window.__require = function e(t, o, n) {
function a(r, l) {
if (!o[r]) {
if (!t[r]) {
var s = r.split("/");
s = s[s.length - 1];
if (!t[s]) {
var c = "function" == typeof __require && __require;
if (!l && c) return c(s, !0);
if (i) return i(s, !0);
throw new Error("Cannot find module '" + r + "'");
}
r = s;
}
var u = o[r] = {
exports: {}
};
t[r][0].call(u.exports, function(e) {
return a(t[r][1][e] || e);
}, u, u.exports, e, t, o, n);
}
return o[r].exports;
}
for (var i = "function" == typeof __require && __require, r = 0; r < n.length; r++) a(n[r]);
return a;
}({
ABDealer: [ function(e, t, o) {
"use strict";
cc._RF.push(t, "0c387qmR71Nsbeyw/RmO9t1", "ABDealer");
var n, a = this && this.__extends || (n = function(e, t) {
return (n = Object.setPrototypeOf || {
__proto__: []
} instanceof Array && function(e, t) {
e.__proto__ = t;
} || function(e, t) {
for (var o in t) Object.prototype.hasOwnProperty.call(t, o) && (e[o] = t[o]);
})(e, t);
}, function(e, t) {
n(e, t);
function o() {
this.constructor = e;
}
e.prototype = null === t ? Object.create(t) : (o.prototype = t.prototype, new o());
}), i = this && this.__decorate || function(e, t, o, n) {
var a, i = arguments.length, r = i < 3 ? t : null === n ? n = Object.getOwnPropertyDescriptor(t, o) : n;
if ("object" == typeof Reflect && "function" == typeof Reflect.decorate) r = Reflect.decorate(e, t, o, n); else for (var l = e.length - 1; l >= 0; l--) (a = e[l]) && (r = (i < 3 ? a(r) : i > 3 ? a(t, o, r) : a(t, o)) || r);
return i > 3 && r && Object.defineProperty(t, o, r), r;
};
Object.defineProperty(o, "__esModule", {
value: !0
});
var r = e("../../../Game/client/global/enum/game/Const"), l = e("../../../Game/client/global/enum/game/Event"), s = e("../../../Game/fromework/global/ResLoader"), c = e("../../../Game/fromework/helper/AudioHelper"), u = e("../../../Game/fromework/helper/EventHelper"), d = e("../../../platform/Platform"), p = e("../../Common/Component/CompositeCard"), h = e("../../Common/Manager/ChipManager"), f = e("../../Common/Utils/CompositeEvent"), _ = e("../../Common/Utils/CompositeUtil"), m = cc._decorator, y = m.ccclass, g = m.property, v = 3 + h.ChipTime, C = function(e) {
a(t, e);
function t() {
var t = null !== e && e.apply(this, arguments) || this;
t.Dealer = null;
t.CardParent = null;
t.OpenSlot = null;
t.AndarSlot = null;
t.BaharSlot = null;
t.CountBack = null;
t.Count = null;
t.DragonBonus = null;
t._winCard = null;
t._openCard = null;
t._dealerCards = [];
t._andarCardList = [];
t._baharCardList = [];
return t;
}
t.prototype.onEnable = function() {
u.default.Instance.Global.bind(f.CompositeGameEvent.GAME_RECONNECT, this.onEnterRoom, this);
u.default.Instance.Global.bind(l.GameEvent.S2C_AB_DEAL, this.onDealerWildCard, this);
u.default.Instance.Global.bind(l.GameEvent.S2C_AB_SHOW, this.onDealer, this);
u.default.Instance.Global.bind(l.GameEvent.S2C_RESET, this.playResetAnimation, this);
};
t.prototype.onDisable = function() {
u.default.Instance.Global.unbind(f.CompositeGameEvent.GAME_RECONNECT, this.onEnterRoom, this);
u.default.Instance.Global.unbind(l.GameEvent.S2C_AB_DEAL, this.onDealerWildCard, this);
u.default.Instance.Global.unbind(l.GameEvent.S2C_AB_SHOW, this.onDealer, this);
u.default.Instance.Global.unbind(l.GameEvent.S2C_RESET, this.playResetAnimation, this);
};
t.prototype.onLoad = function() {
cc.game.on(cc.game.EVENT_SHOW, this._onReset, this);
};
t.prototype.onDestroy = function() {
this.unscheduleAllCallbacks();
cc.game.off(cc.game.EVENT_SHOW, this._onReset, this);
};
t.prototype._onReset = function() {
this.node.stopAllActions();
this._andarCardList.splice(0);
this._baharCardList.splice(0);
this._dealerCards.splice(0);
this.CardParent.destroyAllChildren();
this.destroyWinCard();
this.destroyOpenCard();
this.CountBack.active = !1;
this.Count.string = "0";
this.Dealer.children.forEach(function(e) {
e.active = !0;
});
};
t.prototype.destroyWinCard = function() {
if (null != this._winCard) {
this._winCard.removeFromParent(!0);
this._winCard.destroy();
}
this._winCard = null;
};
t.prototype.destroyOpenCard = function() {
if (null != this._openCard) {
this._openCard.removeFromParent(!0);
this._openCard.destroy();
}
this._openCard = null;
};
t.prototype.refreshListPos = function(e) {
for (var t = e ? this._andarCardList : this._baharCardList, o = 0; o < t.length; o++) {
var n = t[o];
if (n && n.isValid) {
var a = 0;
(a = o < 3 ? 230 + 28 * o : 314 + 2 * (o - 3)) > 320 && (a = 320);
n.setPosition(cc.v2(e ? -a : a, e ? this.AndarSlot.y : this.BaharSlot.y));
}
}
};
t.prototype.refreshDealer = function(e) {
var t = 51 - e, o = 10;
t <= 48 && (o = Math.floor(t / 5)) < 0 && (o = 0);
this.Dealer.children.forEach(function(e, t) {
e.active = t <= o;
});
};
Object.defineProperty(t.prototype, "dealerPos", {
get: function() {
var e = 0;
this.Dealer.children.forEach(function(t) {
t.active && e++;
});
var t = this.Dealer.position;
t.y += this.Dealer.height / 2 + .5 * e;
return t;
},
enumerable: !1,
configurable: !0
});
t.prototype.createWildCard = function() {
var e = this, t = _.default.Game.Model;
s.default.Instance.loadBundleRes(r.BundleUIPath.CompositeCard, cc.Prefab, function(o, n) {
if (o) d.default.log("ABDealer Can Not Load CompositeCard!"); else {
e._openCard = cc.instantiate(n);
e._openCard.scale = .53;
e._openCard.active = !0;
e._openCard.parent = e.CardParent;
e._openCard.setPosition(e.OpenSlot.getPosition());
e._openCard.zIndex = 999;
e._openCard.getComponent(p.default).init(t.deal_card[0], !0);
}
});
};
t.prototype.onEnterRoom = function() {
var e = this, t = _.default.Game.Model;
this._onReset();
0 != t.deal_card.length && this.createWildCard();
if (2 == t.roomData.state || 3 == t.roomData.state) {
if (3 == t.roomData.state) if (0 != t.show_card.length) {
var o = 0, n = t.getCountDown() - v;
n <= 0 ? o = t.show_card.length - 1 : (o = Math.floor(t.show_card.length - n / .25)) < 0 && (o = 0);
this.createCards(t.show_card, function() {
e.dealer(o);
});
} else u.default.Instance.Global.emit(f.OddsEvent.ODDS_RECYCLING);
} else u.default.Instance.Global.emit(f.OddsEvent.ODDS_RECYCLING);
};
t.prototype.onDealerWildCard = function(e) {
var t = this, o = e.getUserData();
this.destroyOpenCard();
s.default.Instance.loadBundleRes(r.BundleUIPath.CompositeCard, cc.Prefab, function(e, n) {
if (e) d.default.log("ABDealer Can Not Load CompositeCard!"); else {
t._openCard = cc.instantiate(n);
t._openCard.scale = .53;
t._openCard.parent = t.CardParent;
t._openCard.setPosition(t.dealerPos);
t._openCard.zIndex = 999;
var a = t._openCard.getComponent(p.default);
a.init(o.wildCard, !1);
var i = t.OpenSlot.getPosition();
a.moveCard(.3, i, t._openCard.scale, t._openCard.scale, function() {
a.flipCard(.3, cc.v3(0, -180, 0), !1, function() {
u.default.Instance.Global.emit(f.CompositeUIEvent.UI_PLAY_START_BET);
});
}, !1);
c.default.Instance.playBundleEffect(r.BundleSoundPath.common_discard);
}
});
};
t.prototype.dealer = function(e) {
var t = this;
void 0 === e && (e = 0);
var o = 0 == _.default.Game.Model.show_card_index ? 0 : 1;
0 != e && (this.Count.string = String(e + 1));
for (var n = [], a = function(a) {
var l = i._dealerCards[a], s = a % 2 == o, d = a == i._dealerCards.length - 1, h = s ? i.AndarSlot : i.BaharSlot;
if (!l || !l.node || !l.node.isValid) return "continue";
if (a < e) {
l.node.active = !0;
l.open = !0;
l.showLightBorder(d);
l.showTranslucentMask(!d);
s ? i._andarCardList.unshift(l.node) : i._baharCardList.unshift(l.node);
} else {
n.push(cc.callFunc(function() {
if (l.node && l.node.isValid) {
l.node.active = !0;
t.Count.string = String(a + 1);
l.node.setPosition(t.dealerPos);
var e = h.getPosition(), o = l.node.scale;
l.moveCard(.05, e, o, o, function() {
l.open = !0;
d || t.scheduleOnce(function() {
if (l.node && l.node.isValid) {
l.showTranslucentMask(!d);
l.moveCard(.1, cc.v2(s ? -230 : 222, h.y), o, o, function() {
s ? t._andarCardList.unshift(l.node) : t._baharCardList.unshift(l.node);
t.refreshListPos(s);
}, !1);
}
}, .2);
}, !1);
c.default.Instance.playBundleEffect(r.BundleSoundPath.common_discard);
t.refreshDealer(a + 1);
}
}));
d || n.push(cc.delayTime(.25));
}
if (d) {
i._winCard = l.node;
n.push(cc.delayTime(.4));
n.push(cc.callFunc(function() {
t._openCard && t._openCard.getComponent(p.default).showLightBorder(!0);
t._winCard && t._winCard.getComponent(p.default).showLightBorder(!0);
u.default.Instance.Global.emit(f.OddsEvent.ODDS_SHOW_WIN);
}));
n.push(cc.delayTime(2.5));
n.push(cc.callFunc(function() {
u.default.Instance.Global.emit(f.OddsEvent.ODDS_RECYCLING);
}));
}
}, i = this, l = 0; l < this._dealerCards.length; l++) a(l);
this.refreshListPos(!0);
this.refreshListPos(!1);
this.CountBack.active = !0;
this.node.stopAllActions();
this.node.runAction(cc.sequence(n));
};
t.prototype.createCards = function(e, t) {
var o = this, n = 0 == _.default.Game.Model.show_card_index ? 0 : 1;
s.default.Instance.loadBundleRes(r.BundleUIPath.CompositeCard, cc.Prefab, function(a, i) {
if (a) d.default.log("ABDealer Can Not Load CompositeCard!"); else {
for (var r = 0; r < e.length; r++) {
var l = r % 2 == n, s = cc.instantiate(i);
s.scale = .53;
s.active = !1;
s.parent = o.CardParent;
s.setPosition(o.dealerPos);
s.zIndex = l ? r : 999 - r;
var c = s.getComponent(p.default);
c.init(e[r], !1);
o._dealerCards.push(c);
}
t && t();
}
});
};
t.prototype.onDealer = function() {
var e = this, t = _.default.Game.Model;
this.createCards(t.show_card, function() {
e.dealer(0);
});
};
t.prototype.playResetAnimation = function() {
var e = this, t = [];
t.push(cc.callFunc(function() {
e._andarCardList.forEach(function(t) {
t.runAction(cc.sequence(cc.moveTo(.2, e.OpenSlot.getPosition()), cc.callFunc(function() {
t.removeFromParent(!0);
t.destroy();
})));
});
e._andarCardList.splice(0);
e._baharCardList.forEach(function(t) {
t.runAction(cc.sequence(cc.moveTo(.2, e.OpenSlot.getPosition()), cc.callFunc(function() {
t.removeFromParent(!0);
t.destroy();
})));
});
e._baharCardList.splice(0);
e._winCard && e._winCard.isValid && e._winCard.runAction(cc.sequence(cc.callFunc(function() {
c.default.Instance.playBundleEffect(r.BundleSoundPath.common_draw);
}), cc.moveTo(.2, e.OpenSlot.getPosition()), cc.callFunc(function() {
e.destroyWinCard();
})));
}));
t.push(cc.delayTime(.3));
t.push(cc.callFunc(function() {
if (e._openCard && e._openCard.isValid) {
var t = e._openCard.getComponent(p.default);
t.showLightBorder(!1);
t.flipCard(.3, cc.v3(0, -180, 0), !0, function() {
t.moveCard(.3, cc.v2(e.dealerPos.x, e.dealerPos.y), e._openCard.scale, e._openCard.scale, function() {
e._onReset();
e.Dealer.active = !1;
e.DragonBonus.node.active = !0;
e.DragonBonus.armatureName = "Armature";
e.DragonBonus.once(dragonBones.EventObject.COMPLETE, function() {
e.Dealer.active = !0;
e.DragonBonus.node.active = !1;
}, e);
e.DragonBonus.playAnimation("card", 1);
c.default.Instance.playBundleEffect(r.BundleSoundPath.common_shuffle_cards);
}, !1);
c.default.Instance.playBundleEffect(r.BundleSoundPath.common_draw);
});
}
}));
this.CountBack.active = !1;
this.node.stopAllActions();
this.node.runAction(cc.sequence(t));
};
i([ g(cc.Node) ], t.prototype, "Dealer", void 0);
i([ g(cc.Node) ], t.prototype, "CardParent", void 0);
i([ g(cc.Node) ], t.prototype, "OpenSlot", void 0);
i([ g(cc.Node) ], t.prototype, "AndarSlot", void 0);
i([ g(cc.Node) ], t.prototype, "BaharSlot", void 0);
i([ g(cc.Node) ], t.prototype, "CountBack", void 0);
i([ g(cc.Label) ], t.prototype, "Count", void 0);
i([ g(dragonBones.ArmatureDisplay) ], t.prototype, "DragonBonus", void 0);
return i([ y ], t);
}(cc.Component);
o.default = C;
cc._RF.pop();
}, {
"../../../Game/client/global/enum/game/Const": "Const",
"../../../Game/client/global/enum/game/Event": "Event",
"../../../Game/fromework/global/ResLoader": "ResLoader",
"../../../Game/fromework/helper/AudioHelper": "AudioHelper",
"../../../Game/fromework/helper/EventHelper": "EventHelper",
"../../../platform/Platform": "Platform",
"../../Common/Component/CompositeCard": "CompositeCard",
"../../Common/Manager/ChipManager": "ChipManager",
"../../Common/Utils/CompositeEvent": "CompositeEvent",
"../../Common/Utils/CompositeUtil": "CompositeUtil"
} ],
ABHelp: [ function(e, t, o) {
"use strict";
cc._RF.push(t, "08ab1CiQkJLUpXBabzOVCaU", "ABHelp");
var n, a = this && this.__extends || (n = function(e, t) {
return (n = Object.setPrototypeOf || {
__proto__: []
} instanceof Array && function(e, t) {
e.__proto__ = t;
} || function(e, t) {
for (var o in t) Object.prototype.hasOwnProperty.call(t, o) && (e[o] = t[o]);
})(e, t);
}, function(e, t) {
n(e, t);
function o() {
this.constructor = e;
}
e.prototype = null === t ? Object.create(t) : (o.prototype = t.prototype, new o());
}), i = this && this.__decorate || function(e, t, o, n) {
var a, i = arguments.length, r = i < 3 ? t : null === n ? n = Object.getOwnPropertyDescriptor(t, o) : n;
if ("object" == typeof Reflect && "function" == typeof Reflect.decorate) r = Reflect.decorate(e, t, o, n); else for (var l = e.length - 1; l >= 0; l--) (a = e[l]) && (r = (i < 3 ? a(r) : i > 3 ? a(t, o, r) : a(t, o)) || r);
return i > 3 && r && Object.defineProperty(t, o, r), r;
};
Object.defineProperty(o, "__esModule", {
value: !0
});
var r = e("../../Common/Utils/CompositeUtil"), l = cc._decorator, s = l.ccclass, c = l.property, u = function(e) {
a(t, e);
function t() {
var t = null !== e && e.apply(this, arguments) || this;
t.RateAry = [];
return t;
}
t.prototype.onLoad = function() {
for (var e = r.default.Game.Model, t = 0; t < this.RateAry.length; t++) this.RateAry[t].string = e.bet_options[t].x + " x";
};
i([ c([ cc.Label ]) ], t.prototype, "RateAry", void 0);
return i([ s ], t);
}(cc.Component);
o.default = u;
cc._RF.pop();
}, {
"../../Common/Utils/CompositeUtil": "CompositeUtil"
} ],
ABModel: [ function(e, t, o) {
"use strict";
cc._RF.push(t, "eee43URaopDiJ3rKkpJpeT0", "ABModel");
var n, a = this && this.__extends || (n = function(e, t) {
return (n = Object.setPrototypeOf || {
__proto__: []
} instanceof Array && function(e, t) {
e.__proto__ = t;
} || function(e, t) {
for (var o in t) Object.prototype.hasOwnProperty.call(t, o) && (e[o] = t[o]);
})(e, t);
}, function(e, t) {
n(e, t);
function o() {
this.constructor = e;
}
e.prototype = null === t ? Object.create(t) : (o.prototype = t.prototype, new o());
});
Object.defineProperty(o, "__esModule", {
value: !0
});
o.ABModel = void 0;
var i = e("../../../Game/client/global/enum/game/Event"), r = e("../../../Game/client/global/enum/game/Game"), l = e("../../../Game/client/global/enum/net/C2S"), s = e("../../../Game/client/global/enum/net/S2C"), c = e("../../../Game/fromework/global/Tools"), u = e("../../../Game/fromework/helper/EventHelper"), d = e("../../../Game/fromework/mvvm/modelView/ViewModel"), p = e("../../../client/logic/game/HearBeat"), h = e("../../../client/model/ErrorModel"), f = e("../../../fromework/helper/NetHelper"), _ = e("../../Common/Utils/CompositeProxy"), m = e("./ABStruct"), y = function(e) {
a(t, e);
function t() {
var t = null !== e && e.apply(this, arguments) || this;
t.declearHistory = new m.ABStruct.DeclearHistory();
t.show_card_index = 0;
t.bet_fee_currency = [];
t.bet_options = [];
return t;
}
Object.defineProperty(t, "Instance", {
get: function() {
t._instance || (t._instance = new t());
return t._instance;
},
enumerable: !1,
configurable: !0
});
t.prototype.clear = function() {
null != t._instance && (t._instance = null);
};
t.prototype.getCompensationCash = function() {
for (var e = new Map(), t = 0; t < this.win_options.length; t++) {
var o = this.roomBetRecord[this.win_options[t]];
if (0 != o.amount) {
var n = this.bet_options[this.win_options[t]];
e.set(this.win_options[t], o.amount * (n.x - 1));
}
}
return e;
};
t.prototype.getWinFee = function(e) {
var t = new Map();
if (this.declearData.user_data.has(String(e))) for (var o = this.declearData.user_data.get(String(e)), n = 0; n < o.bet_record.length; n++) {
var a = o.bet_record[n];
if (0 != a.amount) {
var i = t.has(n) ? t.get(n) : 0, r = this.bet_options[n];
t.set(n, i + a.amount * r.x);
}
}
return t;
};
t._instance = null;
return t;
}(_.CompositeModel);
o.ABModel = y;
var g = function(e) {
a(t, e);
function t() {
return null !== e && e.apply(this, arguments) || this;
}
Object.defineProperty(t, "Instance", {
get: function() {
t._instance || (t._instance = new t());
return t._instance;
},
enumerable: !1,
configurable: !0
});
t.prototype.Init = function() {
u.default.Instance.Net.bind(s.S2C.GAME.ROOM_ENTER_ROOM, this._onEnterRoom, this);
u.default.Instance.Net.bind(s.S2C.GAME.ROOM_SWITCH_ROOM, this._onSwitchRoom, this);
u.default.Instance.Net.bind(s.S2C.GAME.ROOM_DEAL, this._onDeal, this);
u.default.Instance.Net.bind(s.S2C.GAME.ROOM_START_BET, this._onStartBet, this);
u.default.Instance.Net.bind(s.S2C.GAME.ROOM_BET, this._onBet, this);
u.default.Instance.Net.bind(s.S2C.GAME.ROOM_BET_BATCH, this._onBetBatch, this);
u.default.Instance.Net.bind(s.S2C.GAME.ROOM_STOP_BET, this._onStopBet, this);
u.default.Instance.Net.bind(s.S2C.GAME.ROOM_SHOW, this._onShow, this);
u.default.Instance.Net.bind(s.S2C.GAME.ROOM_RESET_ROOM, this._onResetRoom, this);
u.default.Instance.Net.bind(s.S2C.GAME.ROOM_INTERACT, this._onInteract, this);
u.default.Instance.Net.bind(s.S2C.GAME.ROOM_RANK, this._onRank, this);
u.default.Instance.Net.bind(s.S2C.GAME.ROOM_LEAVE, this._onLeave, this);
u.default.Instance.Net.bind(s.S2C.GAME.ROOM_LEAVE_SINGLE, this._onLeaveSingle, this);
u.default.Instance.Net.bind(s.S2C.GAME.ROOM_DISMISS, this._onDismiss, this);
u.default.Instance.Net.bind(s.S2C.GAME.ROOM_SEND_AVAILABLE_BALANCE, this._onBalanceRefresh, this);
u.default.Instance.Global.bind(f.NetState.NET_WEBSOCKET_CONNECT_OPEN, this._onWsContented, this);
};
t.prototype.destory = function() {
u.default.Instance.Net.unbind(s.S2C.GAME.ROOM_ENTER_ROOM, this._onEnterRoom, this);
u.default.Instance.Net.unbind(s.S2C.GAME.ROOM_SWITCH_ROOM, this._onSwitchRoom, this);
u.default.Instance.Net.unbind(s.S2C.GAME.ROOM_DEAL, this._onDeal, this);
u.default.Instance.Net.unbind(s.S2C.GAME.ROOM_START_BET, this._onStartBet, this);
u.default.Instance.Net.unbind(s.S2C.GAME.ROOM_BET, this._onBet, this);
u.default.Instance.Net.unbind(s.S2C.GAME.ROOM_BET_BATCH, this._onBetBatch, this);
u.default.Instance.Net.unbind(s.S2C.GAME.ROOM_STOP_BET, this._onStopBet, this);
u.default.Instance.Net.unbind(s.S2C.GAME.ROOM_SHOW, this._onShow, this);
u.default.Instance.Net.unbind(s.S2C.GAME.ROOM_RESET_ROOM, this._onResetRoom, this);
u.default.Instance.Net.unbind(s.S2C.GAME.ROOM_INTERACT, this._onInteract, this);
u.default.Instance.Net.unbind(s.S2C.GAME.ROOM_RANK, this._onRank, this);
u.default.Instance.Net.unbind(s.S2C.GAME.ROOM_LEAVE, this._onLeave, this);
u.default.Instance.Net.unbind(s.S2C.GAME.ROOM_LEAVE_SINGLE, this._onLeaveSingle, this);
u.default.Instance.Net.unbind(s.S2C.GAME.ROOM_DISMISS, this._onDismiss, this);
u.default.Instance.Net.unbind(s.S2C.GAME.ROOM_SEND_AVAILABLE_BALANCE, this._onBalanceRefresh, this);
u.default.Instance.Global.unbind(f.NetState.NET_WEBSOCKET_CONNECT_OPEN, this._onWsContented, this);
};
t.prototype.clear = function() {};
t.prototype._onWsContented = function() {
p.default.Instance.begin();
var e = d.VM.getValue("lobby.roomID");
0 != e && this.sendEnterRoom(e);
};
Object.defineProperty(t.prototype, "roomID", {
get: function() {
return d.VM.getValue("lobby.roomID");
},
enumerable: !1,
configurable: !0
});
t.prototype.checkRoomID = function(e) {
return d.VM.getValue("lobby.roomID") == e;
};
t.prototype.checkRoomType = function(e) {
var t = e.split("_"), o = -1;
null != t && null != t[0] && (o = parseInt(t[0]));
return o == r.GameEnum.PlayType.GAME_ANDARBAHAR;
};
t.prototype._onEnterRoom = function(t) {
var o = t.getUserData();
if (this.checkRoomID(o.rid)) {
var n = y.Instance;
if (null != o.user_data && o.uid == this.uid) {
n.bet_fee_currency = o.bet_fee_currency;
n.bet_options = o.bet_options;
n.declearHistory.refresh(o.declear_history);
n.show_card_index = o.show_card_index;
}
e.prototype._onEnterRoom.call(this, o, n);
}
};
t.prototype._onSwitchRoom = function(e) {
var t = e.getUserData();
if (this.checkRoomType(t.room_type)) {
d.VM.getValue("lobby.roomID") != t.r && d.VM.setValue("lobby.roomID", parseInt(t.r));
u.default.Instance.Global.emit(i.GameEvent.S2C_SWITCH_ROOM, t.r);
}
};
t.prototype._onDeal = function(t) {
var o = t.getUserData();
if (this.checkRoomID(o.rid)) {
var n = y.Instance;
e.prototype._onDeal.call(this, o, n);
}
};
t.prototype._onStartBet = function(t) {
var o = t.getUserData();
if (this.checkRoomID(o.rid)) {
var n = y.Instance;
e.prototype._onStartBet.call(this, o, n);
}
};
t.prototype._onBet = function(t) {
var o = t.getUserData();
if (this.checkRoomID(o.rid)) {
var n = y.Instance;
e.prototype._onBet.call(this, o, n);
}
};
t.prototype._onBetBatch = function(t) {
var o = t.getUserData();
if (this.checkRoomID(o.rid)) {
var n = y.Instance;
e.prototype._onBetBatch.call(this, o, n);
}
};
t.prototype._onStopBet = function(t) {
var o = t.getUserData();
if (this.checkRoomID(o.rid)) {
var n = y.Instance;
e.prototype._onStopBet.call(this, o, n);
}
};
t.prototype._onShow = function(t) {
var o = t.getUserData();
if (this.checkRoomID(o.rid)) {
var n = y.Instance;
n.show_card_index = o.show_card_index;
var a = new m.ABStruct.HistoryData({
d: [ o.room_data.show_card.length ],
w: o.win_options
});
n.declearHistory.addHistory(a);
e.prototype._onShow.call(this, o, n);
}
};
t.prototype._onResetRoom = function(t) {
var o = t.getUserData();
if (this.checkRoomID(o.rid)) {
var n = y.Instance;
e.prototype._onResetRoom.call(this, o, n);
}
};
t.prototype._onInteract = function(t) {
var o = t.getUserData();
if (this.checkRoomID(o.rid)) {
var n = y.Instance;
e.prototype._onInteract.call(this, o, n);
}
};
t.prototype._onRank = function(t) {
var o = t.getUserData();
if (this.checkRoomID(o.rid)) {
var n = y.Instance;
e.prototype._onRank.call(this, o, n);
}
};
t.prototype._onLeave = function(t) {
var o = t.getUserData();
if (this.checkRoomID(o.rid)) {
var n = y.Instance;
e.prototype._onLeave.call(this, o, n);
}
};
t.prototype._onLeaveSingle = function(t) {
var o = t.getUserData();
if (this.checkRoomID(o.rid) || 0 == d.VM.getValue("lobby.roomID")) {
var n = y.Instance;
e.prototype._onLeaveSingle.call(this, o, n);
}
};
t.prototype._onDismiss = function(t) {
var o = t.getUserData();
if (this.checkRoomID(o.rid)) {
var n = y.Instance;
e.prototype._onDismiss.call(this, o, n);
}
};
t.prototype._onBalanceRefresh = function(t) {
var o = t.getUserData();
if (!this.checkRoomID(o.rid)) {
var n = y.Instance;
e.prototype._onBalanceRefresh.call(this, o, n);
}
};
t.prototype.sendEnterRoom = function(e, t) {
void 0 === t && (t = !0);
var o = f.default.Instance.makeMsg(l.C2S.ROOM_ENTER_ROOM, {
u: this.uid,
t: this.token,
r: e,
is_open: t
});
f.default.Instance.send(o);
};
t.prototype.sendBet = function(e, t) {
var o = c.Tools.TNumber.num2thousand(e);
h.default.Instance.CompositeBetNum = e;
var n = f.default.Instance.makeMsg(l.C2S.ROOM_BET, {
u: this.uid,
t: this.token,
r: this.roomID,
fee: o,
option: t
});
f.default.Instance.send(n);
};
t.prototype.sendInteract = function(e, t, o) {
var n;
n = o ? {
u: this.uid,
t: this.token,
r: this.roomID,
to_u: e,
opt_type: t,
opt_val: o
} : {
u: this.uid,
t: this.token,
r: this.roomID,
to_u: e,
opt_type: t
};
var a = f.default.Instance.makeMsg(l.C2S.ROOM_INTERACT, n);
f.default.Instance.send(a);
};
t.prototype.sendRank = function(e, t) {
var o = f.default.Instance.makeMsg(l.C2S.ROOM_RANK, {
u: this.uid,
t: this.token,
r: this.roomID,
page: e,
count: t
});
f.default.Instance.send(o);
};
t.prototype.sendLeave = function() {
var e = f.default.Instance.makeMsg(l.C2S.ROOM_LEAVE, {
u: this.uid,
t: this.token,
r: this.roomID
});
f.default.Instance.send(e);
};
t._instance = null;
return t;
}(_.CompositeProxy);
o.default = g;
cc._RF.pop();
}, {
"../../../Game/client/global/enum/game/Event": "Event",
"../../../Game/client/global/enum/game/Game": "Game",
"../../../Game/client/global/enum/net/C2S": "C2S",
"../../../Game/client/global/enum/net/S2C": "S2C",
"../../../Game/fromework/global/Tools": "Tools",
"../../../Game/fromework/helper/EventHelper": "EventHelper",
"../../../Game/fromework/mvvm/modelView/ViewModel": "ViewModel",
"../../../client/logic/game/HearBeat": "HearBeat",
"../../../client/model/ErrorModel": "ErrorModel",
"../../../fromework/helper/NetHelper": "NetHelper",
"../../Common/Utils/CompositeProxy": "CompositeProxy",
"./ABStruct": "ABStruct"
} ],
ABRecordSmall: [ function(e, t, o) {
"use strict";
cc._RF.push(t, "adb20NhnOpNrI8rTq2fYmL1", "ABRecordSmall");
var n, a = this && this.__extends || (n = function(e, t) {
return (n = Object.setPrototypeOf || {
__proto__: []
} instanceof Array && function(e, t) {
e.__proto__ = t;
} || function(e, t) {
for (var o in t) Object.prototype.hasOwnProperty.call(t, o) && (e[o] = t[o]);
})(e, t);
}, function(e, t) {
n(e, t);
function o() {
this.constructor = e;
}
e.prototype = null === t ? Object.create(t) : (o.prototype = t.prototype, new o());
}), i = this && this.__decorate || function(e, t, o, n) {
var a, i = arguments.length, r = i < 3 ? t : null === n ? n = Object.getOwnPropertyDescriptor(t, o) : n;
if ("object" == typeof Reflect && "function" == typeof Reflect.decorate) r = Reflect.decorate(e, t, o, n); else for (var l = e.length - 1; l >= 0; l--) (a = e[l]) && (r = (i < 3 ? a(r) : i > 3 ? a(t, o, r) : a(t, o)) || r);
return i > 3 && r && Object.defineProperty(t, o, r), r;
};
Object.defineProperty(o, "__esModule", {
value: !0
});
var r = e("../../../Game/client/global/enum/game/Event"), l = e("../../../Game/fromework/helper/EventHelper"), s = e("../../Common/Utils/CompositeUtil"), c = cc._decorator, u = c.ccclass, d = c.property, p = function(e) {
a(t, e);
function t() {
var t = null !== e && e.apply(this, arguments) || this;
t.TopRecordParent = null;
t.TopRecordItem = null;
t.Light = null;
t.Frames_Item = [];
t.MaxCount = 18;
return t;
}
t.prototype.onEnable = function() {
l.default.Instance.Global.bind(r.GameEvent.S2C_ENTER_ROOM, this._onEnterRoom, this);
l.default.Instance.Global.bind(r.GameEvent.S2C_RESET, this._onResetRoom, this);
};
t.prototype.onDisable = function() {
l.default.Instance.Global.unbind(r.GameEvent.S2C_ENTER_ROOM, this._onEnterRoom, this);
l.default.Instance.Global.unbind(r.GameEvent.S2C_RESET, this._onResetRoom, this);
};
t.prototype.onLoad = function() {
this.refreshTopRecord(!1);
};
t.prototype._onEnterRoom = function() {
this.refreshTopRecord(!1);
};
t.prototype._onResetRoom = function() {
this.refreshTopRecord(!0);
};
t.prototype.refreshTopRecord = function(e) {
var t = this;
void 0 === e && (e = !1);
var o = s.default.Game.Model;
this.TopRecordParent.destroyAllChildren();
for (var n = o.declearHistory.getSimpleHistory(this.MaxCount), a = 0; a < n.length; a++) {
var i = n[a], r = cc.instantiate(this.TopRecordItem);
r.active = !0;
r.setPosition(cc.Vec2.ZERO);
r.parent = this.TopRecordParent;
r.getChildByName("Background").getComponent(cc.Sprite).spriteFrame = this.Frames_Item[0 == i.win[0] ? 0 : 1];
var l = o.bet_options[i.win[1]], c = r.getChildByName("Points").getComponent(cc.Label);
l && c && (c.string = l.min + "-" + l.max);
}
if (e && null != this.Light) {
this.TopRecordParent.getComponent(cc.Layout).updateLayout();
var u = this.TopRecordParent.children[this.TopRecordParent.children.length - 1], d = u.parent.convertToWorldSpaceAR(u.position), p = this.Light.node.parent.convertToNodeSpaceAR(d);
this.Light.node.position = p;
this.Light.node.active = !0;
this.Light.armatureName = "Armature";
this.Light.once(dragonBones.EventObject.COMPLETE, function() {
t.Light.node.active = !1;
}, this);
this.Light.playAnimation("animation_new_details", 1);
}
};
i([ d(cc.Node) ], t.prototype, "TopRecordParent", void 0);
i([ d(cc.Node) ], t.prototype, "TopRecordItem", void 0);
i([ d(dragonBones.ArmatureDisplay) ], t.prototype, "Light", void 0);
i([ d([ cc.SpriteFrame ]) ], t.prototype, "Frames_Item", void 0);
i([ d ], t.prototype, "MaxCount", void 0);
return i([ u ], t);
}(cc.Component);
o.default = p;
cc._RF.pop();
}, {
"../../../Game/client/global/enum/game/Event": "Event",
"../../../Game/fromework/helper/EventHelper": "EventHelper",
"../../Common/Utils/CompositeUtil": "CompositeUtil"
} ],
ABRecord: [ function(e, t, o) {
"use strict";
cc._RF.push(t, "15329wtsb9JtaymVrxhw5Dz", "ABRecord");
var n, a = this && this.__extends || (n = function(e, t) {
return (n = Object.setPrototypeOf || {
__proto__: []
} instanceof Array && function(e, t) {
e.__proto__ = t;
} || function(e, t) {
for (var o in t) Object.prototype.hasOwnProperty.call(t, o) && (e[o] = t[o]);
})(e, t);
}, function(e, t) {
n(e, t);
function o() {
this.constructor = e;
}
e.prototype = null === t ? Object.create(t) : (o.prototype = t.prototype, new o());
}), i = this && this.__decorate || function(e, t, o, n) {
var a, i = arguments.length, r = i < 3 ? t : null === n ? n = Object.getOwnPropertyDescriptor(t, o) : n;
if ("object" == typeof Reflect && "function" == typeof Reflect.decorate) r = Reflect.decorate(e, t, o, n); else for (var l = e.length - 1; l >= 0; l--) (a = e[l]) && (r = (i < 3 ? a(r) : i > 3 ? a(t, o, r) : a(t, o)) || r);
return i > 3 && r && Object.defineProperty(t, o, r), r;
};
Object.defineProperty(o, "__esModule", {
value: !0
});
var r = e("../../../Game/fromework/helper/UIHelper"), l = e("../../Common/Utils/CompositeUtil"), s = cc._decorator, c = s.ccclass, u = s.property, d = function(e) {
a(t, e);
function t() {
var t = null !== e && e.apply(this, arguments) || this;
t.AndarWin = null;
t.BaharWin = null;
t.BottomContent = null;
t.BottomRecordParent = null;
t.BottomRecordItem = null;
t.Frames_Item = [];
return t;
}
t.prototype.onLoad = function() {
var e = l.default.Game.Model;
if (e) {
var t = e.declearHistory.getWinRate();
this.AndarWin.string = (100 * t.andar).toFixed(0) + "%";
this.BaharWin.string = (100 * t.bahar).toFixed(0) + "%";
} else {
this.AndarWin.string = "0%";
this.BaharWin.string = "0%";
}
this.refreshBottomRecord();
};
t.prototype.refreshBottomRecord = function() {
var e = l.default.Game.Model;
this.BottomRecordParent.destroyAllChildren();
for (var t = e.declearHistory.getComplexHistory(18), o = 0, n = 0; n < t.length; n++) {
var a = t[n], i = 27 + 54 * n;
a.length > o && (o = a.length);
for (var r = 0; r < a.length; r++) {
var s = a[r], c = -(27 + 54 * r), u = cc.instantiate(this.BottomRecordItem);
u.active = !0;
u.setPosition(cc.v2(i, c));
u.parent = this.BottomRecordParent;
u.getChildByName("Background").getComponent(cc.Sprite).spriteFrame = this.Frames_Item[0 == s.win[0] ? 0 : 1];
u.getChildByName("Points").getComponent(cc.Label).string = s.count + "";
var d = e.bet_options[s.win[1]], p = u.getChildByName("Second").getComponent(cc.Label);
d && p && (p.string = d.min + "-" + d.max);
}
}
this.BottomContent.height = 54 * o;
};
t.prototype.onCloseClicked = function() {
r.default.Instance.removeMaskLayer(this.node, !0);
};
i([ u(cc.Label) ], t.prototype, "AndarWin", void 0);
i([ u(cc.Label) ], t.prototype, "BaharWin", void 0);
i([ u(cc.Node) ], t.prototype, "BottomContent", void 0);
i([ u(cc.Node) ], t.prototype, "BottomRecordParent", void 0);
i([ u(cc.Node) ], t.prototype, "BottomRecordItem", void 0);
i([ u([ cc.SpriteFrame ]) ], t.prototype, "Frames_Item", void 0);
return i([ c ], t);
}(cc.Component);
o.default = d;
cc._RF.pop();
}, {
"../../../Game/fromework/helper/UIHelper": "UIHelper",
"../../Common/Utils/CompositeUtil": "CompositeUtil"
} ],
ABStruct: [ function(e, t, o) {
"use strict";
cc._RF.push(t, "3ba34clONtM/IX8Y4Rk82Vm", "ABStruct");
Object.defineProperty(o, "__esModule", {
value: !0
});
o.ABStruct = void 0;
(function(e) {
var t = function() {
function e(e) {
this.count = 0;
this.win = [];
e && this.refresh(e);
}
e.prototype.refresh = function(e) {
this.count = e.d[0];
this.win = e.w;
};
return e;
}();
e.HistoryData = t;
var o = function() {
function e(e) {
this.historyArray = [];
e && this.refresh(e);
}
e.prototype.refresh = function(e) {
var o = this;
this.historyArray.splice(0);
e.forEach(function(e) {
var n = new t(e);
o.historyArray.push(n);
});
};
e.prototype.getWinRate = function() {
var e = 0, t = 0, o = 0;
this.historyArray.forEach(function(n) {
e++;
0 == n.win[0] ? t++ : o++;
});
return {
andar: t / e,
bahar: o / e
};
};
e.prototype.addHistory = function(e) {
100 == this.historyArray.length && this.historyArray.shift();
this.historyArray.push(e);
};
e.prototype.getSimpleHistory = function(e) {
for (var t = [], o = this.historyArray.length - 1; o >= 0; o--) {
var n = this.historyArray[o];
t.unshift(n);
if (t.length == e) break;
}
return t;
};
e.prototype.getComplexHistory = function(e) {
for (var t = [], o = -1, n = this.historyArray.length - 1; n >= 0; n--) {
var a = this.historyArray[n];
if (o != a.win[0]) {
if (t.length == e) break;
o = a.win[0];
t.unshift([]);
}
t[0].length != e && t[0].unshift(a);
}
return t;
};
return e;
}();
e.DeclearHistory = o;
})(o.ABStruct || (o.ABStruct = {}));
cc._RF.pop();
}, {} ],
ActiveEvent: [ function(e, t, o) {
"use strict";
cc._RF.push(t, "7fd69W1UNNP6rU8VEtaa+D+", "ActiveEvent");
Object.defineProperty(o, "__esModule", {
value: !0
});
o.LotoEvent = o.RechargeLuckyEvent = o.RechargeSuperEvent = o.DailyRechargeEvent = o.BrokeEvent = void 0;
o.BrokeEvent = {
BROKE_GET_BROKE_DATA: "BROKE_GET_BROKE_DATA"
};
o.DailyRechargeEvent = {
DAILY_RECHARGE_PAY_CLICK: "DAILY_RECHARGE_PAY_CLICK"
};
o.RechargeSuperEvent = {
RECHARGE_GET_SUPER_DATA: "RECHARGE_GET_SUPER_DATA",
RECHARGE_GET_SUPER_RECEIVE: "RECHARGE_GET_SUPER_RECEIVE",
RECHARGE_GET_SUPER_PAY: "RECHARGE_GET_SUPER_PAY"
};
o.RechargeLuckyEvent = {
RECHARGE_GET_LUCKY_DATA: "RECHARGE_GET_LUCKY_DATA",
RECHARGE_GET_LUCKY_PAY: "RECHARGE_GET_LUCKY_PAY"
};
o.LotoEvent = {
LOTO_ALL: "LOTO_ALL",
LOTO_MAIN: "LOTO_MAIN",
LOTO_BET: "LOTO_BET",
LOTO_GET_REWARD: "LOTO_GET_REWARD",
LOTO_DATE_CLICK: "LOTO_DATE_CLICK"
};
cc._RF.pop();
}, {} ],
ActiveManager: [ function(e, t, o) {
"use strict";
cc._RF.push(t, "a3a50oOZAdFXbgvGDWgfNgP", "ActiveManager");
Object.defineProperty(o, "__esModule", {
value: !0
});
var n = e("../../../Game/client/global/enum/game/Const"), a = e("../../../Game/client/global/enum/game/Event"), i = e("../../../Game/fromework/helper/EventHelper"), r = e("../../../Game/fromework/helper/UIHelper"), l = e("../../../Game/fromework/mvvm/modelView/ViewModel"), s = e("../../../Game/Script/global/GlobalValue"), c = e("../../component/WithdrawAlert"), u = e("../../global/PopHelper"), d = e("../../model/MonthCardModel"), p = e("../../model/UserModel"), h = e("../../model/WalletModel"), f = e("../ui/MonthCard/MonthCardLobbyView"), _ = e("../ui/MonthCard/MonthCardUpdate"), m = e("../ui/Notice/Notice"), y = e("../Wallet/WalletHelper"), g = e("./ActiveModel"), v = e("./FirstCharge/FirstCharge"), C = e("./Recharge/RechagerActivity"), b = function() {
function e() {
this.isOpenWithdraw = !1;
this._loginFuncBool = !1;
this._loginActiveBool = !1;
this._loginSignBool = !1;
this._loginBonusBool = !1;
}
Object.defineProperty(e, "Instance", {
get: function() {
e._instance || (e._instance = new e());
return e._instance;
},
enumerable: !1,
configurable: !0
});
e.prototype.Init = function() {
i.default.Instance.Global.bind(a.TipsEvent.TIPS_SYSTEM_WITHDRAW_ALERT, this._onCheckWithdrawAlert, this);
};
e.prototype.clear = function() {
i.default.Instance.Global.unbind(a.TipsEvent.TIPS_SYSTEM_WITHDRAW_ALERT, this._onCheckWithdrawAlert, this);
this._loginFuncBool = !1;
this._loginActiveBool = !1;
};
e.prototype._onCheckWithdrawAlert = function() {
if (s.default.getInstance().isCashGame) {
if (null != g.ActiveProxy.Instance.systemTipsData && l.VM.getValue("wallet.withdraw") >= 100) {
this.openWithdrawAlert(g.ActiveProxy.Instance.systemTipsData.sub_type);
g.ActiveProxy.Instance.systemTipsData = null;
}
if (g.ActiveProxy.Instance.isOpenBrokeAlert) {
g.ActiveProxy.Instance.isOpenBrokeAlert = !1;
this.openBrokeAlert();
}
}
};
e.prototype.checkFirstAward = function() {
return l.VM.getValue("user.isFirstLogin");
};
e.prototype.checkMonthCardUpdate = function() {
return d.MonthCardProxy.Instance.monthCardAll.close_not_get_deposit + d.MonthCardProxy.Instance.monthCardAll.close_not_get_bonus > 0;
};
e.prototype.checkSuperActive = function() {
if (!s.default.getInstance().isCashGame) return !1;
var e = g.ActiveModel.Instance;
return null != e && !(!e.rechargeSuperActiveData || !e.rechargeSuperActiveData.activeInfo || 3 == e.rechargeSuperActiveData.activeInfo.active_status);
};
e.prototype.checkLuckyActive = function() {
if (!s.default.getInstance().isCashGame) return !1;
var e = g.ActiveModel.Instance;
return null != e && !(!e.rechargeLuckyActiveData || !e.rechargeLuckyActiveData.activeInfo || 3 == e.rechargeLuckyActiveData.activeInfo.active_status);
};
e.prototype.openLoginFuncAlert = function(e, t) {
void 0 === e && (e = !1);
void 0 === t && (t = 0);
if (!this._loginFuncBool) {
this._loginFuncBool = !0;
this.checkMonthCardUpdate() ? this.openMonthCardUpdate() : this.openLoginActiveAlert(e, t);
}
};
e.prototype.openLoginActiveAlert = function(e, t) {
void 0 === e && (e = !1);
void 0 === t && (t = 0);
if (!this._loginActiveBool) {
this._loginActiveBool = !0;
this.checkLuckyActive() ? this.openLuckyAlertAndRefreshData() : this.checkSuperActive() ? this.openSuperAlertAndRefreshData() : e && 0 != t && r.default.Instance.addBundleMaskLayer(n.BundleUIPath.MonthCardLobbyView, function(e) {
e.getComponent(f.default).initView(t);
});
}
};
e.prototype.openNotice = function(e) {
r.default.Instance.addBundleMaskLayer(n.BundleUIPath.Notice, function(t) {
t.getComponent(m.default).show(null, e);
});
};
e.prototype.openFirstAward = function() {
l.VM.setValue("user.isFirstLogin", !1);
r.default.Instance.addBundleMaskLayer(n.BundleUIPath.FirstAward);
};
e.prototype.openWithdrawAlert = function(e, t) {
if (r.default.Instance.isOpenMaskLayer(n.BundleUIPath.WithdrawAlert)) {
var o = r.default.Instance.getMaskLayer(n.BundleUIPath.WithdrawAlert);
o && o.getComponent(c.default).refreshAlert(e, t);
} else r.default.Instance.addBundleMaskLayer(n.BundleUIPath.WithdrawAlert, function(o) {
o.getComponent(c.default).showAlert(e, t);
}, u.PopZindex.Alert);
};
e.prototype.openMonthCardUpdate = function() {
r.default.Instance.addBundleMaskLayer(n.BundleUIPath.MonthCardUpdate, function(e) {
e.getComponent(_.default).show();
});
};
e.prototype.openFirstCharge = function() {
var e = h.WalletProxy.Instance.getRechargeActiveByType(1);
if (null != e && null != e[0]) {
var t = h.WalletProxy.Instance.getRechargeGoods(e[0].id);
if (null != t) {
var o = 99999;
t.forEach(function(e) {
o = Math.min(parseInt(e.amount), o);
});
r.default.Instance.addBundleMaskLayer(n.BundleUIPath.FirstCharge, function(t) {
t.getComponent(v.default).show(e[0], o);
});
}
}
};
e.prototype.openBrokeAlert = function() {
var e = g.ActiveModel.Instance;
if (null != e && null != e.brokeActiveData) {
var t = "", o = "", a = u.PopZindex.Alert;
if (null != e.brokeActiveData.monthlyCardInfo) {
t = n.BundleUIPath.BrokeMonthCard;
o = "BrokeMonthCard";
} else if (null != e.brokeActiveData.bankruptcyInfo && e.brokeActiveData.bankruptcyInfo.expire_time > 0) {
t = n.BundleUIPath.BrokeActive;
o = "BrokeActive";
} else {
t = n.BundleUIPath.GoldSliverCard;
o = "GoldSliverCard";
a = null;
}
r.default.Instance.addBundleMaskLayer(t, function(e) {
var t = e.getComponent(o);
(null == t ? void 0 : t.show) && t.show();
}, a);
}
};
e.prototype.openBrokeAlertAndRefreshData = function() {
var e = this;
g.ActiveProxy.Instance.sendGetBrokeActive(function() {
e.openBrokeAlert();
});
};
e.prototype.openRechargeAlert = function(e) {
var t = g.ActiveModel.Instance, o = null;
if (null != t) if (4 != e) {
if (5 == e) {
if (!t.rechargeLuckyActiveData || !t.rechargeLuckyActiveData.activeInfo) return;
o = t.rechargeLuckyActiveData;
}
r.default.Instance.addBundleMaskLayer(n.BundleUIPath.Recharge, function(e) {
e.getComponent(C.default).refresh(o);
}, u.PopZindex.Alert);
} else {
if (!t.rechargeSuperActiveData || !t.rechargeSuperActiveData.activeInfo) return;
o = t.rechargeSuperActiveData;
}
};
e.prototype.openSuperAlertAndRefreshData = function() {
this.openRechargeAlert(4);
};
e.prototype.openLuckyAlertAndRefreshData = function() {
this.openRechargeAlert(5);
};
e.prototype.checkOpenChairWithdraw = function() {
if (this.isOpenWithdraw) {
this.isOpenWithdraw = !1;
y.default.Instance.openWithdraw();
}
};
e.prototype.openOtherAmountView = function() {
e.Instance.checkSuperActive() ? e.Instance.openSuperAlertAndRefreshData() : 1 == p.default.checkSwitch(p.ClientSwitch.CLIENT_FUNC_SWITCH_MONTH_CARD) && s.default.getInstance().isCashGame && r.default.Instance.addBundleMaskLayer(n.BundleUIPath.MonthCard);
};
e._instance = null;
return e;
}();
o.default = b;
cc._RF.pop();
}, {
"../../../Game/Script/global/GlobalValue": "GlobalValue",
"../../../Game/client/global/enum/game/Const": "Const",
"../../../Game/client/global/enum/game/Event": "Event",
"../../../Game/fromework/helper/EventHelper": "EventHelper",
"../../../Game/fromework/helper/UIHelper": "UIHelper",
"../../../Game/fromework/mvvm/modelView/ViewModel": "ViewModel",
"../../component/WithdrawAlert": "WithdrawAlert",
"../../global/PopHelper": "PopHelper",
"../../model/MonthCardModel": "MonthCardModel",
"../../model/UserModel": "UserModel",
"../../model/WalletModel": "WalletModel",
"../Wallet/WalletHelper": "WalletHelper",
"../ui/MonthCard/MonthCardLobbyView": "MonthCardLobbyView",
"../ui/MonthCard/MonthCardUpdate": "MonthCardUpdate",
"../ui/Notice/Notice": "Notice",
"./ActiveModel": "ActiveModel",
"./FirstCharge/FirstCharge": "FirstCharge",
"./Recharge/RechagerActivity": "RechagerActivity"
} ],
ActiveModel: [ function(e, t, o) {
"use strict";
cc._RF.push(t, "0a146bP60xPP5/rzjsqFt2A", "ActiveModel");
Object.defineProperty(o, "__esModule", {
value: !0
});
o.ActiveProxy = o.ActiveModel = void 0;
var n = e("../../../Game/Script/global/GlobalValue"), a = e("../../../Game/client/global/enum/net/S2C"), i = e("../../../Game/fromework/helper/EventHelper"), r = e("../../../Game/fromework/mvvm/modelView/ViewModel"), l = e("../../../Game/fromework/net/NetHttp"), s = e("../../../platform/Platform"), c = e("../../global/PopHelper"), u = e("../../model/WalletModel"), d = e("../Wallet/WalletHelper"), p = e("./ActiveEvent"), h = e("./ActiveStruct"), f = function() {
function e() {
this.brokeActiveData = new h.ActiveStruct.BrokeActiveData();
this.rechargeSuperActiveData = new h.ActiveStruct.RechargeActiveData();
this.rechargeLuckyActiveData = new h.ActiveStruct.RechargeActiveData();
}
Object.defineProperty(e, "Instance", {
get: function() {
e._instance || (e._instance = new e());
return e._instance;
},
enumerable: !1,
configurable: !0
});
e._instance = null;
return e;
}();
o.ActiveModel = f;
var _ = function() {
function e() {
this._systemTipsData = null;
this._isOpenBrokeAlert = !1;
this.alreadyBuy = !1;
this.ExchangeData = null;
this.isOpenExchangeActive = !1;
}
Object.defineProperty(e, "Instance", {
get: function() {
e._instance || (e._instance = new e());
return e._instance;
},
enumerable: !1,
configurable: !0
});
Object.defineProperty(e.prototype, "systemTipsData", {
get: function() {
return this._systemTipsData;
},
set: function(e) {
this._systemTipsData = e;
},
enumerable: !1,
configurable: !0
});
Object.defineProperty(e.prototype, "isOpenBrokeAlert", {
get: function() {
return this._isOpenBrokeAlert;
},
set: function(e) {
this._isOpenBrokeAlert = e;
},
enumerable: !1,
configurable: !0
});
e.prototype.Init = function() {
i.default.Instance.Net.bind(a.S2C.GAME.ROOM_SYSTEM_TIPS, this._onSystemTips, this);
};
e.prototype.clear = function() {
i.default.Instance.Net.unbind(a.S2C.GAME.ROOM_SYSTEM_TIPS, this._onSystemTips, this);
};
Object.defineProperty(e.prototype, "uid", {
get: function() {
return r.VM.getValue("user.uid");
},
enumerable: !1,
configurable: !0
});
Object.defineProperty(e.prototype, "token", {
get: function() {
return r.VM.getValue("user.token");
},
enumerable: !1,
configurable: !0
});
e.prototype._onSystemTips = function(e) {
var t = e.getUserData();
1 == t.type && (this._systemTipsData = t);
if (2 == t.type) {
this.isOpenBrokeAlert = !0;
this.sendGetBrokeActive();
}
};
e.prototype.sendGetBrokeActive = function(e) {
l.default.Instance.post(n.default.getInstance().WalletUrl + "bankruptcy", {
player_index: this.uid,
token: this.token
}, function(t) {
var o = JSON.parse(t.response);
if (1 == o.code) {
f.Instance.brokeActiveData.refresh(o.data);
i.default.Instance.Global.emit(p.BrokeEvent.BROKE_GET_BROKE_DATA);
e && e();
}
}, !0);
};
e.prototype.sendGetRechargeSuperActiveInfo = function(e) {
l.default.Instance.get(n.default.getInstance().WalletUrl + "rechargeActiveOpt", {
opt: 1,
player_index: this.uid,
token: this.token,
active_type: 4
}, function(t) {
var o = JSON.parse(t.response);
if (1 == o.code) {
f.Instance.rechargeSuperActiveData.refresh(o.data);
i.default.Instance.Global.emit(p.RechargeSuperEvent.RECHARGE_GET_SUPER_DATA, f.Instance.rechargeSuperActiveData);
e && e();
}
}, !0);
};
e.prototype.sendReceiveRechargeSuperActive = function(e) {
l.default.Instance.get(n.default.getInstance().WalletUrl + "rechargeActiveOpt", {
opt: 2,
player_index: this.uid,
token: this.token,
active_type: 4
}, function(t) {
var o = JSON.parse(t.response);
if (1 == o.code) {
f.Instance.rechargeSuperActiveData.refresh(o.data);
i.default.Instance.Global.emit(p.RechargeSuperEvent.RECHARGE_GET_SUPER_RECEIVE, f.Instance.rechargeSuperActiveData);
e && e();
}
}, !0);
};
e.prototype.sendPayRechargeSuperActive = function(e) {
l.default.Instance.get(n.default.getInstance().WalletUrl + "rechargeActiveOpt", {
opt: 3,
player_index: this.uid,
token: this.token,
active_type: 4
}, function(t) {
var o = JSON.parse(t.response);
if (1 == o.code) {
i.default.Instance.Global.emit(p.RechargeSuperEvent.RECHARGE_GET_SUPER_PAY, o.data);
d.default.Instance.onPayment(o);
e && e();
}
}, !0);
};
e.prototype.sendGetRechargeLuckyActiveInfo = function(e) {
l.default.Instance.get(n.default.getInstance().WalletUrl + "rechargeActiveOpt", {
opt: 1,
player_index: this.uid,
token: this.token,
active_type: 5
}, function(t) {
var o = JSON.parse(t.response);
if (1 == o.code) {
f.Instance.rechargeLuckyActiveData.refresh(o.data);
i.default.Instance.Global.emit(p.RechargeLuckyEvent.RECHARGE_GET_LUCKY_DATA, f.Instance.rechargeLuckyActiveData);
e && e();
}
}, !0);
};
e.prototype.sendPayRechargeLuckyActive = function(e) {
l.default.Instance.get(n.default.getInstance().WalletUrl + "rechargeActiveOpt", {
opt: 3,
player_index: this.uid,
token: this.token,
active_type: 5
}, function(t) {
var o = JSON.parse(t.response);
if (1 == o.code) {
i.default.Instance.Global.emit(p.RechargeLuckyEvent.RECHARGE_GET_LUCKY_PAY, o.data);
d.default.Instance.onPayment(o);
e && e();
}
}, !0);
};
e.prototype.sendPayRechargeFirstRecharge = function(e, t) {
l.default.Instance.get(n.default.getInstance().WalletUrl + "rechargeActiveOpt", {
opt: 3,
player_index: this.uid,
token: this.token,
active_type: e
}, function(e) {
var o = JSON.parse(e.response);
if (1 == o.code) {
i.default.Instance.Global.emit(p.RechargeSuperEvent.RECHARGE_GET_SUPER_PAY, o.data);
d.default.Instance.onPayment(o);
t && t();
}
}, !0);
};
e.prototype.getRechargeAlertActiv = function(e) {
l.default.Instance.get(n.default.getInstance().WalletUrl + "rechargeActiveOpt", {
opt: 1,
player_index: this.uid,
token: this.token,
active_type: 8,
active_id: 2
}, function(t) {
var o = JSON.parse(t.response);
1 == o.code && e && e(o.data);
}, !0);
};
e.prototype.sendRechargeAlertActiv = function(e, t) {
l.default.Instance.get(n.default.getInstance().WalletUrl + "rechargeActiveOpt", {
opt: 3,
player_index: this.uid,
token: this.token,
active_type: e,
active_id: 2
}, function(e) {
var o = JSON.parse(e.response);
if (1 == o.code) {
d.default.Instance.onPayment(o);
t && t(o.data);
}
}, !0);
};
e.prototype.getRechargeBonus = function(e, t) {
l.default.Instance.get(n.default.getInstance().WalletUrl + "rechargeActiveOpt", {
opt: 1,
player_index: this.uid,
token: this.token,
active_type: 9,
active_id: e
}, function(e) {
var o = JSON.parse(e.response);
1 == o.code && t && t(o.data);
}, !0);
};
e.prototype.sendRechargeBonus = function(e, t, o) {
l.default.Instance.get(n.default.getInstance().WalletUrl + "rechargeActiveOpt", {
opt: 3,
player_index: this.uid,
token: this.token,
active_type: e,
active_id: t
}, function(e) {
var t = JSON.parse(e.response);
if (1 == t.code) {
d.default.Instance.onPayment(t);
o && o(t.data);
}
}, !0);
};
e.prototype.getRechargeBonusNew = function(e, t) {
var o = this;
l.default.Instance.get(n.default.getInstance().WalletUrl + "rechargeActiveOpt", {
opt: 5,
player_index: this.uid,
token: this.token,
active_type: 9,
active_id: e
}, function(e) {
var n, a = JSON.parse(e.response);
if (1 == a.code) {
o.alreadyBuy = 1 === (null === (n = null == a ? void 0 : a.data) || void 0 === n ? void 0 : n.alreadyBuy);
t && t(a.data);
}
}, !0);
};
e.prototype.getExchangeData = function(e, t, o) {
var a = this;
l.default.Instance.get(n.default.getInstance().WalletUrl + "exchageInfo", {
player_index: this.uid,
token: this.token,
type: e,
exchangeAmont: t
}, function(e) {
var t = JSON.parse(e.response);
if (1 == t.code) {
o && o(t.data);
a.ExchangeData = t.data;
a.isOpenExchangeActive = !0;
i.default.Instance.Global.emit("referExchangeRed");
} else if (0 == t.code) {
a.isOpenExchangeActive = !1;
a.ExchangeData = null;
}
}, !0);
};
e.prototype.withdrawExchange = function(e, t, o) {
l.default.Instance.get(n.default.getInstance().WalletUrl + "withdrawalExchage", {
player_index: this.uid,
token: this.token,
type: e,
exchangeAmont: t
}, function(e) {
var t = JSON.parse(e.response);
if (1 == t.code) {
o && o(t.data);
u.WalletProxy.Instance.sendGetUserWallet();
} else t.msg && c.PopHelper.Instance.showTips(t.msg);
}, !0);
};
e.prototype.receiveExchageActive = function(e, t) {
l.default.Instance.get(n.default.getInstance().WalletUrl + "receiveExchageActived", {
player_index: this.uid,
token: this.token,
level: e
}, function(e) {
var o = JSON.parse(e.response);
if (1 == o.code) {
t && t(o.data);
u.WalletProxy.Instance.sendGetUserWallet();
}
}, !0);
};
e.prototype.getKongQueKaData = function(e) {
l.default.Instance.get(n.default.getInstance().WalletUrl + "rechargeActiveOpt", {
opt: 1,
player_index: this.uid,
token: this.token,
active_type: 11
}, function(t) {
var o = JSON.parse(t.response);
1 == o.code && e && e(o.data);
}, !0);
};
e.prototype.BuyKongQueKaData = function(e, t, o, a) {
l.default.Instance.get(n.default.getInstance().WalletUrl + "rechargeActiveOpt", {
opt: 3,
player_index: this.uid,
token: this.token,
active_type: 11,
active_id: e,
buy_count: t,
number: o
}, function(e) {
var t = JSON.parse(e.response);
if (1 == t.code) {
d.default.Instance.onPayment(t);
a && a(t.data);
}
}, !0);
};
e.prototype.ReceiveKongQueKaData = function(e) {
l.default.Instance.get(n.default.getInstance().WalletUrl + "rechargeActiveOpt", {
opt: 2,
player_index: this.uid,
token: this.token,
active_type: 11
}, function(t) {
var o = JSON.parse(t.response);
1 == o.code ? e && e(o.data) : -1 == o.code && c.PopHelper.Instance.showTips(o.data.msg);
}, !0);
};
e.prototype.getThirtyDayData = function(e) {
l.default.Instance.get(n.default.getInstance().WalletUrl + "rechargeActiveOpt", {
opt: 1,
player_index: this.uid,
token: this.token,
active_type: 12,
package: s.default.getPackageName()
}, function(t) {
var o = JSON.parse(t.response);
1 == o.code && e && e(o.data);
}, !0);
};
e.prototype.ReceiveThirtyDayData = function(e) {
l.default.Instance.get(n.default.getInstance().WalletUrl + "rechargeActiveOpt", {
opt: 2,
player_index: this.uid,
token: this.token,
active_type: 12
}, function(t) {
var o = JSON.parse(t.response);
1 == o.code ? e && e(o.data) : -1 == o.code && c.PopHelper.Instance.showTips(o.data.msg);
}, !0);
};
e.prototype.BuyThirtyDayData = function(e) {
l.default.Instance.get(n.default.getInstance().WalletUrl + "rechargeActiveOpt", {
opt: 3,
player_index: this.uid,
token: this.token,
active_type: 12
}, function(t) {
var o = JSON.parse(t.response);
if (1 == o.code) {
d.default.Instance.onPayment(o);
e && e(o.data);
} else c.PopHelper.Instance.showTips("aready buy");
}, !0);
};
e.prototype.getBetBoxData = function(e) {
l.default.Instance.get(n.default.getInstance().WalletUrl + "rechargeActiveOpt", {
opt: 1,
player_index: this.uid,
token: this.token,
active_type: 10
}, function(t) {
var o = JSON.parse(t.response);
1 == o.code && e && e(o.data);
}, !0);
};
e.prototype.getBuyedBetBoxData = function(e) {
l.default.Instance.get(n.default.getInstance().WalletUrl + "rechargeActiveOpt", {
opt: 5,
player_index: this.uid,
token: this.token,
active_type: 10
}, function(t) {
var o = JSON.parse(t.response);
1 == o.code && e && e(o.data);
}, !0);
};
e.prototype.getBetBoxAward = function(e, t) {
l.default.Instance.get(n.default.getInstance().WalletUrl + "rechargeActiveOpt", {
opt: 2,
player_index: this.uid,
token: this.token,
active_type: 10,
active_id: e
}, function(e) {
var o = JSON.parse(e.response);
1 == o.code ? t && t(o.data) : -1 == o.code && c.PopHelper.Instance.showTips(o.data.msg);
}, !0);
};
e.prototype.getBetBoxReturnAward = function(e) {
l.default.Instance.get(n.default.getInstance().WalletUrl + "rechargeActiveOpt", {
opt: 2,
player_index: this.uid,
token: this.token,
active_type: 10
}, function(t) {
var o = JSON.parse(t.response);
1 == o.code ? e && e(o.data) : -1 == o.code && c.PopHelper.Instance.showTips(o.data.msg);
}, !0);
};
e.prototype.buyBetBox = function(e, t, o) {
l.default.Instance.get(n.default.getInstance().WalletUrl + "rechargeActiveOpt", {
opt: 3,
player_index: this.uid,
token: this.token,
active_type: 10,
active_id: e,
buy_count: t
}, function(e) {
var t = JSON.parse(e.response);
if (1 == t.code) {
d.default.Instance.onPayment(t);
o && o(t.data);
}
}, !0);
};
e.prototype.historyBetBox = function(e) {
l.default.Instance.get(n.default.getInstance().WalletUrl + "rechargeActiveOpt", {
opt: 6,
player_index: this.uid,
token: this.token,
active_type: 10
}, function(t) {
var o = JSON.parse(t.response);
1 == o.code && e && e(o.data);
}, !0);
};
e.prototype.getReferEarnData = function(e) {
l.default.Instance.get(n.default.getInstance().WalletUrl + "referralsDashboard", {
uid: this.uid
}, function(t) {
var o = JSON.parse(t.response);
1 == o.code && e && e(o.data);
}, !0);
};
e.prototype.getReferEarnListData = function(e, t, o) {
l.default.Instance.get(n.default.getInstance().WalletUrl + "referralsList", {
uid: this.uid,
page_num: e,
page_size: t
}, function(e) {
var t = JSON.parse(e.response);
1 == t.code && o && o(t.data);
}, !0);
};
e.prototype.getReferralsRewardData = function(e) {
l.default.Instance.get(n.default.getInstance().WalletUrl + "referralsReward", {
uid: this.uid
}, function(t) {
var o = JSON.parse(t.response);
1 == o.code && e && e(o.data);
}, !0);
};
e._instance = null;
return e;
}();
o.ActiveProxy = _;
cc._RF.pop();
}, {
"../../../Game/Script/global/GlobalValue": "GlobalValue",
"../../../Game/client/global/enum/net/S2C": "S2C",
"../../../Game/fromework/helper/EventHelper": "EventHelper",
"../../../Game/fromework/mvvm/modelView/ViewModel": "ViewModel",
"../../../Game/fromework/net/NetHttp": "NetHttp",
"../../../platform/Platform": "Platform",
"../../global/PopHelper": "PopHelper",
"../../model/WalletModel": "WalletModel",
"../Wallet/WalletHelper": "WalletHelper",
"./ActiveEvent": "ActiveEvent",
"./ActiveStruct": "ActiveStruct"
} ],
ActiveStruct: [ function(e, t, o) {
"use strict";
cc._RF.push(t, "ea2faww31hN2IgtjzgBcmmU", "ActiveStruct");
Object.defineProperty(o, "__esModule", {
value: !0
});
o.ActiveStruct = void 0;
var n = e("../../../Game/fromework/global/Tools");
(function(e) {
var t = function() {
function e(e) {
this.recommend_gear_amount = 0;
e && this.refresh(e);
}
e.prototype.refresh = function(e) {
null != e.bankruptcy_info && null != e.bankruptcy_info.pay_amount_qf ? this.bankruptcyInfo = {
pay_amount_qf: n.Tools.TNumber.num2single(parseFloat(e.bankruptcy_info.pay_amount_qf)),
deposit_amount_qf: n.Tools.TNumber.num2single(parseFloat(e.bankruptcy_info.deposit_amount_qf)),
bouns_amount_qf: n.Tools.TNumber.num2single(parseFloat(e.bankruptcy_info.bouns_amount_qf)),
expire_time: e.bankruptcy_info.expire_time
} : this.bankruptcyInfo = null;
null != e.monthly_card_info && null != e.monthly_card_info.deposit ? this.monthlyCardInfo = {
deposit: n.Tools.TNumber.num2single(parseFloat(e.monthly_card_info.deposit)),
bonus: n.Tools.TNumber.num2single(parseFloat(e.monthly_card_info.bonus)),
cnt: n.Tools.TNumber.num2single(parseFloat(e.monthly_card_info.cnt))
} : this.monthlyCardInfo = null;
this.recommend_gear_amount = n.Tools.TNumber.num2single(e.recommend_gear_amount);
};
return e;
}();
e.BrokeActiveData = t;
var o = function() {
function e(e) {
this.activeInfo = null;
this.activeInfo = null;
e && this.refresh(e);
}
e.prototype.refresh = function(e) {
if (!e.activeInfo || Array.isArray(e.activeInfo) && e.activeInfo.length <= 0) this.activeInfo = null; else {
var t = e.activeInfo, o = [];
if (t.reward && t.reward.length > 0) for (var n = 0; n < t.reward.length; ++n) {
var a = t.reward[n];
o.push({
deposit: a.currey_qf[1],
bonus: a.currey_qf[4],
receive_stat: a.receive_stat,
receive_time: a.receive_time
});
}
this.activeInfo = {
active_type: t.active_type,
active_status: t.active_status,
end_time: t.end_time,
pay_qf: t.pay_qf,
price_qf: t.price_qf,
reward: o
};
}
};
return e;
}();
e.RechargeActiveData = o;
})(o.ActiveStruct || (o.ActiveStruct = {}));
cc._RF.pop();
}, {
"../../../Game/fromework/global/Tools": "Tools"
} ],
ActivityItem: [ function(e, t, o) {
"use strict";
cc._RF.push(t, "63806Q4JyJMLIIdj5E9QD3R", "ActivityItem");
var n, a = this && this.__extends || (n = function(e, t) {
return (n = Object.setPrototypeOf || {
__proto__: []
} instanceof Array && function(e, t) {
e.__proto__ = t;
} || function(e, t) {
for (var o in t) Object.prototype.hasOwnProperty.call(t, o) && (e[o] = t[o]);
})(e, t);
}, function(e, t) {
n(e, t);
function o() {
this.constructor = e;
}
e.prototype = null === t ? Object.create(t) : (o.prototype = t.prototype, new o());
}), i = this && this.__decorate || function(e, t, o, n) {
var a, i = arguments.length, r = i < 3 ? t : null === n ? n = Object.getOwnPropertyDescriptor(t, o) : n;
if ("object" == typeof Reflect && "function" == typeof Reflect.decorate) r = Reflect.decorate(e, t, o, n); else for (var l = e.length - 1; l >= 0; l--) (a = e[l]) && (r = (i < 3 ? a(r) : i > 3 ? a(t, o, r) : a(t, o)) || r);
return i > 3 && r && Object.defineProperty(t, o, r), r;
};
Object.defineProperty(o, "__esModule", {
value: !0
});
var r = e("../../../../Game/client/global/enum/game/Event"), l = e("../../../../Game/client/global/enum/game/Game"), s = e("../../../../Game/client/model/LanguageModel"), c = e("../../../../Game/fromework/global/Tools"), u = e("../../../../Game/fromework/helper/EventHelper"), d = e("../../../component/RedDot"), p = e("../../../model/RedDotModel"), h = cc._decorator, f = h.ccclass, _ = h.property, m = function(e) {
a(t, e);
function t() {
var t = null !== e && e.apply(this, arguments) || this;
t.Background = null;
t.Title = null;
t.Time = null;
t.Provision = null;
t.Parent = null;
t.Item = null;
t.RedDot = null;
t.Frames_Back = [];
t._data = null;
t._index = -1;
return t;
}
t.prototype.onItemInitCallFunc = function(e, t) {
this._data = e;
this._index = t;
this._data && this.RedDot.setBindKeys([ l.GameEnum.RedDotKey.RechargeActivity + this._data.id ]);
this.Background.spriteFrame = this.Frames_Back[this._data.isSelect ? 0 : 1];
this.Title.string = this._data.title;
var o = c.Tools.TDate.second2Day(this._data.end_time - this._data.now_time), n = c.Tools.TStr.replaceString(s.default.getString("COMMON_SURPLUS_TIME"), o);
this.Time.string = c.Tools.TStr.replaceAll(s.default.getString("ADD_EX"), "%{num}", n);
this.Parent.destroyAllChildren();
for (var a = this._data.table ? this._data.table : [], i = 1; i < a.length; i++) {
var r = a[i], u = cc.instantiate(this.Item);
u.active = !0;
u.setPosition(cc.Vec2.ZERO);
u.parent = this.Parent;
var d = u.getChildByName("AddCash").getComponent(cc.Label);
d && (d.string = r[0] ? r[0] : "");
var p = u.getChildByName("CashBack").getComponent(cc.Label);
p && (p.string = r[1] && "" != r[1] ? r[1] : "");
var h = u.getChildByName("Bonus").getComponent(cc.Label);
h && (h.string = r[2] && "" != r[2] ? r[2] : "");
}
this.Provision.string = this._data.provision;
};
t.prototype.onItemEnterCallFunc = function() {
this.node.opacity = 255;
};
t.prototype.onItemExitCallFunc = function() {
this.node.opacity = 0;
};
t.prototype.onJoinClicked = function() {
p.default.Instance.delRechargeRedDot(this._data);
u.default.Instance.Global.emit(r.WalletEvent.ACTIVITY_SELECT, this._data);
};
i([ _(cc.Sprite) ], t.prototype, "Background", void 0);
i([ _(cc.Label) ], t.prototype, "Title", void 0);
i([ _(cc.Label) ], t.prototype, "Time", void 0);
i([ _(cc.Label) ], t.prototype, "Provision", void 0);
i([ _(cc.Node) ], t.prototype, "Parent", void 0);
i([ _(cc.Node) ], t.prototype, "Item", void 0);
i([ _(d.default) ], t.prototype, "RedDot", void 0);
i([ _([ cc.SpriteFrame ]) ], t.prototype, "Frames_Back", void 0);
return i([ f ], t);
}(cc.Component);
o.default = m;
cc._RF.pop();
}, {
"../../../../Game/client/global/enum/game/Event": "Event",
"../../../../Game/client/global/enum/game/Game": "Game",
"../../../../Game/client/model/LanguageModel": "LanguageModel",
"../../../../Game/fromework/global/Tools": "Tools",
"../../../../Game/fromework/helper/EventHelper": "EventHelper",
"../../../component/RedDot": "RedDot",
"../../../model/RedDotModel": "RedDotModel"
} ],
Activity: [ function(e, t, o) {
"use strict";
cc._RF.push(t, "44685J560ZBG4CEPJHxqsPz", "Activity");
var n, a = this && this.__extends || (n = function(e, t) {
return (n = Object.setPrototypeOf || {
__proto__: []
} instanceof Array && function(e, t) {
e.__proto__ = t;
} || function(e, t) {
for (var o in t) Object.prototype.hasOwnProperty.call(t, o) && (e[o] = t[o]);
})(e, t);
}, function(e, t) {
n(e, t);
function o() {
this.constructor = e;
}
e.prototype = null === t ? Object.create(t) : (o.prototype = t.prototype, new o());
}), i = this && this.__decorate || function(e, t, o, n) {
var a, i = arguments.length, r = i < 3 ? t : null === n ? n = Object.getOwnPropertyDescriptor(t, o) : n;
if ("object" == typeof Reflect && "function" == typeof Reflect.decorate) r = Reflect.decorate(e, t, o, n); else for (var l = e.length - 1; l >= 0; l--) (a = e[l]) && (r = (i < 3 ? a(r) : i > 3 ? a(t, o, r) : a(t, o)) || r);
return i > 3 && r && Object.defineProperty(t, o, r), r;
};
Object.defineProperty(o, "__esModule", {
value: !0
});
var r = e("../../../../Game/client/global/enum/game/Event"), l = e("../../../../Game/fromework/helper/EventHelper"), s = e("../../../../Game/fromework/helper/UIHelper"), c = e("../../../../fromework/component/listView/ListView"), u = e("../../../model/WalletModel"), d = cc._decorator, p = d.ccclass, h = d.property, f = function(e) {
a(t, e);
function t() {
var t = null !== e && e.apply(this, arguments) || this;
t.List = null;
t.Content = null;
t._selectID = 0;
return t;
}
t.prototype.onEnable = function() {
l.default.Instance.Global.bind(r.WalletEvent.ACTIVITY_SELECT, this.onCloseClicked, this);
};
t.prototype.onDisable = function() {
l.default.Instance.Global.unbind(r.WalletEvent.ACTIVITY_SELECT, this.onCloseClicked, this);
};
t.prototype.InitView = function(e) {
this._selectID = e || 0;
this.initActivity();
};
t.prototype.initActivity = function() {
for (var e = this, t = [], o = 0; o < u.WalletProxy.Instance.activityList.length; o++) 7 != u.WalletProxy.Instance.activityList[o].type && t.push(u.WalletProxy.Instance.activityList[o]);
t.forEach(function(t) {
t.isSelect = t.id == e._selectID;
});
this.List.datas = t;
this.scheduleOnce(function() {
if (t.length > 3) {
e.Content.setAnchorPoint(cc.v2(0, .5));
e.Content.setPosition(cc.v2(-e.Content.parent.width / 2, 0));
} else {
e.Content.setAnchorPoint(cc.v2(.5, .5));
e.Content.setPosition(cc.Vec2.ZERO);
}
});
};
t.prototype.onCloseClicked = function() {
s.default.Instance.removeMaskLayer(this.node);
};
i([ h(c.default) ], t.prototype, "List", void 0);
i([ h(cc.Node) ], t.prototype, "Content", void 0);
return i([ p ], t);
}(cc.Component);
o.default = f;
cc._RF.pop();
}, {
"../../../../Game/client/global/enum/game/Event": "Event",
"../../../../Game/fromework/helper/EventHelper": "EventHelper",
"../../../../Game/fromework/helper/UIHelper": "UIHelper",
"../../../../fromework/component/listView/ListView": "ListView",
"../../../model/WalletModel": "WalletModel"
} ],
AddCashActItem: [ function(e, t, o) {
"use strict";
cc._RF.push(t, "d42e0vtZjlM3o3woMhGJ7iM", "AddCashActItem");
var n, a = this && this.__extends || (n = function(e, t) {
return (n = Object.setPrototypeOf || {
__proto__: []
} instanceof Array && function(e, t) {
e.__proto__ = t;
} || function(e, t) {
for (var o in t) Object.prototype.hasOwnProperty.call(t, o) && (e[o] = t[o]);
})(e, t);
}, function(e, t) {
n(e, t);
function o() {
this.constructor = e;
}
e.prototype = null === t ? Object.create(t) : (o.prototype = t.prototype, new o());
}), i = this && this.__decorate || function(e, t, o, n) {
var a, i = arguments.length, r = i < 3 ? t : null === n ? n = Object.getOwnPropertyDescriptor(t, o) : n;
if ("object" == typeof Reflect && "function" == typeof Reflect.decorate) r = Reflect.decorate(e, t, o, n); else for (var l = e.length - 1; l >= 0; l--) (a = e[l]) && (r = (i < 3 ? a(r) : i > 3 ? a(t, o, r) : a(t, o)) || r);
return i > 3 && r && Object.defineProperty(t, o, r), r;
};
Object.defineProperty(o, "__esModule", {
value: !0
});
var r = e("../../../global/PopHelper"), l = e("../../../../Game/client/global/enum/game/Const"), s = e("../../../../Game/client/model/LanguageModel"), c = e("../../../../Game/fromework/global/Tools"), u = e("../../../../Game/fromework/helper/UIHelper"), d = e("../../../model/MonthCardModel"), p = e("../../../model/UserModel"), h = e("../../active/ActiveManager"), f = e("../../active/ActiveModel"), _ = e("../MonthCard/MonthCard"), m = e("../../../../Game/fromework/helper/EventHelper"), y = e("../../../../Game/client/global/enum/game/Event"), g = e("../../Wallet/WalletHelper"), v = e("../../../global/Global"), C = cc._decorator, b = C.ccclass, I = C.property, E = function(e) {
a(t, e);
function t() {
var t = null !== e && e.apply(this, arguments) || this;
t.InfoNode = null;
t.Mask = null;
t.Rate = null;
t.Icon = null;
t.Bonus = null;
t.BonusLabel = null;
t.Deposite = null;
t.DepositeLabel = null;
t.Pay = null;
t.Frames_Icon = [];
t._index = 0;
t._data = null;
t._data2 = null;
t.autoSelect = !0;
return t;
}
t.prototype.refreshSuperDeal = function(e) {
this._index = e;
this.Icon.spriteFrame = this.Frames_Icon[0];
if (h.default.Instance.checkSuperActive()) {
this.Mask.active = !1;
this.InfoNode.active = !0;
this.Pay.node.active = !1;
var t = f.ActiveModel.Instance.rechargeSuperActiveData;
this._data = t;
for (var o = 0, n = 0, a = c.Tools.TNumber.num2single(t.activeInfo.pay_qf), i = 0; i < t.activeInfo.reward.length; i++) {
o += t.activeInfo.reward[i].bonus;
n += t.activeInfo.reward[i].deposit;
}
o = c.Tools.TNumber.num2single(o);
n = c.Tools.TNumber.num2single(n);
var r = Math.ceil((o + n) / a * 100);
this.Rate.string = "+" + r + "%";
this.Bonus.active = o > 0;
this.BonusLabel.string = o.toString();
this.Deposite.active = n > 0;
this.DepositeLabel.string = n.toString();
this.Pay.node.active = !1;
this.Pay.string = s.default.getString("MoneySymbol") + a;
this._data2 = {
cash: a.toString(),
extarCash: "0",
bonus: o.toString(),
total: n.toString(),
price: a.toString()
};
if (this.autoSelect && a === v.Global.Instance.selectAddCashPrice) {
this.autoSelect = !1;
this.onItemClicked();
}
} else {
this.Mask.active = !0;
this.InfoNode.active = !1;
this.Pay.string = "200";
this.Pay.node.active = !0;
}
};
t.prototype.refreshMonthCard = function(e) {
this._index = e;
this.Icon.spriteFrame = this.Frames_Icon[e];
if (0 != p.default.checkSwitch(p.ClientSwitch.CLIENT_FUNC_SWITCH_MONTH_CARD)) {
this.Mask.active = !1;
this.InfoNode.active = !0;
var t = d.MonthCardProxy.Instance.getMonthCardByIndex(e - 1);
this._data = t;
var o = t.bonus + t.day_bonus * t.day, n = t.deposit + t.day_deposit * t.day, a = Math.ceil((o + n) / t.price * 100);
this.Rate.string = "+" + a + "%";
this.Bonus.active = o > 0;
this.BonusLabel.string = o.toString();
this.Deposite.active = n > 0;
this.DepositeLabel.string = n.toString();
this.Pay.string = s.default.getString("MoneySymbol") + t.price;
this._data2 = {
cash: t.deposit.toString(),
extarCash: t.day_deposit + "x" + t.day,
bonus: o,
total: (n + o).toString(),
price: t.price.toString()
};
if (this.autoSelect && t.price === v.Global.Instance.selectAddCashPrice) {
this.autoSelect = !1;
this.onItemClicked();
}
} else {
this.Mask.active = !0;
this.InfoNode.active = !1;
}
};
t.prototype.onItemClicked = function() {
var e = this;
0 == this._index ? h.default.Instance.checkSuperActive() ? m.default.Instance.Global.emit(y.WalletEvent.ADDCASH_ITEM_ONLY_CLICKED, [ this._data2, this.node, function() {
h.default.Instance.openSuperAlertAndRefreshData();
} ]) : r.PopHelper.Instance.showTips(s.default.getString("ADDCASH_PROMOTIONS_SUPER")) : 0 == p.default.checkSwitch(p.ClientSwitch.CLIENT_FUNC_SWITCH_MONTH_CARD) ? r.PopHelper.Instance.showTips(s.default.getString("ADDCASH_PROMOTIONS_MONTHCARD")) : 1 == this._data.card_status && this._data.remaining_days > this._data.renew_num ? u.default.Instance.addBundleMaskLayer(l.BundleUIPath.MonthCard, function(t) {
t.getComponent(_.default).refreshSelect(e._index - 1);
}) : m.default.Instance.Global.emit(y.WalletEvent.ADDCASH_ITEM_ONLY_CLICKED, [ this._data2, this.node, function() {
g.default.Instance.openRechargeView(function() {}, e._data.price, 0, e._data.id);
} ]);
};
i([ I(cc.Node) ], t.prototype, "InfoNode", void 0);
i([ I(cc.Node) ], t.prototype, "Mask", void 0);
i([ I(cc.Label) ], t.prototype, "Rate", void 0);
i([ I(cc.Sprite) ], t.prototype, "Icon", void 0);
i([ I(cc.Node) ], t.prototype, "Bonus", void 0);
i([ I(cc.Label) ], t.prototype, "BonusLabel", void 0);
i([ I(cc.Node) ], t.prototype, "Deposite", void 0);
i([ I(cc.Label) ], t.prototype, "DepositeLabel", void 0);
i([ I(cc.Label) ], t.prototype, "Pay", void 0);
i([ I([ cc.SpriteFrame ]) ], t.prototype, "Frames_Icon", void 0);
return i([ b ], t);
}(cc.Component);
o.default = E;
cc._RF.pop();
}, {
"../../../../Game/client/global/enum/game/Const": "Const",
"../../../../Game/client/global/enum/game/Event": "Event",
"../../../../Game/client/model/LanguageModel": "LanguageModel",
"../../../../Game/fromework/global/Tools": "Tools",
"../../../../Game/fromework/helper/EventHelper": "EventHelper",
"../../../../Game/fromework/helper/UIHelper": "UIHelper",
"../../../global/Global": "Global",
"../../../global/PopHelper": "PopHelper",
"../../../model/MonthCardModel": "MonthCardModel",
"../../../model/UserModel": "UserModel",
"../../Wallet/WalletHelper": "WalletHelper",
"../../active/ActiveManager": "ActiveManager",
"../../active/ActiveModel": "ActiveModel",
"../MonthCard/MonthCard": "MonthCard"
} ],
AddCashActivity: [ function(e, t, o) {
"use strict";
cc._RF.push(t, "5ae49SBbv9IupySP7bpwqOP", "AddCashActivity");
var n, a = this && this.__extends || (n = function(e, t) {
return (n = Object.setPrototypeOf || {
__proto__: []
} instanceof Array && function(e, t) {
e.__proto__ = t;
} || function(e, t) {
for (var o in t) Object.prototype.hasOwnProperty.call(t, o) && (e[o] = t[o]);
})(e, t);
}, function(e, t) {
n(e, t);
function o() {
this.constructor = e;
}
e.prototype = null === t ? Object.create(t) : (o.prototype = t.prototype, new o());
}), i = this && this.__decorate || function(e, t, o, n) {
var a, i = arguments.length, r = i < 3 ? t : null === n ? n = Object.getOwnPropertyDescriptor(t, o) : n;
if ("object" == typeof Reflect && "function" == typeof Reflect.decorate) r = Reflect.decorate(e, t, o, n); else for (var l = e.length - 1; l >= 0; l--) (a = e[l]) && (r = (i < 3 ? a(r) : i > 3 ? a(t, o, r) : a(t, o)) || r);
return i > 3 && r && Object.defineProperty(t, o, r), r;
};
Object.defineProperty(o, "__esModule", {
value: !0
});
var r = cc._decorator, l = r.ccclass, s = r.property, c = e("../../../../Game/fromework/helper/UIHelper"), u = e("../../../../Game/client/global/enum/game/Const"), d = e("../../active/ActiveModel"), p = function(e) {
a(t, e);
function t() {
var t = null !== e && e.apply(this, arguments) || this;
t.firstNode = null;
t.noFirstNode = null;
t.buyToggle = null;
t.buyLabel = null;
t.buyNum = 0;
t.buyNoNum = 0;
t.buyData = null;
t._callFun = null;
t._actiType = 0;
return t;
}
t.prototype.start = function() {};
t.prototype.show = function(e, t, o, n) {
void 0 === n && (n = 0);
if (t && t.amount && e && e.pay_qf) {
this._actiType = n;
this.buyData = e;
this._callFun = o;
this.buyToggle.isChecked = !0;
this.firstNode.active = !0;
this.noFirstNode.active = !1;
var a = this.firstNode.getChildByName("LabelGet").getComponent(cc.Label), i = this.firstNode.getChildByName("LabelExtra").getComponent(cc.Label), r = this.firstNode.getChildByName("LabelBonus").getComponent(cc.Label);
a.string = u.MoneySymbol + String(e.pay_qf / 1e3);
i.string = u.MoneySymbol + String(e.reward[0].currey_qf[1] / 1e3 - e.pay_qf / 1e3);
r.string = u.MoneySymbol + String(e.reward[0].currey_qf[4] / 1e3);
this.buyLabel.string = u.MoneySymbol + String(e.pay_qf / 1e3);
var l = this.noFirstNode.getChildByName("LabelGet").getComponent(cc.Label), s = this.noFirstNode.getChildByName("LabelBonus").getComponent(cc.Label);
l.string = u.MoneySymbol + String(t.amount);
0 != t.bonus && (s.string = u.MoneySymbol + String(t.bonus));
this.buyNum = e.pay_qf / 1e3;
this.buyNoNum = t.amount;
} else c.default.Instance.removeMaskLayer(this.node);
};
t.prototype.onDestroy = function() {};
t.prototype.onToggleEventClick = function(e) {
if (e.isChecked) {
this.firstNode.active = !0;
this.noFirstNode.active = !1;
this.buyLabel.string = u.MoneySymbol + String(this.buyNum);
} else {
this.firstNode.active = !1;
this.noFirstNode.active = !0;
this.buyLabel.string = u.MoneySymbol + String(this.buyNoNum);
}
};
t.prototype.onCloseClick = function() {
c.default.Instance.removeMaskLayer(this.node);
};
t.prototype.onBuyClick = function() {
var e = this;
if (this.buyToggle.isChecked) 8 == this._actiType ? d.ActiveProxy.Instance.sendRechargeAlertActiv(this.buyData.active_type, function() {
c.default.Instance.removeMaskLayer(e.node);
}) : d.ActiveProxy.Instance.sendPayRechargeFirstRecharge(this.buyData.active_type, function() {
c.default.Instance.removeMaskLayer(e.node);
}); else {
this._callFun && null != this._callFun && this._callFun();
c.default.Instance.removeMaskLayer(this.node);
}
};
i([ s(cc.Node) ], t.prototype, "firstNode", void 0);
i([ s(cc.Node) ], t.prototype, "noFirstNode", void 0);
i([ s(cc.Toggle) ], t.prototype, "buyToggle", void 0);
i([ s(cc.Label) ], t.prototype, "buyLabel", void 0);
return i([ l ], t);
}(cc.Component);
o.default = p;
cc._RF.pop();
}, {
"../../../../Game/client/global/enum/game/Const": "Const",
"../../../../Game/fromework/helper/UIHelper": "UIHelper",
"../../active/ActiveModel": "ActiveModel"
} ],
AddCashEvent: [ function(e, t, o) {
"use strict";
cc._RF.push(t, "36d98MiB2ZPxbpM7mEjPCLs", "AddCashEvent");
Object.defineProperty(o, "__esModule", {
value: !0
});
o.AddCashS2C = o.AddCashEvent = void 0;
o.AddCashEvent = {
ADD_CASH: "ADD_CASH",
SHOW_HELP: "SHOW_HELP",
ADD_CASH_REDDOT: "ADD_CASH_REDDOT",
RECEIVE_VIP_GIFT: "RECEIVE_VIP_GIFT",
INIT_CONTENT: "INIT_CONTENT"
};
o.AddCashS2C = {
PUSH_VIP_UPGRADE: "S2C_User_push_vip_upgrade"
};
cc._RF.pop();
}, {} ],
AddCashItem: [ function(e, t, o) {
"use strict";
cc._RF.push(t, "3bfde2lgMFMt5jYuMqDoBBH", "AddCashItem");
var n, a = this && this.__extends || (n = function(e, t) {
return (n = Object.setPrototypeOf || {
__proto__: []
} instanceof Array && function(e, t) {
e.__proto__ = t;
} || function(e, t) {
for (var o in t) Object.prototype.hasOwnProperty.call(t, o) && (e[o] = t[o]);
})(e, t);
}, function(e, t) {
n(e, t);
function o() {
this.constructor = e;
}
e.prototype = null === t ? Object.create(t) : (o.prototype = t.prototype, new o());
}), i = this && this.__decorate || function(e, t, o, n) {
var a, i = arguments.length, r = i < 3 ? t : null === n ? n = Object.getOwnPropertyDescriptor(t, o) : n;
if ("object" == typeof Reflect && "function" == typeof Reflect.decorate) r = Reflect.decorate(e, t, o, n); else for (var l = e.length - 1; l >= 0; l--) (a = e[l]) && (r = (i < 3 ? a(r) : i > 3 ? a(t, o, r) : a(t, o)) || r);
return i > 3 && r && Object.defineProperty(t, o, r), r;
};
Object.defineProperty(o, "__esModule", {
value: !0
});
var r = e("../../../../Game/client/global/enum/game/Const"), l = e("../../../../Game/client/global/enum/game/Event"), s = e("../../../../Game/fromework/helper/EventHelper"), c = e("../../../model/WalletModel"), u = e("../../../../Game/fromework/helper/UIHelper"), d = e("../../../../Game/client/global/enum/game/Const"), p = e("./AddCashActivity"), h = e("../../../global/Global"), f = cc._decorator, _ = f.ccclass, m = f.property, y = function(e) {
a(t, e);
function t() {
var t = null !== e && e.apply(this, arguments) || this;
t.Icon = null;
t.Money = null;
t.Pay = null;
t.Title = null;
t.TitleCash = null;
t.TitleBonus = null;
t.Frames_Icon = [];
t._data = null;
t._index = -1;
t._data2 = null;
t.autoSelect = !0;
return t;
}
t.prototype.onItemInitCallFunc = function(e, t) {
this._data = e;
this._index = t;
this.Icon.spriteFrame = this.Frames_Icon[t < this.Frames_Icon.length ? t : this.Frames_Icon.length - 1];
this.Title.active = 0 != this._data.deposit || 0 != this._data.bonus;
this.TitleCash.node.parent.active = 0 != this._data.deposit;
this.TitleBonus.node.parent.active = 0 != this._data.bonus;
0 != this._data.deposit && (this.TitleCash.string = this._data.deposit + "");
0 != this._data.bonus && (this.TitleBonus.string = this._data.bonus + "");
this.Money.string = this._data.amount + "";
this.Pay.string = r.MoneySymbol + this._data.amount;
this._data2 = {
cash: this._data.amount.toString(),
extarCash: this._data.deposit.toString(),
bonus: this._data.bonus.toString(),
total: (this._data.amount + this._data.deposit + this._data.bonus).toString(),
price: this._data.amount.toString()
};
if (this.autoSelect && this._data.amount === h.Global.Instance.selectAddCashPrice) {
this.autoSelect = !1;
this.onCellClicked();
}
};
t.prototype.onItemEnterCallFunc = function() {
this.node.opacity = 255;
};
t.prototype.onItemExitCallFunc = function() {
this.node.opacity = 0;
};
t.prototype.onCellClicked = function() {
var e = this;
this._data && this._data.amount && 100 == this._data.amount && c.WalletProxy.Instance.firstRechargeInfo && null != c.WalletProxy.Instance.firstRechargeInfo ? u.default.Instance.addBundleMaskLayer(d.BundleUIPath.AddCashActivity, function(t) {
t.getComponent(p.default).show(c.WalletProxy.Instance.firstRechargeInfo, e._data, function() {
s.default.Instance.Global.emit(l.WalletEvent.ADDCASH_ITEM_ONLY_CLICKED, [ e._data2, e.node, function() {
s.default.Instance.Global.emit(l.WalletEvent.ADDCASH_ITEM_CLICKED, e._data);
} ]);
});
}) : s.default.Instance.Global.emit(l.WalletEvent.ADDCASH_ITEM_ONLY_CLICKED, [ this._data2, this.node, function() {
s.default.Instance.Global.emit(l.WalletEvent.ADDCASH_ITEM_CLICKED, e._data);
} ]);
};
i([ m(cc.Sprite) ], t.prototype, "Icon", void 0);
i([ m(cc.Label) ], t.prototype, "Money", void 0);
i([ m(cc.Label) ], t.prototype, "Pay", void 0);
i([ m(cc.Node) ], t.prototype, "Title", void 0);
i([ m(cc.Label) ], t.prototype, "TitleCash", void 0);
i([ m(cc.Label) ], t.prototype, "TitleBonus", void 0);
i([ m([ cc.SpriteFrame ]) ], t.prototype, "Frames_Icon", void 0);
return i([ _ ], t);
}(cc.Component);
o.default = y;
cc._RF.pop();
}, {
"../../../../Game/client/global/enum/game/Const": "Const",
"../../../../Game/client/global/enum/game/Event": "Event",
"../../../../Game/fromework/helper/EventHelper": "EventHelper",
"../../../../Game/fromework/helper/UIHelper": "UIHelper",
"../../../global/Global": "Global",
"../../../model/WalletModel": "WalletModel",
"./AddCashActivity": "AddCashActivity"
} ],
AddCashVIPModel: [ function(e, t, o) {
"use strict";
cc._RF.push(t, "6bcdbS1TkVDWqIJniSzGePM", "AddCashVIPModel");
Object.defineProperty(o, "__esModule", {
value: !0
});
o.AddCashVIPProxy = void 0;
var n = e("../../Game/fromework/helper/EventHelper"), a = e("../../Game/fromework/mvvm/modelView/ViewModel"), i = e("../../Game/fromework/net/NetHttp"), r = e("../../Game/Script/global/GlobalValue"), l = e("../../platform/Platform"), s = e("../logic/ui/AddCashVIP/AddCashEvent"), c = function() {
function e() {
this.vipInfo = null;
}
Object.defineProperty(e, "Instance", {
get: function() {
e._instance || (e._instance = new e());
return e._instance;
},
enumerable: !1,
configurable: !0
});
e.prototype.Init = function() {
n.default.Instance.Net.bind(s.AddCashS2C.PUSH_VIP_UPGRADE, this._onPushVIPUpgrade, this);
};
e.prototype.clear = function() {
n.default.Instance.Net.unbind(s.AddCashS2C.PUSH_VIP_UPGRADE, this._onPushVIPUpgrade, this);
};
e.prototype.getVipInfo = function(e, t) {
var o = this;
void 0 === e && (e = null);
void 0 === t && (t = 0);
i.default.Instance.get(r.default.getInstance().WalletUrl + "vipInfo", {
player_index: a.VM.getValue("user.uid"),
token: a.VM.getValue("user.token"),
auto_receive: t
}, function(t) {
o.onVipInfo(t, e);
}, !0);
};
e.prototype.receiveVipGift = function(e, t) {
var o = this;
void 0 === t && (t = null);
i.default.Instance.get(r.default.getInstance().WalletUrl + "receiveVipGift", {
player_index: a.VM.getValue("user.uid"),
token: a.VM.getValue("user.token"),
gift_type: e
}, function(e) {
o.onReceiveVipGift(e, t);
}, !0);
};
e.prototype.onVipInfo = function(e, t) {
void 0 === t && (t = null);
var o = JSON.parse(e.response);
l.default.log("onVipInfo", o);
if (1 == o.code) {
this.vipInfo = o.data;
var a = o.data, i = !!a.level && (0 === a.daily.count_down || 0 === a.weekly.count_down || 0 === a.monthly.count_down);
n.default.Instance.Global.emit(s.AddCashEvent.ADD_CASH_REDDOT, i);
t && t(o);
}
};
e.prototype.onReceiveVipGift = function(e, t) {
void 0 === t && (t = null);
var o = JSON.parse(e.response);
l.default.log("onReceiveVipGift", o);
o.code;
};
e.prototype._onPushVIPUpgrade = function(e) {
var t = e.getUserData();
l.default.log("_onPushVIPUpgrade", t);
this.getVipInfo();
};
e._instance = null;
return e;
}();
o.AddCashVIPProxy = c;
cc._RF.pop();
}, {
"../../Game/Script/global/GlobalValue": "GlobalValue",
"../../Game/fromework/helper/EventHelper": "EventHelper",
"../../Game/fromework/mvvm/modelView/ViewModel": "ViewModel",
"../../Game/fromework/net/NetHttp": "NetHttp",
"../../platform/Platform": "Platform",
"../logic/ui/AddCashVIP/AddCashEvent": "AddCashEvent"
} ],
AddCashVIPgradeItem: [ function(e, t, o) {
"use strict";
cc._RF.push(t, "d3505/b9k9M14mVfI/Gd9As", "AddCashVIPgradeItem");
var n, a = this && this.__extends || (n = function(e, t) {
return (n = Object.setPrototypeOf || {
__proto__: []
} instanceof Array && function(e, t) {
e.__proto__ = t;
} || function(e, t) {
for (var o in t) Object.prototype.hasOwnProperty.call(t, o) && (e[o] = t[o]);
})(e, t);
}, function(e, t) {
n(e, t);
function o() {
this.constructor = e;
}
e.prototype = null === t ? Object.create(t) : (o.prototype = t.prototype, new o());
}), i = this && this.__decorate || function(e, t, o, n) {
var a, i = arguments.length, r = i < 3 ? t : null === n ? n = Object.getOwnPropertyDescriptor(t, o) : n;
if ("object" == typeof Reflect && "function" == typeof Reflect.decorate) r = Reflect.decorate(e, t, o, n); else for (var l = e.length - 1; l >= 0; l--) (a = e[l]) && (r = (i < 3 ? a(r) : i > 3 ? a(t, o, r) : a(t, o)) || r);
return i > 3 && r && Object.defineProperty(t, o, r), r;
};
Object.defineProperty(o, "__esModule", {
value: !0
});
var r = e("../../../../Game/fromework/global/Tools"), l = e("../../../../Game/fromework/helper/EventHelper"), s = e("./AddCashEvent"), c = cc._decorator, u = c.ccclass, d = c.property, p = function(e) {
a(t, e);
function t() {
var t = null !== e && e.apply(this, arguments) || this;
t.grade = null;
t.viewVIPLabel = null;
t.ProgressBar = null;
t.vipdi = null;
t.jingyandi = null;
t.addCashLabel = null;
t.AddCash = null;
t.countdownFunArr = [];
return t;
}
t.prototype.start = function() {};
t.prototype.init = function(e) {
var t = this;
this.grade.string = e.level;
this.vipdi.string = "VIP " + e.level;
var o = e.vip_exp > e.next_exp ? e.next_exp : e.vip_exp;
this.ProgressBar.progress = o / e.next_exp;
this.jingyandi.string = o + "/" + e.next_exp;
this.addCashLabel.string = "Add Cash to become VIP " + e.level;
for (var n = [ "daily", "weekly", "monthly" ], a = function(o) {
var a = e[n[o]], r = a.flow;
if (!a) return {
value: void 0
};
var c = i.node.getChildByName("item_" + (o + 1)), u = c.getChildByName("mask");
u.active = 0 !== a.count_down;
if (u.activeInHierarchy) {
var d = u.getChildByName("countdown").getComponent(cc.Label);
d.node.active = !!a.count_down;
if (d.enabledInHierarchy && !i.countdownFunArr[o]) {
var p = a.count_down;
i.countdownFunArr[o] = function() {
p -= 1;
t.showCountdown(p, d);
if (p <= 0) {
t.unschedule(t.countdownFunArr[o]);
t.countdownFunArr[o] = null;
}
};
i.schedule(i.countdownFunArr[o], 1);
}
}
c.getComponent(cc.Button).interactable = !u.activeInHierarchy;
c.off("click");
c.on("click", function() {
if (!(parseInt(e.level) <= 1)) {
var t = r.cash;
a.cash == t && l.default.Instance.Global.emit(s.AddCashEvent.RECEIVE_VIP_GIFT, {
key: o,
flow: r
});
}
});
c.getChildByName("moneyLabel").getComponent(cc.Label).string = "₹ " + a.cash;
}, i = this, r = 0; r < 3; r++) {
var c = a(r);
if ("object" == typeof c) return c.value;
}
this.viewVIPLabel.off("click");
this.viewVIPLabel.on("click", function() {
l.default.Instance.Global.emit(s.AddCashEvent.SHOW_HELP, e.level - 1);
});
this.AddCash.off("click");
this.AddCash.on("click", function() {
l.default.Instance.Global.emit(s.AddCashEvent.ADD_CASH);
});
};
t.prototype.showCountdown = function(e, t) {
var o = r.Tools.TDate.second2Day(e), n = o.day > 0 ? o.day + " days\n" : "";
n += (o.hour.toString().length > 1 ? o.hour : "0" + o.hour) + " : " + (o.minu.toString().length > 1 ? o.minu : "0" + o.minu) + " : " + (o.sec.toString().length > 1 ? o.sec : "0" + o.sec);
t.string = n;
};
i([ d(cc.Label) ], t.prototype, "grade", void 0);
i([ d(cc.Node) ], t.prototype, "viewVIPLabel", void 0);
i([ d(cc.ProgressBar) ], t.prototype, "ProgressBar", void 0);
i([ d(cc.Label) ], t.prototype, "vipdi", void 0);
i([ d(cc.Label) ], t.prototype, "jingyandi", void 0);
i([ d(cc.Label) ], t.prototype, "addCashLabel", void 0);
i([ d(cc.Node) ], t.prototype, "AddCash", void 0);
return i([ u ], t);
}(cc.Component);
o.default = p;
cc._RF.pop();
}, {
"../../../../Game/fromework/global/Tools": "Tools",
"../../../../Game/fromework/helper/EventHelper": "EventHelper",
"./AddCashEvent": "AddCashEvent"
} ],
AddCashVIP: [ function(e, t, o) {
"use strict";
cc._RF.push(t, "a85d1ooTMpMiLUr7BlmBtCu", "AddCashVIP");
var n, a = this && this.__extends || (n = function(e, t) {
return (n = Object.setPrototypeOf || {
__proto__: []
} instanceof Array && function(e, t) {
e.__proto__ = t;
} || function(e, t) {
for (var o in t) Object.prototype.hasOwnProperty.call(t, o) && (e[o] = t[o]);
})(e, t);
}, function(e, t) {
n(e, t);
function o() {
this.constructor = e;
}
e.prototype = null === t ? Object.create(t) : (o.prototype = t.prototype, new o());
}), i = this && this.__decorate || function(e, t, o, n) {
var a, i = arguments.length, r = i < 3 ? t : null === n ? n = Object.getOwnPropertyDescriptor(t, o) : n;
if ("object" == typeof Reflect && "function" == typeof Reflect.decorate) r = Reflect.decorate(e, t, o, n); else for (var l = e.length - 1; l >= 0; l--) (a = e[l]) && (r = (i < 3 ? a(r) : i > 3 ? a(t, o, r) : a(t, o)) || r);
return i > 3 && r && Object.defineProperty(t, o, r), r;
};
Object.defineProperty(o, "__esModule", {
value: !0
});
var r = e("../../../../Game/fromework/helper/EventHelper"), l = e("../../../../Game/fromework/helper/UIHelper"), s = e("../../../../platform/Platform"), c = e("../../../global/PopHelper"), u = e("../../../model/AddCashVIPModel"), d = e("../../Wallet/WalletHelper"), p = e("./AddCashEvent"), h = e("./AddCashVIPgradeItem"), f = cc._decorator, _ = f.ccclass, m = f.property, y = function(e) {
a(t, e);
function t() {
var t = null !== e && e.apply(this, arguments) || this;
t.main = null;
t.help = null;
t.leftArrow = null;
t.rightArrow = null;
t.mainContent = null;
t.helpContent = null;
t.AddCashVIPgradeItem_origin = null;
t.AddCashVIPgradeItem_tartget = null;
t.helpPageItem_origin = null;
t.helpPageItem_target = null;
t.helpKey = 0;
t.helpLock = !1;
t.contentKey = 0;
t.contentLock = !1;
t.data = null;
return t;
}
t.prototype.onEnable = function() {
r.default.Instance.Global.bind(p.AddCashEvent.SHOW_HELP, this.showHelp, this);
r.default.Instance.Global.bind(p.AddCashEvent.ADD_CASH, this.addCash, this);
r.default.Instance.Global.bind(p.AddCashEvent.RECEIVE_VIP_GIFT, this.receiveVipGift, this);
r.default.Instance.Global.bind(p.AddCashEvent.INIT_CONTENT, this.onInitContent, this);
};
t.prototype.onDisable = function() {
r.default.Instance.Global.unbind(p.AddCashEvent.SHOW_HELP, this.showHelp, this);
r.default.Instance.Global.unbind(p.AddCashEvent.ADD_CASH, this.addCash, this);
r.default.Instance.Global.unbind(p.AddCashEvent.RECEIVE_VIP_GIFT, this.receiveVipGift, this);
r.default.Instance.Global.unbind(p.AddCashEvent.INIT_CONTENT, this.onInitContent, this);
};
t.prototype.start = function() {
var e = this;
this.leftArrow.on("click", function() {
if (e.help.activeInHierarchy) {
if (e.helpLock) return;
--e.helpKey;
e.helpTween(-890);
} else {
if (e.contentLock) return;
--e.contentKey;
e.contentTween(-1181);
}
});
this.rightArrow.on("click", function() {
if (e.help.activeInHierarchy) {
if (e.helpLock) return;
++e.helpKey;
e.helpTween(890);
} else {
if (e.contentLock) return;
++e.contentKey;
e.contentTween(1181);
}
});
};
t.prototype.helpTween = function(e) {
var t = this;
this.helpLock = !0;
this.initHelp(this.helpPageItem_target, this.helpKey);
this.helpPageItem_target.x = e;
this.helpPageItem_target.active = !0;
cc.tween(this.helpPageItem_target).to(.3, {
x: 0
}, {
easing: cc.easing.fade
}).union().start();
cc.tween(this.helpPageItem_origin).to(.3, {
x: -e
}, {
easing: cc.easing.fade
}).union().call(function() {
var e;
e = [ t.helpPageItem_target, t.helpPageItem_origin ], t.helpPageItem_origin = e[0], 
t.helpPageItem_target = e[1];
t.refreshArrow();
t.helpLock = !1;
}).start();
};
t.prototype.contentTween = function(e) {
var t = this;
this.contentLock = !0;
this.initContent(this.AddCashVIPgradeItem_tartget, this.contentKey);
this.AddCashVIPgradeItem_tartget.x = e;
this.AddCashVIPgradeItem_tartget.active = !0;
cc.tween(this.AddCashVIPgradeItem_tartget).to(.3, {
x: 0
}, {
easing: cc.easing.fade
}).union().start();
cc.tween(this.AddCashVIPgradeItem_origin).to(.3, {
x: -e
}, {
easing: cc.easing.fade
}).union().call(function() {
var e;
e = [ t.AddCashVIPgradeItem_tartget, t.AddCashVIPgradeItem_origin ], t.AddCashVIPgradeItem_origin = e[0], 
t.AddCashVIPgradeItem_tartget = e[1];
t.refreshArrow();
t.contentLock = !1;
}).start();
};
t.prototype.refreshArrow = function() {
if (this.help.activeInHierarchy) {
this.leftArrow.getComponent(cc.Button).interactable = this.helpKey > 0;
this.rightArrow.getComponent(cc.Button).interactable = this.helpKey < 2;
} else {
this.leftArrow.getComponent(cc.Button).interactable = this.contentKey > 0;
this.rightArrow.getComponent(cc.Button).interactable = this.contentKey < this.data.config.length - 1;
}
};
t.prototype.close = function() {
if (this.help.activeInHierarchy) {
this.help.active = !1;
this.main.active = !0;
} else l.default.Instance.removeLayer(this.node);
this.refreshArrow();
};
t.prototype.InitView = function(e, t) {
var o, n;
void 0 === e && (e = null);
void 0 === t && (t = !0);
if (e) {
this.data = e;
this.data.levelLength = null === (n = null === (o = this.data) || void 0 === o ? void 0 : o.config) || void 0 === n ? void 0 : n.length;
}
s.default.log("addcashvip initview", e);
if (t) {
this.AddCashVIPgradeItem_origin = this.mainContent.getChildByName("AddCashVIPgradeItem");
this.AddCashVIPgradeItem_tartget = cc.instantiate(this.AddCashVIPgradeItem_origin);
this.AddCashVIPgradeItem_tartget.active = !1;
this.AddCashVIPgradeItem_tartget.parent = this.mainContent;
this.helpPageItem_origin = this.helpContent.getChildByName("helpPageItem");
this.helpPageItem_target = cc.instantiate(this.helpPageItem_origin);
this.helpPageItem_target.active = !1;
this.helpPageItem_target.parent = this.helpContent;
}
this.contentKey = this.data.level > 0 ? this.data.level - 1 : 0;
this.initContent(this.AddCashVIPgradeItem_origin, this.contentKey);
this.refreshArrow();
};
t.prototype.showHelp = function(e) {
if (!this.contentLock) {
var t = Math.floor(Number(e.getUserData()) / 10);
this.helpKey = t;
this.initHelp(this.helpPageItem_origin, t);
this.help.active = !0;
this.main.active = !1;
this.refreshArrow();
}
};
t.prototype.initHelp = function(e, t) {
for (var o = 0; o < 10; o++) {
var n = this.data.config[10 * t + o];
e.getChildByName("lv" + (o + 1)).getComponent(cc.Label).string = "Lv" + n.level;
e.getChildByName("exp" + (o + 1)).getComponent(cc.Label).string = n.exp;
}
};
t.prototype.initContent = function(e, t) {
var o, n, a = this.data.config[t], i = {
level: a.level,
vip_exp: this.data.vip_exp,
next_exp: a.exp,
levelLength: null === (n = null === (o = this.data) || void 0 === o ? void 0 : o.config) || void 0 === n ? void 0 : n.length,
daily: {
cash: a.daily_cash,
count_down: 0,
flow: this.data.daily
},
weekly: {
cash: a.weekly_cash,
count_down: 0,
flow: this.data.weekly
},
monthly: {
cash: a.monthly_cash,
count_down: 0,
flow: this.data.monthly
}
};
if (i.level === this.data.level) {
i.daily.count_down = this.data.daily.count_down;
i.weekly.count_down = this.data.weekly.count_down;
i.monthly.count_down = this.data.monthly.count_down;
}
e.getComponent(h.default).init(i);
};
t.prototype.onInitContent = function() {
var e = this;
u.AddCashVIPProxy.Instance.getVipInfo(function(t) {
e.InitView(null == t ? void 0 : t.data, !1);
});
};
t.prototype.addCash = function() {
d.default.Instance.openRecharge();
this.close();
};
t.prototype.receiveVipGift = function(e) {
var t = this, o = e.getUserData();
if (o.flow.flow < o.flow.condit_flow) c.PopHelper.Instance.showTips("Total wins and losses are ₹" + o.flow.flow + " \n and ₹" + o.flow.condit_flow + " wins and losses are required to receive the reward"); else {
var n = e.getUserData().key + 1;
u.AddCashVIPProxy.Instance.receiveVipGift(n, function() {
u.AddCashVIPProxy.Instance.vipInfo = null;
t.close();
});
}
};
i([ m(cc.Node) ], t.prototype, "main", void 0);
i([ m(cc.Node) ], t.prototype, "help", void 0);
i([ m(cc.Node) ], t.prototype, "leftArrow", void 0);
i([ m(cc.Node) ], t.prototype, "rightArrow", void 0);
i([ m(cc.Node) ], t.prototype, "mainContent", void 0);
i([ m(cc.Node) ], t.prototype, "helpContent", void 0);
return i([ _ ], t);
}(cc.Component);
o.default = y;
cc._RF.pop();
}, {
"../../../../Game/fromework/helper/EventHelper": "EventHelper",
"../../../../Game/fromework/helper/UIHelper": "UIHelper",
"../../../../platform/Platform": "Platform",
"../../../global/PopHelper": "PopHelper",
"../../../model/AddCashVIPModel": "AddCashVIPModel",
"../../Wallet/WalletHelper": "WalletHelper",
"./AddCashEvent": "AddCashEvent",
"./AddCashVIPgradeItem": "AddCashVIPgradeItem"
} ],
AddCash: [ function(e, t, o) {
"use strict";
cc._RF.push(t, "5ca56K1sYlE9o7yMjavG+Mp", "AddCash");
var n, a = this && this.__extends || (n = function(e, t) {
return (n = Object.setPrototypeOf || {
__proto__: []
} instanceof Array && function(e, t) {
e.__proto__ = t;
} || function(e, t) {
for (var o in t) Object.prototype.hasOwnProperty.call(t, o) && (e[o] = t[o]);
})(e, t);
}, function(e, t) {
n(e, t);
function o() {
this.constructor = e;
}
e.prototype = null === t ? Object.create(t) : (o.prototype = t.prototype, new o());
}), i = this && this.__decorate || function(e, t, o, n) {
var a, i = arguments.length, r = i < 3 ? t : null === n ? n = Object.getOwnPropertyDescriptor(t, o) : n;
if ("object" == typeof Reflect && "function" == typeof Reflect.decorate) r = Reflect.decorate(e, t, o, n); else for (var l = e.length - 1; l >= 0; l--) (a = e[l]) && (r = (i < 3 ? a(r) : i > 3 ? a(t, o, r) : a(t, o)) || r);
return i > 3 && r && Object.defineProperty(t, o, r), r;
};
Object.defineProperty(o, "__esModule", {
value: !0
});
var r = e("../../../../Game/Script/global/GlobalValue"), l = e("../../../global/PopHelper"), s = e("../../../../Game/client/global/enum/game/Const"), c = e("../../../../Game/client/global/enum/game/Event"), u = e("../../../../Game/client/model/CommonModel"), d = e("../../../../Game/client/model/LanguageModel"), p = e("../../../../Game/fromework/global/Tools"), h = e("../../../../Game/fromework/helper/EventHelper"), f = e("../../../../Game/fromework/helper/UIHelper"), _ = e("../../../../fromework/component/listView/ListView"), m = e("../../../model/MonthCardModel"), y = e("../../../model/RecentModel"), g = e("../../../model/WalletModel"), v = e("../../Wallet/WalletHelper"), C = e("../../Wallet/WalletInfoAlert"), b = e("../Recent/RecentPayView"), I = e("./Activity"), E = e("./AddCashActItem"), S = e("../../../global/Global"), T = e("../../../component/pop/tipsHand"), R = cc._decorator, O = R.ccclass, A = R.property, P = function(e) {
a(t, e);
function t() {
var t = null !== e && e.apply(this, arguments) || this;
t.Activity = null;
t.ActSelectItem = null;
t.ActSelectItemName = null;
t.Enpty = null;
t.Name = null;
t.Phone = null;
t.AddCashActItem = null;
t.Promotions = null;
t.content = null;
t.List = null;
t.cashLabel = null;
t.extarCashLabel = null;
t.bonusLabel = null;
t.totalLabel = null;
t.priceLabel = null;
t._isInit = !1;
t._openParam = null;
t._isSelectAct = !1;
t._curActivityData = null;
t._addCashCb = null;
return t;
}
t.prototype.onEnable = function() {
h.default.Instance.Global.bind(c.WalletEvent.ACTIVITY_SELECT, this.onSelectActivity, this);
h.default.Instance.Global.bind(c.WalletEvent.ADDCASH_ITEM_CLICKED, this.onAddCashClicked, this);
h.default.Instance.Global.bind(c.WalletEvent.RECHARGE_GET_GOODS, this.refreshListView, this);
h.default.Instance.Global.bind(c.WalletEvent.RECHARGE_ACT_REFRESH, this.onActRefresh, this);
h.default.Instance.Global.bind(c.WalletEvent.RECHARGE_CLOSE_WEBVIEW, this.onResetView, this);
h.default.Instance.Global.bind(c.WalletEvent.RECHARGE_GET_USERINFO, this.onUserInfoRefresh, this);
h.default.Instance.Global.bind(c.WalletEvent.ADDCASH_ITEM_ONLY_CLICKED, this.onAddCashOnlyClicked, this);
h.default.Instance.Global.bind(c.MonthCardEent.MONTHCARD_GET_LIST, this.refreshListView, this);
};
t.prototype.onDisable = function() {
h.default.Instance.Global.unbind(c.WalletEvent.ACTIVITY_SELECT, this.onSelectActivity, this);
h.default.Instance.Global.unbind(c.WalletEvent.ADDCASH_ITEM_CLICKED, this.onAddCashClicked, this);
h.default.Instance.Global.unbind(c.WalletEvent.RECHARGE_GET_GOODS, this.refreshListView, this);
h.default.Instance.Global.unbind(c.WalletEvent.RECHARGE_ACT_REFRESH, this.onActRefresh, this);
h.default.Instance.Global.unbind(c.WalletEvent.RECHARGE_CLOSE_WEBVIEW, this.onResetView, this);
h.default.Instance.Global.unbind(c.WalletEvent.RECHARGE_GET_USERINFO, this.onUserInfoRefresh, this);
h.default.Instance.Global.unbind(c.WalletEvent.ADDCASH_ITEM_ONLY_CLICKED, this.onAddCashOnlyClicked, this);
h.default.Instance.Global.unbind(c.MonthCardEent.MONTHCARD_GET_LIST, this.refreshListView, this);
};
t.prototype.onLoad = function() {
S.Global.Instance.selectAddCashPrice = 1e3;
h.default.Instance.Global.bind(c.WalletEvent.RECHARGE_BROWSER_END, this._onShowApp, this);
};
t.prototype.onDestroy = function() {
h.default.Instance.Global.unbind(c.WalletEvent.RECHARGE_BROWSER_END, this._onShowApp, this);
};
t.prototype._onShowApp = function() {
var e = this;
this && this.node && this.node.isValid && this.scheduleOnce(function() {
g.WalletProxy.Instance.sendGetUserWallet();
g.WalletProxy.Instance.sendGetRechargeUserInfo();
m.MonthCardProxy.Instance.sendGetMonthCardList();
e.onResetView();
});
};
t.prototype.onPayment = function(e) {
var t = "";
1 == e.code ? 1 == e.payWay ? t = "purchase succeeds!" : e.data.isOpenURL ? cc.sys.openURL(e.data.payLinks) : v.default.Instance.openRechargeWebView(e.data.payLinks) : t = 6001 == e.code ? d.default.getString("WALLET_CASH_ATTEND") : 6003 == e.code ? d.default.getString("WALLET_CASH_WRONG") : 6004 == e.code ? d.default.getString("WALLET_CASH_UID") : 6005 == e.code ? d.default.getString("WALLET_CASH_ORDER") : 6006 == e.code ? d.default.getString("WALLET_CASH_THIRD") : 6008 == e.code ? d.default.getString("WALLET_CASH_TYPE") : 999 == e.code ? e.msg : "Error code:" + e.code;
"" != t && l.PopHelper.Instance.showTips(t);
};
t.prototype.onResetView = function() {
this._isInit = !0;
this._isSelectAct = !1;
this._curActivityData = null;
this.Enpty.active = !1;
this.ActSelectItem.active = !1;
g.WalletProxy.Instance.sendGetActivityList();
g.WalletProxy.Instance.sendGetRechargeGoods(0, []);
};
t.prototype.onUserInfoRefresh = function() {
var e = g.WalletProxy.Instance.rechargeUserInfo;
this.Name.string = e.user_name && "" != e.user_name ? p.Tools.TStr.ellipsisString(e.user_name, 16) : d.default.getString("ADDCASH_TIPS_NAME");
this.Phone.string = e.tel_phone && "" != e.tel_phone ? e.tel_phone : d.default.getString("ADDCASH_TIPS_PHONE");
};
t.prototype.onActRefresh = function() {
var e = this;
if (this._isInit && g.WalletProxy.Instance.activityList.length > 0 && r.default.getInstance().isCashGame) {
var t = g.WalletProxy.Instance.activityList[0];
null != this._openParam && null != this._openParam.activityId && g.WalletProxy.Instance.activityList.forEach(function(o) {
e._openParam.activityId == o.id && (t = o);
});
this._isInit = !1;
this._isSelectAct = !0;
this._curActivityData = t;
this.refreshListView();
} else this.refreshListView();
this.refreshAct();
};
t.prototype.onSelectActivity = function(e) {
var t = e.getUserData();
this._curActivityData = t;
this._isSelectAct = !0;
this.refreshAct();
};
t.prototype.InitView = function(e) {
this._isInit = !0;
this._openParam = e;
this.Enpty.active = !1;
this.ActSelectItem.active = !1;
this.Activity.active = !1;
this.onUserInfoRefresh();
g.WalletProxy.Instance.sendGetActivityList();
g.WalletProxy.Instance.sendGetRechargeGoods(0, []);
m.MonthCardProxy.Instance.sendGetMonthCardList();
};
t.prototype.refreshListView = function() {
for (var e = 0; e < 4; e++) {
var t = this.Promotions.getChildByName("AddCashActItem_" + e);
if (!(null == t ? void 0 : t.isValid)) {
(t = cc.instantiate(this.AddCashActItem)).parent = this.Promotions;
t.name = "AddCashActItem_" + e;
}
var o = t.getComponent(E.default);
0 == e ? o.refreshSuperDeal(e) : o.refreshMonthCard(e);
}
var n = g.WalletProxy.Instance.rechargeGear.concat(), a = [];
for (e = 0; e < n.length; e++) {
var i = new u.Common.AddCashData();
i.amount = n[e];
if (this._isSelectAct) {
var r = g.WalletProxy.Instance.getRechargeAmountRate(this._curActivityData.id, n[e]);
i.deposit = r.deposit;
i.bonus = r.bonus;
} else {
i.deposit = 0;
i.bonus = 0;
}
a.push(i);
}
this.List.datas = a;
};
t.prototype.refreshAct = function() {
this._isSelectAct && g.WalletProxy.Instance.sendGetRechargeGoods(this._curActivityData.id, []);
this.Enpty.active = !this._isSelectAct;
this.ActSelectItem.active = this._isSelectAct;
this._isSelectAct && (this.ActSelectItemName.string = this._curActivityData.title);
};
t.prototype.onActDeselected = function() {
this._curActivityData = null;
this._isSelectAct = !1;
this.refreshAct();
this.refreshListView();
};
t.prototype.onActSelectClicked = function() {
var e = this;
g.WalletProxy.Instance.activityList.length > 0 ? f.default.Instance.addBundleMaskLayer(s.BundleUIPath.Activity, function(t) {
var o = e._isSelectAct ? e._curActivityData.id : 0;
t.getComponent(I.default).InitView(o);
}) : l.PopHelper.Instance.showTips(d.default.getString("ACTIVITY_NONE"));
};
t.prototype.onAddCashClicked = function(e) {
var t = this, o = e.getUserData();
if (o) {
var n = o.amount, a = this._curActivityData ? this._curActivityData.id : 0;
g.WalletProxy.Instance.sendPayment(n, a, o.deposit, o.bonus, function(e) {
var o = JSON.parse(e.response);
t.onPayment(o);
});
} else l.PopHelper.Instance.showTips(d.default.getString("RECHARGE_INPUT_TIPS1"));
};
t.prototype.onAddCashOnlyClicked = function(e) {
var t = e.getUserData(), o = t[0], n = t[1];
this._addCashCb = t[2];
this.Promotions.children.concat(this.content.children).forEach(function(e) {
e && e.isValid && (e.getChildByName("addcash_item_light").active = !1);
});
n && n.isValid && (n.getChildByName("addcash_item_light").active = !0);
this.cashLabel.string = o.cash;
this.extarCashLabel.string = o.extarCash;
this.bonusLabel.string = o.bonus;
this.totalLabel.string = o.total;
this.priceLabel.string = o.price;
S.Global.Instance.selectAddCashPrice = Number(o.price);
this.priceLabel.node.parent.parent.getChildByName("tipsHand").active = !0;
this.priceLabel.node.parent.parent.getChildByName("tipsHand").getComponent(T.default).show(o.price);
};
t.prototype.onAddCashOnlyClickedCb = function() {
this._addCashCb && this._addCashCb();
};
t.prototype.onEditClicked = function() {
f.default.Instance.addBundleMaskLayer(s.BundleUIPath.WalletInfoAlert, function(e) {
e.getComponent(C.default).InitView();
});
};
t.prototype.onRecentClicked = function() {
f.default.Instance.addBundleMaskLayer(s.BundleUIPath.RecentPayView, function(e) {
e.getComponent(b.default).showView(y.RecentType.MainView);
});
};
t.prototype.onCloseClicked = function() {
f.default.Instance.removeMaskLayer(this.node);
};
i([ A(cc.Node) ], t.prototype, "Activity", void 0);
i([ A(cc.Node) ], t.prototype, "ActSelectItem", void 0);
i([ A(cc.Label) ], t.prototype, "ActSelectItemName", void 0);
i([ A(cc.Node) ], t.prototype, "Enpty", void 0);
i([ A(cc.Label) ], t.prototype, "Name", void 0);
i([ A(cc.Label) ], t.prototype, "Phone", void 0);
i([ A(cc.Prefab) ], t.prototype, "AddCashActItem", void 0);
i([ A(cc.Node) ], t.prototype, "Promotions", void 0);
i([ A(cc.Node) ], t.prototype, "content", void 0);
i([ A(_.default) ], t.prototype, "List", void 0);
i([ A(cc.Label) ], t.prototype, "cashLabel", void 0);
i([ A(cc.Label) ], t.prototype, "extarCashLabel", void 0);
i([ A(cc.Label) ], t.prototype, "bonusLabel", void 0);
i([ A(cc.Label) ], t.prototype, "totalLabel", void 0);
i([ A(cc.Label) ], t.prototype, "priceLabel", void 0);
return i([ O ], t);
}(cc.Component);
o.default = P;
cc._RF.pop();
}, {
"../../../../Game/Script/global/GlobalValue": "GlobalValue",
"../../../../Game/client/global/enum/game/Const": "Const",
"../../../../Game/client/global/enum/game/Event": "Event",
"../../../../Game/client/model/CommonModel": "CommonModel",
"../../../../Game/client/model/LanguageModel": "LanguageModel",
"../../../../Game/fromework/global/Tools": "Tools",
"../../../../Game/fromework/helper/EventHelper": "EventHelper",
"../../../../Game/fromework/helper/UIHelper": "UIHelper",
"../../../../fromework/component/listView/ListView": "ListView",
"../../../component/pop/tipsHand": "tipsHand",
"../../../global/Global": "Global",
"../../../global/PopHelper": "PopHelper",
"../../../model/MonthCardModel": "MonthCardModel",
"../../../model/RecentModel": "RecentModel",
"../../../model/WalletModel": "WalletModel",
"../../Wallet/WalletHelper": "WalletHelper",
"../../Wallet/WalletInfoAlert": "WalletInfoAlert",
"../Recent/RecentPayView": "RecentPayView",
"./Activity": "Activity",
"./AddCashActItem": "AddCashActItem"
} ],
Alert: [ function(e, t, o) {
"use strict";
cc._RF.push(t, "56e0cPBT3hHv5soXpQfkUJc", "Alert");
var n, a = this && this.__extends || (n = function(e, t) {
return (n = Object.setPrototypeOf || {
__proto__: []
} instanceof Array && function(e, t) {
e.__proto__ = t;
} || function(e, t) {
for (var o in t) Object.prototype.hasOwnProperty.call(t, o) && (e[o] = t[o]);
})(e, t);
}, function(e, t) {
n(e, t);
function o() {
this.constructor = e;
}
e.prototype = null === t ? Object.create(t) : (o.prototype = t.prototype, new o());
}), i = this && this.__decorate || function(e, t, o, n) {
var a, i = arguments.length, r = i < 3 ? t : null === n ? n = Object.getOwnPropertyDescriptor(t, o) : n;
if ("object" == typeof Reflect && "function" == typeof Reflect.decorate) r = Reflect.decorate(e, t, o, n); else for (var l = e.length - 1; l >= 0; l--) (a = e[l]) && (r = (i < 3 ? a(r) : i > 3 ? a(t, o, r) : a(t, o)) || r);
return i > 3 && r && Object.defineProperty(t, o, r), r;
};
Object.defineProperty(o, "__esModule", {
value: !0
});
var r = cc._decorator, l = r.ccclass, s = r.property, c = function(e) {
a(t, e);
function t() {
var t = null !== e && e.apply(this, arguments) || this;
t.Title = null;
t.Content = null;
t.LblLeft = null;
t.LblRight = null;
t.AlertPanel = null;
t.LeftButton = null;
t.RightButton = null;
t._openParam = null;
return t;
}
t.prototype.show = function(e) {
this._openParam = e;
this.Title.node.active = null != e.title;
this.LeftButton.active = null != e.leftTitle;
this.RightButton.active = null != e.rightTitle;
this.Title.string = e.title ? e.title : "";
this.LblLeft.string = e.leftTitle ? e.leftTitle : "";
this.LblRight.string = e.rightTitle ? e.rightTitle : "";
this.Content.string = e.content;
this.openAction();
};
t.prototype.close = function() {
var e = this;
this.closeAction(function() {
e._openParam && e._openParam.cancelCallFunc && (e._openParam.target ? e._openParam.cancelCallFunc.apply(e._openParam.target) : e._openParam.cancelCallFunc());
});
};
t.prototype.openAction = function() {
this.AlertPanel.setPosition(cc.v2(0, this.node.height / 2 + this.AlertPanel.height / 2));
this.AlertPanel.runAction(cc.moveTo(.1, cc.v2(0, 0)));
};
t.prototype.closeAction = function(e) {
var t = this, o = cc.moveTo(.1, cc.v2(0, -(this.node.height / 2 + this.AlertPanel.height / 2))), n = cc.callFunc(function() {
e && e.apply(t);
t._openParam = null;
t.node.removeFromParent(!0);
t.node.destroy();
}), a = cc.sequence(o, n);
this.AlertPanel.runAction(a);
};
t.prototype.onLeftClicked = function() {
var e = this;
if (1 == this._openParam.leftNotHideAlert) {
if (!this._openParam.leftCallFunc) return;
this._openParam.target ? this._openParam.leftCallFunc.call(this._openParam.target) : this._openParam.leftCallFunc();
} else this.closeAction(function() {
e._openParam.leftCallFunc && (e._openParam.target ? e._openParam.leftCallFunc.call(e._openParam.target) : e._openParam.leftCallFunc());
});
};
t.prototype.onRightClicked = function() {
var e = this;
if (1 == this._openParam.rightNotHideAlert) {
if (!this._openParam.rightCallFunc) return;
this._openParam.target ? this._openParam.rightCallFunc.call(this._openParam.target) : this._openParam.rightCallFunc();
} else this.closeAction(function() {
e._openParam.rightCallFunc && (e._openParam.target ? e._openParam.rightCallFunc.call(e._openParam.target) : e._openParam.rightCallFunc());
});
};
t.prototype.onBackClicked = function() {
1 != this._openParam.isBanCancel && this.close();
};
i([ s(cc.Label) ], t.prototype, "Title", void 0);
i([ s(cc.Label) ], t.prototype, "Content", void 0);
i([ s(cc.Label) ], t.prototype, "LblLeft", void 0);
i([ s(cc.Label) ], t.prototype, "LblRight", void 0);
i([ s(cc.Node) ], t.prototype, "AlertPanel", void 0);
i([ s(cc.Node) ], t.prototype, "LeftButton", void 0);
i([ s(cc.Node) ], t.prototype, "RightButton", void 0);
return i([ l ], t);
}(cc.Component);
o.default = c;
cc._RF.pop();
}, {} ],
AudioHelper: [ function(e, t, o) {
"use strict";
cc._RF.push(t, "26eaevYgzRAnq9jmcYEdCGV", "AudioHelper");
var n = this && this.__awaiter || function(e, t, o, n) {
return new (o || (o = Promise))(function(a, i) {
function r(e) {
try {
s(n.next(e));
} catch (e) {
i(e);
}
}
function l(e) {
try {
s(n.throw(e));
} catch (e) {
i(e);
}
}
function s(e) {
e.done ? a(e.value) : (t = e.value, t instanceof o ? t : new o(function(e) {
e(t);
})).then(r, l);
var t;
}
s((n = n.apply(e, t || [])).next());
});
}, a = this && this.__generator || function(e, t) {
var o, n, a, i, r = {
label: 0,
sent: function() {
if (1 & a[0]) throw a[1];
return a[1];
},
trys: [],
ops: []
};
return i = {
next: l(0),
throw: l(1),
return: l(2)
}, "function" == typeof Symbol && (i[Symbol.iterator] = function() {
return this;
}), i;
function l(e) {
return function(t) {
return s([ e, t ]);
};
}
function s(i) {
if (o) throw new TypeError("Generator is already executing.");
for (;r; ) try {
if (o = 1, n && (a = 2 & i[0] ? n.return : i[0] ? n.throw || ((a = n.return) && a.call(n), 
0) : n.next) && !(a = a.call(n, i[1])).done) return a;
(n = 0, a) && (i = [ 2 & i[0], a.value ]);
switch (i[0]) {
case 0:
case 1:
a = i;
break;

case 4:
r.label++;
return {
value: i[1],
done: !1
};

case 5:
r.label++;
n = i[1];
i = [ 0 ];
continue;

case 7:
i = r.ops.pop();
r.trys.pop();
continue;

default:
if (!(a = r.trys, a = a.length > 0 && a[a.length - 1]) && (6 === i[0] || 2 === i[0])) {
r = 0;
continue;
}
if (3 === i[0] && (!a || i[1] > a[0] && i[1] < a[3])) {
r.label = i[1];
break;
}
if (6 === i[0] && r.label < a[1]) {
r.label = a[1];
a = i;
break;
}
if (a && r.label < a[2]) {
r.label = a[2];
r.ops.push(i);
break;
}
a[2] && r.ops.pop();
r.trys.pop();
continue;
}
i = t.call(e, r);
} catch (e) {
i = [ 6, e ];
n = 0;
} finally {
o = a = 0;
}
if (5 & i[0]) throw i[1];
return {
value: i[0] ? i[1] : void 0,
done: !0
};
}
};
Object.defineProperty(o, "__esModule", {
value: !0
});
o.audioHelper = void 0;
var i, r = e("../../../Game/BundleManager"), l = e("../../../platform/Platform"), s = e("../global/ResLoader");
(function(e) {
(function(e) {
e[e.BGM = 0] = "BGM";
e[e.EFFECT = 1] = "EFFECT";
})(e.PlayType || (e.PlayType = {}));
})(i = o.audioHelper || (o.audioHelper = {}));
var c = "[AudioHelper]:", u = function() {
function e() {
this._isValid = !1;
this._bgmAudioID = 0;
this._curEffectAudioID = null;
this._bgmUrl = "";
this._curEffectUrl = null;
this._bgmVolume = 0;
this._effectVolume = 0;
this._effectPlaying = !1;
this._curEffectIndex = 0;
}
e.prototype._play = function(e, t, o, n, a, r) {
var s = this, u = function(e, t, o) {
if (i.PlayType.BGM == e) {
s._bgmUrl = t;
s._bgmAudioID = o;
} else {
if (i.PlayType.EFFECT != e) {
l.default.error(c + "play type is invalid value!");
return;
}
s._curEffectUrl.set(r || s._curEffectIndex, t);
s._curEffectAudioID.set(r || s._curEffectIndex, o);
}
a && cc.audioEngine.setFinishCallback(o, a);
};
if ("string" == typeof e) this.preload(e, function(a, i) {
if (a) l.default.error(a); else {
var r = cc.audioEngine.play(i, o, n);
u(t, e, r);
}
}); else {
var d = cc.audioEngine.play(e, o, n);
u(t, e.url, d);
}
};
e.prototype._effectFinish = function(e, t) {
void 0 === t && (t = !1);
t && s.default.Instance.releaseRes(this._curEffectUrl[e], cc.AudioClip);
this._curEffectAudioID.delete(e);
this._curEffectUrl.delete(e);
this._effectPlaying = !1;
};
Object.defineProperty(e, "Instance", {
get: function() {
e._instance || (e._instance = new e());
return e._instance;
},
enumerable: !1,
configurable: !0
});
Object.defineProperty(e.prototype, "valid", {
get: function() {
return this._isValid;
},
enumerable: !1,
configurable: !0
});
Object.defineProperty(e.prototype, "bgmVolume", {
get: function() {
return this._bgmVolume;
},
set: function(e) {
cc.audioEngine.setVolume(this._bgmAudioID, this._bgmVolume = e);
cc.sys.localStorage.setItem("BGM_VOLUME", String(e));
e > 0 && this.turnOn(!this._isValid);
},
enumerable: !1,
configurable: !0
});
Object.defineProperty(e.prototype, "effectVolume", {
get: function() {
return this._effectVolume;
},
set: function(e) {
this._effectVolume = e;
cc.sys.localStorage.setItem("EFFECT_VOLUME", String(e));
e > 0 && this.turnOn(!this._isValid);
},
enumerable: !1,
configurable: !0
});
Object.defineProperty(e.prototype, "effectPlaying", {
get: function() {
return this._effectPlaying;
},
enumerable: !1,
configurable: !0
});
e.prototype.init = function() {
this._bgmAudioID = 0;
this._curEffectAudioID = new Map();
this._bgmUrl = "";
this._curEffectUrl = new Map();
this._isValid = JSON.parse(cc.sys.localStorage.getItem("MUSIC_OPEN"));
this._bgmVolume = parseFloat(cc.sys.localStorage.getItem("BGM_VOLUME"));
this._effectVolume = parseFloat(cc.sys.localStorage.getItem("EFFECT_VOLUME"));
null == this._isValid && (this._isValid = !0);
isNaN(this._bgmVolume) && (this._bgmVolume = 1);
isNaN(this._effectVolume) && (this._effectVolume = 1);
};
e.prototype.preload = function(e, t) {
this._isValid && s.default.Instance.loadRes(e, cc.AudioClip, function(e, o) {
t && t(e, o);
});
};
e.prototype.turnOn = function(e) {
void 0 === e && (e = !0);
this._isValid = !0;
this._bgmVolume = parseFloat(cc.sys.localStorage.getItem("BGM_VOLUME"));
this._effectVolume = parseFloat(cc.sys.localStorage.getItem("EFFECT_VOLUME"));
isNaN(this._bgmVolume) && (this._bgmVolume = 1);
isNaN(this._effectVolume) && (this._effectVolume = 1);
cc.sys.localStorage.setItem("MUSIC_OPEN", JSON.stringify(!0));
cc.audioEngine.setVolume(this._bgmAudioID, this._bgmVolume);
e && "" != this._bgmUrl && this.playBGM(this._bgmUrl);
};
e.prototype.turnOff = function() {
this._isValid = !1;
this.bgmVolume = 0;
this.effectVolume = 0;
cc.audioEngine.stopAll();
cc.sys.localStorage.setItem("MUSIC_OPEN", JSON.stringify(!1));
cc.audioEngine.setVolume(this._bgmAudioID, this._bgmVolume = 0);
};
e.prototype.playBGM = function(e, t) {
this._isValid && this._play(e, i.PlayType.BGM, !0, this._bgmVolume, t);
};
e.prototype.stopBGM = function(e) {
void 0 === e && (e = !1);
if (this._isValid) {
cc.audioEngine.stopAll();
e && s.default.Instance.releaseRes(this._bgmUrl, cc.AudioClip);
}
};
e.prototype.playEffect = function(e, t, o, n) {
void 0 === t && (t = !1);
void 0 === n && (n = !1);
if (this._isValid) {
var a = this._curEffectIndex++;
this._play(e, i.PlayType.EFFECT, n, this._effectVolume, function() {
o && o();
}, a);
this._effectPlaying = !0;
return a;
}
};
e.prototype.stopEffect = function(e, t) {
void 0 === t && (t = !1);
if (this._isValid) {
cc.audioEngine.stop(this._curEffectAudioID.get(e));
this._effectFinish(e, t);
}
};
e.prototype.playBGMBundle = function(e, t) {
this._isValid && this._playBundle(e, i.PlayType.BGM, !0, this.bgmVolume, t);
};
e.prototype.playBundleEffect = function(e, t, o, n, a) {
var r = this;
void 0 === t && (t = !1);
void 0 === n && (n = !1);
void 0 === a && (a = !1);
if (this._isValid) {
var l = this._curEffectIndex++, s = 0;
if (a) {
s = this._bgmVolume;
this.bgmVolume = .3 * s;
}
this._playBundle(e, i.PlayType.EFFECT, n, this._effectVolume, function() {
a && (r.bgmVolume = s);
o && o();
}, l);
this._effectPlaying = !0;
return l;
}
};
e.prototype._playBundle = function(e, t, o, n, a, r) {
var s = this, u = function(e, t, o) {
if (i.PlayType.BGM == e) {
s._bgmUrl = t;
s._bgmAudioID = o;
} else {
if (i.PlayType.EFFECT != e) {
l.default.error(c + "play type is invalid value!");
return;
}
s._curEffectUrl.set(r || s._curEffectIndex, t);
s._curEffectAudioID.set(r || s._curEffectIndex, o);
}
a && cc.audioEngine.setFinishCallback(o, a);
};
if ("string" == typeof e) this.preloadBundle(e, function(a, i) {
if (a) l.default.error(a); else {
var r = cc.audioEngine.play(i, o, n);
u(t, e, r);
}
}); else {
var d = cc.audioEngine.play(e, o, n);
u(t, e.url, d);
}
};
e.prototype.preloadBundle = function(e, t) {
return n(this, void 0, void 0, function() {
var o, n;
return a(this, function(a) {
switch (a.label) {
case 0:
if (!this._isValid) return [ 2 ];
o = function(e, o) {
t && t(e, o);
};
a.label = 1;

case 1:
a.trys.push([ 1, 3, , 4 ]);
return [ 4, r.default.getInstance().getGameBundle() ];

case 2:
a.sent().load(e, cc.AudioClip, o);
return [ 3, 4 ];

case 3:
n = a.sent();
l.default.error("preloadBundle error", n);
return [ 3, 4 ];

case 4:
return [ 2 ];
}
});
});
};
e._instance = null;
return e;
}();
o.default = u;
cc.Button.prototype._onTouchEnded = function(e) {
if (this.interactable && this.enabledInHierarchy) {
this.isNotPlaySound || u.Instance.playBundleEffect("resources/sound/common/common_button_click");
if (this._pressed) {
cc.Component.EventHandler.emitEvents(this.clickEvents, e);
this.node.emit("click", this);
}
this._pressed = !1;
this._updateState();
e.stopPropagation();
}
};
cc._RF.pop();
}, {
"../../../Game/BundleManager": "BundleManager",
"../../../platform/Platform": "Platform",
"../global/ResLoader": "ResLoader"
} ],
AutoSortNew: [ function(e, t, o) {
"use strict";
cc._RF.push(t, "6e991xizLVHiJ0/T3WNnjAa", "AutoSortNew");
Object.defineProperty(o, "__esModule", {
value: !0
});
o.group = void 0;
var n = e("../../../../Game/client/global/enum/game/Const"), a = e("../../../../Game/fromework/global/Tools"), i = e("../../../../platform/Platform"), r = [ 0, 10, 2, 3, 4, 5, 6, 7, 8, 9, 10, 10, 10, 10, 0, 0 ], l = {
65536: 256,
131072: 512,
196608: 512,
262144: 512,
1048576: 4096,
2097152: 8192,
3145728: 8192,
4194304: 8192,
1114112: 8192,
1179648: 8192,
1245184: 8192,
2162688: 8192,
2228224: 8192,
3211264: 8192
};
function s(e, t) {
for (var o = new Array(e), n = 0; n < e; n++) {
o[n] = new Array(t);
o[n].fill(0);
}
i.default.log("r: ", o);
return o;
}
function c(e, t) {
for (var o = 0, n = e.length; o < n; o++) Array.isArray(e[o]) ? c(e[o], t) : e[o] = t;
}
function u(e) {
for (var t = 0; e; ) {
e ^= e & -e;
t++;
}
return t;
}
o.group = function(e, t) {
t &= 15;
var o = {}, i = {
0: 0
}, d = {}, p = new Array(13), h = [], f = e.length, _ = 1 << f, m = 0, y = 0;
e.sort(function(e, t) {
return e - t;
});
var g = s(4, 14), v = g[0], C = [ 0, 0, 0, 0 ];
r.slice(0)[t] = 0;
function b(e, o, n, a) {
if (n > 14) return -1;
for (var i = 0, l = 0, s = o; s <= n; s++) {
var c = 14 == s ? 1 : s;
if (g[e][c]) {
c === t && a--;
i++;
l += r[c];
}
}
return i + a == n - o + 1 ? (0 === a ? 1048576 : 65536) | l : -1;
}
for (var I = function(e) {
var o = -1;
c(g, 0);
c(C, 0);
for (var n = 0, a = 0, i = !0, l = !0, s = -1, u = -1, d = 0; d < e; d++) {
var h = 15 & p[d];
if (65 != p[d] && 66 != p[d]) {
var f = p[d] >> 4;
C[f] && (i = !1);
if (h !== t) {
if (-1 === s) {
s = f;
u = h;
}
if (1 === g[f][h]) return o;
s != f && (l = !1);
u != h && (i = !1);
} else a++;
g[f][h]++;
C[f]++;
} else n++;
}
if (e === n) return o;
var _ = n + a;
if (e <= 4 && i) return (e - _) * r[u];
if (l) {
o = b(s, u, u + e - 1, _);
if (1 === u) {
var m = -1;
for (d = 2; d <= 13; d++) if (g[s][d]) {
m = d;
break;
}
m > 0 && (o = Math.max(o, b(s, m, m + e - 1, _)));
}
return o;
}
return o;
}, E = 7, S = 0; E < _; E++) if (!(u(E) < 3)) {
S = 0;
for (var T = 0, R = E; T < f && R; T++, R >>= 1) 1 & R && (p[S++] = e[T]);
var O = I(S);
O > 0 && (o[E] = O);
}
for (E = 7; E < _; E++) for (T = E; 0 != T; T = T - 1 & E) if (void 0 !== o[T] && void 0 !== i[S = E ^ T]) {
var A = i[S] + o[T], P = 16711680 & A, M = l[P] | 255 & A;
if (M > (65535 & i[E])) {
i[E] = P | M;
d[E] = T;
if (M > m) {
m = M;
y = E;
} else if (M == m && u(E) > u(y)) {
m = M;
y = E;
}
}
}
for (;y; ) {
var G = d[y], w = [];
for (E = 0; E < f; E++) if (1 << E & G) {
v[E] = -1;
w.push(e[E]);
}
i[0] += w.length;
h.push(w);
y ^= d[y];
}
i[0] !== f && function(t, o) {
for (var i = {}, r = 0, l = 0, s = 0; s < t; s++) -1 !== v[s] && (i[l = (r = e[s]) >> 4] ? i[l].push(r) : i[l] = [ r ]);
var c = Object.values(i);
if (o.length + c.length > n.MAX_GROUPCOUNT) if (n.MAX_GROUPCOUNT - o.length == 1) c = [ a.Tools.TArray.flatten(c) ]; else if (n.MAX_GROUPCOUNT - o.length == 2) {
var u = c.shift();
c = [ u, a.Tools.TArray.flatten(c) ];
} else if (n.MAX_GROUPCOUNT - o.length == 3) {
u = c.shift();
var d = c.shift();
c = [ u, d, a.Tools.TArray.flatten(c) ];
} else c = [ a.Tools.TArray.flatten(c) ];
o.push.apply(o, c);
}(f, h);
return h;
};
cc._RF.pop();
}, {
"../../../../Game/client/global/enum/game/Const": "Const",
"../../../../Game/fromework/global/Tools": "Tools",
"../../../../platform/Platform": "Platform"
} ],
AutoSort: [ function(e, t, o) {
"use strict";
cc._RF.push(t, "cc8bfpo8U5GF6skCax88i3i", "AutoSort");
Object.defineProperty(o, "__esModule", {
value: !0
});
var n = e("../../../../../Game/client/global/enum/game/Const"), a = e("../../../../../Game/fromework/global/Tools"), i = e("../GameHelper"), r = e("./CheckTools"), l = e("./PureSequence"), s = e("./Sequence"), c = e("./Set"), u = function() {
function e() {
this._maxScore = 0;
this._maxCardsCount = 0;
}
Object.defineProperty(e, "Instance", {
get: function() {
e._Instance || (e._Instance = new e());
return e._Instance;
},
enumerable: !1,
configurable: !0
});
e.prototype.init = function(e, t) {
this._maxScore = e;
this._maxCardsCount = t;
};
e.prototype.getHands = function(e, t) {
var o = a.Tools.TArray.deepCopy(e);
if (a.Tools.TArray.getLength(o) == this._maxCardsCount + 1) {
for (var u = o[o.length - 1].pop(), d = !1, p = 0; p < o.length; p++) {
var h = a.Tools.TArray.deepCopy(o[p]);
h.push(u);
h.sort(function(e, t) {
return e - t;
});
if (i.GroupHelper.checkPureSequence(h) || i.GroupHelper.checkSequence(h, t) || i.GroupHelper.checkSet(h, t)) {
o[p] = h;
d = !0;
break;
}
}
d || (o = a.Tools.TArray.deepCopy(e));
}
var f = i.GroupHelper.getTotalScore(o, t, this._maxScore, this._maxCardsCount), _ = r.default.group(e), m = r.default.getXCards(_, t), y = r.default.deleteSame(_, [ m ]), g = [], v = [], C = [], b = [], I = [], E = [], S = [], T = [], R = function(e) {
var t, o = l.default.getMaxOnePs(e), n = c.default.getMaxOneRealSet(a.Tools.TArray.flatten(e)), i = [];
if (o.length <= 0 && n.length <= 0) return [];
if (r.default.getRealScore(o) >= r.default.getRealScore(n)) {
i = [ o ];
I.push(o);
} else {
i = [ n ];
S.push(n);
}
t = r.default.deleteSame(e, i);
return i.concat(R(t));
}, O = function(e) {
var t, o = s.default.getMaxOneSequ(e), n = c.default.getMaxOneSet(a.Tools.TArray.flatten(e)), i = [];
if (o.length <= 0 && n.length <= 0) return [];
i = r.default.getRealScore(o) >= r.default.getRealScore(n) ? [ o ] : [ n ];
t = r.default.deleteSame(e, i);
return i.concat(O(t));
}, A = l.default.getMaxOnePs(y);
if (A.length <= 0) {
A = l.default.getMaxOnePs(_);
for (p = 0; p < A.length; p++) if (i.GroupHelper.checkWild(A[p], t)) for (var P = 0; P < m.length; P++) if (m[P] == A[p]) {
m.splice(P, 1);
break;
}
}
if (!(A.length > 0)) return _;
I.push(A);
g = r.default.deleteSame(y, [ A ]);
if ((A = l.default.getMaxOnePs(g)).length > 0) I.push(A); else if (m.length > 0) {
var M = s.default.getMaxOneSequ(g);
r.default.addXCardToSuit(M, m);
E.push(M);
}
v = I.concat(E);
g = r.default.deleteSame(y, v);
b = v.concat(R(g));
g = r.default.deleteSame(y, b);
C = O(g);
for (;C.length > 0 && m.length > 0; ) {
var G = C.shift(), w = r.default.addXCardToSuit(G, m);
if (-1 != w) {
1 == w ? E.push(G) : 0 == w && T.push(G);
b.push(G);
}
}
g = r.default.deleteSame(g, b);
l.default.downwardChangePS(I, g);
b = I.concat(E).concat(S).concat(T);
g = r.default.deleteSame(y, b);
R(g);
b = I.concat(E).concat(S).concat(T);
g = r.default.deleteSame(y, b);
s.default.downwardChangeSequ(E, g, t);
O(g);
b = I.concat(E).concat(S).concat(T);
g = r.default.deleteSame(y, b);
l.default.upwardChangePS(I, g);
b = I.concat(E).concat(S).concat(T);
g = r.default.deleteSame(y, b);
R(g);
b = I.concat(E).concat(S).concat(T);
g = r.default.deleteSame(y, b);
s.default.upwardChangeSequ(E, g, t);
O(g);
b = I.concat(E).concat(S).concat(T);
g = r.default.deleteSame(y, b);
l.default.linkAddPS(I, g);
b = I.concat(E).concat(S).concat(T);
g = r.default.deleteSame(y, b);
s.default.upAddSequence(E, g, t);
b = I.concat(E).concat(S).concat(T);
g = r.default.deleteSame(y, b);
s.default.downAddSequence(E, g, t);
b = I.concat(E).concat(S).concat(T);
g = r.default.deleteSame(y, b);
c.default.linkAddSet(S, g);
b = I.concat(E).concat(S).concat(T);
g = r.default.deleteSame(y, b);
c.default.linkAddSet(T, g);
b = I.concat(E).concat(S).concat(T);
g = r.default.deleteSame(y, b);
for (;m.length >= 2 && g.length > 0; ) {
var D = a.Tools.TArray.flatten(g);
D.sort(function(e, t) {
return i.GroupHelper.getFigure(t) - i.GroupHelper.getFigure(e);
});
E.push([ D[0], m.pop(), m.pop() ]);
b = I.concat(E).concat(S).concat(T);
g = r.default.deleteSame(y, b);
}
if (m.length > 0) for (p = m.length - 1; p >= 0; p--) b[b.length - 1].push(m.pop());
b = I.concat(E).concat(S).concat(T);
var L = r.default.deleteSame(_, b);
if (a.Tools.TArray.flatten(L).length <= 3) L = [ a.Tools.TArray.flatten(L) ]; else if (L.length + b.length > n.MAX_GROUPCOUNT) if (n.MAX_GROUPCOUNT - b.length == 1) L = [ a.Tools.TArray.flatten(L) ]; else if (n.MAX_GROUPCOUNT - b.length == 2) {
var B = L.shift();
L = [ B, N = a.Tools.TArray.flatten(L) ];
} else if (n.MAX_GROUPCOUNT - b.length == 3) {
B = L.shift();
var N = L.shift();
L = [ B, N, a.Tools.TArray.flatten(L) ];
} else L = [ a.Tools.TArray.flatten(L) ];
var k = b.concat(L);
for (p = k.length - 1; p >= 0; p--) k[p].length <= 0 && k.splice(p, 1);
return i.GroupHelper.getTotalScore(k, t, this._maxScore, this._maxCardsCount) <= f ? k : o;
};
e._Instance = null;
return e;
}();
o.default = u;
cc._RF.pop();
}, {
"../../../../../Game/client/global/enum/game/Const": "Const",
"../../../../../Game/fromework/global/Tools": "Tools",
"../GameHelper": "GameHelper",
"./CheckTools": "CheckTools",
"./PureSequence": "PureSequence",
"./Sequence": "Sequence",
"./Set": "Set"
} ],
Base64IN: [ function(e, t, o) {
"use strict";
cc._RF.push(t, "7c29f8D2ZNLn75JpZYsvx7b", "Base64IN");
Object.defineProperty(o, "__esModule", {
value: !0
});
var n = function() {
function e() {
this._keyStr = "ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=";
}
e.getInstance = function() {
e._Instance || (e._Instance = new e());
return e._Instance;
};
e.prototype.encode = function(e) {
var t, o, n, a, i, r, l, s = "", c = 0;
e = this._utf8_encode(e);
for (;c < e.length; ) {
a = (t = e.charCodeAt(c++)) >> 2;
i = (3 & t) << 4 | (o = e.charCodeAt(c++)) >> 4;
r = (15 & o) << 2 | (n = e.charCodeAt(c++)) >> 6;
l = 63 & n;
isNaN(o) ? r = l = 64 : isNaN(n) && (l = 64);
s = s + this._keyStr.charAt(a) + this._keyStr.charAt(i) + this._keyStr.charAt(r) + this._keyStr.charAt(l);
}
return s;
};
e.prototype.decode = function(e) {
var t, o, n, a, i, r, l = "", s = 0;
e = e.replace(/[^A-Za-z0-9]/g, "");
for (;s < e.length; ) {
t = this._keyStr.indexOf(e.charAt(s++)) << 2 | (a = this._keyStr.indexOf(e.charAt(s++))) >> 4;
o = (15 & a) << 4 | (i = this._keyStr.indexOf(e.charAt(s++))) >> 2;
n = (3 & i) << 6 | (r = this._keyStr.indexOf(e.charAt(s++)));
l += String.fromCharCode(t);
64 != i && (l += String.fromCharCode(o));
64 != r && (l += String.fromCharCode(n));
}
return this._utf8_decode(l);
};
e.prototype._utf8_encode = function(e) {
e = e.replace(/\r\n/g, "\n");
for (var t = "", o = 0; o < e.length; o++) {
var n = e.charCodeAt(o);
if (n < 128) t += String.fromCharCode(n); else if (n > 127 && n < 2048) {
t += String.fromCharCode(n >> 6 | 192);
t += String.fromCharCode(63 & n | 128);
} else {
t += String.fromCharCode(n >> 12 | 224);
t += String.fromCharCode(n >> 6 & 63 | 128);
t += String.fromCharCode(63 & n | 128);
}
}
return t;
};
e.prototype._utf8_decode = function(e) {
for (var t = "", o = 0, n = 0, a = 0, i = 0; o < e.length; ) if ((n = e.charCodeAt(o)) < 128) {
t += String.fromCharCode(n);
o++;
} else if (n > 191 && n < 224) {
a = e.charCodeAt(o + 1);
t += String.fromCharCode((31 & n) << 6 | 63 & a);
o += 2;
} else {
a = e.charCodeAt(o + 1);
i = e.charCodeAt(o + 2);
t += String.fromCharCode((15 & n) << 12 | (63 & a) << 6 | 63 & i);
o += 3;
}
return t;
};
e._Instance = null;
return e;
}();
o.default = n;
cc._RF.pop();
}, {} ],
BestDeclare: [ function(e, t, o) {
"use strict";
cc._RF.push(t, "fb5afUX4XZHKpyF9XQZwULW", "BestDeclare");
var n, a = this && this.__extends || (n = function(e, t) {
return (n = Object.setPrototypeOf || {
__proto__: []
} instanceof Array && function(e, t) {
e.__proto__ = t;
} || function(e, t) {
for (var o in t) Object.prototype.hasOwnProperty.call(t, o) && (e[o] = t[o]);
})(e, t);
}, function(e, t) {
n(e, t);
function o() {
this.constructor = e;
}
e.prototype = null === t ? Object.create(t) : (o.prototype = t.prototype, new o());
}), i = this && this.__decorate || function(e, t, o, n) {
var a, i = arguments.length, r = i < 3 ? t : null === n ? n = Object.getOwnPropertyDescriptor(t, o) : n;
if ("object" == typeof Reflect && "function" == typeof Reflect.decorate) r = Reflect.decorate(e, t, o, n); else for (var l = e.length - 1; l >= 0; l--) (a = e[l]) && (r = (i < 3 ? a(r) : i > 3 ? a(t, o, r) : a(t, o)) || r);
return i > 3 && r && Object.defineProperty(t, o, r), r;
};
Object.defineProperty(o, "__esModule", {
value: !0
});
var r = e("../../../Game/client/global/enum/game/Const"), l = e("../../../Game/client/logic/game/GameHelper"), s = e("../../../Game/client/logic/game/sort/AutoSort"), c = e("../Card"), u = e("../Group"), d = .8 * r.GROUP_DEFAULT_WIDTH, p = .8 * r.CARD_WIDTH, h = .8 * r.CARD_SHOW_WIDTH, f = cc._decorator, _ = f.ccclass, m = f.property, y = function(e) {
a(t, e);
function t() {
var t = null !== e && e.apply(this, arguments) || this;
t.Prefab_Card = null;
t.Prefab_Group = null;
t.BestScore = null;
t.CardParent = null;
t.Line = null;
t._idx16s = [];
t._group = [];
t._cards = [];
t._wildCard = 0;
t._maxScore = r.TOTAL_GAME_SCORE;
t._maxCardCount = 0;
return t;
}
t.prototype.show = function(e, t, o, n) {
this._wildCard = t;
this._maxScore = o;
this._maxCardCount = n;
this._idx16s = s.default.Instance.getHands(e, this._wildCard);
this.BestScore.node.active = !1;
this.createCards();
this.node.active = !0;
this.playAction();
};
t.prototype.createCards = function() {
var e = this, t = l.GroupHelper.getPokerHands(this._idx16s, this._wildCard, this._maxScore, this._maxCardCount), o = 0;
this._idx16s.forEach(function(n) {
var a = l.GroupHelper.getGroupType(n, e._wildCard), i = l.GroupHelper.getScore(n, t.hasPureSequence, t.sequCount, e._wildCard, e._maxCardCount), r = (n.length - 1) * h + d, s = o + r / 2;
o += r;
var p = cc.instantiate(e.Prefab_Group);
p.active = !1;
p.width = r;
p.setPosition(cc.v2(s, -60));
p.zIndex = 99;
p.parent = e.CardParent;
var f = p.getComponent(u.default);
f.initNoDetail(a, i, t.hasPureSequence, !1);
e._group.push(f);
n.forEach(function(t) {
var o = cc.instantiate(e.Prefab_Card);
o.active = !1;
o.setPosition(cc.v2(300, 0));
o.parent = e.CardParent;
var n = o.getComponent(c.default);
n.init(t, !0, e._wildCard);
e._cards.push(n);
});
});
this.CardParent.width = o;
this.Line.height = o + 190;
};
t.prototype.playAction = function() {
var e = this, t = [], o = 0;
this._idx16s.forEach(function(n, a) {
var i = e._group[a].node, r = i.x - i.width / 2 + (d - p) / 2 + p / 2;
n.forEach(function(n, a) {
var i = e._cards[o];
o++;
t.push(cc.callFunc(function() {
i.node.active = !0;
i.moveCard(.1, cc.v2(r + a * h, 0), .8, .8);
}));
t.push(cc.delayTime(.1));
});
t.push(cc.delayTime(.2));
t.push(cc.callFunc(function() {
i.active = !0;
}));
t.push(cc.delayTime(.1));
});
t.push(cc.callFunc(function() {
e.showScore();
}));
this.node.runAction(cc.sequence(t));
};
t.prototype.showScore = function() {
this.BestScore.string = String(l.GroupHelper.getTotalScore(this._idx16s, this._wildCard, this._maxScore, this._maxCardCount));
this.BestScore.node.scale = 0;
this.BestScore.node.active = !0;
this.BestScore.node.runAction(cc.sequence(cc.scaleTo(.1, 1.2), cc.scaleTo(.1, 1)));
};
t.prototype.close = function() {
this.onCloseClicked();
};
t.prototype.onCloseClicked = function() {
this._group.forEach(function(e) {
if (e.node && e.node.isValid) {
e.node.removeFromParent(!0);
e.node.destroy();
}
});
this._group.splice(0);
this._cards.forEach(function(e) {
if (e.node && e.node.isValid) {
e.node.removeFromParent(!0);
e.node.destroy();
}
});
this._cards.splice(0);
this._idx16s.splice(0);
if (this.node && this.node.isValid) {
this.node.stopAllActions();
this.node.removeFromParent(!0);
this.node.destroy();
}
};
i([ m(cc.Prefab) ], t.prototype, "Prefab_Card", void 0);
i([ m(cc.Prefab) ], t.prototype, "Prefab_Group", void 0);
i([ m(cc.Label) ], t.prototype, "BestScore", void 0);
i([ m(cc.Node) ], t.prototype, "CardParent", void 0);
i([ m(cc.Node) ], t.prototype, "Line", void 0);
return i([ _ ], t);
}(cc.Component);
o.default = y;
cc._RF.pop();
}, {
"../../../Game/client/global/enum/game/Const": "Const",
"../../../Game/client/logic/game/GameHelper": "GameHelper",
"../../../Game/client/logic/game/sort/AutoSort": "AutoSort",
"../Card": "Card",
"../Group": "Group"
} ],
BetBoxLayer: [ function(e, t, o) {
"use strict";
cc._RF.push(t, "aaa45WOaB9AsrJ6YWfPLkuZ", "BetBoxLayer");
var n, a = this && this.__extends || (n = function(e, t) {
return (n = Object.setPrototypeOf || {
__proto__: []
} instanceof Array && function(e, t) {
e.__proto__ = t;
} || function(e, t) {
for (var o in t) Object.prototype.hasOwnProperty.call(t, o) && (e[o] = t[o]);
})(e, t);
}, function(e, t) {
n(e, t);
function o() {
this.constructor = e;
}
e.prototype = null === t ? Object.create(t) : (o.prototype = t.prototype, new o());
}), i = this && this.__decorate || function(e, t, o, n) {
var a, i = arguments.length, r = i < 3 ? t : null === n ? n = Object.getOwnPropertyDescriptor(t, o) : n;
if ("object" == typeof Reflect && "function" == typeof Reflect.decorate) r = Reflect.decorate(e, t, o, n); else for (var l = e.length - 1; l >= 0; l--) (a = e[l]) && (r = (i < 3 ? a(r) : i > 3 ? a(t, o, r) : a(t, o)) || r);
return i > 3 && r && Object.defineProperty(t, o, r), r;
};
Object.defineProperty(o, "__esModule", {
value: !0
});
var r = e("../../../global/Global"), l = e("../../../../Game/fromework/global/Tools"), s = e("../../../../Game/fromework/helper/UIHelper"), c = e("../../../../fromework/component/TableView/TableList"), u = e("../../../global/PopHelper"), d = e("../../active/ActiveModel"), p = e("../../../../Game/fromework/helper/AudioHelper"), h = e("../../../model/UserModel"), f = e("../../../component/pop/tipsHand"), _ = cc._decorator, m = _.ccclass, y = _.property, g = function(e) {
a(t, e);
function t() {
var t = null !== e && e.apply(this, arguments) || this;
t.planeTreasure = null;
t.planeChest = null;
t.listTreasure = null;
t.listChest = null;
t.itemTreasure = null;
t.itemChest = null;
t.planeHistory = null;
t.toggle1 = null;
t.boxSpr = [];
t.buyBoxSpr = [];
t.boxPriceNum = [];
t.buyIndex = 0;
t.buyNum = 1;
t.betBoxData = null;
t.betBoxBuyData = null;
t.betBoxHistoryData = null;
t.isBuyBox = !1;
t.isCharged = !1;
t.boxIndex = 2;
t.boxPriceList = [];
t.betBoxSoreData = {};
return t;
}
t.prototype.start = function() {
var e = this;
this.isCharged = !1;
this.planeTreasure.active = !1;
d.ActiveProxy.Instance.getBetBoxData(function(t) {
if (t && e.node && e.node.isValid) {
var o = t.list;
o = o.sort(function(e, t) {
return e.atype - t.atype;
});
for (var n = 0; n < o.length; n++) if (e.betBoxSoreData[o[n].atype]) e.betBoxSoreData[o[n].atype].push(o[n]); else {
e.boxPriceList.push(o[n].atype);
e.boxPriceNum[e.boxPriceList.length - 1].string = "₹" + o[n].atype;
e.betBoxSoreData[o[n].atype] = [];
e.betBoxSoreData[o[n].atype].push(o[n]);
}
e.betBoxData = t;
e.showTreasureData();
}
});
d.ActiveProxy.Instance.getBuyedBetBoxData(function(t) {
if (t && e.node && e.node.isValid) for (var o = 0; o < t.activeInfos.length; o++) if (Number(t.activeInfos[o].buy_count) > 0) {
e.isBuyBox = !0;
e.isCharged = !0;
break;
}
});
if (0 == h.userSoundHavePlay.SOUND_TREASUEBOX_ONE) {
p.default.Instance.playBundleEffect("resources/sound/tipEffect/One", !1, null, !1, !0);
h.userSoundHavePlay.SOUND_TREASUEBOX_ONE = 1;
}
};
t.prototype.toggleClick = function(e, t) {
var o = this;
if (1 == t) {
this.planeTreasure.active = !0;
this.planeChest.active = !1;
this.planeHistory.active = !1;
} else if (2 == t) {
if (this.isBuyBox) {
this.planeTreasure.active = !1;
this.planeChest.active = !0;
this.planeHistory.active = !1;
d.ActiveProxy.Instance.getBuyedBetBoxData(function(e) {
if (e && o.node && o.node.isValid) {
o.betBoxBuyData = e;
o.showChestData();
}
});
} else this.toggle1.isChecked = !0;
this.isCharged || u.PopHelper.Instance.showTips("Available after any purchase");
} else if (3 == t) {
if (this.isBuyBox) {
this.planeTreasure.active = !1;
this.planeChest.active = !1;
this.planeHistory.active = !0;
d.ActiveProxy.Instance.historyBetBox(function(e) {
if (e && o.node && o.node.isValid) {
o.betBoxHistoryData = e;
o.showHistoryData();
}
});
} else this.toggle1.isChecked = !0;
this.isCharged || u.PopHelper.Instance.showTips("Available after any purchase");
}
};
t.prototype.toggleClickTreasure = function(e, t) {
1 == t ? this.boxIndex = 0 : 2 == t ? this.boxIndex = 1 : 3 == t && (this.boxIndex = 2);
this.showTreasureData();
};
t.prototype.showTreasureData = function() {
var e = this;
this.planeTreasure.active = !0;
this.listTreasure.getComponent(cc.ScrollView).content.destroyAllChildren();
this.scheduleOnce(function() {
for (var t = function(t) {
var o = e.betBoxSoreData[e.boxPriceList[e.boxIndex]][t], n = cc.instantiate(e.itemTreasure);
n.name = "box" + (t + 1);
n.active = !0;
n.setPosition(0, 26);
n.getChildByName("box_icon").getComponent(cc.Sprite).spriteFrame = e.buyBoxSpr[t];
n.parent = e.listTreasure.getComponent(cc.ScrollView).content;
n.getChildByName("change").active = !1;
e.buyIndex == t && (n.getChildByName("change").active = !0);
n.getComponent(cc.Sprite).spriteFrame = e.boxSpr[t];
n.info = {
index: t,
data: o
};
n.getChildByName("moneyLayout").getChildByName("money").getComponent(cc.Label).string = "" + o.total_reward / 1e3;
n.getChildByName("tipsLabel").getComponent(cc.Label).string = "₹ " + o.reward / 1e3 + "x" + (o.days - 1) + " days \nGet ₹1000 cash \nafter " + (o.days - 1) + " days";
n.on(cc.Node.EventType.TOUCH_END, function() {
for (var t = 1; t <= e.betBoxSoreData[e.boxPriceList[e.boxIndex]].length; t++) e.listTreasure.getComponent(cc.ScrollView).content.getChildByName("box" + t).getChildByName("change").active = !1;
e.listTreasure.getComponent(cc.ScrollView).content.getChildByName("box" + (n.info.index + 1)).getChildByName("change").active = !0;
e.buyIndex = n.info.index;
e.planeTreasure.getChildByName("btn_buy").getChildByName("text").getComponent(cc.Label).string = "Only ₹" + n.info.data.pay_qf / 1e3 * e.buyNum;
e.planeTreasure.getChildByName("btn_buy").getChildByName("tipsHand").active = !0;
e.planeTreasure.getChildByName("btn_buy").getChildByName("tipsHand").getComponent(f.default).show(n.info.data.pay_qf / 1e3 * e.buyNum);
}, e);
n.getChildByName("quan").getChildByName("numLabel").getComponent(cc.Label).string = o.rate;
}, o = 0; o < e.betBoxSoreData[e.boxPriceList[e.boxIndex]].length; o++) t(o);
e.planeTreasure.getChildByName("btn_buy").getChildByName("text").getComponent(cc.Label).string = "Only ₹" + e.listTreasure.getComponent(cc.ScrollView).content.getChildByName("box" + (e.buyIndex + 1)).info.data.pay_qf / 1e3 * e.buyNum;
e.planeTreasure.getChildByName("btn_buy").getChildByName("tipsHand").active = !0;
e.planeTreasure.getChildByName("btn_buy").getChildByName("tipsHand").getComponent(f.default).show(e.listTreasure.getComponent(cc.ScrollView).content.getChildByName("box" + (e.buyIndex + 1)).info.data.pay_qf / 1e3 * e.buyNum);
});
};
t.prototype.TreasureLeft = function() {
if (this.buyNum > 1) {
this.buyNum = this.buyNum - 1;
this.planeTreasure.getChildByName("numDi").getChildByName("num").getComponent(cc.Label).string = "" + this.buyNum;
this.planeTreasure.getChildByName("btn_buy").getChildByName("text").getComponent(cc.Label).string = "Only ₹" + this.listTreasure.getComponent(cc.ScrollView).content.getChildByName("box" + (this.buyIndex + 1)).info.data.pay_qf / 1e3 * this.buyNum;
this.planeTreasure.getChildByName("btn_buy").getChildByName("tipsHand").active = !0;
this.planeTreasure.getChildByName("btn_buy").getChildByName("tipsHand").getComponent(f.default).show(this.listTreasure.getComponent(cc.ScrollView).content.getChildByName("box" + (this.buyIndex + 1)).info.data.pay_qf / 1e3 * this.buyNum);
this.buyNum <= 1 && (this.planeTreasure.getChildByName("left").getComponent(cc.Button).interactable = !1);
19 == this.buyNum && (this.planeTreasure.getChildByName("right").getComponent(cc.Button).interactable = !0);
}
};
t.prototype.TreasureRight = function() {
if (this.buyNum < 20) {
this.buyNum = this.buyNum + 1;
this.planeTreasure.getChildByName("numDi").getChildByName("num").getComponent(cc.Label).string = "" + this.buyNum;
this.planeTreasure.getChildByName("btn_buy").getChildByName("text").getComponent(cc.Label).string = "Only ₹" + this.listTreasure.getComponent(cc.ScrollView).content.getChildByName("box" + (this.buyIndex + 1)).info.data.pay_qf / 1e3 * this.buyNum;
this.planeTreasure.getChildByName("btn_buy").getChildByName("tipsHand").active = !0;
this.planeTreasure.getChildByName("btn_buy").getChildByName("tipsHand").getComponent(f.default).show(this.listTreasure.getComponent(cc.ScrollView).content.getChildByName("box" + (this.buyIndex + 1)).info.data.pay_qf / 1e3 * this.buyNum);
this.buyNum >= 20 && (this.planeTreasure.getChildByName("right").getComponent(cc.Button).interactable = !1);
2 == this.buyNum && (this.planeTreasure.getChildByName("left").getComponent(cc.Button).interactable = !0);
}
};
t.prototype.TreasureBuyClick = function() {
this.betBoxSoreData && this.betBoxSoreData[this.boxPriceList[this.boxIndex]] && d.ActiveProxy.Instance.buyBetBox(this.betBoxSoreData[this.boxPriceList[this.boxIndex]][this.buyIndex].active_id, this.buyNum, function() {});
};
t.prototype.showChestData = function() {
var e = this;
this.listChest.getComponent(cc.ScrollView).content.destroyAllChildren();
for (var t = function(t) {
var n = cc.instantiate(o.itemChest);
n.active = !0;
n.setPosition(0, 28);
n.parent = o.listChest.getComponent(cc.ScrollView).content;
var a = 0;
30 == o.betBoxBuyData.activeInfos[t].days ? a = 1 : 60 == o.betBoxBuyData.activeInfos[t].days && (a = 2);
n.getChildByName("box_tong").getComponent(cc.Sprite).spriteFrame = o.buyBoxSpr[a];
n.getComponent(cc.Sprite).spriteFrame = o.boxSpr[a];
n.getChildByName("money").getComponent(cc.Label).string = "Cash ₹" + o.betBoxBuyData.activeInfos[t].reward / 1e3;
n.getChildByName("tipsLabel").getComponent(cc.Label).string = "₹" + o.betBoxBuyData.activeInfos[t].bet / 1e3;
n.getChildByName("num").getComponent(cc.Label).string = Number(o.betBoxBuyData.activeInfos[t].buy_count) - Number(o.betBoxBuyData.activeInfos[t].recv_count) + "/" + o.betBoxBuyData.activeInfos[t].buy_count;
n.off(cc.Node.EventType.TOUCH_END);
n.on(cc.Node.EventType.TOUCH_END, function() {
Number(e.betBoxBuyData.activeInfos[t].buy_count) - Number(e.betBoxBuyData.activeInfos[t].recv_count) > 0 && (e.betBoxBuyData.activeInfos[t].bet > e.betBoxBuyData.bet || 0 == e.betBoxBuyData.activeInfos[t].status ? u.PopHelper.Instance.showTips("The amount is insufficient, please go to the game to bet, you still need ₹" + Math.ceil((e.betBoxBuyData.activeInfos[t].bet - e.betBoxBuyData.bet) / 1e3) + " bet value") : d.ActiveProxy.Instance.getBetBoxAward(e.betBoxBuyData.activeInfos[t].active_id, function(t) {
u.PopHelper.Instance.showReward(r.Global.Instance.changeReward({
1: t.amount / 1e3
}), function() {
d.ActiveProxy.Instance.getBuyedBetBoxData(function(t) {
if (t && e.node && e.node.isValid) {
e.betBoxBuyData = t;
e.showChestData();
}
});
});
}));
}, o);
n.getChildByName("RedDot").active = !1;
Number(o.betBoxBuyData.activeInfos[t].buy_count) - Number(o.betBoxBuyData.activeInfos[t].recv_count) > 0 && o.betBoxBuyData.activeInfos[t].bet <= o.betBoxBuyData.bet && 0 != o.betBoxBuyData.activeInfos[t].status && (n.getChildByName("RedDot").active = !0);
}, o = this, n = 0; n < this.betBoxBuyData.activeInfos.length; n++) t(n);
this.planeChest.getChildByName("num").getComponent(cc.Label).string = "₹" + this.betBoxBuyData.bet / 1e3;
if (this.betBoxBuyData.return_list && null != this.betBoxBuyData.return_list[0] && this.betBoxBuyData.return_list[0].amount && this.betBoxBuyData.return_list[0].amount > 0) {
this.planeChest.getChildByName("btn_get").active = !0;
this.planeChest.getChildByName("btn_get").getChildByName("text").getComponent(cc.Label).string = "Get ₹" + this.betBoxBuyData.return_list[0].amount / 1e3;
if (this.betBoxBuyData.return_list[0].second > 0) {
var a = this.betBoxBuyData.return_list[0].second;
this.planeChest.getChildByName("btn_get").getChildByName("RedDot").active = !1;
this.planeChest.getChildByName("btn_get").getChildByName("time").active = !0;
this.planeChest.getChildByName("btn_get").getChildByName("need").active = !1;
this.planeChest.getChildByName("btn_get").getComponent(cc.Button).interactable = !1;
var i = l.Tools.TDate.second2Day(this.betBoxBuyData.return_list[0].second), s = String(i.hour), c = String(i.minu), p = String(i.sec);
i.hour < 10 && (s = "0" + i.hour);
i.minu < 10 && (c = "0" + i.minu);
i.sec < 10 && (p = "0" + i.sec);
this.planeChest.getChildByName("btn_get").getChildByName("time").getComponent(cc.Label).unscheduleAllCallbacks();
this.planeChest.getChildByName("btn_get").getChildByName("time").getComponent(cc.Label).string = i.day + "days " + s + ":" + c + ":" + p;
this.planeChest.getChildByName("btn_get").getChildByName("time").getComponent(cc.Label).schedule(function() {
if ((a -= 1) >= 0) {
i = l.Tools.TDate.second2Day(a);
s = String(i.hour);
c = String(i.minu);
p = String(i.sec);
i.hour < 10 && (s = "0" + i.hour);
i.minu < 10 && (c = "0" + i.minu);
i.sec < 10 && (p = "0" + i.sec);
e.planeChest.getChildByName("btn_get").getChildByName("time").getComponent(cc.Label).string = i.day + "days " + s + ":" + c + ":" + p;
} else {
a = 0;
e.planeChest.getChildByName("btn_get").getChildByName("time").getComponent(cc.Label).unscheduleAllCallbacks();
}
}, 1);
} else {
0 != this.betBoxBuyData.return_list[0].status ? this.planeChest.getChildByName("btn_get").getChildByName("RedDot").active = !0 : this.planeChest.getChildByName("btn_get").getChildByName("RedDot").active = !1;
this.planeChest.getChildByName("btn_get").getChildByName("time").active = !1;
this.planeChest.getChildByName("btn_get").getComponent(cc.Button).interactable = !0;
this.planeChest.getChildByName("btn_get").getChildByName("need").active = !0;
this.planeChest.getChildByName("btn_get").getChildByName("need").getComponent(cc.Label).string = "Need to bet ₹" + this.betBoxBuyData.return_list[0].amount / 100;
}
} else this.planeChest.getChildByName("btn_get").active = !1;
};
t.prototype.ChestGetClick = function() {
var e = this;
0 == this.betBoxBuyData.return_list[0].status ? u.PopHelper.Instance.showTips("The amount is insufficient, please go to the game to bet, you still need ₹" + Math.ceil(this.betBoxBuyData.return_list[0].amount / 100 - this.betBoxBuyData.bet / 1e3) + " bet value") : d.ActiveProxy.Instance.getBetBoxReturnAward(function(t) {
u.PopHelper.Instance.showReward(r.Global.Instance.changeReward({
1: t.amount / 1e3
}), function() {
d.ActiveProxy.Instance.getBuyedBetBoxData(function(t) {
if (t && e.node && e.node.isValid) {
e.betBoxBuyData = t;
e.showChestData();
}
});
});
});
};
t.prototype.showHistoryData = function() {
if (this.betBoxHistoryData && this.betBoxHistoryData.length > 0) {
this.planeHistory.getChildByName("noNode").active = !1;
this.planeHistory.getChildByName("HistoryTableList").getComponent(c.default).numItems = this.betBoxHistoryData.length;
} else {
this.planeHistory.getChildByName("HistoryTableList").getComponent(c.default).numItems = 0;
this.planeHistory.getChildByName("noNode").active = !0;
}
};
t.prototype.onListRender = function(e, t) {
e.active = !0;
var o = this.betBoxHistoryData[t];
e.getChildByName("time").getComponent(cc.Label).string = "" + o.buyDay;
e.getChildByName("num").getComponent(cc.Label).string = "" + o.buyCount;
e.getChildByName("name").getComponent(cc.Label).string = this.betBoxData.list[Number(o.treasureId) - 1].days + " days treasure";
};
t.prototype.closeClick = function() {
this.planeChest.getChildByName("btn_get").getChildByName("time").getComponent(cc.Label).unscheduleAllCallbacks();
s.default.Instance.removeMaskLayer(this.node, !0);
};
i([ y(cc.Node) ], t.prototype, "planeTreasure", void 0);
i([ y(cc.Node) ], t.prototype, "planeChest", void 0);
i([ y(cc.Node) ], t.prototype, "listTreasure", void 0);
i([ y(cc.Node) ], t.prototype, "listChest", void 0);
i([ y(cc.Node) ], t.prototype, "itemTreasure", void 0);
i([ y(cc.Node) ], t.prototype, "itemChest", void 0);
i([ y(cc.Node) ], t.prototype, "planeHistory", void 0);
i([ y(cc.Toggle) ], t.prototype, "toggle1", void 0);
i([ y(cc.SpriteFrame) ], t.prototype, "boxSpr", void 0);
i([ y(cc.SpriteFrame) ], t.prototype, "buyBoxSpr", void 0);
i([ y(cc.Label) ], t.prototype, "boxPriceNum", void 0);
return i([ m ], t);
}(cc.Component);
o.default = g;
cc._RF.pop();
}, {
"../../../../Game/fromework/global/Tools": "Tools",
"../../../../Game/fromework/helper/AudioHelper": "AudioHelper",
"../../../../Game/fromework/helper/UIHelper": "UIHelper",
"../../../../fromework/component/TableView/TableList": "TableList",
"../../../component/pop/tipsHand": "tipsHand",
"../../../global/Global": "Global",
"../../../global/PopHelper": "PopHelper",
"../../../model/UserModel": "UserModel",
"../../active/ActiveModel": "ActiveModel"
} ],
BhvButtonGroup: [ function(e, t, o) {
"use strict";
cc._RF.push(t, "740bf8Qz/xOqZWlNGUr7dJM", "BhvButtonGroup");
var n, a = this && this.__extends || (n = function(e, t) {
return (n = Object.setPrototypeOf || {
__proto__: []
} instanceof Array && function(e, t) {
e.__proto__ = t;
} || function(e, t) {
for (var o in t) Object.prototype.hasOwnProperty.call(t, o) && (e[o] = t[o]);
})(e, t);
}, function(e, t) {
n(e, t);
function o() {
this.constructor = e;
}
e.prototype = null === t ? Object.create(t) : (o.prototype = t.prototype, new o());
}), i = this && this.__decorate || function(e, t, o, n) {
var a, i = arguments.length, r = i < 3 ? t : null === n ? n = Object.getOwnPropertyDescriptor(t, o) : n;
if ("object" == typeof Reflect && "function" == typeof Reflect.decorate) r = Reflect.decorate(e, t, o, n); else for (var l = e.length - 1; l >= 0; l--) (a = e[l]) && (r = (i < 3 ? a(r) : i > 3 ? a(t, o, r) : a(t, o)) || r);
return i > 3 && r && Object.defineProperty(t, o, r), r;
};
Object.defineProperty(o, "__esModule", {
value: !0
});
var r, l = cc._decorator, s = l.ccclass, c = l.property, u = l.menu;
(function(e) {
e[e.CHILDREN_INDEX = 0] = "CHILDREN_INDEX";
e[e.CHILDREN_NAME = 1] = "CHILDREN_NAME";
})(r || (r = {}));
var d = function(e) {
a(t, e);
function t() {
var t = null !== e && e.apply(this, arguments) || this;
t.transition = cc.Button.Transition.NONE;
t.hoverColor = cc.color(255, 255, 255);
t.normalColor = cc.color(214, 214, 214);
t.pressedColor = cc.color(211, 211, 211);
t.disabledColor = cc.color(124, 124, 124);
t.normalSprite = null;
t.pressedSprite = null;
t.hoverSprite = null;
t.disabledSprite = null;
t.duration = 1;
t.zoomScale = 1.1;
t.paramType = r.CHILDREN_INDEX;
t.touchEvents = [];
return t;
}
t.prototype.onLoad = function() {
var e = this;
this.node.children.forEach(function(t, o) {
var n = t.getComponent(cc.Button);
n || (n = t.addComponent(cc.Button));
n.target = t;
n.transition = e.transition;
n.zoomScale = e.zoomScale;
n.disabledSprite = e.disabledSprite;
n.hoverSprite = e.hoverSprite;
n.normalSprite = e.normalSprite;
n.pressedSprite = e.pressedSprite;
n.hoverColor = e.hoverColor;
n.normalColor = e.normalColor;
n.pressedColor = e.pressedColor;
n.disabledColor = e.disabledColor;
e.touchEvents.forEach(function(a) {
var i = new cc.Component.EventHandler();
i.target = a.target;
i.handler = a.handler;
i.component = a.component;
i._componentId = a._componentId;
e.paramType === r.CHILDREN_INDEX ? i.customEventData = o.toString() : i.customEventData = t.name;
n.clickEvents.push(i);
});
});
};
i([ c({
type: cc.Enum(cc.Button.Transition)
}) ], t.prototype, "transition", void 0);
i([ c({
visible: function() {
return this.transition === cc.Button.Transition.COLOR;
}
}) ], t.prototype, "hoverColor", void 0);
i([ c({
visible: function() {
return this.transition === cc.Button.Transition.COLOR;
}
}) ], t.prototype, "normalColor", void 0);
i([ c({
visible: function() {
return this.transition === cc.Button.Transition.COLOR;
}
}) ], t.prototype, "pressedColor", void 0);
i([ c({
visible: function() {
return this.transition === cc.Button.Transition.COLOR;
}
}) ], t.prototype, "disabledColor", void 0);
i([ c({
type: cc.SpriteFrame,
visible: function() {
return this.transition === cc.Button.Transition.SPRITE;
}
}) ], t.prototype, "normalSprite", void 0);
i([ c({
type: cc.SpriteFrame,
visible: function() {
return this.transition === cc.Button.Transition.SPRITE;
}
}) ], t.prototype, "pressedSprite", void 0);
i([ c({
type: cc.SpriteFrame,
visible: function() {
return this.transition === cc.Button.Transition.SPRITE;
}
}) ], t.prototype, "hoverSprite", void 0);
i([ c({
type: cc.SpriteFrame,
visible: function() {
return this.transition === cc.Button.Transition.SPRITE;
}
}) ], t.prototype, "disabledSprite", void 0);
i([ c({
visible: function() {
return this.transition === cc.Button.Transition.SCALE || this.transition === cc.Button.Transition.COLOR;
}
}) ], t.prototype, "duration", void 0);
i([ c({
visible: function() {
return this.transition === cc.Button.Transition.SCALE;
}
}) ], t.prototype, "zoomScale", void 0);
i([ c({
type: cc.Enum(r)
}) ], t.prototype, "paramType", void 0);
i([ c([ cc.Component.EventHandler ]) ], t.prototype, "touchEvents", void 0);
return i([ s, u("添加特殊行为/Input/Button Group(一组按钮控制)") ], t);
}(cc.Component);
o.default = d;
cc._RF.pop();
}, {} ],
BhvFrameIndex: [ function(e, t, o) {
"use strict";
cc._RF.push(t, "6b63aFxTF1DNa6+PUJS2AHR", "BhvFrameIndex");
var n, a = this && this.__extends || (n = function(e, t) {
return (n = Object.setPrototypeOf || {
__proto__: []
} instanceof Array && function(e, t) {
e.__proto__ = t;
} || function(e, t) {
for (var o in t) Object.prototype.hasOwnProperty.call(t, o) && (e[o] = t[o]);
})(e, t);
}, function(e, t) {
n(e, t);
function o() {
this.constructor = e;
}
e.prototype = null === t ? Object.create(t) : (o.prototype = t.prototype, new o());
}), i = this && this.__decorate || function(e, t, o, n) {
var a, i = arguments.length, r = i < 3 ? t : null === n ? n = Object.getOwnPropertyDescriptor(t, o) : n;
if ("object" == typeof Reflect && "function" == typeof Reflect.decorate) r = Reflect.decorate(e, t, o, n); else for (var l = e.length - 1; l >= 0; l--) (a = e[l]) && (r = (i < 3 ? a(r) : i > 3 ? a(t, o, r) : a(t, o)) || r);
return i > 3 && r && Object.defineProperty(t, o, r), r;
};
Object.defineProperty(o, "__esModule", {
value: !0
});
var r = cc._decorator, l = r.ccclass, s = r.property, c = r.executeInEditMode, u = r.requireComponent, d = r.menu, p = function(e) {
a(t, e);
function t() {
var t = null !== e && e.apply(this, arguments) || this;
t.spriteFrames = [ null ];
t._index = 0;
return t;
}
Object.defineProperty(t.prototype, "index", {
get: function() {
return this._index;
},
set: function(e) {
if (!(e < 0)) {
this._index = e % this.spriteFrames.length;
this.node.getComponent(cc.Sprite).spriteFrame = this.spriteFrames[this._index];
}
},
enumerable: !1,
configurable: !0
});
t.prototype.setName = function(e) {
var t = this.spriteFrames.findIndex(function(t) {
return t.name == e;
});
t < 0 && Platform.error("frameIndex 设置了不存在的name:", e);
this.index = t || 0;
};
t.prototype.random = function(e, t) {
if (this.spriteFrames) {
var o = this.spriteFrames.length;
(null == e || e < 0) && (e = 0);
(null == t || t > o) && (t = o);
this.index = Math.floor(Math.random() * (t - e) + e);
}
};
t.prototype.next = function() {
this.index++;
};
t.prototype.previous = function() {
this.index--;
};
i([ s({
type: [ cc.SpriteFrame ],
tooltip: "sprite将会用到帧图片"
}) ], t.prototype, "spriteFrames", void 0);
i([ s({
tooltip: "当前显示的帧图",
type: cc.Integer
}) ], t.prototype, "index", null);
i([ s ], t.prototype, "_index", void 0);
return i([ l, c, u(cc.Sprite), d("添加特殊行为/UI/Frame Index(帧图改变)") ], t);
}(cc.Component);
o.default = p;
cc._RF.pop();
}, {} ],
BhvRollNumber: [ function(e, t, o) {
"use strict";
cc._RF.push(t, "cb7adow4zJP95wZ3X9Z741A", "BhvRollNumber");
var n, a = this && this.__extends || (n = function(e, t) {
return (n = Object.setPrototypeOf || {
__proto__: []
} instanceof Array && function(e, t) {
e.__proto__ = t;
} || function(e, t) {
for (var o in t) Object.prototype.hasOwnProperty.call(t, o) && (e[o] = t[o]);
})(e, t);
}, function(e, t) {
n(e, t);
function o() {
this.constructor = e;
}
e.prototype = null === t ? Object.create(t) : (o.prototype = t.prototype, new o());
}), i = this && this.__decorate || function(e, t, o, n) {
var a, i = arguments.length, r = i < 3 ? t : null === n ? n = Object.getOwnPropertyDescriptor(t, o) : n;
if ("object" == typeof Reflect && "function" == typeof Reflect.decorate) r = Reflect.decorate(e, t, o, n); else for (var l = e.length - 1; l >= 0; l--) (a = e[l]) && (r = (i < 3 ? a(r) : i > 3 ? a(t, o, r) : a(t, o)) || r);
return i > 3 && r && Object.defineProperty(t, o, r), r;
};
Object.defineProperty(o, "__esModule", {
value: !0
});
var r, l = cc._decorator, s = l.ccclass, c = l.property, u = l.menu;
(function(e) {
e[e.INTEGER = 0] = "INTEGER";
e[e.FIXED_2 = 1] = "FIXED_2";
e[e.TIMER = 2] = "TIMER";
e[e.PERCENTAGE = 3] = "PERCENTAGE";
e[e.KMBT_FIXED2 = 4] = "KMBT_FIXED2";
e[e.CUSTOMER = 5] = "CUSTOMER";
})(r || (r = {}));
var d = function(e) {
a(t, e);
function t() {
var t = null !== e && e.apply(this, arguments) || this;
t.label = null;
t.value = 0;
t.showPlusSymbol = !1;
t._targetValue = 100;
t.lerp = .1;
t.playAtStart = !0;
t.runWaitTimer = 0;
t.valueType = r.INTEGER;
t._custom_callback = null;
t.isScrolling = !1;
t._lastLabelText = "";
return t;
}
Object.defineProperty(t.prototype, "targetValue", {
get: function() {
return this._targetValue;
},
set: function(e) {
this._targetValue = e;
this.scroll();
},
enumerable: !1,
configurable: !0
});
t.prototype.onLoad = function() {
null == this.label && (this.label = this.node.getComponent(cc.Label));
if (this.playAtStart) {
this.updateLabel();
this.scroll();
}
};
t.prototype.scroll = function() {
var e = this;
this.isScrolling || (this.runWaitTimer > 0 ? this.scheduleOnce(function() {
e.isScrolling = !0;
}, this.runWaitTimer) : this.isScrolling = !0);
};
t.prototype.stop = function() {
this.value = this.targetValue;
this.isScrolling = !1;
this.updateLabel();
};
t.prototype.init = function(e, t, o) {
this.targetValue = t || 0;
this.value = e || 0;
this.lerp = o || .1;
};
t.prototype.scrollTo = function(e) {
null != e && (this.targetValue = e);
};
t.prototype.updateLabel = function() {
var e = this.value, t = "";
switch (this.valueType) {
case r.INTEGER:
t = Math.round(e) + "";
break;

case r.FIXED_2:
t = e.toFixed(2);
break;

case r.TIMER:
t = p(e);
break;

case r.PERCENTAGE:
t = Math.round(100 * e) + "%";
break;

case r.KMBT_FIXED2:
t = e >= Number.MAX_VALUE ? "MAX" : e > 1e12 ? (e / 1e12).toFixed(2) + "T" : e > 1e9 ? (e / 1e9).toFixed(2) + "B" : e > 1e6 ? (e / 1e6).toFixed(2) + "M" : e > 1e3 ? (e / 1e3).toFixed(2) + "K" : Math.round(e).toString();
break;

case r.CUSTOMER:
this._custom_callback && (t = this._custom_callback(this.value, this.targetValue));
}
this.showPlusSymbol && (e > 0 ? t = "+" + t : e < 0 && (t = "-" + t));
if (this.label) {
if (t === this.label.string) return;
this.label.string = t;
}
};
t.prototype.update = function() {
if (0 != this.isScrolling) {
this.value = cc.misc.lerp(this.value, this.targetValue, this.lerp);
this.updateLabel();
if (Math.abs(this.value - this.targetValue) <= 1e-4) {
this.value = this.targetValue;
this.isScrolling = !1;
}
}
};
i([ c({
type: cc.Label,
tooltip: "需要滚动的 Label 组件,如果不进行设置，就会从自己的节点自动查找"
}) ], t.prototype, "label", void 0);
i([ c({
tooltip: "当前的滚动值(开始的滚动值)"
}) ], t.prototype, "value", void 0);
i([ c({
tooltip: "是否显示正负符号"
}) ], t.prototype, "showPlusSymbol", void 0);
i([ c({
tooltip: "滚动的目标值"
}) ], t.prototype, "targetValue", null);
i([ c ], t.prototype, "_targetValue", void 0);
i([ c({
tooltip: "滚动的线性差值",
step: .01,
max: 1,
min: 0
}) ], t.prototype, "lerp", void 0);
i([ c({
tooltip: "是否在开始时就播放"
}) ], t.prototype, "playAtStart", void 0);
i([ c({
tooltip: "在滚动之前会等待几秒",
step: .1,
max: 1,
min: 0
}) ], t.prototype, "runWaitTimer", void 0);
i([ c({
type: cc.Enum(r),
tooltip: "是否在开始时就播放"
}) ], t.prototype, "valueType", void 0);
return i([ s, u("添加特殊行为/UI/Roll Number (滚动数字)") ], t);
}(cc.Component);
o.default = d;
function p(e, t) {
void 0 === e && (e = 0);
void 0 === t && (t = !0);
var o = Math.floor(e), n = Math.floor(o / 3600), a = Math.floor(o % 3600 / 60), i = o % 60, r = "" + a, l = "" + i;
i < 10 && (l = "0" + i);
if (t) {
a < 10 && (r = "0" + a);
return n + ":" + r + ":" + l;
}
r = "" + (a + 60 * n);
a < 10 && (r = "0" + a);
return r + ":" + l;
}
cc._RF.pop();
}, {} ],
BhvSwitchPage: [ function(e, t, o) {
"use strict";
cc._RF.push(t, "f28f6REBN9G2YOmfzdm6bVB", "BhvSwitchPage");
var n, a = this && this.__extends || (n = function(e, t) {
return (n = Object.setPrototypeOf || {
__proto__: []
} instanceof Array && function(e, t) {
e.__proto__ = t;
} || function(e, t) {
for (var o in t) Object.prototype.hasOwnProperty.call(t, o) && (e[o] = t[o]);
})(e, t);
}, function(e, t) {
n(e, t);
function o() {
this.constructor = e;
}
e.prototype = null === t ? Object.create(t) : (o.prototype = t.prototype, new o());
}), i = this && this.__decorate || function(e, t, o, n) {
var a, i = arguments.length, r = i < 3 ? t : null === n ? n = Object.getOwnPropertyDescriptor(t, o) : n;
if ("object" == typeof Reflect && "function" == typeof Reflect.decorate) r = Reflect.decorate(e, t, o, n); else for (var l = e.length - 1; l >= 0; l--) (a = e[l]) && (r = (i < 3 ? a(r) : i > 3 ? a(t, o, r) : a(t, o)) || r);
return i > 3 && r && Object.defineProperty(t, o, r), r;
};
Object.defineProperty(o, "__esModule", {
value: !0
});
var r = cc._decorator, l = r.ccclass, s = r.property, c = r.executeInEditMode, u = r.menu, d = function(e) {
a(t, e);
function t() {
var t = null !== e && e.apply(this, arguments) || this;
t.isLoopPage = !1;
t._index = 0;
t.preIndex = 0;
t._isChanging = !1;
return t;
}
Object.defineProperty(t.prototype, "index", {
get: function() {
return this._index;
},
set: function(e) {
if (!this.isChanging) {
e = Math.round(e);
var t = this.node.childrenCount - 1;
if (this.isLoopPage) {
e > t && (e = 0);
e < 0 && (e = t);
} else {
e > t && (e = t);
e < 0 && (e = 0);
}
this.preIndex = this._index;
this._index = e;
this._updatePage(e);
}
},
enumerable: !1,
configurable: !0
});
Object.defineProperty(t.prototype, "isChanging", {
get: function() {
return this._isChanging;
},
enumerable: !1,
configurable: !0
});
t.prototype.onLoad = function() {
this.preIndex = this.index;
};
t.prototype._updateEditorPage = function() {};
t.prototype._updatePage = function() {
var e = this.node.children, t = this.preIndex, o = this.index;
if (t !== o) {
var n = e[t], a = e[o];
n.active = !1;
a.active = !0;
}
};
t.prototype.next = function() {
if (this.isChanging) return !1;
this.index++;
return !0;
};
t.prototype.previous = function() {
if (this.isChanging) return !1;
this.index--;
return !0;
};
t.prototype.setEventIndex = function(e, t) {
if (this.index >= 0 && null != this.index && !1 === this.isChanging) {
this.index = t;
return !0;
}
return !1;
};
i([ s ], t.prototype, "isLoopPage", void 0);
i([ s ], t.prototype, "_index", void 0);
i([ s({
type: cc.Integer
}) ], t.prototype, "index", null);
return i([ l, c, u("添加特殊行为/UI/Switch Page (切换页面)") ], t);
}(cc.Component);
o.default = d;
cc._RF.pop();
}, {} ],
BindAlert: [ function(e, t, o) {
"use strict";
cc._RF.push(t, "3a31fYRRhFDWLYGcNo4S4Fl", "BindAlert");
var n, a = this && this.__extends || (n = function(e, t) {
return (n = Object.setPrototypeOf || {
__proto__: []
} instanceof Array && function(e, t) {
e.__proto__ = t;
} || function(e, t) {
for (var o in t) Object.prototype.hasOwnProperty.call(t, o) && (e[o] = t[o]);
})(e, t);
}, function(e, t) {
n(e, t);
function o() {
this.constructor = e;
}
e.prototype = null === t ? Object.create(t) : (o.prototype = t.prototype, new o());
}), i = this && this.__decorate || function(e, t, o, n) {
var a, i = arguments.length, r = i < 3 ? t : null === n ? n = Object.getOwnPropertyDescriptor(t, o) : n;
if ("object" == typeof Reflect && "function" == typeof Reflect.decorate) r = Reflect.decorate(e, t, o, n); else for (var l = e.length - 1; l >= 0; l--) (a = e[l]) && (r = (i < 3 ? a(r) : i > 3 ? a(t, o, r) : a(t, o)) || r);
return i > 3 && r && Object.defineProperty(t, o, r), r;
};
Object.defineProperty(o, "__esModule", {
value: !0
});
var r = e("../../../Game/client/global/enum/game/Event"), l = e("../../../Game/client/model/LanguageModel"), s = e("../../../Game/fromework/helper/EventHelper"), c = e("../../model/PhoneModel"), u = e("../NumericLabel"), d = cc._decorator, p = d.ccclass, h = d.property, f = function(e) {
a(t, e);
function t() {
var t = null !== e && e.apply(this, arguments) || this;
t.Title = null;
t.Content = null;
t.PhoneLab = null;
t.Time = null;
t.AlertPanel = null;
t.CodeInput = null;
t.RetryButton = null;
t._phoneNum = null;
t._sms_type = null;
t._callFunc = null;
t._interval = -1;
return t;
}
t.prototype.onEnable = function() {
s.default.Instance.Global.bind(r.GameUIEvent.BINDALERT_REFRESH_VIEW, this.refreshView, this);
};
t.prototype.onDisable = function() {
s.default.Instance.Global.unbind(r.GameUIEvent.BINDALERT_REFRESH_VIEW, this.refreshView, this);
};
t.prototype.show = function(e, t, o) {
this._phoneNum = e;
this._sms_type = t;
this._callFunc = o;
this.refreshView();
this.openAction();
};
t.prototype.refreshView = function() {
var e = this;
this.Title.string = l.default.getString("SIGN_ENTER");
this.Content.string = l.default.getString("KYC_PHONE_OTP");
var t = String(this._phoneNum);
this.PhoneLab.string = t;
var o = c.PhoneProxy.Instance.getCountDown(this._sms_type), n = function() {
e.Time.string = o + "";
};
if (o <= 0) {
this.RetryButton.node.active = !0;
this.Time.node.active = !1;
c.PhoneProxy.Instance.sendGetVerificationCode(this._sms_type, this._phoneNum);
} else {
this.RetryButton.node.active = !1;
this.Time.node.active = !0;
if (-1 != this._interval) {
clearInterval(this._interval);
this._interval = -1;
}
n();
this._interval = setInterval(function() {
o--;
if (!e || !e.node || !e.node.isValid || o <= 0) {
clearInterval(e._interval);
if (e.node) {
e.RetryButton.node.active = !0;
e.Time.node.active = !1;
}
} else n();
}, 1e3);
}
};
t.prototype.close = function() {
var e = this, t = parseInt(this.CodeInput.string);
isNaN(t) ? this._callFunc(null) : this.closeAction(function() {
e._callFunc && e._callFunc(t);
});
};
t.prototype.openAction = function() {
this.AlertPanel.setPosition(cc.v2(0, this.node.height / 2 + this.AlertPanel.height / 2));
this.AlertPanel.runAction(cc.moveTo(.1, cc.v2(0, 0)));
};
t.prototype.closeAction = function(e) {
var t = this;
this.AlertPanel.runAction(cc.sequence(cc.moveTo(.1, cc.v2(0, -(this.node.height / 2 + this.AlertPanel.height / 2))), cc.callFunc(function() {
e && e();
t.node.removeFromParent(!0);
t.node.destroy();
})));
};
t.prototype.onRetryClicked = function() {
c.PhoneProxy.Instance.sendGetVerificationCode(this._sms_type, this._phoneNum);
};
t.prototype.onSubmitClicked = function() {
var e = this, t = parseInt(this.CodeInput.string);
isNaN(t) ? this._callFunc(null) : this.closeAction(function() {
e._callFunc && e._callFunc(t);
});
};
t.prototype.onBackClicked = function() {
this.closeAction();
};
i([ h(cc.Label) ], t.prototype, "Title", void 0);
i([ h(cc.Label) ], t.prototype, "Content", void 0);
i([ h(cc.Label) ], t.prototype, "PhoneLab", void 0);
i([ h(cc.Label) ], t.prototype, "Time", void 0);
i([ h(cc.Node) ], t.prototype, "AlertPanel", void 0);
i([ h(u.default) ], t.prototype, "CodeInput", void 0);
i([ h(cc.Button) ], t.prototype, "RetryButton", void 0);
return i([ p ], t);
}(cc.Component);
o.default = f;
cc._RF.pop();
}, {
"../../../Game/client/global/enum/game/Event": "Event",
"../../../Game/client/model/LanguageModel": "LanguageModel",
"../../../Game/fromework/helper/EventHelper": "EventHelper",
"../../model/PhoneModel": "PhoneModel",
"../NumericLabel": "NumericLabel"
} ],
BlastBetPanel: [ function(e, t, o) {
"use strict";
cc._RF.push(t, "38629UlyOZAvrGdczaqryRz", "BlastBetPanel");
var n, a = this && this.__extends || (n = function(e, t) {
return (n = Object.setPrototypeOf || {
__proto__: []
} instanceof Array && function(e, t) {
e.__proto__ = t;
} || function(e, t) {
for (var o in t) Object.prototype.hasOwnProperty.call(t, o) && (e[o] = t[o]);
})(e, t);
}, function(e, t) {
n(e, t);
function o() {
this.constructor = e;
}
e.prototype = null === t ? Object.create(t) : (o.prototype = t.prototype, new o());
}), i = this && this.__decorate || function(e, t, o, n) {
var a, i = arguments.length, r = i < 3 ? t : null === n ? n = Object.getOwnPropertyDescriptor(t, o) : n;
if ("object" == typeof Reflect && "function" == typeof Reflect.decorate) r = Reflect.decorate(e, t, o, n); else for (var l = e.length - 1; l >= 0; l--) (a = e[l]) && (r = (i < 3 ? a(r) : i > 3 ? a(t, o, r) : a(t, o)) || r);
return i > 3 && r && Object.defineProperty(t, o, r), r;
};
Object.defineProperty(o, "__esModule", {
value: !0
});
var r = e("../../../Game/client/global/enum/game/Const"), l = e("../../../Game/client/global/enum/game/Event"), s = e("../../../Game/client/logic/game/GameHelper"), c = e("../../../Game/client/model/LanguageModel"), u = e("../../../Game/fromework/global/Tools"), d = e("../../../Game/fromework/helper/AudioHelper"), p = e("../../../Game/fromework/helper/EventHelper"), h = e("../../../Game/fromework/mvvm/modelView/ViewModel"), f = e("../../../client/component/NumericLabel"), _ = e("../../../client/logic/Wallet/WalletHelper"), m = e("../../../client/model/LobbyModel"), y = e("../Common/BlastEvent"), g = e("../Common/BlastModel"), v = e("./BlastSpace"), C = cc._decorator, b = C.ccclass, I = C.property, E = function(e) {
a(t, e);
function t() {
var t = null !== e && e.apply(this, arguments) || this;
t.Rocket = null;
t.TotalBanlance = null;
t.AutoToggle = null;
t.BlockInputPanel = null;
t.RateInput = null;
t.IncomeLabel = null;
t.WinRateLabel = null;
t.NormalColor = cc.Color.WHITE;
t.AutoColor = cc.Color.WHITE;
t.BetReady = null;
t.Time = null;
t.BetAmountGear = [];
t.BetInput = null;
t.BetEndLabel = null;
t.BetButton = null;
t.RunButtonLabel = null;
t.RunButton = null;
t.BetProgress = null;
t.BetWaitting = null;
t.BetEnd = null;
t._minRate = 2;
t._maxRate = 999;
t._rate = t._minRate;
t._minBet = 5;
t._maxBet = 2e3;
t._betAmount = 200;
t._curBetIndex = 0;
t._countdownID = -1;
return t;
}
t.prototype.onEnable = function() {
p.default.Instance.Global.bind(y.BlastGameEvent.GAME_RECONNECT, this.onReconnect, this);
p.default.Instance.Global.bind(y.BlastGameEvent.S2C_DEAL_BLAST, this.refreshBetButton, this);
p.default.Instance.Global.bind(y.BlastUIEvent.BLAST_BET_START, this.onStartBet, this);
p.default.Instance.Global.bind(y.BlastUIEvent.BLAST_ROCKET_START, this.onStartRocket, this);
p.default.Instance.Global.bind(y.BlastUIEvent.BLAST_ROCKET_STOP, this.refreshBetButton, this);
p.default.Instance.Global.bind(y.BlastGameEvent.S2C_RESET_BLAST, this.refreshBetButton, this);
p.default.Instance.Global.bind(y.BlastGameEvent.S2C_BET_BLAST, this.refreshBetButton, this);
p.default.Instance.Global.bind(y.BlastUIEvent.BLAST_ROCKET_ESCAPE, this.refreshBetButton, this);
p.default.Instance.Global.bind(l.GameEvent.S2C_SEND_AVAILABLE_BALANCE, this.refreshBlance, this);
};
t.prototype.onDisable = function() {
p.default.Instance.Global.unbind(y.BlastGameEvent.GAME_RECONNECT, this.onReconnect, this);
p.default.Instance.Global.unbind(y.BlastGameEvent.S2C_DEAL_BLAST, this.refreshBetButton, this);
p.default.Instance.Global.unbind(y.BlastUIEvent.BLAST_BET_START, this.onStartBet, this);
p.default.Instance.Global.unbind(y.BlastUIEvent.BLAST_ROCKET_START, this.onStartRocket, this);
p.default.Instance.Global.unbind(y.BlastUIEvent.BLAST_ROCKET_STOP, this.refreshBetButton, this);
p.default.Instance.Global.unbind(y.BlastGameEvent.S2C_RESET_BLAST, this.refreshBetButton, this);
p.default.Instance.Global.unbind(y.BlastGameEvent.S2C_BET_BLAST, this.refreshBetButton, this);
p.default.Instance.Global.unbind(y.BlastUIEvent.BLAST_ROCKET_ESCAPE, this.refreshBetButton, this);
p.default.Instance.Global.unbind(l.GameEvent.S2C_SEND_AVAILABLE_BALANCE, this.refreshBlance, this);
};
t.prototype.onDestroy = function() {
this._stopCountDown();
};
t.prototype.onReconnect = function() {
var e = g.BlastModel.Instance;
this.AutoToggle.isChecked = e.autoPlay;
this._minBet = e.bet_min;
this._maxBet = e.bet_max;
this.BlockInputPanel.active = !this.AutoToggle.isChecked;
this.refreshBlance();
this.refreshAutoLeaveLabel();
this.refreshBetButton();
2 == e.roomData.state && this._startCountDown();
};
t.prototype.onStartBet = function() {
this.refreshBetButton();
this._startCountDown();
};
t.prototype.onStartRocket = function() {
this.refreshBetButton();
this._stopCountDown();
};
t.prototype._startCountDown = function() {
var e = this, t = g.BlastModel.Instance;
if (-1 != this._countdownID) {
s.Countdown.deleta(this._countdownID);
this._countdownID = -1;
}
var o = t.getCountDown();
o--;
this.Time.string = o + "";
this._countdownID = s.Countdown.creat(o, function() {
e && e.Time && e.Time.node && e.Time.node.isValid && (e.Time.string = "0");
}, function(t) {
if (e && e.Time && e.Time.node && e.Time.node.isValid && t >= 0) {
0 == t ? d.default.Instance.playBundleEffect(r.BundleSoundPath.composite_countdown_0) : t > 0 && t < 5 && d.default.Instance.playBundleEffect(r.BundleSoundPath.composite_countdown_1);
1 == t && p.default.Instance.Global.emit(y.BlastUIEvent.BLAST_PLAY_RATE_BORDER);
e.Time.string = t + "";
}
}, this);
};
t.prototype._stopCountDown = function() {
if (-1 != this._countdownID) {
s.Countdown.deleta(this._countdownID);
this._countdownID = -1;
}
};
t.prototype.refreshBlance = function() {
var e = g.BlastModel.Instance;
this.TotalBanlance.string = e.total_fee + "";
};
t.prototype.getRateStep = function(e) {
return e >= 2 && e < 3 ? .1 : e >= 3 && e < 5 ? .2 : e >= 5 && e < 10 ? .5 : e >= 10 && e < 20 ? 1 : e >= 20 && e < 40 ? 2 : e >= 40 && e < 100 ? 5 : e >= 100 && e < 200 ? 10 : e >= 200 && e < 400 ? 20 : e >= 400 && e <= 999 ? 50 : void 0;
};
t.prototype.refreshAutoLeaveLabel = function() {
var e = g.BlastModel.Instance.bet_win_rate / this._rate;
e < 0 && (e = 0);
this.IncomeLabel.string = (this._betAmount * this._rate).toFixed(2);
this.WinRateLabel.string = (100 * e).toFixed(2) + "%";
this.IncomeLabel.node.color = this.AutoToggle.isChecked ? this.AutoColor : this.NormalColor;
this.WinRateLabel.node.color = this.AutoToggle.isChecked ? this.AutoColor : this.NormalColor;
};
t.prototype.onRateInputEnd = function() {
var e = this, t = g.BlastModel.Instance;
this._rate = parseInt(this.RateInput.string);
this._rate >= this._maxRate && (this._rate = this._maxRate);
this._rate <= this._minRate && (this._rate = this._minRate);
this.scheduleOnce(function() {
e.RateInput.string = e._rate + "";
});
t.autoRate = this._rate;
this.refreshAutoLeaveLabel();
};
t.prototype.onAddClicked = function() {
var e = g.BlastModel.Instance;
if (!(this._rate >= this._maxRate)) {
var t = this.getRateStep(this._rate);
this._rate = u.Tools.TFloat.add(this._rate, t);
this._rate >= this._maxRate && (this._rate = this._maxRate);
this.RateInput.string = this._rate + "";
e.autoRate = this._rate;
this.refreshAutoLeaveLabel();
}
};
t.prototype.onSubClicked = function() {
var e = g.BlastModel.Instance;
if (!(this._rate <= this._minRate)) {
var t = this.getRateStep(this._rate);
this._rate = u.Tools.TFloat.sub(this._rate, t);
this._rate <= this._minRate && (this._rate = this._minRate);
this.RateInput.string = this._rate + "";
e.autoRate = this._rate;
this.refreshAutoLeaveLabel();
}
};
t.prototype.onAutoToggleClicked = function() {
this.BlockInputPanel.active = !this.AutoToggle.isChecked;
this.refreshAutoLeaveLabel();
g.default.Instance.sendAutoPlay(this.AutoToggle.isChecked);
};
t.prototype.refreshBetButton = function() {
var e = g.BlastModel.Instance, t = h.VM.getValue("user.uid"), o = e.getUserData(t), n = e.roomData.state, a = o.state, i = o.res;
this.BetButton.active = 2 == n && 0 == a;
this.BetEnd.active = 2 == n && 1 == a;
this.RunButton.active = 3 == n && 1 == a && 0 == i;
this.BetProgress.active = 3 == n && 1 == a && 0 != i;
this.BetWaitting.active = 0 == n || 1 == n || 3 == n && 0 == a || 4 == n;
this.BetReady.active = 2 == n;
this.BetEnd.active && (this.BetEndLabel.string = u.Tools.TStr.replaceString(c.default.getString("BLAST_BET_BRACKETS"), {
amount: o.bet_record.amount
}));
this.RunButton.active && (this.RunButtonLabel.string = u.Tools.TStr.replaceString(c.default.getString("BLAST_RUN_BRACKETS"), {
amount: o.bet_record.amount
}));
};
t.prototype.refreshBetGear = function() {
var e = this;
this.BetAmountGear.forEach(function(t, o) {
if (o == e._curBetIndex) {
t.check();
t.interactable = !1;
} else {
t.uncheck();
t.interactable = !0;
}
});
};
t.prototype.onBetGearClicked = function(e, t) {
var o = g.BlastModel.Instance, n = parseInt(t);
if (n != this._curBetIndex) {
this._curBetIndex = n;
this._betAmount = o.bet_fee_currency[this._curBetIndex];
this.refreshBetGear();
this.refreshAutoLeaveLabel();
this.BetInput.string = this._betAmount + "";
}
};
t.prototype.onBetInputEnd = function() {
var e = this, t = g.BlastModel.Instance, o = parseInt(this.BetInput.string);
if (!isNaN(o)) {
o < this._minBet && (o = this._minBet);
o > this._maxBet && (o = this._maxBet);
this._curBetIndex = t.bet_fee_currency.indexOf(o);
this._betAmount = o;
this.refreshBetGear();
this.refreshAutoLeaveLabel();
this.scheduleOnce(function() {
e.BetInput.string = e._betAmount + "";
});
}
};
t.prototype.onBetClicked = function() {
var e = g.BlastModel.Instance, t = h.VM.getValue("user.uid"), o = e.getUserData(t), n = m.default.Instance.getGamePlay(e.roomData.rtype), a = m.default.Instance.getPlaySwitch(n.cls);
a && (!a || 3 != a.s) || e.checkRecharge() ? 2 == e.roomData.state && 0 == o.state && (e.total_fee >= this._betAmount ? g.default.Instance.sendBet(this._betAmount, this._rate, this.AutoToggle.isChecked) : _.default.Instance.openRechargeAlert(this._betAmount, 0)) : _.default.Instance.openRechargeAlert(100, 0, !1);
};
t.prototype.onRunClicked = function() {
var e = g.BlastModel.Instance, t = h.VM.getValue("user.uid"), o = e.getUserData(t);
3 == e.roomData.state && 1 == o.state && 0 == o.res && g.default.Instance.sendRun(this.Rocket.getRateByTime());
};
i([ I(v.default) ], t.prototype, "Rocket", void 0);
i([ I(cc.Label) ], t.prototype, "TotalBanlance", void 0);
i([ I(cc.Toggle) ], t.prototype, "AutoToggle", void 0);
i([ I(cc.Node) ], t.prototype, "BlockInputPanel", void 0);
i([ I(f.default) ], t.prototype, "RateInput", void 0);
i([ I(cc.Label) ], t.prototype, "IncomeLabel", void 0);
i([ I(cc.Label) ], t.prototype, "WinRateLabel", void 0);
i([ I(cc.Color) ], t.prototype, "NormalColor", void 0);
i([ I(cc.Color) ], t.prototype, "AutoColor", void 0);
i([ I(cc.Node) ], t.prototype, "BetReady", void 0);
i([ I(cc.Label) ], t.prototype, "Time", void 0);
i([ I([ cc.Toggle ]) ], t.prototype, "BetAmountGear", void 0);
i([ I(f.default) ], t.prototype, "BetInput", void 0);
i([ I(cc.Label) ], t.prototype, "BetEndLabel", void 0);
i([ I(cc.Node) ], t.prototype, "BetButton", void 0);
i([ I(cc.Label) ], t.prototype, "RunButtonLabel", void 0);
i([ I(cc.Node) ], t.prototype, "RunButton", void 0);
i([ I(cc.Node) ], t.prototype, "BetProgress", void 0);
i([ I(cc.Node) ], t.prototype, "BetWaitting", void 0);
i([ I(cc.Node) ], t.prototype, "BetEnd", void 0);
return i([ b ], t);
}(cc.Component);
o.default = E;
cc._RF.pop();
}, {
"../../../Game/client/global/enum/game/Const": "Const",
"../../../Game/client/global/enum/game/Event": "Event",
"../../../Game/client/logic/game/GameHelper": "GameHelper",
"../../../Game/client/model/LanguageModel": "LanguageModel",
"../../../Game/fromework/global/Tools": "Tools",
"../../../Game/fromework/helper/AudioHelper": "AudioHelper",
"../../../Game/fromework/helper/EventHelper": "EventHelper",
"../../../Game/fromework/mvvm/modelView/ViewModel": "ViewModel",
"../../../client/component/NumericLabel": "NumericLabel",
"../../../client/logic/Wallet/WalletHelper": "WalletHelper",
"../../../client/model/LobbyModel": "LobbyModel",
"../Common/BlastEvent": "BlastEvent",
"../Common/BlastModel": "BlastModel",
"./BlastSpace": "BlastSpace"
} ],
BlastEvent: [ function(e, t, o) {
"use strict";
cc._RF.push(t, "697f3WaxIlDY4J977QTBQ1v", "BlastEvent");
Object.defineProperty(o, "__esModule", {
value: !0
});
o.BlastUIEvent = o.BlastGameEvent = void 0;
o.BlastGameEvent = {
S2C_ENTER_ROOM_BLAST: "S2C_ENTER_ROOM_BLAST",
S2C_SWITCH_ROOM_BLAST: "S2C_SWITCH_ROOM_BLAST",
S2C_RESET_BLAST: "S2C_RESET_BLAST",
S2C_LEAVE_BLAST: "S2C_LEAVE_BLAST",
S2C_LEAVE_SINGLE_BLAST: "S2C_LEAVE_SINGLE_BLAST",
S2C_DISMISS_ROOM_BLAST: "S2C_DISMISS_ROOM_BLAST",
S2C_INTERACT_BLAST: "S2C_INTERACT_BLAST",
S2C_DEAL_BLAST: "S2C_DEAL_BLAST",
S2C_BET_BLAST: "S2C_BET_BLAST",
S2C_BET_BATCH_BLAST: "S2C_BET_BATCH_BLAST",
S2C_SHOW_BLAST: "S2C_SHOW_BLAST",
S2C_RANK_BLAST: "S2C_RANK_BLAST",
S2C_AUTO_PLAY_BLAST: "S2C_AUTO_PLAY_BLAST",
S2C_REPEAT_BET_BLAST: "S2C_REPEAT_BET_BLAST",
S2C_USER_RECORD_BLAST: "S2C_USER_RECORD_BLAST",
TABLE_REFRESH_TABLE_BLAST: "TABLE_REFRESH_TABLE_BLAST",
GAME_RECONNECT: "GAME_RECONNECT_BLAST",
TABLE_REPEAT_BET_ERROR: "TABLE_REPEAT_BET_ERROR"
};
o.BlastUIEvent = {
BLAST_BET_START: "BLAST_BET_START",
BLAST_BET_STOP: "BLAST_BET_STOP",
BLAST_ROCKET_START: "BLAST_ROCKET_START",
BLAST_ROCKET_STOP: "BLAST_ROCKET_STOP",
BLAST_ROCKET_ESCAPE: "BLAST_ROCKET_ESCAPE",
BLAST_ROCKET_ESCAPE_BATCH: "BLAST_ROCKET_ESCAPE_BATCH",
BLAST_RECORD_ROUND_REFRESH: "BLAST_RECORD_ROUND_REFRESH",
BLAST_RECORD_LOTTERY_REFRESH: "BLAST_RECORD_LOTTERY_REFRESH",
BLAST_PLAY_RATE_BORDER: "BLAST_PLAY_RATE_BORDER",
BLAST_SYNC_TIME_RATE: "BLAST_SYNC_TIME_RATE"
};
cc._RF.pop();
}, {} ],
BlastLotteryRecordItem: [ function(e, t, o) {
"use strict";
cc._RF.push(t, "275dd8crLFAjbAKiALX7qwn", "BlastLotteryRecordItem");
var n, a = this && this.__extends || (n = function(e, t) {
return (n = Object.setPrototypeOf || {
__proto__: []
} instanceof Array && function(e, t) {
e.__proto__ = t;
} || function(e, t) {
for (var o in t) Object.prototype.hasOwnProperty.call(t, o) && (e[o] = t[o]);
})(e, t);
}, function(e, t) {
n(e, t);
function o() {
this.constructor = e;
}
e.prototype = null === t ? Object.create(t) : (o.prototype = t.prototype, new o());
}), i = this && this.__decorate || function(e, t, o, n) {
var a, i = arguments.length, r = i < 3 ? t : null === n ? n = Object.getOwnPropertyDescriptor(t, o) : n;
if ("object" == typeof Reflect && "function" == typeof Reflect.decorate) r = Reflect.decorate(e, t, o, n); else for (var l = e.length - 1; l >= 0; l--) (a = e[l]) && (r = (i < 3 ? a(r) : i > 3 ? a(t, o, r) : a(t, o)) || r);
return i > 3 && r && Object.defineProperty(t, o, r), r;
};
Object.defineProperty(o, "__esModule", {
value: !0
});
var r = e("../../../Game/client/model/LanguageModel"), l = cc._decorator, s = l.ccclass, c = l.property, u = function(e) {
a(t, e);
function t() {
var t = null !== e && e.apply(this, arguments) || this;
t.RocketIcon = null;
t.ID = null;
t.Money = null;
t.WinMoney = null;
t.Rate = null;
t._data = null;
return t;
}
t.prototype.onItemInitCallFunc = function(e) {
this._data = e;
this.ID.string = r.default.getString("COMMON_ID_SPACE") + this._data.p;
this.Money.string = this._data.b + "";
this.WinMoney.string = r.default.getString("COMMON_WIN_SPACE").concat(parseFloat(this._data.w.toFixed(2)).toString());
this.Rate.string = this._data.d + "";
};
t.prototype.onItemEnterCallFunc = function() {
this.node.opacity = 255;
};
t.prototype.onItemExitCallFunc = function() {
this.node.opacity = 0;
};
i([ c(cc.Node) ], t.prototype, "RocketIcon", void 0);
i([ c(cc.Label) ], t.prototype, "ID", void 0);
i([ c(cc.Label) ], t.prototype, "Money", void 0);
i([ c(cc.Label) ], t.prototype, "WinMoney", void 0);
i([ c(cc.Label) ], t.prototype, "Rate", void 0);
return i([ s ], t);
}(cc.Component);
o.default = u;
cc._RF.pop();
}, {
"../../../Game/client/model/LanguageModel": "LanguageModel"
} ],
BlastModel: [ function(e, t, o) {
"use strict";
cc._RF.push(t, "46b5eRyxQtKNb5M0X3qh5OR", "BlastModel");
Object.defineProperty(o, "__esModule", {
value: !0
});
o.BlastModel = void 0;
var n = e("../../../Game/client/global/enum/game/Event"), a = e("../../../Game/client/global/enum/game/Game"), i = e("../../../Game/client/global/enum/net/C2S"), r = e("../../../Game/client/global/enum/net/S2C"), l = e("../../../Game/fromework/global/Tools"), s = e("../../../Game/fromework/helper/EventHelper"), c = e("../../../Game/fromework/mvvm/modelView/ViewModel"), u = e("../../../platform/Platform"), d = e("../../../client/logic/game/HearBeat"), p = e("../../../client/model/ErrorModel"), h = e("../../../client/model/WalletModel"), f = e("../../../fromework/helper/NetHelper"), _ = e("../../Common/Utils/CompositeConst"), m = e("./BlastEvent"), y = e("./BlastStruct"), g = function() {
function e() {
this.refreshIndex = 0;
this.sTime = 0;
this.total_fee = 0;
this.autoPlay = !1;
this.autoRate = 2;
this.bet_win_rate = 1;
this.roomData = new y.BlastStruct.RoomData();
this.allUserData = new Map();
this.declearHistory = new y.BlastStruct.DeclearHistory();
this.bet_fee_currency = [];
this.bet_min = 0;
this.bet_max = 0;
this.user_record = [];
}
Object.defineProperty(e, "Instance", {
get: function() {
e._instance || (e._instance = new e());
return e._instance;
},
enumerable: !1,
configurable: !0
});
e.prototype.clear = function() {
null != e._instance && (e._instance = null);
};
e.prototype.getCountDown = function() {
u.default.log("get count down:", this.roomData.dl, this.sTime);
return Math.ceil(this.roomData.dl - this.sTime);
};
e.prototype.clearUserData = function() {
this.allUserData.clear();
this.refreshIndex = 0;
};
e.prototype.refreshUserData = function(e) {
var t = this, o = Object.keys(e), n = c.VM.getValue("user.uid");
o.forEach(function(o) {
var a = Number(o);
t.refreshIndex++;
if (t.allUserData.has(a)) {
(i = t.allUserData.get(a)).index = t.refreshIndex;
i.refresh(e[o]);
} else {
var i;
(i = new y.BlastStruct.UserData(e[o])).index = t.refreshIndex;
t.allUserData.set(Number(o), i);
}
if (o == n) {
t.total_fee = l.Tools.TNumber.num2single(e[o].total_fee);
t.autoPlay = e[o].auto;
}
});
};
e.prototype.refreshUserDataSingle = function(e) {
if (this.allUserData.has(e.uid)) this.allUserData.get(e.uid).refresh(e); else {
var t = new y.BlastStruct.UserData(e);
this.refreshIndex++;
t.index = this.refreshIndex;
this.allUserData.set(Number(e.uid), t);
}
};
e.prototype.deleteUserData = function(e) {
this.allUserData.has(e) && this.allUserData.delete(e);
};
e.prototype.getUserData = function(e) {
return this.allUserData.has(e) ? this.allUserData.get(e) : null;
};
e.prototype.checkRecharge = function() {
return c.VM.getValue("wallet.totalRecharge") >= _.COMPOSITE_MIN_RECHARGE;
};
e._instance = null;
return e;
}();
o.BlastModel = g;
var v = function() {
function e() {
this._recordCount = 10;
this.userPage = 0;
this._userTotal = 10;
}
Object.defineProperty(e, "Instance", {
get: function() {
e._instance || (e._instance = new e());
return e._instance;
},
enumerable: !1,
configurable: !0
});
e.prototype.Init = function() {
s.default.Instance.Net.bind(r.S2C.GAME.ROOM_ENTER_ROOM, this._onEnterRoom, this);
s.default.Instance.Net.bind(r.S2C.GAME.ROOM_SWITCH_ROOM, this._onSwitchRoom, this);
s.default.Instance.Net.bind(r.S2C.GAME.ROOM_DEAL, this._onDeal, this);
s.default.Instance.Net.bind(r.S2C.GAME.ROOM_START_BET, this._onStartBet, this);
s.default.Instance.Net.bind(r.S2C.GAME.ROOM_BET, this._onBet, this);
s.default.Instance.Net.bind(r.S2C.GAME.ROOM_BET_BATCH, this._onBetBatch, this);
s.default.Instance.Net.bind(r.S2C.GAME.ROOM_STOP_BET, this._onStopBet, this);
s.default.Instance.Net.bind(r.S2C.GAME.ROOM_ESCAPE, this._onEscape, this);
s.default.Instance.Net.bind(r.S2C.GAME.ROOM_ESCAPE_BATCH, this._onEscapeBatch, this);
s.default.Instance.Net.bind(r.S2C.GAME.ROOM_BOOM, this._onBoom, this);
s.default.Instance.Net.bind(r.S2C.GAME.ROOM_RESET_ROOM, this._onResetRoom, this);
s.default.Instance.Net.bind(r.S2C.GAME.ROOM_AUTOPLAY, this._onAutoPlay, this);
s.default.Instance.Net.bind(r.S2C.GAME.ROOM_USER_RECORD, this._onUserRecord, this);
s.default.Instance.Net.bind(r.S2C.GAME.ROOM_LEAVE, this._onLeave, this);
s.default.Instance.Net.bind(r.S2C.GAME.ROOM_LEAVE_SINGLE, this._onLeaveSingle, this);
s.default.Instance.Net.bind(r.S2C.GAME.ROOM_DISMISS, this._onDismiss, this);
s.default.Instance.Net.bind(r.S2C.GAME.ROOM_SEND_AVAILABLE_BALANCE, this._onBalanceRefresh, this);
s.default.Instance.Global.bind(f.NetState.NET_WEBSOCKET_CONNECT_OPEN, this._onWsContented, this);
};
e.prototype.destory = function() {
s.default.Instance.Net.unbind(r.S2C.GAME.ROOM_ENTER_ROOM, this._onEnterRoom, this);
s.default.Instance.Net.unbind(r.S2C.GAME.ROOM_SWITCH_ROOM, this._onSwitchRoom, this);
s.default.Instance.Net.unbind(r.S2C.GAME.ROOM_DEAL, this._onDeal, this);
s.default.Instance.Net.unbind(r.S2C.GAME.ROOM_START_BET, this._onStartBet, this);
s.default.Instance.Net.unbind(r.S2C.GAME.ROOM_BET, this._onBet, this);
s.default.Instance.Net.unbind(r.S2C.GAME.ROOM_BET_BATCH, this._onBetBatch, this);
s.default.Instance.Net.unbind(r.S2C.GAME.ROOM_STOP_BET, this._onStopBet, this);
s.default.Instance.Net.unbind(r.S2C.GAME.ROOM_ESCAPE, this._onEscape, this);
s.default.Instance.Net.unbind(r.S2C.GAME.ROOM_ESCAPE_BATCH, this._onEscapeBatch, this);
s.default.Instance.Net.unbind(r.S2C.GAME.ROOM_BOOM, this._onBoom, this);
s.default.Instance.Net.unbind(r.S2C.GAME.ROOM_RESET_ROOM, this._onResetRoom, this);
s.default.Instance.Net.unbind(r.S2C.GAME.ROOM_AUTOPLAY, this._onAutoPlay, this);
s.default.Instance.Net.unbind(r.S2C.GAME.ROOM_USER_RECORD, this._onUserRecord, this);
s.default.Instance.Net.unbind(r.S2C.GAME.ROOM_LEAVE, this._onLeave, this);
s.default.Instance.Net.unbind(r.S2C.GAME.ROOM_LEAVE_SINGLE, this._onLeaveSingle, this);
s.default.Instance.Net.unbind(r.S2C.GAME.ROOM_DISMISS, this._onDismiss, this);
s.default.Instance.Net.unbind(r.S2C.GAME.ROOM_SEND_AVAILABLE_BALANCE, this._onBalanceRefresh, this);
s.default.Instance.Global.unbind(f.NetState.NET_WEBSOCKET_CONNECT_OPEN, this._onWsContented, this);
};
e.prototype.clear = function() {
this._recordCount = 10;
this.userPage = 0;
this._userTotal = 10;
};
e.prototype._onWsContented = function() {
d.default.Instance.begin();
var e = c.VM.getValue("lobby.roomID");
0 != e && this.sendEnterRoom(e);
};
Object.defineProperty(e.prototype, "roomID", {
get: function() {
return c.VM.getValue("lobby.roomID");
},
enumerable: !1,
configurable: !0
});
Object.defineProperty(e.prototype, "uid", {
get: function() {
return c.VM.getValue("user.uid");
},
enumerable: !1,
configurable: !0
});
Object.defineProperty(e.prototype, "token", {
get: function() {
return c.VM.getValue("user.token");
},
enumerable: !1,
configurable: !0
});
e.prototype.checkRoomID = function(e) {
return c.VM.getValue("lobby.roomID") == e;
};
e.prototype.checkRoomType = function(e) {
var t = e.split("_"), o = -1;
null != t && null != t[0] && (o = parseInt(t[0]));
return o == a.GameEnum.PlayType.GAME_BLAST_SPACE;
};
e.prototype._onEnterRoom = function(e) {
var t = e.getUserData();
if (this.checkRoomID(t.rid)) {
var o = g.Instance;
o.sTime = t.stime;
if (t.uid == this.uid) {
o.clearUserData();
o.roomData.refresh(t.room_data);
o.refreshUserData(t.user_data);
o.declearHistory.refresh(t.declear_history);
null != t.bet_win_rate && (o.bet_win_rate = t.bet_win_rate);
o.bet_fee_currency.length = 0;
t.bet_fee_currency.forEach(function(e) {
o.bet_fee_currency.push(l.Tools.TNumber.num2single(e));
});
o.bet_min = l.Tools.TNumber.num2single(t.bet_fee_currency_section.min);
o.bet_max = l.Tools.TNumber.num2single(t.bet_fee_currency_section.max);
s.default.Instance.Global.emit(m.BlastGameEvent.GAME_RECONNECT, t.uid);
s.default.Instance.Global.emit(m.BlastUIEvent.BLAST_RECORD_LOTTERY_REFRESH);
s.default.Instance.Global.emit(m.BlastUIEvent.BLAST_RECORD_ROUND_REFRESH);
} else {
o.refreshUserData(t.user_data);
s.default.Instance.Global.emit(m.BlastGameEvent.S2C_ENTER_ROOM_BLAST, t.uid);
}
}
};
e.prototype._onSwitchRoom = function(e) {
var t = e.getUserData();
if (this.checkRoomType(t.room_type)) {
c.VM.getValue("lobby.roomID") != t.r && c.VM.setValue("lobby.roomID", parseInt(t.r));
s.default.Instance.Global.emit(m.BlastGameEvent.S2C_SWITCH_ROOM_BLAST, t.r);
}
};
e.prototype._onDeal = function(e) {
var t = e.getUserData();
if (this.checkRoomID(t.rid)) {
var o = g.Instance;
o.sTime = t.stime;
o.roomData.refresh(t.room_data);
o.clearUserData();
o.refreshUserDataSingle(t.user_data);
s.default.Instance.Global.emit(m.BlastUIEvent.BLAST_RECORD_ROUND_REFRESH);
s.default.Instance.Global.emit(m.BlastGameEvent.S2C_DEAL_BLAST);
}
};
e.prototype._onStartBet = function(e) {
var t = e.getUserData();
if (this.checkRoomID(t.rid)) {
var o = g.Instance;
o.sTime = t.stime;
o.roomData.refresh(t.room_data);
s.default.Instance.Global.emit(m.BlastUIEvent.BLAST_BET_START);
}
};
e.prototype._onBet = function(e) {
var t = e.getUserData();
if (this.checkRoomID(t.rid)) {
var o = g.Instance;
o.sTime = t.stime;
o.refreshUserDataSingle(t.bet_user);
if (t.bet_user.uid == this.uid) {
o.total_fee = l.Tools.TNumber.num2single(t.bet_user.total_fee);
o.autoPlay = t.bet_user.auto;
}
s.default.Instance.Global.emit(m.BlastUIEvent.BLAST_RECORD_ROUND_REFRESH);
s.default.Instance.Global.emit(m.BlastGameEvent.S2C_BET_BLAST);
}
};
e.prototype._onBetBatch = function(e) {
var t = e.getUserData();
if (this.checkRoomID(t.rid)) {
var o = g.Instance;
o.sTime = t.stime;
o.refreshUserData(t.bet_batch_data);
s.default.Instance.Global.emit(m.BlastUIEvent.BLAST_RECORD_ROUND_REFRESH);
s.default.Instance.Global.emit(m.BlastGameEvent.S2C_BET_BATCH_BLAST);
}
};
e.prototype._onStopBet = function(e) {
var t = e.getUserData();
if (this.checkRoomID(t.rid)) {
var o = g.Instance;
o.sTime = t.stime;
o.roomData.refresh(t.room_data);
s.default.Instance.Global.emit(m.BlastUIEvent.BLAST_ROCKET_START);
}
};
e.prototype._onEscape = function(e) {
var t = e.getUserData();
if (this.checkRoomID(t.rid)) {
var o = g.Instance;
o.sTime = t.stime;
o.refreshUserDataSingle(t.escape_user);
var n = new y.BlastStruct.UserData(t.escape_user);
s.default.Instance.Global.emit(m.BlastUIEvent.BLAST_RECORD_ROUND_REFRESH);
s.default.Instance.Global.emit(m.BlastUIEvent.BLAST_ROCKET_ESCAPE, n);
}
};
e.prototype._onEscapeBatch = function(e) {
var t = e.getUserData();
if (this.checkRoomID(t.rid)) {
g.Instance.refreshUserData(t.escape_batch_data);
s.default.Instance.Global.emit(m.BlastUIEvent.BLAST_RECORD_ROUND_REFRESH);
s.default.Instance.Global.emit(m.BlastUIEvent.BLAST_ROCKET_ESCAPE_BATCH, t.escape_batch_data);
}
};
e.prototype._onBoom = function(e) {
var t = e.getUserData();
if (this.checkRoomID(t.rid)) {
var o = g.Instance;
o.sTime = t.stime;
o.roomData.refresh(t.room_data);
o.refreshUserData(t.user_data);
var n = new y.BlastStruct.HistoryData(t.declear_data);
o.declearHistory.addHistory(n);
s.default.Instance.Global.emit(m.BlastUIEvent.BLAST_RECORD_ROUND_REFRESH);
s.default.Instance.Global.emit(m.BlastUIEvent.BLAST_ROCKET_STOP);
}
};
e.prototype._onResetRoom = function(e) {
var t = e.getUserData();
if (this.checkRoomID(t.rid)) {
var o = g.Instance;
o.sTime = t.stime;
o.roomData.refresh(t.room_data);
o.refreshUserData(t.user_data);
for (var a = Object.keys(t.kick_data), i = this.uid, r = 0; r < a.length; r++) {
var l = Number(a[r]);
if (l == i) {
s.default.Instance.Global.emit(n.GameEvent.S2C_LEAVE_SINGLE);
return;
}
o.deleteUserData(l);
}
s.default.Instance.Global.emit(m.BlastUIEvent.BLAST_RECORD_ROUND_REFRESH);
s.default.Instance.Global.emit(m.BlastGameEvent.S2C_RESET_BLAST);
}
};
e.prototype._onAutoPlay = function(e) {
var t = e.getUserData();
if (this.checkRoomID(t.rid)) {
var o = g.Instance;
o.autoPlay = t.auto;
o.getUserData(this.uid).auto = t.auto;
s.default.Instance.Global.emit(m.BlastGameEvent.S2C_AUTO_PLAY_BLAST);
}
};
e.prototype._onUserRecord = function(e) {
var t = e.getUserData();
if (this.checkRoomID(t.rid)) {
var o = g.Instance;
o.sTime = t.stime;
this._userTotal = Math.max(t.total, 10);
t.page_data.forEach(function(e) {
var t = new y.BlastStruct.UserRecord(e);
o.user_record.push(t);
});
s.default.Instance.Global.emit(m.BlastGameEvent.S2C_USER_RECORD_BLAST);
}
};
e.prototype._onLeave = function(e) {
var t = e.getUserData();
if (this.checkRoomID(t.rid)) {
g.Instance.sTime = t.stime;
s.default.Instance.Global.emit(m.BlastGameEvent.S2C_LEAVE_BLAST);
}
};
e.prototype._onLeaveSingle = function(e) {
var t = e.getUserData();
if (this.checkRoomID(t.rid) || 0 == c.VM.getValue("lobby.roomID")) {
g.Instance.sTime = t.stime;
s.default.Instance.Global.emit(m.BlastGameEvent.S2C_LEAVE_SINGLE_BLAST, t);
}
};
e.prototype._onDismiss = function(e) {
var t = e.getUserData();
this.checkRoomID(t.rid) && s.default.Instance.Global.emit(m.BlastGameEvent.S2C_DISMISS_ROOM_BLAST, t);
};
e.prototype._onBalanceRefresh = function(e) {
var t = e.getUserData();
if (this.checkRoomID(t.rid)) {
var o = g.Instance, a = l.Tools.TNumber.num2single(t.total_fee);
o.total_fee = a;
var i = o.getUserData(this.uid);
i && (i.total_fee = a);
h.WalletProxy.Instance.refreshWallet(t);
s.default.Instance.Global.emit(n.GameEvent.S2C_SEND_AVAILABLE_BALANCE);
}
};
e.prototype.sendEnterRoom = function(e, t) {
void 0 === t && (t = !0);
var o = f.default.Instance.makeMsg(i.C2S.ROOM_ENTER_ROOM, {
u: this.uid,
t: this.token,
r: e,
is_open: t
});
f.default.Instance.send(o);
};
e.prototype.sendBet = function(e, t, o) {
var n = l.Tools.TNumber.num2thousand(e);
p.default.Instance.CompositeBetNum = e;
var a = f.default.Instance.makeMsg(i.C2S.ROOM_BET, {
u: this.uid,
t: this.token,
r: this.roomID,
fee: n,
multiple: t,
auto: o
});
f.default.Instance.send(a);
};
e.prototype.sendRun = function(e) {
var t = f.default.Instance.makeMsg(i.C2S.ROOM_ESCAPE, {
u: this.uid,
t: this.token,
r: this.roomID,
multiple: e
});
f.default.Instance.send(t);
};
e.prototype.sendBoom = function() {
var e = f.default.Instance.makeMsg(i.C2S.ROOM_BOOM, {
u: this.uid,
t: this.token,
r: this.roomID
});
f.default.Instance.send(e);
};
e.prototype.sendAutoPlay = function(e) {
var t = f.default.Instance.makeMsg(i.C2S.ROOM_AUTOPLAY, {
u: this.uid,
t: this.token,
r: this.roomID,
auto: e
});
f.default.Instance.send(t);
};
e.prototype.sendUserRecord = function() {
if (0 == this._userTotal || Math.ceil(this._userTotal / this._recordCount) >= this.userPage + 1) {
this.userPage++;
var e = f.default.Instance.makeMsg(i.C2S.ROOM_USER_RECORD, {
u: this.uid,
t: this.token,
r: this.roomID,
page: this.userPage,
count: this._recordCount
});
f.default.Instance.send(e);
}
};
e.prototype.sendLeave = function() {
var e = f.default.Instance.makeMsg(i.C2S.ROOM_LEAVE, {
u: this.uid,
t: this.token,
r: this.roomID
});
f.default.Instance.send(e);
};
e._instance = null;
return e;
}();
o.default = v;
cc._RF.pop();
}, {
"../../../Game/client/global/enum/game/Event": "Event",
"../../../Game/client/global/enum/game/Game": "Game",
"../../../Game/client/global/enum/net/C2S": "C2S",
"../../../Game/client/global/enum/net/S2C": "S2C",
"../../../Game/fromework/global/Tools": "Tools",
"../../../Game/fromework/helper/EventHelper": "EventHelper",
"../../../Game/fromework/mvvm/modelView/ViewModel": "ViewModel",
"../../../client/logic/game/HearBeat": "HearBeat",
"../../../client/model/ErrorModel": "ErrorModel",
"../../../client/model/WalletModel": "WalletModel",
"../../../fromework/helper/NetHelper": "NetHelper",
"../../../platform/Platform": "Platform",
"../../Common/Utils/CompositeConst": "CompositeConst",
"./BlastEvent": "BlastEvent",
"./BlastStruct": "BlastStruct"
} ],
BlastMyRecordItem: [ function(e, t, o) {
"use strict";
cc._RF.push(t, "76a1a+NQUBJw5+mEemJ/Lu3", "BlastMyRecordItem");
var n, a = this && this.__extends || (n = function(e, t) {
return (n = Object.setPrototypeOf || {
__proto__: []
} instanceof Array && function(e, t) {
e.__proto__ = t;
} || function(e, t) {
for (var o in t) Object.prototype.hasOwnProperty.call(t, o) && (e[o] = t[o]);
})(e, t);
}, function(e, t) {
n(e, t);
function o() {
this.constructor = e;
}
e.prototype = null === t ? Object.create(t) : (o.prototype = t.prototype, new o());
}), i = this && this.__decorate || function(e, t, o, n) {
var a, i = arguments.length, r = i < 3 ? t : null === n ? n = Object.getOwnPropertyDescriptor(t, o) : n;
if ("object" == typeof Reflect && "function" == typeof Reflect.decorate) r = Reflect.decorate(e, t, o, n); else for (var l = e.length - 1; l >= 0; l--) (a = e[l]) && (r = (i < 3 ? a(r) : i > 3 ? a(t, o, r) : a(t, o)) || r);
return i > 3 && r && Object.defineProperty(t, o, r), r;
};
Object.defineProperty(o, "__esModule", {
value: !0
});
var r = e("../../../Game/client/global/enum/game/UIUtils"), l = e("../../../Game/client/model/LanguageModel"), s = cc._decorator, c = s.ccclass, u = s.property, d = function(e) {
a(t, e);
function t() {
var t = null !== e && e.apply(this, arguments) || this;
t.RocketIcon = null;
t.ID = null;
t.Money = null;
t.WinMoney = null;
t.Rate = null;
t._data = null;
return t;
}
t.prototype.onItemInitCallFunc = function(e) {
this._data = e;
this.ID.string = l.default.getString("COMMON_ID_SPACE") + this._data.p;
this.Money.string = parseFloat(this._data.b.toFixed(2)).toString();
this.WinMoney.string = 1 == this._data.r ? "Win " + parseFloat(this._data.w.toFixed(2)) : "Lose " + parseFloat(this._data.b.toFixed(2));
this.Rate.string = 1 == this._data.r ? this._data.m.toFixed(2) + "" : "Fail";
var t = 1 == this._data.r ? "fffd05" : "ff0000";
r.UIUtils.setNodeColor(this.WinMoney.node, t);
var o = this._data.m, n = "";
1 == this._data.r ? o < 2 ? n = "1791f0" : o >= 2 && o < 5 ? n = "e41cf6" : o >= 5 && o < 10 ? n = "fd7f0f" : o >= 10 && o < 50 ? n = "f81c17" : o >= 50 && (n = "fff60a") : n = "ff0000";
r.UIUtils.setNodeColor(this.RocketIcon, n);
r.UIUtils.setNodeColor(this.Rate.node, n);
};
t.prototype.onItemEnterCallFunc = function() {
this.node.opacity = 255;
};
t.prototype.onItemExitCallFunc = function() {
this.node.opacity = 0;
};
i([ u(cc.Node) ], t.prototype, "RocketIcon", void 0);
i([ u(cc.Label) ], t.prototype, "ID", void 0);
i([ u(cc.Label) ], t.prototype, "Money", void 0);
i([ u(cc.Label) ], t.prototype, "WinMoney", void 0);
i([ u(cc.Label) ], t.prototype, "Rate", void 0);
return i([ c ], t);
}(cc.Component);
o.default = d;
cc._RF.pop();
}, {
"../../../Game/client/global/enum/game/UIUtils": "UIUtils",
"../../../Game/client/model/LanguageModel": "LanguageModel"
} ],
BlastRecordAlertItem: [ function(e, t, o) {
"use strict";
cc._RF.push(t, "e5e20j7mPdOH7QrYf8Q35e9", "BlastRecordAlertItem");
var n, a = this && this.__extends || (n = function(e, t) {
return (n = Object.setPrototypeOf || {
__proto__: []
} instanceof Array && function(e, t) {
e.__proto__ = t;
} || function(e, t) {
for (var o in t) Object.prototype.hasOwnProperty.call(t, o) && (e[o] = t[o]);
})(e, t);
}, function(e, t) {
n(e, t);
function o() {
this.constructor = e;
}
e.prototype = null === t ? Object.create(t) : (o.prototype = t.prototype, new o());
}), i = this && this.__decorate || function(e, t, o, n) {
var a, i = arguments.length, r = i < 3 ? t : null === n ? n = Object.getOwnPropertyDescriptor(t, o) : n;
if ("object" == typeof Reflect && "function" == typeof Reflect.decorate) r = Reflect.decorate(e, t, o, n); else for (var l = e.length - 1; l >= 0; l--) (a = e[l]) && (r = (i < 3 ? a(r) : i > 3 ? a(t, o, r) : a(t, o)) || r);
return i > 3 && r && Object.defineProperty(t, o, r), r;
};
Object.defineProperty(o, "__esModule", {
value: !0
});
var r = cc._decorator, l = r.ccclass, s = r.property, c = function(e) {
a(t, e);
function t() {
var t = null !== e && e.apply(this, arguments) || this;
t.Pertod = null;
t.WinRates = [];
t._data = null;
return t;
}
t.prototype.onItemInitCallFunc = function(e) {
this._data = e;
this.Pertod.string = this._data.p + "";
var t = this._data.d, o = 0;
t < 2 ? o = 0 : t >= 2 && t < 5 ? o = 1 : t >= 5 && t < 10 ? o = 2 : t >= 10 && t < 50 ? o = 3 : t >= 50 && (o = 4);
this.WinRates.forEach(function(e, n) {
e.node.active = n == o;
n == o && (e.string = t + "");
});
};
t.prototype.onItemEnterCallFunc = function() {
this.node.opacity = 255;
};
t.prototype.onItemExitCallFunc = function() {
this.node.opacity = 0;
};
i([ s(cc.Label) ], t.prototype, "Pertod", void 0);
i([ s([ cc.Label ]) ], t.prototype, "WinRates", void 0);
return i([ l ], t);
}(cc.Component);
o.default = c;
cc._RF.pop();
}, {} ],
BlastRecordAlert: [ function(e, t, o) {
"use strict";
cc._RF.push(t, "f54b0UBpydDMrspvC19eLrp", "BlastRecordAlert");
var n, a = this && this.__extends || (n = function(e, t) {
return (n = Object.setPrototypeOf || {
__proto__: []
} instanceof Array && function(e, t) {
e.__proto__ = t;
} || function(e, t) {
for (var o in t) Object.prototype.hasOwnProperty.call(t, o) && (e[o] = t[o]);
})(e, t);
}, function(e, t) {
n(e, t);
function o() {
this.constructor = e;
}
e.prototype = null === t ? Object.create(t) : (o.prototype = t.prototype, new o());
}), i = this && this.__decorate || function(e, t, o, n) {
var a, i = arguments.length, r = i < 3 ? t : null === n ? n = Object.getOwnPropertyDescriptor(t, o) : n;
if ("object" == typeof Reflect && "function" == typeof Reflect.decorate) r = Reflect.decorate(e, t, o, n); else for (var l = e.length - 1; l >= 0; l--) (a = e[l]) && (r = (i < 3 ? a(r) : i > 3 ? a(t, o, r) : a(t, o)) || r);
return i > 3 && r && Object.defineProperty(t, o, r), r;
};
Object.defineProperty(o, "__esModule", {
value: !0
});
var r = e("../../../Game/fromework/global/Tools"), l = e("../../../Game/fromework/helper/UIHelper"), s = e("../../../fromework/component/TableView/TableList"), c = e("../Common/BlastModel"), u = e("./BlastRecordAlertItem"), d = cc._decorator, p = d.ccclass, h = d.property, f = function(e) {
a(t, e);
function t() {
var t = null !== e && e.apply(this, arguments) || this;
t.BottomList = null;
t.Chance = [];
t.Times = [];
t.Highest = [];
t._datas = [];
return t;
}
t.prototype.onLoad = function() {
this.refreshView();
};
t.prototype.refreshView = function() {
this.refreshTop();
this.refreshBottom();
};
t.prototype.refreshTop = function() {
var e = c.BlastModel.Instance.declearHistory.getStatisticalData();
this.Chance.forEach(function(t, o) {
t.string = parseFloat(r.Tools.TFloat.mul(e.chance[o], 100).toFixed(2)).toString().concat("%");
});
this.Times.forEach(function(t, o) {
t.string = e.times[o] + "";
});
this.Highest.forEach(function(t, o) {
t.string = e.highest[o] + "";
});
};
t.prototype.onBottomItemRender = function(e, t) {
e.getComponent(u.default).onItemInitCallFunc(this._datas[t], t);
};
t.prototype.refreshBottom = function() {
var e = c.BlastModel.Instance;
this._datas = e.declearHistory.getHistoryAry();
this.BottomList.numItems = this._datas.length;
};
t.prototype.onCloseClicked = function() {
l.default.Instance.removeMaskLayer(this.node, !0);
};
i([ h(s.default) ], t.prototype, "BottomList", void 0);
i([ h([ cc.Label ]) ], t.prototype, "Chance", void 0);
i([ h([ cc.Label ]) ], t.prototype, "Times", void 0);
i([ h([ cc.Label ]) ], t.prototype, "Highest", void 0);
return i([ p ], t);
}(cc.Component);
o.default = f;
cc._RF.pop();
}, {
"../../../Game/fromework/global/Tools": "Tools",
"../../../Game/fromework/helper/UIHelper": "UIHelper",
"../../../fromework/component/TableView/TableList": "TableList",
"../Common/BlastModel": "BlastModel",
"./BlastRecordAlertItem": "BlastRecordAlertItem"
} ],
BlastRecordPanel: [ function(e, t, o) {
"use strict";
cc._RF.push(t, "f6fb8ogW75P+Lt/bcWwn6fn", "BlastRecordPanel");
var n, a = this && this.__extends || (n = function(e, t) {
return (n = Object.setPrototypeOf || {
__proto__: []
} instanceof Array && function(e, t) {
e.__proto__ = t;
} || function(e, t) {
for (var o in t) Object.prototype.hasOwnProperty.call(t, o) && (e[o] = t[o]);
})(e, t);
}, function(e, t) {
n(e, t);
function o() {
this.constructor = e;
}
e.prototype = null === t ? Object.create(t) : (o.prototype = t.prototype, new o());
}), i = this && this.__decorate || function(e, t, o, n) {
var a, i = arguments.length, r = i < 3 ? t : null === n ? n = Object.getOwnPropertyDescriptor(t, o) : n;
if ("object" == typeof Reflect && "function" == typeof Reflect.decorate) r = Reflect.decorate(e, t, o, n); else for (var l = e.length - 1; l >= 0; l--) (a = e[l]) && (r = (i < 3 ? a(r) : i > 3 ? a(t, o, r) : a(t, o)) || r);
return i > 3 && r && Object.defineProperty(t, o, r), r;
};
Object.defineProperty(o, "__esModule", {
value: !0
});
var r = e("../../../Game/fromework/helper/EventHelper"), l = e("../../../Game/fromework/mvvm/modelView/ViewModel"), s = e("../../../platform/Platform"), c = e("../../../fromework/component/TableView/TableList"), u = e("../Common/BlastEvent"), d = e("../Common/BlastModel"), p = e("./BlastLotteryRecordItem"), h = e("./BlastMyRecordItem"), f = e("./BlastThisRoundItem"), _ = cc._decorator, m = _.ccclass, y = _.property, g = function(e) {
a(t, e);
function t() {
var t = null !== e && e.apply(this, arguments) || this;
t.ThisRoundList = null;
t.LotteryRecordList = null;
t.MyRecordList = null;
t.ToggleContainer = null;
t.Toggles = [];
t._curIndex = 0;
t._isInit = !1;
t._time = 0;
t._rate = 0;
t._thisRoundList = [];
t._lotteryList = [];
t._myList = [];
return t;
}
t.prototype.onEnable = function() {
r.default.Instance.Global.bind(u.BlastGameEvent.GAME_RECONNECT, this.onReconnect, this);
r.default.Instance.Global.bind(u.BlastGameEvent.S2C_RESET_BLAST, this.onReset, this);
r.default.Instance.Global.bind(u.BlastUIEvent.BLAST_RECORD_ROUND_REFRESH, this.refreshRoundList, this);
r.default.Instance.Global.bind(u.BlastUIEvent.BLAST_RECORD_LOTTERY_REFRESH, this.refreshLotteryList, this);
r.default.Instance.Global.bind(u.BlastGameEvent.S2C_USER_RECORD_BLAST, this.refreshMyList, this);
r.default.Instance.Global.bind(u.BlastUIEvent.BLAST_SYNC_TIME_RATE, this.refreshTime, this);
r.default.Instance.Global.bind(u.BlastUIEvent.BLAST_ROCKET_START, this.onRocketStart, this);
r.default.Instance.Global.bind(u.BlastUIEvent.BLAST_ROCKET_STOP, this.onRocketStop, this);
this.MyRecordList.node.on("scroll-to-bottom", this.loadMoreMyRecord, this);
};
t.prototype.onDisable = function() {
this.unscheduleAllCallbacks();
r.default.Instance.Global.unbind(u.BlastGameEvent.GAME_RECONNECT, this.onReconnect, this);
r.default.Instance.Global.unbind(u.BlastGameEvent.S2C_RESET_BLAST, this.onReset, this);
r.default.Instance.Global.unbind(u.BlastUIEvent.BLAST_RECORD_ROUND_REFRESH, this.refreshRoundList, this);
r.default.Instance.Global.unbind(u.BlastUIEvent.BLAST_RECORD_LOTTERY_REFRESH, this.refreshLotteryList, this);
r.default.Instance.Global.unbind(u.BlastGameEvent.S2C_USER_RECORD_BLAST, this.refreshMyList, this);
r.default.Instance.Global.unbind(u.BlastUIEvent.BLAST_SYNC_TIME_RATE, this.refreshTime, this);
r.default.Instance.Global.unbind(u.BlastUIEvent.BLAST_ROCKET_START, this.onRocketStart, this);
r.default.Instance.Global.unbind(u.BlastUIEvent.BLAST_ROCKET_STOP, this.onRocketStop, this);
this.MyRecordList.node.off("scroll-to-bottom", this.loadMoreMyRecord, this);
};
t.prototype.loadMoreMyRecord = function() {
d.default.Instance.sendUserRecord();
};
t.prototype.onReconnect = function() {
if (!this._isInit) {
this._isInit = !0;
this.Toggles[this._curIndex].isChecked = !0;
this.setListActive(this._curIndex);
}
0 == this._curIndex && this.refreshRoundList();
1 == this._curIndex && this.refreshLotteryList();
2 == this._curIndex && d.default.Instance.sendUserRecord();
};
t.prototype.onReset = function() {
if (1 == this.MyRecordList.node.active) {
d.BlastModel.Instance.user_record.length = 0;
d.default.Instance.userPage = 0;
d.default.Instance.sendUserRecord();
}
};
t.prototype.sortThisRound = function(e) {
var t = d.BlastModel.Instance, o = l.VM.getValue("user.uid");
3 == t.roomData.state ? e.sort(function(e, t) {
var o = e.nowRate > 0 && e.nowRate >= e.bet_record.multiple, n = t.nowRate > 0 && t.nowRate >= t.bet_record.multiple;
return o && n ? t.bet_record.multiple - e.bet_record.multiple : o ? -1 : n ? 1 : 0;
}) : 4 == t.roomData.state || 1 == t.roomData.state ? e.sort(function(e, t) {
return t.bet_record.multiple - e.bet_record.multiple;
}) : e.sort(function(e, t) {
return t.index - e.index;
});
for (var n = 0; n < e.length; n++) if (e[n].uid == o) {
var a = e.splice(n, 1)[0];
e.unshift(a);
break;
}
};
t.prototype.checkRefreshThisRound = function() {
if (this.ThisRoundList.node.active) {
var e = d.BlastModel.Instance;
if (e && e.roomData && (2 == e.roomData.state || 3 == e.roomData.state)) {
s.default.log("刷新ThisRound");
this.refreshRoundList();
}
}
};
t.prototype.onThisRoundRender = function(e, t) {
e.getComponent(f.default).onItemInitCallFunc(this._thisRoundList[t], t);
};
t.prototype.refreshRoundList = function() {
var e = this;
if (this.ThisRoundList.node.active) {
var t = d.BlastModel.Instance;
this._thisRoundList.length = 0;
t.allUserData.forEach(function(t) {
t.nowRate = e._rate;
1 == t.state && t.bet_record.amount > 0 && e._thisRoundList.push(t);
});
this.sortThisRound(this._thisRoundList);
this.ThisRoundList.numItems = this._thisRoundList.length;
this.unschedule(this.checkRefreshThisRound);
this.scheduleOnce(this.checkRefreshThisRound, 1.5);
}
};
t.prototype.onLotteryRender = function(e, t) {
e.getComponent(p.default).onItemInitCallFunc(this._lotteryList[t], t);
};
t.prototype.refreshLotteryList = function() {
if (this.LotteryRecordList.node.active) {
var e = d.BlastModel.Instance;
this._lotteryList = e.declearHistory.historyArray.concat().reverse();
this.LotteryRecordList.numItems = this._lotteryList.length;
}
};
t.prototype.onMyRender = function(e, t) {
e.getComponent(h.default).onItemInitCallFunc(this._myList[t], t);
};
t.prototype.refreshMyList = function() {
if (this.MyRecordList.node.active) {
var e = d.BlastModel.Instance;
this._myList = e.user_record.concat();
this.MyRecordList.numItems = this._myList.length;
}
};
t.prototype.refreshTime = function(e) {
var t = e.getUserData();
this._time = t.time;
this._rate = t.rate;
};
t.prototype.onRocketStart = function() {};
t.prototype.onRocketStop = function() {
this.unscheduleAllCallbacks();
};
t.prototype.setListActive = function(e) {
var t = d.BlastModel.Instance;
if (0 == e) {
this.ThisRoundList.node.active = !0;
this.LotteryRecordList.node.active = !1;
this.MyRecordList.node.active = !1;
this.refreshRoundList();
} else if (1 == e) {
this.ThisRoundList.node.active = !1;
this.LotteryRecordList.node.active = !0;
this.MyRecordList.node.active = !1;
this.refreshLotteryList();
} else if (2 == e) {
this.ThisRoundList.node.active = !1;
this.LotteryRecordList.node.active = !1;
this.MyRecordList.node.active = !0;
t.user_record.length = 0;
d.default.Instance.userPage = 0;
d.default.Instance.sendUserRecord();
}
};
t.prototype.onToggleContainerClicked = function() {
this.ToggleContainer.toggleItems.forEach(function(e) {
e.node.getChildByName("Background").active = !e.isChecked;
});
};
t.prototype.onToggleClicked = function(e, t) {
var o = parseInt(t);
if (o != this._curIndex) {
this._curIndex = o;
this.setListActive(this._curIndex);
}
};
i([ y(c.default) ], t.prototype, "ThisRoundList", void 0);
i([ y(c.default) ], t.prototype, "LotteryRecordList", void 0);
i([ y(c.default) ], t.prototype, "MyRecordList", void 0);
i([ y(cc.ToggleContainer) ], t.prototype, "ToggleContainer", void 0);
i([ y([ cc.Toggle ]) ], t.prototype, "Toggles", void 0);
return i([ m ], t);
}(cc.Component);
o.default = g;
cc._RF.pop();
}, {
"../../../Game/fromework/helper/EventHelper": "EventHelper",
"../../../Game/fromework/mvvm/modelView/ViewModel": "ViewModel",
"../../../fromework/component/TableView/TableList": "TableList",
"../../../platform/Platform": "Platform",
"../Common/BlastEvent": "BlastEvent",
"../Common/BlastModel": "BlastModel",
"./BlastLotteryRecordItem": "BlastLotteryRecordItem",
"./BlastMyRecordItem": "BlastMyRecordItem",
"./BlastThisRoundItem": "BlastThisRoundItem"
} ],
BlastRecordSmall: [ function(e, t, o) {
"use strict";
cc._RF.push(t, "c0b07EDKs9PMbKHWDQLJwUE", "BlastRecordSmall");
var n, a = this && this.__extends || (n = function(e, t) {
return (n = Object.setPrototypeOf || {
__proto__: []
} instanceof Array && function(e, t) {
e.__proto__ = t;
} || function(e, t) {
for (var o in t) Object.prototype.hasOwnProperty.call(t, o) && (e[o] = t[o]);
})(e, t);
}, function(e, t) {
n(e, t);
function o() {
this.constructor = e;
}
e.prototype = null === t ? Object.create(t) : (o.prototype = t.prototype, new o());
}), i = this && this.__decorate || function(e, t, o, n) {
var a, i = arguments.length, r = i < 3 ? t : null === n ? n = Object.getOwnPropertyDescriptor(t, o) : n;
if ("object" == typeof Reflect && "function" == typeof Reflect.decorate) r = Reflect.decorate(e, t, o, n); else for (var l = e.length - 1; l >= 0; l--) (a = e[l]) && (r = (i < 3 ? a(r) : i > 3 ? a(t, o, r) : a(t, o)) || r);
return i > 3 && r && Object.defineProperty(t, o, r), r;
};
Object.defineProperty(o, "__esModule", {
value: !0
});
var r = e("../../../Game/client/global/enum/game/Const"), l = e("../../../Game/client/global/enum/game/UIUtils"), s = e("../../../Game/fromework/helper/EventHelper"), c = e("../../../Game/fromework/helper/UIHelper"), u = e("../Common/BlastEvent"), d = e("../Common/BlastModel"), p = cc._decorator, h = p.ccclass, f = p.property, _ = function(e) {
a(t, e);
function t() {
var t = null !== e && e.apply(this, arguments) || this;
t.TopRecordParent = null;
t.TopRecordItem = null;
t.Light = null;
t.MaxCount = 7;
return t;
}
t.prototype.onEnable = function() {
s.default.Instance.Global.bind(u.BlastGameEvent.GAME_RECONNECT, this._onEnterRoom, this);
s.default.Instance.Global.bind(u.BlastUIEvent.BLAST_ROCKET_STOP, this._onResetRoom, this);
};
t.prototype.onDisable = function() {
s.default.Instance.Global.unbind(u.BlastGameEvent.GAME_RECONNECT, this._onEnterRoom, this);
s.default.Instance.Global.unbind(u.BlastUIEvent.BLAST_ROCKET_STOP, this._onResetRoom, this);
};
t.prototype.onLoad = function() {
this.refreshTopRecord(!1);
};
t.prototype._onEnterRoom = function() {
this.refreshTopRecord(!1);
};
t.prototype._onResetRoom = function() {
this.refreshTopRecord(!0);
};
t.prototype.refreshTopRecord = function(e) {
var t = this;
void 0 === e && (e = !1);
var o = d.BlastModel.Instance;
this.TopRecordParent.destroyAllChildren();
for (var n = o.declearHistory.getSimpleHistory(this.MaxCount), a = 0; a < n.length; a++) {
var i = n[a], r = cc.instantiate(this.TopRecordItem);
r.active = !0;
r.setPosition(cc.Vec2.ZERO);
r.parent = this.TopRecordParent;
var s = i.d, c = "";
s < 2 ? c = "1791f0" : s >= 2 && s < 5 ? c = "e41cf6" : s >= 5 && s < 10 ? c = "fd7f0f" : s >= 10 && s < 50 ? c = "f81c17" : s >= 50 && (c = "fff60a");
var u = r.getChildByName("Points");
l.UIUtils.setNodeColor(u, c);
u.getComponent(cc.Label).string = s + "";
}
if (e && null != this.Light) {
this.TopRecordParent.getComponent(cc.Layout).updateLayout();
var p = this.TopRecordParent.children[this.TopRecordParent.children.length - 1], h = p.parent.convertToWorldSpaceAR(p.position), f = this.Light.node.parent.convertToNodeSpaceAR(h);
this.Light.node.position = f;
this.Light.node.active = !0;
this.Light.armatureName = "Armature";
this.Light.once(dragonBones.EventObject.COMPLETE, function() {
t.Light.node.active = !1;
}, this);
this.Light.playAnimation("animation_new_details", 1);
}
};
t.prototype.onHistoryClicked = function() {
c.default.Instance.addBundleMaskLayer(r.BundleUIPath.BlastRecordAlert);
};
i([ f(cc.Node) ], t.prototype, "TopRecordParent", void 0);
i([ f(cc.Node) ], t.prototype, "TopRecordItem", void 0);
i([ f(dragonBones.ArmatureDisplay) ], t.prototype, "Light", void 0);
i([ f ], t.prototype, "MaxCount", void 0);
return i([ h ], t);
}(cc.Component);
o.default = _;
cc._RF.pop();
}, {
"../../../Game/client/global/enum/game/Const": "Const",
"../../../Game/client/global/enum/game/UIUtils": "UIUtils",
"../../../Game/fromework/helper/EventHelper": "EventHelper",
"../../../Game/fromework/helper/UIHelper": "UIHelper",
"../Common/BlastEvent": "BlastEvent",
"../Common/BlastModel": "BlastModel"
} ],
BlastRocket: [ function(e, t, o) {
"use strict";
cc._RF.push(t, "d569dyMmhpBcJAtyoMwrq1l", "BlastRocket");
var n, a = this && this.__extends || (n = function(e, t) {
return (n = Object.setPrototypeOf || {
__proto__: []
} instanceof Array && function(e, t) {
e.__proto__ = t;
} || function(e, t) {
for (var o in t) Object.prototype.hasOwnProperty.call(t, o) && (e[o] = t[o]);
})(e, t);
}, function(e, t) {
n(e, t);
function o() {
this.constructor = e;
}
e.prototype = null === t ? Object.create(t) : (o.prototype = t.prototype, new o());
}), i = this && this.__decorate || function(e, t, o, n) {
var a, i = arguments.length, r = i < 3 ? t : null === n ? n = Object.getOwnPropertyDescriptor(t, o) : n;
if ("object" == typeof Reflect && "function" == typeof Reflect.decorate) r = Reflect.decorate(e, t, o, n); else for (var l = e.length - 1; l >= 0; l--) (a = e[l]) && (r = (i < 3 ? a(r) : i > 3 ? a(t, o, r) : a(t, o)) || r);
return i > 3 && r && Object.defineProperty(t, o, r), r;
};
Object.defineProperty(o, "__esModule", {
value: !0
});
var r = e("../../../Game/client/global/enum/game/Const"), l = e("../../../Game/fromework/global/Tools"), s = e("../../../Game/fromework/helper/AudioHelper"), c = cc._decorator, u = c.ccclass, d = c.property, p = function(e) {
a(t, e);
function t() {
var t = null !== e && e.apply(this, arguments) || this;
t.Rocket = null;
t.Boom1 = null;
t.Boom2 = null;
t.ShakeImage = null;
return t;
}
t.prototype.playReady = function() {
this.Boom1.node.active = !1;
this.Boom2.node.active = !1;
this.Rocket.node.active = !0;
s.default.Instance.stopBGM();
this.Rocket.playAnimation("ready", 0);
};
t.prototype.playLaunch = function(e) {
this.Boom1.node.active = !1;
this.Boom2.node.active = !1;
this.Rocket.node.active = !0;
s.default.Instance.stopBGM();
s.default.Instance.playBundleEffect(r.BundleSoundPath.blast_takeoff);
this.Rocket.playAnimation("take_off", 0);
e && e();
};
t.prototype.playFly = function() {
this.Boom1.node.active = !1;
this.Boom2.node.active = !1;
this.Rocket.node.active = !0;
s.default.Instance.playBGMBundle(r.BundleSoundPath.blast_flying);
this.Rocket.playAnimation("flying", 0);
};
t.prototype.playShake = function() {
var e = this, t = l.Tools.TNumber.randomNumber(1, 3), o = l.Tools.TNumber.randomNumber(2, 3), n = 0 == l.Tools.TNumber.randomNumber(0, 1);
if (0 == t && 0 == o) {
t = 0;
o = 0;
}
if (0 != t) {
this.ShakeImage.active = !0;
this.ShakeImage.opacity = 0;
this.ShakeImage.stopAllActions();
cc.tween(this.ShakeImage).to(.1, {
opacity: 255
}).to(.1, {
opacity: 0
}).union().repeat(t).call(function() {
e.ShakeImage.active = !1;
}).start();
}
if (0 != o) {
this.node.stopAllActions();
n ? cc.tween(this.node).by(.05, {
scale: .05
}).by(.05, {
scale: -.05
}).union().repeat(o).start() : cc.tween(this.node).by(.01, {
x: 5
}).by(.02, {
x: -10
}).by(.01, {
x: 5
}).union().repeat(2 * o).start();
}
};
t.prototype.playBoom = function(e) {
var t = this;
this.Boom1.node.active = !0;
this.Rocket.node.active = !1;
s.default.Instance.stopBGM();
s.default.Instance.playBundleEffect(r.BundleSoundPath.blast_boom);
this.Boom1.once(dragonBones.EventObject.COMPLETE, function() {
t.Boom1.node.active = !1;
t.Boom2.node.active = !0;
t.Boom2.once(dragonBones.EventObject.COMPLETE, function() {
t.Boom2.node.active = !1;
e && e();
}, t);
t.Boom2.playAnimation("flying_boom", 1);
}, this);
this.Boom1.playAnimation("flying_boom", 1);
};
i([ d(dragonBones.ArmatureDisplay) ], t.prototype, "Rocket", void 0);
i([ d(dragonBones.ArmatureDisplay) ], t.prototype, "Boom1", void 0);
i([ d(dragonBones.ArmatureDisplay) ], t.prototype, "Boom2", void 0);
i([ d(cc.Node) ], t.prototype, "ShakeImage", void 0);
return i([ u ], t);
}(cc.Component);
o.default = p;
cc._RF.pop();
}, {
"../../../Game/client/global/enum/game/Const": "Const",
"../../../Game/fromework/global/Tools": "Tools",
"../../../Game/fromework/helper/AudioHelper": "AudioHelper"
} ],
BlastScaleLine: [ function(e, t, o) {
"use strict";
cc._RF.push(t, "aa49aaBka5HUriICUCz3uH+", "BlastScaleLine");
var n, a = this && this.__extends || (n = function(e, t) {
return (n = Object.setPrototypeOf || {
__proto__: []
} instanceof Array && function(e, t) {
e.__proto__ = t;
} || function(e, t) {
for (var o in t) Object.prototype.hasOwnProperty.call(t, o) && (e[o] = t[o]);
})(e, t);
}, function(e, t) {
n(e, t);
function o() {
this.constructor = e;
}
e.prototype = null === t ? Object.create(t) : (o.prototype = t.prototype, new o());
}), i = this && this.__decorate || function(e, t, o, n) {
var a, i = arguments.length, r = i < 3 ? t : null === n ? n = Object.getOwnPropertyDescriptor(t, o) : n;
if ("object" == typeof Reflect && "function" == typeof Reflect.decorate) r = Reflect.decorate(e, t, o, n); else for (var l = e.length - 1; l >= 0; l--) (a = e[l]) && (r = (i < 3 ? a(r) : i > 3 ? a(t, o, r) : a(t, o)) || r);
return i > 3 && r && Object.defineProperty(t, o, r), r;
};
Object.defineProperty(o, "__esModule", {
value: !0
});
var r = cc._decorator, l = r.ccclass, s = r.property, c = function(e) {
a(t, e);
function t() {
var t = null !== e && e.apply(this, arguments) || this;
t.Tag = null;
t.TextRatio = null;
t._ratio = 0;
return t;
}
Object.defineProperty(t.prototype, "ratio", {
get: function() {
return this._ratio;
},
set: function(e) {
this._ratio = e;
if (e <= 1) this.node.opacity = 0; else {
this.node.opacity = 255;
this.TextRatio.string = this._ratio + "x";
}
},
enumerable: !1,
configurable: !0
});
t.prototype.init = function(e) {
void 0 === e && (e = 0);
this.ratio = e;
};
i([ s(cc.Node) ], t.prototype, "Tag", void 0);
i([ s(cc.Label) ], t.prototype, "TextRatio", void 0);
return i([ l ], t);
}(cc.Component);
o.default = c;
cc._RF.pop();
}, {} ],
BlastSpaceBG: [ function(e, t, o) {
"use strict";
cc._RF.push(t, "42bf9J/pGpCW77akHtH+gkM", "BlastSpaceBG");
var n, a = this && this.__extends || (n = function(e, t) {
return (n = Object.setPrototypeOf || {
__proto__: []
} instanceof Array && function(e, t) {
e.__proto__ = t;
} || function(e, t) {
for (var o in t) Object.prototype.hasOwnProperty.call(t, o) && (e[o] = t[o]);
})(e, t);
}, function(e, t) {
n(e, t);
function o() {
this.constructor = e;
}
e.prototype = null === t ? Object.create(t) : (o.prototype = t.prototype, new o());
}), i = this && this.__decorate || function(e, t, o, n) {
var a, i = arguments.length, r = i < 3 ? t : null === n ? n = Object.getOwnPropertyDescriptor(t, o) : n;
if ("object" == typeof Reflect && "function" == typeof Reflect.decorate) r = Reflect.decorate(e, t, o, n); else for (var l = e.length - 1; l >= 0; l--) (a = e[l]) && (r = (i < 3 ? a(r) : i > 3 ? a(t, o, r) : a(t, o)) || r);
return i > 3 && r && Object.defineProperty(t, o, r), r;
};
Object.defineProperty(o, "__esModule", {
value: !0
});
var r = e("./BlastSpaceMeteor"), l = e("./BlastSpaceMeteorite"), s = e("./BlastSpaceStar"), c = cc._decorator, u = c.ccclass, d = c.property, p = .5, h = 1, f = 7, _ = function(e) {
a(t, e);
function t() {
var t = null !== e && e.apply(this, arguments) || this;
t.SkyNodes = [];
t.BlastStar = null;
t.BlastMeteor = null;
t.BlastMeteorite = null;
t.StarParent = null;
t.MeteorParent = null;
t.MeteoriteParent = null;
t._starPool = [];
t._meteorPool = [];
t._meteoritePool = [];
t.skySpeed = p;
t.starSpeed = h;
t.meteoriteSpeed = f;
t._star_minY = 0;
return t;
}
t.prototype.onLoad = function() {
var e = cc.winSize.height;
this._star_minY = -e;
this.SkyNodes.forEach(function(t, o) {
t.setContentSize(cc.winSize);
t.y = e * (o - 1);
});
this.SkyNodes.sort(function(e, t) {
return t.y - e.y;
});
for (var t = 0; t < 30; t++) {
var o = cc.instantiate(this.BlastStar);
o.parent = this.StarParent;
(a = o.getComponent(s.default)).doRandom();
this._starPool.push(a);
}
for (t = 0; t < 5; t++) {
var n = cc.instantiate(this.BlastMeteor);
n.parent = this.MeteorParent;
(a = n.getComponent(r.default)).doRandom();
this._meteorPool.push(a);
}
for (t = 0; t < 5; t++) {
var a, i = cc.instantiate(this.BlastMeteorite);
i.parent = this.MeteoriteParent;
(a = i.getComponent(l.default)).doRandom();
this._meteoritePool.push(a);
}
};
t.prototype.reset = function() {
this._meteoritePool.forEach(function(e) {
e.doRandom();
});
this.skySpeed = p;
this.starSpeed = h;
this.meteoriteSpeed = f;
};
t.prototype.moveSky = function(e) {
for (var t = 0; t < this.SkyNodes.length; ++t) (o = this.SkyNodes[t]).y -= e;
for (t = 0; t < this.SkyNodes.length; ++t) {
var o;
if ((o = this.SkyNodes[t]).y <= this._star_minY) {
var n = this.SkyNodes;
n.sort(function(e, t) {
return t.y - e.y;
});
o.y = n[0].y + o.height;
}
}
};
t.prototype.moveStar = function(e) {
for (var t = 0; t < this._starPool.length; ++t) this._starPool[t].changePos(e);
};
t.prototype.moveMeteor = function() {
for (var e = 0; e < this._meteorPool.length; ++e) this._meteorPool[e].changePos();
};
t.prototype.moveMeteorite = function(e) {
for (var t = 0; t < this._meteoritePool.length; ++t) this._meteoritePool[t].changePos(e);
};
t.prototype.move = function(e) {
this.skySpeed += .05 * e;
this.starSpeed += .1 * e;
this.meteoriteSpeed += 1 * e;
this.moveSky(Math.min(this.skySpeed, 2.5));
this.moveStar(Math.min(this.starSpeed, 5));
this.moveMeteorite(Math.min(this.meteoriteSpeed, 47));
};
t.prototype.update = function() {
this.moveMeteor();
};
i([ d([ cc.Node ]) ], t.prototype, "SkyNodes", void 0);
i([ d(cc.Prefab) ], t.prototype, "BlastStar", void 0);
i([ d(cc.Prefab) ], t.prototype, "BlastMeteor", void 0);
i([ d(cc.Prefab) ], t.prototype, "BlastMeteorite", void 0);
i([ d(cc.Node) ], t.prototype, "StarParent", void 0);
i([ d(cc.Node) ], t.prototype, "MeteorParent", void 0);
i([ d(cc.Node) ], t.prototype, "MeteoriteParent", void 0);
return i([ u ], t);
}(cc.Component);
o.default = _;
cc._RF.pop();
}, {
"./BlastSpaceMeteor": "BlastSpaceMeteor",
"./BlastSpaceMeteorite": "BlastSpaceMeteorite",
"./BlastSpaceStar": "BlastSpaceStar"
} ],
BlastSpaceMeteorite: [ function(e, t, o) {
"use strict";
cc._RF.push(t, "d06a5tIvGhEu4MWMW+BZ4wh", "BlastSpaceMeteorite");
var n, a = this && this.__extends || (n = function(e, t) {
return (n = Object.setPrototypeOf || {
__proto__: []
} instanceof Array && function(e, t) {
e.__proto__ = t;
} || function(e, t) {
for (var o in t) Object.prototype.hasOwnProperty.call(t, o) && (e[o] = t[o]);
})(e, t);
}, function(e, t) {
n(e, t);
function o() {
this.constructor = e;
}
e.prototype = null === t ? Object.create(t) : (o.prototype = t.prototype, new o());
}), i = this && this.__decorate || function(e, t, o, n) {
var a, i = arguments.length, r = i < 3 ? t : null === n ? n = Object.getOwnPropertyDescriptor(t, o) : n;
if ("object" == typeof Reflect && "function" == typeof Reflect.decorate) r = Reflect.decorate(e, t, o, n); else for (var l = e.length - 1; l >= 0; l--) (a = e[l]) && (r = (i < 3 ? a(r) : i > 3 ? a(t, o, r) : a(t, o)) || r);
return i > 3 && r && Object.defineProperty(t, o, r), r;
};
Object.defineProperty(o, "__esModule", {
value: !0
});
var r = e("../../../Game/fromework/global/Tools"), l = cc._decorator, s = l.ccclass, c = l.property, u = function(e) {
a(t, e);
function t() {
var t = null !== e && e.apply(this, arguments) || this;
t.MeteoriteAry = [];
t._rotation = 0;
return t;
}
t.prototype.doRandom = function() {
this.MeteoriteAry.forEach(function(e) {
e.node.active = !1;
});
var e = r.Tools.TNumber.randomFloat(0, cc.winSize.width), t = r.Tools.TNumber.randomFloat(cc.winSize.height, 2 * cc.winSize.height), o = r.Tools.TNumber.randomFloat(.2, .4), n = r.Tools.TNumber.randomNumber(0, this.MeteoriteAry.length - 1);
r.Tools.TNumber.randomFloat(.1, .5);
this._rotation = r.Tools.TNumber.randomFloat(-.8, 1.2);
var a = this.MeteoriteAry[n];
a.node.active = !0;
a.armatureName = "Armature";
a.timeScale = 1;
a.playAnimation("meteorite_" + (n + 1), 0);
this.node.x = e;
this.node.y = t;
this.node.scale = o;
this.node.zIndex = Math.floor(100 * o);
};
t.prototype.changePos = function(e) {
this.node.y -= e * this.node.scale;
this.node.angle += this._rotation;
if (this.node.y < -this.node.height) {
this.node.x = r.Tools.TNumber.randomFloat(0, cc.winSize.width);
this.node.y += 2 * cc.winSize.height;
}
};
i([ c([ dragonBones.ArmatureDisplay ]) ], t.prototype, "MeteoriteAry", void 0);
return i([ s ], t);
}(cc.Component);
o.default = u;
cc._RF.pop();
}, {
"../../../Game/fromework/global/Tools": "Tools"
} ],
BlastSpaceMeteor: [ function(e, t, o) {
"use strict";
cc._RF.push(t, "955b1FVK4JDrLyKiir9baqt", "BlastSpaceMeteor");
var n, a = this && this.__extends || (n = function(e, t) {
return (n = Object.setPrototypeOf || {
__proto__: []
} instanceof Array && function(e, t) {
e.__proto__ = t;
} || function(e, t) {
for (var o in t) Object.prototype.hasOwnProperty.call(t, o) && (e[o] = t[o]);
})(e, t);
}, function(e, t) {
n(e, t);
function o() {
this.constructor = e;
}
e.prototype = null === t ? Object.create(t) : (o.prototype = t.prototype, new o());
}), i = this && this.__decorate || function(e, t, o, n) {
var a, i = arguments.length, r = i < 3 ? t : null === n ? n = Object.getOwnPropertyDescriptor(t, o) : n;
if ("object" == typeof Reflect && "function" == typeof Reflect.decorate) r = Reflect.decorate(e, t, o, n); else for (var l = e.length - 1; l >= 0; l--) (a = e[l]) && (r = (i < 3 ? a(r) : i > 3 ? a(t, o, r) : a(t, o)) || r);
return i > 3 && r && Object.defineProperty(t, o, r), r;
};
Object.defineProperty(o, "__esModule", {
value: !0
});
var r = e("../../../Game/fromework/global/Tools"), l = cc._decorator, s = l.ccclass, c = l.property, u = function(e) {
a(t, e);
function t() {
var t = null !== e && e.apply(this, arguments) || this;
t.Star = null;
return t;
}
t.prototype.doRandom = function() {
var e, t = r.Tools.TNumber.randomFloat(-200, cc.winSize.width - 200);
e = t >= 0 ? r.Tools.TNumber.randomFloat(cc.winSize.height, 2 * cc.winSize.height) : r.Tools.TNumber.randomFloat(0, 2 * cc.winSize.height);
var o = r.Tools.TNumber.randomFloat(.5, 1);
this.node.x = t;
this.node.y = e;
this.node.scale = o;
this.node.angle = 45;
var n = r.Tools.TNumber.randomNumber(1, 2);
this.Star.playAnimation("meteor_" + n, 0);
};
t.prototype.changePos = function() {
this.node.x += 6 * Math.pow(this.node.scale, 2);
this.node.y -= 6 * Math.pow(this.node.scale, 2);
(this.node.x > cc.winSize.width + this.node.width || this.node.y < -this.node.height) && this.doRandom();
};
i([ c(dragonBones.ArmatureDisplay) ], t.prototype, "Star", void 0);
return i([ s ], t);
}(cc.Component);
o.default = u;
cc._RF.pop();
}, {
"../../../Game/fromework/global/Tools": "Tools"
} ],
BlastSpaceRun: [ function(e, t, o) {
"use strict";
cc._RF.push(t, "e18d7R7xU1AHYI4CofHSGQI", "BlastSpaceRun");
var n, a = this && this.__extends || (n = function(e, t) {
return (n = Object.setPrototypeOf || {
__proto__: []
} instanceof Array && function(e, t) {
e.__proto__ = t;
} || function(e, t) {
for (var o in t) Object.prototype.hasOwnProperty.call(t, o) && (e[o] = t[o]);
})(e, t);
}, function(e, t) {
n(e, t);
function o() {
this.constructor = e;
}
e.prototype = null === t ? Object.create(t) : (o.prototype = t.prototype, new o());
}), i = this && this.__decorate || function(e, t, o, n) {
var a, i = arguments.length, r = i < 3 ? t : null === n ? n = Object.getOwnPropertyDescriptor(t, o) : n;
if ("object" == typeof Reflect && "function" == typeof Reflect.decorate) r = Reflect.decorate(e, t, o, n); else for (var l = e.length - 1; l >= 0; l--) (a = e[l]) && (r = (i < 3 ? a(r) : i > 3 ? a(t, o, r) : a(t, o)) || r);
return i > 3 && r && Object.defineProperty(t, o, r), r;
};
Object.defineProperty(o, "__esModule", {
value: !0
});
var r = e("../../../Game/fromework/global/Tools"), l = e("../../../Game/fromework/helper/EventHelper"), s = e("../Common/BlastEvent"), c = e("../Common/BlastModel"), u = cc._decorator, d = u.ccclass, p = (u.property, 
function() {
this.x = 0;
this.y = 0;
this.opacity = 0;
this.runNode = null;
}), h = function(e) {
a(t, e);
function t() {
var t = null !== e && e.apply(this, arguments) || this;
t.runEscapes = [];
t._time = 0;
return t;
}
t.prototype.onEnable = function() {
l.default.Instance.Global.bind(s.BlastUIEvent.BLAST_ROCKET_ESCAPE, this.onEscape, this);
l.default.Instance.Global.bind(s.BlastUIEvent.BLAST_ROCKET_ESCAPE_BATCH, this.onEscapeBatch, this);
l.default.Instance.Global.bind(s.BlastUIEvent.BLAST_ROCKET_STOP, this.onReset, this);
l.default.Instance.Global.bind(s.BlastUIEvent.BLAST_SYNC_TIME_RATE, this.refreshTime, this);
};
t.prototype.onDisable = function() {
l.default.Instance.Global.unbind(s.BlastUIEvent.BLAST_ROCKET_ESCAPE, this.onEscape, this);
l.default.Instance.Global.unbind(s.BlastUIEvent.BLAST_ROCKET_ESCAPE_BATCH, this.onEscapeBatch, this);
l.default.Instance.Global.unbind(s.BlastUIEvent.BLAST_ROCKET_STOP, this.onReset, this);
l.default.Instance.Global.bind(s.BlastUIEvent.BLAST_SYNC_TIME_RATE, this.refreshTime, this);
};
t.prototype.createRunNode = function(e) {
var t = new p();
t.runNode = new cc.Node();
t.runNode.addComponent(cc.Label);
t.runNode.parent = this.node;
t.runNode.position = cc.Vec3.ZERO;
t.runNode.color = cc.color(209, 217, 255);
var o = t.runNode.getComponent(cc.Label);
o.fontSize = 20;
o.lineHeight = 20;
o.string = e;
t.x = r.Tools.TNumber.randomNumber(-2, 2);
t.y = r.Tools.TNumber.randomNumber(2, 5);
t.opacity = 2;
return t;
};
t.prototype.onEscape = function(e) {
var t = e.getUserData(), o = this.createRunNode(t.name + " took off @" + t.bet_record.multiple + "X");
this.runEscapes.push(o);
};
t.prototype.onEscapeBatch = function(e) {
var t = this, o = c.BlastModel.Instance, n = e.getUserData();
Object.keys(n).forEach(function(e) {
var n = o.getUserData(Number(e));
if (null != n) {
var a = 16.609 * Math.log(n.bet_record.multiple) + .0228 - t._time;
a < 0 && (a = 0);
t.scheduleOnce(function() {
var e = t.createRunNode(n.name + " took off @" + n.bet_record.multiple + "X");
t.runEscapes.push(e);
}, a);
}
});
};
t.prototype.onReset = function() {
this.unscheduleAllCallbacks();
this.node.destroyAllChildren();
this.runEscapes.length = 0;
this._time = 0;
};
t.prototype.refreshTime = function(e) {
var t = e.getUserData();
this._time = 16.609 * Math.log(t.rate) + .0228;
};
t.prototype.update = function() {
var e = this.runEscapes.length;
if (e > 0) for (var t = 0; t < e; t++) {
var o = this.runEscapes[t];
if (o) {
o.runNode.x += o.x;
o.runNode.y -= o.y;
o.runNode.opacity -= o.opacity;
if (o.runNode.opacity <= 0) {
o.runNode.destroy();
this.runEscapes.splice(t, 1);
}
}
}
};
return i([ d ], t);
}(cc.Component);
o.default = h;
cc._RF.pop();
}, {
"../../../Game/fromework/global/Tools": "Tools",
"../../../Game/fromework/helper/EventHelper": "EventHelper",
"../Common/BlastEvent": "BlastEvent",
"../Common/BlastModel": "BlastModel"
} ],
BlastSpaceScene: [ function(e, t, o) {
"use strict";
cc._RF.push(t, "9d154atyHBBGbpqhnnPf64x", "BlastSpaceScene");
var n, a = this && this.__extends || (n = function(e, t) {
return (n = Object.setPrototypeOf || {
__proto__: []
} instanceof Array && function(e, t) {
e.__proto__ = t;
} || function(e, t) {
for (var o in t) Object.prototype.hasOwnProperty.call(t, o) && (e[o] = t[o]);
})(e, t);
}, function(e, t) {
n(e, t);
function o() {
this.constructor = e;
}
e.prototype = null === t ? Object.create(t) : (o.prototype = t.prototype, new o());
}), i = this && this.__decorate || function(e, t, o, n) {
var a, i = arguments.length, r = i < 3 ? t : null === n ? n = Object.getOwnPropertyDescriptor(t, o) : n;
if ("object" == typeof Reflect && "function" == typeof Reflect.decorate) r = Reflect.decorate(e, t, o, n); else for (var l = e.length - 1; l >= 0; l--) (a = e[l]) && (r = (i < 3 ? a(r) : i > 3 ? a(t, o, r) : a(t, o)) || r);
return i > 3 && r && Object.defineProperty(t, o, r), r;
};
Object.defineProperty(o, "__esModule", {
value: !0
});
var r = e("../../../Game/BundleManager"), l = e("../../../Game/client/global/enum/game/Const"), s = e("../../../Game/client/global/enum/game/Event"), c = e("../../../Game/client/logic/game/GameHelper"), u = e("../../../Game/fromework/helper/AudioHelper"), d = e("../../../Game/fromework/helper/EventHelper"), p = e("../../../Game/fromework/helper/UIHelper"), h = e("../../../Game/fromework/mvvm/modelView/ViewModel"), f = e("../../../platform/Platform"), _ = e("../../../client/global/PopHelper"), m = e("../../../client/logic/game/HearBeat"), y = e("../../../client/logic/Wallet/WalletHelper"), g = e("../../../client/model/GameModel"), v = e("../../../client/teenpatti/model/TeenPattiModel"), C = e("../Common/BlastEvent"), b = e("../Common/BlastModel"), I = cc._decorator, E = I.ccclass, S = I.property, T = function(e) {
a(t, e);
function t() {
var t = null !== e && e.apply(this, arguments) || this;
t.Background = null;
t.UILayer = null;
t.TopLayer = null;
t._roomID = 0;
return t;
}
t.prototype._initNetworkDelay = function() {};
t.prototype._joinRoom = function() {
this._roomID = h.VM.getValue("lobby.roomID");
b.default.Instance.sendEnterRoom(this._roomID);
};
t.prototype._onSwitchRoom = function(e) {
var t = e.getUserData();
b.default.Instance.sendEnterRoom(t);
};
t.prototype._onLeaveSingle = function() {
this._leaveRoom();
};
t.prototype._leaveRoom = function(e) {
void 0 === e && (e = !1);
_.PopHelper.Instance.closeCountdown(this._roomID);
_.PopHelper.Instance.showWaiting(1);
b.default.Instance.clear();
c.Countdown.clear();
_.PopHelper.Instance.hideWaiting();
h.VM.setValue("lobby.roomID", 0);
r.default.getInstance().enterBundleScene(l.Scene.Lobby, function() {
e && y.default.Instance.openRecharge();
});
f.default.setOrientation(l.Orientation.Landscape);
};
t.prototype.onEnable = function() {
d.default.Instance.Global.bind(C.BlastGameEvent.S2C_SWITCH_ROOM_BLAST, this._onSwitchRoom, this);
d.default.Instance.Global.bind(C.BlastGameEvent.S2C_LEAVE_SINGLE_BLAST, this._onLeaveSingle, this);
d.default.Instance.Global.bind(C.BlastGameEvent.S2C_DISMISS_ROOM_BLAST, this._onLeaveSingle, this);
d.default.Instance.Global.bind(s.GameEvent.TABLE_REFRESH_TABLE, this._joinRoom, this);
};
t.prototype.onDisable = function() {
d.default.Instance.Global.unbind(C.BlastGameEvent.S2C_SWITCH_ROOM_BLAST, this._onSwitchRoom, this);
d.default.Instance.Global.unbind(C.BlastGameEvent.S2C_LEAVE_SINGLE_BLAST, this._onLeaveSingle, this);
d.default.Instance.Global.unbind(C.BlastGameEvent.S2C_DISMISS_ROOM_BLAST, this._onLeaveSingle, this);
d.default.Instance.Global.unbind(s.GameEvent.TABLE_REFRESH_TABLE, this._joinRoom, this);
};
t.prototype.onDestroy = function() {
cc.game.off(cc.game.EVENT_SHOW, this._joinRoom, this);
b.default.Instance.destory();
this._roomID = 0;
};
t.prototype.onLoad = function() {
u.default.Instance.stopBGM();
v.default.Instance.destory();
g.default.Instance.destory();
b.default.Instance.Init();
m.default.Instance.intervalTime = 5e3;
p.default.Instance.setLayers(this.Background, this.UILayer, this.TopLayer);
this._initNetworkDelay();
cc.game.on(cc.game.EVENT_SHOW, this._joinRoom, this);
};
t.prototype.start = function() {
this._joinRoom();
};
i([ S(cc.Node) ], t.prototype, "Background", void 0);
i([ S(cc.Node) ], t.prototype, "UILayer", void 0);
i([ S(cc.Node) ], t.prototype, "TopLayer", void 0);
return i([ E ], t);
}(cc.Component);
o.default = T;
cc._RF.pop();
}, {
"../../../Game/BundleManager": "BundleManager",
"../../../Game/client/global/enum/game/Const": "Const",
"../../../Game/client/global/enum/game/Event": "Event",
"../../../Game/client/logic/game/GameHelper": "GameHelper",
"../../../Game/fromework/helper/AudioHelper": "AudioHelper",
"../../../Game/fromework/helper/EventHelper": "EventHelper",
"../../../Game/fromework/helper/UIHelper": "UIHelper",
"../../../Game/fromework/mvvm/modelView/ViewModel": "ViewModel",
"../../../client/global/PopHelper": "PopHelper",
"../../../client/logic/Wallet/WalletHelper": "WalletHelper",
"../../../client/logic/game/HearBeat": "HearBeat",
"../../../client/model/GameModel": "GameModel",
"../../../client/teenpatti/model/TeenPattiModel": "TeenPattiModel",
"../../../platform/Platform": "Platform",
"../Common/BlastEvent": "BlastEvent",
"../Common/BlastModel": "BlastModel"
} ],
BlastSpaceStar: [ function(e, t, o) {
"use strict";
cc._RF.push(t, "5ae0evy825E4K32QEAOWcuC", "BlastSpaceStar");
var n, a = this && this.__extends || (n = function(e, t) {
return (n = Object.setPrototypeOf || {
__proto__: []
} instanceof Array && function(e, t) {
e.__proto__ = t;
} || function(e, t) {
for (var o in t) Object.prototype.hasOwnProperty.call(t, o) && (e[o] = t[o]);
})(e, t);
}, function(e, t) {
n(e, t);
function o() {
this.constructor = e;
}
e.prototype = null === t ? Object.create(t) : (o.prototype = t.prototype, new o());
}), i = this && this.__decorate || function(e, t, o, n) {
var a, i = arguments.length, r = i < 3 ? t : null === n ? n = Object.getOwnPropertyDescriptor(t, o) : n;
if ("object" == typeof Reflect && "function" == typeof Reflect.decorate) r = Reflect.decorate(e, t, o, n); else for (var l = e.length - 1; l >= 0; l--) (a = e[l]) && (r = (i < 3 ? a(r) : i > 3 ? a(t, o, r) : a(t, o)) || r);
return i > 3 && r && Object.defineProperty(t, o, r), r;
};
Object.defineProperty(o, "__esModule", {
value: !0
});
var r = e("../../../Game/fromework/global/Tools"), l = cc._decorator, s = l.ccclass, c = l.property, u = function(e) {
a(t, e);
function t() {
var t = null !== e && e.apply(this, arguments) || this;
t.StarAry = [];
return t;
}
t.prototype.doRandom = function() {
this.StarAry.forEach(function(e) {
e.active = !1;
});
var e = r.Tools.TNumber.randomFloat(0, cc.winSize.width), t = r.Tools.TNumber.randomFloat(0, 2 * cc.winSize.height), o = r.Tools.TNumber.randomFloat(.25, .6), n = r.Tools.TNumber.randomNumber(0, this.StarAry.length - 1);
this.StarAry[n].active = !0;
this.node.x = e;
this.node.y = t;
this.node.scale = o;
};
t.prototype.changePos = function(e) {
this.node.y -= e * Math.pow(this.node.scale + .5, 2.5);
if (this.node.y < -this.node.height) {
this.node.x = r.Tools.TNumber.randomFloat(0, cc.winSize.width);
this.node.y += 2 * cc.winSize.height;
}
};
i([ c([ cc.Node ]) ], t.prototype, "StarAry", void 0);
return i([ s ], t);
}(cc.Component);
o.default = u;
cc._RF.pop();
}, {
"../../../Game/fromework/global/Tools": "Tools"
} ],
BlastSpaceUI: [ function(e, t, o) {
"use strict";
cc._RF.push(t, "2c6d8Zfh7hEGqwSE6HDIHUC", "BlastSpaceUI");
var n, a = this && this.__extends || (n = function(e, t) {
return (n = Object.setPrototypeOf || {
__proto__: []
} instanceof Array && function(e, t) {
e.__proto__ = t;
} || function(e, t) {
for (var o in t) Object.prototype.hasOwnProperty.call(t, o) && (e[o] = t[o]);
})(e, t);
}, function(e, t) {
n(e, t);
function o() {
this.constructor = e;
}
e.prototype = null === t ? Object.create(t) : (o.prototype = t.prototype, new o());
}), i = this && this.__decorate || function(e, t, o, n) {
var a, i = arguments.length, r = i < 3 ? t : null === n ? n = Object.getOwnPropertyDescriptor(t, o) : n;
if ("object" == typeof Reflect && "function" == typeof Reflect.decorate) r = Reflect.decorate(e, t, o, n); else for (var l = e.length - 1; l >= 0; l--) (a = e[l]) && (r = (i < 3 ? a(r) : i > 3 ? a(t, o, r) : a(t, o)) || r);
return i > 3 && r && Object.defineProperty(t, o, r), r;
};
Object.defineProperty(o, "__esModule", {
value: !0
});
var r = e("../../../client/logic/Wallet/WalletHelper"), l = e("../../../Game/client/model/LanguageModel"), s = e("../Common/BlastEvent"), c = e("../Common/BlastModel"), u = e("../../../Game/fromework/helper/EventHelper"), d = e("../../../Game/fromework/mvvm/modelView/ViewModel"), p = e("../../../Game/client/global/enum/game/Const"), h = e("../../../Game/fromework/helper/UIHelper"), f = e("../../../client/global/PopHelper"), _ = cc._decorator, m = _.ccclass, y = _.property, g = function(e) {
a(t, e);
function t() {
var t = null !== e && e.apply(this, arguments) || this;
t.BlastSpace = null;
return t;
}
t.prototype.onEnable = function() {
u.default.Instance.Global.bind(s.BlastGameEvent.S2C_RESET_BLAST, this.onReset);
};
t.prototype.onDisable = function() {
u.default.Instance.Global.unbind(s.BlastGameEvent.S2C_RESET_BLAST, this.onReset);
};
t.prototype.onLoad = function() {};
t.prototype.onReset = function() {};
t.prototype.onLeaveClicked = function() {
var e = c.BlastModel.Instance.getUserData(d.VM.getValue("user.uid"));
1 == e.state && 0 == e.res ? f.PopHelper.Instance.showTips(l.default.getString("TIPS_TMWOCSPW")) : c.default.Instance.sendLeave();
};
t.prototype.onHelpClicked = function() {
h.default.Instance.addBundleMaskLayer(p.BundleUIPath.BlastHelp);
};
t.prototype.onRechargeClicked = function() {
r.default.Instance.openRecharge();
};
i([ y(cc.Node) ], t.prototype, "BlastSpace", void 0);
return i([ m ], t);
}(cc.Component);
o.default = g;
cc._RF.pop();
}, {
"../../../Game/client/global/enum/game/Const": "Const",
"../../../Game/client/model/LanguageModel": "LanguageModel",
"../../../Game/fromework/helper/EventHelper": "EventHelper",
"../../../Game/fromework/helper/UIHelper": "UIHelper",
"../../../Game/fromework/mvvm/modelView/ViewModel": "ViewModel",
"../../../client/global/PopHelper": "PopHelper",
"../../../client/logic/Wallet/WalletHelper": "WalletHelper",
"../Common/BlastEvent": "BlastEvent",
"../Common/BlastModel": "BlastModel"
} ],
BlastSpace: [ function(e, t, o) {
"use strict";
cc._RF.push(t, "05765A3WvdMtaagnGCHOTWf", "BlastSpace");
var n, a = this && this.__extends || (n = function(e, t) {
return (n = Object.setPrototypeOf || {
__proto__: []
} instanceof Array && function(e, t) {
e.__proto__ = t;
} || function(e, t) {
for (var o in t) Object.prototype.hasOwnProperty.call(t, o) && (e[o] = t[o]);
})(e, t);
}, function(e, t) {
n(e, t);
function o() {
this.constructor = e;
}
e.prototype = null === t ? Object.create(t) : (o.prototype = t.prototype, new o());
}), i = this && this.__decorate || function(e, t, o, n) {
var a, i = arguments.length, r = i < 3 ? t : null === n ? n = Object.getOwnPropertyDescriptor(t, o) : n;
if ("object" == typeof Reflect && "function" == typeof Reflect.decorate) r = Reflect.decorate(e, t, o, n); else for (var l = e.length - 1; l >= 0; l--) (a = e[l]) && (r = (i < 3 ? a(r) : i > 3 ? a(t, o, r) : a(t, o)) || r);
return i > 3 && r && Object.defineProperty(t, o, r), r;
};
Object.defineProperty(o, "__esModule", {
value: !0
});
var r = e("../../../Game/fromework/global/Tools"), l = e("../../../Game/fromework/helper/EventHelper"), s = e("../../../Game/fromework/mvvm/modelView/ViewModel"), c = e("../Common/BlastEvent"), u = e("../Common/BlastModel"), d = e("./BlastRocket"), p = e("./BlastScaleLine"), h = e("./BlastSpaceBG"), f = cc._decorator, _ = f.ccclass, m = f.property, y = function(e) {
a(t, e);
function t() {
var t = null !== e && e.apply(this, arguments) || this;
t.SpaceBG = null;
t.ScaleLineNode = null;
t.ScaleLine = null;
t.LaunchBaseBack = null;
t.Rocket = null;
t.LaunchBaseFront = null;
t.Smoke = null;
t.RateBorder = null;
t.Rate = null;
t._scaleLinePool = [];
t._time = 0;
t._shakeTime = 0;
t._star_minY = 0;
t._preY = 0;
t._launchBackStartY = 0;
t._launchFrontStartY = 0;
t._rocketStartY = 0;
t._start = !1;
t._sendBoom = !1;
t._sendRun = !1;
return t;
}
t.prototype.getRateByTime = function(e) {
var t = null == e ? this._time : e;
return t <= 0 ? 1 : Math.exp((t - .0228) / 16.609);
};
t.prototype.onEnable = function() {
l.default.Instance.Global.bind(c.BlastGameEvent.GAME_RECONNECT, this._onReconnet, this);
l.default.Instance.Global.bind(c.BlastUIEvent.BLAST_ROCKET_START, this._onStartRocket, this);
l.default.Instance.Global.bind(c.BlastUIEvent.BLAST_ROCKET_STOP, this._onStopRocket, this);
l.default.Instance.Global.bind(c.BlastUIEvent.BLAST_PLAY_RATE_BORDER, this._playRateBorder, this);
l.default.Instance.Global.bind(c.BlastGameEvent.S2C_RESET_BLAST, this._onResetRocket, this);
};
t.prototype.onDisable = function() {
l.default.Instance.Global.unbind(c.BlastGameEvent.GAME_RECONNECT, this._onReconnet, this);
l.default.Instance.Global.unbind(c.BlastUIEvent.BLAST_ROCKET_START, this._onStartRocket, this);
l.default.Instance.Global.unbind(c.BlastUIEvent.BLAST_ROCKET_STOP, this._onStopRocket, this);
l.default.Instance.Global.unbind(c.BlastUIEvent.BLAST_PLAY_RATE_BORDER, this._playRateBorder, this);
l.default.Instance.Global.unbind(c.BlastGameEvent.S2C_RESET_BLAST, this._onResetRocket, this);
};
t.prototype.onLoad = function() {
this.init();
};
t.prototype._onReconnet = function() {
var e = u.BlastModel.Instance;
this._sendBoom = !1;
this._sendRun = !1;
if (3 == e.roomData.state) {
this._time = e.roomData.getLunchTime(e.sTime);
this._preY = 0;
this._start = !0;
this.RateBorder.height = 565;
this.Rocket.node.active = !0;
this.Rocket.node.stopAllActions();
this.Rocket.node.y = 0;
this.Rocket.node.scale = 1;
this.Rocket.playFly();
this.LaunchBaseBack.active = !1;
this.LaunchBaseFront.active = !1;
} else if (4 == e.roomData.state) {
this._time = e.roomData.getLunchTime(e.sTime);
this._preY = 0;
this._start = !1;
this.RateBorder.height = 565;
this.Rocket.node.active = !1;
this.Rocket.node.stopAllActions();
this.LaunchBaseBack.active = !1;
this.LaunchBaseFront.active = !1;
} else {
this.RateBorder.height = 0;
this.resetRocket();
}
this.Rate.string = this.getRateByTime(this._time).toFixed(2) + "X";
};
t.prototype._onStartRocket = function() {
var e = this;
this._sendBoom = !1;
this._sendRun = !1;
this.resetRocket();
this._start = !0;
this.Smoke.node.active = !0;
this.Smoke.once(dragonBones.EventObject.COMPLETE, function() {
e.Smoke.node.active = !1;
}, this);
this.Smoke.playAnimation("smoke", 1);
if (565 != this.RateBorder.height) {
this.RateBorder.stopAllActions();
this.RateBorder.height = 565;
}
this.Rocket.playLaunch(function() {
cc.tween(e.Rocket.node).to(1, {
y: 0,
scale: 1
}, {
easing: "circOut"
}).call(function() {
!e._sendBoom && e.Rocket.playFly();
}).start();
});
};
t.prototype._onStopRocket = function() {
var e = this, t = u.BlastModel.Instance;
this._start = !1;
this.Rate.string = this.getRateByTime(t.roomData.getEndTime()).toFixed(2) + "X";
this.Rocket.node.stopAllActions();
this.Rocket.playBoom(function() {
e.Rocket.node.active = !1;
});
};
t.prototype._playRateBorder = function() {
this.RateBorder.stopAllActions();
this.RateBorder.height = 0;
cc.tween(this.RateBorder).to(.7, {
height: 565
}).start();
};
t.prototype._onResetRocket = function() {
this._sendBoom = !1;
this._sendRun = !1;
this.RateBorder.height = 0;
this.resetRocket();
};
t.prototype.resetRocket = function() {
this._start = !1;
this._time = 0;
this._shakeTime = 0;
this._preY = 0;
l.default.Instance.Global.emit(c.BlastUIEvent.BLAST_SYNC_TIME_RATE, {
time: 0,
rate: 0
});
this.Rate.string = "1X";
this.Rocket.node.stopAllActions();
this.Rocket.node.y = this._rocketStartY;
this.Rocket.node.scale = 1;
this.Rocket.node.active = !0;
this.Rocket.playReady();
this.LaunchBaseBack.y = this._launchBackStartY;
this.LaunchBaseBack.active = !0;
this.LaunchBaseFront.y = this._launchFrontStartY;
this.LaunchBaseFront.active = !0;
for (var e = 0, t = 0; t < this._scaleLinePool.length; t++) {
var o = this._scaleLinePool[t];
e = e >= 10 ? e + 1 : e + .5;
o.node.y = 1e3 * e + 160;
o.ratio = e;
}
this._scaleLinePool.sort(function(e, t) {
return t.node.y - e.node.y;
});
this.SpaceBG.reset();
};
t.prototype.init = function() {
var e = cc.winSize.height;
this._star_minY = -e;
this._time = 0;
this._shakeTime = 0;
this._rocketStartY = this.Rocket.node.y;
this._launchBackStartY = this.LaunchBaseBack.y;
this._launchFrontStartY = this.LaunchBaseFront.y;
this.Rocket.node.getComponent(cc.Widget).enabled = !1;
this.LaunchBaseBack.getComponent(cc.Widget).enabled = !1;
this.LaunchBaseFront.getComponent(cc.Widget).enabled = !1;
this.Rate.string = "1X";
this.RateBorder.height = 0;
for (var t = this.getRateByTime(this._time), o = Math.ceil(t), n = 0; n < 20; ++n) {
var a = cc.instantiate(this.ScaleLine);
if (a) {
var i = a.getComponent(p.default);
if (i) {
o = o >= 10 ? o + 1 : o + .5;
i.node.parent = this.ScaleLineNode;
i.node.x = 0;
i.node.y = 1e3 * o + 160;
i.ratio = o;
this._scaleLinePool.push(i);
}
}
}
this._scaleLinePool.sort(function(e, t) {
return t.node.y - e.node.y;
});
};
t.prototype._move = function(e) {
var t = u.BlastModel.Instance, o = t.getUserData(s.VM.getValue("user.uid")), n = t.roomData.getEndTime();
this._time += e;
var a = this.getRateByTime(this._time), i = 1e3 * (a - this._preY);
l.default.Instance.Global.emit(c.BlastUIEvent.BLAST_SYNC_TIME_RATE, {
time: this._time,
rate: a
});
for (var r = 0; r < this._scaleLinePool.length; ++r) (d = this._scaleLinePool[r]).node.y -= i;
for (r = 0; r < this._scaleLinePool.length; ++r) {
var d;
if ((d = this._scaleLinePool[r]).node.y <= this._star_minY / 2 - d.node.height) {
var p = this._scaleLinePool;
p.sort(function(e, t) {
return t.node.y - e.node.y;
});
if (p[0].ratio >= 10) {
d.node.y = p[0].node.y + 1e3;
d.ratio = p[0].ratio + 1;
} else {
d.node.y = p[0].node.y + 500;
d.ratio = p[0].ratio + .5;
}
}
}
if (this.LaunchBaseBack.active) {
this.LaunchBaseBack.y -= 3;
Math.abs(this.LaunchBaseBack.y) <= this.LaunchBaseBack.height && (this.LaunchBaseBack.active = !1);
}
if (this.LaunchBaseFront.active) {
this.LaunchBaseFront.y -= 3;
Math.abs(this.LaunchBaseFront.y) <= this.LaunchBaseFront.height && (this.LaunchBaseFront.active = !1);
}
this.SpaceBG.move(a - this._preY);
this.Rate.string = a.toFixed(2) + "X";
this._preY = a;
if (t.autoPlay && a >= t.autoRate && 1 == o.state && 0 == o.res && !this._sendRun) {
this._sendRun = !0;
u.default.Instance.sendRun(t.autoRate);
}
if (this._time >= n && !this._sendBoom) {
this._sendBoom = !0;
this._start = !1;
u.default.Instance.sendBoom();
}
};
t.prototype.update = function(e) {
if (this._start) {
this._move(e);
0 == this._shakeTime && (this._shakeTime = this._time + r.Tools.TNumber.randomFloat(1, 5));
if (this._time >= this._shakeTime) {
this.Rocket.playShake();
this._shakeTime = this._time + r.Tools.TNumber.randomFloat(1, 5);
}
}
};
i([ m(h.default) ], t.prototype, "SpaceBG", void 0);
i([ m(cc.Node) ], t.prototype, "ScaleLineNode", void 0);
i([ m(cc.Prefab) ], t.prototype, "ScaleLine", void 0);
i([ m(cc.Node) ], t.prototype, "LaunchBaseBack", void 0);
i([ m(d.default) ], t.prototype, "Rocket", void 0);
i([ m(cc.Node) ], t.prototype, "LaunchBaseFront", void 0);
i([ m(dragonBones.ArmatureDisplay) ], t.prototype, "Smoke", void 0);
i([ m(cc.Node) ], t.prototype, "RateBorder", void 0);
i([ m(cc.Label) ], t.prototype, "Rate", void 0);
return i([ _ ], t);
}(cc.Component);
o.default = y;
cc._RF.pop();
}, {
"../../../Game/fromework/global/Tools": "Tools",
"../../../Game/fromework/helper/EventHelper": "EventHelper",
"../../../Game/fromework/mvvm/modelView/ViewModel": "ViewModel",
"../Common/BlastEvent": "BlastEvent",
"../Common/BlastModel": "BlastModel",
"./BlastRocket": "BlastRocket",
"./BlastScaleLine": "BlastScaleLine",
"./BlastSpaceBG": "BlastSpaceBG"
} ],
BlastStruct: [ function(e, t, o) {
"use strict";
cc._RF.push(t, "50c10Fh9DZLSZS5Ug12SlRl", "BlastStruct");
Object.defineProperty(o, "__esModule", {
value: !0
});
o.BlastStruct = void 0;
var n = e("../../../Game/fromework/global/Tools");
(function(e) {
var t = function() {
function e(e) {
this.multiple = 0;
this.amount = 0;
e && this.refresh(e);
}
e.prototype.refresh = function(e) {
null == e.multiple ? this.multiple = 0 : this.multiple = e.multiple;
null == e.amount ? this.amount = 0 : this.amount = n.Tools.TNumber.num2single(e.amount);
};
return e;
}();
e.BetRecord = t;
var o = function() {
function e(e) {
this.uid = 0;
this.name = "";
this.head_url = "";
this.sex = 0;
this.auto = !1;
this.state = 0;
this.res = 0;
this.total_fee = 0;
this.bet_record = null;
this.win_fee = 0;
this.index = 0;
e && this.refresh(e);
}
e.prototype.refresh = function(e) {
null != e.uid && (this.uid = e.uid);
null != e.name && (this.name = e.name);
null != e.head_url && (this.head_url = e.head_url);
null != e.sex && (this.sex = e.sex);
null != e.auto && (this.auto = e.auto);
null != e.state && (this.state = e.state);
null != e.res && (this.res = e.res);
null != e.total_fee && (this.total_fee = n.Tools.TNumber.num2single(e.total_fee));
this.bet_record = new t(e.bet_record);
null != e.win_fee && (this.win_fee = n.Tools.TNumber.num2single(e.win_fee));
};
return e;
}();
e.UserData = o;
var a = function() {
function e(e) {
this.rid = 0;
this.rtype = "";
this.state = 0;
this.dl = 0;
this.round = 0;
this.lunch_time = 0;
this.flight_time = 0;
e && this.refresh(e);
}
e.prototype.refresh = function(e) {
this.rid = e.rid;
this.rtype = e.rtype;
this.state = e.state;
this.dl = e.dl;
this.round = e.round;
this.lunch_time = e.lunch_time;
this.flight_time = e.flight_time;
};
e.prototype.getLunchTime = function(e) {
return e - this.lunch_time;
};
e.prototype.getEndTime = function() {
return (this.flight_time - this.round - this.lunch_time) / 2e3;
};
return e;
}();
e.RoomData = a;
var i = function() {
function e(e) {
this.p = 0;
this.m = 0;
this.b = 0;
this.w = 0;
this.r = 0;
e && this.refresh(e);
}
e.prototype.refresh = function(e) {
this.p = e.p;
this.m = e.m;
this.b = n.Tools.TNumber.num2single(e.b);
this.w = n.Tools.TNumber.num2single(e.w);
this.r = e.r;
};
return e;
}();
e.UserRecord = i;
var r = function() {
function e(e) {
this.p = 0;
this.d = 0;
this.b = 0;
this.w = 0;
e && this.refresh(e);
}
e.prototype.refresh = function(e) {
this.p = e.p;
this.d = e.d;
this.b = n.Tools.TNumber.num2single(e.b);
this.w = n.Tools.TNumber.num2single(e.w);
};
return e;
}();
e.HistoryData = r;
var l = function() {
function e(e) {
this.historyArray = [];
e && this.refresh(e);
}
e.prototype.refresh = function(e) {
var t = this;
this.historyArray.splice(0);
e.forEach(function(e) {
var o = new r(e);
t.historyArray.push(o);
});
};
e.prototype.addHistory = function(e) {
100 == this.historyArray.length && this.historyArray.shift();
this.historyArray.push(e);
};
e.prototype.getHistoryAry = function() {
var e = [];
this.historyArray.forEach(function(t) {
e.unshift(t);
});
return e;
};
e.prototype.getSimpleHistory = function(e) {
for (var t = [], o = this.historyArray.length - 1; o >= 0; o--) {
var n = this.historyArray[o];
t.unshift(n);
if (t.length == e) break;
}
return t;
};
e.prototype.getMaxConsecutiveCount = function(e, t) {
for (var o = 0, n = 0, a = 0; a < e.length; a++) if (e[a] == t) o++; else if (o > n) {
n = o;
o = 0;
}
o > n && (n = o);
return n;
};
e.prototype.getStatisticalData = function() {
var e = 0, t = [ 0, 0, 0, 0, 0 ], o = [];
this.historyArray.forEach(function(n) {
e++;
if (n.d < 2) {
t[0]++;
o.push(0);
} else if (n.d >= 2 && n.d < 5) {
t[1]++;
o.push(1);
} else if (n.d >= 5 && n.d < 10) {
t[2]++;
o.push(2);
} else if (n.d >= 10 && n.d < 50) {
t[3]++;
o.push(3);
} else if (n.d >= 50) {
t[4]++;
o.push(4);
}
});
for (var n = [], a = [], i = [], r = 0; r < t.length; r++) {
n.push(t[r] / e);
a.push(t[r]);
i.push(this.getMaxConsecutiveCount(o, r));
}
return {
chance: n,
times: a,
highest: i
};
};
return e;
}();
e.DeclearHistory = l;
})(o.BlastStruct || (o.BlastStruct = {}));
cc._RF.pop();
}, {
"../../../Game/fromework/global/Tools": "Tools"
} ],
BlastThisRoundItem: [ function(e, t, o) {
"use strict";
cc._RF.push(t, "9884br4UJhOipJyuU+n7NYf", "BlastThisRoundItem");
var n, a = this && this.__extends || (n = function(e, t) {
return (n = Object.setPrototypeOf || {
__proto__: []
} instanceof Array && function(e, t) {
e.__proto__ = t;
} || function(e, t) {
for (var o in t) Object.prototype.hasOwnProperty.call(t, o) && (e[o] = t[o]);
})(e, t);
}, function(e, t) {
n(e, t);
function o() {
this.constructor = e;
}
e.prototype = null === t ? Object.create(t) : (o.prototype = t.prototype, new o());
}), i = this && this.__decorate || function(e, t, o, n) {
var a, i = arguments.length, r = i < 3 ? t : null === n ? n = Object.getOwnPropertyDescriptor(t, o) : n;
if ("object" == typeof Reflect && "function" == typeof Reflect.decorate) r = Reflect.decorate(e, t, o, n); else for (var l = e.length - 1; l >= 0; l--) (a = e[l]) && (r = (i < 3 ? a(r) : i > 3 ? a(t, o, r) : a(t, o)) || r);
return i > 3 && r && Object.defineProperty(t, o, r), r;
};
Object.defineProperty(o, "__esModule", {
value: !0
});
var r = e("../../../Game/client/global/enum/game/UIUtils"), l = e("../../../Game/client/model/LanguageModel"), s = e("../../../Game/fromework/global/Tools"), c = e("../Common/BlastModel"), u = cc._decorator, d = u.ccclass, p = u.property, h = function(e) {
a(t, e);
function t() {
var t = null !== e && e.apply(this, arguments) || this;
t.UserHead = null;
t.ResultInfoNode = null;
t.RocketIcon = null;
t.NormalHead = [];
t.Name = null;
t.Money = null;
t.WinMoney = null;
t.Rate = null;
t._data = null;
t._headUrl = "";
return t;
}
t.prototype.onItemInitCallFunc = function(e) {
this._data = e;
if ("" != this._data.head_url && this._headUrl != this._data.head_url) {
this._headUrl = this._data.head_url;
r.UIUtils.updateHeadImage(this._data.head_url, this.UserHead, cc.size(102, 102));
}
this.Name.string = s.Tools.TStr.ellipsisString(this._data.name, 10);
this.Money.string = this._data.bet_record.amount + "";
this.WinMoney.string = l.default.getString("COMMON_WIN_SPACE") + this._data.win_fee.toFixed(2);
this.Rate.string = this._data.bet_record.multiple.toFixed(2) + "";
var t = !0;
this._data.nowRate > 0 && (t = this._data.nowRate >= this._data.bet_record.multiple);
var o, n = c.BlastModel.Instance;
o = 2 == n.roomData.state || 3 == n.roomData.state ? 1 == this._data.state && 1 == this._data.res && t : 1 == this._data.state && 1 == this._data.res;
this.ResultInfoNode.active = o;
if (this.ResultInfoNode.active) {
var a = this._data.bet_record.multiple, i = "";
a < 2 ? i = "1791f0" : a >= 2 && a < 5 ? i = "e41cf6" : a >= 5 && a < 10 ? i = "fd7f0f" : a >= 10 && a < 50 ? i = "f81c17" : a >= 50 && (i = "fff60a");
r.UIUtils.setNodeColor(this.RocketIcon, i);
r.UIUtils.setNodeColor(this.Rate.node, i);
}
};
t.prototype.onItemEnterCallFunc = function() {
this.node.opacity = 255;
};
t.prototype.onItemExitCallFunc = function() {
this.node.opacity = 0;
};
i([ p(cc.Sprite) ], t.prototype, "UserHead", void 0);
i([ p(cc.Node) ], t.prototype, "ResultInfoNode", void 0);
i([ p(cc.Node) ], t.prototype, "RocketIcon", void 0);
i([ p([ cc.SpriteFrame ]) ], t.prototype, "NormalHead", void 0);
i([ p(cc.Label) ], t.prototype, "Name", void 0);
i([ p(cc.Label) ], t.prototype, "Money", void 0);
i([ p(cc.Label) ], t.prototype, "WinMoney", void 0);
i([ p(cc.Label) ], t.prototype, "Rate", void 0);
return i([ d ], t);
}(cc.Component);
o.default = h;
cc._RF.pop();
}, {
"../../../Game/client/global/enum/game/UIUtils": "UIUtils",
"../../../Game/client/model/LanguageModel": "LanguageModel",
"../../../Game/fromework/global/Tools": "Tools",
"../Common/BlastModel": "BlastModel"
} ],
BlastWin: [ function(e, t, o) {
"use strict";
cc._RF.push(t, "bf7d8OHEh5KKY0dSwwLAiuJ", "BlastWin");
var n, a = this && this.__extends || (n = function(e, t) {
return (n = Object.setPrototypeOf || {
__proto__: []
} instanceof Array && function(e, t) {
e.__proto__ = t;
} || function(e, t) {
for (var o in t) Object.prototype.hasOwnProperty.call(t, o) && (e[o] = t[o]);
})(e, t);
}, function(e, t) {
n(e, t);
function o() {
this.constructor = e;
}
e.prototype = null === t ? Object.create(t) : (o.prototype = t.prototype, new o());
}), i = this && this.__decorate || function(e, t, o, n) {
var a, i = arguments.length, r = i < 3 ? t : null === n ? n = Object.getOwnPropertyDescriptor(t, o) : n;
if ("object" == typeof Reflect && "function" == typeof Reflect.decorate) r = Reflect.decorate(e, t, o, n); else for (var l = e.length - 1; l >= 0; l--) (a = e[l]) && (r = (i < 3 ? a(r) : i > 3 ? a(t, o, r) : a(t, o)) || r);
return i > 3 && r && Object.defineProperty(t, o, r), r;
};
Object.defineProperty(o, "__esModule", {
value: !0
});
var r = e("../../../Game/client/model/LanguageModel"), l = e("../../../Game/fromework/global/Tools"), s = e("../../../Game/fromework/helper/EventHelper"), c = e("../../../Game/fromework/mvvm/modelView/ViewModel"), u = e("../Common/BlastEvent"), d = e("../Common/BlastModel"), p = cc._decorator, h = p.ccclass, f = p.property, _ = function(e) {
a(t, e);
function t() {
var t = null !== e && e.apply(this, arguments) || this;
t.WinNode = null;
t.WinLabel = null;
return t;
}
t.prototype.onEnable = function() {
s.default.Instance.Global.bind(u.BlastUIEvent.BLAST_ROCKET_ESCAPE, this.onEscape, this);
};
t.prototype.onDisable = function() {
s.default.Instance.Global.unbind(u.BlastUIEvent.BLAST_ROCKET_ESCAPE, this.onEscape, this);
};
t.prototype.onDestroy = function() {
this.unscheduleAllCallbacks();
};
t.prototype.onEscape = function(e) {
var t = this, o = (d.BlastModel.Instance, e.getUserData());
if (o && o.uid == c.VM.getValue("user.uid") && 1 == o.state && 1 == o.res) {
this.WinLabel.string = r.default.getString("COMMON_WIN_SPACE") + r.default.getString("MoneySymbol") + l.Tools.TNumber.numFixed(o.win_fee, 2);
this.WinNode.scale = 0;
this.WinNode.active = !0;
cc.tween(this.WinNode).to(.2, {
scale: 1
}).start();
this.scheduleOnce(function() {
t && t.node.isValid && (t.WinNode.active = !1);
}, 3);
}
};
i([ f(cc.Node) ], t.prototype, "WinNode", void 0);
i([ f(cc.Label) ], t.prototype, "WinLabel", void 0);
return i([ h ], t);
}(cc.Component);
o.default = _;
cc._RF.pop();
}, {
"../../../Game/client/model/LanguageModel": "LanguageModel",
"../../../Game/fromework/global/Tools": "Tools",
"../../../Game/fromework/helper/EventHelper": "EventHelper",
"../../../Game/fromework/mvvm/modelView/ViewModel": "ViewModel",
"../Common/BlastEvent": "BlastEvent",
"../Common/BlastModel": "BlastModel"
} ],
BonusLayer: [ function(e, t, o) {
"use strict";
cc._RF.push(t, "e7d9aG2cjRKoaXyjbauAlWg", "BonusLayer");
var n, a = this && this.__extends || (n = function(e, t) {
return (n = Object.setPrototypeOf || {
__proto__: []
} instanceof Array && function(e, t) {
e.__proto__ = t;
} || function(e, t) {
for (var o in t) Object.prototype.hasOwnProperty.call(t, o) && (e[o] = t[o]);
})(e, t);
}, function(e, t) {
n(e, t);
function o() {
this.constructor = e;
}
e.prototype = null === t ? Object.create(t) : (o.prototype = t.prototype, new o());
}), i = this && this.__decorate || function(e, t, o, n) {
var a, i = arguments.length, r = i < 3 ? t : null === n ? n = Object.getOwnPropertyDescriptor(t, o) : n;
if ("object" == typeof Reflect && "function" == typeof Reflect.decorate) r = Reflect.decorate(e, t, o, n); else for (var l = e.length - 1; l >= 0; l--) (a = e[l]) && (r = (i < 3 ? a(r) : i > 3 ? a(t, o, r) : a(t, o)) || r);
return i > 3 && r && Object.defineProperty(t, o, r), r;
};
Object.defineProperty(o, "__esModule", {
value: !0
});
var r = e("../../../../Game/client/global/enum/game/Const"), l = e("../../../../Game/client/global/enum/game/Event"), s = e("../../../../Game/fromework/helper/EventHelper"), c = e("../../../../Game/fromework/helper/UIHelper"), u = e("../../../component/pop/tipsHand"), d = e("../../../global/Global"), p = e("../../../global/PopHelper"), h = e("../../../model/WalletModel"), f = e("../../active/ActiveModel"), _ = cc._decorator, m = _.ccclass, y = _.property, g = function(e) {
a(t, e);
function t() {
var t = null !== e && e.apply(this, arguments) || this;
t.reward = null;
t.active = null;
t.helpNode = null;
t.redNode = null;
t.bonusRate = null;
t.bonusInfo = null;
t.bonusList = null;
t.bonusItem = null;
t.bonusProgree = null;
t.bonusNow = null;
t.bonusLv = null;
t.data = null;
t.dataBonus = null;
return t;
}
t.prototype.start = function() {
var e = this;
this.reward.string = "Cash:" + String(h.WalletProxy.Instance.unclaimedBonus);
this.redNode.active = !1;
this.bonusRate.string = String(h.WalletProxy.Instance.BonusReturnRate) + "%";
if (f.ActiveProxy.Instance.alreadyBuy) this.node.getChildByName("UINode").getChildByName("img_active").active = !1; else {
this.node.getChildByName("UINode").getChildByName("img_active").active = !0;
f.ActiveProxy.Instance.getRechargeBonus(2, function(t) {
e.data = t;
e.node.getChildByName("UINode").getChildByName("img_active").getChildByName("tipsHand").active = !0;
e.node.getChildByName("UINode").getChildByName("img_active").getChildByName("tipsHand").getComponent(u.default).show(Number(e.data.activeInfo.pay_qf) / 1e3);
});
}
h.WalletProxy.Instance.getBonusData(function(t) {
e.dataBonus = t;
e.initBonus();
});
};
t.prototype.onLoad = function() {
s.default.Instance.Global.bind(l.WalletEvent.BONUS_GET_UNREWARD, this.refreshBonus, this);
};
t.prototype.onDisable = function() {
s.default.Instance.Global.unbind(l.WalletEvent.BONUS_GET_UNREWARD, this.refreshBonus, this);
};
t.prototype.initBonus = function() {
this.bonusLv.string = "LV" + this.dataBonus.level + " BONUS";
this.bonusNow.string = "+" + r.MoneySymbol + this.dataBonus.amount_condit;
this.bonusProgree.progress = this.dataBonus.amount / this.dataBonus.amount_condit;
this.dataBonus.amount >= this.dataBonus.amount_condit && (this.redNode.active = !0);
if (this.dataBonus.level_config) {
this.bonusInfo.getChildByName("lvLayout").destroyAllChildren();
for (var e in this.dataBonus.level_config) if (Object.prototype.hasOwnProperty.call(this.dataBonus.level_config, e)) {
var t = this.dataBonus.level_config[e], o = cc.instantiate(this.bonusInfo.getChildByName("lvItem"));
o.active = !0;
this.bonusInfo.getChildByName("lvLayout").addChild(o);
o.getChildByName("lvLabel").getComponent(cc.Label).string = "Lv" + e;
o.getChildByName("numLabel").getComponent(cc.Label).string = "+" + r.MoneySymbol + t;
}
}
};
t.prototype.helpClick = function() {
this.helpNode.active = !0;
};
t.prototype.closeClick = function() {
c.default.Instance.removeMaskLayer(this.node, !0);
};
t.prototype.helpClose = function() {
this.helpNode.active = !1;
};
t.prototype.activeClick = function() {
null != this.data && this.data && f.ActiveProxy.Instance.sendRechargeBonus(this.data.activeInfo.active_type, 2, function() {});
};
t.prototype.getBtnClick = function() {
var e = this;
this.dataBonus && this.dataBonus.amount >= this.dataBonus.amount_condit ? h.WalletProxy.Instance.sendRewardBonus(function(t) {
if (e.node.isValid) {
p.PopHelper.Instance.showReward(d.Global.Instance.changeReward({
1: t
}), null);
h.WalletProxy.Instance.sendGetBonusUnaccalimed();
h.WalletProxy.Instance.getBonusData(function(t) {
if (e.node.isValid) {
e.dataBonus = t;
e.initBonus();
}
});
}
}) : this.bonusInfo.active = !this.bonusInfo.active;
};
t.prototype.refreshBonus = function() {
var e = this;
this.redNode.active = !1;
this.dataBonus && this.dataBonus.amount >= this.dataBonus.amount_condit && (this.redNode.active = !0);
this.reward.string = "Cash:" + String(h.WalletProxy.Instance.unclaimedBonus);
this.bonusRate.string = String(h.WalletProxy.Instance.BonusReturnRate) + "%";
f.ActiveProxy.Instance.getRechargeBonus(2, function(t) {
e.data = t;
});
};
i([ y(cc.Label) ], t.prototype, "reward", void 0);
i([ y(cc.Node) ], t.prototype, "active", void 0);
i([ y(cc.Node) ], t.prototype, "helpNode", void 0);
i([ y(cc.Node) ], t.prototype, "redNode", void 0);
i([ y(cc.Label) ], t.prototype, "bonusRate", void 0);
i([ y(cc.Node) ], t.prototype, "bonusInfo", void 0);
i([ y(cc.Node) ], t.prototype, "bonusList", void 0);
i([ y(cc.Node) ], t.prototype, "bonusItem", void 0);
i([ y(cc.ProgressBar) ], t.prototype, "bonusProgree", void 0);
i([ y(cc.Label) ], t.prototype, "bonusNow", void 0);
i([ y(cc.Label) ], t.prototype, "bonusLv", void 0);
return i([ m ], t);
}(cc.Component);
o.default = g;
cc._RF.pop();
}, {
"../../../../Game/client/global/enum/game/Const": "Const",
"../../../../Game/client/global/enum/game/Event": "Event",
"../../../../Game/fromework/helper/EventHelper": "EventHelper",
"../../../../Game/fromework/helper/UIHelper": "UIHelper",
"../../../component/pop/tipsHand": "tipsHand",
"../../../global/Global": "Global",
"../../../global/PopHelper": "PopHelper",
"../../../model/WalletModel": "WalletModel",
"../../active/ActiveModel": "ActiveModel"
} ],
BonusRecordItem: [ function(e, t, o) {
"use strict";
cc._RF.push(t, "e68bcw4ZdpNjZ8uzaULxIq7", "BonusRecordItem");
var n, a = this && this.__extends || (n = function(e, t) {
return (n = Object.setPrototypeOf || {
__proto__: []
} instanceof Array && function(e, t) {
e.__proto__ = t;
} || function(e, t) {
for (var o in t) Object.prototype.hasOwnProperty.call(t, o) && (e[o] = t[o]);
})(e, t);
}, function(e, t) {
n(e, t);
function o() {
this.constructor = e;
}
e.prototype = null === t ? Object.create(t) : (o.prototype = t.prototype, new o());
}), i = this && this.__decorate || function(e, t, o, n) {
var a, i = arguments.length, r = i < 3 ? t : null === n ? n = Object.getOwnPropertyDescriptor(t, o) : n;
if ("object" == typeof Reflect && "function" == typeof Reflect.decorate) r = Reflect.decorate(e, t, o, n); else for (var l = e.length - 1; l >= 0; l--) (a = e[l]) && (r = (i < 3 ? a(r) : i > 3 ? a(t, o, r) : a(t, o)) || r);
return i > 3 && r && Object.defineProperty(t, o, r), r;
};
Object.defineProperty(o, "__esModule", {
value: !0
});
var r = e("../../../Game/client/model/LanguageModel"), l = e("../../../Game/fromework/global/Tools"), s = cc._decorator, c = s.ccclass, u = s.property, d = function(e) {
a(t, e);
function t() {
var t = null !== e && e.apply(this, arguments) || this;
t.Title = null;
t.ExpiryDate = null;
t.PendingAcount = null;
t.CreditedAmount = null;
t.IssuedAmount = null;
t.IssuedDate = null;
t._data = null;
return t;
}
t.prototype.onItemInitCallFunc = function(e) {
this._data = e;
this.Title.string = this._data.title;
this.ExpiryDate.string = l.Tools.TStr.replaceAll(r.default.getString("BONUS_RECORD_EXPIRY"), "%{date}", l.Tools.TDate.format(1e3 * this._data.end_time, "MM-dd-yyyy hh:mm"));
this.PendingAcount.string = l.Tools.TStr.replaceAll(r.default.getString("BONUS_RECORD_PENDING"), "%{num}", this._data.bonus_left_amount_qf);
this.CreditedAmount.string = l.Tools.TStr.replaceAll(r.default.getString("BONUS_RECORD_CREDITED"), "%{num}", this._data.bonus_pay_amount_qf);
this.IssuedAmount.string = l.Tools.TStr.replaceAll(r.default.getString("BONUS_RECORD_ISSUED"), "%{num}", this._data.bonus_all_amount_qf);
this.IssuedDate.string = l.Tools.TStr.replaceAll(r.default.getString("BONUS_RECORD_ISSUED_DATE"), "%{date}", l.Tools.TDate.format(1e3 * this._data.start_time, "MM-dd-yyyy hh:mm"));
};
t.prototype.onItemEnterCallFunc = function() {
this.node.opacity = 255;
};
t.prototype.onItemExitCallFunc = function() {
this.node.opacity = 0;
};
i([ u(cc.Label) ], t.prototype, "Title", void 0);
i([ u(cc.Label) ], t.prototype, "ExpiryDate", void 0);
i([ u(cc.Label) ], t.prototype, "PendingAcount", void 0);
i([ u(cc.Label) ], t.prototype, "CreditedAmount", void 0);
i([ u(cc.Label) ], t.prototype, "IssuedAmount", void 0);
i([ u(cc.Label) ], t.prototype, "IssuedDate", void 0);
return i([ c ], t);
}(cc.Component);
o.default = d;
cc._RF.pop();
}, {
"../../../Game/client/model/LanguageModel": "LanguageModel",
"../../../Game/fromework/global/Tools": "Tools"
} ],
BonusRecord: [ function(e, t, o) {
"use strict";
cc._RF.push(t, "1db04CTwdZFGomBfJ/w6gZ2", "BonusRecord");
var n, a = this && this.__extends || (n = function(e, t) {
return (n = Object.setPrototypeOf || {
__proto__: []
} instanceof Array && function(e, t) {
e.__proto__ = t;
} || function(e, t) {
for (var o in t) Object.prototype.hasOwnProperty.call(t, o) && (e[o] = t[o]);
})(e, t);
}, function(e, t) {
n(e, t);
function o() {
this.constructor = e;
}
e.prototype = null === t ? Object.create(t) : (o.prototype = t.prototype, new o());
}), i = this && this.__decorate || function(e, t, o, n) {
var a, i = arguments.length, r = i < 3 ? t : null === n ? n = Object.getOwnPropertyDescriptor(t, o) : n;
if ("object" == typeof Reflect && "function" == typeof Reflect.decorate) r = Reflect.decorate(e, t, o, n); else for (var l = e.length - 1; l >= 0; l--) (a = e[l]) && (r = (i < 3 ? a(r) : i > 3 ? a(t, o, r) : a(t, o)) || r);
return i > 3 && r && Object.defineProperty(t, o, r), r;
};
Object.defineProperty(o, "__esModule", {
value: !0
});
var r = e("../../../fromework/component/listView/ListView"), l = e("../../../Game/fromework/helper/EventHelper"), s = e("../../../Game/fromework/helper/UIHelper"), c = e("../../../Game/client/global/enum/game/Event"), u = e("../../model/WalletModel"), d = e("./WalletHelper"), p = cc._decorator, h = p.ccclass, f = p.property, _ = function(e) {
a(t, e);
function t() {
var t = null !== e && e.apply(this, arguments) || this;
t.ListView = null;
t.EmptyNode = null;
return t;
}
t.prototype.onEnable = function() {
l.default.Instance.Global.bind(c.WalletEvent.REFRESH_BONUS_RECORD, this.refreshView, this);
};
t.prototype.onDisable = function() {
l.default.Instance.Global.unbind(c.WalletEvent.REFRESH_BONUS_RECORD, this.refreshView, this);
};
t.prototype.onLoad = function() {
this.ListView.node.active = !1;
this.EmptyNode.active = !1;
};
t.prototype.InitView = function() {
u.WalletProxy.Instance.sendGetBonusRecord();
};
t.prototype.refreshView = function() {
var e = this;
this.ListView.node.active = 0 != this.ListView.datas.length;
this.EmptyNode.active = 0 == this.ListView.datas.length;
this.scheduleOnce(function() {
e && e.node && e.node.isValid && (e.ListView.datas = u.WalletProxy.Instance.bonusRecordList.concat());
});
};
t.prototype.onAddCashClicked = function() {
d.default.Instance.openRecharge();
};
t.prototype.onCloseClicked = function() {
s.default.Instance.removeLayer(this.node);
};
i([ f(r.default) ], t.prototype, "ListView", void 0);
i([ f(cc.Node) ], t.prototype, "EmptyNode", void 0);
return i([ h ], t);
}(cc.Component);
o.default = _;
cc._RF.pop();
}, {
"../../../Game/client/global/enum/game/Event": "Event",
"../../../Game/fromework/helper/EventHelper": "EventHelper",
"../../../Game/fromework/helper/UIHelper": "UIHelper",
"../../../fromework/component/listView/ListView": "ListView",
"../../model/WalletModel": "WalletModel",
"./WalletHelper": "WalletHelper"
} ],
BrokeActive: [ function(e, t, o) {
"use strict";
cc._RF.push(t, "bd85djphEFK55BEEIWksI54", "BrokeActive");
var n, a = this && this.__extends || (n = function(e, t) {
return (n = Object.setPrototypeOf || {
__proto__: []
} instanceof Array && function(e, t) {
e.__proto__ = t;
} || function(e, t) {
for (var o in t) Object.prototype.hasOwnProperty.call(t, o) && (e[o] = t[o]);
})(e, t);
}, function(e, t) {
n(e, t);
function o() {
this.constructor = e;
}
e.prototype = null === t ? Object.create(t) : (o.prototype = t.prototype, new o());
}), i = this && this.__decorate || function(e, t, o, n) {
var a, i = arguments.length, r = i < 3 ? t : null === n ? n = Object.getOwnPropertyDescriptor(t, o) : n;
if ("object" == typeof Reflect && "function" == typeof Reflect.decorate) r = Reflect.decorate(e, t, o, n); else for (var l = e.length - 1; l >= 0; l--) (a = e[l]) && (r = (i < 3 ? a(r) : i > 3 ? a(t, o, r) : a(t, o)) || r);
return i > 3 && r && Object.defineProperty(t, o, r), r;
};
Object.defineProperty(o, "__esModule", {
value: !0
});
var r = e("../../../../Game/client/model/LanguageModel"), l = e("../../../../Game/fromework/global/Tools"), s = e("../../Wallet/WalletHelper"), c = e("../ActiveModel"), u = cc._decorator, d = u.ccclass, p = u.property, h = function(e) {
a(t, e);
function t() {
var t = null !== e && e.apply(this, arguments) || this;
t.AlertPanel = null;
t.Deposit = null;
t.Bonus = null;
t.PayMoney = null;
t.Time = null;
return t;
}
t.prototype.onDestroy = function() {
this.unscheduleAllCallbacks();
};
t.prototype.show = function() {
this.refreshView();
this.openAction();
};
t.prototype.close = function() {
this.unscheduleAllCallbacks();
this.closeAction(function() {});
};
t.prototype.refreshView = function() {
var e = this, t = c.ActiveModel.Instance;
this.Deposit.string = r.default.getString("MoneySymbol") + t.brokeActiveData.bankruptcyInfo.deposit_amount_qf.toString();
this.Bonus.string = r.default.getString("MoneySymbol") + t.brokeActiveData.bankruptcyInfo.bouns_amount_qf.toString();
this.PayMoney.string = r.default.getString("MoneySymbol") + t.brokeActiveData.bankruptcyInfo.pay_amount_qf;
var o = t.brokeActiveData.bankruptcyInfo.expire_time;
this.unscheduleAllCallbacks();
this.schedule(function() {
o--;
t = l.Tools.TDate.second2Hour(o), e.Time.string = "(" + t.hour + ":" + t.minu + ":" + t.sec + ")";
var t;
if (o <= 0) {
c.ActiveProxy.Instance.sendGetBrokeActive();
e.close();
}
}, 1);
};
t.prototype.openAction = function() {
this.AlertPanel.setPosition(cc.v2(0, this.node.height / 2 + this.AlertPanel.height / 2));
this.AlertPanel.runAction(cc.moveTo(.1, cc.v2(0, 0)));
};
t.prototype.closeAction = function(e) {
var t = this, o = cc.moveTo(.1, cc.v2(0, -(this.node.height / 2 + this.AlertPanel.height / 2))), n = cc.callFunc(function() {
e && e.apply(t);
t.node.removeFromParent(!0);
t.node.destroy();
}), a = cc.sequence(o, n);
this.AlertPanel.runAction(a);
};
t.prototype.onPayButtonClicked = function() {
var e = c.ActiveModel.Instance.brokeActiveData.bankruptcyInfo.pay_amount_qf;
if (0 != e) {
s.default.Instance.openRechargeView(function() {}, e, 0, 0, 1);
this.close();
}
};
t.prototype.onBackClicked = function() {
this.close();
};
i([ p(cc.Node) ], t.prototype, "AlertPanel", void 0);
i([ p(cc.Label) ], t.prototype, "Deposit", void 0);
i([ p(cc.Label) ], t.prototype, "Bonus", void 0);
i([ p(cc.Label) ], t.prototype, "PayMoney", void 0);
i([ p(cc.Label) ], t.prototype, "Time", void 0);
return i([ d ], t);
}(cc.Component);
o.default = h;
cc._RF.pop();
}, {
"../../../../Game/client/model/LanguageModel": "LanguageModel",
"../../../../Game/fromework/global/Tools": "Tools",
"../../Wallet/WalletHelper": "WalletHelper",
"../ActiveModel": "ActiveModel"
} ],
BrokeChargeCmp: [ function(e, t, o) {
"use strict";
cc._RF.push(t, "40d74fKiPxGS6h1YErJCE1B", "BrokeChargeCmp");
var n, a = this && this.__extends || (n = function(e, t) {
return (n = Object.setPrototypeOf || {
__proto__: []
} instanceof Array && function(e, t) {
e.__proto__ = t;
} || function(e, t) {
for (var o in t) Object.prototype.hasOwnProperty.call(t, o) && (e[o] = t[o]);
})(e, t);
}, function(e, t) {
n(e, t);
function o() {
this.constructor = e;
}
e.prototype = null === t ? Object.create(t) : (o.prototype = t.prototype, new o());
}), i = this && this.__decorate || function(e, t, o, n) {
var a, i = arguments.length, r = i < 3 ? t : null === n ? n = Object.getOwnPropertyDescriptor(t, o) : n;
if ("object" == typeof Reflect && "function" == typeof Reflect.decorate) r = Reflect.decorate(e, t, o, n); else for (var l = e.length - 1; l >= 0; l--) (a = e[l]) && (r = (i < 3 ? a(r) : i > 3 ? a(t, o, r) : a(t, o)) || r);
return i > 3 && r && Object.defineProperty(t, o, r), r;
};
Object.defineProperty(o, "__esModule", {
value: !0
});
var r = e("../../../../Game/Script/global/GlobalValue"), l = e("../../../../Game/fromework/global/Tools"), s = e("../../../../Game/fromework/helper/EventHelper"), c = e("../../../model/UserModel"), u = e("../../Wallet/WalletHelper"), d = e("../ActiveEvent"), p = e("../ActiveManager"), h = e("../ActiveModel"), f = cc._decorator, _ = f.ccclass, m = f.property, y = function(e) {
a(t, e);
function t() {
var t = null !== e && e.apply(this, arguments) || this;
t.ChargeButton = null;
t.BrokeButton = null;
t.BrokeTime = null;
return t;
}
t.prototype.onLoad = function() {
this.refreshButton();
s.default.Instance.Global.bind(d.BrokeEvent.BROKE_GET_BROKE_DATA, this.refreshButton, this);
};
t.prototype.onDestroy = function() {
this.unscheduleAllCallbacks();
s.default.Instance.Global.unbind(d.BrokeEvent.BROKE_GET_BROKE_DATA, this.refreshButton, this);
};
t.prototype.startTime = function(e) {
var t = this, o = function() {
var o = l.Tools.TDate.second2Hour(e);
t.BrokeTime.string = o.hour + ":" + o.minu + ":" + o.sec;
};
this.unscheduleAllCallbacks();
o();
this.schedule(function() {
e--;
o();
e <= 0 && h.ActiveProxy.Instance.sendGetBrokeActive();
}, 1);
};
t.prototype.refreshButton = function() {
var e = h.ActiveModel.Instance;
if (r.default.getInstance().isCashGame) if (null != e.brokeActiveData && null != e.brokeActiveData.bankruptcyInfo && e.brokeActiveData.bankruptcyInfo.expire_time > 0) {
this.ChargeButton.active = !1;
this.BrokeButton.active = !0;
this.startTime(e.brokeActiveData.bankruptcyInfo.expire_time);
} else {
this.ChargeButton.active = !0;
this.BrokeButton.active = !1;
this.unscheduleAllCallbacks();
} else {
this.ChargeButton.active = c.default.checkOrganicSwitch(c.OrganicSwitch.ORGANIC_FUNC_SWITCH_RECHARGE);
this.BrokeButton.active = !1;
this.unscheduleAllCallbacks();
}
};
t.prototype.onRechargeClicked = function() {
u.default.Instance.openRecharge();
};
t.prototype.onBrokeClicked = function() {
p.default.Instance.openBrokeAlertAndRefreshData();
};
i([ m(cc.Node) ], t.prototype, "ChargeButton", void 0);
i([ m(cc.Node) ], t.prototype, "BrokeButton", void 0);
i([ m(cc.Label) ], t.prototype, "BrokeTime", void 0);
return i([ _ ], t);
}(cc.Component);
o.default = y;
cc._RF.pop();
}, {
"../../../../Game/Script/global/GlobalValue": "GlobalValue",
"../../../../Game/fromework/global/Tools": "Tools",
"../../../../Game/fromework/helper/EventHelper": "EventHelper",
"../../../model/UserModel": "UserModel",
"../../Wallet/WalletHelper": "WalletHelper",
"../ActiveEvent": "ActiveEvent",
"../ActiveManager": "ActiveManager",
"../ActiveModel": "ActiveModel"
} ],
BrokeMonthCard: [ function(e, t, o) {
"use strict";
cc._RF.push(t, "f656fF7CLdCTLM1b8mhFyoB", "BrokeMonthCard");
var n, a = this && this.__extends || (n = function(e, t) {
return (n = Object.setPrototypeOf || {
__proto__: []
} instanceof Array && function(e, t) {
e.__proto__ = t;
} || function(e, t) {
for (var o in t) Object.prototype.hasOwnProperty.call(t, o) && (e[o] = t[o]);
})(e, t);
}, function(e, t) {
n(e, t);
function o() {
this.constructor = e;
}
e.prototype = null === t ? Object.create(t) : (o.prototype = t.prototype, new o());
}), i = this && this.__decorate || function(e, t, o, n) {
var a, i = arguments.length, r = i < 3 ? t : null === n ? n = Object.getOwnPropertyDescriptor(t, o) : n;
if ("object" == typeof Reflect && "function" == typeof Reflect.decorate) r = Reflect.decorate(e, t, o, n); else for (var l = e.length - 1; l >= 0; l--) (a = e[l]) && (r = (i < 3 ? a(r) : i > 3 ? a(t, o, r) : a(t, o)) || r);
return i > 3 && r && Object.defineProperty(t, o, r), r;
};
Object.defineProperty(o, "__esModule", {
value: !0
});
var r = e("../../../../Game/client/model/LanguageModel"), l = e("../../../../Game/fromework/global/Tools"), s = e("../../Wallet/WalletHelper"), c = e("../ActiveModel"), u = cc._decorator, d = u.ccclass, p = u.property, h = function(e) {
a(t, e);
function t() {
var t = null !== e && e.apply(this, arguments) || this;
t.AlertPanel = null;
t.Deposit = null;
t.Bonus = null;
t.PayMoney = null;
t.Time = null;
return t;
}
t.prototype.show = function() {
this.refreshView();
this.openAction();
};
t.prototype.close = function() {
this.unscheduleAllCallbacks();
this.closeAction(function() {});
};
t.prototype.refreshView = function() {
var e = this, t = c.ActiveModel.Instance;
this.Deposit.string = r.default.getString("MoneySymbol") + (t.brokeActiveData.bankruptcyInfo.deposit_amount_qf + t.brokeActiveData.monthlyCardInfo.deposit).toString();
this.Bonus.string = r.default.getString("MoneySymbol") + t.brokeActiveData.bankruptcyInfo.bouns_amount_qf.toString();
this.PayMoney.string = r.default.getString("MoneySymbol") + t.brokeActiveData.bankruptcyInfo.pay_amount_qf;
var o = t.brokeActiveData.bankruptcyInfo.expire_time;
this.unscheduleAllCallbacks();
this.schedule(function() {
o--;
t = l.Tools.TDate.second2Hour(o), e.Time.string = "(" + t.hour + ":" + t.minu + ":" + t.sec + ")";
var t;
if (o <= 0) {
c.ActiveProxy.Instance.sendGetBrokeActive();
e.close();
}
}, 1);
};
t.prototype.openAction = function() {
this.AlertPanel.setPosition(cc.v2(0, this.node.height / 2 + this.AlertPanel.height / 2));
this.AlertPanel.runAction(cc.moveTo(.1, cc.v2(0, 0)));
};
t.prototype.closeAction = function(e) {
var t = this, o = cc.moveTo(.1, cc.v2(0, -(this.node.height / 2 + this.AlertPanel.height / 2))), n = cc.callFunc(function() {
e && e.apply(t);
t.node.removeFromParent(!0);
t.node.destroy();
}), a = cc.sequence(o, n);
this.AlertPanel.runAction(a);
};
t.prototype.onPayButtonClicked = function() {
var e = c.ActiveModel.Instance.brokeActiveData.bankruptcyInfo.pay_amount_qf;
if (0 != e) {
s.default.Instance.openRechargeView(function() {}, e, 0, 0, 1);
this.close();
}
};
t.prototype.onBackClicked = function() {
this.close();
};
i([ p(cc.Node) ], t.prototype, "AlertPanel", void 0);
i([ p(cc.Label) ], t.prototype, "Deposit", void 0);
i([ p(cc.Label) ], t.prototype, "Bonus", void 0);
i([ p(cc.Label) ], t.prototype, "PayMoney", void 0);
i([ p(cc.Label) ], t.prototype, "Time", void 0);
return i([ d ], t);
}(cc.Component);
o.default = h;
cc._RF.pop();
}, {
"../../../../Game/client/model/LanguageModel": "LanguageModel",
"../../../../Game/fromework/global/Tools": "Tools",
"../../Wallet/WalletHelper": "WalletHelper",
"../ActiveModel": "ActiveModel"
} ],
BrokeNormal: [ function(e, t, o) {
"use strict";
cc._RF.push(t, "44c9cR24k9FAqYCe+Vf9y0T", "BrokeNormal");
var n, a = this && this.__extends || (n = function(e, t) {
return (n = Object.setPrototypeOf || {
__proto__: []
} instanceof Array && function(e, t) {
e.__proto__ = t;
} || function(e, t) {
for (var o in t) Object.prototype.hasOwnProperty.call(t, o) && (e[o] = t[o]);
})(e, t);
}, function(e, t) {
n(e, t);
function o() {
this.constructor = e;
}
e.prototype = null === t ? Object.create(t) : (o.prototype = t.prototype, new o());
}), i = this && this.__decorate || function(e, t, o, n) {
var a, i = arguments.length, r = i < 3 ? t : null === n ? n = Object.getOwnPropertyDescriptor(t, o) : n;
if ("object" == typeof Reflect && "function" == typeof Reflect.decorate) r = Reflect.decorate(e, t, o, n); else for (var l = e.length - 1; l >= 0; l--) (a = e[l]) && (r = (i < 3 ? a(r) : i > 3 ? a(t, o, r) : a(t, o)) || r);
return i > 3 && r && Object.defineProperty(t, o, r), r;
};
Object.defineProperty(o, "__esModule", {
value: !0
});
var r = e("../../../../Game/client/model/LanguageModel"), l = e("../../Wallet/WalletHelper"), s = e("../ActiveModel"), c = cc._decorator, u = c.ccclass, d = c.property, p = function(e) {
a(t, e);
function t() {
var t = null !== e && e.apply(this, arguments) || this;
t.AlertPanel = null;
t.Deposit = null;
t.PayMoney = null;
return t;
}
t.prototype.show = function() {
this.refreshView();
this.openAction();
};
t.prototype.close = function() {
this.closeAction(function() {});
};
t.prototype.refreshView = function() {
var e = s.ActiveModel.Instance;
this.Deposit.string = r.default.getString("MoneySymbol") + e.brokeActiveData.recommend_gear_amount.toString();
this.PayMoney.string = r.default.getString("MoneySymbol") + e.brokeActiveData.recommend_gear_amount;
};
t.prototype.openAction = function() {
this.AlertPanel.setPosition(cc.v2(0, this.node.height / 2 + this.AlertPanel.height / 2));
this.AlertPanel.runAction(cc.moveTo(.1, cc.v2(0, 0)));
};
t.prototype.closeAction = function(e) {
var t = this, o = cc.moveTo(.1, cc.v2(0, -(this.node.height / 2 + this.AlertPanel.height / 2))), n = cc.callFunc(function() {
e && e.apply(t);
t.node.removeFromParent(!0);
t.node.destroy();
}), a = cc.sequence(o, n);
this.AlertPanel.runAction(a);
};
t.prototype.onPayButtonClicked = function() {
var e = s.ActiveModel.Instance.brokeActiveData.recommend_gear_amount;
if (0 != e) {
l.default.Instance.openRechargeView(function() {}, e, 0, 0, 1);
this.close();
}
};
t.prototype.onBackClicked = function() {
this.close();
};
i([ d(cc.Node) ], t.prototype, "AlertPanel", void 0);
i([ d(cc.Label) ], t.prototype, "Deposit", void 0);
i([ d(cc.Label) ], t.prototype, "PayMoney", void 0);
return i([ u ], t);
}(cc.Component);
o.default = p;
cc._RF.pop();
}, {
"../../../../Game/client/model/LanguageModel": "LanguageModel",
"../../Wallet/WalletHelper": "WalletHelper",
"../ActiveModel": "ActiveModel"
} ],
BtnBuyFit: [ function(e, t, o) {
"use strict";
cc._RF.push(t, "8ff7amDObFA8oUwjtIZpuZl", "BtnBuyFit");
var n, a = this && this.__extends || (n = function(e, t) {
return (n = Object.setPrototypeOf || {
__proto__: []
} instanceof Array && function(e, t) {
e.__proto__ = t;
} || function(e, t) {
for (var o in t) Object.prototype.hasOwnProperty.call(t, o) && (e[o] = t[o]);
})(e, t);
}, function(e, t) {
n(e, t);
function o() {
this.constructor = e;
}
e.prototype = null === t ? Object.create(t) : (o.prototype = t.prototype, new o());
}), i = this && this.__decorate || function(e, t, o, n) {
var a, i = arguments.length, r = i < 3 ? t : null === n ? n = Object.getOwnPropertyDescriptor(t, o) : n;
if ("object" == typeof Reflect && "function" == typeof Reflect.decorate) r = Reflect.decorate(e, t, o, n); else for (var l = e.length - 1; l >= 0; l--) (a = e[l]) && (r = (i < 3 ? a(r) : i > 3 ? a(t, o, r) : a(t, o)) || r);
return i > 3 && r && Object.defineProperty(t, o, r), r;
};
Object.defineProperty(o, "__esModule", {
value: !0
});
var r = cc._decorator, l = r.ccclass, s = (r.property, function(e) {
a(t, e);
function t() {
return null !== e && e.apply(this, arguments) || this;
}
t.prototype.onEnable = function() {
var e = this;
if (this.node.x < 535) {
this.node.getComponent(cc.Widget).isAlignLeft = !1;
this.scheduleOnce(function() {
e.node.x = 535;
});
} else {
this.node.getComponent(cc.Widget).isAlignLeft = !0;
this.node.getComponent(cc.Widget).left = 0;
}
};
t.prototype.onLoad = function() {};
t.prototype.start = function() {};
return i([ l ], t);
}(cc.Component));
o.default = s;
cc._RF.pop();
}, {} ],
BundleManager: [ function(e, t, o) {
"use strict";
cc._RF.push(t, "91444qj7fxDeLQJ1OIrC9lZ", "BundleManager");
Object.defineProperty(o, "__esModule", {
value: !0
});
var n = e("../platform/Platform"), a = function() {
function e() {}
e.getInstance = function() {
null == e.instance && (e.instance = new e());
return e.instance;
};
e.prototype.getBundle = function(e, t) {
try {
var o = cc.assetManager.getBundle(e);
o ? t(o) : cc.assetManager.loadBundle(e, function(o, n) {
if (o) return null;
n = cc.assetManager.getBundle(e);
t(n);
});
} catch (e) {
n.default.error("getBundle error", e);
}
};
e.prototype.getGameBundle = function() {
var t = this;
return new Promise(function(o, a) {
try {
e.bundleGame ? o(e.bundleGame) : t.getBundle(e.bundleName, function(t) {
e.bundleGame = t;
n.default.log("getGameBundle firstLoad");
o(t);
});
} catch (e) {
n.default.error("getGameBundle error", e);
a();
}
});
};
e.prototype.enterBundleScene = function(t, o) {
try {
n.default.warn("BundleManager  enterBundleScene  0 sceneName=" + t);
this.getBundle(e.bundleName, function(e) {
n.default.warn("BundleManager enterBundleScene  1 sceneName=" + t);
e.loadScene(t, function(e, a) {
n.default.warn("BundleManager enterBundleScene  2 sceneName=" + t);
cc.director.runScene(a, null, o);
});
});
} catch (e) {
n.default.error("enterBundleScene error", e);
}
};
e.prototype.preloadBundleScene = function(t, o, n) {
e.bundleGame && e.bundleGame.preloadScene(t, o, n);
};
e.instance = null;
e.bundleGame = null;
e.bundleName = "BundleGame";
return e;
}();
o.default = a;
cc._RF.pop();
}, {
"../platform/Platform": "Platform"
} ],
ButtonBlock: [ function(e, t, o) {
"use strict";
cc._RF.push(t, "e0cfbt1i+FCoq9/FroMSiE6", "ButtonBlock");
var n, a = this && this.__extends || (n = function(e, t) {
return (n = Object.setPrototypeOf || {
__proto__: []
} instanceof Array && function(e, t) {
e.__proto__ = t;
} || function(e, t) {
for (var o in t) Object.prototype.hasOwnProperty.call(t, o) && (e[o] = t[o]);
})(e, t);
}, function(e, t) {
n(e, t);
function o() {
this.constructor = e;
}
e.prototype = null === t ? Object.create(t) : (o.prototype = t.prototype, new o());
}), i = this && this.__decorate || function(e, t, o, n) {
var a, i = arguments.length, r = i < 3 ? t : null === n ? n = Object.getOwnPropertyDescriptor(t, o) : n;
if ("object" == typeof Reflect && "function" == typeof Reflect.decorate) r = Reflect.decorate(e, t, o, n); else for (var l = e.length - 1; l >= 0; l--) (a = e[l]) && (r = (i < 3 ? a(r) : i > 3 ? a(t, o, r) : a(t, o)) || r);
return i > 3 && r && Object.defineProperty(t, o, r), r;
};
Object.defineProperty(o, "__esModule", {
value: !0
});
var r = cc._decorator, l = r.ccclass, s = r.property, c = r.menu, u = r.requireComponent, d = function(e) {
a(t, e);
function t() {
var t = null !== e && e.apply(this, arguments) || this;
t.BlockTime = .5;
t._timeId = -1;
t._button = null;
return t;
}
t.prototype.onLoad = function() {
this._button = this.node.getComponent(cc.Button);
};
t.prototype.onEnable = function() {
this.node.on("click", this.onButtonClick, this);
};
t.prototype.onDisable = function() {
this.node.off("click", this.onButtonClick, this);
};
t.prototype.onDestroy = function() {
if (-1 != this._timeId) {
clearTimeout(this._timeId);
this._timeId = -1;
}
};
t.prototype.onButtonClick = function() {
var e = this;
this._button.interactable = !1;
this._timeId = setTimeout(function() {
e.node && e.node.isValid && (e._button.interactable = !0);
}, 1e3 * this.BlockTime);
};
i([ s(cc.Float) ], t.prototype, "BlockTime", void 0);
return i([ l, c("component/按钮连点屏蔽"), u(cc.Button) ], t);
}(cc.Component);
o.default = d;
cc._RF.pop();
}, {} ],
C2S: [ function(e, t, o) {
"use strict";
cc._RF.push(t, "c9dbb8O9DFO37qgX0wkpOPH", "C2S");
Object.defineProperty(o, "__esModule", {
value: !0
});
o.C2S = void 0;
o.C2S = {
SERVER_GAME_SERVICE: [ "Server", "game_service" ],
SERVER_CONFIG: [ "Server", "channel_service" ],
SERVER_HOT_UPDATE: [ "Server", "hot_update" ],
SERVER_SYSTEM_TIPS_WITHDRAW: [ "Server", "system_tips_withdraw" ],
SERVER_DOT: [ "Server", "dot" ],
USER_REGISTER: [ "User", "reg" ],
USER_LOGIN_CODE: [ "User", "login_code" ],
USER_LOGIN_PHONE: [ "User", "phone_login" ],
USER_LOGIN_PHONE_TOKEN: [ "User", "phone_token_login" ],
USER_LOGIN_GUEST: [ "User", "guest_login" ],
USER_LOGIN_OTHER: [ "User", "open_platform_login" ],
USER_BIND_INVITE: [ "User", "bind_invite" ],
USER_GET_SHARE_URL: [ "User", "get_share_url" ],
USER_PREPARE_TO_SHARE: [ "User", "prepare_to_share" ],
USER_GET_VERIFICATION_CODE: [ "User", "get_verification_code" ],
USER_CHECK_VERIFICATION_CODE: [ "User", "check_verification_code" ],
USER_UPDATE_REWARD: [ "User", "update_reward" ],
USER_BIND_OPENPLATFORM: [ "User", "bind_open_platform" ],
USER_GET_VIP_INFO: [ "User", "get_vip_info" ],
USER_MODIFY_DEFAULT_HEAD: [ "User", "modify_default_head" ],
HB: [ "Hb", "hb" ],
LOBBY_JOIN: [ "Lobby", "join" ],
LOBBY_GET_ROOMS: [ "Lobby", "get_rooms" ],
LOBBY_GET_GAMES: [ "Lobby", "get_game_list" ],
LOBBY_HOME: [ "Lobby", "home" ],
LOBBY_GET_SYSTEM_NOTICE: [ "Lobby", "get_system_notice" ],
ROOM_ENTER_ROOM: [ "Room", "enter_room" ],
ROOM_SWITCH_ROOM: [ "Room", "switch_room" ],
ROOM_ORDER_CONFIRM: [ "Room", "order_confirm" ],
ROOM_CARD_CONFIRM: [ "Room", "card_confirm" ],
ROOM_DRAW: [ "Room", "draw" ],
ROOM_DISCARD: [ "Room", "discard" ],
ROOM_FINISH: [ "Room", "finish" ],
ROOM_DECLEAR: [ "Room", "declear" ],
ROOM_SYNC_CARD: [ "Room", "sync_card" ],
ROOM_LEAVE: [ "Room", "leave" ],
ROOM_DROP: [ "Room", "drop" ],
ROOM_AUTOSORT_SWITCH: [ "Room", "autosort_switch" ],
ROOM_AUTOSORT: [ "Room", "autosort" ],
ROOM_AUTOPLAY: [ "Room", "autoplay" ],
ROOM_SCORE_WINDOW: [ "Room", "score_window" ],
ROOM_INITIATE_SPLIT: [ "Room", "initiate_split" ],
ROOM_SPLIT: [ "Room", "split" ],
ROOM_REJOIN: [ "Room", "rejoin" ],
ROOM_READY: [ "Room", "ready" ],
ROOM_INTERACT: [ 'Room", "interact' ],
ROOM_SEE_CARD: [ "Room", "see_card" ],
ROOM_WAGER: [ "Room", "wager" ],
ROOM_INITIATE_COMPARE: [ "Room", "initiate_compare" ],
ROOM_CONFIRM_COMPARE: [ "Room", "confirm_compare" ],
ROOM_GET_RECHARGE_AMOUNT: [ "Room", "get_recharge_amount" ],
ROOM_INITIATE_RECHARGE: [ "Room", "initiate_recharge" ],
ROOM_FINISH_RECHARGE: [ "Room", "finish_recharge" ],
ROOM_BET: [ "Room", "bet" ],
ROOM_RANK: [ "Room", "rank" ],
ROOM_REPEAT_BET: [ "Room", "repeat_bet" ],
ROOM_USER_RECORD: [ "Room", "user_record" ],
ROOM_BIGWINNER_RECORD: [ "Room", "bigwinner_record" ],
ROOM_GET_JACKPOT_HISTORY: [ "Room", "get_jackpot_history" ],
ROOM_ESCAPE: [ "Room", "escape" ],
ROOM_BOOM: [ "Room", "boom" ],
ROOM_SPIN: [ "Room", "spin" ],
ROOM_CLEAN: [ "Room", "clean" ],
ROOM_EXCHANGE: [ "Room", "exchange" ],
ROOM_APPLY_DEALER: [ "Room", "apply_dealer" ],
ROOM_CANCEL_DEALER: [ "Room", "cancel_dealer" ],
ROOM_OPEN_DEALER: [ "Room", "open_dealer" ],
ROOM_CLICK_DEALER: [ "Room", "click_dealer" ],
ITEM_GET_USER_ITEM: [ "Item", "get_user_item" ],
EMAIL_LIST: [ "Email", "list" ],
EMAIL_CHANGE_STATUS: [ "Email", "change_status" ],
WALLET_CHECK_PHONE: [ "User", "check_exist" ],
WALLET_BIND_CODE: [ "User", "bind_code" ],
WALLET_BIND_PHONE: [ "User", "bind_phone" ],
WALLET_BIND_EMAIL: [ "User", "bind_email" ],
WALLET_LOG: [ "Wallet", "get_user_wallet_log" ],
WALLET_GET_USER_WALLET: [ "Wallet", "get_user_wallet" ],
TASK_MAIN: [ "Task", "main" ],
TASK_GET_REWARD: [ "Task", "get_reward" ],
ACT_ALL: [ "Act", "all" ],
ACT_MAIN: [ "Act", "main" ],
ACT_EXCHANGE: [ "Act", "exchange" ],
ACT_GET_REWARD: [ "Act", "get_reward" ],
ACT_LOTO: [ "Act", "loto" ],
WALLET_IOS_PAY_AMOUNT_TYPE: [ "ConsoleApi", "iosPayAmountType" ],
WALLET_KYC_RES: [ "ConsoleApi", "kycRes" ],
WALLET_GIFT_CALCULATOR: [ "ConsoleApi", "giftCalculator" ],
WALLET_SET_BANK_ACCOUNT: [ "ConsoleApi", "setBankAccount" ],
WALLET_BANK_ACCOUNT: [ "ConsoleApi", "bankAccount" ],
WALLET_WITHDROW: [ "ConsoleApi", "withd" ],
WALLET_: [ "ConsoleApi", "paytype" ],
WALLET_PAY: [ "ConsoleApi", "pay" ],
WALLET_BONUS_LIST: [ "ConsoleApi", "bonusList" ],
WALLET_BONUS_ALLAMOUNT: [ "ConsoleApi", "bonusAllAmount" ],
WALLET_GET_USER_RECHARGE_INFO: [ "ConsoleApi", "getUserRechargeInfo" ],
WALLET_GOODS_CNT: [ "ConsoleApi", "goodsCnt" ],
WALLET_GET_RECHARGE_USER_INFO: [ "ConsoleApi", "getRechargeUserInfo" ]
};
cc._RF.pop();
}, {} ],
CachePool: [ function(e, t, o) {
"use strict";
cc._RF.push(t, "41464EhHNRMnYbCLMOuiCae", "CachePool");
var n = this && this.__decorate || function(e, t, o, n) {
var a, i = arguments.length, r = i < 3 ? t : null === n ? n = Object.getOwnPropertyDescriptor(t, o) : n;
if ("object" == typeof Reflect && "function" == typeof Reflect.decorate) r = Reflect.decorate(e, t, o, n); else for (var l = e.length - 1; l >= 0; l--) (a = e[l]) && (r = (i < 3 ? a(r) : i > 3 ? a(t, o, r) : a(t, o)) || r);
return i > 3 && r && Object.defineProperty(t, o, r), r;
};
Object.defineProperty(o, "__esModule", {
value: !0
});
o.CacheType = o.instance = o.CachePool = void 0;
var a, i = cc._decorator, r = i.ccclass, l = (i.property, function() {
function e() {}
t = e;
e.getInstance = function() {
t._instance || (t._instance = new t());
return t._instance;
};
e.prototype.pushObj = function(e, o) {
if (o && cc.isValid(o)) {
cc.Tween.stopAllByTarget(o);
e == a.BET_GOLD ? t.nodePool.put(o) : e == a.BET_COIN ? t.nodePoolAB.put(o) : t.nodePoolShell.put(o);
}
};
e.prototype.getObj = function(e, o) {
void 0 === o && (o = null);
var n = null;
(n = e == a.BET_GOLD ? t.nodePool.get() : e == a.BET_COIN ? t.nodePoolAB.get() : t.nodePoolShell.get()) && cc.isValid(n) || (n = cc.instantiate(o));
n.zIndex = 0;
return n;
};
e.prototype.clear = function(e) {
e == a.BET_GOLD ? t.nodePool.clear() : e == a.BET_COIN ? t.nodePoolAB.clear() : t.nodePoolShell.clear();
};
e.prototype.clearAll = function() {
t.nodePool.clear();
t.nodePoolAB.clear();
t.nodePoolShell.clear();
};
var t;
e._instance = null;
e.nodePool = new cc.NodePool();
e.nodePoolAB = new cc.NodePool();
e.nodePoolShell = new cc.NodePool();
return t = n([ r ], e);
}());
o.CachePool = l;
(function(e) {
e.BET_GOLD = "bet_gold";
e.BET_COIN = "bet_coin";
e.BET_SHELL = "bet_shell";
})(a || (a = {}));
o.CacheType = a;
var s = l.getInstance();
o.instance = s;
cc._RF.pop();
}, {} ],
CalenderDay: [ function(e, t, o) {
"use strict";
cc._RF.push(t, "aa4ff5eStdJ75sEkqNfZYFT", "CalenderDay");
var n, a = this && this.__extends || (n = function(e, t) {
return (n = Object.setPrototypeOf || {
__proto__: []
} instanceof Array && function(e, t) {
e.__proto__ = t;
} || function(e, t) {
for (var o in t) Object.prototype.hasOwnProperty.call(t, o) && (e[o] = t[o]);
})(e, t);
}, function(e, t) {
n(e, t);
function o() {
this.constructor = e;
}
e.prototype = null === t ? Object.create(t) : (o.prototype = t.prototype, new o());
}), i = this && this.__decorate || function(e, t, o, n) {
var a, i = arguments.length, r = i < 3 ? t : null === n ? n = Object.getOwnPropertyDescriptor(t, o) : n;
if ("object" == typeof Reflect && "function" == typeof Reflect.decorate) r = Reflect.decorate(e, t, o, n); else for (var l = e.length - 1; l >= 0; l--) (a = e[l]) && (r = (i < 3 ? a(r) : i > 3 ? a(t, o, r) : a(t, o)) || r);
return i > 3 && r && Object.defineProperty(t, o, r), r;
};
Object.defineProperty(o, "__esModule", {
value: !0
});
var r = cc._decorator, l = r.ccclass, s = r.property, c = function(e) {
a(t, e);
function t() {
var t = null !== e && e.apply(this, arguments) || this;
t.Day = null;
t.Select = null;
t._index = -1;
t._day = -1;
t._callFunc = null;
return t;
}
t.prototype.setDay = function(e, t, o, n) {
this._index = e;
this._day = t;
this._callFunc = n;
this.Day.string = String(t);
this.Select.active = o;
};
t.prototype.onItemClicked = function() {
this._callFunc && this._callFunc(this._index, this._day);
};
i([ s(cc.Label) ], t.prototype, "Day", void 0);
i([ s(cc.Node) ], t.prototype, "Select", void 0);
return i([ l ], t);
}(cc.Component);
o.default = c;
cc._RF.pop();
}, {} ],
Calender: [ function(e, t, o) {
"use strict";
cc._RF.push(t, "40f1cCu3ypDnIHXwiGR+mcZ", "Calender");
var n, a = this && this.__extends || (n = function(e, t) {
return (n = Object.setPrototypeOf || {
__proto__: []
} instanceof Array && function(e, t) {
e.__proto__ = t;
} || function(e, t) {
for (var o in t) Object.prototype.hasOwnProperty.call(t, o) && (e[o] = t[o]);
})(e, t);
}, function(e, t) {
n(e, t);
function o() {
this.constructor = e;
}
e.prototype = null === t ? Object.create(t) : (o.prototype = t.prototype, new o());
}), i = this && this.__decorate || function(e, t, o, n) {
var a, i = arguments.length, r = i < 3 ? t : null === n ? n = Object.getOwnPropertyDescriptor(t, o) : n;
if ("object" == typeof Reflect && "function" == typeof Reflect.decorate) r = Reflect.decorate(e, t, o, n); else for (var l = e.length - 1; l >= 0; l--) (a = e[l]) && (r = (i < 3 ? a(r) : i > 3 ? a(t, o, r) : a(t, o)) || r);
return i > 3 && r && Object.defineProperty(t, o, r), r;
};
Object.defineProperty(o, "__esModule", {
value: !0
});
var r = e("../../../../Game/fromework/helper/UIHelper"), l = e("./CalenderDay"), s = cc._decorator, c = s.ccclass, u = s.property, d = [ "Jan", "Feb", "Mar", "Apr", "May", "Jun", "Jul", "Aug", "Sept", "Oct", "Nov", "Dec" ], p = [ "Sun", "Mon", "Tue", "Wed", "Thur", "Fri", "Sat" ], h = function(e) {
a(t, e);
function t() {
var t = null !== e && e.apply(this, arguments) || this;
t.Year = null;
t.WeekMonthDay = null;
t.YearMonth = null;
t.DayParnet = null;
t.Prefab_Day = null;
t._date = null;
t._year = 0;
t._month = 0;
t._day = 0;
t._selectYear = 0;
t._selectMonth = 0;
t._selectDay = 0;
t.pfgListDay = [];
t._callFunc = null;
return t;
}
t.prototype.onLoad = function() {
this.initData();
this.updateDate();
};
t.prototype.setDate = function(e, t, o) {
this._date = new Date(e, t - 1, o);
this._year = e;
this._month = t;
this._day = o;
this.setSelect();
this.updateDate();
};
t.prototype.setPickDateCallback = function(e) {
this._callFunc = e;
};
t.prototype.setSelect = function() {
this._selectYear = this._year;
this._selectMonth = this._month;
this._selectDay = this._day;
};
t.prototype.initData = function() {
this._date = this._date ? this._date : new Date();
this._year = this._date.getFullYear();
this._month = this._date.getMonth();
this._day = this._date.getDate();
this.pfgListDay.splice(0);
for (var e = 0; e < 31; ++e) {
var t = cc.instantiate(this.Prefab_Day);
t.parent = this.DayParnet;
this.pfgListDay.push(t);
}
};
t.prototype.updateDate = function() {
var e = this, t = new Date(this._year, this._month, this._day);
this.YearMonth.string = d[t.getMonth()] + " " + t.getFullYear();
this.Year.string = String(t.getFullYear());
this.WeekMonthDay.string = p[t.getDay()] + "," + d[t.getMonth()] + " " + t.getDate();
for (var o = new Date(this._year, this._month + 1, 0).getDate(), n = new Date(this._year, this._month, 0).getDay(), a = 0; a < this.pfgListDay.length; ++a) {
var i = this.pfgListDay[a];
if (a < o) {
i.active = !0;
var r = n + a, s = Math.floor(r / 7), c = r % 7, u = i.width + 10, h = i.height + 10, f = .5 * -(this.DayParnet.width - u) + c * u, _ = .5 * (this.DayParnet.height - h) - s * h;
i.setPosition(f, _);
var m = i.getComponent(l.default), y = this._selectYear == this._year && this._selectMonth == this._month && this._selectDay == a + 1;
m.setDay(a, a + 1, y, function(t, o) {
e._day = o;
e.setSelect();
e.updateDate();
});
} else i.active = !1;
}
};
t.prototype.onClickLeft = function() {
if (this._month > 0) this._month -= 1; else {
this._month = 11;
this._year -= 1;
}
this._date.setFullYear(this._year);
this._date.setMonth(this._month);
this.updateDate();
};
t.prototype.onClickRight = function() {
if (this._month < 11) this._month += 1; else {
this._month = 0;
this._year += 1;
}
this._date.setFullYear(this._year);
this._date.setMonth(this._month);
this.updateDate();
};
t.prototype.onClickConfirm = function() {
this._callFunc && this._callFunc(this._selectYear, this._selectMonth, this._selectDay);
this.onClickClose();
};
t.prototype.onClickClose = function() {
r.default.Instance.removeMaskLayer(this.node);
};
i([ u(cc.Label) ], t.prototype, "Year", void 0);
i([ u(cc.Label) ], t.prototype, "WeekMonthDay", void 0);
i([ u(cc.Label) ], t.prototype, "YearMonth", void 0);
i([ u(cc.Node) ], t.prototype, "DayParnet", void 0);
i([ u(cc.Prefab) ], t.prototype, "Prefab_Day", void 0);
return i([ c ], t);
}(cc.Component);
o.default = h;
cc._RF.pop();
}, {
"../../../../Game/fromework/helper/UIHelper": "UIHelper",
"./CalenderDay": "CalenderDay"
} ],
CardRecorderItem: [ function(e, t, o) {
"use strict";
cc._RF.push(t, "d5095tn5bZGgLdFSSr/7ze0", "CardRecorderItem");
var n, a = this && this.__extends || (n = function(e, t) {
return (n = Object.setPrototypeOf || {
__proto__: []
} instanceof Array && function(e, t) {
e.__proto__ = t;
} || function(e, t) {
for (var o in t) Object.prototype.hasOwnProperty.call(t, o) && (e[o] = t[o]);
})(e, t);
}, function(e, t) {
n(e, t);
function o() {
this.constructor = e;
}
e.prototype = null === t ? Object.create(t) : (o.prototype = t.prototype, new o());
}), i = this && this.__decorate || function(e, t, o, n) {
var a, i = arguments.length, r = i < 3 ? t : null === n ? n = Object.getOwnPropertyDescriptor(t, o) : n;
if ("object" == typeof Reflect && "function" == typeof Reflect.decorate) r = Reflect.decorate(e, t, o, n); else for (var l = e.length - 1; l >= 0; l--) (a = e[l]) && (r = (i < 3 ? a(r) : i > 3 ? a(t, o, r) : a(t, o)) || r);
return i > 3 && r && Object.defineProperty(t, o, r), r;
};
Object.defineProperty(o, "__esModule", {
value: !0
});
var r = e("../../../../Game/fromework/global/ResLoader"), l = e("../../../component/Card"), s = cc._decorator, c = s.ccclass, u = s.property, d = function(e) {
a(t, e);
function t() {
var t = null !== e && e.apply(this, arguments) || this;
t.PickedNode = null;
t.CardParent = null;
t._data = null;
return t;
}
t.prototype.onItemInitCallFunc = function(e) {
var t = this;
this._data = e;
this.PickedNode.active = e.isDraw;
this.CardParent.destroyAllChildren();
r.default.Instance.loadBundleRes("resources/prefab/component/Card", cc.Prefab, function(o, n) {
if (!o) {
var a = cc.instantiate(n);
a.parent = t.CardParent;
a.setPosition(cc.Vec3.ZERO);
a.getComponent(l.default).init(e.card, !0, e.wildCard);
}
});
};
t.prototype.onItemEnterCallFunc = function() {
this.node.opacity = 255;
};
t.prototype.onItemExitCallFunc = function() {
this.node.opacity = 0;
};
i([ u(cc.Node) ], t.prototype, "PickedNode", void 0);
i([ u(cc.Node) ], t.prototype, "CardParent", void 0);
return i([ c ], t);
}(cc.Component);
o.default = d;
cc._RF.pop();
}, {
"../../../../Game/fromework/global/ResLoader": "ResLoader",
"../../../component/Card": "Card"
} ],
CardRecorder: [ function(e, t, o) {
"use strict";
cc._RF.push(t, "842bfJWlIFODKOL17yUAGy9", "CardRecorder");
var n, a = this && this.__extends || (n = function(e, t) {
return (n = Object.setPrototypeOf || {
__proto__: []
} instanceof Array && function(e, t) {
e.__proto__ = t;
} || function(e, t) {
for (var o in t) Object.prototype.hasOwnProperty.call(t, o) && (e[o] = t[o]);
})(e, t);
}, function(e, t) {
n(e, t);
function o() {
this.constructor = e;
}
e.prototype = null === t ? Object.create(t) : (o.prototype = t.prototype, new o());
}), i = this && this.__decorate || function(e, t, o, n) {
var a, i = arguments.length, r = i < 3 ? t : null === n ? n = Object.getOwnPropertyDescriptor(t, o) : n;
if ("object" == typeof Reflect && "function" == typeof Reflect.decorate) r = Reflect.decorate(e, t, o, n); else for (var l = e.length - 1; l >= 0; l--) (a = e[l]) && (r = (i < 3 ? a(r) : i > 3 ? a(t, o, r) : a(t, o)) || r);
return i > 3 && r && Object.defineProperty(t, o, r), r;
};
Object.defineProperty(o, "__esModule", {
value: !0
});
var r = e("../../../../Game/client/global/enum/game/Const"), l = e("../../../../Game/fromework/global/ResLoader"), s = e("../../../../Game/fromework/global/Tools"), c = e("../../../../fromework/component/listView/ListView"), u = e("../../../component/Card"), d = cc._decorator, p = d.ccclass, h = d.property, f = function(e) {
a(t, e);
function t() {
var t = null !== e && e.apply(this, arguments) || this;
t.Panel = null;
t.ListView = null;
t.FirstCardParent = null;
t.TopToggle = null;
t.ToggleContainer = null;
t._orignalPos = null;
t._curUid = 0;
t._model = null;
return t;
}
t.prototype.onLoad = function() {
this._orignalPos = this.Panel.getPosition();
};
t.prototype.show = function(e) {
var t = this;
this._model = e;
this.refreshFirstCard();
this.refreshTopContainer();
this.Panel.setPosition(cc.v2(this.Panel.x + this.Panel.width, this.Panel.y));
this.Panel.runAction(cc.sequence(cc.moveTo(.2, this._orignalPos), cc.callFunc(function() {
t.ListView.refreshVisualBox();
})));
};
t.prototype.refreshFirstCard = function() {
var e = this;
if (0 == this._model.recordData.firstCard) this.FirstCardParent.parent.active = !1; else {
this.FirstCardParent.parent.active = !0;
this.FirstCardParent.destroyAllChildren();
l.default.Instance.loadBundleRes(r.BundleUIPath.Card, cc.Prefab, function(t, o) {
if (!t) {
var n = cc.instantiate(o);
n.parent = e.FirstCardParent;
n.setPosition(cc.v2(0, 0));
n.getComponent(u.default).init(e._model.recordData.firstCard, !0, e._model.roomData.xcard);
}
});
}
};
t.prototype.refreshTopContainer = function() {
var e = this;
this.ToggleContainer.destroyAllChildren();
this._model.roomData.order.forEach(function(t, o) {
var n = cc.instantiate(e.TopToggle), a = n.getComponent(cc.Toggle), i = n.getChildByName("Name").getComponent(cc.Label), r = n.getChildByName("DSeat"), l = e._model.allUserData.getUserData(t);
n.active = !0;
n.setPosition(cc.v2(0, 0));
e.ToggleContainer.addChild(n);
i.string = l ? s.Tools.TStr.ellipsisString(l.name, 12) : "";
var c = new cc.Component.EventHandler();
c.target = e.node;
c.component = "CardRecorder";
c.handler = "onTopToggleClicked";
c.customEventData = String(t);
a.checkEvents.push(c);
if (0 == o) {
a.isChecked = !0;
e._curUid = t;
}
r.active = o == e._model.roomData.order.length - 1;
});
this.refreshListView();
};
t.prototype.onTopToggleClicked = function(e, t) {
var o = parseInt(t);
if (this._curUid != o) {
this._curUid = o;
this.refreshListView();
}
};
t.prototype.refreshListView = function() {
var e = this, t = this._model.recordData.getRecords(this._curUid);
t.forEach(function(t) {
t.wildCard = e._model.roomData.xcard;
});
t && (this.ListView.datas = t);
};
t.prototype.close = function() {
var e = this;
this.Panel.runAction(cc.sequence(cc.moveTo(.2, cc.v2(this.Panel.x + this.Panel.width, this._orignalPos.y)), cc.callFunc(function() {
e.node.removeFromParent(!0);
e.node.destroy();
})));
};
i([ h(cc.Node) ], t.prototype, "Panel", void 0);
i([ h(c.default) ], t.prototype, "ListView", void 0);
i([ h(cc.Node) ], t.prototype, "FirstCardParent", void 0);
i([ h(cc.Node) ], t.prototype, "TopToggle", void 0);
i([ h(cc.Node) ], t.prototype, "ToggleContainer", void 0);
return i([ p ], t);
}(cc.Component);
o.default = f;
cc._RF.pop();
}, {
"../../../../Game/client/global/enum/game/Const": "Const",
"../../../../Game/fromework/global/ResLoader": "ResLoader",
"../../../../Game/fromework/global/Tools": "Tools",
"../../../../fromework/component/listView/ListView": "ListView",
"../../../component/Card": "Card"
} ],
Card_tp: [ function(e, t, o) {
"use strict";
cc._RF.push(t, "ebcff0evoFK+Yp/GtdyPRGj", "Card_tp");
var n, a = this && this.__extends || (n = function(e, t) {
return (n = Object.setPrototypeOf || {
__proto__: []
} instanceof Array && function(e, t) {
e.__proto__ = t;
} || function(e, t) {
for (var o in t) Object.prototype.hasOwnProperty.call(t, o) && (e[o] = t[o]);
})(e, t);
}, function(e, t) {
n(e, t);
function o() {
this.constructor = e;
}
e.prototype = null === t ? Object.create(t) : (o.prototype = t.prototype, new o());
}), i = this && this.__decorate || function(e, t, o, n) {
var a, i = arguments.length, r = i < 3 ? t : null === n ? n = Object.getOwnPropertyDescriptor(t, o) : n;
if ("object" == typeof Reflect && "function" == typeof Reflect.decorate) r = Reflect.decorate(e, t, o, n); else for (var l = e.length - 1; l >= 0; l--) (a = e[l]) && (r = (i < 3 ? a(r) : i > 3 ? a(t, o, r) : a(t, o)) || r);
return i > 3 && r && Object.defineProperty(t, o, r), r;
};
Object.defineProperty(o, "__esModule", {
value: !0
});
var r = e("../../../Game/client/global/enum/game/Event"), l = e("../../../Game/client/global/enum/game/Game"), s = e("../../../Game/client/logic/game/GameHelper"), c = e("../../../Game/fromework/global/ResLoader"), u = e("../../../Game/fromework/helper/EventHelper"), d = e("../../../platform/Platform"), p = cc._decorator, h = p.ccclass, f = p.property, _ = function(e) {
a(t, e);
function t() {
var t = null !== e && e.apply(this, arguments) || this;
t.Front = null;
t.Pattern = null;
t.Figure = null;
t.Face = null;
t.WildCard = null;
t.Back = null;
t.BlackMask = null;
t.Frame_Patterns = [];
t.Frame_Figures = [];
t.Frame_Faces = [];
t._open = !1;
t._isWildCard = !1;
t._idx16 = 0;
t._pattern = 0;
t._figure = 0;
t._eulerAngles = cc.Vec3.ZERO;
t._is4Color = !1;
return t;
}
t.prototype.onEnable = function() {
u.default.Instance.Global.bind(r.GameEvent.CARD_REFRESH_COLOR, this._refreshColor, this);
};
t.prototype.onDisable = function() {
u.default.Instance.Global.unbind(r.GameEvent.CARD_REFRESH_COLOR, this._refreshColor, this);
};
Object.defineProperty(t.prototype, "open", {
get: function() {
return this._open;
},
set: function(e) {
this._open = e;
this._initSide();
},
enumerable: !1,
configurable: !0
});
Object.defineProperty(t.prototype, "isWildCard", {
get: function() {
return this._isWildCard;
},
set: function(e) {
this._isWildCard = e;
this._refreshWildCard();
},
enumerable: !1,
configurable: !0
});
Object.defineProperty(t.prototype, "pattern", {
get: function() {
return this._pattern;
},
enumerable: !1,
configurable: !0
});
Object.defineProperty(t.prototype, "figure", {
get: function() {
return this._figure;
},
enumerable: !1,
configurable: !0
});
Object.defineProperty(t.prototype, "idx16", {
get: function() {
return this._idx16;
},
enumerable: !1,
configurable: !0
});
t.prototype._refreshColor = function(e) {
var t = e.getUserData();
this._is4Color = t;
this._initColor();
this._initPattern();
this._initFace();
};
t.prototype._getCardColor = function(e) {
if (this._is4Color) {
if (e == l.GameEnum.Pattern.Spade) return cc.color(0, 0, 0);
if (e == l.GameEnum.Pattern.Heart) return cc.color(218, 26, 26);
if (e == l.GameEnum.Pattern.Club) return cc.color(38, 142, 29);
if (e == l.GameEnum.Pattern.Diamond) return cc.color(35, 127, 205);
} else {
if (e == l.GameEnum.Pattern.Heart || e == l.GameEnum.Pattern.Diamond) return cc.color(218, 26, 26);
if (e == l.GameEnum.Pattern.Spade || e == l.GameEnum.Pattern.Club) return cc.color(0, 0, 0);
}
};
t.prototype._getPatternIndex = function() {
return this._is4Color && this.pattern < 2 ? this.pattern + 4 : this.pattern;
};
t.prototype._isBigJoker = function() {
return this.pattern == l.GameEnum.Pattern.BigJoker;
};
t.prototype.init = function(e, t, o) {
void 0 === o && (o = !1);
this._open = t;
this._isWildCard = o;
this._idx16 = e;
this._pattern = s.GroupHelper.getPattern(e);
this._figure = s.GroupHelper.getFigure(e);
var n = JSON.parse(cc.sys.localStorage.getItem("Card_is4Color"));
null == n && (n = !1);
this._is4Color = n;
this._init();
};
t.prototype._init = function() {
this._initColor();
this._initPattern();
this._initFigure();
this._initFace();
this._initSide();
this._refreshWildCard();
};
t.prototype._initColor = function() {
if (this._isBigJoker()) this.Figure.node.color = cc.Color.WHITE; else {
var e = this._getCardColor(this.pattern);
this.Figure.node.color = e;
}
};
t.prototype._initPattern = function() {
if (this._isBigJoker()) this.Pattern.node.active = !1; else {
this.Pattern.node.active = !0;
this.Pattern.spriteFrame = this.Frame_Patterns[this._getPatternIndex()];
}
};
t.prototype._initFigure = function() {
this._isBigJoker() ? this.Figure.spriteFrame = this.Frame_Figures[13] : this.Figure.spriteFrame = this.Frame_Figures[this.figure - 1];
};
t.prototype._initFace = function() {
this.figure > 10 && this.figure < 14 ? this.Face.spriteFrame = this.Frame_Faces[this.figure - 11] : this._isBigJoker() ? this.Face.spriteFrame = this.Frame_Patterns[6] : this.Face.spriteFrame = this.Frame_Patterns[this._getPatternIndex()];
};
t.prototype._refreshWildCard = function() {
this.WildCard.node.active = this._isWildCard;
};
t.prototype._initSide = function() {
this.Front.active = this._open;
this.Back.node.active = !this._open;
};
t.prototype.setEulerAngles = function(e) {
this.node.eulerAngles = e;
this._eulerAngles = e;
this.Front.scale = 1;
};
t.prototype.setBlackMask = function(e) {
this.BlackMask.active = e;
};
t.prototype.getEuler = function(e) {
var t = cc.quat(), o = cc.misc.degreesToRadians(e), n = this.node.getRotation(cc.quat()), a = cc.Vec3.transformQuat(cc.quat(), cc.Vec3.UP, n);
cc.Quat.rotateAround(t, n, a, o);
return t.toEuler(cc.v3());
};
t.prototype.flipCard = function(e, t, o, n) {
var a = this;
void 0 === e && (e = .5);
void 0 === t && (t = cc.v3(0, -180, 0));
void 0 === o && (o = !1);
void 0 === n && (n = null);
if (0 == e) {
this.Front.active = !o;
this.Back.node.active = o;
this.Front.scaleX = -1;
this.node.setRotation(t.x, t.y, t.z);
n && n();
} else {
var i = cc.sequence(cc.spawn(cc.scaleTo(e / 2, this.node.scale), cc.rotate3DTo(e / 2, this.getEuler(t.y / 2))), cc.callFunc(function() {
a.Front.active = !o;
a.Back.node.active = o;
a.Front.scaleX = -1;
}), cc.spawn(cc.scaleTo(e / 2, this.node.scale), cc.rotate3DTo(e / 2, this.getEuler(t.y))), cc.callFunc(function() {
a.Front.scale = 1;
a.node.eulerAngles = a._eulerAngles;
null != n && n();
}));
this.Front.active = o;
this.Back.node.active = !o;
this.node.runAction(i);
}
};
t.prototype.moveCard = function(e, t, o, n, a) {
void 0 === e && (e = .5);
void 0 === t && (t = cc.Vec2.ZERO);
void 0 === o && (o = 1);
void 0 === n && (n = 1);
void 0 === a && (a = null);
var i = cc.sequence(cc.spawn(cc.moveTo(e, t), cc.scaleTo(e, o, n)), cc.rotateTo(.1, 0), cc.callFunc(function() {
null != a && a();
}));
this.node.runAction(i);
};
t.prototype.playJokerChange = function(e, t) {
var o = this, n = new cc.Node();
n.position = cc.v3(0, this.node.height / 2, 0);
n.parent = this.node;
var a = n.addComponent(sp.Skeleton);
c.default.Instance.loadBundleRes("resources/Skeleton/TeenPatti/tp_card_change", sp.SkeletonData, function(i, r) {
if (i) d.default.log("Load Teenpatti Joker Card Change Effect Error:" + i.message); else if (null != n && n.isValid) {
a.skeletonData = r;
a.setCompleteListener(function() {
n && n.isValid && n.destroy();
t && t();
});
a.setEventListener(function() {
o.init(e, !0, !0);
});
a.setAnimation(0, "animation", !1);
}
});
};
i([ f(cc.Node) ], t.prototype, "Front", void 0);
i([ f(cc.Sprite) ], t.prototype, "Pattern", void 0);
i([ f(cc.Sprite) ], t.prototype, "Figure", void 0);
i([ f(cc.Sprite) ], t.prototype, "Face", void 0);
i([ f(cc.Sprite) ], t.prototype, "WildCard", void 0);
i([ f(cc.Sprite) ], t.prototype, "Back", void 0);
i([ f(cc.Node) ], t.prototype, "BlackMask", void 0);
i([ f([ cc.SpriteFrame ]) ], t.prototype, "Frame_Patterns", void 0);
i([ f([ cc.SpriteFrame ]) ], t.prototype, "Frame_Figures", void 0);
i([ f([ cc.SpriteFrame ]) ], t.prototype, "Frame_Faces", void 0);
return i([ h ], t);
}(cc.Component);
o.default = _;
cc._RF.pop();
}, {
"../../../Game/client/global/enum/game/Event": "Event",
"../../../Game/client/global/enum/game/Game": "Game",
"../../../Game/client/logic/game/GameHelper": "GameHelper",
"../../../Game/fromework/global/ResLoader": "ResLoader",
"../../../Game/fromework/helper/EventHelper": "EventHelper",
"../../../platform/Platform": "Platform"
} ],
Card: [ function(e, t, o) {
"use strict";
cc._RF.push(t, "0046cxtMuBBZpZfiEv5GcyP", "Card");
var n, a = this && this.__extends || (n = function(e, t) {
return (n = Object.setPrototypeOf || {
__proto__: []
} instanceof Array && function(e, t) {
e.__proto__ = t;
} || function(e, t) {
for (var o in t) Object.prototype.hasOwnProperty.call(t, o) && (e[o] = t[o]);
})(e, t);
}, function(e, t) {
n(e, t);
function o() {
this.constructor = e;
}
e.prototype = null === t ? Object.create(t) : (o.prototype = t.prototype, new o());
}), i = this && this.__decorate || function(e, t, o, n) {
var a, i = arguments.length, r = i < 3 ? t : null === n ? n = Object.getOwnPropertyDescriptor(t, o) : n;
if ("object" == typeof Reflect && "function" == typeof Reflect.decorate) r = Reflect.decorate(e, t, o, n); else for (var l = e.length - 1; l >= 0; l--) (a = e[l]) && (r = (i < 3 ? a(r) : i > 3 ? a(t, o, r) : a(t, o)) || r);
return i > 3 && r && Object.defineProperty(t, o, r), r;
};
Object.defineProperty(o, "__esModule", {
value: !0
});
var r = e("../../Game/client/global/enum/game/Const"), l = e("../../Game/client/global/enum/game/Event"), s = e("../../Game/client/global/enum/game/Game"), c = e("../../Game/client/logic/game/GameHelper"), u = e("../../Game/fromework/helper/EventHelper"), d = cc._decorator, p = d.ccclass, h = d.property, f = function(e) {
a(t, e);
function t() {
var t = null !== e && e.apply(this, arguments) || this;
t.Front = null;
t.Pattern = null;
t.Figure = null;
t.Face = null;
t.WildCard = null;
t.Back = null;
t.SelectMask = null;
t.LightBorder = null;
t.TranslucentMask = null;
t.Frame_Patterns = [];
t.Frame_Figures = [];
t.Frame_Faces = [];
t._open = !1;
t._idx16 = 0;
t._pattern = 0;
t._figure = 0;
t._wildCard = 0;
t._isClick = !1;
t._is4Color = !1;
return t;
}
t.prototype.onEnable = function() {
u.default.Instance.Global.bind(l.GameEvent.CARD_REFRESH_COLOR, this._refreshColor, this);
};
t.prototype.onDisable = function() {
u.default.Instance.Global.unbind(l.GameEvent.CARD_REFRESH_COLOR, this._refreshColor, this);
};
t.prototype.onDestroy = function() {
this.unscheduleAllCallbacks();
};
Object.defineProperty(t.prototype, "open", {
get: function() {
return this._open;
},
set: function(e) {
this._open = e;
this._initSide();
},
enumerable: !1,
configurable: !0
});
Object.defineProperty(t.prototype, "pattern", {
get: function() {
return this._pattern;
},
enumerable: !1,
configurable: !0
});
Object.defineProperty(t.prototype, "figure", {
get: function() {
return this._figure;
},
enumerable: !1,
configurable: !0
});
Object.defineProperty(t.prototype, "idx16", {
get: function() {
return this._idx16;
},
enumerable: !1,
configurable: !0
});
Object.defineProperty(t.prototype, "box", {
get: function() {
return this && this.node ? this.node.getBoundingBoxToWorld() : new cc.Rect(0, 0, 0, 0);
},
enumerable: !1,
configurable: !0
});
Object.defineProperty(t.prototype, "pos", {
get: function() {
return this && this.node ? this.node.getPosition() : cc.Vec2.ZERO;
},
set: function(e) {
this.node.setPosition(e);
var t = this.node.parent.convertToWorldSpaceAR(e);
this.node.zIndex = Math.floor(t.x) + r.CARD_ZINDEX;
t.y <= r.SCALE_LINE_DOWN && 1 != this.node.scale && (this.node.scale = 1);
t.y >= r.SCALE_LINE_UP && this.node.scale != r.SCALE_DESK && (this.node.scale = r.SCALE_DESK);
if (t.y > r.SCALE_LINE_DOWN && t.y < r.SCALE_LINE_UP) {
var o = 1 - (t.y - r.SCALE_LINE_DOWN) / (r.SCALE_LINE_UP - r.SCALE_LINE_DOWN) * (1 - r.SCALE_DESK);
this.node.scale != o && (this.node.scale = o);
}
},
enumerable: !1,
configurable: !0
});
Object.defineProperty(t.prototype, "Clicked", {
get: function() {
return this._isClick;
},
enumerable: !1,
configurable: !0
});
t.prototype._refreshColor = function(e) {
var t = e.getUserData();
this._is4Color = t;
this._initColor();
this._initPattern();
this._initFace();
};
t.prototype._getCardColor = function(e) {
if (this._is4Color) {
if (e == s.GameEnum.Pattern.Spade) return cc.color(0, 0, 0);
if (e == s.GameEnum.Pattern.Heart) return cc.color(218, 26, 26);
if (e == s.GameEnum.Pattern.Club) return cc.color(38, 142, 29);
if (e == s.GameEnum.Pattern.Diamond) return cc.color(35, 127, 205);
} else {
if (e == s.GameEnum.Pattern.Heart || e == s.GameEnum.Pattern.Diamond) return cc.color(218, 26, 26);
if (e == s.GameEnum.Pattern.Spade || e == s.GameEnum.Pattern.Club) return cc.color(0, 0, 0);
}
};
t.prototype._getPatternIndex = function() {
return this._is4Color && this.pattern < 2 ? this.pattern + 4 : this.pattern;
};
t.prototype._isJoker = function() {
return this.pattern == s.GameEnum.Pattern.BigJoker || this.pattern == s.GameEnum.Pattern.LittleJoker;
};
t.prototype.init = function(e, t, o) {
void 0 === o && (o = 0);
this._open = t;
this._idx16 = e;
this._wildCard = o;
this._pattern = c.GroupHelper.getPattern(e);
this._figure = c.GroupHelper.getFigure(e);
var n = JSON.parse(cc.sys.localStorage.getItem("Card_is4Color"));
null == n && (n = !1);
this._is4Color = n;
this._init();
};
t.prototype._init = function() {
this._initColor();
this._initPattern();
this._initFigure();
this._initFace();
this.refreshWildCard();
this._initSide();
};
t.prototype._initColor = function() {
if (!this._isJoker()) {
var e = this._getCardColor(this.pattern);
e || (e = cc.Color.BLACK);
this.Pattern.node.color = e;
this.Figure.node.color = e;
}
};
t.prototype._initPattern = function() {
if (this._isJoker()) this.Pattern.node.active = !1; else {
this.Pattern.node.active = !0;
this.Pattern.spriteFrame = this.Frame_Patterns[this._getPatternIndex()];
}
};
t.prototype._initFigure = function() {
this._isJoker() ? this.Figure.spriteFrame = this.Frame_Figures[13] : this.Figure.spriteFrame = this.Frame_Figures[this.figure - 1];
};
t.prototype._initFace = function() {
this.figure > 10 && this.figure < 14 ? this.Face.spriteFrame = this.Frame_Faces[this.figure - 11] : this._isJoker() ? this.Face.spriteFrame = this.Frame_Patterns[6] : this.Face.spriteFrame = this.Frame_Patterns[this._getPatternIndex()];
};
t.prototype.refreshWildCard = function() {
this.WildCard.node.active = c.GroupHelper.checkWild(this.idx16, this._wildCard) && !this._isJoker() && c.GroupHelper.isShowWildCard();
};
t.prototype.setCloseDeckWildIcon = function() {};
t.prototype._initSide = function() {
this.Front.active = this._open;
this.Back.node.active = !this._open;
};
t.prototype.showLightBorder = function(e) {
this.LightBorder.active = e;
};
t.prototype.showTranslucentMask = function(e) {
this.TranslucentMask.active = e;
};
t.prototype.drawTipAnimation = function() {
var e = this;
if (this && this.node && this.node.isValid) {
this.SelectMask.active = !0;
this.LightBorder.active = !0;
this.scheduleOnce(function() {
if (e && e.node && e.node.isValid) {
e.SelectMask.active = !1;
e.LightBorder.active = !1;
}
}, 1);
}
};
t.prototype.flipCard = function(e, t, o, n) {
var a = this;
void 0 === e && (e = .5);
void 0 === t && (t = cc.v3(0, -180, 0));
void 0 === o && (o = !1);
void 0 === n && (n = null);
if (0 == e) {
this.Front.active = !o;
this.Back.node.active = o;
this.Front.scaleX = -1;
this.node.setRotation(t.x, t.y, t.z);
n && n();
} else {
var i = cc.sequence(cc.spawn(cc.scaleTo(e / 2, this.node.scale), cc.rotate3DTo(e / 2, t.div(2))), cc.callFunc(function() {
a.Front.active = !o;
a.Back.node.active = o;
a.Front.scaleX = -1;
}), cc.spawn(cc.scaleTo(e / 2, this.node.scale), cc.rotate3DTo(e / 2, t)), cc.callFunc(function() {
null != n && n();
}));
this.node.runAction(i);
}
};
t.prototype.moveCard = function(e, t, o, n, a, i, r) {
void 0 === e && (e = .5);
void 0 === t && (t = cc.Vec2.ZERO);
void 0 === o && (o = 1);
void 0 === n && (n = 1);
void 0 === a && (a = null);
void 0 === i && (i = !0);
void 0 === r && (r = !0);
if (this.node) {
var l = [];
r ? l.push(cc.spawn(cc.moveTo(e, t).easing(cc.easeCircleActionOut()), cc.scaleTo(e, o, n))) : l.push(cc.spawn(cc.moveTo(e, t), cc.scaleTo(e, o, n)));
i && l.push(cc.rotateTo(.1, 0));
l.push(cc.callFunc(function() {
null != a && a();
}));
var s = cc.sequence(l);
this.node.runAction(s);
}
};
t.prototype.onClick = function() {
this._isClick = !this._isClick;
this.node.y += this._isClick ? 30 : -30;
};
t.prototype.toLeft = function() {
this.pos = this.pos.sub(cc.v2(r.CARD_SHOW_WIDTH, 0));
};
t.prototype.toRight = function() {
this.pos = this.pos.add(cc.v2(r.CARD_SHOW_WIDTH, 0));
};
i([ h(cc.Node) ], t.prototype, "Front", void 0);
i([ h(cc.Sprite) ], t.prototype, "Pattern", void 0);
i([ h(cc.Sprite) ], t.prototype, "Figure", void 0);
i([ h(cc.Sprite) ], t.prototype, "Face", void 0);
i([ h(cc.Sprite) ], t.prototype, "WildCard", void 0);
i([ h(cc.Sprite) ], t.prototype, "Back", void 0);
i([ h(cc.Node) ], t.prototype, "SelectMask", void 0);
i([ h(cc.Node) ], t.prototype, "LightBorder", void 0);
i([ h(cc.Node) ], t.prototype, "TranslucentMask", void 0);
i([ h([ cc.SpriteFrame ]) ], t.prototype, "Frame_Patterns", void 0);
i([ h([ cc.SpriteFrame ]) ], t.prototype, "Frame_Figures", void 0);
i([ h([ cc.SpriteFrame ]) ], t.prototype, "Frame_Faces", void 0);
return i([ p ], t);
}(cc.Component);
o.default = f;
cc._RF.pop();
}, {
"../../Game/client/global/enum/game/Const": "Const",
"../../Game/client/global/enum/game/Event": "Event",
"../../Game/client/global/enum/game/Game": "Game",
"../../Game/client/logic/game/GameHelper": "GameHelper",
"../../Game/fromework/helper/EventHelper": "EventHelper"
} ],
CashSprite: [ function(e, t, o) {
"use strict";
cc._RF.push(t, "2b108W0KJhBK7ThOgDGSsy0", "CashSprite");
var n, a = this && this.__extends || (n = function(e, t) {
return (n = Object.setPrototypeOf || {
__proto__: []
} instanceof Array && function(e, t) {
e.__proto__ = t;
} || function(e, t) {
for (var o in t) Object.prototype.hasOwnProperty.call(t, o) && (e[o] = t[o]);
})(e, t);
}, function(e, t) {
n(e, t);
function o() {
this.constructor = e;
}
e.prototype = null === t ? Object.create(t) : (o.prototype = t.prototype, new o());
}), i = this && this.__decorate || function(e, t, o, n) {
var a, i = arguments.length, r = i < 3 ? t : null === n ? n = Object.getOwnPropertyDescriptor(t, o) : n;
if ("object" == typeof Reflect && "function" == typeof Reflect.decorate) r = Reflect.decorate(e, t, o, n); else for (var l = e.length - 1; l >= 0; l--) (a = e[l]) && (r = (i < 3 ? a(r) : i > 3 ? a(t, o, r) : a(t, o)) || r);
return i > 3 && r && Object.defineProperty(t, o, r), r;
};
Object.defineProperty(o, "__esModule", {
value: !0
});
var r = e("../../Game/Script/global/GlobalValue"), l = e("../../Game/fromework/global/ResLoader"), s = cc._decorator, c = s.ccclass, u = (s.property, 
s.disallowMultiple), d = s.menu, p = s.executionOrder, h = s.requireComponent, f = function(e) {
a(t, e);
function t() {
return null !== e && e.apply(this, arguments) || this;
}
t.prototype.onLoad = function() {
if (!r.default.getInstance().isCashGame) {
var e = this.node.getComponent(cc.Sprite);
if (null != e && null != e.spriteFrame && "" != e.spriteFrame.name) {
var t = "resources/Texture/Gold/" + e.spriteFrame.name;
l.default.Instance.loadBundleRes(t, cc.SpriteFrame, function(t, o) {
t || null != e && e.isValid && (e.spriteFrame = o);
});
}
}
};
return i([ c, u(), h(cc.Sprite), p(-5e3), d("自定义组件/CashSprite") ], t);
}(cc.Component);
o.default = f;
cc._RF.pop();
}, {
"../../Game/Script/global/GlobalValue": "GlobalValue",
"../../Game/fromework/global/ResLoader": "ResLoader"
} ],
ChairAlert: [ function(e, t, o) {
"use strict";
cc._RF.push(t, "8e6cf+Fw6pK5KLrdleGAx8/", "ChairAlert");
var n, a = this && this.__extends || (n = function(e, t) {
return (n = Object.setPrototypeOf || {
__proto__: []
} instanceof Array && function(e, t) {
e.__proto__ = t;
} || function(e, t) {
for (var o in t) Object.prototype.hasOwnProperty.call(t, o) && (e[o] = t[o]);
})(e, t);
}, function(e, t) {
n(e, t);
function o() {
this.constructor = e;
}
e.prototype = null === t ? Object.create(t) : (o.prototype = t.prototype, new o());
}), i = this && this.__decorate || function(e, t, o, n) {
var a, i = arguments.length, r = i < 3 ? t : null === n ? n = Object.getOwnPropertyDescriptor(t, o) : n;
if ("object" == typeof Reflect && "function" == typeof Reflect.decorate) r = Reflect.decorate(e, t, o, n); else for (var l = e.length - 1; l >= 0; l--) (a = e[l]) && (r = (i < 3 ? a(r) : i > 3 ? a(t, o, r) : a(t, o)) || r);
return i > 3 && r && Object.defineProperty(t, o, r), r;
};
Object.defineProperty(o, "__esModule", {
value: !0
});
var r = e("../../../../Game/client/global/enum/game/Event"), l = e("../../../../Game/fromework/helper/EventHelper"), s = e("../../../../Game/fromework/helper/UIHelper"), c = cc._decorator, u = c.ccclass, d = (c.property, 
function(e) {
a(t, e);
function t() {
var t = null !== e && e.apply(this, arguments) || this;
t._callFunc = null;
return t;
}
t.prototype.showView = function(e) {
this._callFunc = e;
};
t.prototype.onWithdrawClicked = function() {
this._callFunc && this._callFunc();
this._callFunc = null;
s.default.Instance.removeMaskLayer(this.node, !0);
};
t.prototype.onCloseClicked = function() {
s.default.Instance.removeMaskLayer(this.node, !0);
l.default.Instance.Global.emit(r.GameEvent.TABLE_SWITCH_TABLE);
};
return i([ u ], t);
}(cc.Component));
o.default = d;
cc._RF.pop();
}, {
"../../../../Game/client/global/enum/game/Event": "Event",
"../../../../Game/fromework/helper/EventHelper": "EventHelper",
"../../../../Game/fromework/helper/UIHelper": "UIHelper"
} ],
ChallengeButton: [ function(e, t, o) {
"use strict";
cc._RF.push(t, "27907QRGelF3q/w8et5FyfN", "ChallengeButton");
var n, a = this && this.__extends || (n = function(e, t) {
return (n = Object.setPrototypeOf || {
__proto__: []
} instanceof Array && function(e, t) {
e.__proto__ = t;
} || function(e, t) {
for (var o in t) Object.prototype.hasOwnProperty.call(t, o) && (e[o] = t[o]);
})(e, t);
}, function(e, t) {
n(e, t);
function o() {
this.constructor = e;
}
e.prototype = null === t ? Object.create(t) : (o.prototype = t.prototype, new o());
}), i = this && this.__decorate || function(e, t, o, n) {
var a, i = arguments.length, r = i < 3 ? t : null === n ? n = Object.getOwnPropertyDescriptor(t, o) : n;
if ("object" == typeof Reflect && "function" == typeof Reflect.decorate) r = Reflect.decorate(e, t, o, n); else for (var l = e.length - 1; l >= 0; l--) (a = e[l]) && (r = (i < 3 ? a(r) : i > 3 ? a(t, o, r) : a(t, o)) || r);
return i > 3 && r && Object.defineProperty(t, o, r), r;
};
Object.defineProperty(o, "__esModule", {
value: !0
});
var r = e("../../../../Game/client/global/enum/game/Const"), l = e("../../../../Game/fromework/helper/AudioHelper"), s = e("../../../../Game/fromework/helper/EventHelper"), c = e("../../../../Game/fromework/helper/UIHelper"), u = e("../../../model/UserModel"), d = e("./ChallengeModel"), p = cc._decorator, h = p.ccclass, f = (p.property, 
function(e) {
a(t, e);
function t() {
var t = null !== e && e.apply(this, arguments) || this;
t.challengeData = null;
return t;
}
t.prototype.onEnable = function() {
s.default.Instance.Global.bind("referChallenge", this.referShow, this);
};
t.prototype.onDisable = function() {
s.default.Instance.Global.unbind("referChallenge", this.referShow, this);
};
t.prototype.start = function() {
this.referShow();
};
t.prototype.updateView = function() {
var e = cc.find("Title", this.node), t = cc.find("RedDot/challengeDone", this.node), o = "Lobby" === cc.director.getScene().name;
e.active = o;
t.y = o ? -170 : -140;
};
t.prototype.referShow = function() {
this.challengeData = d.ChallengeModel.Instance.challengeData;
if (this.challengeData && null != this.challengeData) {
this.updateView();
var e = this.node.getChildByName("effect").getComponent(sp.Skeleton), t = this.node.getChildByName("RedDot");
if (0 == this.challengeData.challage_5 || 0 == this.challengeData.challage_2_today || 0 == this.challengeData.challage_3_today) {
e.clearTrack(0);
e.setAnimation(0, "nodone", !0);
} else {
e.clearTrack(0);
e.setAnimation(0, "done1", !0);
}
1 == this.challengeData.challage_5 && 0 == this.challengeData.challage_5_received || 1 == this.challengeData.challage_2 && 0 == this.challengeData.challage_2_received || 1 == this.challengeData.challage_3 && 0 == this.challengeData.challage_3_received ? t.active = !0 : t.active = !1;
}
};
t.prototype.clickCall = function() {
d.ChallengeModel.Instance.getChallengeInfo(function() {
c.default.Instance.addBundleMaskLayer(r.BundleUIPath.challengeLayer);
});
if (0 == u.userSoundHavePlay.SOUND_EXCHANGE_WIN) {
l.default.Instance.playBundleEffect("resources/sound/tipEffect/Win", !1, null, !1, !0);
u.userSoundHavePlay.SOUND_EXCHANGE_WIN = 1;
}
};
return i([ h ], t);
}(cc.Component));
o.default = f;
cc._RF.pop();
}, {
"../../../../Game/client/global/enum/game/Const": "Const",
"../../../../Game/fromework/helper/AudioHelper": "AudioHelper",
"../../../../Game/fromework/helper/EventHelper": "EventHelper",
"../../../../Game/fromework/helper/UIHelper": "UIHelper",
"../../../model/UserModel": "UserModel",
"./ChallengeModel": "ChallengeModel"
} ],
ChallengeLayer: [ function(e, t, o) {
"use strict";
cc._RF.push(t, "d26aehE4RpNW46drnF06jsl", "ChallengeLayer");
var n, a = this && this.__extends || (n = function(e, t) {
return (n = Object.setPrototypeOf || {
__proto__: []
} instanceof Array && function(e, t) {
e.__proto__ = t;
} || function(e, t) {
for (var o in t) Object.prototype.hasOwnProperty.call(t, o) && (e[o] = t[o]);
})(e, t);
}, function(e, t) {
n(e, t);
function o() {
this.constructor = e;
}
e.prototype = null === t ? Object.create(t) : (o.prototype = t.prototype, new o());
}), i = this && this.__decorate || function(e, t, o, n) {
var a, i = arguments.length, r = i < 3 ? t : null === n ? n = Object.getOwnPropertyDescriptor(t, o) : n;
if ("object" == typeof Reflect && "function" == typeof Reflect.decorate) r = Reflect.decorate(e, t, o, n); else for (var l = e.length - 1; l >= 0; l--) (a = e[l]) && (r = (i < 3 ? a(r) : i > 3 ? a(t, o, r) : a(t, o)) || r);
return i > 3 && r && Object.defineProperty(t, o, r), r;
};
Object.defineProperty(o, "__esModule", {
value: !0
});
var r = e("../../../../Game/Script/global/GlobalValue"), l = e("../../../../Game/client/global/enum/game/Const"), s = e("../../../../Game/client/model/LanguageModel"), c = e("../../../../Game/fromework/global/Tools"), u = e("../../../../Game/fromework/helper/EventHelper"), d = e("../../../../Game/fromework/helper/UIHelper"), p = e("../../../../Game/fromework/mvvm/modelView/ViewModel"), h = e("../../../../Game/fromework/net/NetHttp"), f = e("../../../component/pop/tipsHand"), _ = e("../../../global/Global"), m = e("../../../global/PopHelper"), y = e("../../Wallet/WalletHelper"), g = e("./ChallengeModel"), v = cc._decorator, C = v.ccclass, b = v.property, I = function(e) {
a(t, e);
function t() {
var t = null !== e && e.apply(this, arguments) || this;
t.helpNode = null;
t.dayNode = null;
t.dayServenNode = null;
t.dayThreeNode = null;
t.dayFiveNode = null;
t.buyNum = null;
t.timeLabel = null;
t.txtTip = null;
t.addCash = null;
t.addCashToStore = null;
t.challengeData = null;
return t;
}
t.prototype.onEnable = function() {
u.default.Instance.Global.bind("referChallenge", this.referShow, this);
};
t.prototype.onDisable = function() {
u.default.Instance.Global.unbind("referChallenge", this.referShow, this);
};
t.prototype.referShow = function() {
this.challengeData = g.ChallengeModel.Instance.challengeData;
if (this.challengeData && 1 == this.challengeData.challage_2) {
this.dayServenNode.getChildByName("Completed").active = !0;
0 == this.challengeData.challage_2_received ? this.dayServenNode.getChildByName("getBtn").getComponent(cc.Button).interactable = !0 : this.dayServenNode.getChildByName("getBtn").getComponent(cc.Button).interactable = !1;
} else this.dayServenNode.getChildByName("Completed").active = !1;
if (this.challengeData && 1 == this.challengeData.challage_3) {
this.dayThreeNode.getChildByName("Completed").active = !0;
0 == this.challengeData.challage_3_received ? this.dayThreeNode.getChildByName("getBtn").getComponent(cc.Button).interactable = !0 : this.dayThreeNode.getChildByName("getBtn").getComponent(cc.Button).interactable = !1;
} else this.dayThreeNode.getChildByName("Completed").active = !1;
if (this.challengeData && 1 == this.challengeData.challage_5) {
this.dayFiveNode.getChildByName("Completed").active = !0;
0 == this.challengeData.challage_3_received ? this.dayFiveNode.getChildByName("getBtn").getComponent(cc.Button).interactable = !0 : this.dayFiveNode.getChildByName("getBtn").getComponent(cc.Button).interactable = !1;
} else this.dayFiveNode.getChildByName("Completed").active = !1;
if (this.challengeData) {
this.dayServenNode.getChildByName("win").getComponent(cc.Label).string = "Win ₹" + this.challengeData.challage_2_amount;
this.dayServenNode.getChildByName("getBtn").getChildByName("textLayout").getChildByName("label").getComponent(cc.Label).string = this.challengeData.challage_config_week + " free";
this.dayThreeNode.getChildByName("win").getComponent(cc.Label).string = "Win ₹" + this.challengeData.challage_3_amount;
this.dayThreeNode.getChildByName("getBtn").getChildByName("textLayout").getChildByName("label").getComponent(cc.Label).string = this.challengeData.challage_config_three + " free";
this.dayFiveNode.getChildByName("win").getComponent(cc.Label).string = "Win ₹" + this.challengeData.challage_5_amount;
this.dayFiveNode.getChildByName("getBtn").getChildByName("textLayout").getChildByName("label").getComponent(cc.Label).string = this.challengeData.challage_config_five + " free";
for (var e = 7, t = 1; t <= 7; t++) {
var o = this.dayServenNode.getChildByName("Toggle" + t);
if (1 == this.challengeData.week_reach[t - 1]) {
o.getComponent(cc.Toggle).isChecked = !0;
e -= 1;
} else o.getComponent(cc.Toggle).isChecked = !1;
}
this.dayServenNode.getChildByName("day").getComponent(cc.Label).string = "" + e;
var n = 3;
for (t = 1; t <= 3; t++) {
o = this.dayThreeNode.getChildByName("Toggle" + t);
if (1 == this.challengeData.three_reach[t - 1]) {
o.getComponent(cc.Toggle).isChecked = !0;
n -= 1;
} else o.getComponent(cc.Toggle).isChecked = !1;
}
this.dayThreeNode.getChildByName("day").getComponent(cc.Label).string = "" + n;
var a = 5;
for (t = 1; t <= 5; t++) {
o = this.dayFiveNode.getChildByName("Toggle" + t);
if (1 == this.challengeData.three_reach[t - 1]) {
o.getComponent(cc.Toggle).isChecked = !0;
a -= 1;
} else o.getComponent(cc.Toggle).isChecked = !1;
}
this.dayFiveNode.getChildByName("day").getComponent(cc.Label).string = "" + a;
if (this.challengeData.challage_received_All && this.challengeData.challage_received_All > 0) {
this.node.getChildByName("uiNode").getChildByName("tipsNode").active = !0;
this.node.getChildByName("uiNode").getChildByName("tipsNode").getChildByName("money").getComponent(cc.Label).string = "₹" + this.challengeData.challage_received_All;
} else this.node.getChildByName("uiNode").getChildByName("tipsNode").active = !1;
if (this.challengeData.challage_open) {
this.buyNum.string = l.MoneySymbol + Number(this.challengeData.pay_info.pay_qf) + "+";
this.addCash.node.getChildByName("tipsHand").active = !0;
this.addCash.node.getChildByName("tipsHand").getComponent(f.default).show(this.challengeData.pay_info.pay_qf);
}
}
};
t.prototype.start = function() {
var e = this;
this.referShow();
var t = new Date(new Date(new Date().toLocaleDateString()).getTime() + 864e5 - 1).getTime(), o = Math.round(Number(t) / 1e3 - Number(new Date().getTime()) / 1e3) - Number(_.Global.Instance.TimeDifference), n = c.Tools.TDate.second2Hour(o), a = String(n.hour), i = String(n.minu), r = String(n.sec);
n.hour < 10 && (a = "0" + n.hour);
n.minu < 10 && (i = "0" + n.minu);
n.sec < 10 && (r = "0" + n.sec);
this.timeLabel.string = a + ":" + i + ":" + r;
this.timeLabel.schedule(function() {
if ((o -= 1) >= 0) {
n = c.Tools.TDate.second2Hour(o);
a = String(n.hour);
i = String(n.minu);
r = String(n.sec);
n.hour < 10 && (a = "0" + n.hour);
n.minu < 10 && (i = "0" + n.minu);
n.sec < 10 && (r = "0" + n.sec);
e.timeLabel.string = a + ":" + i + ":" + r;
} else {
o = 0;
e.timeLabel.unscheduleAllCallbacks();
}
}, 1);
this.addCash.node.active = !1;
this.addCashToStore.node.active = !1;
if (this.challengeData.challage_open) {
this.addCash.node.active = !0;
this.txtTip.string = "you can purchase the item on the right to reduce your winning goal";
} else {
this.addCashToStore.node.active = !0;
this.txtTip.string = "Make a purchase to open the challege function";
}
};
t.prototype.onClickShop = function() {
if ("TeenPatti" == cc.director.getScene().name) m.PopHelper.Instance.showTips("Recharge cannot be done in the game, please go to the lobby to purchase."); else {
y.default.Instance.openRecharge();
this.closeClick();
}
};
t.prototype.helpClick = function() {
this.helpNode.active = !0;
};
t.prototype.closeHelp = function() {
this.helpNode.active = !1;
};
t.prototype.closeClick = function() {
this.timeLabel.unscheduleAllCallbacks();
d.default.Instance.removeMaskLayer(this.node, !0);
};
t.prototype.getDay = function() {
g.ChallengeModel.Instance.sendReceiveChallenge(1, function() {});
};
t.prototype.getDay7 = function() {
g.ChallengeModel.Instance.sendReceiveChallenge(2, function() {});
};
t.prototype.getDay3 = function() {
g.ChallengeModel.Instance.sendReceiveChallenge(3, function() {});
};
t.prototype.getDay5 = function() {
g.ChallengeModel.Instance.sendReceiveChallenge(5, function() {});
};
t.prototype.addCashClick = function() {
var e = this;
if ("TeenPatti" == cc.director.getScene().name) m.PopHelper.Instance.showTips("Recharge cannot be done in the game, please go to the lobby to purchase."); else if (this.challengeData.pay_info && null != this.challengeData.pay_info) {
var t = 0;
cc.sys.os == cc.sys.OS_ANDROID && (t = 1);
cc.sys.os == cc.sys.OS_IOS && (t = 2);
cc.sys.isNative || (t = 3);
var o = {
player_index: p.VM.getValue("user.uid"),
token: p.VM.getValue("user.token"),
amount: this.challengeData.pay_info.pay_qf,
user_name: "",
mobile_type: t,
tel_phone: "",
email: "",
idCard: "",
payType: 0,
cashback: 0,
bonus: 0,
monthly_card_id: 0,
is_bankruptcy: 0,
is_cash: r.default.getInstance().isCashGame ? "" : "is_cash",
active_type: this.challengeData.pay_info.active_type,
hideGainInfo: 0
};
h.default.Instance.get(r.default.getInstance().WalletUrl + "pay", o, function(t) {
var o = JSON.parse(t.response);
e.onPayment(o);
}, !0);
}
};
t.prototype.onPayment = function(e) {
var t = "";
if (1 == e.code) if (1 == e.payWay) {
t = "purchase succeeds!";
g.ChallengeModel.Instance.getChallengeInfo();
} else e.data.isOpenURL ? cc.sys.openURL(e.data.payLinks) : y.default.Instance.openRechargeWebView(e.data.payLinks); else t = 6001 == e.code ? s.default.getString("WALLET_CASH_ATTEND") : 6003 == e.code ? s.default.getString("WALLET_CASH_WRONG") : 6004 == e.code ? s.default.getString("WALLET_CASH_UID") : 6005 == e.code ? s.default.getString("WALLET_CASH_ORDER") : 6006 == e.code ? s.default.getString("WALLET_CASH_THIRD") : 6008 == e.code ? s.default.getString("WALLET_CASH_TYPE") : 999 == e.code ? e.msg : "Error code:" + e.code;
"" != t && m.PopHelper.Instance.showTips(t);
};
i([ b(cc.Node) ], t.prototype, "helpNode", void 0);
i([ b(cc.Node) ], t.prototype, "dayNode", void 0);
i([ b(cc.Node) ], t.prototype, "dayServenNode", void 0);
i([ b(cc.Node) ], t.prototype, "dayThreeNode", void 0);
i([ b(cc.Node) ], t.prototype, "dayFiveNode", void 0);
i([ b(cc.Label) ], t.prototype, "buyNum", void 0);
i([ b(cc.Label) ], t.prototype, "timeLabel", void 0);
i([ b(cc.Label) ], t.prototype, "txtTip", void 0);
i([ b(cc.Button) ], t.prototype, "addCash", void 0);
i([ b(cc.Button) ], t.prototype, "addCashToStore", void 0);
return i([ C ], t);
}(cc.Component);
o.default = I;
cc._RF.pop();
}, {
"../../../../Game/Script/global/GlobalValue": "GlobalValue",
"../../../../Game/client/global/enum/game/Const": "Const",
"../../../../Game/client/model/LanguageModel": "LanguageModel",
"../../../../Game/fromework/global/Tools": "Tools",
"../../../../Game/fromework/helper/EventHelper": "EventHelper",
"../../../../Game/fromework/helper/UIHelper": "UIHelper",
"../../../../Game/fromework/mvvm/modelView/ViewModel": "ViewModel",
"../../../../Game/fromework/net/NetHttp": "NetHttp",
"../../../component/pop/tipsHand": "tipsHand",
"../../../global/Global": "Global",
"../../../global/PopHelper": "PopHelper",
"../../Wallet/WalletHelper": "WalletHelper",
"./ChallengeModel": "ChallengeModel"
} ],
ChallengeModel: [ function(e, t, o) {
"use strict";
cc._RF.push(t, "0fa48eYjsBIAZ7HGhyqr+/O", "ChallengeModel");
Object.defineProperty(o, "__esModule", {
value: !0
});
o.ChallengeModel = void 0;
var n = e("../../../../Game/Script/global/GlobalValue"), a = e("../../../../Game/fromework/helper/EventHelper"), i = e("../../../../Game/fromework/mvvm/modelView/ViewModel"), r = e("../../../../Game/fromework/net/NetHttp"), l = e("../../../global/Global"), s = e("../../../global/PopHelper"), c = function() {
function e() {
this._challengeData = null;
}
Object.defineProperty(e, "Instance", {
get: function() {
e._instance || (e._instance = new e());
return e._instance;
},
enumerable: !1,
configurable: !0
});
Object.defineProperty(e.prototype, "uid", {
get: function() {
return i.VM.getValue("user.uid");
},
enumerable: !1,
configurable: !0
});
Object.defineProperty(e.prototype, "token", {
get: function() {
return i.VM.getValue("user.token");
},
enumerable: !1,
configurable: !0
});
Object.defineProperty(e.prototype, "challengeData", {
get: function() {
return this._challengeData;
},
enumerable: !1,
configurable: !0
});
e.prototype.Init = function() {
a.default.Instance.Net.bind("push_challenge_reach", this.challenge_reach, this);
};
e.prototype.clear = function() {
a.default.Instance.Net.unbind("push_challenge_reach", this.challenge_reach, this);
};
e.prototype.challenge_reach = function(e) {
var t = e.getUserData();
t && t.challenge_type && this.getChallengeInfo();
};
e.prototype.getChallengeInfo = function(e) {
var t = this;
r.default.Instance.get(n.default.getInstance().WalletUrl + "challengeInfo", {
player_index: this.uid,
token: this.token
}, function(o) {
var n = JSON.parse(o.response);
if (1 == n.code) {
t._challengeData = n.data;
a.default.Instance.Global.emit("referChallenge");
e && e(n.data);
}
}, !0);
};
e.prototype.sendReceiveChallenge = function(e, t) {
var o = this;
r.default.Instance.get(n.default.getInstance().WalletUrl + "receiveChallenge", {
player_index: this.uid,
token: this.token,
type: e
}, function(e) {
var n = JSON.parse(e.response);
if (1 == n.code) {
s.PopHelper.Instance.showReward(l.Global.Instance.changeReward({
1: n.data.amount
}), function() {
o.getChallengeInfo();
});
t && t(n.data);
} else if (33 == n.code) s.PopHelper.Instance.showTips("Operate too frequently!"); else if (1001 == n.code) s.PopHelper.Instance.showTips("Challenge not completed!"); else if (1002 == n.code) {
o.getChallengeInfo();
s.PopHelper.Instance.showTips("Challenge rewards have been claimed!");
}
}, !0);
};
e._instance = null;
return e;
}();
o.ChallengeModel = c;
cc._RF.pop();
}, {
"../../../../Game/Script/global/GlobalValue": "GlobalValue",
"../../../../Game/fromework/helper/EventHelper": "EventHelper",
"../../../../Game/fromework/mvvm/modelView/ViewModel": "ViewModel",
"../../../../Game/fromework/net/NetHttp": "NetHttp",
"../../../global/Global": "Global",
"../../../global/PopHelper": "PopHelper"
} ],
Character: [ function(e, t, o) {
"use strict";
cc._RF.push(t, "9ded5Tjg6hIc5sFnFv/C++B", "Character");
var n, a = this && this.__extends || (n = function(e, t) {
return (n = Object.setPrototypeOf || {
__proto__: []
} instanceof Array && function(e, t) {
e.__proto__ = t;
} || function(e, t) {
for (var o in t) Object.prototype.hasOwnProperty.call(t, o) && (e[o] = t[o]);
})(e, t);
}, function(e, t) {
n(e, t);
function o() {
this.constructor = e;
}
e.prototype = null === t ? Object.create(t) : (o.prototype = t.prototype, new o());
}), i = this && this.__decorate || function(e, t, o, n) {
var a, i = arguments.length, r = i < 3 ? t : null === n ? n = Object.getOwnPropertyDescriptor(t, o) : n;
if ("object" == typeof Reflect && "function" == typeof Reflect.decorate) r = Reflect.decorate(e, t, o, n); else for (var l = e.length - 1; l >= 0; l--) (a = e[l]) && (r = (i < 3 ? a(r) : i > 3 ? a(t, o, r) : a(t, o)) || r);
return i > 3 && r && Object.defineProperty(t, o, r), r;
};
Object.defineProperty(o, "__esModule", {
value: !0
});
var r = e("../../Game/fromework/global/Tools"), l = cc._decorator, s = l.ccclass, c = l.property, u = function(e) {
a(t, e);
function t() {
var t = null !== e && e.apply(this, arguments) || this;
t.Role = null;
t._isPlayKiss = !1;
t._isFirst = !0;
t._nextCount = 0;
return t;
}
t.prototype.onLoad = function() {
var e = this;
this.Role.setCompleteListener(function() {
e.checkAction();
});
this.randomNextCount();
this.Role.setAnimation(0, "animation_idol", !1);
};
t.prototype.onDestroy = function() {};
t.prototype.randomNextCount = function() {
if (this._isFirst) {
this._isFirst = !1;
this._nextCount = r.Tools.TNumber.randomNumber(0, 1);
} else this._nextCount = r.Tools.TNumber.randomNumber(5, 10);
};
t.prototype.checkAction = function() {
this._nextCount--;
this._isPlayKiss = !1;
if (this._nextCount <= 0) {
this._isPlayKiss = !0;
this.randomNextCount();
this.Role.setAnimation(0, "animation_role", !1);
} else this.Role.setAnimation(0, "animation_idol", !1);
};
t.prototype.onRoleClicked = function() {
if (!this._isPlayKiss) {
this._nextCount = 0;
this.checkAction();
}
};
i([ c(sp.Skeleton) ], t.prototype, "Role", void 0);
return i([ s ], t);
}(cc.Component);
o.default = u;
cc._RF.pop();
}, {
"../../Game/fromework/global/Tools": "Tools"
} ],
CheckTools: [ function(e, t, o) {
"use strict";
cc._RF.push(t, "15f4aWu7qVK36s6tGHD43cH", "CheckTools");
Object.defineProperty(o, "__esModule", {
value: !0
});
var n = e("../../../../../Game/fromework/global/Tools"), a = e("../GameHelper"), i = function() {
function e() {}
e.getRealScore = function(e) {
if (e.length <= 0) return 0;
var t = 0;
e.forEach(function(e) {
a.GroupHelper.isJoker(e) ? t += 0 : 1 == a.GroupHelper.getFigure(e) ? t += 10 : a.GroupHelper.getFigure(e) >= 10 ? t += 10 : t += a.GroupHelper.getFigure(e);
});
return t;
};
e.getRealPoints = function(e) {
if (e.length <= 0) return 0;
var t = 0;
e.forEach(function(e) {
a.GroupHelper.isJoker(e) ? t += 0 : 1 == a.GroupHelper.getFigure(e) ? t += 14 : t += a.GroupHelper.getFigure(e);
});
return t;
};
e.group = function(e) {
var t = [], o = new Map();
e.forEach(function(e) {
e.forEach(function(e) {
var t = a.GroupHelper.getPattern(e);
o.has(t) || o.set(t, []);
o.get(t).push(e);
});
});
o.forEach(function(e) {
e.sort(function(e, t) {
return e - t;
});
t.push(e);
});
t.sort(function(e, t) {
return a.GroupHelper.isJoker(e[0]) || a.GroupHelper.isJoker(t[0]) ? 1 : t[0] - e[0];
});
return t;
};
e.getXCards = function(e, t) {
for (var o = n.Tools.TArray.flatten(e), i = a.GroupHelper.getFigure(t), r = [], l = 0; l < o.length; l++) (a.GroupHelper.getFigure(o[l]) == i || a.GroupHelper.isJoker(o[l])) && r.push(o[l]);
return r;
};
e.deleteSame = function(e, t) {
if (t.length <= 0) return this.group(e);
var o = n.Tools.TArray.flatten(e), a = n.Tools.TArray.flatten(t), i = n.Tools.TArray.duplicate(o, a);
return this.group([ i ]);
};
e.checkoutSame = function(e, t, o) {
var n = e ? e.length : 0;
if (n < 1) return !1;
var a = 0, i = 1;
t.push(e[a]);
for (;i < n; ) {
e[a] == e[i] ? o.push(e[i]) : t.push(e[i]);
a = i;
i++;
}
return o.length > 0;
};
e.hasQKA = function(e) {
var t = !1, o = !1, n = !1, i = [];
e.forEach(function(e) {
if (1 == a.GroupHelper.getFigure(e)) {
i.push(e);
n = !0;
} else if (12 == a.GroupHelper.getFigure(e)) {
i.push(e);
t = !0;
} else if (13 == a.GroupHelper.getFigure(e)) {
i.push(e);
o = !0;
}
});
if (t && o && n) {
i.sort(function(e, t) {
return 1 == a.GroupHelper.getFigure(e) ? 1 : 1 == a.GroupHelper.getFigure(t) ? -1 : e - t;
});
return i;
}
return [];
};
e.hasMaxSequence = function(e) {
var t = !1, o = !1, n = !1, i = [];
e.forEach(function(e) {
var r = a.GroupHelper.getFigure(e);
if (1 == r) {
i.push(e);
n = !0;
} else if (12 == r) {
i.push(e);
t = !0;
} else if (13 == r) {
i.push(e);
o = !0;
}
});
if (t && o || o && n || t && n) {
i.sort(function(e, t) {
return 1 == a.GroupHelper.getFigure(e) ? 1 : 1 == a.GroupHelper.getFigure(t) ? -1 : e - t;
});
return i;
}
return [];
};
e.addXCardToSuit = function(e, t) {
if (e.length <= 0 || t.length <= 0) return -1;
if (e[0] - e[1] == -1) e.push(t.pop()); else if (e[0] - e[1] == -2) e.splice(1, 0, t.pop()); else if (e[0] % 16 == 13 && e[1] % 16 == 1) e.unshift(t.pop()); else {
if (e[0] % 16 != 12 || e[1] % 16 != 1) {
e.push(t.pop());
return 0;
}
e.splice(1, 0, t.pop());
}
return 1;
};
return e;
}();
o.default = i;
cc._RF.pop();
}, {
"../../../../../Game/fromework/global/Tools": "Tools",
"../GameHelper": "GameHelper"
} ],
ChipManagerGold: [ function(e, t, o) {
"use strict";
cc._RF.push(t, "359899atsBOmbOHHqPvjKDo", "ChipManagerGold");
var n, a = this && this.__extends || (n = function(e, t) {
return (n = Object.setPrototypeOf || {
__proto__: []
} instanceof Array && function(e, t) {
e.__proto__ = t;
} || function(e, t) {
for (var o in t) Object.prototype.hasOwnProperty.call(t, o) && (e[o] = t[o]);
})(e, t);
}, function(e, t) {
n(e, t);
function o() {
this.constructor = e;
}
e.prototype = null === t ? Object.create(t) : (o.prototype = t.prototype, new o());
}), i = this && this.__decorate || function(e, t, o, n) {
var a, i = arguments.length, r = i < 3 ? t : null === n ? n = Object.getOwnPropertyDescriptor(t, o) : n;
if ("object" == typeof Reflect && "function" == typeof Reflect.decorate) r = Reflect.decorate(e, t, o, n); else for (var l = e.length - 1; l >= 0; l--) (a = e[l]) && (r = (i < 3 ? a(r) : i > 3 ? a(t, o, r) : a(t, o)) || r);
return i > 3 && r && Object.defineProperty(t, o, r), r;
};
Object.defineProperty(o, "__esModule", {
value: !0
});
var r = e("../../../Game/client/global/enum/game/Const"), l = e("../../../Game/client/global/enum/game/Event"), s = e("../../../Game/fromework/global/CachePool"), c = e("../../../Game/fromework/helper/AudioHelper"), u = e("../../../Game/fromework/helper/EventHelper"), d = e("../Component/CompositeChipGold"), p = e("../Utils/CompositeConst"), h = e("../Utils/CompositeEvent"), f = e("../Utils/CompositeUtil"), _ = {
10: 2,
50: 5,
200: 7,
1e3: 9,
5e3: 12
}, m = [ 10, 50, 200, 1e3, 5e3 ], y = cc._decorator, g = y.ccclass, v = y.property, C = function(e) {
a(t, e);
function t() {
var t = null !== e && e.apply(this, arguments) || this;
t.ChipPrefab = null;
t.ChipsLayer = null;
t.Banker = null;
t._chips = new Map();
return t;
}
t.prototype._getHarvest = function(e, t) {
for (var o = 0, n = [ 5e3, 1e3, 200, 50, 10 ], a = 0; a < n.length; ) if (e - n[a] >= 0) {
e -= n[a];
o += _[n[a]] * (Math.sqrt(t - 1) + 1);
} else a++;
return o;
};
t.prototype._getDispense = function(e, t) {
return this._chips.get(e).length * Math.sqrt(t - 1);
};
t.prototype._init = function() {
for (var e = 0; e < 11; e++) this._chips.set(e, []);
};
t.prototype._onGameHide = function() {
this._clear();
this.unscheduleAllCallbacks();
};
t.prototype._addChip = function(e, t) {
this._chips.get(e).push(t);
};
t.prototype._clear = function() {
this._chips.forEach(function(e) {
e.forEach(function(e) {
if (e.isValid) {
e.stopAllActions();
s.CachePool.getInstance().pushObj(s.CacheType.BET_GOLD, e);
}
});
});
this._init();
};
t.prototype._refreshChips = function() {
var e = this;
this._clear();
var t = f.default.Game.Model;
if (2 == t.roomData.state || 3 == t.roomData.state) for (var o = t.roomBetRecord, n = function(t) {
var n = o[t];
n.detail.size > 0 && n.detail.forEach(function(o, n) {
for (var a = 0; a < o; a++) {
var i = null;
(i = s.CachePool.getInstance().getObj(s.CacheType.BET_GOLD, cc.instantiate(e.ChipPrefab))).getComponent(d.default).reset(n / 1e3, s.CacheType.BET_GOLD);
i.parent = e.ChipsLayer;
i.getComponent(d.default);
var r = f.default.getOddsManager().getPosInRect(t);
i.position = r;
i.angle = 360 * Math.random();
e._addChip(t, i);
}
});
}, a = 0; a < o.length; a++) n(a);
};
t.prototype._onGeneratorBet = function(e) {
var t = e.getUserData();
this._addChip(t.index, t.node);
};
t.prototype._onRecycling = function() {
var e = this, t = f.default.Game.Model.win_options, o = 0;
this._chips.forEach(function(n, a) {
for (var i = !1, r = 0; r < t.length; r++) a == t[r] && (i = !0);
if (!i) {
n.forEach(function(t) {
o++;
t.zIndex = 99;
t.getComponent(d.default).back(e.Banker.position, function() {}, s.CacheType.BET_GOLD);
});
e._chips.set(a, []);
}
});
o > 0 && c.default.Instance.playBundleEffect(r.BundleSoundPath.tp_chip_collect);
u.default.Instance.Global.emit(h.OddsEvent.ODDS_HIDE_WIN);
this.scheduleOnce(function() {
e && e.node && e.node.isValid && e._onDispense();
}, 1.2);
};
t.prototype._onDispense = function() {
var e = this, t = f.default.Game.Model.win_options, o = 0;
t.forEach(function(t) {
for (var n = e._getDispense(t, f.default.Game.Model.getOddsRate(t)), a = 0; a < n; a++) {
o++;
var i, r = null, l = 100 * Math.random();
i = l < 40 ? m[0] : l < 60 ? m[1] : l < 80 ? m[2] : l < 90 ? m[3] : m[4];
(r = s.CachePool.getInstance().getObj(s.CacheType.BET_GOLD, cc.instantiate(e.ChipPrefab))).getComponent(d.default).reset(i, s.CacheType.BET_GOLD);
r.parent = e.ChipsLayer;
r.angle = 360 * Math.random();
var c = f.default.getOddsManager().getPosInRect(t);
r.position = e.Banker.position;
e._addChip(t, r);
r.getComponent(d.default).throw(c);
}
});
o > 0 && c.default.Instance.playBundleEffect(r.BundleSoundPath.tp_chip_collect);
this.scheduleOnce(function() {
e && e.node && e.node.isValid && e._harvest();
}, 1);
};
t.prototype._harvest = function() {
var e = this, t = f.default.Game.Model, o = 0;
t.allUserData.forEach(function(n) {
var a = t.getWinFee(n.uid), i = f.default.getGeneratorIndex(n.uid), r = p.HeadPositions[i];
a.forEach(function(n, a) {
for (var i = e._getHarvest(n, t.getOddsRate(a)), l = e._chips.get(a), c = 0; c < i && c < l.length; c++) {
var u = l[c];
o++;
u.getComponent(d.default).back(r, null, s.CacheType.BET_GOLD);
l.splice(c, 1);
}
});
});
var n = p.HeadPositions[6];
this._chips.forEach(function(e) {
for (var t = 0; t < e.length; t++) {
o++;
e[t].getComponent(d.default).back(n, null, s.CacheType.BET_GOLD);
}
});
o > 0 && c.default.Instance.playBundleEffect(r.BundleSoundPath.tp_chip_collect);
this.scheduleOnce(function() {
e._clear();
t.declearData.user_data.forEach(function(e, o) {
if (null != e.win_fee && 0 != e.win_fee) {
var n = {
index: f.default.getGeneratorIndex(parseInt(o)),
money: e.win_fee,
total: e.total_fee
}, a = t.getUserData(o);
null != a && (a.total_fee = e.total_fee);
u.default.Instance.Global.emit(h.UserEvent.USER_WIN_MONEY, n);
}
});
if (t.declearData && t.declearData.other && t.declearData.other.win_fee) {
var o = {
index: 6,
money: t.declearData.other.win_fee,
total: 0
};
u.default.Instance.Global.emit(h.UserEvent.USER_WIN_MONEY, o);
}
"AndarBahar" != cc.director.getScene().name && "LuckyDice" != cc.director.getScene().name && "SevenUpDown" != cc.director.getScene().name || u.default.Instance.Global.emit("TREASURE_LIST_AB");
}, .5);
};
t.prototype._onReset = function() {
this.unscheduleAllCallbacks();
this._clear();
};
t.prototype.onEnable = function() {
u.default.Instance.Global.bind(h.CompositeGameEvent.GAME_RECONNECT, this._refreshChips, this);
u.default.Instance.Global.bind(h.ChipGeneratorEvent.GENERATOR_ADDCHIP, this._onGeneratorBet, this);
u.default.Instance.Global.bind(h.OddsEvent.ODDS_RECYCLING, this._onRecycling, this);
u.default.Instance.Global.bind(l.GameEvent.S2C_RESET, this._onReset, this);
};
t.prototype.onDisable = function() {
u.default.Instance.Global.unbind(h.CompositeGameEvent.GAME_RECONNECT, this._refreshChips, this);
u.default.Instance.Global.unbind(h.ChipGeneratorEvent.GENERATOR_ADDCHIP, this._onGeneratorBet, this);
u.default.Instance.Global.unbind(h.OddsEvent.ODDS_RECYCLING, this._onRecycling, this);
u.default.Instance.Global.unbind(l.GameEvent.S2C_RESET, this._onReset, this);
};
t.prototype.onLoad = function() {
this._init();
cc.game.on(cc.game.EVENT_HIDE, this._onGameHide, this);
};
t.prototype.onDestroy = function() {
this.unscheduleAllCallbacks();
};
i([ v(cc.Prefab) ], t.prototype, "ChipPrefab", void 0);
i([ v(cc.Node) ], t.prototype, "ChipsLayer", void 0);
i([ v(cc.Node) ], t.prototype, "Banker", void 0);
return i([ g ], t);
}(cc.Component);
o.default = C;
cc._RF.pop();
}, {
"../../../Game/client/global/enum/game/Const": "Const",
"../../../Game/client/global/enum/game/Event": "Event",
"../../../Game/fromework/global/CachePool": "CachePool",
"../../../Game/fromework/helper/AudioHelper": "AudioHelper",
"../../../Game/fromework/helper/EventHelper": "EventHelper",
"../Component/CompositeChipGold": "CompositeChipGold",
"../Utils/CompositeConst": "CompositeConst",
"../Utils/CompositeEvent": "CompositeEvent",
"../Utils/CompositeUtil": "CompositeUtil"
} ],
ChipManager: [ function(e, t, o) {
"use strict";
cc._RF.push(t, "d7878Pcgq1IBZa2NNE9YZ46", "ChipManager");
var n, a = this && this.__extends || (n = function(e, t) {
return (n = Object.setPrototypeOf || {
__proto__: []
} instanceof Array && function(e, t) {
e.__proto__ = t;
} || function(e, t) {
for (var o in t) Object.prototype.hasOwnProperty.call(t, o) && (e[o] = t[o]);
})(e, t);
}, function(e, t) {
n(e, t);
function o() {
this.constructor = e;
}
e.prototype = null === t ? Object.create(t) : (o.prototype = t.prototype, new o());
}), i = this && this.__decorate || function(e, t, o, n) {
var a, i = arguments.length, r = i < 3 ? t : null === n ? n = Object.getOwnPropertyDescriptor(t, o) : n;
if ("object" == typeof Reflect && "function" == typeof Reflect.decorate) r = Reflect.decorate(e, t, o, n); else for (var l = e.length - 1; l >= 0; l--) (a = e[l]) && (r = (i < 3 ? a(r) : i > 3 ? a(t, o, r) : a(t, o)) || r);
return i > 3 && r && Object.defineProperty(t, o, r), r;
};
Object.defineProperty(o, "__esModule", {
value: !0
});
o.ChipTime = void 0;
var r = e("../../../Game/client/global/enum/game/Const"), l = e("../../../Game/client/global/enum/game/Event"), s = e("../../../Game/fromework/helper/AudioHelper"), c = e("../../../Game/fromework/helper/EventHelper"), u = e("../../../platform/Platform"), d = e("../Component/CompositeChip"), p = e("../Utils/CompositeConst"), h = e("../Utils/CompositeEvent"), f = e("../Utils/CompositeUtil");
o.ChipTime = 2.7;
var _ = cc._decorator, m = _.ccclass, y = _.property, g = function(e) {
a(t, e);
function t() {
var t = null !== e && e.apply(this, arguments) || this;
t.ChipPrefab = null;
t.ChipsLayer = null;
t.Banker = null;
t._chips = new Map();
return t;
}
t.prototype._init = function() {
for (var e = 0; e < 11; e++) this._chips.set(e, []);
};
t.prototype._onGameHide = function() {
this._clear();
this.unscheduleAllCallbacks();
};
t.prototype._addChip = function(e, t) {
this._chips.get(e).push(t);
};
t.prototype._clear = function() {
this._chips.forEach(function(e) {
e.forEach(function(e) {
if (e.isValid) {
e.stopAllActions();
e.removeFromParent(!0);
}
});
});
this._init();
};
t.prototype._refreshChips = function() {
var e = this;
this._clear();
var t = f.default.Game.Model;
if (2 == t.roomData.state || 3 == t.roomData.state) for (var o = t.roomBetRecord, n = function(t) {
var n = o[t];
n.detail.size > 0 && n.detail.forEach(function(o, n) {
for (var a = 0; a < o; a++) {
var i = cc.instantiate(e.ChipPrefab);
i.parent = e.ChipsLayer;
i.getComponent(d.default).init(n / 1e3);
var r = f.default.getOddsManager().getPosInRect(t);
i.position = r;
i.angle = 360 * Math.random();
e._addChip(t, i);
}
});
}, a = 0; a < o.length; a++) n(a);
};
t.prototype._onGeneratorBet = function(e) {
var t = e.getUserData();
this._addChip(t.index, t.node);
};
t.prototype._onRecycling = function() {
var e = this, t = f.default.Game.Model.win_options, o = 0;
this._chips.forEach(function(n, a) {
for (var i = !1, r = 0; r < t.length; r++) a == t[r] && (i = !0);
if (!i) {
n.forEach(function(t) {
o++;
t.zIndex = 99;
t.getComponent(d.default).back(e.Banker.position);
});
e._chips.set(a, []);
}
});
o > 0 && s.default.Instance.playBundleEffect(r.BundleSoundPath.tp_chip_collect);
c.default.Instance.Global.emit(h.OddsEvent.ODDS_HIDE_WIN);
this.scheduleOnce(function() {
e && e.node && e.node.isValid && e._onDispense();
}, 1.2);
};
t.prototype._onDispense = function() {
var e = this, t = f.default.Game.Model.getCompensationCash(), o = 0;
t.forEach(function(t, n) {
for (var a = d.default.division(t), i = 0; i < a.length; i++) {
o++;
var r = cc.instantiate(e.ChipPrefab);
r.parent = e.ChipsLayer;
r.getComponent(d.default).init(a[i]);
r.angle = 360 * Math.random();
var l = f.default.getOddsManager().getPosInRect(n);
u.default.log(l);
r.position = e.Banker.position;
e._addChip(n, r);
r.getComponent(d.default).throw(l);
}
});
o > 0 && s.default.Instance.playBundleEffect(r.BundleSoundPath.tp_chip_collect);
this.scheduleOnce(function() {
e && e.node && e.node.isValid && e._harvest();
}, 1);
};
t.prototype._harvest = function() {
var e = this, t = f.default.Game.Model, o = 0;
t.allUserData.forEach(function(n) {
var a = t.getWinFee(n.uid), i = f.default.getGeneratorIndex(n.uid), r = p.HeadPositions[i];
a.forEach(function(t, n) {
for (var a = d.default.division(t), i = 0; i < a.length; i++) for (var l = e._chips.get(n), s = 0; s < l.length; s++) {
var c = l[s];
if (c.getComponent(d.default).value == a[i]) {
o++;
c.getComponent(d.default).back(r);
l.splice(s, 1);
break;
}
}
});
});
var n = p.HeadPositions[6];
this._chips.forEach(function(e) {
for (var t = 0; t < e.length; t++) {
o++;
e[t].getComponent(d.default).back(n);
}
});
o > 0 && s.default.Instance.playBundleEffect(r.BundleSoundPath.tp_chip_collect);
this.scheduleOnce(function() {
e._clear();
t.declearData.user_data.forEach(function(e, o) {
if (null != e.win_fee && 0 != e.win_fee) {
var n = {
index: f.default.getGeneratorIndex(parseInt(o)),
money: e.win_fee,
total: e.total_fee
}, a = t.getUserData(o);
null != a && (a.total_fee = e.total_fee);
c.default.Instance.Global.emit(h.UserEvent.USER_WIN_MONEY, n);
}
});
if (t.declearData && t.declearData.other && t.declearData.other.win_fee) {
var o = {
index: 6,
money: t.declearData.other.win_fee,
total: 0
};
c.default.Instance.Global.emit(h.UserEvent.USER_WIN_MONEY, o);
}
}, .5);
};
t.prototype._onReset = function() {
this.unscheduleAllCallbacks();
this._clear();
};
t.prototype.onEnable = function() {
c.default.Instance.Global.bind(h.CompositeGameEvent.GAME_RECONNECT, this._refreshChips, this);
c.default.Instance.Global.bind(h.ChipGeneratorEvent.GENERATOR_ADDCHIP, this._onGeneratorBet, this);
c.default.Instance.Global.bind(h.OddsEvent.ODDS_RECYCLING, this._onRecycling, this);
c.default.Instance.Global.bind(l.GameEvent.S2C_RESET, this._onReset, this);
};
t.prototype.onDisable = function() {
c.default.Instance.Global.unbind(h.CompositeGameEvent.GAME_RECONNECT, this._refreshChips, this);
c.default.Instance.Global.unbind(h.ChipGeneratorEvent.GENERATOR_ADDCHIP, this._onGeneratorBet, this);
c.default.Instance.Global.unbind(h.OddsEvent.ODDS_RECYCLING, this._onRecycling, this);
c.default.Instance.Global.unbind(l.GameEvent.S2C_RESET, this._onReset, this);
};
t.prototype.onLoad = function() {
this._init();
cc.game.on(cc.game.EVENT_HIDE, this._onGameHide, this);
};
t.prototype.onDestroy = function() {
this.unscheduleAllCallbacks();
};
i([ y(cc.Prefab) ], t.prototype, "ChipPrefab", void 0);
i([ y(cc.Node) ], t.prototype, "ChipsLayer", void 0);
i([ y(cc.Node) ], t.prototype, "Banker", void 0);
return i([ m ], t);
}(cc.Component);
o.default = g;
cc._RF.pop();
}, {
"../../../Game/client/global/enum/game/Const": "Const",
"../../../Game/client/global/enum/game/Event": "Event",
"../../../Game/fromework/helper/AudioHelper": "AudioHelper",
"../../../Game/fromework/helper/EventHelper": "EventHelper",
"../../../platform/Platform": "Platform",
"../Component/CompositeChip": "CompositeChip",
"../Utils/CompositeConst": "CompositeConst",
"../Utils/CompositeEvent": "CompositeEvent",
"../Utils/CompositeUtil": "CompositeUtil"
} ],
Chip: [ function(e, t, o) {
"use strict";
cc._RF.push(t, "0daae7e0UpGs5EubpUvRkgI", "Chip");
var n, a = this && this.__extends || (n = function(e, t) {
return (n = Object.setPrototypeOf || {
__proto__: []
} instanceof Array && function(e, t) {
e.__proto__ = t;
} || function(e, t) {
for (var o in t) Object.prototype.hasOwnProperty.call(t, o) && (e[o] = t[o]);
})(e, t);
}, function(e, t) {
n(e, t);
function o() {
this.constructor = e;
}
e.prototype = null === t ? Object.create(t) : (o.prototype = t.prototype, new o());
}), i = this && this.__decorate || function(e, t, o, n) {
var a, i = arguments.length, r = i < 3 ? t : null === n ? n = Object.getOwnPropertyDescriptor(t, o) : n;
if ("object" == typeof Reflect && "function" == typeof Reflect.decorate) r = Reflect.decorate(e, t, o, n); else for (var l = e.length - 1; l >= 0; l--) (a = e[l]) && (r = (i < 3 ? a(r) : i > 3 ? a(t, o, r) : a(t, o)) || r);
return i > 3 && r && Object.defineProperty(t, o, r), r;
};
Object.defineProperty(o, "__esModule", {
value: !0
});
var r = e("../../Game/fromework/global/Tools"), l = cc._decorator, s = l.ccclass, c = l.property, u = function(e) {
a(t, e);
function t() {
var t = null !== e && e.apply(this, arguments) || this;
t.Chap_0_0_1 = null;
t.Chap_0_1 = null;
t.Chap_0_5 = null;
t.Chap_1 = null;
t.Chap_5 = null;
t.Chap_10 = null;
t.Chap_50 = null;
t.Chap_100 = null;
t.Chap_500 = null;
t.Chap_1k = null;
t.Chap_5k = null;
t.Chap_10k = null;
t.Chap_Icon = null;
t._ChapSpriteMap = null;
t.num = 0;
t._scaleMin = .8;
t._angleMax = 40;
return t;
}
t.division = function(e) {
for (var t = [], o = [ 1e4, 5e3, 1e3, 500, 100, 50, 10, 5, 1, .5, .1, .01 ], n = 0; n < o.length; ) if (r.Tools.TFloat.sub(e, o[n]) >= 0) {
e = r.Tools.TFloat.sub(e, o[n]);
t.push(o[n]);
} else n++;
return t;
};
t.prototype.getTargetScale = function(e) {
var t = 1, o = 0;
if (e.y >= 160) {
t = this._scaleMin;
o = this._angleMax;
} else if (e.y <= -160) {
t = 1;
o = 0;
} else {
var n = (e.y - -160) / 320;
t = 1 - (1 - this._scaleMin) * n;
o = this._angleMax * n;
}
return {
scale: t,
angle: o
};
};
t.prototype.init = function(e) {
this.num = e;
this.Chap_Icon.spriteFrame = this._ChapSpriteMap.get(e);
};
t.prototype.throw = function(e, t) {
var o = r.Tools.TNumber.randomFloat(.3, .5), n = this.getTargetScale(e);
cc.tween(this.node).to(o, {
position: e,
scale: n.scale,
eulerAngles: cc.v3(n.angle, 0, 0)
}, {
easing: "quadOut"
}).call(function() {
t && t();
}).start();
};
t.prototype.throwAndRotate = function(e, t) {
var o = r.Tools.TNumber.randomFloat(.3, .5);
cc.tween(this.node).parallel(cc.tween(this.node).to(o, {
position: e
}, {
easing: "quadOut"
}).call(function() {
t && t();
}), cc.tween(this.node).by(o, {
angle: 360 * Math.random()
}, {
easing: "quadOut"
})).start();
};
t.prototype.onLoad = function() {
this._ChapSpriteMap = new Map([ [ .01, this.Chap_0_0_1 ], [ .1, this.Chap_0_1 ], [ .5, this.Chap_0_5 ], [ 1, this.Chap_1 ], [ 5, this.Chap_5 ], [ 10, this.Chap_10 ], [ 50, this.Chap_50 ], [ 100, this.Chap_100 ], [ 500, this.Chap_500 ], [ 1e3, this.Chap_1k ], [ 5e3, this.Chap_5k ], [ 1e4, this.Chap_10k ] ]);
};
t.prototype.start = function() {};
i([ c(cc.SpriteFrame) ], t.prototype, "Chap_0_0_1", void 0);
i([ c(cc.SpriteFrame) ], t.prototype, "Chap_0_1", void 0);
i([ c(cc.SpriteFrame) ], t.prototype, "Chap_0_5", void 0);
i([ c(cc.SpriteFrame) ], t.prototype, "Chap_1", void 0);
i([ c(cc.SpriteFrame) ], t.prototype, "Chap_5", void 0);
i([ c(cc.SpriteFrame) ], t.prototype, "Chap_10", void 0);
i([ c(cc.SpriteFrame) ], t.prototype, "Chap_50", void 0);
i([ c(cc.SpriteFrame) ], t.prototype, "Chap_100", void 0);
i([ c(cc.SpriteFrame) ], t.prototype, "Chap_500", void 0);
i([ c(cc.SpriteFrame) ], t.prototype, "Chap_1k", void 0);
i([ c(cc.SpriteFrame) ], t.prototype, "Chap_5k", void 0);
i([ c(cc.SpriteFrame) ], t.prototype, "Chap_10k", void 0);
i([ c(cc.Sprite) ], t.prototype, "Chap_Icon", void 0);
return i([ s ], t);
}(cc.Component);
o.default = u;
cc._RF.pop();
}, {
"../../Game/fromework/global/Tools": "Tools"
} ],
ChooseBetChip: [ function(e, t, o) {
"use strict";
cc._RF.push(t, "2a91dfboVdNdpynU48pM0WT", "ChooseBetChip");
var n, a = this && this.__extends || (n = function(e, t) {
return (n = Object.setPrototypeOf || {
__proto__: []
} instanceof Array && function(e, t) {
e.__proto__ = t;
} || function(e, t) {
for (var o in t) Object.prototype.hasOwnProperty.call(t, o) && (e[o] = t[o]);
})(e, t);
}, function(e, t) {
n(e, t);
function o() {
this.constructor = e;
}
e.prototype = null === t ? Object.create(t) : (o.prototype = t.prototype, new o());
}), i = this && this.__decorate || function(e, t, o, n) {
var a, i = arguments.length, r = i < 3 ? t : null === n ? n = Object.getOwnPropertyDescriptor(t, o) : n;
if ("object" == typeof Reflect && "function" == typeof Reflect.decorate) r = Reflect.decorate(e, t, o, n); else for (var l = e.length - 1; l >= 0; l--) (a = e[l]) && (r = (i < 3 ? a(r) : i > 3 ? a(t, o, r) : a(t, o)) || r);
return i > 3 && r && Object.defineProperty(t, o, r), r;
};
Object.defineProperty(o, "__esModule", {
value: !0
});
var r = e("../../../Game/fromework/helper/EventHelper"), l = e("../Utils/CompositeEvent"), s = cc.color(204, 204, 204, 255), c = cc.color(255, 255, 255, 255), u = cc._decorator, d = u.ccclass, p = u.property, h = function(e) {
a(t, e);
function t() {
var t = null !== e && e.apply(this, arguments) || this;
t.Light = null;
t.ChipValue = 0;
t.Chap_Icon = null;
return t;
}
t.prototype._init = function() {
this.Chap_Icon.node.color = s;
};
t.prototype._onBetChip = function(e) {
var t = e.getUserData(), o = this.Light.node.active, n = this.Light.node.active = t == this.ChipValue;
this.Chap_Icon.node.color = t == this.ChipValue ? c : s;
o && !n ? cc.tween(this.node).to(.05, {
y: 0
}).start() : n && !o && cc.tween(this.node).to(.05, {
y: 20
}).start();
};
t.prototype.onClick = function() {
r.default.Instance.Global.emit(l.BetChipEvent.BET_CHIP_CLICK, this.ChipValue);
};
t.prototype.onEnable = function() {
r.default.Instance.Global.bind(l.BetChipEvent.BET_CHIP_CLICK, this._onBetChip, this);
};
t.prototype.onDisable = function() {
r.default.Instance.Global.unbind(l.BetChipEvent.BET_CHIP_CLICK, this._onBetChip, this);
};
t.prototype.onLoad = function() {
this._init();
};
t.prototype.start = function() {};
i([ p(cc.Sprite) ], t.prototype, "Light", void 0);
i([ p ], t.prototype, "ChipValue", void 0);
i([ p(cc.Sprite) ], t.prototype, "Chap_Icon", void 0);
return i([ d ], t);
}(cc.Component);
o.default = h;
cc._RF.pop();
}, {
"../../../Game/fromework/helper/EventHelper": "EventHelper",
"../Utils/CompositeEvent": "CompositeEvent"
} ],
CloseDeck: [ function(e, t, o) {
"use strict";
cc._RF.push(t, "d4db63LwDJEYJKolw25JpDr", "CloseDeck");
var n, a = this && this.__extends || (n = function(e, t) {
return (n = Object.setPrototypeOf || {
__proto__: []
} instanceof Array && function(e, t) {
e.__proto__ = t;
} || function(e, t) {
for (var o in t) Object.prototype.hasOwnProperty.call(t, o) && (e[o] = t[o]);
})(e, t);
}, function(e, t) {
n(e, t);
function o() {
this.constructor = e;
}
e.prototype = null === t ? Object.create(t) : (o.prototype = t.prototype, new o());
}), i = this && this.__decorate || function(e, t, o, n) {
var a, i = arguments.length, r = i < 3 ? t : null === n ? n = Object.getOwnPropertyDescriptor(t, o) : n;
if ("object" == typeof Reflect && "function" == typeof Reflect.decorate) r = Reflect.decorate(e, t, o, n); else for (var l = e.length - 1; l >= 0; l--) (a = e[l]) && (r = (i < 3 ? a(r) : i > 3 ? a(t, o, r) : a(t, o)) || r);
return i > 3 && r && Object.defineProperty(t, o, r), r;
};
Object.defineProperty(o, "__esModule", {
value: !0
});
var r = e("../../../Game/client/global/enum/game/Const"), l = e("../../../Game/client/logic/game/GameHelper"), s = e("../../../Game/fromework/global/ResLoader"), c = e("../Card"), u = cc._decorator, d = u.ccclass, p = u.property, h = function(e) {
a(t, e);
function t() {
var t = null !== e && e.apply(this, arguments) || this;
t.show = null;
t.wildParent = null;
t.title = null;
t.back = null;
t.lightBorder = null;
t.drawActionNode = null;
t.wildCardTips = null;
t.CardParent = null;
t._tipsTimeId = -1;
return t;
}
t.prototype.reset = function() {
this.drawActionNode.stopAllActions();
this.drawActionNode.setPosition(cc.Vec2.ZERO);
this.drawActionNode.scale = r.DESK_CARD_SCALE;
this.drawActionNode.active = !1;
this.show.active = !1;
this.lightBorder.active = !1;
};
t.prototype.getWildCardPosInTarget = function(e) {
var t = this.wildParent.parent.convertToWorldSpaceAR(this.wildParent.getPosition());
t.x += 5;
t.y += 8;
return e.convertToNodeSpaceAR(t);
};
t.prototype.getCloseDeckPosInTarget = function(e) {
var t = this.node.parent.convertToWorldSpaceAR(this.node.getPosition());
return e.convertToNodeSpaceAR(t);
};
t.prototype.setSlotActive = function(e) {
this.show.active = e;
};
t.prototype.setLightBorderActive = function(e) {
this.lightBorder.active = e;
};
t.prototype.otherUserDrawCloseAction = function(e, t) {
var o = this;
this.drawActionNode.setPosition(cc.Vec2.ZERO);
this.drawActionNode.scale = r.DESK_CARD_SCALE;
this.drawActionNode.active = !0;
this.drawActionNode.opacity = 255;
var n = cc.sequence(cc.spawn(cc.moveTo(.2, e).easing(cc.easeCircleActionOut()), cc.scaleTo(.2, r.OTHER_CARD_SCALE)), cc.delayTime(.2), cc.fadeOut(.1), cc.callFunc(function() {
o.drawActionNode.setPosition(cc.Vec2.ZERO);
o.drawActionNode.scale = r.DESK_CARD_SCALE;
o.drawActionNode.active = !1;
t && t();
}));
this.drawActionNode.runAction(n);
};
t.prototype.setTipsCards = function(e) {
var t = this, o = l.GroupHelper.getFigure(e);
this.CardParent.destroyAllChildren();
s.default.Instance.loadBundleRes(r.BundleUIPath.Card, cc.Prefab, function(n, a) {
if (!n) for (var i = 0; i < 4; i++) {
var r = cc.instantiate(a);
r.parent = t.CardParent;
r.scale = .35;
r.setPosition(cc.v2(0, 0));
var s = r.getComponent(c.default), u = l.GroupHelper.getIdx16(i, o);
s.init(u, !0, e);
}
});
};
t.prototype.showWildTips = function() {};
t.prototype.hideWildTips = function() {
if (-1 != this._tipsTimeId) {
clearTimeout(this._tipsTimeId);
this._tipsTimeId = -1;
}
this.wildCardTips.active = !1;
};
i([ p(cc.Node) ], t.prototype, "show", void 0);
i([ p(cc.Node) ], t.prototype, "wildParent", void 0);
i([ p(cc.Label) ], t.prototype, "title", void 0);
i([ p(cc.Node) ], t.prototype, "back", void 0);
i([ p(cc.Node) ], t.prototype, "lightBorder", void 0);
i([ p(cc.Node) ], t.prototype, "drawActionNode", void 0);
i([ p(cc.Node) ], t.prototype, "wildCardTips", void 0);
i([ p(cc.Node) ], t.prototype, "CardParent", void 0);
return i([ d ], t);
}(cc.Component);
o.default = h;
cc._RF.pop();
}, {
"../../../Game/client/global/enum/game/Const": "Const",
"../../../Game/client/logic/game/GameHelper": "GameHelper",
"../../../Game/fromework/global/ResLoader": "ResLoader",
"../Card": "Card"
} ],
ColorAssembler2D: [ function(e, t, o) {
"use strict";
cc._RF.push(t, "8bbe2OXsi5AWo2GauwiJy1K", "ColorAssembler2D");
var n, a = this && this.__extends || (n = function(e, t) {
return (n = Object.setPrototypeOf || {
__proto__: []
} instanceof Array && function(e, t) {
e.__proto__ = t;
} || function(e, t) {
for (var o in t) Object.prototype.hasOwnProperty.call(t, o) && (e[o] = t[o]);
})(e, t);
}, function(e, t) {
n(e, t);
function o() {
this.constructor = e;
}
e.prototype = null === t ? Object.create(t) : (o.prototype = t.prototype, new o());
}), i = this && this.__decorate || function(e, t, o, n) {
var a, i = arguments.length, r = i < 3 ? t : null === n ? n = Object.getOwnPropertyDescriptor(t, o) : n;
if ("object" == typeof Reflect && "function" == typeof Reflect.decorate) r = Reflect.decorate(e, t, o, n); else for (var l = e.length - 1; l >= 0; l--) (a = e[l]) && (r = (i < 3 ? a(r) : i > 3 ? a(t, o, r) : a(t, o)) || r);
return i > 3 && r && Object.defineProperty(t, o, r), r;
};
Object.defineProperty(o, "__esModule", {
value: !0
});
var r = cc._decorator, l = r.ccclass, s = r.property, c = r.executeInEditMode, u = r.requireComponent, d = r.menu, p = function(e) {
a(t, e);
function t() {
var t = null !== e && e.apply(this, arguments) || this;
t._colors = [];
return t;
}
Object.defineProperty(t.prototype, "colors", {
get: function() {
return this._colors;
},
set: function(e) {
this._colors = e;
this._updateColors();
},
enumerable: !1,
configurable: !0
});
t.prototype.onEnable = function() {
cc.director.once(cc.Director.EVENT_AFTER_DRAW, this._updateColors, this);
};
t.prototype.onDisable = function() {
cc.director.off(cc.Director.EVENT_AFTER_DRAW, this._updateColors, this);
this.node._renderFlag |= cc.RenderFlow.FLAG_COLOR;
};
t.prototype._updateColors = function() {
var e = this.getComponent(cc.RenderComponent);
if (e) {
var t = e._assembler;
if (t instanceof cc.Assembler2D) {
var o = t._renderData.uintVDatas[0];
if (o) for (var n = this.node.color, a = t.floatsPerVert, i = 0, r = t.colorOffset, l = o.length; r < l; r += a) o[r] = (this.colors[i++] || n)._val;
}
}
};
i([ s ], t.prototype, "_colors", void 0);
i([ s({
type: [ cc.Color ]
}) ], t.prototype, "colors", null);
return i([ l, c, u(cc.RenderComponent), d("component/颜色渐变组件") ], t);
}(cc.Component);
o.default = p;
cc._RF.pop();
}, {} ],
CommonModel: [ function(e, t, o) {
"use strict";
cc._RF.push(t, "09d89fEGPxJJI4n6JNt9N9E", "CommonModel");
Object.defineProperty(o, "__esModule", {
value: !0
});
o.Common = o.Play = void 0;
var n = e("../../fromework/global/Tools"), a = e("../global/enum/game/Const"), i = e("../global/enum/game/Game"), r = function() {
function e(e) {
this.cls = 0;
this.currency = 0;
this.name = "";
this.free_limit = 0;
this.max = 0;
this.rate = 0;
this.base = 0;
this.min_entry = 0;
this.max_entry = 0;
this.playing = 0;
this.rtype = "";
this.is_hot = !1;
this.deals_round = 0;
this.deals_score = 0;
this.pool_score = 0;
this.chaal_limit = 0;
this.pot_limit = 0;
this.max_blind = 0;
this.max_bet = 0;
this.max_payout = 0;
e && this.refresh(e);
}
e.prototype.refresh = function(e) {
this.cls = parseInt(e.cls);
this.currency = parseInt(e.currency);
this.name = e.name;
this.max = parseInt(e.max);
this.free_limit = parseInt(e.free_limit || 0);
this.rate = parseInt(e.rate);
this.base = parseFloat(e.base);
this.playing = parseInt(e.playing);
this.rtype = e.rtype;
this.is_hot = !!e.is_hot && 1 == e.is_hot;
if (e.cls == i.GameEnum.PlayType.RUMMY_POOL) {
this.min_entry = e.base;
this.pool_score = parseInt(e.pool);
} else if (e.cls == i.GameEnum.PlayType.RUMMY_DEALS) {
this.min_entry = e.base;
this.deals_round = parseInt(e.round);
this.deals_score = parseInt(e.score);
} else if (e.cls == i.GameEnum.PlayType.RUMMY_POINTS || e.cls == i.GameEnum.PlayType.RUMMY_TENCARD) this.min_entry = e.rate * e.base; else if (i.GameEnum.isTeenpatti(e.cls)) {
this.min_entry = e.rate * e.base;
this.max_entry = null != e.entry_max_rate ? e.entry_max_rate * e.base : 0;
this.chaal_limit = e.rate * e.base;
this.pot_limit = e.max_rate * e.base;
this.max_blind = e.max_blind;
} else if (e.cls == i.GameEnum.PlayType.GAME_TRADITION_AB) {
this.min_entry = 0;
this.max_bet = e.max_bet;
this.max_payout = e.max_payout;
}
};
return e;
}();
o.Play = r;
(function(e) {
var t = function() {
function e(e) {
this.uid = 0;
this.name = "";
this.head_url = "";
this.sex = 1;
this.state = -1;
this.protect = 0;
this.score = 0;
this.tscore = 0;
this.res = 0;
this.split = 0;
this.rejoin = !1;
this.practice = 0;
this.draw = !1;
this.out_round = 0;
this.bonus = 0;
this.confirm_state = 0;
e && this.refresh(e);
}
e.prototype.refresh = function(e) {
this.uid = e.uid;
this.name = e.name;
this.head_url = e.head_url;
this.sex = e.sex;
this.state = e.state;
this.protect = e.protect;
this.score = e.score;
this.tscore = e.tscore;
this.res = e.res;
this.split = e.split;
this.rejoin = e.rejoin;
this.practice = e.practice;
this.draw = e.draw;
this.out_round = e.out_round ? e.out_round : 0;
this.bonus = e.bonus ? e.bonus : 0;
this.confirm_state = e.confirm_state ? e.confirm_state : 0;
};
return e;
}();
e.UserData = t;
var o = function() {
function e(e) {
this.rid = 0;
this.rtype = "";
this.curr = 0;
this.cstate = 0;
this.state = 0;
this.max = 0;
this.last = [];
this.xcard = 0;
this.realxcard = 0;
this.base = 0;
this.mcard = 0;
this.dl = 0;
this.act = 0;
this.order = [];
this.circle = 0;
this.duid = 0;
this.fcard = 0;
this.btime = 0;
this.round = 0;
this.bonus = 0;
this.split = !1;
this.ready_switch = !1;
e && this.refresh(e);
}
e.prototype.refresh = function(e) {
this.rid = e.rid;
this.rtype = e.rtype;
this.curr = e.curr;
this.cstate = e.cstate;
this.state = e.state;
this.max = e.max;
this.last = e.last;
this.xcard = 65 == e.xcard || 66 == e.xcard ? 1 : e.xcard;
this.realxcard = e.xcard;
this.base = e.base;
this.mcard = e.mcard;
this.dl = e.dl;
this.act = e.act;
this.order = e.order;
this.circle = e.circle;
this.duid = e.duid;
this.fcard = e.fcard;
this.btime = e.btime;
this.round = e.round;
this.bonus = e.bonus;
this.split = e.split;
this.ready_switch = null != e.ready_switch && 1 == e.ready_switch;
};
return e;
}();
e.RoomData = o;
var i = function() {
function e(e) {
this.curr = 0;
this.cstate = 0;
this.state = 0;
this.dl = 0;
this.order = [];
this.circle = 0;
this.last = [];
this.split = !1;
this.sim_time = 0;
e && this.refresh(e);
}
e.prototype.refresh = function(e) {
this.curr = e.curr ? e.curr : 0;
this.cstate = e.cstate ? e.cstate : 0;
this.state = e.state ? e.state : 0;
this.dl = e.dl ? e.dl : 0;
this.order = e.order ? e.order : [];
this.circle = e.circle ? e.circle : 0;
this.last = e.last ? e.last : [];
this.split = !!e.split && e.split;
this.sim_time = e.sim_time ? e.sim_time : 0;
};
return e;
}();
e.OptData = i;
var r = function() {
function e(e) {
this.rid = 0;
this.uid = 0;
this.dt = 0;
this.card = 0;
e && this.refresh(e);
}
e.prototype.refresh = function(e) {
this.rid = e.rid;
this.uid = e.uid;
this.dt = e.dt;
this.card = e.card;
};
return e;
}();
e.DrawData = r;
var l = function() {
function e(e) {
this.rid = 0;
this.uid = 0;
this.card = 0;
e && this.refresh(e);
}
e.prototype.refresh = function(e) {
this.rid = e.rid;
this.uid = e.uid;
this.card = e.card;
};
return e;
}();
e.DiscardData = l;
var s = function() {
function e(e) {
this.rid = 0;
this.uid = 0;
this.card = 0;
e && this.refresh(e);
}
e.prototype.refresh = function(e) {
this.rid = e.rid;
this.uid = e.uid;
this.card = e.card;
};
return e;
}();
e.FinishData = s;
var c = function() {
function e(e) {
this.cardDataMap = new Map();
this.userData = new d();
e && this.refresh(e);
}
e.prototype.refresh = function(e) {
var t = this;
Object.keys(e.user_card_data).forEach(function(o) {
t.cardDataMap.set(parseInt(o), e.user_card_data[o]);
});
this.userData.refresh(e.user_data);
};
e.prototype.getDeclearCards = function(e) {
return this.cardDataMap.has(e) ? this.cardDataMap.get(e) : [];
};
return e;
}();
e.DeclearData = c;
var u = function() {
function e(e) {
this.rid = 0;
this.uid = 0;
this.fcard = 0;
e && this.refresh(e);
}
e.prototype.refresh = function(e) {
this.rid = e.rid;
this.uid = e.uid;
this.fcard = e.fcard;
};
return e;
}();
e.DeclearFailData = u;
var d = function() {
function e(e) {
this.userMap = new Map();
this.kickList = null;
e && this.refresh(e);
}
e.prototype.refresh = function(e) {
var t = this, o = Object.keys(e);
this.userMap.forEach(function(e, n) {
o.indexOf(String(n)) < 0 && t.userMap.delete(n);
});
o.forEach(function(o) {
t.userMap.set(parseInt(o), e[o]);
});
};
e.prototype.refreshOptUser = function(e) {
this.userMap.has(e.uid) && this.userMap.set(e.uid, e);
};
e.prototype.filterLeaveUser = function(e) {
var t = this;
if (this.kickList) {
Object.keys(this.kickList).forEach(function(o) {
!t.userMap.has(parseInt(o)) || null != e && e == o || t.userMap.delete(parseInt(o));
});
this.kickList = null;
}
};
e.prototype.resetUserState = function() {
this.userMap.forEach(function(e) {
e.state = 1;
e.res = 0;
});
};
e.prototype.getUserData = function(e) {
return this.userMap.has(e) ? this.userMap.get(e) : null;
};
return e;
}();
e.AllUserData = d;
var p = function() {
function e(e) {
this.rid = 0;
this.uid = 0;
e && this.refresh(e);
}
e.prototype.refresh = function(e) {
this.rid = e.rid;
this.uid = e.uid;
};
return e;
}();
e.DropData = p;
var h = function() {
function e(e) {
this.rid = 0;
this.uid = 0;
e && this.refresh(e);
}
e.prototype.refresh = function(e) {
this.rid = e.rid;
this.uid = e.uid;
};
return e;
}();
e.LeaveData = h;
var f = function() {
function e(e) {
this.rid = 0;
this.uid = 0;
this.state = 0;
e && this.refresh(e);
}
e.prototype.refresh = function(e) {
this.rid = e.rid;
this.uid = e.uid;
this.state = e.state;
};
return e;
}();
e.DismissData = f;
var _ = function() {
this.card = 0;
this.isDraw = !1;
this.wildCard = 0;
}, m = function() {
function e(e) {
this.firstCard = 0;
this.firstDraw = !1;
this.records = new Map();
e && this.refresh(e);
}
e.prototype.refresh = function(e) {
var t = this;
this.records.clear();
Object.keys(e).forEach(function(o) {
var n = e[o];
if (0 == parseInt(o)) {
t.firstCard = parseInt(Object.keys(n)[0]);
t.firstDraw = n[t.firstCard];
} else {
var a = new Array();
Object.keys(n).forEach(function(e) {
var t = new _();
t.card = parseInt(e);
t.isDraw = n[e];
a.push(t);
});
t.records.set(parseInt(o), a);
}
});
};
e.prototype.onDraw = function(e, t) {
if (this.records.has(e)) {
var o = (n = this.records.get(e))[n.length - 1];
o && o.card == t && (o.isDraw = !0);
} else {
var n = new Array(), a = new _();
a.card = t;
a.isDraw = !0;
n.push(a);
this.records.set(e, n);
}
};
e.prototype.onDiscard = function(e, t) {
var o = null;
if (this.records.has(e)) o = this.records.get(e); else {
o = new Array();
this.records.set(e, o);
}
var n = new _();
n.card = t;
n.isDraw = !1;
o.push(n);
};
e.prototype.getRecords = function(e) {
var t = this.records.get(e);
return t ? t.concat() : [];
};
e.prototype.getDiscardCount = function() {
var e = 0;
this.records.forEach(function(t) {
e += t.length;
});
return e;
};
return e;
}();
e.RecordData = m;
e.ScoreItemData = function() {
this.wildCard = 0;
this.userName = "";
this.uid = 0;
this.isWinner = !1;
this.isSelf = !1;
this.res = 0;
this.countDown = 0;
this.gameScore = "";
this.totalScore = "";
this.declearCards = [];
this.maxCardCount = 0;
this.onDeclareTipsBtnClicked = null;
this.draw = !1;
this.maxScore = a.TOTAL_GAME_SCORE;
this.bonus = 0;
this.play = null;
this.confirm_state = 0;
};
var y = function() {
function e(e) {
this.subject = "";
this.uid = 0;
this.room_id = 0;
this.wallet_sn = "";
this.total = 0;
this.amount = 0;
this.currency = 0;
this.bonus = 0;
this.play = 0;
this.type = 0;
this.status = 0;
this.time = 0;
this.fail_message = "";
this.status_new = 0;
e && this.refresh(e);
}
e.prototype.refresh = function(e) {
this.subject = e.subject;
this.uid = e.uid;
this.room_id = e.room_id;
this.wallet_sn = e.wallet_sn;
this.total = null != e.total ? e.total : e.amount;
this.amount = e.amount;
this.currency = e.currency;
this.bonus = e.bonus;
this.play = e.play;
this.type = e.type;
this.status = e.status;
this.time = 1e3 * e.time;
this.fail_message = e.fail_message;
this.status_new = e.status_new;
};
return e;
}();
e.WalletRecentLog = y;
var g = function() {
function e(e) {
this.id = 0;
this.type = 0;
this.min_amount = 0;
this.max_amount = 0;
this.title = "";
this.subtitle = "";
this.des = "";
this.provision = "";
this.table = [];
this.now_time = 0;
this.end_time = 0;
this.red_dot_type = 0;
this.is_count_down = !1;
this.count_down = 0;
this.display_start_time = 0;
this.start_time = 0;
this.img = "";
e && this.refresh(e);
}
e.prototype.refresh = function(e) {
this.id = parseInt(e.id);
this.type = e.type || 0;
this.min_amount = parseFloat(e.min_amount);
this.max_amount = parseFloat(e.max_amount);
this.title = e.info.title;
this.subtitle = e.info.subtitle;
this.des = e.info.des;
this.provision = e.info.provision;
this.table = e.rules_show;
this.now_time = e.now_time;
this.end_time = e.end_time;
this.red_dot_type = null != e.red_dot_type ? e.red_dot_type : 0;
this.is_count_down = !!e.is_count_down && 1 == e.is_count_down;
this.count_down = e.count_down;
this.display_start_time = e.display_start_time;
this.start_time = e.start_time;
this.img = e.img;
};
return e;
}();
e.ActivityData = g;
var v = function() {
function e(e) {
this.name = "";
this.account = "";
this.ifsc = "";
this.createTime = 0;
this.beneId = 0;
this.states = 0;
this.email = "";
this.bank_name = "";
this.pan_no = "";
this.aadhaar = "";
e && this.refresh(e);
}
e.prototype.refresh = function(e) {
this.name = e.true_name;
this.account = e.bank_account;
this.ifsc = e.ifsc;
this.createTime = e.create_time;
this.beneId = e.bene_id;
this.states = e.states;
this.email = e.email || "";
this.bank_name = e.bank_name || "";
this.pan_no = e.pan_no || "";
this.aadhaar = e.aadhaar || "";
};
return e;
}();
e.BankData = v;
var C = function() {
function e(e) {
this.freeTotalAmt = 0;
this.withTotalAmt = 0;
this.totalWithLimt = 0;
this.totalFlow = 0;
this.remainingWithAmt = 0;
e && this.refresh(e);
}
e.prototype.refresh = function(e) {
this.freeTotalAmt = n.Tools.TNumber.num2single(e.freeTotalAmt);
this.withTotalAmt = n.Tools.TNumber.num2single(e.withTotalAmt);
this.totalWithLimt = n.Tools.TNumber.num2single(e.totalWithLimt);
this.totalFlow = n.Tools.TNumber.num2single(e.totalFlow);
this.remainingWithAmt = n.Tools.TNumber.num2single(e.remainingWithAmt);
};
return e;
}();
e.WithdrawLimitData = C;
var b = function() {
function e(e) {
this.key = 0;
this.title = "";
this.pic_url = "";
this.pic_jump_type = 0;
this.pic_jump_http_url = "";
this.start_time = 0;
this.end_time = 0;
this.active_type = 0;
this.active_order = 0;
this.red_dot = !1;
this.active_id = null;
this.stay_time = null;
this.pic_type = 0;
e && this.refresh(e);
}
e.prototype.refresh = function(e) {
this.key = e.key;
this.title = e.title;
this.pic_url = e.pic_url;
this.pic_jump_type = e.pic_jump_type;
this.pic_jump_http_url = e.pic_jump_http_url;
this.start_time = e.start_time;
this.end_time = e.end_time;
this.active_type = e.active_type;
this.active_order = e.active_order;
this.red_dot = !!e.red_dot && 1 == e.red_dot;
this.active_id = null != e.active_id ? e.active_id : null;
this.stay_time = null != e.stay_time ? e.stay_time : null;
this.pic_type = e.pic_type;
};
return e;
}();
e.NoticeData = b;
var I = function() {
function e(e) {
this.title = "";
this.bonus_all_amount_qf = 0;
this.bonus_pay_amount_qf = 0;
this.bonus_left_amount_qf = 0;
this.start_time = 0;
this.end_time = 0;
e && this.refresh(e);
}
e.prototype.refresh = function(e) {
this.title = e.title;
this.bonus_all_amount_qf = e.bonus_all_amount_qf;
this.bonus_pay_amount_qf = e.bonus_pay_amount_qf;
this.bonus_left_amount_qf = e.bonus_left_amount_qf;
this.start_time = e.start_time;
this.end_time = e.end_time;
};
return e;
}();
e.BonusRecordData = I;
var E = function() {
function e(e) {
this.head = [];
this.body = [];
this.foot = [];
e && this.refresh(e);
}
e.prototype.refresh = function(e) {
this.head = null != e.head ? e.head : [];
this.body = null != e.body ? e.body : [ [] ];
this.foot = null != e.foot ? e.foot : [];
};
return e;
}();
e.ScoreBoardData = E;
var S = function() {
function e(e) {
this.rejoin = 0;
this.uid = 0;
e && this.refresh(e);
}
e.prototype.refresh = function(e) {
this.rejoin = e.rejoin;
this.uid = e.uid;
};
return e;
}();
e.RejoinData = S;
var T = function() {
function e(e) {
this.uid = 0;
this.user_name = "";
this.score = 0;
this.drop = 0;
this.amount = 0;
this.origin_amount = 0;
this.accepted = 0;
e && this.refresh(e);
}
e.prototype.refresh = function(e) {
this.uid = e.uid;
this.user_name = e.user_name;
this.score = e.score;
this.drop = e.drop;
this.amount = e.amount;
this.origin_amount = e.origin_amount;
this.accepted = e.accepted;
};
return e;
}();
e.SplitData = T;
var R = function() {
function e(e) {
this.show = !1;
e && this.refresh(e);
}
e.prototype.refresh = function(e) {
this.web_url = e.web_url;
this.gate_url = e.gate_url;
this.gm_url = e.gm_url;
this.kefu_url = e.kefu_url;
this.app_version = parseInt(e.app_version);
this.hot_update_url = e.hot_update_url;
this.app_update_url = e.app_update_url;
this.update_switch = !!e.update_switch && 1 == e.update_switch;
this.func_level = e.func_level ? e.func_level : 0;
this.func_state = e.func_state ? e.func_state : 0;
this.guest_switch = null == e.guest_switch || 1 == e.guest_switch;
this.in_white_list = null != e.in_white_list && e.in_white_list;
this.gp_share_url = null != e.gp_share_url ? e.gp_share_url : "";
this.gp_share_tips = null != e.gp_share_tips ? e.gp_share_tips : "";
this.is_hot_update = !!e.is_hot_update && 1 == e.is_hot_update;
e.client_tips_config && (this.client_tips_config = e.client_tips_config);
if (null != e.store) {
this.show = !!e.store.show && 1 == e.store.show;
this.force = !!e.store.force && 1 == e.store.force;
this.tips = e.store.tips;
this.url = e.store.url;
}
};
return e;
}();
e.ServerConfig = R;
var O = function() {
function e(e) {
this.hot_update_url = "";
this.hot_update_type = 0;
this.reward = null;
this.notice_title = "";
this.notice_list = [];
e && this.refresh(e);
}
e.prototype.refresh = function(e) {
this.hot_update_url = e.hot_update_url;
this.hot_update_type = e.hot_update_type;
this.reward = e.reward;
this.notice_title = e.notice_title;
this.notice_list = e.notice_list;
};
return e;
}();
e.HotUpdateNotoceData = O;
var A = function() {
function e(e) {
this.id = 0;
this.amt = [];
this.condition = 0;
this.type = 0;
this.box_type = 0;
this.state = 0;
e && this.refresh(e);
}
e.prototype.refresh = function(e) {
this.id = e.id;
this.amt = e.amt;
this.condition = e.condition;
this.type = e.type;
this.box_type = e.box_type;
this.state = e.state;
};
return e;
}();
e.ReferBoxData = A;
var P = function() {
function e(e) {
this.invite_count = 0;
this.total_gain = 0;
this.reward_count = 0;
this.rate = 0;
this.invite_box = [];
e && this.refresh(e);
}
e.prototype.refresh = function(e) {
this.invite_count = e.invite_count || 0;
this.total_gain = null != e.total_gain ? n.Tools.TNumber.num2single(e.total_gain) : 0;
this.reward_count = null != e.reward_count ? n.Tools.TNumber.num2single(e.reward_count) : 0;
this.rate = e.rate || 0;
this.invite_box.length = 0;
if (null != e.invite_box && 0 != e.invite_box.length) for (var t = 0; t < e.invite_box.length; t++) {
var o = new A(e.invite_box[t]);
this.invite_box.push(o);
} else this.invite_box = [];
};
return e;
}();
e.ReferInviteData = P;
var M = function() {
function e(e) {
this.id = 0;
this.name = "";
this.last_rebate = 0;
this.total_revenue = 0;
this.state = 0;
this.bind_phone = !1;
this.match_count = 0;
this.match_max = 0;
e && this.refresh(e);
}
e.prototype.refresh = function(e) {
this.id = e.id || 0;
this.name = e.name || "";
this.last_rebate = e.last_rebate || 0;
this.total_revenue = null != e.total_revenue ? n.Tools.TNumber.num2single(e.total_revenue) : 0;
this.state = e.state || 0;
this.bind_phone = e.bind_phone;
this.match_count = e.match_count || 0;
this.match_max = e.match_max || 0;
};
return e;
}();
e.ReferListData = M;
var G = function() {
function e(e) {
this.level_list = [];
this.level = 1;
this.amount = 0;
e && this.refresh(e);
}
e.prototype.refresh = function(e) {
this.level_list.length = 0;
for (var t = 0; t < e.level_list.length; t++) {
var o = e.level_list[t];
this.level_list.push(o);
}
this.level = e.level;
this.amount = e.amount;
};
return e;
}();
e.ReferLevelData = G;
var w = function() {
function e(e) {
this.rule_id = 0;
this.is_signed = 0;
this.jar_type = 0;
this.prop_id = 0;
this.reward_type = 1;
this.currency = 0;
this.amount = "";
e && this.refresh(e);
}
e.prototype.refresh = function(e) {
this.rule_id = e.rule_id;
this.is_signed = e.is_signed;
this.jar_type = e.jar_type;
this.prop_id = e.prop_id || 0;
this.reward_type = e.reward_type || 1;
this.currency = e.currency;
this.amount = e.amount;
};
return e;
}();
e.SignData = w;
var D = function() {
function e(e) {
this.user_name = "";
this.tel_phone = "";
this.email = "";
this.preferred = 0;
this.info_switch = !0;
e && this.refresh(e);
}
e.prototype.refresh = function(e) {
this.user_name = e.user_name;
this.tel_phone = e.tel_phone;
this.email = e.email;
this.preferred = e.preinstall_amount ? parseInt(e.preinstall_amount) : 0;
this.info_switch = e.info_switch;
};
return e;
}();
e.RechargeUserInfo = D;
var L = function() {
function e(e) {
this.id = 0;
this.cost_type = 0;
this.cost_num = 0;
this.reward_type = 0;
this.reward_max = 0;
e && this.refresh(e);
}
e.prototype.refresh = function(e) {
this.id = e.id;
this.cost_type = e.cost_type;
this.cost_num = e.cost_num / 1e3;
this.reward_type = e.reward_type;
this.reward_max = e.reward_max / 1e3;
};
return e;
}();
e.LotteryData = L;
var B = function() {
function e(e) {
this.code = 0;
this.bonus = 0;
this.deposit = 0;
this.withdrawal = 0;
e && this.refresh(e);
}
e.prototype.refresh = function(e) {
this.code = e.code;
this.bonus = Math.floor(e.bonus / 1e3);
this.deposit = Math.floor(e.deposit / 1e3);
this.withdrawal = Math.floor(e.withdrawal / 1e3);
};
return e;
}();
e.LotteryResult = B;
var N = function() {
function e(e) {
this.id = 0;
this.name = "";
this.price = 0;
this.deposit = 0;
this.bonus = 0;
this.day_deposit = 0;
this.day_bonus = 0;
this.renew_num = 0;
this.channel = "";
this.vip = 0;
this.card_status = 0;
this.tag = 0;
this.end_date = "";
this.remaining_days = 0;
this.today_collection = 0;
this.day = 0;
this.day_need_flow = 0;
e && this.refresh(e);
}
e.prototype.refresh = function(e) {
this.id = e.id;
this.name = e.name;
this.price = e.price;
this.deposit = e.deposit;
this.bonus = e.bonus;
this.day_deposit = e.day_deposit;
this.day_bonus = e.day_bonus;
this.renew_num = e.renew_num;
this.channel = e.channel;
this.vip = e.vip;
this.card_status = e.card_status;
this.tag = e.tag;
this.end_date = e.end_date;
this.remaining_days = e.remaining_days;
this.today_collection = e.today_collection;
this.day = e.day;
this.day_need_flow = e.day_need_flow;
};
return e;
}();
e.MonthCard = N;
var k = function() {
function e(e) {
this.all_month_card = [];
this.close_not_get_deposit = 0;
this.close_not_get_bonus = 0;
this.yester_status = 0;
e && this.refresh(e);
}
e.prototype.refresh = function(e) {
var t, o = this;
this.all_month_card.splice(0);
null === (t = null == e ? void 0 : e.all_month_card) || void 0 === t || t.forEach(function(e) {
var t = new N(e);
o.all_month_card.push(t);
});
this.close_not_get_deposit = n.Tools.TNumber.num2single(e.close_not_get_deposit) || 0;
this.close_not_get_bonus = n.Tools.TNumber.num2single(e.close_not_get_bonus) || 0;
this.yester_status = e.yester_status;
};
return e;
}();
e.MonthCardAll = k;
var F = function() {
function e(e) {
this.withdraw_number = 0;
this.min_amount = 0;
this.extra_amount = 0;
this.extra_charge = 0;
this.refresh_time = 0;
e && this.refresh(e);
}
e.prototype.refresh = function(e) {
this.withdraw_number = e.withdraw_number;
this.min_amount = e.min_amount;
this.extra_amount = e.extra_amount;
this.extra_charge = e.extra_charge;
this.refresh_time = e.refresh_time;
};
return e;
}();
e.VIPWithdrawConfig = F;
var H = function() {
function e(e) {
this.level = 0;
this.exp = 0;
this.recharge_rate = 0;
this.discount_rate = 0;
this.withdraw_conf = null;
this.withdraw_conf = new F();
e && this.refresh(e);
}
e.prototype.refresh = function(e) {
this.level = e.level;
this.exp = e.exp;
this.recharge_rate = e.recharge_rate;
this.discount_rate = e.discount_rate;
this.withdraw_conf.refresh(e.withdraw_conf);
};
return e;
}();
e.VIPLevelConfig = H;
var U = function() {
function e(e) {
this.gift_id = 0;
this.vip = 0;
this.buy_lock = 0;
this.gift_pack_name = "";
this.give_bonus = 0;
this.give_deposit = 0;
this.give_withdraw = 0;
this.deposit = 0;
this.withdraw = 0;
e && this.refresh(e);
}
e.prototype.refresh = function(e) {
this.gift_id = e.gift_id;
this.vip = e.vip;
this.buy_lock = e.buy_lock;
this.gift_pack_name = e.gift_pack_name;
this.give_bonus = e.give_bonus;
this.give_deposit = e.give_deposit;
this.give_withdraw = e.give_withdraw;
this.deposit = e.deposit;
this.withdraw = e.withdraw;
};
return e;
}();
e.VIPShopGift = U;
var V = function() {
function e(e) {
this.extra_charge = 0;
this.with_min = 0;
this.max_amt = 0;
this.with_extra = 0;
this.with_num = 0;
this.extra_num = 0;
this.with_amt = [];
this.handling_fee_rate = 0;
this.min_handling_fee = 0;
e && this.refresh(e);
}
e.prototype.refresh = function(e) {
this.extra_charge = e.extra_charge;
this.with_min = e.with_min;
this.max_amt = e.max_amt;
this.with_extra = e.with_extra;
this.with_num = e.with_num;
this.extra_num = e.extra_num;
this.handling_fee_rate = e.handling_fee_rate;
this.min_handling_fee = e.min_handling_fee;
this.with_amt.splice(0);
this.with_amt = e.with_amt;
this.with_amt.sort(function(e, t) {
return t.amt - e.amt;
});
};
return e;
}();
e.VIPWithdrawRule = V;
var x = function() {
function e(e) {
this.amount = 0;
this.deposit = 0;
this.bonus = 0;
this.amount = 0;
this.deposit = 0;
this.bonus = 0;
e && this.refresh(e);
}
e.prototype.refresh = function(e) {
this.amount = e.amount;
this.deposit = e.deposit;
this.bonus = e.bonus;
};
return e;
}();
e.AddCashData = x;
var W = function() {
function e(e) {
this.id = "";
this.rid = 0;
this.rtype = "";
this.param = null;
e && this.refresh(e);
}
e.prototype.refresh = function(e) {
this.id = e.id;
this.rid = e.r;
this.rtype = e.rtype;
this.param = e.d;
};
return e;
}();
e.MarqueeData = W;
var j = function() {
function e(e) {
this.amount = 0;
this.bet = 0;
this.cls = 0;
this.cls_name = "";
this.name = "";
this.type = "";
e && this.refresh(e);
}
e.prototype.refresh = function(e) {
this.amount = e.amount;
this.bet = e.bet;
this.cls = e.cls;
this.cls_name = e.cls_name;
this.name = e.name;
this.type = e.type;
};
return e;
}();
e.GameHallMarqueeData = j;
var K = function() {
function e(e) {
this.type = 1;
this.msg = "";
this.iv_t = 0;
this.ed_t = 0;
e && this.refresh(e);
}
e.prototype.refresh = function(e) {
this.type = parseInt(e.type);
this.msg = e.msg;
this.iv_t = null != e.iv_t ? parseInt(e.iv_t) : 0;
this.ed_t = null != e.ed_t ? parseInt(e.ed_t) : 0;
};
return e;
}();
e.MarqueeNoticeData = K;
var Y = function() {
function e(e) {
this.rtype = 0;
this.type = 0;
this.num = 0;
e && this.refresh(e);
}
e.prototype.refresh = function(e) {
this.rtype = e.rtype;
this.type = e.type;
this.num = e.num;
};
return e;
}();
e.Reward = Y;
})(o.Common || (o.Common = {}));
cc._RF.pop();
}, {
"../../fromework/global/Tools": "Tools",
"../global/enum/game/Const": "Const",
"../global/enum/game/Game": "Game"
} ],
CompateAlert: [ function(e, t, o) {
"use strict";
cc._RF.push(t, "a928aWs+DFH3IA5780+Mu7p", "CompateAlert");
var n, a = this && this.__extends || (n = function(e, t) {
return (n = Object.setPrototypeOf || {
__proto__: []
} instanceof Array && function(e, t) {
e.__proto__ = t;
} || function(e, t) {
for (var o in t) Object.prototype.hasOwnProperty.call(t, o) && (e[o] = t[o]);
})(e, t);
}, function(e, t) {
n(e, t);
function o() {
this.constructor = e;
}
e.prototype = null === t ? Object.create(t) : (o.prototype = t.prototype, new o());
}), i = this && this.__decorate || function(e, t, o, n) {
var a, i = arguments.length, r = i < 3 ? t : null === n ? n = Object.getOwnPropertyDescriptor(t, o) : n;
if ("object" == typeof Reflect && "function" == typeof Reflect.decorate) r = Reflect.decorate(e, t, o, n); else for (var l = e.length - 1; l >= 0; l--) (a = e[l]) && (r = (i < 3 ? a(r) : i > 3 ? a(t, o, r) : a(t, o)) || r);
return i > 3 && r && Object.defineProperty(t, o, r), r;
};
Object.defineProperty(o, "__esModule", {
value: !0
});
var r = e("../../../../Game/client/global/enum/game/Event"), l = e("../../../../Game/client/logic/game/GameHelper"), s = e("../../../../Game/client/model/LanguageModel"), c = e("../../../../Game/fromework/helper/AudioHelper"), u = e("../../../../Game/fromework/helper/EventHelper"), d = e("../../../../Game/fromework/helper/UIHelper"), p = e("../../../../Game/fromework/mvvm/modelView/ViewModel"), h = e("../../component/PlayerHead_tp"), f = e("../../model/TeenPattiModel"), _ = cc._decorator, m = _.ccclass, y = _.property, g = function(e) {
a(t, e);
function t() {
var t = null !== e && e.apply(this, arguments) || this;
t.Panel = null;
t.Title = null;
t.Content = null;
t.Time = null;
t.PlayerHead = null;
t.LeftHeadParent = null;
t.RightHeadParent = null;
t._leftHead = null;
t._rightHead = null;
t._time = 0;
t._initiateData = null;
t._receiveData = null;
t._callFunc = null;
t._timeID = -1;
return t;
}
t.prototype.onLoad = function() {
u.default.Instance.Global.bind(r.TeenPattiEvent.TP_CLOSE_COMPATE, this.onCloseClicked, this);
};
t.prototype.onDestroy = function() {
u.default.Instance.Global.unbind(r.TeenPattiEvent.TP_CLOSE_COMPATE, this.onCloseClicked, this);
};
t.prototype.openAction = function() {
this.Panel.setPosition(cc.v2(0, this.node.height / 2 + this.Panel.height / 2));
this.Panel.runAction(cc.moveTo(.1, cc.v2(0, 0)));
};
t.prototype.closeAction = function(e) {
var t = this;
if (-1 != this._timeID) {
l.Countdown.deleta(this._timeID, !1);
this._timeID = -1;
}
this.Panel.runAction(cc.sequence(cc.moveTo(.1, cc.v2(0, -(this.node.height / 2 + this.Panel.height / 2))), cc.callFunc(function() {
e && e();
d.default.Instance.removeMaskLayer(t.node);
})));
};
t.prototype.onTimeComplete = function(e) {
var t = this;
this._timeID = -1;
e && this.closeAction(function() {
t._callFunc = null;
});
};
t.prototype.onTimeProgress = function(e) {
this.Time.string = "(" + e + "s)";
};
t.prototype.refreshView = function() {
f.TeenPattiModel.Instance || this.closeAction();
this._leftHead.isSelfHead = this._initiateData.uid == p.VM.getValue("user.uid");
this._leftHead.refresh(this._initiateData);
this._leftHead.setDSeat(!1);
this._leftHead.UserName.string = this._initiateData.name;
this._leftHead.CardParent.active = !1;
this._leftHead.WinNode.active = !1;
this._leftHead.SeenNode.active = !1;
this._leftHead.State.active = !1;
this._rightHead.isSelfHead = this._receiveData.uid == p.VM.getValue("user.uid");
this._rightHead.refresh(this._receiveData);
this._rightHead.setDSeat(!1);
this._rightHead.UserName.string = this._receiveData.name;
this._rightHead.CardParent.active = !1;
this._rightHead.WinNode.active = !1;
this._rightHead.SeenNode.active = !1;
this._rightHead.State.active = !1;
this.Title.string = s.default.getString("TP_BTN_SHOW");
this.Content.string = s.default.getString("TP_COMPATE_CONTENT");
this.Time.string = "(" + this._time + "s)";
this._time > 0 && -1 == this._timeID && (this._timeID = l.Countdown.creat(this._time, this.onTimeComplete, this.onTimeProgress, this));
};
t.prototype.InitView = function(e, t, o, n) {
this._time = e;
this._initiateData = t;
this._receiveData = o;
this._callFunc = n;
this.LeftHeadParent.destroyAllChildren();
var a = cc.instantiate(this.PlayerHead);
a.setPosition(cc.Vec2.ZERO);
a.parent = this.LeftHeadParent;
this._leftHead = a.getComponent(h.default);
this.RightHeadParent.destroyAllChildren();
var i = cc.instantiate(this.PlayerHead);
i.setPosition(cc.Vec2.ZERO);
i.parent = this.RightHeadParent;
this._rightHead = i.getComponent(h.default);
this.refreshView();
this.openAction();
};
t.prototype.onAcceptClicked = function() {
var e = this;
c.default.Instance.playBundleEffect("resources/sound/teenpatti/buttonSound/accept", !1, null, !1, !0);
this.closeAction(function() {
e._callFunc && e._callFunc(!0);
e._callFunc = null;
});
};
t.prototype.onCancelClicked = function() {
var e = this;
this.closeAction(function() {
e._callFunc && e._callFunc(!1);
e._callFunc = null;
});
};
t.prototype.onCloseClicked = function() {
this.closeAction();
};
i([ y(cc.Node) ], t.prototype, "Panel", void 0);
i([ y(cc.Label) ], t.prototype, "Title", void 0);
i([ y(cc.Label) ], t.prototype, "Content", void 0);
i([ y(cc.Label) ], t.prototype, "Time", void 0);
i([ y(cc.Prefab) ], t.prototype, "PlayerHead", void 0);
i([ y(cc.Node) ], t.prototype, "LeftHeadParent", void 0);
i([ y(cc.Node) ], t.prototype, "RightHeadParent", void 0);
return i([ m ], t);
}(cc.Component);
o.default = g;
cc._RF.pop();
}, {
"../../../../Game/client/global/enum/game/Event": "Event",
"../../../../Game/client/logic/game/GameHelper": "GameHelper",
"../../../../Game/client/model/LanguageModel": "LanguageModel",
"../../../../Game/fromework/helper/AudioHelper": "AudioHelper",
"../../../../Game/fromework/helper/EventHelper": "EventHelper",
"../../../../Game/fromework/helper/UIHelper": "UIHelper",
"../../../../Game/fromework/mvvm/modelView/ViewModel": "ViewModel",
"../../component/PlayerHead_tp": "PlayerHead_tp",
"../../model/TeenPattiModel": "TeenPattiModel"
} ],
CompositeCard: [ function(e, t, o) {
"use strict";
cc._RF.push(t, "fd0a3D3DtFC5acy8lA2FI82", "CompositeCard");
var n, a = this && this.__extends || (n = function(e, t) {
return (n = Object.setPrototypeOf || {
__proto__: []
} instanceof Array && function(e, t) {
e.__proto__ = t;
} || function(e, t) {
for (var o in t) Object.prototype.hasOwnProperty.call(t, o) && (e[o] = t[o]);
})(e, t);
}, function(e, t) {
n(e, t);
function o() {
this.constructor = e;
}
e.prototype = null === t ? Object.create(t) : (o.prototype = t.prototype, new o());
}), i = this && this.__decorate || function(e, t, o, n) {
var a, i = arguments.length, r = i < 3 ? t : null === n ? n = Object.getOwnPropertyDescriptor(t, o) : n;
if ("object" == typeof Reflect && "function" == typeof Reflect.decorate) r = Reflect.decorate(e, t, o, n); else for (var l = e.length - 1; l >= 0; l--) (a = e[l]) && (r = (i < 3 ? a(r) : i > 3 ? a(t, o, r) : a(t, o)) || r);
return i > 3 && r && Object.defineProperty(t, o, r), r;
};
Object.defineProperty(o, "__esModule", {
value: !0
});
var r = e("../../../Game/client/global/enum/game/Game"), l = e("../../../Game/client/logic/game/GameHelper"), s = cc._decorator, c = s.ccclass, u = s.property, d = function(e) {
a(t, e);
function t() {
var t = null !== e && e.apply(this, arguments) || this;
t.Front = null;
t.Pattern = null;
t.Figure = null;
t.Face = null;
t.Back = null;
t.LightBorder = null;
t.TranslucentMask = null;
t.Frame_Patterns = [];
t.Frame_Figures = [];
t.Frame_Faces = [];
t._open = !1;
t._idx16 = 0;
t._pattern = 0;
t._figure = 0;
return t;
}
Object.defineProperty(t.prototype, "open", {
get: function() {
return this._open;
},
set: function(e) {
this._open = e;
this._initSide();
},
enumerable: !1,
configurable: !0
});
Object.defineProperty(t.prototype, "pattern", {
get: function() {
return this._pattern;
},
enumerable: !1,
configurable: !0
});
Object.defineProperty(t.prototype, "figure", {
get: function() {
return this._figure;
},
enumerable: !1,
configurable: !0
});
Object.defineProperty(t.prototype, "idx16", {
get: function() {
return this._idx16;
},
enumerable: !1,
configurable: !0
});
Object.defineProperty(t.prototype, "box", {
get: function() {
return this && this.node ? this.node.getBoundingBoxToWorld() : new cc.Rect(0, 0, 0, 0);
},
enumerable: !1,
configurable: !0
});
t.prototype._getCardColor = function(e) {
return e == r.GameEnum.Pattern.Heart || e == r.GameEnum.Pattern.Diamond ? cc.color(218, 26, 26) : e == r.GameEnum.Pattern.Spade || e == r.GameEnum.Pattern.Club ? cc.color(0, 0, 0) : cc.color(218, 26, 26);
};
t.prototype._isJoker = function() {
return this.pattern == r.GameEnum.Pattern.BigJoker || this.pattern == r.GameEnum.Pattern.LittleJoker;
};
t.prototype.init = function(e, t) {
this._open = t;
this._idx16 = e;
this._pattern = l.GroupHelper.getPattern(e);
this._figure = l.GroupHelper.getFigure(e);
this._init();
};
t.prototype._init = function() {
this._initColor();
this._initPattern();
this._initFigure();
this._initFace();
this._initSide();
};
t.prototype._initColor = function() {
if (!this._isJoker()) {
var e = this._getCardColor(this.pattern);
this.Pattern.node.color = e;
this.Figure.node.color = e;
}
};
t.prototype._initPattern = function() {
if (this._isJoker()) this.Pattern.node.active = !1; else {
this.Pattern.node.active = !0;
this.Pattern.spriteFrame = this.Frame_Patterns[this.pattern];
}
};
t.prototype._initFigure = function() {
this._isJoker() ? this.Figure.spriteFrame = this.Frame_Figures[13] : this.Figure.spriteFrame = this.Frame_Figures[this.figure - 1];
};
t.prototype._initFace = function() {
this.figure > 10 && this.figure < 14 ? this.Face.spriteFrame = this.Frame_Faces[this.figure - 11] : this._isJoker() ? this.Face.spriteFrame = this.Frame_Patterns[4] : this.Face.spriteFrame = this.Frame_Patterns[this.pattern];
};
t.prototype._initSide = function() {
this.Front.active = this._open;
this.Back.node.active = !this._open;
};
t.prototype.showLightBorder = function(e) {
var t = this;
if (this && this.node && this.node.isValid) {
this.LightBorder.active = e;
this.LightBorder.opacity = 0;
var o = cc.tween(this.LightBorder).to(.5, {
opacity: 255
}).to(.5, {
opacity: 0
});
cc.tween(this.LightBorder).then(o).repeat(2).call(function() {
t.LightBorder.active = !1;
}).start();
}
};
t.prototype.showTranslucentMask = function(e) {
this && this.node && this.node.isValid && (this.TranslucentMask.active = e);
};
t.prototype.flipCard = function(e, t, o, n) {
var a = this;
void 0 === e && (e = .5);
void 0 === t && (t = cc.v3(0, -180, 0));
void 0 === o && (o = !1);
void 0 === n && (n = null);
if (this.node) if (0 == e) {
this.Front.active = !o;
this.Back.node.active = o;
this.Front.scaleX = -1;
this.node.setRotation(t.x, t.y, t.z);
n && n();
} else {
var i = cc.sequence(cc.spawn(cc.scaleTo(e / 2, this.node.scale), cc.rotate3DTo(e / 2, t.div(2))), cc.callFunc(function() {
a.Front.active = !o;
a.Back.node.active = o;
a.Front.scaleX = -1;
}), cc.spawn(cc.scaleTo(e / 2, this.node.scale), cc.rotate3DTo(e / 2, t)), cc.callFunc(function() {
null != n && n();
}));
this.node.runAction(i);
}
};
t.prototype.moveCard = function(e, t, o, n, a, i, r) {
void 0 === e && (e = .5);
void 0 === t && (t = cc.Vec2.ZERO);
void 0 === o && (o = 1);
void 0 === n && (n = 1);
void 0 === a && (a = null);
void 0 === i && (i = !0);
void 0 === r && (r = !0);
if (this.node) {
var l = [];
r ? l.push(cc.spawn(cc.moveTo(e, t).easing(cc.easeCircleActionOut()), cc.scaleTo(e, o, n))) : l.push(cc.spawn(cc.moveTo(e, t), cc.scaleTo(e, o, n)));
i && l.push(cc.rotateTo(.1, 0));
l.push(cc.callFunc(function() {
null != a && a();
}));
var s = cc.sequence(l);
this.node.runAction(s);
}
};
i([ u(cc.Node) ], t.prototype, "Front", void 0);
i([ u(cc.Sprite) ], t.prototype, "Pattern", void 0);
i([ u(cc.Sprite) ], t.prototype, "Figure", void 0);
i([ u(cc.Sprite) ], t.prototype, "Face", void 0);
i([ u(cc.Sprite) ], t.prototype, "Back", void 0);
i([ u(cc.Node) ], t.prototype, "LightBorder", void 0);
i([ u(cc.Node) ], t.prototype, "TranslucentMask", void 0);
i([ u([ cc.SpriteFrame ]) ], t.prototype, "Frame_Patterns", void 0);
i([ u([ cc.SpriteFrame ]) ], t.prototype, "Frame_Figures", void 0);
i([ u([ cc.SpriteFrame ]) ], t.prototype, "Frame_Faces", void 0);
return i([ c ], t);
}(cc.Component);
o.default = d;
cc._RF.pop();
}, {
"../../../Game/client/global/enum/game/Game": "Game",
"../../../Game/client/logic/game/GameHelper": "GameHelper"
} ],
CompositeChipGenerator: [ function(e, t, o) {
"use strict";
cc._RF.push(t, "d74b2gDC2JHJ6GQFZ+W0Opn", "CompositeChipGenerator");
var n, a = this && this.__extends || (n = function(e, t) {
return (n = Object.setPrototypeOf || {
__proto__: []
} instanceof Array && function(e, t) {
e.__proto__ = t;
} || function(e, t) {
for (var o in t) Object.prototype.hasOwnProperty.call(t, o) && (e[o] = t[o]);
})(e, t);
}, function(e, t) {
n(e, t);
function o() {
this.constructor = e;
}
e.prototype = null === t ? Object.create(t) : (o.prototype = t.prototype, new o());
}), i = this && this.__decorate || function(e, t, o, n) {
var a, i = arguments.length, r = i < 3 ? t : null === n ? n = Object.getOwnPropertyDescriptor(t, o) : n;
if ("object" == typeof Reflect && "function" == typeof Reflect.decorate) r = Reflect.decorate(e, t, o, n); else for (var l = e.length - 1; l >= 0; l--) (a = e[l]) && (r = (i < 3 ? a(r) : i > 3 ? a(t, o, r) : a(t, o)) || r);
return i > 3 && r && Object.defineProperty(t, o, r), r;
}, r = this && this.__awaiter || function(e, t, o, n) {
return new (o || (o = Promise))(function(a, i) {
function r(e) {
try {
s(n.next(e));
} catch (e) {
i(e);
}
}
function l(e) {
try {
s(n.throw(e));
} catch (e) {
i(e);
}
}
function s(e) {
e.done ? a(e.value) : (t = e.value, t instanceof o ? t : new o(function(e) {
e(t);
})).then(r, l);
var t;
}
s((n = n.apply(e, t || [])).next());
});
}, l = this && this.__generator || function(e, t) {
var o, n, a, i, r = {
label: 0,
sent: function() {
if (1 & a[0]) throw a[1];
return a[1];
},
trys: [],
ops: []
};
return i = {
next: l(0),
throw: l(1),
return: l(2)
}, "function" == typeof Symbol && (i[Symbol.iterator] = function() {
return this;
}), i;
function l(e) {
return function(t) {
return s([ e, t ]);
};
}
function s(i) {
if (o) throw new TypeError("Generator is already executing.");
for (;r; ) try {
if (o = 1, n && (a = 2 & i[0] ? n.return : i[0] ? n.throw || ((a = n.return) && a.call(n), 
0) : n.next) && !(a = a.call(n, i[1])).done) return a;
(n = 0, a) && (i = [ 2 & i[0], a.value ]);
switch (i[0]) {
case 0:
case 1:
a = i;
break;

case 4:
r.label++;
return {
value: i[1],
done: !1
};

case 5:
r.label++;
n = i[1];
i = [ 0 ];
continue;

case 7:
i = r.ops.pop();
r.trys.pop();
continue;

default:
if (!(a = r.trys, a = a.length > 0 && a[a.length - 1]) && (6 === i[0] || 2 === i[0])) {
r = 0;
continue;
}
if (3 === i[0] && (!a || i[1] > a[0] && i[1] < a[3])) {
r.label = i[1];
break;
}
if (6 === i[0] && r.label < a[1]) {
r.label = a[1];
a = i;
break;
}
if (a && r.label < a[2]) {
r.label = a[2];
r.ops.push(i);
break;
}
a[2] && r.ops.pop();
r.trys.pop();
continue;
}
i = t.call(e, r);
} catch (e) {
i = [ 6, e ];
n = 0;
} finally {
o = a = 0;
}
if (5 & i[0]) throw i[1];
return {
value: i[0] ? i[1] : void 0,
done: !0
};
}
};
Object.defineProperty(o, "__esModule", {
value: !0
});
o.GeneratorVector = void 0;
var s = e("../../../Game/fromework/global/CachePool"), c = e("../../../Game/fromework/helper/EventHelper"), u = e("../Utils/CompositeEvent"), d = e("../Utils/CompositeUtil"), p = e("./CompositeChipGold");
o.GeneratorVector = [ cc.v2(10, -10), cc.v2(-10, -10), cc.v2(10, 0), cc.v2(10, 10), cc.v2(-10, 0), cc.v2(-10, 10), cc.v2(10, 10), cc.v2(0, 10) ];
var h = cc._decorator, f = h.ccclass, _ = h.property, m = function(e) {
a(t, e);
function t() {
var t = null !== e && e.apply(this, arguments) || this;
t.ChitItem = null;
t.Target = null;
t.Frame = !0;
t.Duration = 8;
t.Index = 0;
return t;
}
t.prototype.init = function(e) {
this.Index = e;
};
t.prototype._tremble = function() {
cc.tween(this.Target).to(.05, {
x: o.GeneratorVector[this.Index].x,
y: o.GeneratorVector[this.Index].y
}).to(.05, {
x: 0,
y: 0
}).start();
};
t.prototype._chipIn = function(e, t, o) {
var n = s.CachePool.getInstance().getObj(s.CacheType.BET_GOLD, cc.instantiate(this.ChitItem));
n.getComponent(p.default).reset(e, s.CacheType.BET_GOLD);
var a = n.getComponent(p.default);
n.angle = 360 * Math.random();
n.parent = d.default.getChipLayer();
n.position = this.node.parent.convertToWorldSpaceAR(this.node.position).sub(cc.v3(cc.winSize.width / 2, cc.winSize.height / 2, 0));
a.throw(t);
c.default.Instance.Global.emit(u.ChipGeneratorEvent.GENERATOR_ADDCHIP, {
index: o,
node: n
});
};
t.prototype._getItemGenerator = function(e) {
var t;
return l(this, function(o) {
switch (o.label) {
case 0:
t = 0;
o.label = 1;

case 1:
return t < e.length ? [ 4, this._chipIn(e[t].value, e[t].dest, e[t].index) ] : [ 3, 4 ];

case 2:
o.sent();
o.label = 3;

case 3:
++t;
return [ 3, 1 ];

case 4:
return [ 2 ];
}
});
};
t.prototype.executePreFrame = function(e, t) {
var o = this;
return new Promise(function(n) {
var a = e, i = function() {
for (var e = new Date().getTime(), r = a.next(); ;r = a.next()) {
if (null == r || r.done) {
n(null);
return;
}
if (new Date().getTime() - e > t) {
o.scheduleOnce(function() {
i();
});
return;
}
}
};
i();
});
};
t.prototype._doChipInAsync = function(e) {
return r(this, void 0, void 0, function() {
return l(this, function(t) {
switch (t.label) {
case 0:
return [ 4, this.executePreFrame(this._getItemGenerator(e), this.Duration) ];

case 1:
t.sent();
return [ 2 ];
}
});
});
};
t.prototype._doChipIn = function(e) {
var t = this;
e.forEach(function(e) {
t._chipIn(e.value, e.dest, e.index);
});
};
t.prototype.doChipIn = function(e) {
if (!(e.length <= 0)) {
this._tremble();
this.Frame ? this._doChipInAsync(e) : this._doChipIn(e);
}
};
t.prototype._onGeneratorBet = function(e) {
var t = e.getUserData();
t.index == this.Index && this.doChipIn(t.betData);
};
t.prototype.onEnable = function() {
c.default.Instance.Global.bind(u.ChipGeneratorEvent.GENERATOR_BET, this._onGeneratorBet, this);
};
t.prototype.onDisable = function() {
c.default.Instance.Global.unbind(u.ChipGeneratorEvent.GENERATOR_BET, this._onGeneratorBet, this);
};
t.prototype.onLoad = function() {};
t.prototype.start = function() {};
i([ _(cc.Prefab) ], t.prototype, "ChitItem", void 0);
i([ _(cc.Node) ], t.prototype, "Target", void 0);
i([ _({
tooltip: "是否分帧加载"
}) ], t.prototype, "Frame", void 0);
i([ _({
tooltip: "分配给每帧的时间，单位毫秒，仅在开启分帧加载时有用",
visible: function() {
return 0 != this.Frame;
}
}) ], t.prototype, "Duration", void 0);
i([ _ ], t.prototype, "Index", void 0);
return i([ f ], t);
}(cc.Component);
o.default = m;
cc._RF.pop();
}, {
"../../../Game/fromework/global/CachePool": "CachePool",
"../../../Game/fromework/helper/EventHelper": "EventHelper",
"../Utils/CompositeEvent": "CompositeEvent",
"../Utils/CompositeUtil": "CompositeUtil",
"./CompositeChipGold": "CompositeChipGold"
} ],
CompositeChipGold: [ function(e, t, o) {
"use strict";
cc._RF.push(t, "e2c2bsTlZ5N46kV2W44cP9J", "CompositeChipGold");
var n, a = this && this.__extends || (n = function(e, t) {
return (n = Object.setPrototypeOf || {
__proto__: []
} instanceof Array && function(e, t) {
e.__proto__ = t;
} || function(e, t) {
for (var o in t) Object.prototype.hasOwnProperty.call(t, o) && (e[o] = t[o]);
})(e, t);
}, function(e, t) {
n(e, t);
function o() {
this.constructor = e;
}
e.prototype = null === t ? Object.create(t) : (o.prototype = t.prototype, new o());
}), i = this && this.__decorate || function(e, t, o, n) {
var a, i = arguments.length, r = i < 3 ? t : null === n ? n = Object.getOwnPropertyDescriptor(t, o) : n;
if ("object" == typeof Reflect && "function" == typeof Reflect.decorate) r = Reflect.decorate(e, t, o, n); else for (var l = e.length - 1; l >= 0; l--) (a = e[l]) && (r = (i < 3 ? a(r) : i > 3 ? a(t, o, r) : a(t, o)) || r);
return i > 3 && r && Object.defineProperty(t, o, r), r;
};
Object.defineProperty(o, "__esModule", {
value: !0
});
var r = e("../../../Game/fromework/global/CachePool"), l = e("../../../Game/fromework/global/ResLoader"), s = e("../../../Game/fromework/global/Tools"), c = e("../../../platform/Platform"), u = cc._decorator, d = u.ccclass, p = (u.property, 
function(e) {
a(t, e);
function t() {
return null !== e && e.apply(this, arguments) || this;
}
t.prototype.throw = function(e, t) {
var o = s.Tools.TNumber.randomFloat(.3, .5);
e.sub(this.node.position).mag();
cc.tween(this.node).to(o, {
position: e
}, {
easing: "quadOut"
}).call(function() {
t && t();
}).start();
};
t.prototype.back = function(e, t, o) {
var n = this, a = s.Tools.TNumber.randomFloat(.3, .5);
cc.tween(this.node).to(a, {
position: e
}, {
easing: "quadOut"
}).call(function() {
t && t();
o && r.CachePool.getInstance().pushObj(o, n.node);
}).start();
};
t.prototype.onLoad = function() {};
t.prototype.start = function() {};
t.prototype.reset = function(e, t) {
var o = this;
if (t == r.CacheType.BET_GOLD) {
var n = "Texture/Composite/Common/Chip/MultipleGame_" + e;
l.default.Instance.loadBundleRes(n, cc.SpriteFrame, function(t, a) {
if (t) c.default.log("Chip " + e + " load item image " + n + " failed"); else if (o.node && o.node.getComponent(cc.Sprite) && o.node.isValid) {
o.node.getComponent(cc.Sprite).spriteFrame = a;
o.node.getComponent(cc.Sprite).sizeMode = cc.Sprite.SizeMode.RAW;
}
});
} else {
var a = "Texture/Composite/Common/Chip/chouma" + e;
l.default.Instance.loadBundleRes(a, cc.SpriteFrame, function(t, n) {
if (t) c.default.log("Chip " + e + " load item image " + a + " failed"); else if (o.node && o.node.getComponent(cc.Sprite) && o.node.isValid) {
o.node.getComponent(cc.Sprite).spriteFrame = n;
o.node.getComponent(cc.Sprite).sizeMode = cc.Sprite.SizeMode.RAW;
}
});
}
};
return i([ d ], t);
}(cc.Component));
o.default = p;
cc._RF.pop();
}, {
"../../../Game/fromework/global/CachePool": "CachePool",
"../../../Game/fromework/global/ResLoader": "ResLoader",
"../../../Game/fromework/global/Tools": "Tools",
"../../../platform/Platform": "Platform"
} ],
CompositeChip: [ function(e, t, o) {
"use strict";
cc._RF.push(t, "a098d3buQNEhYDXkhJtbla2", "CompositeChip");
var n, a = this && this.__extends || (n = function(e, t) {
return (n = Object.setPrototypeOf || {
__proto__: []
} instanceof Array && function(e, t) {
e.__proto__ = t;
} || function(e, t) {
for (var o in t) Object.prototype.hasOwnProperty.call(t, o) && (e[o] = t[o]);
})(e, t);
}, function(e, t) {
n(e, t);
function o() {
this.constructor = e;
}
e.prototype = null === t ? Object.create(t) : (o.prototype = t.prototype, new o());
}), i = this && this.__decorate || function(e, t, o, n) {
var a, i = arguments.length, r = i < 3 ? t : null === n ? n = Object.getOwnPropertyDescriptor(t, o) : n;
if ("object" == typeof Reflect && "function" == typeof Reflect.decorate) r = Reflect.decorate(e, t, o, n); else for (var l = e.length - 1; l >= 0; l--) (a = e[l]) && (r = (i < 3 ? a(r) : i > 3 ? a(t, o, r) : a(t, o)) || r);
return i > 3 && r && Object.defineProperty(t, o, r), r;
};
Object.defineProperty(o, "__esModule", {
value: !0
});
var r = e("../../../Game/fromework/global/Tools"), l = cc._decorator, s = l.ccclass, c = l.property, u = function(e) {
a(t, e);
function t() {
var t = null !== e && e.apply(this, arguments) || this;
t.Chap_Icon = null;
t.Chap_10 = null;
t.Chap_50 = null;
t.Chap_200 = null;
t.Chap_1k = null;
t.Chap_5k = null;
t._ChapSpriteMap = null;
t._value = 0;
return t;
}
Object.defineProperty(t.prototype, "value", {
get: function() {
return this._value;
},
enumerable: !1,
configurable: !0
});
t.division = function(e) {
var t = [], o = [ 5e3, 1e3, 200, 50, 10 ], n = 0;
e % o[o.length - 1] != 0 && t.push(o[o.length - 1]);
for (;n < o.length; ) if (e - o[n] >= 0) {
e -= o[n];
t.push(o[n]);
} else n++;
return t;
};
t.prototype.init = function(e) {
this.Chap_Icon.spriteFrame = this._ChapSpriteMap.get(1e3 * e);
this._value = e;
};
t.prototype.throw = function(e, t) {
var o = r.Tools.TNumber.randomFloat(.45, .6);
e.sub(this.node.position).mag();
cc.tween(this.node).parallel(cc.tween(this.node).to(o, {
position: e
}, {
easing: "quadOut"
}).call(function() {
t && t();
})).start();
};
t.prototype.back = function(e, t) {
var o = r.Tools.TNumber.randomFloat(.45, .6);
cc.tween(this.node).to(o, {
position: e
}).call(function() {
t && t();
}).removeSelf().start();
};
t.prototype.onLoad = function() {
this._ChapSpriteMap = new Map([ [ 1e4, this.Chap_10 ], [ 5e4, this.Chap_50 ], [ 2e5, this.Chap_200 ], [ 1e6, this.Chap_1k ], [ 5e6, this.Chap_5k ] ]);
};
t.prototype.start = function() {};
i([ c(cc.Sprite) ], t.prototype, "Chap_Icon", void 0);
i([ c(cc.SpriteFrame) ], t.prototype, "Chap_10", void 0);
i([ c(cc.SpriteFrame) ], t.prototype, "Chap_50", void 0);
i([ c(cc.SpriteFrame) ], t.prototype, "Chap_200", void 0);
i([ c(cc.SpriteFrame) ], t.prototype, "Chap_1k", void 0);
i([ c(cc.SpriteFrame) ], t.prototype, "Chap_5k", void 0);
return i([ s ], t);
}(cc.Component);
o.default = u;
cc._RF.pop();
}, {
"../../../Game/fromework/global/Tools": "Tools"
} ],
CompositeConst: [ function(e, t, o) {
"use strict";
cc._RF.push(t, "0e7d6hoCFdBWJJZwIKuDK0N", "CompositeConst");
Object.defineProperty(o, "__esModule", {
value: !0
});
o.OddsComponentData = o.OddsPosition = o.UI_SELFHEAD_BG_PATH = o.UI_BOTTOM_BG_PATH = o.UI_BG_TEXTURE_PATH = o.ODDS_TITLE_ROULETTE = o.ODDS_TITLE_TPW = o.ODDS_TITLE_SUD = o.ODDS_TITLE_DT = o.ODDS_TITLE_LD = o.ODDS_TITLE_RB = o.ODDS_TITLE_AB = o.ODDS_TITLE_PATH = o.ODDS_TEXTURE_PATH = o.TraditionHeadPosition = o.HeadPositions = o.PlayMethod = o.COMPOSITE_MIN_RECHARGE = o.TRADITION_PLAYER_SELF = o.ODDS_LUCKYDICE_OFFSET = o.ODDS_CHIP_OFFSET = o.ODDS_TOP_OFFSET = o.OTHER_MEMBER_PAGE_NUM = o.PLAYER_INDEX_SELF = o.PLAYER_INDEX_OTHERS = o.PLAYER_INDEX_RANDOM2 = o.PLAYER_INDEX_RANDOM1 = o.PLAYER_INDEX_MONEY2 = o.PLAYER_INDEX_MONEY1 = o.PLAYER_INDEX_LUCKY = o.PLAYER_INDEX_BIGWINNER = o.PLAYER_TYPE_RANDOM = o.PLAYER_TYPE_MONEY = o.PLAYER_TYPE_LUCKY = o.PLAYER_TYPE_BIGWINNER = void 0;
o.PLAYER_TYPE_BIGWINNER = 1;
o.PLAYER_TYPE_LUCKY = 2;
o.PLAYER_TYPE_MONEY = 3;
o.PLAYER_TYPE_RANDOM = 4;
o.PLAYER_INDEX_BIGWINNER = 0;
o.PLAYER_INDEX_LUCKY = 1;
o.PLAYER_INDEX_MONEY1 = 2;
o.PLAYER_INDEX_MONEY2 = 3;
o.PLAYER_INDEX_RANDOM1 = 4;
o.PLAYER_INDEX_RANDOM2 = 5;
o.PLAYER_INDEX_OTHERS = 6;
o.PLAYER_INDEX_SELF = 7;
o.OTHER_MEMBER_PAGE_NUM = 14;
o.ODDS_TOP_OFFSET = 40;
o.ODDS_CHIP_OFFSET = 15;
o.ODDS_LUCKYDICE_OFFSET = 40;
o.TRADITION_PLAYER_SELF = 7;
o.COMPOSITE_MIN_RECHARGE = 10;
o.PlayMethod = cc.Enum({
AndarBahar: 0,
RedAndBlack: 1,
LuckyDice: 2,
DragonVSTiger: 3,
SevenUpDown: 4,
TraditionAndarBahar: 5,
TPWar: 6,
Roulette: 7
});
o.HeadPositions = [ cc.v3(-600, 145, 0), cc.v3(600, 145, 0), cc.v3(-600, -5, 0), cc.v3(-600, -155, 0), cc.v3(600, -5, 0), cc.v3(600, -155, 0), cc.v3(-597, -315, 0), cc.v3(-370, -315, 0) ];
o.TraditionHeadPosition = [ cc.v3(-540, -60, 0), cc.v3(-285, -160, 0), cc.v3(285, -160, 0), cc.v3(540, -60, 0), cc.v3(0, -180, 0), cc.v3(-600, -200, 0) ];
o.ODDS_TEXTURE_PATH = "resources/Texture/Composite/Odds/";
o.ODDS_TITLE_PATH = "composite_odds_title_";
o.ODDS_TITLE_AB = "ab_";
o.ODDS_TITLE_RB = "rb_";
o.ODDS_TITLE_LD = "ld_";
o.ODDS_TITLE_DT = "dt_";
o.ODDS_TITLE_SUD = "sud_";
o.ODDS_TITLE_TPW = "tpw_";
o.ODDS_TITLE_ROULETTE = "roulette_";
o.UI_BG_TEXTURE_PATH = "resources/Texture/Composite/BG/";
o.UI_BOTTOM_BG_PATH = "composite_ui_bottom_bg";
o.UI_SELFHEAD_BG_PATH = "composite_ui_head_self_bg";
o.OddsPosition = [ [ cc.v3(-278, 90, 0), cc.v3(278, 90, 0), cc.v3(-379.5, -50, 0), cc.v3(-126.5, -50, 0), cc.v3(126.5, -50, 0), cc.v3(379.5, -50, 0), cc.v3(-379.5, -168, 0), cc.v3(-126.5, -168, 0), cc.v3(126.5, -168, 0), cc.v3(379.5, -168, 0) ], [ cc.v3(-329, 175, 0), cc.v3(0, 175, 0), cc.v3(329, 175, 0), cc.v3(-427.5, 15, 0), cc.v3(-230.5, 15, 0), cc.v3(230.5, 15, 0), cc.v3(427.5, 15, 0), cc.v3(-280.5, -145, 0), cc.v3(125.5, -145, 0), cc.v3(404, -145, 0) ], [ cc.v3(-293, 116, 0), cc.v3(0, 116, 0), cc.v3(293, 116, 0), cc.v3(-325, -72, 0), cc.v3(-1, -72, 0), cc.v3(324, -72, 0) ], [ cc.v3(-329, -31, 0), cc.v3(0, -31, 0), cc.v3(329, -31, 0) ], [ cc.v3(-346, -9, 0), cc.v3(2, -9, 0), cc.v3(342, -9, 0) ], [], [ cc.v3(-250, 35, 0), cc.v3(250, 35, 0), cc.v3(426, -140, 0), cc.v3(223, -140, 0), cc.v3(0, -140, 0), cc.v3(-222, -140, 0), cc.v3(-421, -140, 0) ], [ cc.v3(-379.5, -43, 0), cc.v3(-126.5, -43, 0), cc.v3(126.5, -43, 0), cc.v3(379.5, -43, 0), cc.v3(-379.5, -173, 0), cc.v3(-126.5, -173, 0), cc.v3(126.5, -173, 0), cc.v3(379.5, -173, 0) ] ];
o.OddsComponentData = [ [ {
with: 449,
height: 158,
odds_value: 1.95,
odds_scale: 1,
bg_img: "composite_odds_bg_blue1"
}, {
with: 449,
height: 158,
odds_value: 2.05,
odds_scale: 1,
bg_img: "composite_odds_bg_red1"
}, {
with: 246,
height: 114,
odds_value: 3.6,
odds_scale: .7,
bg_img: "composite_odds_bg_green2"
}, {
with: 246,
height: 114,
odds_value: 4.6,
odds_scale: .7,
bg_img: "composite_odds_bg_green2"
}, {
with: 246,
height: 114,
odds_value: 5.9,
odds_scale: .7,
bg_img: "composite_odds_bg_green2"
}, {
with: 246,
height: 114,
odds_value: 4.6,
odds_scale: .7,
bg_img: "composite_odds_bg_green2"
}, {
with: 246,
height: 114,
odds_value: 16,
odds_scale: .7,
bg_img: "composite_odds_bg_green2"
}, {
with: 246,
height: 114,
odds_value: 27,
odds_scale: .7,
bg_img: "composite_odds_bg_green2"
}, {
with: 246,
height: 114,
odds_value: 52,
odds_scale: .7,
bg_img: "composite_odds_bg_green2"
}, {
with: 246,
height: 114,
odds_value: 126,
odds_scale: .7,
bg_img: "composite_odds_bg_green2"
} ], [ {
with: 390,
height: 154,
odds_value: 1.9,
odds_scale: 1,
bg_img: "composite_odds_bg_red1"
}, {
with: 260,
height: 154,
odds_value: 25,
odds_scale: 1,
bg_img: "composite_odds_bg_yellow1"
}, {
with: 390,
height: 154,
odds_value: 1.9,
odds_scale: 1,
bg_img: "composite_odds_bg_black1"
}, {
with: 193,
height: 154,
odds_value: 3.8,
odds_scale: 1,
bg_img: "composite_odds_bg_red2"
}, {
with: 193,
height: 154,
odds_value: 3.8,
odds_scale: 1,
bg_img: "composite_odds_bg_red2"
}, {
with: 193,
height: 154,
odds_value: 3.8,
odds_scale: 1,
bg_img: "composite_odds_bg_black2"
}, {
with: 193,
height: 154,
odds_value: 3.8,
odds_scale: 1,
bg_img: "composite_odds_bg_black2"
}, {
with: 487,
height: 154,
odds_value: 2.1,
odds_scale: 1,
bg_img: "composite_odds_bg_blue2"
}, {
with: 317,
height: 154,
odds_value: 3.2,
odds_scale: 1,
bg_img: "composite_odds_bg_blue2"
}, {
with: 232,
height: 154,
odds_value: 4.3,
odds_scale: 1,
bg_img: "composite_odds_bg_blue2"
} ], [ {
with: 258,
height: 167,
odds_value: -1,
odds_scale: 1,
bg_img: "composite_odds_bg_luckyDice1"
}, {
with: 244,
height: 167,
odds_value: -1,
odds_scale: 1,
bg_img: "composite_odds_bg_luckyDice2"
}, {
with: 258,
height: 167,
odds_value: -1,
odds_scale: 1,
bg_img: "composite_odds_bg_luckyDice3"
}, {
with: 275,
height: 205,
odds_value: -1,
odds_scale: 1,
bg_img: "composite_odds_bg_luckyDice4"
}, {
with: 258,
height: 205,
odds_value: -1,
odds_scale: 1,
bg_img: "composite_odds_bg_luckyDice5"
}, {
with: 275,
height: 205,
odds_value: -1,
odds_scale: 1,
bg_img: "composite_odds_bg_luckyDice6"
} ], [ {
with: 270,
height: 330,
odds_value: 2.05,
odds_scale: 1.5,
bg_img: "composite_odds_bg_blue1"
}, {
with: 270,
height: 330,
odds_value: 9.5,
odds_scale: 1.5,
bg_img: "composite_odds_bg_green3"
}, {
with: 270,
height: 330,
odds_value: 2.05,
odds_scale: 1.5,
bg_img: "composite_odds_bg_red1"
} ], [ {
with: 328,
height: 262,
odds_value: 2.2,
odds_scale: 1.5,
bg_img: "composite_odds_bg_blue3_7up"
}, {
with: 244,
height: 262,
odds_value: 5.5,
odds_scale: 1.5,
bg_img: "composite_odds_bg_green4_7up"
}, {
with: 414 * .8,
height: 262,
odds_value: 2.2,
odds_scale: 1.5,
bg_img: "composite_odds_bg_red3_7up"
} ], [], [ {
with: 494,
height: 174,
odds_value: 2,
odds_scale: 1,
bg_img: "composite_odds_bg_blue1"
}, {
with: 494,
height: 174,
odds_value: 2,
odds_scale: 1,
bg_img: "composite_odds_bg_red1"
}, {
with: 994,
height: 152,
odds_value: 2,
odds_scale: .8,
bg_img: "composite_odds_bg_green2"
}, {
with: 994,
height: 152,
odds_value: 2,
odds_scale: .8,
bg_img: "composite_odds_bg_green2"
}, {
with: 994,
height: 152,
odds_value: 2,
odds_scale: .8,
bg_img: "composite_odds_bg_green2"
}, {
with: 994,
height: 152,
odds_value: 2,
odds_scale: .8,
bg_img: "composite_odds_bg_green2"
}, {
with: 994,
height: 152,
odds_value: 2,
odds_scale: .8,
bg_img: "composite_odds_bg_green2"
} ], [ {
with: 249,
height: 126,
odds_value: 42.5,
odds_scale: 1,
bg_img: "composite_odds_bg_green2"
}, {
with: 249,
height: 126,
odds_value: 26.5,
odds_scale: 1,
bg_img: "composite_odds_bg_green2"
}, {
with: 249,
height: 126,
odds_value: 15.9,
odds_scale: 1,
bg_img: "composite_odds_bg_green2"
}, {
with: 249,
height: 126,
odds_value: 10.6,
odds_scale: 1,
bg_img: "composite_odds_bg_green2"
}, {
with: 249,
height: 126,
odds_value: 5.3,
odds_scale: 1,
bg_img: "composite_odds_bg_green2"
}, {
with: 249,
height: 126,
odds_value: 5.3,
odds_scale: 1,
bg_img: "composite_odds_bg_green2"
}, {
with: 249,
height: 126,
odds_value: 5.3,
odds_scale: 1,
bg_img: "composite_odds_bg_green2"
}, {
with: 249,
height: 126,
odds_value: 5.3,
odds_scale: 1,
bg_img: "composite_odds_bg_green2"
} ] ];
cc._RF.pop();
}, {} ],
CompositeEffect: [ function(e, t, o) {
"use strict";
cc._RF.push(t, "17d01W7meJKDI/9xhAWRJF9", "CompositeEffect");
var n, a = this && this.__extends || (n = function(e, t) {
return (n = Object.setPrototypeOf || {
__proto__: []
} instanceof Array && function(e, t) {
e.__proto__ = t;
} || function(e, t) {
for (var o in t) Object.prototype.hasOwnProperty.call(t, o) && (e[o] = t[o]);
})(e, t);
}, function(e, t) {
n(e, t);
function o() {
this.constructor = e;
}
e.prototype = null === t ? Object.create(t) : (o.prototype = t.prototype, new o());
}), i = this && this.__decorate || function(e, t, o, n) {
var a, i = arguments.length, r = i < 3 ? t : null === n ? n = Object.getOwnPropertyDescriptor(t, o) : n;
if ("object" == typeof Reflect && "function" == typeof Reflect.decorate) r = Reflect.decorate(e, t, o, n); else for (var l = e.length - 1; l >= 0; l--) (a = e[l]) && (r = (i < 3 ? a(r) : i > 3 ? a(t, o, r) : a(t, o)) || r);
return i > 3 && r && Object.defineProperty(t, o, r), r;
};
Object.defineProperty(o, "__esModule", {
value: !0
});
var r = e("../../../Game/client/global/enum/game/Const"), l = e("../../../Game/client/global/enum/game/Event"), s = e("../../../Game/client/logic/game/GameHelper"), c = e("../../../Game/fromework/global/Tools"), u = e("../../../Game/fromework/helper/AudioHelper"), d = e("../../../Game/fromework/helper/EventHelper"), p = e("../Utils/CompositeConst"), h = e("../Utils/CompositeEvent"), f = e("../Utils/CompositeUtil"), _ = {
2: "SET",
3: "PURE",
4: "SEQ",
5: "COLOR",
6: "PAIR"
}, m = cc._decorator, y = m.ccclass, g = m.property, v = function(e) {
a(t, e);
function t() {
var t = null !== e && e.apply(this, arguments) || this;
t.Start = null;
t.Stop = null;
t.CountDown = null;
t.Time = null;
t.Eff_Win = null;
t.Eff_Win_RB = null;
t.Eff_GoldDice = null;
t.GameMethod = p.PlayMethod.AndarBahar;
t._EffWins = [];
t._EffGold = [];
t._countdownID = -1;
return t;
}
t.prototype.init = function(e) {
this.GameMethod = e;
};
t.prototype._onGoldDice = function(e) {
for (var t = e.getUserData(), o = p.OddsComponentData[p.PlayMethod.SevenUpDown], n = 0; n < o.length; ++n) {
var a = "win" + t, i = p.OddsPosition[p.PlayMethod.SevenUpDown][n], r = cc.instantiate(this.Eff_GoldDice);
this._EffGold.push(r);
r.parent = this.node;
r.position = cc.v3(i.x, i.y - 75, 0);
r.y -= 15;
var l = r.getComponent(dragonBones.ArmatureDisplay);
l.armatureName = "Armature";
l.playAnimation(a, -1);
}
};
t.prototype._hideEffect_Gold = function() {
this._EffGold.forEach(function(e) {
e.removeFromParent(!0);
});
this._EffGold.splice(0);
this._EffGold = [];
};
t.prototype._onGameHide = function() {
this.unscheduleAllCallbacks();
this._hideEffect_WIn();
this._hideCountDown();
this.Stop.node.active = !1;
this.Start.node.active = !1;
};
t.prototype._show_win = function(e, t) {
var o = null, n = "", a = this._getWinType(e);
if (p.PlayMethod.AndarBahar == this.GameMethod) {
o = this.Eff_Win;
n = "animation_win";
} else if (p.PlayMethod.RedAndBlack == this.GameMethod) ; else if (p.PlayMethod.LuckyDice == this.GameMethod) {
o = this.Eff_Win;
n = "animation_win_odds";
} else if (p.PlayMethod.DragonVSTiger == this.GameMethod) {
o = this.Eff_Win;
n = "animation_win";
} else if (p.PlayMethod.SevenUpDown == this.GameMethod) {
o = this.Eff_Win;
n = "animation_win";
} else if (p.PlayMethod.TPWar == this.GameMethod) {
o = this.Eff_Win;
n = 0 == e || 1 == e ? "animation_win" : "animation_lucky_shot_win";
} else if (p.PlayMethod.Roulette == this.GameMethod) {
o = this.Eff_Win;
n = "animation_win";
}
var i = cc.instantiate(o), r = e;
p.PlayMethod.TPWar == this.GameMethod && r > 6 && (r = 6);
var l = p.OddsPosition[this.GameMethod][r];
!l && (l = cc.Vec3.ZERO);
this._EffWins.push(i);
i.parent = this.node;
i.position = l;
i.y += -10;
var s = i.getComponent(sp.Skeleton);
if (o == this.Eff_Win) {
var c = s.attachUtil;
c.generateAllAttachedNodes();
var u = c.getAttachedNodes("win")[0];
if (u) {
var d = cc.instantiate(i.getChildByName("WinLabel"));
d.active = !0;
d.position = cc.Vec3.ZERO;
var h = d.getComponent(cc.Label);
if ("animation_lucky_shot_win" == n) if (0 == e || 1 == e) h.string = "WIN"; else {
var m = f.default.Game.Model.bet_options[t].x;
h.string = _[t] + " " + m + "X";
} else h.string = "WIN";
h.fontSize = 80;
u.addChild(d);
}
if ("animation_win_odds" == n) {
var y = c.getAttachedNodes("Num")[0];
if (y) {
var g = cc.instantiate(i.getChildByName("WinLabel"));
g.active = !0;
g.position = cc.Vec3.ZERO;
(h = g.getComponent(cc.Label)).string = a + "X";
h.fontSize = 80;
y.addChild(g);
}
}
}
s.setAnimation(0, n, !1);
};
t.prototype._getWinType = function(e) {
var t = f.default.Game.Model.bet_options, o = f.default.Game.Model.show_card, n = 0;
if (p.PlayMethod.AndarBahar == this.GameMethod) ; else if (p.PlayMethod.RedAndBlack == this.GameMethod && e < 3) {
var a = Math.floor(o[0] / 16);
n = 2 == a || 3 == a || 4 == a ? 1 : 2;
} else if (p.PlayMethod.LuckyDice == this.GameMethod) {
var i = c.Tools.TArray.getEleCount(o, e);
n = t[0][i];
} else p.PlayMethod.DragonVSTiger == this.GameMethod || (p.PlayMethod.SevenUpDown, 
this.GameMethod);
return n;
};
t.prototype._showEffect_Win = function() {
for (var e = f.default.Game.Model.win_options, t = 0; t < e.length; t++) if (this.GameMethod == p.PlayMethod.TPWar) {
var o = f.default.Game.Model;
this._show_win(e[t], o.real_win_options[t]);
} else this._show_win(e[t]);
};
t.prototype._hideEffect_WIn = function() {
this._EffWins.forEach(function(e) {
e.removeFromParent(!0);
});
this._EffWins.splice(0);
this._EffWins = [];
};
t.prototype._showCountDown = function() {
var e = this, t = f.default.Game.Model;
if (-1 != this._countdownID) {
s.Countdown.deleta(this._countdownID);
this._countdownID = -1;
}
var o = t.getCountDown();
o--;
this.CountDown.active = !0;
this.Time.string = o + "";
this._countdownID = s.Countdown.creat(o, function() {
e && e.Time && e.Time.node && e.Time.node.isValid && (e.Time.string = "0");
}, function(t) {
if (e && e.Time && e.Time.node && e.Time.node.isValid && t >= 0) {
0 == t ? u.default.Instance.playBundleEffect(r.BundleSoundPath.composite_countdown_0) : t > 0 && t < 5 && u.default.Instance.playBundleEffect(r.BundleSoundPath.composite_countdown_1);
e.GameMethod == p.PlayMethod.Roulette && 2 == t && u.default.Instance.playBundleEffect(r.BundleSoundPath.roulette_car_run);
e.Time.string = t + "";
}
}, this);
};
t.prototype._hideCountDown = function() {
this.CountDown.active = !1;
if (-1 != this._countdownID) {
s.Countdown.deleta(this._countdownID);
this._countdownID = -1;
}
};
t.prototype._playStartBetting = function() {
if (p.PlayMethod.DragonVSTiger != this.GameMethod && p.PlayMethod.TPWar != this.GameMethod) {
this.Start.node.active = !0;
this.Start.setAnimation(0, "animation", !1);
}
u.default.Instance.playBundleEffect(r.BundleSoundPath.composite_start_betting);
};
t.prototype._playStopBetting = function() {
var e = this;
this.Stop.node.active = !0;
this.Stop.armatureName = "Armature";
this.Stop.once(dragonBones.EventObject.COMPLETE, function() {
e.Stop.node.active = !1;
}, this);
this.Stop.playAnimation("animation", 1);
u.default.Instance.playBundleEffect(r.BundleSoundPath.composite_stop_betting);
};
t.prototype._onStartBetting = function() {
this.Start.node.active = !1;
this._showCountDown();
};
t.prototype._onStopBetting = function() {
this._playStopBetting();
this._hideCountDown();
};
t.prototype._onEnterRoom = function() {
2 == f.default.Game.Model.roomData.state && this._showCountDown();
};
t.prototype._onReset = function() {
this._onGameHide();
};
t.prototype.onEnable = function() {
d.default.Instance.Global.bind(h.CompositeUIEvent.UI_PLAY_START_BET, this._playStartBetting, this);
d.default.Instance.Global.bind(h.CompositeGameEvent.GAME_RECONNECT, this._onEnterRoom, this);
d.default.Instance.Global.bind(h.CompositeGameEvent.UI_EFFECT_START_BET, this._onStartBetting, this);
d.default.Instance.Global.bind(h.CompositeGameEvent.UI_EFFECT_STOP_BET, this._onStopBetting, this);
if (p.PlayMethod.TraditionAndarBahar != this.GameMethod) {
d.default.Instance.Global.bind(h.OddsEvent.ODDS_HIDE_WIN, this._hideEffect_WIn, this);
d.default.Instance.Global.bind(h.OddsEvent.ODDS_SHOW_WIN, this._showEffect_Win, this);
d.default.Instance.Global.bind(h.CompositeUIEvent.UI_PLAY_GOLD_DICE_EFF, this._onGoldDice, this);
d.default.Instance.Global.bind(h.CompositeUIEvent.UI_HIDE_GOLD_DICE_EFF, this._hideEffect_Gold, this);
}
d.default.Instance.Global.bind(l.GameEvent.S2C_RESET, this._onReset, this);
};
t.prototype.onDisable = function() {
d.default.Instance.Global.unbind(h.CompositeUIEvent.UI_PLAY_START_BET, this._playStartBetting, this);
d.default.Instance.Global.unbind(h.CompositeGameEvent.GAME_RECONNECT, this._onEnterRoom, this);
d.default.Instance.Global.unbind(h.CompositeGameEvent.UI_EFFECT_START_BET, this._onStartBetting, this);
d.default.Instance.Global.unbind(h.CompositeGameEvent.UI_EFFECT_STOP_BET, this._onStopBetting, this);
if (p.PlayMethod.TraditionAndarBahar != this.GameMethod) {
d.default.Instance.Global.unbind(h.OddsEvent.ODDS_HIDE_WIN, this._hideEffect_WIn, this);
d.default.Instance.Global.unbind(h.OddsEvent.ODDS_SHOW_WIN, this._showEffect_Win, this);
d.default.Instance.Global.unbind(h.CompositeUIEvent.UI_PLAY_GOLD_DICE_EFF, this._onGoldDice, this);
d.default.Instance.Global.unbind(h.CompositeUIEvent.UI_HIDE_GOLD_DICE_EFF, this._hideEffect_Gold, this);
}
d.default.Instance.Global.unbind(l.GameEvent.S2C_RESET, this._onReset, this);
};
t.prototype.onLoad = function() {
cc.game.on(cc.game.EVENT_HIDE, this._onGameHide, this);
};
t.prototype.onDestroy = function() {
this._hideCountDown();
};
t.prototype.start = function() {};
i([ g(sp.Skeleton) ], t.prototype, "Start", void 0);
i([ g(dragonBones.ArmatureDisplay) ], t.prototype, "Stop", void 0);
i([ g(cc.Node) ], t.prototype, "CountDown", void 0);
i([ g(cc.Label) ], t.prototype, "Time", void 0);
i([ g(cc.Prefab) ], t.prototype, "Eff_Win", void 0);
i([ g(cc.Prefab) ], t.prototype, "Eff_Win_RB", void 0);
i([ g(cc.Prefab) ], t.prototype, "Eff_GoldDice", void 0);
i([ g({
type: cc.Enum(p.PlayMethod)
}) ], t.prototype, "GameMethod", void 0);
return i([ y ], t);
}(cc.Component);
o.default = v;
cc._RF.pop();
}, {
"../../../Game/client/global/enum/game/Const": "Const",
"../../../Game/client/global/enum/game/Event": "Event",
"../../../Game/client/logic/game/GameHelper": "GameHelper",
"../../../Game/fromework/global/Tools": "Tools",
"../../../Game/fromework/helper/AudioHelper": "AudioHelper",
"../../../Game/fromework/helper/EventHelper": "EventHelper",
"../Utils/CompositeConst": "CompositeConst",
"../Utils/CompositeEvent": "CompositeEvent",
"../Utils/CompositeUtil": "CompositeUtil"
} ],
CompositeEvent: [ function(e, t, o) {
"use strict";
cc._RF.push(t, "ba3bdcuTRxMzKShmTY9SCB2", "CompositeEvent");
Object.defineProperty(o, "__esModule", {
value: !0
});
o.CompositeGameEvent = o.CompositeUIEvent = o.OddsEvent = o.ChipGeneratorEvent = o.BetChipEvent = o.UserEvent = void 0;
o.UserEvent = {
USER_REFRESH_DATA: "USER_REFRESH_DATA",
USER_WIN_MONEY: "USER_WIN_MONEY",
USER_SHOW_COUNTDOWN: "USER_SHOW_COUNTDOWN",
USER_HIDE_COUNTDOWN: "USER_HIDE_COUNTDOWN"
};
o.BetChipEvent = {
BET_CHIP_CLICK: "BET_CHIP_CLICK"
};
o.ChipGeneratorEvent = {
GENERATOR_BET: "GENERATOR_BET",
GENERATOR_ADDCHIP: "GENERATOR_ADDCHIP"
};
o.OddsEvent = {
ODDS_ONLOAD: "ODDS_ONLOAD",
ODDS_INIT: "ODDS_INIT",
ODDS_CLICK: "ODDS_CLICK",
ODDS_BET_CHANGED_ALL: "ODDS_BET_CHANGED_ALL",
ODDS_BET_CHANGED_SELF: "ODDS_BET_CHANGED_SELF",
ODDS_SHOW_STAR1: "ODDS_SHOW_STAR1",
ODDS_SHOW_STAR2: "ODDS_SHOW_STAR2",
ODDS_SHOW_WIN: "ODDS_SHOW_WIN",
ODDS_HIDE_WIN: "ODDS_HIDE_WIN",
ODDS_RECYCLING: "ODDS_RECYCLING",
ODDS_DISPENSE: "ODDS_DISPENSE"
};
o.CompositeUIEvent = {
UI_MEMBER_COUNT_CHANGE: "UI_MEMBER_COUNT_CHANGE",
UI_PLAY_START_BET: "UI_PLAY_START_BET",
UI_PLAY_STOP_BET: "UI_PLAY_STOP_BET",
UI_PLAY_GOLD_DICE_EFF: "UI_PLAY_GOLD_DICE_EFF",
UI_HIDE_GOLD_DICE_EFF: "UI_HIDE_GOLD_DICE_EFF"
};
o.CompositeGameEvent = {
GAME_RECONNECT: "GAME_RECONNECT",
UI_EFFECT_START_BET: "UI_EFFECT_START_BET",
UI_EFFECT_STOP_BET: "UI_EFFECT_STOP_BET"
};
cc._RF.pop();
}, {} ],
CompositeHelp: [ function(e, t, o) {
"use strict";
cc._RF.push(t, "b0018XY+T1At7972e3nqTmK", "CompositeHelp");
var n, a = this && this.__extends || (n = function(e, t) {
return (n = Object.setPrototypeOf || {
__proto__: []
} instanceof Array && function(e, t) {
e.__proto__ = t;
} || function(e, t) {
for (var o in t) Object.prototype.hasOwnProperty.call(t, o) && (e[o] = t[o]);
})(e, t);
}, function(e, t) {
n(e, t);
function o() {
this.constructor = e;
}
e.prototype = null === t ? Object.create(t) : (o.prototype = t.prototype, new o());
}), i = this && this.__decorate || function(e, t, o, n) {
var a, i = arguments.length, r = i < 3 ? t : null === n ? n = Object.getOwnPropertyDescriptor(t, o) : n;
if ("object" == typeof Reflect && "function" == typeof Reflect.decorate) r = Reflect.decorate(e, t, o, n); else for (var l = e.length - 1; l >= 0; l--) (a = e[l]) && (r = (i < 3 ? a(r) : i > 3 ? a(t, o, r) : a(t, o)) || r);
return i > 3 && r && Object.defineProperty(t, o, r), r;
};
Object.defineProperty(o, "__esModule", {
value: !0
});
var r = e("../../../Game/fromework/helper/UIHelper"), l = cc._decorator, s = l.ccclass, c = (l.property, 
function(e) {
a(t, e);
function t() {
return null !== e && e.apply(this, arguments) || this;
}
t.prototype.onCloseClicked = function() {
r.default.Instance.removeMaskLayer(this.node, !0);
};
return i([ s ], t);
}(cc.Component));
o.default = c;
cc._RF.pop();
}, {
"../../../Game/fromework/helper/UIHelper": "UIHelper"
} ],
CompositeModel: [ function(e, t, o) {
"use strict";
cc._RF.push(t, "46b93rKlhtB+J8sxXXJOPTj", "CompositeModel");
Object.defineProperty(o, "__esModule", {
value: !0
});
o.ChipDataStruct = void 0;
o.ChipDataStruct = function(e, t, o) {
void 0 === e && (e = 0);
void 0 === t && (t = cc.Vec3.ZERO);
void 0 === o && (o = 0);
this.value = 0;
this.dest = cc.Vec3.ZERO;
this.index = 0;
this.value = e;
this.dest = t.clone();
this.index = o;
};
cc._RF.pop();
}, {} ],
CompositeOdds: [ function(e, t, o) {
"use strict";
cc._RF.push(t, "c1665rmrlZGtJTW7jyurHJC", "CompositeOdds");
var n, a = this && this.__extends || (n = function(e, t) {
return (n = Object.setPrototypeOf || {
__proto__: []
} instanceof Array && function(e, t) {
e.__proto__ = t;
} || function(e, t) {
for (var o in t) Object.prototype.hasOwnProperty.call(t, o) && (e[o] = t[o]);
})(e, t);
}, function(e, t) {
n(e, t);
function o() {
this.constructor = e;
}
e.prototype = null === t ? Object.create(t) : (o.prototype = t.prototype, new o());
}), i = this && this.__decorate || function(e, t, o, n) {
var a, i = arguments.length, r = i < 3 ? t : null === n ? n = Object.getOwnPropertyDescriptor(t, o) : n;
if ("object" == typeof Reflect && "function" == typeof Reflect.decorate) r = Reflect.decorate(e, t, o, n); else for (var l = e.length - 1; l >= 0; l--) (a = e[l]) && (r = (i < 3 ? a(r) : i > 3 ? a(t, o, r) : a(t, o)) || r);
return i > 3 && r && Object.defineProperty(t, o, r), r;
};
Object.defineProperty(o, "__esModule", {
value: !0
});
var r = e("../../../Game/client/global/enum/game/Const"), l = e("../../../Game/client/global/enum/game/Event"), s = e("../../../Game/fromework/global/ResLoader"), c = e("../../../Game/fromework/helper/AudioHelper"), u = e("../../../Game/fromework/helper/EventHelper"), d = e("../../../platform/Platform"), p = e("../Utils/CompositeConst"), h = e("../Utils/CompositeEvent"), f = e("../Utils/CompositeUtil"), _ = cc._decorator, m = _.ccclass, y = _.property, g = function(e) {
a(t, e);
function t() {
var t = null !== e && e.apply(this, arguments) || this;
t.BG = null;
t.SelfBet = null;
t.Slash = null;
t.AllBet = null;
t.Rounds = null;
t.OddsValueNode = null;
t.OddsValueLabel = null;
t.Star1 = null;
t.Star2 = null;
t.WinLight = null;
t.ClickLight = null;
t._gameMethod = p.PlayMethod.AndarBahar;
t._index = 0;
t._oddsValue = 0;
return t;
}
Object.defineProperty(t.prototype, "GameMethod", {
get: function() {
return this._gameMethod;
},
set: function(e) {
this._gameMethod = e;
},
enumerable: !1,
configurable: !0
});
Object.defineProperty(t.prototype, "Index", {
get: function() {
return this._index;
},
set: function(e) {
e < 0 ? this._index = 0 : e >= p.OddsComponentData[this.GameMethod].length ? this._index = p.OddsComponentData[this.GameMethod].length - 1 : this._index = e;
},
enumerable: !1,
configurable: !0
});
Object.defineProperty(t.prototype, "OddsValue", {
get: function() {
return this._oddsValue;
},
set: function(e) {
this._oddsValue = e;
this.OddsValueLabel.string = e + "X";
},
enumerable: !1,
configurable: !0
});
t.prototype.init = function(e, t) {
this.GameMethod = e;
this.Index = t;
this._init();
};
t.prototype._init = function() {
var e = this;
if (this.GameMethod != p.PlayMethod.LuckyDice && this.GameMethod != p.PlayMethod.SevenUpDown && this.GameMethod != p.PlayMethod.DragonVSTiger && this.GameMethod != p.PlayMethod.AndarBahar && this.GameMethod != p.PlayMethod.Roulette && this.GameMethod != p.PlayMethod.TPWar) {
var t = p.OddsComponentData[this.GameMethod][this.Index];
s.default.Instance.loadBundleRes(p.ODDS_TEXTURE_PATH + p.ODDS_TITLE_PATH + this._getTitleType() + this.Index, cc.SpriteFrame, function(t, o) {
t ? d.default.error(t) : e.Rounds.spriteFrame = o;
});
s.default.Instance.loadBundleRes(p.ODDS_TEXTURE_PATH + t.bg_img, cc.SpriteFrame, function(t, o) {
t ? d.default.error(t) : e.BG.spriteFrame = o;
});
if (-1 == t.odds_value) this.OddsValueNode.active = !1; else {
this.OddsValueNode.active = !0;
this.OddsValue = t.odds_value;
}
var o = this.Rounds.node.parent.getComponent(cc.Layout);
if (this.GameMethod == p.PlayMethod.Roulette) {
o.paddingTop = 6;
o.spacingY = 3;
} else {
o.paddingTop = 8;
o.spacingY = 8;
}
this.OddsValueNode.scale = t.odds_scale;
this.node.width = t.with;
this.node.height = t.height;
this._refreshBet(0, 0);
this._resetStar();
} else {
this._refreshBet(0, 0);
this._resetStar();
}
};
t.prototype._getTitleType = function() {
switch (this.GameMethod) {
case p.PlayMethod.AndarBahar:
return p.ODDS_TITLE_AB;

case p.PlayMethod.RedAndBlack:
return p.ODDS_TITLE_RB;

case p.PlayMethod.LuckyDice:
return p.ODDS_TITLE_LD;

case p.PlayMethod.DragonVSTiger:
return p.ODDS_TITLE_DT;

case p.PlayMethod.SevenUpDown:
return p.ODDS_TITLE_SUD;

case p.PlayMethod.TPWar:
return p.ODDS_TITLE_TPW;

case p.PlayMethod.Roulette:
return p.ODDS_TITLE_ROULETTE;

default:
return p.ODDS_TITLE_AB;
}
};
t.prototype._refreshBet = function(e, t) {
if (null != e && 0 != e) {
this.SelfBet.node.active = !0;
this.Slash.node.active = !0;
this.SelfBet.string = "" + e;
} else {
this.SelfBet.node.active = !1;
this.Slash.node.active = !1;
}
null != t && (this.AllBet.string = "" + t);
};
t.prototype._resetStar = function() {
this.Star1.active = !1;
this.Star2.active = !1;
};
t.prototype._onRefrashValueAll = function(e) {
var t = e.getUserData();
t && this.Index == t.index && null != t.all && (this.AllBet.string = "" + t.all);
};
t.prototype._onRefrashValueSelf = function(e) {
var t = e.getUserData();
if (t && this.Index == t.index) if (null == t.self || 0 == t.self) {
this.SelfBet.node.active = !1;
this.Slash.node.active = !1;
} else {
this.SelfBet.node.active = !0;
this.Slash.node.active = !0;
this.SelfBet.string = "" + t.self;
}
};
t.prototype._showStar1 = function(e) {
var t = e.getUserData();
this.Index == t.index && (this.Star1.active = !0);
};
t.prototype._showStar2 = function(e) {
var t = e.getUserData();
this.Index == t.index && (this.Star2.active = !0);
};
t.prototype._reset = function() {
this._refreshBet(0, 0);
this._resetStar();
this._hideEffect_WIn();
};
t.prototype._showEffect_Win = function() {
for (var e = f.default.Game.Model.win_options, t = 0; t < e.length; t++) {
var o = e[t];
p.PlayMethod.TPWar == this.GameMethod && o > 6 && (o = 2);
if (o == this.Index) {
this.WinLight.active = !0;
cc.tween(this.WinLight).repeat(2, cc.tween(this.WinLight).to(.5, {
opacity: 55
}).to(.5, {
opacity: 255
})).start();
c.default.Instance.playBundleEffect(r.BundleSoundPath.common_win);
}
}
};
t.prototype._hideEffect_WIn = function() {
this.WinLight.active = !1;
this.WinLight.stopAllActions();
};
t.prototype.onClick = function() {
var e = this;
u.default.Instance.Global.emit(h.OddsEvent.ODDS_CLICK, {
index: this.Index
});
this.ClickLight.active = !0;
cc.tween(this.ClickLight).to(.04, {
opacity: 255
}).to(.04, {
opacity: 0
}).call(function() {
e.ClickLight.opacity = 0;
e.ClickLight.active = !1;
}).start();
};
t.prototype.onEnable = function() {
u.default.Instance.Global.bind(l.GameEvent.S2C_RESET, this._reset, this);
u.default.Instance.Global.bind(h.OddsEvent.ODDS_SHOW_STAR1, this._showStar1, this);
u.default.Instance.Global.bind(h.OddsEvent.ODDS_SHOW_STAR2, this._showStar2, this);
u.default.Instance.Global.bind(h.OddsEvent.ODDS_BET_CHANGED_ALL, this._onRefrashValueAll, this);
u.default.Instance.Global.bind(h.OddsEvent.ODDS_BET_CHANGED_SELF, this._onRefrashValueSelf, this);
u.default.Instance.Global.bind(h.OddsEvent.ODDS_HIDE_WIN, this._hideEffect_WIn, this);
u.default.Instance.Global.bind(h.OddsEvent.ODDS_SHOW_WIN, this._showEffect_Win, this);
};
t.prototype.onDisable = function() {
u.default.Instance.Global.unbind(l.GameEvent.S2C_RESET, this._reset, this);
u.default.Instance.Global.unbind(h.OddsEvent.ODDS_SHOW_STAR1, this._showStar1, this);
u.default.Instance.Global.unbind(h.OddsEvent.ODDS_SHOW_STAR2, this._showStar2, this);
u.default.Instance.Global.unbind(h.OddsEvent.ODDS_BET_CHANGED_ALL, this._onRefrashValueAll, this);
u.default.Instance.Global.unbind(h.OddsEvent.ODDS_BET_CHANGED_SELF, this._onRefrashValueSelf, this);
u.default.Instance.Global.unbind(h.OddsEvent.ODDS_HIDE_WIN, this._hideEffect_WIn, this);
u.default.Instance.Global.unbind(h.OddsEvent.ODDS_SHOW_WIN, this._showEffect_Win, this);
};
t.prototype.onLoad = function() {
u.default.Instance.Global.emit(h.OddsEvent.ODDS_ONLOAD, {
index: this.Index,
node: this.node
});
this.node.getComponent(cc.Button).isNotPlaySound = !0;
};
t.prototype.start = function() {};
i([ y(cc.Sprite) ], t.prototype, "BG", void 0);
i([ y(cc.Label) ], t.prototype, "SelfBet", void 0);
i([ y(cc.Label) ], t.prototype, "Slash", void 0);
i([ y(cc.Label) ], t.prototype, "AllBet", void 0);
i([ y(cc.Sprite) ], t.prototype, "Rounds", void 0);
i([ y(cc.Node) ], t.prototype, "OddsValueNode", void 0);
i([ y(cc.Label) ], t.prototype, "OddsValueLabel", void 0);
i([ y(cc.Node) ], t.prototype, "Star1", void 0);
i([ y(cc.Node) ], t.prototype, "Star2", void 0);
i([ y(cc.Node) ], t.prototype, "WinLight", void 0);
i([ y(cc.Node) ], t.prototype, "ClickLight", void 0);
i([ y({
type: cc.Enum(p.PlayMethod)
}) ], t.prototype, "_gameMethod", void 0);
i([ y({
type: cc.Enum(p.PlayMethod),
tooltip: "游戏类型"
}) ], t.prototype, "GameMethod", null);
i([ y({
step: 1
}) ], t.prototype, "_index", void 0);
i([ y({
step: 1
}) ], t.prototype, "Index", null);
return i([ m ], t);
}(cc.Component);
o.default = g;
cc._RF.pop();
}, {
"../../../Game/client/global/enum/game/Const": "Const",
"../../../Game/client/global/enum/game/Event": "Event",
"../../../Game/fromework/global/ResLoader": "ResLoader",
"../../../Game/fromework/helper/AudioHelper": "AudioHelper",
"../../../Game/fromework/helper/EventHelper": "EventHelper",
"../../../platform/Platform": "Platform",
"../Utils/CompositeConst": "CompositeConst",
"../Utils/CompositeEvent": "CompositeEvent",
"../Utils/CompositeUtil": "CompositeUtil"
} ],
CompositePlayerHead: [ function(e, t, o) {
"use strict";
cc._RF.push(t, "b400bl33gNMz4C67Gfym+qt", "CompositePlayerHead");
var n, a = this && this.__extends || (n = function(e, t) {
return (n = Object.setPrototypeOf || {
__proto__: []
} instanceof Array && function(e, t) {
e.__proto__ = t;
} || function(e, t) {
for (var o in t) Object.prototype.hasOwnProperty.call(t, o) && (e[o] = t[o]);
})(e, t);
}, function(e, t) {
n(e, t);
function o() {
this.constructor = e;
}
e.prototype = null === t ? Object.create(t) : (o.prototype = t.prototype, new o());
}), i = this && this.__decorate || function(e, t, o, n) {
var a, i = arguments.length, r = i < 3 ? t : null === n ? n = Object.getOwnPropertyDescriptor(t, o) : n;
if ("object" == typeof Reflect && "function" == typeof Reflect.decorate) r = Reflect.decorate(e, t, o, n); else for (var l = e.length - 1; l >= 0; l--) (a = e[l]) && (r = (i < 3 ? a(r) : i > 3 ? a(t, o, r) : a(t, o)) || r);
return i > 3 && r && Object.defineProperty(t, o, r), r;
};
Object.defineProperty(o, "__esModule", {
value: !0
});
var r = e("../../../Game/client/global/enum/game/Const"), l = e("../../../Game/client/global/enum/game/UIUtils"), s = e("../../../Game/fromework/global/Tools"), c = e("../../../Game/fromework/helper/EventHelper"), u = e("../../../Game/fromework/helper/UIHelper"), d = e("../Utils/CompositeConst"), p = e("../Utils/CompositeEvent"), h = cc._decorator, f = h.ccclass, _ = h.property, m = function(e) {
a(t, e);
function t() {
var t = null !== e && e.apply(this, arguments) || this;
t.Icon_Empty = null;
t.Node_Title = null;
t.Node_Name = null;
t.Node_Money = null;
t.Icon_Image = null;
t.Name_Text = null;
t.Money_Value = null;
t.Player_Title_Big_Winner = null;
t.Player_Title_Lucky = null;
t.Player_Title_First = null;
t.Player_Title_Second = null;
t.SpriteFrame_Man = null;
t.SpriteFrame_Woman = null;
t._index = 0;
t._icon_url = "";
return t;
}
Object.defineProperty(t.prototype, "Index", {
get: function() {
return this._index;
},
set: function(e) {
this._index = e;
this._empty();
},
enumerable: !1,
configurable: !0
});
t.prototype.init = function(e) {
this.Index = e;
};
t.prototype._empty = function() {
this._refreshTitle();
this.Node_Name.active = !1;
this.Node_Money.active = !1;
this.Icon_Empty.active = !0;
this.Icon_Image.spriteFrame = null;
this.Icon_Image.node.active = !1;
this.Name_Text.string = "";
this.Money_Value.string = "";
};
t.prototype._refreshTitle = function() {
this.Player_Title_Big_Winner.node.active = this.Index == d.PLAYER_INDEX_BIGWINNER;
this.Player_Title_Lucky.node.active = this.Index == d.PLAYER_INDEX_LUCKY;
this.Player_Title_First.node.active = this.Index == d.PLAYER_INDEX_MONEY1 && !1;
this.Player_Title_Second.node.active = this.Index == d.PLAYER_INDEX_MONEY2 && !1;
};
t.prototype._refreshIcon = function(e, t) {
var o = this, n = !t || 1 == t;
if (null == e) {
this._icon_url = null;
this.Icon_Image.node.active = !1;
this.Icon_Empty.active = !0;
this.Icon_Image.spriteFrame = n ? this.SpriteFrame_Man : this.SpriteFrame_Woman;
this.Icon_Image.node.width = 100;
this.Icon_Image.node.height = 100;
} else if ("" == e) {
this._icon_url = "";
this.Icon_Image.node.active = !0;
this.Icon_Empty.active = !1;
this.Icon_Image.spriteFrame = n ? this.SpriteFrame_Man : this.SpriteFrame_Woman;
this.Icon_Image.node.width = 100;
this.Icon_Image.node.height = 100;
} else if (this._icon_url != e) {
this._icon_url = e;
l.UIUtils.updateHeadImage(e, this.Icon_Image, cc.size(100, 100), function(e) {
if (o && o.Icon_Image && o.Icon_Image.isValid) {
o.Icon_Image.node.active = e;
o.Icon_Empty.active = !e;
}
});
}
};
t.prototype._refreshName = function(e) {
this.Node_Name.active = !0;
this.Name_Text.string = s.Tools.TStr.ellipsisString(e, 12);
};
t.prototype._refreshMoney = function(e) {
this.Node_Money.active = !0;
this.Money_Value.string = "" + s.Tools.TNumber.numFixed(e, 1);
};
t.prototype._refreshHead = function(e) {
this._refreshIcon(e.icon_url, e.sex);
this._refreshName(e.name);
this._refreshMoney(e.money);
this._refreshTitle();
};
t.prototype._onUserDataRefresh = function(e) {
var t = e.getUserData();
if (t.index == this.Index) {
if (!t.head) {
this._empty();
return;
}
this._refreshHead(t.head);
}
};
t.prototype._onUserWin = function(e) {
var t = e.getUserData();
t.index == this.Index && 0 != t.money && this._refreshMoney(t.total);
};
t.prototype.onHeadClicked = function() {
u.default.Instance.addBundleMaskLayer(r.BundleUIPath.OtherMember);
};
t.prototype.onEnable = function() {
c.default.Instance.Global.bind(p.UserEvent.USER_REFRESH_DATA, this._onUserDataRefresh, this);
c.default.Instance.Global.bind(p.UserEvent.USER_WIN_MONEY, this._onUserWin, this);
};
t.prototype.onDisable = function() {
c.default.Instance.Global.unbind(p.UserEvent.USER_REFRESH_DATA, this._onUserDataRefresh, this);
c.default.Instance.Global.unbind(p.UserEvent.USER_WIN_MONEY, this._onUserWin, this);
};
t.prototype.onLoad = function() {};
t.prototype.start = function() {};
i([ _(cc.Node) ], t.prototype, "Icon_Empty", void 0);
i([ _(cc.Node) ], t.prototype, "Node_Title", void 0);
i([ _(cc.Node) ], t.prototype, "Node_Name", void 0);
i([ _(cc.Node) ], t.prototype, "Node_Money", void 0);
i([ _(cc.Sprite) ], t.prototype, "Icon_Image", void 0);
i([ _(cc.Label) ], t.prototype, "Name_Text", void 0);
i([ _(cc.Label) ], t.prototype, "Money_Value", void 0);
i([ _(cc.Sprite) ], t.prototype, "Player_Title_Big_Winner", void 0);
i([ _(cc.Sprite) ], t.prototype, "Player_Title_Lucky", void 0);
i([ _(cc.Sprite) ], t.prototype, "Player_Title_First", void 0);
i([ _(cc.Sprite) ], t.prototype, "Player_Title_Second", void 0);
i([ _(cc.SpriteFrame) ], t.prototype, "SpriteFrame_Man", void 0);
i([ _(cc.SpriteFrame) ], t.prototype, "SpriteFrame_Woman", void 0);
i([ _({
step: 1,
min: 0,
max: 7
}) ], t.prototype, "_index", void 0);
i([ _({
step: 1,
min: 0,
max: 7
}) ], t.prototype, "Index", null);
return i([ f ], t);
}(cc.Component);
o.default = m;
cc._RF.pop();
}, {
"../../../Game/client/global/enum/game/Const": "Const",
"../../../Game/client/global/enum/game/UIUtils": "UIUtils",
"../../../Game/fromework/global/Tools": "Tools",
"../../../Game/fromework/helper/EventHelper": "EventHelper",
"../../../Game/fromework/helper/UIHelper": "UIHelper",
"../Utils/CompositeConst": "CompositeConst",
"../Utils/CompositeEvent": "CompositeEvent"
} ],
CompositeProxy: [ function(e, t, o) {
"use strict";
cc._RF.push(t, "9cffbzP3rtNjaU+VFJSdFye", "CompositeProxy");
Object.defineProperty(o, "__esModule", {
value: !0
});
o.CompositeProxy = o.CompositeModel = void 0;
var n = e("../../../Game/client/global/enum/game/Event"), a = e("../../../Game/fromework/global/Tools"), i = e("../../../Game/fromework/helper/EventHelper"), r = e("../../../Game/fromework/mvvm/modelView/ViewModel"), l = e("../../../platform/Platform"), s = e("../../../client/model/WalletModel"), c = e("./CompositeConst"), u = e("./CompositeEvent"), d = e("./CompositeStruct"), p = function() {
function e() {
this.sTime = 0;
this.total_user = 0;
this.total_fee = 0;
this.roomData = new d.CompositeStruct.RoomData();
this.allUserData = [];
this.betOptionLabel = new Map();
this.declearData = new d.CompositeStruct.DeclearData();
this.playerBetRecord = [];
this.roomBetRecord = [];
this.deal_card = [];
this.show_card = [];
this.win_options = [];
this.bet_limit = 0;
this.bet_fee_currency = [];
this.bet_options = [];
this.rankData = new d.CompositeStruct.RankData();
}
e.prototype.getCountDown = function() {
l.default.log("get count down:", this.roomData.dl, this.sTime);
return Math.ceil(this.roomData.dl - this.sTime);
};
e.prototype.getBetAmount = function() {
var e = 0;
this.playerBetRecord.forEach(function(t) {
e += t.amount;
});
return e;
};
e.prototype.refreshUserData = function(e) {
var t = this;
this.allUserData.splice(0);
var o = Object.keys(e), n = r.VM.getValue("user.uid");
o.forEach(function(o) {
var i = new d.CompositeStruct.UserData(e[o]);
if (o == n) {
t.refreshPlayerRecord(e[o].bet_record);
t.total_fee = a.Tools.TNumber.num2single(e[o].total_fee);
}
t.allUserData.push(i);
});
};
e.prototype.getUserData = function(e) {
for (var t = 0; t < this.allUserData.length; t++) if (this.allUserData[t].uid == e) return this.allUserData[t];
return null;
};
e.prototype.refreshRoomRecord = function(e) {
this.roomBetRecord.splice(0);
this.roomBetRecord = d.CompositeStruct.getBetRecordArray(e);
for (var t = 0; t < this.roomBetRecord.length; t++) i.default.Instance.Global.emit(u.OddsEvent.ODDS_BET_CHANGED_ALL, {
index: t,
self: null,
all: this.roomBetRecord[t].amount
});
};
e.prototype.refreshPlayerRecord = function(e) {
this.playerBetRecord.splice(0);
this.playerBetRecord = d.CompositeStruct.getBetRecordArray(e);
for (var t = 0; t < this.playerBetRecord.length; t++) i.default.Instance.Global.emit(u.OddsEvent.ODDS_BET_CHANGED_SELF, {
index: t,
self: this.playerBetRecord[t].amount,
all: null
});
};
e.prototype.refreshBetOptionLabel = function(e) {
if (null != e) {
for (var t = 0; t < this.bet_options.length; t++) this.betOptionLabel.set(t, e[t] || []);
this.betOptionLabel.forEach(function(e, t) {
e.forEach(function(e) {
1 == e && i.default.Instance.Global.emit(u.OddsEvent.ODDS_SHOW_STAR1, {
index: t
});
2 == e && i.default.Instance.Global.emit(u.OddsEvent.ODDS_SHOW_STAR2, {
index: t
});
});
});
}
};
e.prototype.checkRecharge = function() {
return r.VM.getValue("wallet.totalRecharge") >= c.COMPOSITE_MIN_RECHARGE;
};
e.prototype.getOddsRate = function(e) {
return this.bet_options[e].x;
};
return e;
}();
o.CompositeModel = p;
var h = function() {
function e() {}
Object.defineProperty(e.prototype, "uid", {
get: function() {
return r.VM.getValue("user.uid");
},
enumerable: !1,
configurable: !0
});
Object.defineProperty(e.prototype, "token", {
get: function() {
return r.VM.getValue("user.token");
},
enumerable: !1,
configurable: !0
});
e.prototype._onEnterRoom = function(e, t) {
t.sTime = e.stime;
t.total_user = e.total_user;
if (null != e.user_data) {
t.refreshUserData(e.user_data);
if (e.uid == this.uid) {
t.roomData.refresh(e.room_data);
t.refreshRoomRecord(e.bet_data);
t.refreshBetOptionLabel(e.bet_options_label);
t.bet_limit = a.Tools.TNumber.num2single(e.bet_limit);
null != e.declear_data && t.declearData.refresh(e.declear_data);
t.deal_card = e.room_data.deal_card;
t.show_card = e.room_data.show_card;
t.win_options = e.win_options;
i.default.Instance.Global.emit(u.CompositeGameEvent.GAME_RECONNECT, e.uid);
}
i.default.Instance.Global.emit(n.GameEvent.S2C_ENTER_ROOM, e.uid);
}
i.default.Instance.Global.emit(u.CompositeUIEvent.UI_MEMBER_COUNT_CHANGE, t.total_user);
};
e.prototype._onDeal = function(e, t) {
t.sTime = e.stime;
t.total_user = e.total_user;
t.roomData.refresh(e.room_data);
t.refreshUserData(e.user_data);
t.deal_card = e.room_data.deal_card;
t.show_card = e.room_data.show_card;
i.default.Instance.Global.emit(n.GameEvent.S2C_AB_DEAL, {
wildCard: t.deal_card[0]
});
i.default.Instance.Global.emit(u.CompositeUIEvent.UI_MEMBER_COUNT_CHANGE, t.total_user);
};
e.prototype._onStartBet = function(e, t) {
t.sTime = e.stime;
t.roomData.refresh(e.room_data);
t.deal_card = e.room_data.deal_card;
t.show_card = e.room_data.show_card;
i.default.Instance.Global.emit(u.CompositeGameEvent.UI_EFFECT_START_BET);
i.default.Instance.Global.emit(u.UserEvent.USER_SHOW_COUNTDOWN);
};
e.prototype._onBet = function(e, t) {
t.sTime = e.stime;
t.refreshRoomRecord(e.bet_data);
t.refreshBetOptionLabel(e.bet_options_label);
if (null != e.bet_user && e.bet_user.uid == this.uid) {
t.refreshPlayerRecord(e.bet_user.bet_record);
t.total_fee = a.Tools.TNumber.num2single(e.bet_user.total_fee);
}
var o = t.getUserData(e.bet_user.uid);
null != o && (o.total_fee = a.Tools.TNumber.num2single(e.bet_user.total_fee));
var r = d.CompositeStruct.getBetRecordArray(e.bet_user.bet_batch_data);
i.default.Instance.Global.emit(n.GameEvent.S2C_AB_BET, {
bet_batch_data: r,
uid: e.bet_user.uid
});
};
e.prototype._onBetBatch = function(e, t) {
t.sTime = e.stime;
t.refreshRoomRecord(e.bet_data);
t.refreshBetOptionLabel(e);
var o = d.CompositeStruct.getBetRecordArray(e.bet_batch_data);
i.default.Instance.Global.emit(n.GameEvent.S2C_AB_BET_BATCH, o);
};
e.prototype._onStopBet = function(e, t) {
t.sTime = e.stime;
t.roomData.refresh(e.room_data);
t.deal_card = e.room_data.deal_card;
t.show_card = e.room_data.show_card;
i.default.Instance.Global.emit(u.CompositeGameEvent.UI_EFFECT_STOP_BET);
i.default.Instance.Global.emit(u.UserEvent.USER_HIDE_COUNTDOWN);
};
e.prototype._onShow = function(e, t) {
t.sTime = e.stime;
t.roomData.refresh(e.room_data);
t.deal_card = e.room_data.deal_card;
t.show_card = e.room_data.show_card;
t.win_options = e.win_options;
t.refreshRoomRecord(e.bet_data);
t.declearData = null;
t.declearData = new d.CompositeStruct.DeclearData(e.declear_data);
e.dealer_profit && (t.dealer_profit = e.dealer_profit);
i.default.Instance.Global.emit(n.GameEvent.S2C_AB_SHOW);
};
e.prototype._onResetRoom = function(e, t) {
t.sTime = e.stime;
t.total_user = e.total_user;
t.roomData.refresh(e.room_data);
t.deal_card = e.room_data.deal_card;
t.show_card = e.room_data.show_card;
i.default.Instance.Global.emit(n.GameEvent.S2C_RESET);
i.default.Instance.Global.emit(u.CompositeUIEvent.UI_MEMBER_COUNT_CHANGE, t.total_user);
};
e.prototype._onInteract = function(e) {
i.default.Instance.Global.emit(n.GameEvent.S2C_INTERACT, e);
};
e.prototype._onRank = function(e, t) {
t.sTime = e.stime;
null != e.total_user && (t.total_user = e.total_user);
t.rankData.refresh(e.rank);
i.default.Instance.Global.emit(n.GameEvent.S2C_AB_RANK, t.rankData);
};
e.prototype._onLeave = function(e, t) {
t.sTime = e.stime;
i.default.Instance.Global.emit(n.GameEvent.S2C_LEAVE);
};
e.prototype._onLeaveSingle = function(e, t) {
t.sTime = e.stime;
i.default.Instance.Global.emit(n.GameEvent.S2C_LEAVE_SINGLE, e);
};
e.prototype._onDismiss = function(e) {
i.default.Instance.Global.emit(n.GameEvent.S2C_DISMISS_ROOM, e);
};
e.prototype._onBalanceRefresh = function(e, t) {
var o = a.Tools.TNumber.num2single(e.total_fee);
t.total_fee = o;
var l = t.getUserData(r.VM.getValue("user.uid"));
l && (l.total_fee = o);
s.WalletProxy.Instance.refreshWallet(e);
i.default.Instance.Global.emit(n.GameEvent.S2C_SEND_AVAILABLE_BALANCE);
};
return e;
}();
o.CompositeProxy = h;
cc._RF.pop();
}, {
"../../../Game/client/global/enum/game/Event": "Event",
"../../../Game/fromework/global/Tools": "Tools",
"../../../Game/fromework/helper/EventHelper": "EventHelper",
"../../../Game/fromework/mvvm/modelView/ViewModel": "ViewModel",
"../../../client/model/WalletModel": "WalletModel",
"../../../platform/Platform": "Platform",
"./CompositeConst": "CompositeConst",
"./CompositeEvent": "CompositeEvent",
"./CompositeStruct": "CompositeStruct"
} ],
CompositeRankHead: [ function(e, t, o) {
"use strict";
cc._RF.push(t, "4f452UZRqNGN73vJ2Fm3guM", "CompositeRankHead");
var n, a = this && this.__extends || (n = function(e, t) {
return (n = Object.setPrototypeOf || {
__proto__: []
} instanceof Array && function(e, t) {
e.__proto__ = t;
} || function(e, t) {
for (var o in t) Object.prototype.hasOwnProperty.call(t, o) && (e[o] = t[o]);
})(e, t);
}, function(e, t) {
n(e, t);
function o() {
this.constructor = e;
}
e.prototype = null === t ? Object.create(t) : (o.prototype = t.prototype, new o());
}), i = this && this.__decorate || function(e, t, o, n) {
var a, i = arguments.length, r = i < 3 ? t : null === n ? n = Object.getOwnPropertyDescriptor(t, o) : n;
if ("object" == typeof Reflect && "function" == typeof Reflect.decorate) r = Reflect.decorate(e, t, o, n); else for (var l = e.length - 1; l >= 0; l--) (a = e[l]) && (r = (i < 3 ? a(r) : i > 3 ? a(t, o, r) : a(t, o)) || r);
return i > 3 && r && Object.defineProperty(t, o, r), r;
};
Object.defineProperty(o, "__esModule", {
value: !0
});
var r = e("../../../Game/client/global/enum/game/UIUtils"), l = e("../../../Game/fromework/global/Tools"), s = cc._decorator, c = s.ccclass, u = s.property, d = function(e) {
a(t, e);
function t() {
var t = null !== e && e.apply(this, arguments) || this;
t.Icon_Empty = null;
t.Icon_Image = null;
t.Name_Text = null;
t.Money_Value = null;
t.SpriteFrame_Man = null;
t.SpriteFrame_Woman = null;
t._icon_url = "";
return t;
}
t.prototype._empty = function() {
this.Icon_Empty.active = !0;
this.Icon_Image.spriteFrame = null;
this.Icon_Image.node.active = !1;
this.Name_Text.string = "";
this.Money_Value.string = "";
};
t.prototype._refreshIcon = function(e, t) {
var o = !t || 1 == t;
if (null == e) {
this._icon_url = null;
this.Icon_Image.node.active = !1;
this.Icon_Empty.active = !0;
this.Icon_Image.spriteFrame = o ? this.SpriteFrame_Man : this.SpriteFrame_Woman;
this.Icon_Image.node.width = 100;
this.Icon_Image.node.height = 100;
} else if ("" == e) {
this._icon_url = "";
this.Icon_Image.node.active = !0;
this.Icon_Empty.active = !1;
this.Icon_Image.spriteFrame = o ? this.SpriteFrame_Man : this.SpriteFrame_Woman;
this.Icon_Image.node.width = 100;
this.Icon_Image.node.height = 100;
} else {
this._icon_url != e && (this._icon_url = e);
r.UIUtils.updateHeadImage(e, this.Icon_Image, cc.size(100, 100));
}
};
t.prototype._refreshName = function(e) {
this.Name_Text.string = l.Tools.TStr.ellipsisString(e, 12);
};
t.prototype._refreshMoney = function(e) {
this.Money_Value.string = "" + e;
};
t.prototype._refreshHead = function(e) {
this._refreshIcon(e.head_url);
this._refreshName(e.name);
this._refreshMoney(e.fee);
};
t.prototype.refreshHead = function(e) {
e ? this._refreshHead(e) : this._empty();
};
i([ u(cc.Node) ], t.prototype, "Icon_Empty", void 0);
i([ u(cc.Sprite) ], t.prototype, "Icon_Image", void 0);
i([ u(cc.Label) ], t.prototype, "Name_Text", void 0);
i([ u(cc.Label) ], t.prototype, "Money_Value", void 0);
i([ u(cc.SpriteFrame) ], t.prototype, "SpriteFrame_Man", void 0);
i([ u(cc.SpriteFrame) ], t.prototype, "SpriteFrame_Woman", void 0);
return i([ c ], t);
}(cc.Component);
o.default = d;
cc._RF.pop();
}, {
"../../../Game/client/global/enum/game/UIUtils": "UIUtils",
"../../../Game/fromework/global/Tools": "Tools"
} ],
CompositeScene: [ function(e, t, o) {
"use strict";
cc._RF.push(t, "30c41XpRtRLkJ0ZzdhK/Ap0", "CompositeScene");
var n, a = this && this.__extends || (n = function(e, t) {
return (n = Object.setPrototypeOf || {
__proto__: []
} instanceof Array && function(e, t) {
e.__proto__ = t;
} || function(e, t) {
for (var o in t) Object.prototype.hasOwnProperty.call(t, o) && (e[o] = t[o]);
})(e, t);
}, function(e, t) {
n(e, t);
function o() {
this.constructor = e;
}
e.prototype = null === t ? Object.create(t) : (o.prototype = t.prototype, new o());
}), i = this && this.__decorate || function(e, t, o, n) {
var a, i = arguments.length, r = i < 3 ? t : null === n ? n = Object.getOwnPropertyDescriptor(t, o) : n;
if ("object" == typeof Reflect && "function" == typeof Reflect.decorate) r = Reflect.decorate(e, t, o, n); else for (var l = e.length - 1; l >= 0; l--) (a = e[l]) && (r = (i < 3 ? a(r) : i > 3 ? a(t, o, r) : a(t, o)) || r);
return i > 3 && r && Object.defineProperty(t, o, r), r;
};
Object.defineProperty(o, "__esModule", {
value: !0
});
var r = e("../../Game/BundleManager"), l = e("../../Game/client/global/enum/game/Const"), s = e("../../Game/client/global/enum/game/Event"), c = e("../../Game/client/logic/game/GameHelper"), u = e("../../Game/fromework/global/ResLoader"), d = e("../../Game/fromework/helper/AudioHelper"), p = e("../../Game/fromework/helper/EventHelper"), h = e("../../Game/fromework/helper/UIHelper"), f = e("../../Game/fromework/mvvm/modelView/ViewModel"), _ = e("../../platform/Platform"), m = e("../../client/component/NetworkDelay"), y = e("../../client/global/PopHelper"), g = e("../../client/logic/game/HearBeat"), v = e("../../client/logic/Wallet/WalletHelper"), C = e("./Utils/CompositeConst"), b = e("./Utils/CompositeEvent"), I = e("./Utils/CompositeUtil"), E = cc._decorator, S = E.ccclass, T = E.property, R = function(e) {
a(t, e);
function t() {
var t = null !== e && e.apply(this, arguments) || this;
t.GameMethod = C.PlayMethod.AndarBahar;
t.Background = null;
t.UILayer = null;
t.TopLayer = null;
t._roomID = 0;
return t;
}
t.prototype._init = function() {
this._initHead();
};
t.prototype._initChip = function() {
var e = I.default.Game.Model, t = I.default.Game.GameMethod, o = cc.sys.localStorage.getItem(f.VM.getValue("user.uid") + "CompositeChipIndex" + t);
null == o && (o = 0);
this.scheduleOnce(function() {
p.default.Instance.Global.emit(b.BetChipEvent.BET_CHIP_CLICK, e.bet_fee_currency[parseInt(o)] / 1e3);
});
};
t.prototype._initHead = function() {
for (var e = 0; e < 10; e++) {
var t = {
type: 0,
index: e,
head: null
};
p.default.Instance.Global.emit(b.UserEvent.USER_REFRESH_DATA, t);
}
};
t.prototype._initNetworkDelay = function() {
h.default.Instance.addBundleLayer(l.BundleUIPath.NetworkDelay, function(e) {
e.getComponent(m.default).init(!0);
});
};
t.prototype._joinRoom = function() {
this._roomID = f.VM.getValue("lobby.roomID");
I.default.Game.Proxy.sendEnterRoom(this._roomID);
};
t.prototype._onEnterRoom = function() {
this._initChip();
};
t.prototype._onSwitchRoom = function(e) {
var t = e.getUserData();
I.default.Game.Proxy.sendEnterRoom(t);
};
t.prototype._onReset = function() {};
t.prototype._onLeaveSingle = function() {
this._leaveRoom();
};
t.prototype._leaveRoom = function(e) {
void 0 === e && (e = !1);
y.PopHelper.Instance.closeCountdown(this._roomID);
y.PopHelper.Instance.showWaiting(1);
I.default.Game.Proxy.clear();
c.Countdown.clear();
for (var t = [ "resources/prefab/ui/LobbyTopView", "resources/prefab/ui/LobbyRooms" ], o = 0, n = 0; n < t.length; n++) u.default.Instance.loadBundleRes(t[n], cc.Prefab, function() {
if (++o == t.length) {
y.PopHelper.Instance.hideWaiting();
f.VM.setValue("lobby.roomID", 0);
r.default.getInstance().enterBundleScene(l.Scene.Lobby, function() {
e && v.default.Instance.openRecharge();
});
_.default.setOrientation(l.Orientation.Landscape);
}
});
};
t.prototype.onEnable = function() {
p.default.Instance.Global.bind(s.GameEvent.S2C_ENTER_ROOM, this._onEnterRoom, this);
p.default.Instance.Global.bind(s.GameEvent.S2C_SWITCH_ROOM, this._onSwitchRoom, this);
p.default.Instance.Global.bind(s.GameEvent.S2C_RESET, this._onReset, this);
p.default.Instance.Global.bind(s.GameEvent.S2C_LEAVE_SINGLE, this._onLeaveSingle, this);
p.default.Instance.Global.bind(s.GameEvent.S2C_DISMISS_ROOM, this._onLeaveSingle, this);
p.default.Instance.Global.bind(s.GameEvent.TABLE_REFRESH_TABLE, this._joinRoom, this);
};
t.prototype.onDisable = function() {
p.default.Instance.Global.unbind(s.GameEvent.S2C_ENTER_ROOM, this._onEnterRoom, this);
p.default.Instance.Global.unbind(s.GameEvent.S2C_SWITCH_ROOM, this._onSwitchRoom, this);
p.default.Instance.Global.unbind(s.GameEvent.S2C_RESET, this._onReset, this);
p.default.Instance.Global.unbind(s.GameEvent.S2C_LEAVE_SINGLE, this._onLeaveSingle, this);
p.default.Instance.Global.unbind(s.GameEvent.S2C_DISMISS_ROOM, this._onLeaveSingle, this);
p.default.Instance.Global.unbind(s.GameEvent.TABLE_REFRESH_TABLE, this._joinRoom, this);
};
t.prototype.onDestroy = function() {
this._roomID = 0;
};
t.prototype.onLoad = function() {
d.default.Instance.stopBGM();
this.GameMethod == C.PlayMethod.Roulette ? d.default.Instance.playBGMBundle(l.BundleSoundPath.bgm_roulette) : this.GameMethod == C.PlayMethod.TPWar ? d.default.Instance.playBGMBundle(l.BundleSoundPath.bgm_tpwar) : this.GameMethod == C.PlayMethod.DragonVSTiger || this.GameMethod == C.PlayMethod.SevenUpDown || this.GameMethod == C.PlayMethod.LuckyDice || this.GameMethod == C.PlayMethod.AndarBahar ? d.default.Instance.playBGMBundle(l.BundleSoundPath.bgm_dragonVsTiger) : d.default.Instance.playBGMBundle(l.BundleSoundPath.bgm_game_composite);
y.PopHelper.Instance.addLotoFastMarquee(this.TopLayer);
g.default.Instance.intervalTime = 5e3;
h.default.Instance.setLayers(this.Background, this.UILayer, this.TopLayer);
this._initNetworkDelay();
cc.game.on(cc.game.EVENT_SHOW, this._joinRoom, this);
};
t.prototype.start = function() {
this._init();
this._joinRoom();
};
t.prototype.update = function() {};
i([ T({
type: cc.Enum(C.PlayMethod)
}) ], t.prototype, "GameMethod", void 0);
i([ T(cc.Node) ], t.prototype, "Background", void 0);
i([ T(cc.Node) ], t.prototype, "UILayer", void 0);
i([ T(cc.Node) ], t.prototype, "TopLayer", void 0);
return i([ S ], t);
}(cc.Component);
o.default = R;
cc._RF.pop();
}, {
"../../Game/BundleManager": "BundleManager",
"../../Game/client/global/enum/game/Const": "Const",
"../../Game/client/global/enum/game/Event": "Event",
"../../Game/client/logic/game/GameHelper": "GameHelper",
"../../Game/fromework/global/ResLoader": "ResLoader",
"../../Game/fromework/helper/AudioHelper": "AudioHelper",
"../../Game/fromework/helper/EventHelper": "EventHelper",
"../../Game/fromework/helper/UIHelper": "UIHelper",
"../../Game/fromework/mvvm/modelView/ViewModel": "ViewModel",
"../../client/component/NetworkDelay": "NetworkDelay",
"../../client/global/PopHelper": "PopHelper",
"../../client/logic/Wallet/WalletHelper": "WalletHelper",
"../../client/logic/game/HearBeat": "HearBeat",
"../../platform/Platform": "Platform",
"./Utils/CompositeConst": "CompositeConst",
"./Utils/CompositeEvent": "CompositeEvent",
"./Utils/CompositeUtil": "CompositeUtil"
} ],
CompositeStruct: [ function(e, t, o) {
"use strict";
cc._RF.push(t, "d1e4dib71hByq5byTShOEcF", "CompositeStruct");
Object.defineProperty(o, "__esModule", {
value: !0
});
o.CompositeStruct = void 0;
var n = e("../../../Game/fromework/global/Tools"), a = e("./CompositeUtil");
(function(e) {
function t(e) {
for (var t = a.default.Game.Model.bet_options.length, o = [], n = null != e ? e : [], i = 0; i < t; i++) null == o[i] ? o[i] = new r(n[i]) : o[i].refresh(n[i]);
return o;
}
e.getBetRecordArray = t;
var o = function() {
function e(e) {
this.rid = 0;
this.rtype = "";
this.state = 0;
this.dl = 0;
this.round = 0;
e && this.refresh(e);
}
e.prototype.refresh = function(e) {
this.rid = e.rid;
this.rtype = e.rtype;
this.state = e.state;
this.dl = e.dl;
this.round = e.round;
};
return e;
}();
e.RoomData = o;
var i = function() {
function e(e) {
this.uid = 0;
this.name = "";
this.head_url = "";
this.state = 0;
this.res = 0;
this.total_fee = 0;
this.label = 0;
this.seat = 0;
e && this.refresh(e);
}
e.prototype.refresh = function(e) {
this.uid = e.uid;
this.name = e.name;
this.head_url = e.head_url;
this.state = e.state;
this.res = e.res;
this.total_fee = n.Tools.TNumber.num2single(e.total_fee);
this.label = e.label;
this.seat = e.seat;
};
return e;
}();
e.UserData = i;
var r = function() {
function e(e) {
this.detail = new Map();
this.amount = 0;
e && this.refresh(e);
}
e.prototype.refresh = function(e) {
for (var t = a.default.Game.Model, o = null != e.detail ? e.detail : [], i = 0; i < t.bet_fee_currency.length; i++) this.detail.set(t.bet_fee_currency[i], null != o[t.bet_fee_currency[i]] ? o[t.bet_fee_currency[i]] : 0);
this.amount = null != e.amount ? n.Tools.TNumber.num2single(e.amount) : 0;
};
return e;
}();
e.BetRecord = r;
var l = function() {
function e(e) {
this.bet_record = [];
this.win_fee = 0;
this.total_fee = 0;
e && this.refresh(e);
}
e.prototype.refresh = function(e) {
this.win_fee = n.Tools.TNumber.num2single(e.win_fee);
this.total_fee = n.Tools.TNumber.num2single(e.total_fee);
this.bet_record.splice(0);
this.bet_record = t(e.bet_record);
};
return e;
}();
e.DeclearUserData = l;
var s = function() {
function e(e) {
this.user_data = new Map();
this.other = null;
e && this.refresh(e);
}
e.prototype.refresh = function(e) {
null == this.user_data && (this.user_data = new Map());
for (var t = Object.keys(e.user_data), o = 0; o < t.length; o++) {
var a = new l(e.user_data[t[o]]);
this.user_data.set(t[o], a);
}
if (null == e.other) this.other = {
win_fee: 0
}; else {
e.other.win_fee = n.Tools.TNumber.num2single(e.other.win_fee);
this.other = e.other;
}
};
e.prototype.getWinFeeByUid = function(e) {
return this.user_data.has(e) ? this.user_data.get(e).win_fee : 0;
};
return e;
}();
e.DeclearData = s;
var c = function() {
function e(e) {
this.uid = 0;
this.name = "";
this.head_url = "";
this.fee = 0;
this.count = 0;
e && this.refresh(e);
}
e.prototype.refresh = function(e) {
this.uid = e.uid || 0;
this.name = e.name || "";
this.head_url = e.head_url || "";
this.fee = null != e.fee ? n.Tools.TNumber.num2single(e.fee) : 0;
this.count = e.count || 0;
};
return e;
}();
e.RankUserData = c;
var u = function() {
function e(e) {
this.millionaire = null;
this.lucky = null;
this.other = [];
e && this.refresh(e);
}
e.prototype.refresh = function(e) {
var t = this;
this.millionaire = new c(e[1]);
this.lucky = new c(e[2]);
this.other.splice(0);
e[3].forEach(function(e) {
var o = new c(e);
t.other.push(o);
});
};
return e;
}();
e.RankData = u;
})(o.CompositeStruct || (o.CompositeStruct = {}));
cc._RF.pop();
}, {
"../../../Game/fromework/global/Tools": "Tools",
"./CompositeUtil": "CompositeUtil"
} ],
CompositeUI: [ function(e, t, o) {
"use strict";
cc._RF.push(t, "c6faf+h+WZMv5bt+RPb6M3d", "CompositeUI");
var n, a = this && this.__extends || (n = function(e, t) {
return (n = Object.setPrototypeOf || {
__proto__: []
} instanceof Array && function(e, t) {
e.__proto__ = t;
} || function(e, t) {
for (var o in t) Object.prototype.hasOwnProperty.call(t, o) && (e[o] = t[o]);
})(e, t);
}, function(e, t) {
n(e, t);
function o() {
this.constructor = e;
}
e.prototype = null === t ? Object.create(t) : (o.prototype = t.prototype, new o());
}), i = this && this.__decorate || function(e, t, o, n) {
var a, i = arguments.length, r = i < 3 ? t : null === n ? n = Object.getOwnPropertyDescriptor(t, o) : n;
if ("object" == typeof Reflect && "function" == typeof Reflect.decorate) r = Reflect.decorate(e, t, o, n); else for (var l = e.length - 1; l >= 0; l--) (a = e[l]) && (r = (i < 3 ? a(r) : i > 3 ? a(t, o, r) : a(t, o)) || r);
return i > 3 && r && Object.defineProperty(t, o, r), r;
};
Object.defineProperty(o, "__esModule", {
value: !0
});
var r = e("../../../Game/client/global/enum/game/Const"), l = e("../../../Game/fromework/global/ResLoader"), s = e("../../../Game/fromework/helper/EventHelper"), c = e("../../../Game/fromework/helper/UIHelper"), u = e("../../../platform/Platform"), d = e("../../../client/logic/Wallet/WalletHelper"), p = e("../Component/CompositePlayerHead"), h = e("../Utils/CompositeConst"), f = e("../Utils/CompositeEvent"), _ = e("../Utils/CompositeUtil"), m = cc._decorator, y = m.ccclass, g = m.property, v = function(e) {
a(t, e);
function t() {
var t = null !== e && e.apply(this, arguments) || this;
t.SelfHeadInfoBG = null;
t.MemberCount = null;
t.SelfHead = null;
t._gameMethod = h.PlayMethod.AndarBahar;
return t;
}
Object.defineProperty(t.prototype, "GameMethod", {
get: function() {
return this._gameMethod;
},
set: function(e) {
this._gameMethod = e;
},
enumerable: !1,
configurable: !0
});
t.prototype.onBackClick = function() {
_.default.Game.Proxy.sendLeave();
};
t.prototype.onHelpClick = function() {
h.PlayMethod.AndarBahar == this.GameMethod ? c.default.Instance.addBundleMaskLayer(r.BundleUIPath.ABHelp) : h.PlayMethod.RedAndBlack == this.GameMethod ? c.default.Instance.addBundleMaskLayer(r.BundleUIPath.RBHelp) : h.PlayMethod.LuckyDice == this.GameMethod ? c.default.Instance.addBundleMaskLayer(r.BundleUIPath.LuckyDiceHelp) : h.PlayMethod.DragonVSTiger == this.GameMethod ? c.default.Instance.addBundleMaskLayer(r.BundleUIPath.DTHelp) : h.PlayMethod.SevenUpDown == this.GameMethod ? c.default.Instance.addBundleMaskLayer(r.BundleUIPath.SUDHelp) : h.PlayMethod.TraditionAndarBahar == this.GameMethod ? c.default.Instance.addBundleMaskLayer(r.BundleUIPath.TraditionABHelp) : h.PlayMethod.TPWar == this.GameMethod ? c.default.Instance.addBundleMaskLayer(r.BundleUIPath.TPWarHelp) : h.PlayMethod.Roulette == this.GameMethod && c.default.Instance.addBundleMaskLayer(r.BundleUIPath.RouletteHelp);
};
t.prototype.onHistoryClick = function() {
h.PlayMethod.AndarBahar == this.GameMethod ? c.default.Instance.addBundleMaskLayer(r.BundleUIPath.ABRecord) : h.PlayMethod.RedAndBlack == this.GameMethod ? c.default.Instance.addBundleMaskLayer(r.BundleUIPath.RBRecord) : h.PlayMethod.LuckyDice == this.GameMethod ? c.default.Instance.addBundleMaskLayer(r.BundleUIPath.LuckyDiceRecord) : h.PlayMethod.DragonVSTiger == this.GameMethod ? c.default.Instance.addBundleMaskLayer(r.BundleUIPath.DTRecord) : h.PlayMethod.SevenUpDown == this.GameMethod ? c.default.Instance.addBundleMaskLayer(r.BundleUIPath.SUDRecord) : h.PlayMethod.TraditionAndarBahar == this.GameMethod ? c.default.Instance.addBundleMaskLayer(r.BundleUIPath.TraditionABRecord) : h.PlayMethod.TPWar == this.GameMethod ? c.default.Instance.addBundleMaskLayer(r.BundleUIPath.TPWarRecord) : h.PlayMethod.Roulette == this.GameMethod && c.default.Instance.addBundleMaskLayer(r.BundleUIPath.RouletteRecord);
};
t.prototype.onMemberClick = function() {
c.default.Instance.addBundleMaskLayer(r.BundleUIPath.OtherMember);
};
t.prototype.onNoticeClick = function() {
h.PlayMethod.AndarBahar == this.GameMethod ? c.default.Instance.addBundleMaskLayer(r.BundleUIPath.ABRecord) : h.PlayMethod.RedAndBlack == this.GameMethod ? c.default.Instance.addBundleMaskLayer(r.BundleUIPath.RBRecord) : h.PlayMethod.LuckyDice == this.GameMethod ? c.default.Instance.addBundleMaskLayer(r.BundleUIPath.LuckyDiceRecord) : h.PlayMethod.DragonVSTiger == this.GameMethod ? c.default.Instance.addBundleMaskLayer(r.BundleUIPath.DTRecord) : h.PlayMethod.SevenUpDown == this.GameMethod ? c.default.Instance.addBundleMaskLayer(r.BundleUIPath.SUDRecord) : h.PlayMethod.TraditionAndarBahar == this.GameMethod ? c.default.Instance.addBundleMaskLayer(r.BundleUIPath.TraditionABRecord) : h.PlayMethod.TPWar == this.GameMethod ? c.default.Instance.addBundleMaskLayer(r.BundleUIPath.TPWarRecord) : h.PlayMethod.Roulette == this.GameMethod && c.default.Instance.addBundleMaskLayer(r.BundleUIPath.RouletteRecord);
};
t.prototype.onBuyClick = function() {
d.default.Instance.openRecharge();
};
t.prototype._onMemberCountChange = function(e) {
var t = e.getUserData();
this.MemberCount.string = "" + t;
};
t.prototype._init = function() {
var e = this, t = _.default.Game.Model;
this.MemberCount.string = "" + t.total_user;
l.default.Instance.loadBundleRes(h.UI_BG_TEXTURE_PATH + h.UI_SELFHEAD_BG_PATH + this.GameMethod, cc.SpriteFrame, function(t, o) {
t ? u.default.error(t) : e.SelfHeadInfoBG.spriteFrame = o;
});
};
t.prototype.onEnable = function() {
s.default.Instance.Global.bind(f.CompositeUIEvent.UI_MEMBER_COUNT_CHANGE, this._onMemberCountChange, this);
};
t.prototype.onDisable = function() {
s.default.Instance.Global.unbind(f.CompositeUIEvent.UI_MEMBER_COUNT_CHANGE, this._onMemberCountChange, this);
};
t.prototype.onLoad = function() {};
t.prototype.onDestroy = function() {};
t.prototype.start = function() {
this._init();
};
i([ g(cc.Sprite) ], t.prototype, "SelfHeadInfoBG", void 0);
i([ g(cc.Label) ], t.prototype, "MemberCount", void 0);
i([ g(p.default) ], t.prototype, "SelfHead", void 0);
i([ g({
type: cc.Enum(h.PlayMethod)
}) ], t.prototype, "_gameMethod", void 0);
i([ g({
type: cc.Enum(h.PlayMethod),
tooltip: "游戏类型"
}) ], t.prototype, "GameMethod", null);
return i([ y ], t);
}(cc.Component);
o.default = v;
cc._RF.pop();
}, {
"../../../Game/client/global/enum/game/Const": "Const",
"../../../Game/fromework/global/ResLoader": "ResLoader",
"../../../Game/fromework/helper/EventHelper": "EventHelper",
"../../../Game/fromework/helper/UIHelper": "UIHelper",
"../../../client/logic/Wallet/WalletHelper": "WalletHelper",
"../../../platform/Platform": "Platform",
"../Component/CompositePlayerHead": "CompositePlayerHead",
"../Utils/CompositeConst": "CompositeConst",
"../Utils/CompositeEvent": "CompositeEvent",
"../Utils/CompositeUtil": "CompositeUtil"
} ],
CompositeUtil: [ function(e, t, o) {
"use strict";
cc._RF.push(t, "9763bBCiZ9Ob7ItPnUCbX+w", "CompositeUtil");
var n = this && this.__decorate || function(e, t, o, n) {
var a, i = arguments.length, r = i < 3 ? t : null === n ? n = Object.getOwnPropertyDescriptor(t, o) : n;
if ("object" == typeof Reflect && "function" == typeof Reflect.decorate) r = Reflect.decorate(e, t, o, n); else for (var l = e.length - 1; l >= 0; l--) (a = e[l]) && (r = (i < 3 ? a(r) : i > 3 ? a(t, o, r) : a(t, o)) || r);
return i > 3 && r && Object.defineProperty(t, o, r), r;
};
Object.defineProperty(o, "__esModule", {
value: !0
});
var a = e("../../../Game/fromework/mvvm/modelView/ViewModel"), i = e("../../TraditionAndarBahar/Script/TraditionChipManagerGold"), r = e("../Manager/ChipManagerGold"), l = e("../Manager/GameManager"), s = e("../Manager/OddsManager"), c = e("../UI/CompositeEffect"), u = e("../UI/CompositeUI"), d = cc._decorator, p = d.ccclass, h = (d.property, 
function() {
function e() {}
t = e;
e.getGeneratorIndex = function(e) {
if (a.VM.getValue("user.uid") == e) return 7;
var o = t.Game.Model.getUserData(e);
return o ? o.seat : 6;
};
e.getGeneratorUserData = function(e) {
for (var o = t.Game.Model, n = 0; n < o.allUserData.length; n++) {
var a = o.allUserData[n];
if (a.seat == e) return a;
}
return null;
};
e.getChipLayer = function(e) {
void 0 === e && (e = !1);
var t = cc.director.getScene().getChildByName("Canvas");
return (e ? t.getComponentInChildren(i.default) : t.getComponentInChildren(r.default)).node;
};
e.getOddsManager = function() {
return cc.director.getScene().getChildByName("Canvas").getComponentInChildren(s.default);
};
e.getEffect = function() {
return cc.director.getScene().getChildByName("Canvas").getComponentInChildren(c.default);
};
e.getUI = function() {
return cc.director.getScene().getChildByName("Canvas").getComponentInChildren(u.default);
};
Object.defineProperty(e, "Game", {
get: function() {
return cc.director.getScene().getChildByName("Canvas").getComponent(l.default);
},
enumerable: !1,
configurable: !0
});
var t;
return t = n([ p ], e);
}());
o.default = h;
cc._RF.pop();
}, {
"../../../Game/fromework/mvvm/modelView/ViewModel": "ViewModel",
"../../TraditionAndarBahar/Script/TraditionChipManagerGold": "TraditionChipManagerGold",
"../Manager/ChipManagerGold": "ChipManagerGold",
"../Manager/GameManager": "GameManager",
"../Manager/OddsManager": "OddsManager",
"../UI/CompositeEffect": "CompositeEffect",
"../UI/CompositeUI": "CompositeUI"
} ],
CompositeWinMoney: [ function(e, t, o) {
"use strict";
cc._RF.push(t, "89c5cefKs5Hv6m5c799bLUK", "CompositeWinMoney");
var n, a = this && this.__extends || (n = function(e, t) {
return (n = Object.setPrototypeOf || {
__proto__: []
} instanceof Array && function(e, t) {
e.__proto__ = t;
} || function(e, t) {
for (var o in t) Object.prototype.hasOwnProperty.call(t, o) && (e[o] = t[o]);
})(e, t);
}, function(e, t) {
n(e, t);
function o() {
this.constructor = e;
}
e.prototype = null === t ? Object.create(t) : (o.prototype = t.prototype, new o());
}), i = this && this.__decorate || function(e, t, o, n) {
var a, i = arguments.length, r = i < 3 ? t : null === n ? n = Object.getOwnPropertyDescriptor(t, o) : n;
if ("object" == typeof Reflect && "function" == typeof Reflect.decorate) r = Reflect.decorate(e, t, o, n); else for (var l = e.length - 1; l >= 0; l--) (a = e[l]) && (r = (i < 3 ? a(r) : i > 3 ? a(t, o, r) : a(t, o)) || r);
return i > 3 && r && Object.defineProperty(t, o, r), r;
};
Object.defineProperty(o, "__esModule", {
value: !0
});
var r = e("../../../Game/client/global/enum/game/Event"), l = e("../../../Game/fromework/global/Tools"), s = e("../../../Game/fromework/helper/EventHelper"), c = e("../Utils/CompositeEvent"), u = cc._decorator, d = u.ccclass, p = u.property, h = function(e) {
a(t, e);
function t() {
var t = null !== e && e.apply(this, arguments) || this;
t.Win_Money = null;
t.FontSize = 40;
t._index = 0;
return t;
}
Object.defineProperty(t.prototype, "Index", {
get: function() {
return this._index;
},
set: function(e) {
this._index = e;
this._init();
},
enumerable: !1,
configurable: !0
});
t.prototype.init = function(e) {
this.Index = e;
};
t.prototype._init = function() {};
t.prototype.onEnable = function() {
s.default.Instance.Global.bind(c.UserEvent.USER_WIN_MONEY, this._onUserWin, this);
};
t.prototype.onDisable = function() {
s.default.Instance.Global.unbind(c.UserEvent.USER_WIN_MONEY, this._onUserWin, this);
};
t.prototype.onLoad = function() {
this.Win_Money.fontSize = this.FontSize;
};
t.prototype._onUserWin = function(e) {
var t = this, o = e.getUserData();
if (o.index == this.Index && 0 != o.money) {
var n = this.Win_Money.node.parent;
this.Win_Money.string = "+" + l.Tools.TNumber.numFixed(o.money, 2);
n.opacity = 0;
n.y -= 10;
n.active = !0;
n.stopAllActions();
6 == this._index && s.default.Instance.Global.emit(r.TipsEvent.TIPS_SYSTEM_WITHDRAW_ALERT);
cc.tween(n).to(.5, {
y: 0,
opacity: 255
}).delay(1.5).call(function() {
t && t.node && t.node.isValid && (n.active = !1);
}).start();
}
};
i([ p(cc.Label) ], t.prototype, "Win_Money", void 0);
i([ p ], t.prototype, "FontSize", void 0);
i([ p({
step: 1,
min: 0,
max: 7
}) ], t.prototype, "_index", void 0);
i([ p({
step: 1,
min: 0,
max: 7
}) ], t.prototype, "Index", null);
return i([ d ], t);
}(cc.Component);
o.default = h;
cc._RF.pop();
}, {
"../../../Game/client/global/enum/game/Event": "Event",
"../../../Game/fromework/global/Tools": "Tools",
"../../../Game/fromework/helper/EventHelper": "EventHelper",
"../Utils/CompositeEvent": "CompositeEvent"
} ],
ConfigHelper: [ function(e, t, o) {
"use strict";
cc._RF.push(t, "3825cetoqxBe6lpf4U+SPDV", "ConfigHelper");
var n = this && this.__awaiter || function(e, t, o, n) {
return new (o || (o = Promise))(function(a, i) {
function r(e) {
try {
s(n.next(e));
} catch (e) {
i(e);
}
}
function l(e) {
try {
s(n.throw(e));
} catch (e) {
i(e);
}
}
function s(e) {
e.done ? a(e.value) : (t = e.value, t instanceof o ? t : new o(function(e) {
e(t);
})).then(r, l);
var t;
}
s((n = n.apply(e, t || [])).next());
});
}, a = this && this.__generator || function(e, t) {
var o, n, a, i, r = {
label: 0,
sent: function() {
if (1 & a[0]) throw a[1];
return a[1];
},
trys: [],
ops: []
};
return i = {
next: l(0),
throw: l(1),
return: l(2)
}, "function" == typeof Symbol && (i[Symbol.iterator] = function() {
return this;
}), i;
function l(e) {
return function(t) {
return s([ e, t ]);
};
}
function s(i) {
if (o) throw new TypeError("Generator is already executing.");
for (;r; ) try {
if (o = 1, n && (a = 2 & i[0] ? n.return : i[0] ? n.throw || ((a = n.return) && a.call(n), 
0) : n.next) && !(a = a.call(n, i[1])).done) return a;
(n = 0, a) && (i = [ 2 & i[0], a.value ]);
switch (i[0]) {
case 0:
case 1:
a = i;
break;

case 4:
r.label++;
return {
value: i[1],
done: !1
};

case 5:
r.label++;
n = i[1];
i = [ 0 ];
continue;

case 7:
i = r.ops.pop();
r.trys.pop();
continue;

default:
if (!(a = r.trys, a = a.length > 0 && a[a.length - 1]) && (6 === i[0] || 2 === i[0])) {
r = 0;
continue;
}
if (3 === i[0] && (!a || i[1] > a[0] && i[1] < a[3])) {
r.label = i[1];
break;
}
if (6 === i[0] && r.label < a[1]) {
r.label = a[1];
a = i;
break;
}
if (a && r.label < a[2]) {
r.label = a[2];
r.ops.push(i);
break;
}
a[2] && r.ops.pop();
r.trys.pop();
continue;
}
i = t.call(e, r);
} catch (e) {
i = [ 6, e ];
n = 0;
} finally {
o = a = 0;
}
if (5 & i[0]) throw i[1];
return {
value: i[0] ? i[1] : void 0,
done: !0
};
}
};
Object.defineProperty(o, "__esModule", {
value: !0
});
o.ConfigHelper = void 0;
var i = e("../../../Game/BundleManager"), r = e("../../../platform/Platform"), l = function() {
function e() {
this.configMap = null;
}
Object.defineProperty(e, "Instance", {
get: function() {
e._Instance || (e._Instance = new e());
return e._Instance;
},
enumerable: !1,
configurable: !0
});
e.prototype.init = function() {
this.configMap = new Map();
};
e.prototype.loadAllConfig = function(e, t, o) {
void 0 === t && (t = null);
void 0 === o && (o = null);
return n(this, void 0, Promise, function() {
var n = this;
return a(this, function(a) {
switch (a.label) {
case 0:
return [ 4, i.default.getInstance().getGameBundle() ];

case 1:
a.sent().loadDir(e, cc.JsonAsset, function(e, o) {
t && t(e, o);
}, function(e, t) {
if (e) r.default.error(e); else {
for (var a = 0; a < t.length; ++a) {
var i = t[a], l = i.json, s = i.name;
n.configMap.set(s, new Map());
for (var c = n.configMap.get(s), u = 0; u < l.length; ++u) for (var d in l[u]) {
c.set(l[u][d], l[u]);
break;
}
}
o && o();
}
});
return [ 2 ];
}
});
});
};
e.prototype.release = function() {
this.configMap.forEach(function(e) {
e.clear();
});
this.configMap.clear();
};
e.prototype.getConfigCount = function() {
return this.configMap.size;
};
e.prototype.getConfig = function(e) {
if (!this.configMap.has(e)) {
r.default.warn("[ERROR]:" + e + " is not exist!");
return null;
}
return this.configMap.get(e);
};
e.prototype.getLine = function(e, t) {
var o = null;
if (!(o = this.getConfig(e))) return null;
if (!o.has(t)) {
r.default.warn("[ERROR]:" + e + " at line:" + t + " is invalid!");
return null;
}
return o.get(t);
};
e.prototype.getValue = function(e, t, o) {
var n;
if (!(n = this.getLine(e, t))) return null;
if (!n[o]) {
r.default.warn("[ERROR]:" + e + " at line:" + t + "on key:" + o + " is invalid!");
return null;
}
return n[o];
};
e._Instance = null;
return e;
}();
o.ConfigHelper = l;
cc._RF.pop();
}, {
"../../../Game/BundleManager": "BundleManager",
"../../../platform/Platform": "Platform"
} ],
Config: [ function(e, t, o) {
"use strict";
cc._RF.push(t, "7e6e0SuPYxAYIBwMNf1ONRs", "Config");
Object.defineProperty(o, "__esModule", {
value: !0
});
o.Config = void 0;
o.Config = {
IFSCUrl: "https://economictimes.indiatimes.com/wealth/ifsc-bank-code",
Channel: "Sagar",
PrivatePolicyUrl: "http://tysdw.trerpotv.xyz/3pncsslag.html",
TermsServiceUrl: "http://tysdw.trerpotv.xyz/service.html",
ContactUsUrl: "http://tysdw.trerpotv.xyz/about.html"
};
cc._RF.pop();
}, {} ],
Const: [ function(e, t, o) {
"use strict";
cc._RF.push(t, "49cf836ty5N9alWmrDYwuzf", "Const");
Object.defineProperty(o, "__esModule", {
value: !0
});
o.UIPath = o.BundleUIPath = o.SoundPath = o.BundleSoundPath = o.LoginType = o.Orientation = o.Layer = o.Scene = o.LotteryCostType = o.FailMoneySymbol = o.MoneySymbol = o.MaxSingleWidthdraw = o.MinSingleWidthdraw = o.RechargeMiddle = o.RechargeLittle = o.RechargeGear = o.MaxSingleRecharge = o.MinSingleRecharge = o.PhoneNumberLength = o.MAX_TABLE_COUNT = o.TOTAL_GAME_SCORE = o.SCALE_DESK = o.SCALE_LINE_DOWN = o.SCALE_LINE_UP = o.HEAD_ZINDEX = o.WILD_CARD_ZINDEX = o.DECK_ZINDEX = o.DEALER_ZINDEX = o.CARD_ZINDEX = o.GROUP_ZINDEX = o.OTHER_CARD_SCALE = o.DESK_CARD_ROTATE_WILD = o.DESK_CARD_SCALE_WILD = o.DESK_CARD_SCALE = o.HAND_CARD_SCALE = o.CARD_HAND_POS_Y = o.CARD_SHOW_WIDTH = o.CARD_WIDTH = o.GROUP_DEFAULT_WIDTH = o.CARD_SHOW_WIDTH_NARROW = o.CARD_WIDTH_NARROW = o.GROUP_DEFAULT_WIDTH_NARROW = o.MAX_GROUPCOUNT = void 0;
o.MAX_GROUPCOUNT = 6;
o.GROUP_DEFAULT_WIDTH_NARROW = 158;
o.CARD_WIDTH_NARROW = 138;
o.CARD_SHOW_WIDTH_NARROW = 46;
o.GROUP_DEFAULT_WIDTH = 179;
o.CARD_WIDTH = 153;
o.CARD_SHOW_WIDTH = 55;
o.CARD_HAND_POS_Y = -150;
o.HAND_CARD_SCALE = 1;
o.DESK_CARD_SCALE = .64;
o.DESK_CARD_SCALE_WILD = .64;
o.DESK_CARD_ROTATE_WILD = -15;
o.OTHER_CARD_SCALE = .5;
o.GROUP_ZINDEX = 5e3;
o.CARD_ZINDEX = 800;
o.DEALER_ZINDEX = 700;
o.DECK_ZINDEX = 600;
o.WILD_CARD_ZINDEX = 599;
o.HEAD_ZINDEX = 500;
o.SCALE_LINE_UP = 395;
o.SCALE_LINE_DOWN = 233;
o.SCALE_DESK = .64;
o.TOTAL_GAME_SCORE = 80;
o.MAX_TABLE_COUNT = 3;
o.PhoneNumberLength = 10;
o.MinSingleRecharge = 1;
o.MaxSingleRecharge = 9999;
o.RechargeGear = [ 9e3, 5e3, 1e3, 500, 100, 25 ];
o.RechargeLittle = 299;
o.RechargeMiddle = 999;
o.MinSingleWidthdraw = 100;
o.MaxSingleWidthdraw = 9999;
o.MoneySymbol = "₹";
o.FailMoneySymbol = "G";
o.LotteryCostType = [ "", "[Deposit]", "[Practice]", "[Withdraw]", "[Bonus]" ];
o.Scene = {
Launch: "Launch",
Login: "Login",
Lobby: "Lobby",
Game: "Game",
TeenPatti: "TeenPatti",
AndarBahar: "AndarBahar",
RedAndBlack: "RedAndBlack",
LuckyDice: "LuckyDice",
DragonVSTiger: "DragonVSTiger",
SevenUpDown: "SevenUpDown",
TraditionAndarBahar: "TraditionAndarBahar",
BlastSpace: "BlastSpace",
TPWar: "TPWar",
Roulette: "Roulette",
Slot: "Slot_200"
};
o.Layer = {
Canvas: "Canvas",
UILayer: "UILayer",
BGLayer: "BGLayer",
TopLayer: "TopLayer"
};
o.Orientation = {
Portrait: "PORTRAIT",
Landscape: "LANDSCAPE"
};
o.LoginType = {
Guest: "guest",
Phone: "phone",
FaceBook: "facebook",
Google: "google",
GameCenter: "GameCenter"
};
o.BundleSoundPath = {
bgm_game: "resources/sound/bgm/bgm_game",
bgm_lobby: "resources/sound/bgm/bgm_lobby",
bgm_game_composite: "resources/sound/bgm/bgm_game_composite",
bgm_roulette: "resources/sound/bgm/bgm_roulette",
bgm_slot_200: "resources/sound/bgm/bgm_slot_200",
bgm_tpwar: "resources/sound/bgm/bgm_tpwar",
bgm_loto: "resources/sound/bgm/bgm_loto",
bgm_christmas: "resources/sound/bgm/bgm_christmas",
bgm_dragonVsTiger: "resources/sound/bgm/bgm_dragonVsTiger",
common_button_click: "resources/sound/common/common_button_click",
common_chip: "resources/sound/common/common_chip",
common_chip_collect: "resources/sound/common/common_chip_collect",
common_discard: "resources/sound/common/common_discard",
common_draw: "resources/sound/common/common_draw",
common_shuffle_cards: "resources/sound/common/common_shuffle_cards",
common_win: "resources/sound/common/common_win",
composite_dice_drop: "resources/sound/composite/composite_dice_drop",
composite_odds_stop: "resources/sound/composite/composite_odds_stop",
composite_countdown_0: "resources/sound/composite/composite_countdown_0",
composite_countdown_1: "resources/sound/composite/composite_countdown_1",
composite_dice_shake: "resources/sound/composite/composite_dice_shake",
composite_start_betting: "resources/sound/composite/composite_start_betting",
composite_stop_betting: "resources/sound/composite/composite_stop_betting",
sud_dice_drop: "resources/sound/composite/sud_dice_drop",
dt_dragon_win: "resources/sound/composite/dt_dragon_win",
dt_tie_win: "resources/sound/composite/dt_tie_win",
dt_tiger_win: "resources/sound/composite/dt_tiger_win",
roulette_car_run: "resources/sound/composite/roulette_car_run",
tpwar_king_win: "resources/sound/composite/tpwar_king_win",
tpwar_queen_win: "resources/sound/composite/tpwar_queen_win",
rummy_finish: "resources/sound/rummy/rummy_finish",
rummy_five_seconds: "resources/sound/rummy/rummy_five_seconds",
rummy_own_round: "resources/sound/rummy/rummy_own_round",
slot_bigwin_cheer: "resources/sound/slot/slot_bigwin_cheer",
slot_bigwin_gold: "resources/sound/slot/slot_bigwin_gold",
slot_line: "resources/sound/slot/slot_line",
slot_scatter_track: "resources/sound/slot/slot_scatter_track",
slot_spin_start: "resources/sound/slot/slot_spin_start",
slot_spin_stop: "resources/sound/slot/slot_spin_stop",
slot_tab_change: "resources/sound/slot/slot_tab_change",
tp_chip_collect: "resources/sound/teenpatti/tp_chip_collect",
tp_compare: "resources/sound/teenpatti/tp_compare",
tp_pack: "resources/sound/teenpatti/tp_pack",
tp_seen: "resources/sound/teenpatti/tp_seen",
tp_side_show: "resources/sound/teenpatti/tp_side_show",
tp_vs: "resources/sound/teenpatti/tp_vs",
blast_boom: "resources/sound/composite/blast_boom",
blast_flying: "resources/sound/composite/blast_flying",
blast_takeoff: "resources/sound/composite/blast_takeoff"
};
o.SoundPath = {};
o.BundleUIPath = {
BrokeActive: "resources/prefab/active/Broke/BrokeActive",
BrokeMonthCard: "resources/prefab/active/Broke/BrokeMonthCard",
BrokeNormal: "resources/prefab/active/Broke/BrokeNormal",
FirstCharge: "resources/prefab/active/FirstCharge/FirstCharge",
Recharge: "resources/prefab/active/Recharge/RechagerActivity",
ChairAlert: "resources/prefab/ui/ChairAlert/ChairAlert",
WithdrawChargeAlert: "resources/prefab/ui/WithdrawChargeAlert/WithdrawChargeAlert",
LotoView: "resources/prefab/active/Loto/LotoView",
Card: "resources/prefab/component/Card",
Tips: "resources/prefab/component/Tips",
CountDown: "resources/prefab/component/CountDown",
Alert: "resources/prefab/component/Alert",
TableMenu: "resources/prefab/component/TableMenu",
ScoreWindow: "resources/prefab/ui/ScoreWindow",
BestDeclare: "resources/prefab/ui/BestDeclare",
CardRecorder: "resources/prefab/ui/CardRecorder",
Waiting: "resources/prefab/component/Waiting",
ScoreBoard: "resources/prefab/ui/game/ScoreBoard",
TotalResult: "resources/prefab/ui/game/TotalResult",
SplitPrize: "resources/prefab/ui/game/SplitPrize",
AddCashVIP: "resources/prefab/ui/AddCashVIP/AddCashVIP",
NumericEditorBox: "resources/prefab/component/NumericEditorBox",
WithdrawAlert: "resources/prefab/component/WithdrawAlert",
WithdrawCheckAlert: "resources/prefab/component/WithdrawCheckAlert",
WithdrawLimitAlert: "resources/prefab/component/WithdrawLimitAlert",
TableBoard: "resources/prefab/game/TableBoard",
AddCash: "resources/prefab/ui/AddCash/AddCash",
Activity: "resources/prefab/ui/AddCash/Activity",
AddCashActivity: "resources/prefab/ui/AddCash/AddCashActivity",
LobbyView: "resources/prefab/ui/Lobby/LobbyView",
BindAlert: "resources/prefab/component/BindAlert",
WalletMain: "resources/prefab/Wallet/WalletMain",
WalletWithdraw: "resources/prefab/Wallet/WalletWithdraw",
WalletActivity: "resources/prefab/Wallet/WalletActivity",
WalletRecharge: "resources/prefab/Wallet/WalletRecharge",
WalletInfoAlert: "resources/prefab/Wallet/WalletInfoAlert",
WalletKYC: "resources/prefab/Wallet/WalletKYC",
WalletSelectImg: "resources/prefab/Wallet/WalletSelectImg",
BonusRecord: "resources/prefab/Wallet/BonusRecord",
RechargeView: "resources/prefab/Wallet/RechargeView",
WalletWithdrawPending: "resources/prefab/Wallet/WalletWithdrawPending",
HelpView: "resources/prefab/ui/HelpView",
GameSetting: "resources/prefab/ui/setting/GameSetting",
RechargeAlert: "resources/prefab/ui/rechargealert/RechargeAlert",
FirstAward: "resources/prefab/ui/FirstAward",
Notice: "resources/prefab/ui/notice/Notice",
UpdateNotice: "resources/prefab/ui/updateNotice/UpdateNotice",
UserSetting: "resources/prefab/ui/setting/UserSetting",
LobbySetting: "resources/prefab/ui/setting/LobbySetting",
MailDetail: "resources/prefab/ui/MailDetail",
GameSetView: "resources/prefab/ui/setting/GameSetView",
GameInfo: "resources/prefab/game/GameInfo",
UserInfo: "resources/prefab/ui/UserInfo/UserInfo",
Calender: "resources/prefab/ui/calender/Calender",
MailUI: "resources/prefab/ui/MailUI",
ShopView: "resources/prefab/ui/Shop/ShopView",
RewardView: "resources/prefab/ui/reward/RewardView",
MonthCard: "resources/prefab/ui/MonthCard/MonthCard",
MonthCardLobbyView: "resources/prefab/ui/MonthCard/MonthCardLobbyView",
MonthCardItem: "resources/prefab/ui/MonthCard/MonthCardItem",
MonthCardLight: "resources/prefab/ui/MonthCard/MonthCardLight",
MonthCardUpdate: "resources/prefab/ui/MonthCard/MonthCardUpdate",
RecentView: "resources/prefab/ui/Recent/RecentView",
RecentPayView: "resources/prefab/ui/Recent/RecentPayView",
RecentDetailOther: "resources/prefab/ui/Recent/RecentDetailOther",
VIPDetail: "resources/prefab/ui/VIP/VIPDetail",
VIPDetailItem: "resources/prefab/ui/VIP/VIPDetailItem",
VIPShop: "resources/prefab/ui/VIP/VIPShop",
VIPShopItem: "resources/prefab/ui/VIP/VIPShopItem",
ServiceView: "resources/prefab/ui/Service/ServiceView",
TaskView: "resources/prefab/ui/Task/TaskView",
ABDealer: "resources/prefab_composite/ab/ABDealer",
ABHelp: "resources/prefab_composite/ab/ABHelp",
ABRecord: "resources/prefab_composite/ab/ABRecord",
RBDealer: "resources/prefab_composite/rb/RBDealer",
RBHelp: "resources/prefab_composite/rb/RBHelp",
RBRecord: "resources/prefab_composite/rb/RBRecord",
LuckyDiceDealer: "resources/prefab_composite/luckydice/LuckyDiceDealer",
LuckyDiceHelp: "resources/prefab_composite/luckydice/LuckyDiceHelp",
LuckyDiceRecord: "resources/prefab_composite/luckydice/LuckyDiceRecord",
DTDealer: "resources/prefab_composite/dragonvstiger/DTDealer",
DTHelp: "resources/prefab_composite/dragonvstiger/DTHelp",
DTRecord: "resources/prefab_composite/dragonvstiger/DTRecord",
SUDDealer: "resources/prefab_composite/sevenupdown/SUDDealer",
SUDHelp: "resources/prefab_composite/sevenupdown/SUDHelp",
SUDRecord: "resources/prefab_composite/sevenupdown/SUDRecord",
TraditionABDealer: "resources/prefab_composite/tranditionab/TraditionABDealer",
TraditionABHelp: "resources/prefab_composite/tranditionab/TraditionABHelp",
TraditionABRecord: "resources/prefab_composite/tranditionab/TraditionABRecord",
TPWarHelp: "resources/prefab_composite/tpwar/TPWarHelp",
TPWarRecord: "resources/prefab_composite/tpwar/TPWarRecord",
RouletteHelp: "resources/prefab_composite/roulette/RouletteHelp",
RouletteRecord: "resources/prefab_composite/roulette/RouletteRecord",
RBFast: "resources/prefab_composite/rbfast/RBFast",
RBFastHelp: "resources/prefab_composite/rbfast/RBFastHelp",
RBFastRecordAlert: "resources/prefab_composite/rbfast/RBFastRecordAlert",
LotoFast: "resources/prefab_composite/lotofast/LotoFast",
LotoFastRecord: "resources/prefab_composite/lotofast/LotoFastRecord",
LotoFastHelp: "resources/prefab_composite/lotofast/LotoFastHelp",
LotoFastMarquee: "resources/prefab_composite/lotofast/LotoFastMarquee",
LotoFastRecordAlert: "resources/prefab_composite/lotofast/LotoFastRecordAlert",
CompositeChip: "resources/prefab_composite/common/CompositeChip",
CompositeOdds: "resources/prefab_composite/common/CompositeOdds",
PlayerHead: "resources/prefab_composite/common/CompositePlayerHead",
OtherMember: "resources/prefab_composite/common/CompositeMemberRank",
CompositeCard: "resources/prefab_composite/common/CompositeCard",
NetworkDelay: "resources/prefab/component/NetworkDelay",
BlastHelp: "resources/prefab_composite/blastspace/BlastHelp",
BlastRecordAlert: "resources/prefab_composite/blastspace/BlastRecordAlert",
ReferHelp: "resources/prefab/ui/refer/ReferHelp",
ReferView: "resources/prefab/ui/refer/ReferView",
ReferLevelAlert: "resources/prefab/ui/refer/ReferLevelAlert",
ReferShare: "resources/prefab/ui/refer/ReferShare",
TPRechargeAlert: "prefab_tp/ui/recharge/TPRechargeAlert",
SlotItemAlert: "resources/prefab_slot/Common/SlotItemAlert",
SlotInfo: "Slot_200/Prefab/SlotInfo",
SlotHelp: "Slot_200/Prefab/SlotHelp",
SlotInfo201: "Slot_201/Prefab/SlotInfo_201",
SlotHelp201: "Slot_201/Prefab/SlotHelp_201",
BonusLayer: "resources/prefab/ui/Bonus/BonusLayer",
WelComeBonus: "resources/prefab/ui/Bonus/WelComeBonus",
GoldSliverCard: "resources/prefab/ui/MonthCard/GoldSliverCard",
challengeLayer: "resources/prefab/ui/challenge/ChallengeLayer",
ExchangeLayer: "resources/prefab/ui/Exchange/ExchangeLayer",
ExchangeWithdarwLayer: "resources/prefab/ui/Exchange/ExchangeWithdarwLayer",
BetBoxLayer: "resources/prefab/ui/BetBoxLayer/BetBoxLayer",
ReferEarn: "resources/prefab/ui/ReferEarn/ReferEarn",
SignLayer: "resources/prefab/ui/notice/SignLayer",
KongQueKaLayer: "resources/prefab/ui/KongqueKaLayer",
DownNewLayer: "resources/prefab/ui/DownNewLayer/DownNewLayer",
ThirtySignLayer: "resources/prefab/ui/ThrityDaysSignUp"
};
o.UIPath = {
Tips: "prefab/component/Tips",
Alert: "prefab/component/AlertEx",
WaitingEx: "prefab/component/WaitingEx"
};
cc._RF.pop();
}, {} ],
CountDown: [ function(e, t, o) {
"use strict";
cc._RF.push(t, "29dc4871cFI2Llmy+uc1RhD", "CountDown");
var n, a = this && this.__extends || (n = function(e, t) {
return (n = Object.setPrototypeOf || {
__proto__: []
} instanceof Array && function(e, t) {
e.__proto__ = t;
} || function(e, t) {
for (var o in t) Object.prototype.hasOwnProperty.call(t, o) && (e[o] = t[o]);
})(e, t);
}, function(e, t) {
n(e, t);
function o() {
this.constructor = e;
}
e.prototype = null === t ? Object.create(t) : (o.prototype = t.prototype, new o());
}), i = this && this.__decorate || function(e, t, o, n) {
var a, i = arguments.length, r = i < 3 ? t : null === n ? n = Object.getOwnPropertyDescriptor(t, o) : n;
if ("object" == typeof Reflect && "function" == typeof Reflect.decorate) r = Reflect.decorate(e, t, o, n); else for (var l = e.length - 1; l >= 0; l--) (a = e[l]) && (r = (i < 3 ? a(r) : i > 3 ? a(t, o, r) : a(t, o)) || r);
return i > 3 && r && Object.defineProperty(t, o, r), r;
};
Object.defineProperty(o, "__esModule", {
value: !0
});
var r = e("../../../Game/client/global/enum/game/Event"), l = e("../../../Game/client/logic/game/GameHelper"), s = e("../../../Game/fromework/global/Tools"), c = e("../../../Game/fromework/helper/EventHelper"), u = cc._decorator, d = u.ccclass, p = u.property, h = u.menu, f = function(e) {
a(t, e);
function t() {
var t = null !== e && e.apply(this, arguments) || this;
t.Text = null;
t.ReadyButton = null;
t._tag = 0;
t._text = "";
t._surplusTime = 0;
return t;
}
Object.defineProperty(t.prototype, "surplusTime", {
get: function() {
return this._surplusTime;
},
enumerable: !1,
configurable: !0
});
t.prototype._progress = function(e) {
if (this.node && this.node.isValid) {
this.Text.string = s.Tools.TStr.replaceAll(this._text, "%{num}", e);
this._surplusTime = e;
}
};
t.prototype.show = function(e, t, o, n, a) {
var i = this;
void 0 === n && (n = null);
void 0 === a && (a = !1);
this._text = e;
this._surplusTime = t;
this.ReadyButton.active = a;
this._progress(t);
this._tag = l.Countdown.creat(t, function(e) {
e && (n ? o && o.call(n) : o && o());
if (i.node && i.node.isValid) {
i.node.removeFromParent(!0);
i.node.destroy();
}
}, this._progress.bind(this));
};
t.prototype.close = function() {
l.Countdown.deleta(this._tag);
};
t.prototype.onReadyClicked = function() {
c.default.Instance.Global.emit(r.TipsEvent.TIPS_READY_BUTTON_CLICKED);
};
t.prototype.onDestroy = function() {
l.Countdown.deleta(this._tag, !1);
};
i([ p(cc.Label) ], t.prototype, "Text", void 0);
i([ p(cc.Node) ], t.prototype, "ReadyButton", void 0);
return i([ d, h("component/CountDown(倒计时)") ], t);
}(cc.Component);
o.default = f;
cc._RF.pop();
}, {
"../../../Game/client/global/enum/game/Event": "Event",
"../../../Game/client/logic/game/GameHelper": "GameHelper",
"../../../Game/fromework/global/Tools": "Tools",
"../../../Game/fromework/helper/EventHelper": "EventHelper"
} ],
CurrencySlider: [ function(e, t, o) {
"use strict";
cc._RF.push(t, "77877fHRrJPx6w00Ieppgrw", "CurrencySlider");
var n, a = this && this.__extends || (n = function(e, t) {
return (n = Object.setPrototypeOf || {
__proto__: []
} instanceof Array && function(e, t) {
e.__proto__ = t;
} || function(e, t) {
for (var o in t) Object.prototype.hasOwnProperty.call(t, o) && (e[o] = t[o]);
})(e, t);
}, function(e, t) {
n(e, t);
function o() {
this.constructor = e;
}
e.prototype = null === t ? Object.create(t) : (o.prototype = t.prototype, new o());
}), i = this && this.__decorate || function(e, t, o, n) {
var a, i = arguments.length, r = i < 3 ? t : null === n ? n = Object.getOwnPropertyDescriptor(t, o) : n;
if ("object" == typeof Reflect && "function" == typeof Reflect.decorate) r = Reflect.decorate(e, t, o, n); else for (var l = e.length - 1; l >= 0; l--) (a = e[l]) && (r = (i < 3 ? a(r) : i > 3 ? a(t, o, r) : a(t, o)) || r);
return i > 3 && r && Object.defineProperty(t, o, r), r;
};
Object.defineProperty(o, "__esModule", {
value: !0
});
var r = e("../../Game/client/global/enum/game/Event"), l = e("../../Game/fromework/helper/EventHelper"), s = cc._decorator, c = s.ccclass, u = s.property, d = function(e) {
a(t, e);
function t() {
var t = null !== e && e.apply(this, arguments) || this;
t.Slider = null;
t.SliderProgress = null;
t.LabelParent = null;
t.CopyLabel = null;
t.CashLabel = null;
t._currency = [];
t._progStep = 0;
t._sliderIndex = 0;
t._callFunc = null;
return t;
}
t.prototype.onEnable = function() {
this.Slider.node.on(cc.Node.EventType.TOUCH_END, this.onSliderEnd, this);
this.Slider.node.on(cc.Node.EventType.TOUCH_CANCEL, this.onSliderEnd, this);
};
t.prototype.onDisable = function() {
this.Slider.node.off(cc.Node.EventType.TOUCH_END, this.onSliderEnd, this);
this.Slider.node.off(cc.Node.EventType.TOUCH_CANCEL, this.onSliderEnd, this);
};
t.prototype.updateCurrency = function(e, t) {
this._currency = e;
this._callFunc = t;
this.Slider.progress = 0;
this.SliderProgress.width = 0;
this.refreshLabel();
};
t.prototype.refreshLabel = function() {
var e = this;
this._progStep = 1 / (this._currency.length - 1);
var t = this.LabelParent.width / (this._currency.length - 1);
this.LabelParent.destroyAllChildren();
this._currency.forEach(function(o, n) {
var a = cc.instantiate(e.CopyLabel);
a.active = !0;
a.setPosition(cc.v2(n * t, 0));
a.parent = e.LabelParent;
var i = a.getChildByName("Label").getComponent(cc.Label);
i.node.active = 0 == n || n == e._currency.length - 1 || n == Math.floor((e._currency.length - 1) / 2);
i.string = o + "";
});
this._sliderIndex = 0;
this.refreshSlider();
};
t.prototype.refreshSlider = function() {
var e = this._currency[this._sliderIndex];
this.CashLabel && (this.CashLabel.string = e + "");
this._callFunc && this._callFunc(e);
l.default.Instance.Global.emit(r.GameUIEvent.CREATE_TABLE_SLIDER_UPDATE, e);
};
t.prototype.onSlider = function(e, t) {
void 0 === t && (t = !1);
this.SliderProgress.width = e.node.width * e.progress;
var o = e.progress / this._progStep, n = Math.floor(isNaN(o) ? 0 : o), a = n + (e.progress - n * this._progStep > this._progStep / 2 ? 1 : 0);
if (a != this._sliderIndex) {
this._sliderIndex = a;
this._sliderIndex >= this._currency.length && (this._sliderIndex = this._currency.length - 1);
this.refreshSlider();
}
if (t) {
var i = a * this._progStep;
this.Slider.progress = i;
this.SliderProgress.width = e.node.width * i;
}
};
t.prototype.onSliderMoved = function() {
this.onSlider(this.Slider);
};
t.prototype.onSliderEnd = function() {
this.onSlider(this.Slider, !0);
};
t.prototype.onSliderBtnClicked = function(e, t) {
var o = parseInt(t), n = this._sliderIndex + o;
n >= this._currency.length && (n = this._currency.length - 1);
n < 0 && (n = 0);
if (n != this._sliderIndex) {
this._sliderIndex = n;
var a = n * this._progStep;
this.Slider.progress = a;
this.SliderProgress.width = this.Slider.node.width * a;
this.refreshSlider();
}
};
i([ u(cc.Slider) ], t.prototype, "Slider", void 0);
i([ u(cc.Node) ], t.prototype, "SliderProgress", void 0);
i([ u(cc.Node) ], t.prototype, "LabelParent", void 0);
i([ u(cc.Node) ], t.prototype, "CopyLabel", void 0);
i([ u(cc.Label) ], t.prototype, "CashLabel", void 0);
return i([ c ], t);
}(cc.Component);
o.default = d;
cc._RF.pop();
}, {
"../../Game/client/global/enum/game/Event": "Event",
"../../Game/fromework/helper/EventHelper": "EventHelper"
} ],
DTDealerListItem: [ function(e, t, o) {
"use strict";
cc._RF.push(t, "74b502jY7lOWr3t5gsW1lzd", "DTDealerListItem");
var n, a = this && this.__extends || (n = function(e, t) {
return (n = Object.setPrototypeOf || {
__proto__: []
} instanceof Array && function(e, t) {
e.__proto__ = t;
} || function(e, t) {
for (var o in t) Object.prototype.hasOwnProperty.call(t, o) && (e[o] = t[o]);
})(e, t);
}, function(e, t) {
n(e, t);
function o() {
this.constructor = e;
}
e.prototype = null === t ? Object.create(t) : (o.prototype = t.prototype, new o());
}), i = this && this.__decorate || function(e, t, o, n) {
var a, i = arguments.length, r = i < 3 ? t : null === n ? n = Object.getOwnPropertyDescriptor(t, o) : n;
if ("object" == typeof Reflect && "function" == typeof Reflect.decorate) r = Reflect.decorate(e, t, o, n); else for (var l = e.length - 1; l >= 0; l--) (a = e[l]) && (r = (i < 3 ? a(r) : i > 3 ? a(t, o, r) : a(t, o)) || r);
return i > 3 && r && Object.defineProperty(t, o, r), r;
};
Object.defineProperty(o, "__esModule", {
value: !0
});
var r = cc._decorator, l = r.ccclass, s = (r.property, e("../../../Game/client/global/enum/game/UIUtils")), c = e("../../../Game/fromework/global/Tools"), u = function(e) {
a(t, e);
function t() {
return null !== e && e.apply(this, arguments) || this;
}
t.prototype.start = function() {};
t.prototype.onItemInitCallFunc = function(e, t) {
var o = this.node.getChildByName("headMask").getChildByName("head").getComponent(cc.Sprite), n = this.node.getChildByName("paritic"), a = this.node.getChildByName("wait"), i = this.node.getChildByName("name"), r = this.node.getChildByName("score");
s.UIUtils.updateHeadImage(e.head_url, o, cc.size(65, 65));
if (0 == t) {
n.active = !0;
a.active = !1;
} else {
n.active = !1;
a.active = !0;
}
i.getComponent(cc.Label).string = c.Tools.TStr.ellipsisString(e.name, 12);
r.getComponent(cc.Label).string = e.total_fee;
};
return i([ l ], t);
}(cc.Component);
o.default = u;
cc._RF.pop();
}, {
"../../../Game/client/global/enum/game/UIUtils": "UIUtils",
"../../../Game/fromework/global/Tools": "Tools"
} ],
DTDealerList: [ function(e, t, o) {
"use strict";
cc._RF.push(t, "0c49dQHhOtAopPE6c1NBLJi", "DTDealerList");
var n, a = this && this.__extends || (n = function(e, t) {
return (n = Object.setPrototypeOf || {
__proto__: []
} instanceof Array && function(e, t) {
e.__proto__ = t;
} || function(e, t) {
for (var o in t) Object.prototype.hasOwnProperty.call(t, o) && (e[o] = t[o]);
})(e, t);
}, function(e, t) {
n(e, t);
function o() {
this.constructor = e;
}
e.prototype = null === t ? Object.create(t) : (o.prototype = t.prototype, new o());
}), i = this && this.__decorate || function(e, t, o, n) {
var a, i = arguments.length, r = i < 3 ? t : null === n ? n = Object.getOwnPropertyDescriptor(t, o) : n;
if ("object" == typeof Reflect && "function" == typeof Reflect.decorate) r = Reflect.decorate(e, t, o, n); else for (var l = e.length - 1; l >= 0; l--) (a = e[l]) && (r = (i < 3 ? a(r) : i > 3 ? a(t, o, r) : a(t, o)) || r);
return i > 3 && r && Object.defineProperty(t, o, r), r;
};
Object.defineProperty(o, "__esModule", {
value: !0
});
var r = cc._decorator, l = r.ccclass, s = r.property, c = e("../../../Game/client/global/enum/game/Event"), u = e("../../../Game/fromework/helper/EventHelper"), d = e("../../../Game/fromework/mvvm/modelView/ViewModel"), p = e("../../../Game/client/global/enum/game/UIUtils"), h = e("./DTModel"), f = e("../../../client/global/PopHelper"), _ = e("../../../Game/fromework/global/Tools"), m = e("./DTDealerListItem"), y = e("../../../fromework/component/TableView/TableList"), g = e("../../../client/logic/Wallet/WalletHelper"), v = function(e) {
a(t, e);
function t() {
var t = null !== e && e.apply(this, arguments) || this;
t.dealerNode = null;
t.btn_applyOpen = null;
t.btn_queuing = null;
t.btn_apply = null;
t.btn_cancel = null;
t.listLayer = null;
t.backClose = null;
t.listData = null;
t.isMyInDealer = !1;
t.Win_Money = null;
t.dealerName = null;
t.dealerMoney = null;
t.TaskTableList = null;
return t;
}
t.prototype.onEnable = function() {
u.default.Instance.Global.bind(c.GameEvent.S2C_DT_DEALER_LIST, this._dealerList, this);
u.default.Instance.Global.bind("dealerWin", this.onShowCard, this);
};
t.prototype.onDisable = function() {
u.default.Instance.Global.unbind(c.GameEvent.S2C_DT_DEALER_LIST, this._dealerList, this);
u.default.Instance.Global.unbind("dealerWin", this.onShowCard, this);
};
t.prototype.start = function() {};
t.prototype.onShowCard = function(e) {
var t = this, o = e.getUserData();
if (o) {
var n = o / 1e3;
if (Math.abs(n) > 0) {
var a = this.Win_Money.node.parent;
this.Win_Money.string = n >= 0 ? "+" + _.Tools.TNumber.numFixed(n, 2) : "" + _.Tools.TNumber.numFixed(n, 2);
a.opacity = 0;
a.y -= 10;
a.active = !0;
a.stopAllActions();
cc.tween(a).to(.5, {
y: 0,
opacity: 255
}).delay(1.5).call(function() {
t && t.node && t.node.isValid && (a.active = !1);
}).start();
}
}
};
t.prototype.onListRender = function(e, t) {
var o = this.listData[t];
if (e.isValid) {
e.active = !0;
e.getComponent(m.default).onItemInitCallFunc(o, t);
}
};
t.prototype._dealerList = function(e) {
var t = e.getUserData();
this.listData = t;
var o = !1;
if (t && t.length > 0) {
var n = t[0];
p.UIUtils.updateHeadImage(n.head_url, this.dealerNode.getComponent(cc.Sprite), cc.size(100, 100));
this.dealerName.node.parent.active = !0;
this.dealerMoney.node.parent.active = !0;
this.dealerName.string = _.Tools.TStr.ellipsisString(n.name, 12);
this.dealerMoney.string = n.total_fee;
for (var a = 0; a < t.length; a++) t[a].uid == d.VM.getValue("user.uid") && 0 == t[a].type && (o = !0);
this.TaskTableList.numItems = this.listData.length;
this.isMyInDealer = o;
if (o) {
this.btn_queuing.active = !0;
this.btn_applyOpen.active = !1;
this.btn_cancel.active = !0;
this.btn_apply.active = !1;
} else {
this.btn_queuing.active = !1;
this.btn_applyOpen.active = !0;
this.btn_cancel.active = !1;
this.btn_apply.active = !0;
}
}
};
t.prototype.onClickCloseListView = function() {
this.listLayer.opacity = 0;
this.listLayer.y = 700;
this.backClose.active = !1;
};
t.prototype.onOpenListView = function() {
this.listLayer.opacity = 255;
this.listLayer.y = 0;
this.backClose.active = !0;
h.default.Instance.sendOpenDealer();
};
t.prototype.onClickApply = function() {
h.default.Instance.sendClickDealer();
this.isMyInDealer ? f.PopHelper.Instance.showTips("You've already applied") : this.listData && this.listData.length >= 20 ? f.PopHelper.Instance.showTips("The list is full") : d.VM.getValue("wallet.total") <= 5e3 ? g.default.Instance.openRechargeAlert(5e3, 0, !1, function() {}, !0) : h.default.Instance.sendApplyDealer();
};
t.prototype.onClickCancel = function() {
h.default.Instance.sendCancelDealer();
};
t.prototype.onDestroy = function() {
this.unscheduleAllCallbacks();
};
i([ s(cc.Node) ], t.prototype, "dealerNode", void 0);
i([ s(cc.Node) ], t.prototype, "btn_applyOpen", void 0);
i([ s(cc.Node) ], t.prototype, "btn_queuing", void 0);
i([ s(cc.Node) ], t.prototype, "btn_apply", void 0);
i([ s(cc.Node) ], t.prototype, "btn_cancel", void 0);
i([ s(cc.Node) ], t.prototype, "listLayer", void 0);
i([ s(cc.Node) ], t.prototype, "backClose", void 0);
i([ s(cc.Label) ], t.prototype, "Win_Money", void 0);
i([ s(cc.Label) ], t.prototype, "dealerName", void 0);
i([ s(cc.Label) ], t.prototype, "dealerMoney", void 0);
i([ s(y.default) ], t.prototype, "TaskTableList", void 0);
return i([ l ], t);
}(cc.Component);
o.default = v;
cc._RF.pop();
}, {
"../../../Game/client/global/enum/game/Event": "Event",
"../../../Game/client/global/enum/game/UIUtils": "UIUtils",
"../../../Game/fromework/global/Tools": "Tools",
"../../../Game/fromework/helper/EventHelper": "EventHelper",
"../../../Game/fromework/mvvm/modelView/ViewModel": "ViewModel",
"../../../client/global/PopHelper": "PopHelper",
"../../../client/logic/Wallet/WalletHelper": "WalletHelper",
"../../../fromework/component/TableView/TableList": "TableList",
"./DTDealerListItem": "DTDealerListItem",
"./DTModel": "DTModel"
} ],
DTDealer: [ function(e, t, o) {
"use strict";
cc._RF.push(t, "123c0o3pgJKzKqVF2Iicd4G", "DTDealer");
var n, a = this && this.__extends || (n = function(e, t) {
return (n = Object.setPrototypeOf || {
__proto__: []
} instanceof Array && function(e, t) {
e.__proto__ = t;
} || function(e, t) {
for (var o in t) Object.prototype.hasOwnProperty.call(t, o) && (e[o] = t[o]);
})(e, t);
}, function(e, t) {
n(e, t);
function o() {
this.constructor = e;
}
e.prototype = null === t ? Object.create(t) : (o.prototype = t.prototype, new o());
}), i = this && this.__decorate || function(e, t, o, n) {
var a, i = arguments.length, r = i < 3 ? t : null === n ? n = Object.getOwnPropertyDescriptor(t, o) : n;
if ("object" == typeof Reflect && "function" == typeof Reflect.decorate) r = Reflect.decorate(e, t, o, n); else for (var l = e.length - 1; l >= 0; l--) (a = e[l]) && (r = (i < 3 ? a(r) : i > 3 ? a(t, o, r) : a(t, o)) || r);
return i > 3 && r && Object.defineProperty(t, o, r), r;
};
Object.defineProperty(o, "__esModule", {
value: !0
});
var r = e("../../../Game/client/global/enum/game/Const"), l = e("../../../Game/client/global/enum/game/Event"), s = e("../../../Game/fromework/global/ResLoader"), c = e("../../../Game/fromework/helper/AudioHelper"), u = e("../../../Game/fromework/helper/EventHelper"), d = e("../../../platform/Platform"), p = e("../../Common/Component/CompositeCard"), h = e("../../Common/Utils/CompositeEvent"), f = e("../../Common/Utils/CompositeUtil"), _ = cc._decorator, m = _.ccclass, y = _.property, g = function(e) {
a(t, e);
function t() {
var t = null !== e && e.apply(this, arguments) || this;
t.DragonSlot = null;
t.TigerSlot = null;
t.IconVS = null;
t.DragonWin = null;
t.TigerWin = null;
t.CardFire = null;
t.Discard = null;
t.Dealer = null;
t.DiscardPos = null;
t.DealerPos = null;
t.Template_Card = null;
t.DiscardCount = null;
t.DealerCount = null;
t.CardParent = null;
t.DragonBonus = null;
t._dragonCard = null;
t._tigerCard = null;
return t;
}
t.prototype.onEnable = function() {
u.default.Instance.Global.bind(h.CompositeGameEvent.GAME_RECONNECT, this.onReconnect, this);
u.default.Instance.Global.bind(l.GameEvent.S2C_AB_DEAL, this.onDealerCard, this);
u.default.Instance.Global.bind(h.CompositeGameEvent.UI_EFFECT_START_BET, this.onStartBet, this);
u.default.Instance.Global.bind(h.CompositeGameEvent.UI_EFFECT_STOP_BET, this.onStopBet, this);
u.default.Instance.Global.bind(l.GameEvent.S2C_AB_SHOW, this.onShowCard, this);
u.default.Instance.Global.bind(l.GameEvent.S2C_RESET, this.onReset, this);
};
t.prototype.onDisable = function() {
u.default.Instance.Global.unbind(h.CompositeGameEvent.GAME_RECONNECT, this.onReconnect, this);
u.default.Instance.Global.unbind(l.GameEvent.S2C_AB_DEAL, this.onDealerCard, this);
u.default.Instance.Global.unbind(l.GameEvent.S2C_AB_SHOW, this.onShowCard, this);
u.default.Instance.Global.unbind(l.GameEvent.S2C_RESET, this.onReset, this);
};
t.prototype.onLoad = function() {
cc.game.on(cc.game.EVENT_SHOW, this._onReset, this);
};
t.prototype.onDestroy = function() {
this.unscheduleAllCallbacks();
cc.game.off(cc.game.EVENT_SHOW, this._onReset, this);
};
t.prototype._onReset = function() {
this._dragonCard && this._dragonCard.node && this._dragonCard.node.isValid && this._dragonCard.node.stopAllActions();
this._tigerCard && this._tigerCard.node && this._tigerCard.node.isValid && this._tigerCard.node.stopAllActions();
this.CardParent.destroyAllChildren();
this._dragonCard = null;
this._tigerCard = null;
this.CardFire.active = !1;
};
Object.defineProperty(t.prototype, "dragonSlotPos", {
get: function() {
var e = this.DragonSlot.parent.convertToWorldSpaceAR(this.DragonSlot.position);
return this.CardParent.convertToNodeSpaceAR(e);
},
enumerable: !1,
configurable: !0
});
Object.defineProperty(t.prototype, "tigerSlotPos", {
get: function() {
var e = this.TigerSlot.parent.convertToWorldSpaceAR(this.TigerSlot.position);
return this.CardParent.convertToNodeSpaceAR(e);
},
enumerable: !1,
configurable: !0
});
t.prototype.getCardCount = function(e) {
return Math.ceil(e / 13);
};
t.prototype.refreshDealer = function() {
for (var e = f.default.Game.Model, t = this.getCardCount(e.dealerCount), o = this.Dealer.children.length, n = o - 1; n >= 0; n--) this.Dealer.children[n].active = o - n <= t;
this.DealerCount.string = e.dealerCount + "";
};
t.prototype.refreshDiscard = function() {
for (var e = f.default.Game.Model, t = this.getCardCount(e.discardCount), o = 0; o < this.Discard.children.length; o++) this.Discard.children[o].active = o < t;
this.DiscardCount.string = e.discardCount + "";
};
t.prototype.createCard = function(e) {
var t = this;
this._onReset();
s.default.Instance.loadBundleRes(r.BundleUIPath.CompositeCard, cc.Prefab, function(o, n) {
if (o) d.default.log("ABDealer Can Not Load CompositeCard!"); else {
var a = cc.instantiate(n);
a.scale = .3;
a.active = !1;
a.parent = t.CardParent;
a.setPosition(cc.Vec2.ZERO);
t._dragonCard = a.getComponent(p.default);
t._dragonCard.init(0, !1);
var i = cc.instantiate(n);
i.scale = .3;
i.active = !1;
i.parent = t.CardParent;
i.setPosition(cc.Vec2.ZERO);
t._tigerCard = i.getComponent(p.default);
t._tigerCard.init(0, !1);
e && e();
}
});
};
t.prototype.playWinEffect = function() {
var e = this, t = f.default.Game.Model;
cc.tween(this.node).delay(.4).call(function() {
var o = t.win_options[0];
0 == o && (e.DragonWin.active = !0);
2 == o && (e.TigerWin.active = !0);
u.default.Instance.Global.emit(h.OddsEvent.ODDS_SHOW_WIN);
}).delay(2.5).call(function() {
e.DragonWin.active = !1;
e.TigerWin.active = !1;
u.default.Instance.Global.emit(h.OddsEvent.ODDS_RECYCLING);
}).start();
};
t.prototype.onReconnect = function() {
var e = this, t = f.default.Game.Model;
this._onReset();
this.refreshDealer();
this.refreshDiscard();
this.IconVS.opacity = 2 != t.roomData.state ? 255 : 0;
if (1 == t.roomData.state || 2 == t.roomData.state) this.createCard(function() {
e._dragonCard.node.setPosition(e.dragonSlotPos);
e._dragonCard.node.scale = .53;
e._dragonCard.node.active = !0;
e._dragonCard.init(0, !1);
e._tigerCard.node.setPosition(e.tigerSlotPos);
e._tigerCard.node.scale = .53;
e._tigerCard.node.active = !0;
e._tigerCard.init(0, !1);
e.CardFire.active = !0;
}); else if (3 == t.roomData.state) {
this.createCard(function() {
e._dragonCard.node.setPosition(e.dragonSlotPos);
e._dragonCard.node.scale = .53;
e._dragonCard.node.active = !0;
e._dragonCard.init(null != t.show_card[0] ? t.show_card[0] : 0, null != t.show_card[0]);
e._tigerCard.node.setPosition(e.tigerSlotPos);
e._tigerCard.node.scale = .53;
e._tigerCard.node.active = !0;
e._tigerCard.init(null != t.show_card[1] ? t.show_card[1] : 0, null != t.show_card[1]);
e.CardFire.active = !1;
});
u.default.Instance.Global.emit(h.OddsEvent.ODDS_RECYCLING);
}
};
t.prototype.onStartBet = function() {
this.IconVS.runAction(cc.fadeOut(.1));
};
t.prototype.onStopBet = function() {
this.IconVS.runAction(cc.fadeIn(.1));
};
t.prototype.onDealerCard = function() {
var e = this, t = f.default.Game.Model, o = function() {
e._dragonCard.node.active = !0;
e._dragonCard.node.scale = e.DealerPos.scale;
e._dragonCard.node.angle = e.DealerPos.angle;
e._dragonCard.node.setPosition(e.DealerPos.position);
e._dragonCard.init(0, !1);
t.dealerCount--;
e.refreshDealer();
cc.tween(e._dragonCard.node).to(.35, {
position: e.dragonSlotPos,
scale: .53,
angle: 0
}).call(function() {
c.default.Instance.playBundleEffect(r.BundleSoundPath.common_draw);
}).start();
}, n = function() {
e._tigerCard.node.active = !0;
e._tigerCard.node.scale = e.DealerPos.scale;
e._tigerCard.node.angle = e.DealerPos.angle;
e._tigerCard.node.setPosition(e.DealerPos.position);
e._tigerCard.init(0, !1);
t.dealerCount--;
e.refreshDealer();
cc.tween(e._tigerCard.node).to(.2, {
position: e.tigerSlotPos,
scale: .53,
angle: 0
}).call(function() {
c.default.Instance.playBundleEffect(r.BundleSoundPath.common_draw);
e.CardFire.active = !0;
e.scheduleOnce(function() {
u.default.Instance.Global.emit(h.CompositeUIEvent.UI_PLAY_START_BET);
}, .2);
}).start();
}, a = function() {
var a = cc.instantiate(e.Template_Card);
a.active = !0;
a.setPosition(e.DealerPos.position);
a.scale = e.DealerPos.scale;
a.angle = e.DealerPos.angle;
a.parent = e.CardParent;
t.dealerCount--;
t.discardCount++;
e.refreshDealer();
cc.tween(a).to(.2, {
position: e.DiscardPos.position,
angle: e.DiscardPos.angle
}).call(function() {
e.refreshDiscard();
a.removeFromParent(!0);
a.destroy();
o();
e.scheduleOnce(function() {
e && e.node && e.node.isValid && n();
}, .2);
}).start();
c.default.Instance.playBundleEffect(r.BundleSoundPath.common_draw);
};
this._dragonCard && this._dragonCard.isValid && this._tigerCard && !this._tigerCard.isValid ? a() : this.createCard(function() {
a();
});
};
t.prototype.onShowCard = function() {
var e = this, t = f.default.Game.Model, o = function() {
e._tigerCard.node.active = !0;
e._tigerCard.node.angle = 0;
e._tigerCard.node.scale = .53;
e._tigerCard.node.position = e.tigerSlotPos;
e._tigerCard.init(t.show_card[1], !1);
e._tigerCard.flipCard(.3, cc.v3(0, -180, 0), !1, function() {
e.playWinEffect();
});
c.default.Instance.playBundleEffect(r.BundleSoundPath.common_discard);
};
this.CardFire.active = !1;
(function() {
e._dragonCard.node.active = !0;
e._dragonCard.node.angle = 0;
e._dragonCard.node.scale = .53;
e._dragonCard.node.position = e.dragonSlotPos;
e._dragonCard.init(t.show_card[0], !1);
e._dragonCard.flipCard(.3, cc.v3(0, -180, 0), !1, function() {
e.scheduleOnce(function() {
o();
}, .3);
});
c.default.Instance.playBundleEffect(r.BundleSoundPath.common_discard);
})();
};
t.prototype.onReset = function() {
var e = this;
this.IconVS.runAction(cc.fadeOut(.1));
var t = f.default.Game.Model, o = function() {
e.Discard.children.forEach(function(e) {
e.active = !1;
});
e.DiscardCount.string = "0";
e.DragonBonus.node.active = !0;
e.DragonBonus.node.position = e.DiscardPos.position;
e.DragonBonus.node.angle = e.DiscardPos.angle;
e.DragonBonus.armatureName = "Armature";
e.DragonBonus.once(dragonBones.EventObject.COMPLETE, function() {
cc.tween(e.DragonBonus.node).to(.35, {
position: e.DealerPos.position,
angle: e.DealerPos.angle
}).call(function() {
e.refreshDealer();
e.DragonBonus.node.active = !1;
}).start();
}, e);
e.DragonBonus.playAnimation("card", 1);
c.default.Instance.playBundleEffect(r.BundleSoundPath.common_shuffle_cards);
};
if (this._dragonCard && this._dragonCard.isValid && this._tigerCard && this._tigerCard.isValid) {
cc.tween(e._dragonCard.node).to(.25, {
position: e.DiscardPos.position,
scale: e.DiscardPos.scale,
angle: e.DiscardPos.angle
}).call(function() {
e.refreshDiscard();
e._dragonCard.node.removeFromParent(!0);
e._dragonCard.node.destroy();
e._dragonCard = null;
c.default.Instance.playBundleEffect(r.BundleSoundPath.common_draw);
0 == t.discardCount && o();
}).start();
cc.tween(e._tigerCard.node).to(.25, {
position: e.DiscardPos.position,
scale: e.DiscardPos.scale,
angle: e.DiscardPos.angle
}).call(function() {
e.refreshDiscard();
e._tigerCard.node.removeFromParent(!0);
e._tigerCard.node.destroy();
e._tigerCard = null;
c.default.Instance.playBundleEffect(r.BundleSoundPath.common_draw);
}).start();
}
};
i([ y(cc.Node) ], t.prototype, "DragonSlot", void 0);
i([ y(cc.Node) ], t.prototype, "TigerSlot", void 0);
i([ y(cc.Node) ], t.prototype, "IconVS", void 0);
i([ y(cc.Node) ], t.prototype, "DragonWin", void 0);
i([ y(cc.Node) ], t.prototype, "TigerWin", void 0);
i([ y(cc.Node) ], t.prototype, "CardFire", void 0);
i([ y(cc.Node) ], t.prototype, "Discard", void 0);
i([ y(cc.Node) ], t.prototype, "Dealer", void 0);
i([ y(cc.Node) ], t.prototype, "DiscardPos", void 0);
i([ y(cc.Node) ], t.prototype, "DealerPos", void 0);
i([ y(cc.Node) ], t.prototype, "Template_Card", void 0);
i([ y(cc.Label) ], t.prototype, "DiscardCount", void 0);
i([ y(cc.Label) ], t.prototype, "DealerCount", void 0);
i([ y(cc.Node) ], t.prototype, "CardParent", void 0);
i([ y(dragonBones.ArmatureDisplay) ], t.prototype, "DragonBonus", void 0);
return i([ m ], t);
}(cc.Component);
o.default = g;
cc._RF.pop();
}, {
"../../../Game/client/global/enum/game/Const": "Const",
"../../../Game/client/global/enum/game/Event": "Event",
"../../../Game/fromework/global/ResLoader": "ResLoader",
"../../../Game/fromework/helper/AudioHelper": "AudioHelper",
"../../../Game/fromework/helper/EventHelper": "EventHelper",
"../../../platform/Platform": "Platform",
"../../Common/Component/CompositeCard": "CompositeCard",
"../../Common/Utils/CompositeEvent": "CompositeEvent",
"../../Common/Utils/CompositeUtil": "CompositeUtil"
} ],
DTHelp: [ function(e, t, o) {
"use strict";
cc._RF.push(t, "699d5DxZ/JEZ4Y5K6iu3SMm", "DTHelp");
var n, a = this && this.__extends || (n = function(e, t) {
return (n = Object.setPrototypeOf || {
__proto__: []
} instanceof Array && function(e, t) {
e.__proto__ = t;
} || function(e, t) {
for (var o in t) Object.prototype.hasOwnProperty.call(t, o) && (e[o] = t[o]);
})(e, t);
}, function(e, t) {
n(e, t);
function o() {
this.constructor = e;
}
e.prototype = null === t ? Object.create(t) : (o.prototype = t.prototype, new o());
}), i = this && this.__decorate || function(e, t, o, n) {
var a, i = arguments.length, r = i < 3 ? t : null === n ? n = Object.getOwnPropertyDescriptor(t, o) : n;
if ("object" == typeof Reflect && "function" == typeof Reflect.decorate) r = Reflect.decorate(e, t, o, n); else for (var l = e.length - 1; l >= 0; l--) (a = e[l]) && (r = (i < 3 ? a(r) : i > 3 ? a(t, o, r) : a(t, o)) || r);
return i > 3 && r && Object.defineProperty(t, o, r), r;
};
Object.defineProperty(o, "__esModule", {
value: !0
});
var r = e("../../Common/Utils/CompositeUtil"), l = cc._decorator, s = l.ccclass, c = l.property, u = function(e) {
a(t, e);
function t() {
var t = null !== e && e.apply(this, arguments) || this;
t.RateAry = [];
return t;
}
t.prototype.onLoad = function() {
for (var e = r.default.Game.Model, t = 0; t < this.RateAry.length; t++) this.RateAry[t].string = e.bet_options[t].x + " x";
};
i([ c([ cc.Label ]) ], t.prototype, "RateAry", void 0);
return i([ s ], t);
}(cc.Component);
o.default = u;
cc._RF.pop();
}, {
"../../Common/Utils/CompositeUtil": "CompositeUtil"
} ],
DTModel: [ function(e, t, o) {
"use strict";
cc._RF.push(t, "4b60ff7MmlPaolA7Fxmub17", "DTModel");
var n, a = this && this.__extends || (n = function(e, t) {
return (n = Object.setPrototypeOf || {
__proto__: []
} instanceof Array && function(e, t) {
e.__proto__ = t;
} || function(e, t) {
for (var o in t) Object.prototype.hasOwnProperty.call(t, o) && (e[o] = t[o]);
})(e, t);
}, function(e, t) {
n(e, t);
function o() {
this.constructor = e;
}
e.prototype = null === t ? Object.create(t) : (o.prototype = t.prototype, new o());
});
Object.defineProperty(o, "__esModule", {
value: !0
});
o.DTModel = void 0;
var i = e("../../../Game/client/global/enum/game/Event"), r = e("../../../Game/client/global/enum/game/Game"), l = e("../../../Game/client/global/enum/net/C2S"), s = e("../../../Game/client/global/enum/net/S2C"), c = e("../../../Game/fromework/global/Tools"), u = e("../../../Game/fromework/helper/EventHelper"), d = e("../../../Game/fromework/mvvm/modelView/ViewModel"), p = e("../../../client/logic/game/HearBeat"), h = e("../../../client/model/ErrorModel"), f = e("../../../fromework/helper/NetHelper"), _ = e("../../Common/Utils/CompositeProxy"), m = e("./DTStruct"), y = function(e) {
a(t, e);
function t() {
var t = null !== e && e.apply(this, arguments) || this;
t.declearHistory = new m.DTStruct.DeclearHistory();
t.bet_fee_currency = [];
t.bet_options = [];
t.dealerCount = 0;
t.discardCount = 0;
return t;
}
Object.defineProperty(t, "Instance", {
get: function() {
t._instance || (t._instance = new t());
return t._instance;
},
enumerable: !1,
configurable: !0
});
t.prototype.clear = function() {
null != t._instance && (t._instance = null);
};
t.prototype.getCompensationCash = function() {
for (var e = new Map(), t = 0; t < this.win_options.length; t++) {
var o = this.roomBetRecord[this.win_options[t]];
if (0 != o.amount) {
var n = this.bet_options[this.win_options[t]];
e.set(this.win_options[t], o.amount * (n.x - 1));
}
}
return e;
};
t.prototype.getWinFee = function(e) {
var t = new Map();
if (this.declearData.user_data.has(String(e))) for (var o = this.declearData.user_data.get(String(e)), n = 0; n < o.bet_record.length; n++) {
var a = o.bet_record[n];
if (0 != a.amount) {
var i = t.has(n) ? t.get(n) : 0, r = this.bet_options[n];
t.set(n, i + a.amount * r.x);
}
}
return t;
};
t._instance = null;
return t;
}(_.CompositeModel);
o.DTModel = y;
var g = function(e) {
a(t, e);
function t() {
return null !== e && e.apply(this, arguments) || this;
}
Object.defineProperty(t, "Instance", {
get: function() {
t._instance || (t._instance = new t());
return t._instance;
},
enumerable: !1,
configurable: !0
});
t.prototype.Init = function() {
u.default.Instance.Net.bind(s.S2C.GAME.ROOM_ENTER_ROOM, this._onEnterRoom, this);
u.default.Instance.Net.bind(s.S2C.GAME.ROOM_SWITCH_ROOM, this._onSwitchRoom, this);
u.default.Instance.Net.bind(s.S2C.GAME.ROOM_DEAL, this._onDeal, this);
u.default.Instance.Net.bind(s.S2C.GAME.ROOM_START_BET, this._onStartBet, this);
u.default.Instance.Net.bind(s.S2C.GAME.ROOM_BET, this._onBet, this);
u.default.Instance.Net.bind(s.S2C.GAME.ROOM_BET_BATCH, this._onBetBatch, this);
u.default.Instance.Net.bind(s.S2C.GAME.ROOM_STOP_BET, this._onStopBet, this);
u.default.Instance.Net.bind(s.S2C.GAME.ROOM_SHOW, this._onShow, this);
u.default.Instance.Net.bind(s.S2C.GAME.ROOM_RESET_ROOM, this._onResetRoom, this);
u.default.Instance.Net.bind(s.S2C.GAME.ROOM_INTERACT, this._onInteract, this);
u.default.Instance.Net.bind(s.S2C.GAME.ROOM_RANK, this._onRank, this);
u.default.Instance.Net.bind(s.S2C.GAME.ROOM_LEAVE, this._onLeave, this);
u.default.Instance.Net.bind(s.S2C.GAME.ROOM_LEAVE_SINGLE, this._onLeaveSingle, this);
u.default.Instance.Net.bind(s.S2C.GAME.ROOM_DISMISS, this._onDismiss, this);
u.default.Instance.Net.bind(s.S2C.GAME.ROOM_DEALER_LIST, this._onDealerList, this);
u.default.Instance.Net.bind(s.S2C.GAME.ROOM_APPLY_DEALER, this._onApplyDealer, this);
u.default.Instance.Net.bind(s.S2C.GAME.ROOM_CANCEL_DEALER, this._onCancelDealer, this);
u.default.Instance.Net.bind(s.S2C.GAME.ROOM_SEND_AVAILABLE_BALANCE, this._onBalanceRefresh, this);
u.default.Instance.Global.bind(f.NetState.NET_WEBSOCKET_CONNECT_OPEN, this._onWsContented, this);
};
t.prototype.destory = function() {
u.default.Instance.Net.unbind(s.S2C.GAME.ROOM_ENTER_ROOM, this._onEnterRoom, this);
u.default.Instance.Net.unbind(s.S2C.GAME.ROOM_SWITCH_ROOM, this._onSwitchRoom, this);
u.default.Instance.Net.unbind(s.S2C.GAME.ROOM_DEAL, this._onDeal, this);
u.default.Instance.Net.unbind(s.S2C.GAME.ROOM_START_BET, this._onStartBet, this);
u.default.Instance.Net.unbind(s.S2C.GAME.ROOM_BET, this._onBet, this);
u.default.Instance.Net.unbind(s.S2C.GAME.ROOM_BET_BATCH, this._onBetBatch, this);
u.default.Instance.Net.unbind(s.S2C.GAME.ROOM_STOP_BET, this._onStopBet, this);
u.default.Instance.Net.unbind(s.S2C.GAME.ROOM_SHOW, this._onShow, this);
u.default.Instance.Net.unbind(s.S2C.GAME.ROOM_RESET_ROOM, this._onResetRoom, this);
u.default.Instance.Net.unbind(s.S2C.GAME.ROOM_INTERACT, this._onInteract, this);
u.default.Instance.Net.unbind(s.S2C.GAME.ROOM_RANK, this._onRank, this);
u.default.Instance.Net.unbind(s.S2C.GAME.ROOM_LEAVE, this._onLeave, this);
u.default.Instance.Net.unbind(s.S2C.GAME.ROOM_LEAVE_SINGLE, this._onLeaveSingle, this);
u.default.Instance.Net.unbind(s.S2C.GAME.ROOM_DISMISS, this._onDismiss, this);
u.default.Instance.Net.unbind(s.S2C.GAME.ROOM_DEALER_LIST, this._onDealerList, this);
u.default.Instance.Net.unbind(s.S2C.GAME.ROOM_APPLY_DEALER, this._onApplyDealer, this);
u.default.Instance.Net.unbind(s.S2C.GAME.ROOM_CANCEL_DEALER, this._onCancelDealer, this);
u.default.Instance.Net.unbind(s.S2C.GAME.ROOM_SEND_AVAILABLE_BALANCE, this._onBalanceRefresh, this);
u.default.Instance.Global.unbind(f.NetState.NET_WEBSOCKET_CONNECT_OPEN, this._onWsContented, this);
};
t.prototype.clear = function() {};
t.prototype._onWsContented = function() {
p.default.Instance.begin();
var e = d.VM.getValue("lobby.roomID");
0 != e && this.sendEnterRoom(e);
};
Object.defineProperty(t.prototype, "roomID", {
get: function() {
return d.VM.getValue("lobby.roomID");
},
enumerable: !1,
configurable: !0
});
t.prototype.checkRoomID = function(e) {
return d.VM.getValue("lobby.roomID") == e;
};
t.prototype.checkRoomType = function(e) {
var t = e.split("_"), o = -1;
null != t && null != t[0] && (o = parseInt(t[0]));
return o == r.GameEnum.PlayType.GAME_DRAGON_VS_TIGER;
};
t.prototype._onEnterRoom = function(t) {
var o = t.getUserData();
if (this.checkRoomID(o.rid)) {
var n = y.Instance;
if (null != o.user_data && o.uid == this.uid) {
n.bet_fee_currency = o.bet_fee_currency;
n.bet_options = o.bet_options;
u.default.Instance.Global.emit("showTieRate", n.bet_options);
n.declearHistory.refresh(o.declear_history);
n.dealerCount = o.ready_card_num;
n.discardCount = o.void_card_num;
1 != o.room_data.state && 2 != o.room_data.state && 3 != o.room_data.state || (n.discardCount = n.discardCount - 2);
}
e.prototype._onEnterRoom.call(this, o, n);
}
};
t.prototype._onSwitchRoom = function(e) {
var t = e.getUserData();
if (this.checkRoomType(t.room_type)) {
d.VM.getValue("lobby.roomID") != t.r && d.VM.setValue("lobby.roomID", parseInt(t.r));
u.default.Instance.Global.emit(i.GameEvent.S2C_SWITCH_ROOM, t.r);
}
};
t.prototype._onDeal = function(t) {
var o = t.getUserData();
if (this.checkRoomID(o.rid)) {
var n = y.Instance;
e.prototype._onDeal.call(this, o, n);
}
};
t.prototype._onStartBet = function(t) {
var o = t.getUserData();
if (this.checkRoomID(o.rid)) {
var n = y.Instance;
e.prototype._onStartBet.call(this, o, n);
}
};
t.prototype._onBet = function(t) {
var o = t.getUserData();
if (this.checkRoomID(o.rid)) {
var n = y.Instance;
e.prototype._onBet.call(this, o, n);
}
};
t.prototype._onBetBatch = function(t) {
var o = t.getUserData();
if (this.checkRoomID(o.rid)) {
var n = y.Instance;
e.prototype._onBetBatch.call(this, o, n);
}
};
t.prototype._onStopBet = function(t) {
var o = t.getUserData();
if (this.checkRoomID(o.rid)) {
var n = y.Instance;
e.prototype._onStopBet.call(this, o, n);
}
};
t.prototype._onShow = function(t) {
var o = t.getUserData();
if (this.checkRoomID(o.rid)) {
var n = y.Instance, a = new m.DTStruct.HistoryData({
d: o.room_data.show_card,
w: o.win_options
});
n.declearHistory.addHistory(a);
e.prototype._onShow.call(this, o, n);
}
};
t.prototype._onResetRoom = function(t) {
var o = t.getUserData();
if (this.checkRoomID(o.rid)) {
var n = y.Instance;
n.dealerCount = o.ready_card_num;
n.discardCount = o.void_card_num;
e.prototype._onResetRoom.call(this, o, n);
}
};
t.prototype._onInteract = function(t) {
var o = t.getUserData();
if (this.checkRoomID(o.rid)) {
var n = y.Instance;
e.prototype._onInteract.call(this, o, n);
}
};
t.prototype._onRank = function(t) {
var o = t.getUserData();
if (this.checkRoomID(o.rid)) {
var n = y.Instance;
e.prototype._onRank.call(this, o, n);
}
};
t.prototype._onLeave = function(t) {
var o = t.getUserData();
if (this.checkRoomID(o.rid)) {
var n = y.Instance;
e.prototype._onLeave.call(this, o, n);
}
};
t.prototype._onLeaveSingle = function(t) {
var o = t.getUserData();
if (this.checkRoomID(o.rid) || 0 == d.VM.getValue("lobby.roomID")) {
var n = y.Instance;
e.prototype._onLeaveSingle.call(this, o, n);
}
};
t.prototype._onDismiss = function(t) {
var o = t.getUserData();
if (this.checkRoomID(o.rid)) {
var n = y.Instance;
e.prototype._onDismiss.call(this, o, n);
}
};
t.prototype._onBalanceRefresh = function(t) {
var o = t.getUserData();
if (!this.checkRoomID(o.rid)) {
var n = y.Instance;
e.prototype._onBalanceRefresh.call(this, o, n);
}
};
t.prototype.sendEnterRoom = function(e, t) {
void 0 === t && (t = !0);
var o = f.default.Instance.makeMsg(l.C2S.ROOM_ENTER_ROOM, {
u: this.uid,
t: this.token,
r: e,
is_open: t
});
f.default.Instance.send(o);
};
t.prototype.sendBet = function(e, t) {
var o = c.Tools.TNumber.num2thousand(e);
h.default.Instance.CompositeBetNum = e;
var n = f.default.Instance.makeMsg(l.C2S.ROOM_BET, {
u: this.uid,
t: this.token,
r: this.roomID,
fee: o,
option: t
});
f.default.Instance.send(n);
};
t.prototype.sendInteract = function(e, t, o) {
var n;
n = o ? {
u: this.uid,
t: this.token,
r: this.roomID,
to_u: e,
opt_type: t,
opt_val: o
} : {
u: this.uid,
t: this.token,
r: this.roomID,
to_u: e,
opt_type: t
};
var a = f.default.Instance.makeMsg(l.C2S.ROOM_INTERACT, n);
f.default.Instance.send(a);
};
t.prototype.sendRank = function(e, t) {
var o = f.default.Instance.makeMsg(l.C2S.ROOM_RANK, {
u: this.uid,
t: this.token,
r: this.roomID,
page: e,
count: t
});
f.default.Instance.send(o);
};
t.prototype.sendLeave = function() {
var e = f.default.Instance.makeMsg(l.C2S.ROOM_LEAVE, {
u: this.uid,
t: this.token,
r: this.roomID
});
f.default.Instance.send(e);
};
t.prototype._onDealerList = function() {};
t.prototype.sendApplyDealer = function() {};
t.prototype.sendCancelDealer = function() {};
t.prototype._onApplyDealer = function() {};
t.prototype._onCancelDealer = function() {};
t.prototype.sendOpenDealer = function() {};
t.prototype.sendClickDealer = function() {};
t._instance = null;
return t;
}(_.CompositeProxy);
o.default = g;
cc._RF.pop();
}, {
"../../../Game/client/global/enum/game/Event": "Event",
"../../../Game/client/global/enum/game/Game": "Game",
"../../../Game/client/global/enum/net/C2S": "C2S",
"../../../Game/client/global/enum/net/S2C": "S2C",
"../../../Game/fromework/global/Tools": "Tools",
"../../../Game/fromework/helper/EventHelper": "EventHelper",
"../../../Game/fromework/mvvm/modelView/ViewModel": "ViewModel",
"../../../client/logic/game/HearBeat": "HearBeat",
"../../../client/model/ErrorModel": "ErrorModel",
"../../../fromework/helper/NetHelper": "NetHelper",
"../../Common/Utils/CompositeProxy": "CompositeProxy",
"./DTStruct": "DTStruct"
} ],
DTRecordSmall: [ function(e, t, o) {
"use strict";
cc._RF.push(t, "075dfb1sJtAtpH1GgIlAA2Y", "DTRecordSmall");
var n, a = this && this.__extends || (n = function(e, t) {
return (n = Object.setPrototypeOf || {
__proto__: []
} instanceof Array && function(e, t) {
e.__proto__ = t;
} || function(e, t) {
for (var o in t) Object.prototype.hasOwnProperty.call(t, o) && (e[o] = t[o]);
})(e, t);
}, function(e, t) {
n(e, t);
function o() {
this.constructor = e;
}
e.prototype = null === t ? Object.create(t) : (o.prototype = t.prototype, new o());
}), i = this && this.__decorate || function(e, t, o, n) {
var a, i = arguments.length, r = i < 3 ? t : null === n ? n = Object.getOwnPropertyDescriptor(t, o) : n;
if ("object" == typeof Reflect && "function" == typeof Reflect.decorate) r = Reflect.decorate(e, t, o, n); else for (var l = e.length - 1; l >= 0; l--) (a = e[l]) && (r = (i < 3 ? a(r) : i > 3 ? a(t, o, r) : a(t, o)) || r);
return i > 3 && r && Object.defineProperty(t, o, r), r;
};
Object.defineProperty(o, "__esModule", {
value: !0
});
var r = e("../../../Game/client/global/enum/game/Event"), l = e("../../../Game/fromework/helper/EventHelper"), s = e("../../Common/Utils/CompositeUtil"), c = cc._decorator, u = c.ccclass, d = c.property, p = function(e) {
a(t, e);
function t() {
var t = null !== e && e.apply(this, arguments) || this;
t.TopRecordParent = null;
t.TopRecordItem = null;
t.Dragon_Color = null;
t.Draw_Color = null;
t.Tiger_Color = null;
t.Light = null;
t.MaxCount = 18;
return t;
}
t.prototype.onEnable = function() {
l.default.Instance.Global.bind(r.GameEvent.S2C_ENTER_ROOM, this._onEnterRoom, this);
l.default.Instance.Global.bind(r.GameEvent.S2C_RESET, this._onResetRoom, this);
};
t.prototype.onDisable = function() {
l.default.Instance.Global.unbind(r.GameEvent.S2C_ENTER_ROOM, this._onEnterRoom, this);
l.default.Instance.Global.unbind(r.GameEvent.S2C_RESET, this._onResetRoom, this);
};
t.prototype.onLoad = function() {
this.refreshTopRecord(!1);
};
t.prototype._onEnterRoom = function() {
this.refreshTopRecord(!1);
};
t.prototype._onResetRoom = function() {
this.refreshTopRecord(!0);
};
t.prototype.refreshTopRecord = function(e) {
var t = this;
void 0 === e && (e = !1);
var o = s.default.Game.Model;
this.TopRecordParent.destroyAllChildren();
for (var n = o.declearHistory.getSimpleHistory(this.MaxCount), a = 0; a < n.length; a++) {
var i = n[a], r = cc.instantiate(this.TopRecordItem);
r.active = !0;
r.setPosition(cc.Vec2.ZERO);
r.parent = this.TopRecordParent;
r.getChildByName("Background").getComponent(cc.Sprite).spriteFrame = 0 == i.win ? this.Dragon_Color : 1 == i.win ? this.Draw_Color : this.Tiger_Color;
r.getChildByName("Points").getComponent(cc.Label);
}
if (e && null != this.Light) {
this.TopRecordParent.getComponent(cc.Layout).updateLayout();
var l = this.TopRecordParent.children[this.TopRecordParent.children.length - 1], c = l.parent.convertToWorldSpaceAR(l.position), u = this.Light.node.parent.convertToNodeSpaceAR(c);
this.Light.node.position = u;
this.Light.node.active = !0;
this.Light.armatureName = "Armature";
this.Light.once(dragonBones.EventObject.COMPLETE, function() {
t.Light.node.active = !1;
}, this);
this.Light.playAnimation("animation_new_details", 1);
}
};
i([ d(cc.Node) ], t.prototype, "TopRecordParent", void 0);
i([ d(cc.Node) ], t.prototype, "TopRecordItem", void 0);
i([ d(cc.SpriteFrame) ], t.prototype, "Dragon_Color", void 0);
i([ d(cc.SpriteFrame) ], t.prototype, "Draw_Color", void 0);
i([ d(cc.SpriteFrame) ], t.prototype, "Tiger_Color", void 0);
i([ d(dragonBones.ArmatureDisplay) ], t.prototype, "Light", void 0);
i([ d ], t.prototype, "MaxCount", void 0);
return i([ u ], t);
}(cc.Component);
o.default = p;
cc._RF.pop();
}, {
"../../../Game/client/global/enum/game/Event": "Event",
"../../../Game/fromework/helper/EventHelper": "EventHelper",
"../../Common/Utils/CompositeUtil": "CompositeUtil"
} ],
DTRecord: [ function(e, t, o) {
"use strict";
cc._RF.push(t, "c3238u9+ilGHYVIrbQMsGcO", "DTRecord");
var n, a = this && this.__extends || (n = function(e, t) {
return (n = Object.setPrototypeOf || {
__proto__: []
} instanceof Array && function(e, t) {
e.__proto__ = t;
} || function(e, t) {
for (var o in t) Object.prototype.hasOwnProperty.call(t, o) && (e[o] = t[o]);
})(e, t);
}, function(e, t) {
n(e, t);
function o() {
this.constructor = e;
}
e.prototype = null === t ? Object.create(t) : (o.prototype = t.prototype, new o());
}), i = this && this.__decorate || function(e, t, o, n) {
var a, i = arguments.length, r = i < 3 ? t : null === n ? n = Object.getOwnPropertyDescriptor(t, o) : n;
if ("object" == typeof Reflect && "function" == typeof Reflect.decorate) r = Reflect.decorate(e, t, o, n); else for (var l = e.length - 1; l >= 0; l--) (a = e[l]) && (r = (i < 3 ? a(r) : i > 3 ? a(t, o, r) : a(t, o)) || r);
return i > 3 && r && Object.defineProperty(t, o, r), r;
};
Object.defineProperty(o, "__esModule", {
value: !0
});
var r = e("../../../Game/fromework/helper/UIHelper"), l = e("../../Common/Utils/CompositeUtil"), s = cc._decorator, c = s.ccclass, u = s.property, d = function(e) {
a(t, e);
function t() {
var t = null !== e && e.apply(this, arguments) || this;
t.DragonWin = null;
t.TigerWin = null;
t.BottomContent = null;
t.BottomRecordParent = null;
t.BottomRecordItem = null;
t.Dragon_Color = null;
t.Draw_Color = null;
t.Tiger_Color = null;
return t;
}
t.prototype.onLoad = function() {
var e = l.default.Game.Model;
if (e) {
var t = e.declearHistory.getWinRate();
this.DragonWin.string = (100 * t.dragon).toFixed(0) + "%";
this.TigerWin.string = (100 * t.tiger).toFixed(0) + "%";
} else {
this.DragonWin.string = "0%";
this.TigerWin.string = "0%";
}
this.refreshBottomRecord();
};
t.prototype.refreshBottomRecord = function() {
var e = l.default.Game.Model;
this.BottomRecordParent.destroyAllChildren();
for (var t = e.declearHistory.getComplexHistory(18), o = 0, n = 0; n < t.length; n++) {
var a = t[n], i = 27 + 54 * n;
a.length > o && (o = a.length);
for (var r = 0; r < a.length; r++) {
var s = a[r], c = -(27 + 54 * r), u = cc.instantiate(this.BottomRecordItem);
u.active = !0;
u.setPosition(cc.v2(i, c));
u.parent = this.BottomRecordParent;
u.getChildByName("Background").color = 0 == s.win ? this.Dragon_Color : 1 == s.win ? this.Draw_Color : this.Tiger_Color;
u.getChildByName("Points").getComponent(cc.Label).string = s.getTypeString();
}
}
this.BottomContent.height = 54 * o;
};
t.prototype.onCloseClicked = function() {
r.default.Instance.removeMaskLayer(this.node, !0);
};
i([ u(cc.Label) ], t.prototype, "DragonWin", void 0);
i([ u(cc.Label) ], t.prototype, "TigerWin", void 0);
i([ u(cc.Node) ], t.prototype, "BottomContent", void 0);
i([ u(cc.Node) ], t.prototype, "BottomRecordParent", void 0);
i([ u(cc.Node) ], t.prototype, "BottomRecordItem", void 0);
i([ u(cc.Color) ], t.prototype, "Dragon_Color", void 0);
i([ u(cc.Color) ], t.prototype, "Draw_Color", void 0);
i([ u(cc.Color) ], t.prototype, "Tiger_Color", void 0);
return i([ c ], t);
}(cc.Component);
o.default = d;
cc._RF.pop();
}, {
"../../../Game/fromework/helper/UIHelper": "UIHelper",
"../../Common/Utils/CompositeUtil": "CompositeUtil"
} ],
DTScene: [ function(e, t, o) {
"use strict";
cc._RF.push(t, "e80edG2wkBFH6UDPcQ8oMbk", "DTScene");
var n, a = this && this.__extends || (n = function(e, t) {
return (n = Object.setPrototypeOf || {
__proto__: []
} instanceof Array && function(e, t) {
e.__proto__ = t;
} || function(e, t) {
for (var o in t) Object.prototype.hasOwnProperty.call(t, o) && (e[o] = t[o]);
})(e, t);
}, function(e, t) {
n(e, t);
function o() {
this.constructor = e;
}
e.prototype = null === t ? Object.create(t) : (o.prototype = t.prototype, new o());
}), i = this && this.__decorate || function(e, t, o, n) {
var a, i = arguments.length, r = i < 3 ? t : null === n ? n = Object.getOwnPropertyDescriptor(t, o) : n;
if ("object" == typeof Reflect && "function" == typeof Reflect.decorate) r = Reflect.decorate(e, t, o, n); else for (var l = e.length - 1; l >= 0; l--) (a = e[l]) && (r = (i < 3 ? a(r) : i > 3 ? a(t, o, r) : a(t, o)) || r);
return i > 3 && r && Object.defineProperty(t, o, r), r;
};
Object.defineProperty(o, "__esModule", {
value: !0
});
var r = e("../../../Game/client/global/enum/game/Const"), l = e("../../../Game/fromework/helper/AudioHelper"), s = e("../../../Game/fromework/helper/EventHelper"), c = e("../../Common/Utils/CompositeEvent"), u = e("../../Common/Utils/CompositeUtil"), d = cc._decorator, p = d.ccclass, h = d.property, f = function(e) {
a(t, e);
function t() {
var t = null !== e && e.apply(this, arguments) || this;
t.DT = null;
t.Paw = null;
t.Eff_Dragon_Win = null;
t.Eff_Tiger_Win = null;
t.Eff_Tie_Win = null;
t.Node_VS = null;
t.Eff_VS = null;
t.tieRateAry = null;
return t;
}
t.prototype._init = function() {
this.DT.armatureName = "Armature";
this.Paw.armatureName = "Armature";
this.Eff_Dragon_Win.armatureName = "Armature";
this.Eff_Tiger_Win.armatureName = "Armature";
this.Eff_Tie_Win.armatureName = "Armature";
this.Eff_VS.armatureName = "Armature";
};
t.prototype._onGameHide = function() {
this.DT.node.active = !1;
this.Paw.node.active = !1;
this.Node_VS.active = !1;
this.Eff_Dragon_Win.node.active = !1;
this.Eff_Tiger_Win.node.active = !1;
this.Eff_Tie_Win.node.active = !1;
this.unscheduleAllCallbacks();
};
t.prototype._onGameShow = function() {
this.DT.node.active = !0;
this.Paw.node.active = !0;
this.Node_VS.active = !1;
this.Eff_Dragon_Win.node.active = !1;
this.Eff_Tiger_Win.node.active = !1;
this.Eff_Tie_Win.node.active = !1;
};
t.prototype._playDragonWin = function() {
var e = this;
this.DT.playAnimation("animation_dragon_attack", 1);
this.DT.once(dragonBones.EventObject.COMPLETE, function() {
e._playDefault();
}, this);
this.Paw.playAnimation("animation_dragon_attack_up", 1);
this.Eff_Dragon_Win.node.active = !0;
this.Eff_Dragon_Win.playAnimation("animation_dragon_win", 1);
l.default.Instance.playBundleEffect(r.BundleSoundPath.dt_dragon_win);
};
t.prototype._playTigerWin = function() {
var e = this;
this.DT.playAnimation("animation_tiger_attack", 1);
this.DT.once(dragonBones.EventObject.COMPLETE, function() {
e._playDefault();
}, this);
this.Paw.playAnimation("animation_tiger_attack_up", 1);
this.Eff_Tiger_Win.node.active = !0;
this.Eff_Tiger_Win.playAnimation("animation_tiger_win", 1);
l.default.Instance.playBundleEffect(r.BundleSoundPath.dt_tiger_win);
};
t.prototype._playTie = function() {
var e = this;
this.Eff_Tie_Win.playAnimation("animation_tie", 1);
this.Eff_Tie_Win.node.active = !0;
this.Eff_Tie_Win.once(dragonBones.EventObject.COMPLETE, function() {
e._playDefault();
}, this);
l.default.Instance.playBundleEffect(r.BundleSoundPath.dt_tie_win);
};
t.prototype._playJoin = function() {
var e = this;
this.DT.node.active = !0;
this.Paw.node.active = !0;
this.Node_VS.active = !1;
this.DT.playAnimation("animation_join", 1);
this.DT.once(dragonBones.EventObject.COMPLETE, function() {
e._playDefault();
}, this);
this.Paw.playAnimation("animation_join_up", 1);
};
t.prototype._playOut = function() {
var e = this;
this.DT.playAnimation("animation_out", 1);
this.Paw.playAnimation("animation_out_up", 1);
this.DT.once(dragonBones.EventObject.COMPLETE, function() {
e.DT.node.active = !1;
e.Paw.node.active = !1;
e.Eff_VS.playAnimation("animation_vs", 1);
e.Node_VS.active = !0;
e.Eff_VS.once(dragonBones.EventObject.COMPLETE, function() {
e._playJoin();
});
}, this);
};
t.prototype._playDefault = function() {
this.Eff_Dragon_Win.node.active = !1;
this.Eff_Tiger_Win.node.active = !1;
this.Eff_Tie_Win.node.active = !1;
this.Node_VS.active = !1;
this.DT.playAnimation("animation_default", -1);
this.Paw.playAnimation("animation_default_up", -1);
};
t.prototype._showEffect_Win = function() {
var e = u.default.Game.Model.win_options;
0 == e[0] ? this._playDragonWin() : 1 == e[0] ? this._playTie() : 2 == e[0] && this._playTigerWin();
};
t.prototype._playStartBetting = function() {
this._playOut();
};
t.prototype._onStartBetting = function() {};
t.prototype.onEnable = function() {
s.default.Instance.Global.bind(c.CompositeUIEvent.UI_PLAY_START_BET, this._playStartBetting, this);
s.default.Instance.Global.bind(c.CompositeGameEvent.UI_EFFECT_START_BET, this._onStartBetting, this);
s.default.Instance.Global.bind(c.OddsEvent.ODDS_SHOW_WIN, this._showEffect_Win, this);
s.default.Instance.Global.bind("showTieRate", this.showTieRate, this);
};
t.prototype.onDisable = function() {
s.default.Instance.Global.unbind(c.CompositeUIEvent.UI_PLAY_START_BET, this._playStartBetting, this);
s.default.Instance.Global.unbind(c.CompositeGameEvent.UI_EFFECT_START_BET, this._onStartBetting, this);
s.default.Instance.Global.unbind(c.OddsEvent.ODDS_SHOW_WIN, this._showEffect_Win, this);
s.default.Instance.Global.unbind("showTieRate", this.showTieRate, this);
};
t.prototype.showTieRate = function(e) {
var t = e.getUserData();
t && t[1] && (this.tieRateAry.string = t[1].x + "x");
};
t.prototype.onLoad = function() {
this._init();
cc.game.on(cc.game.EVENT_HIDE, this._onGameHide, this);
cc.game.on(cc.game.EVENT_SHOW, this._onGameShow, this);
};
t.prototype.start = function() {
this._playDefault();
};
i([ h(dragonBones.ArmatureDisplay) ], t.prototype, "DT", void 0);
i([ h(dragonBones.ArmatureDisplay) ], t.prototype, "Paw", void 0);
i([ h(dragonBones.ArmatureDisplay) ], t.prototype, "Eff_Dragon_Win", void 0);
i([ h(dragonBones.ArmatureDisplay) ], t.prototype, "Eff_Tiger_Win", void 0);
i([ h(dragonBones.ArmatureDisplay) ], t.prototype, "Eff_Tie_Win", void 0);
i([ h(cc.Node) ], t.prototype, "Node_VS", void 0);
i([ h(dragonBones.ArmatureDisplay) ], t.prototype, "Eff_VS", void 0);
i([ h(cc.Label) ], t.prototype, "tieRateAry", void 0);
return i([ p ], t);
}(cc.Component);
o.default = f;
cc._RF.pop();
}, {
"../../../Game/client/global/enum/game/Const": "Const",
"../../../Game/fromework/helper/AudioHelper": "AudioHelper",
"../../../Game/fromework/helper/EventHelper": "EventHelper",
"../../Common/Utils/CompositeEvent": "CompositeEvent",
"../../Common/Utils/CompositeUtil": "CompositeUtil"
} ],
DTStruct: [ function(e, t, o) {
"use strict";
cc._RF.push(t, "97254ASC/lE4KsI29MVnWMz", "DTStruct");
Object.defineProperty(o, "__esModule", {
value: !0
});
o.DTStruct = void 0;
(function(e) {
var t = function() {
function e(e) {
this.win = 0;
e && this.refresh(e);
}
e.prototype.refresh = function(e) {
this.win = e.w[0];
};
e.prototype.getTypeString = function() {
return 0 == this.win ? "D" : 1 == this.win ? "TIE" : 2 == this.win ? "T" : "";
};
return e;
}();
e.HistoryData = t;
var o = function() {
function e(e) {
this.historyArray = [];
e && this.refresh(e);
}
e.prototype.refresh = function(e) {
var o = this;
this.historyArray.splice(0);
e.forEach(function(e) {
var n = new t(e);
o.historyArray.push(n);
});
};
e.prototype.getWinRate = function() {
var e = 0, t = 0, o = 0, n = 0;
this.historyArray.forEach(function(a) {
e++;
0 == a.win ? t++ : 1 == a.win ? o++ : 2 == a.win && n++;
});
return {
dragon: t / e,
draw: o / e,
tiger: n / e
};
};
e.prototype.addHistory = function(e) {
100 == this.historyArray.length && this.historyArray.shift();
this.historyArray.push(e);
};
e.prototype.getSimpleHistory = function(e) {
for (var t = [], o = this.historyArray.length - 1; o >= 0; o--) {
var n = this.historyArray[o];
t.unshift(n);
if (t.length == e) break;
}
return t;
};
e.prototype.getComplexHistory = function(e) {
for (var t = [], o = -1, n = this.historyArray.length - 1; n >= 0; n--) {
var a = this.historyArray[n];
if (o != a.win) {
if (t.length == e) break;
o = a.win;
t.unshift([]);
}
t[0].length != e && t[0].unshift(a);
}
return t;
};
return e;
}();
e.DeclearHistory = o;
})(o.DTStruct || (o.DTStruct = {}));
cc._RF.pop();
}, {} ],
DailyRechargeItem: [ function(e, t, o) {
"use strict";
cc._RF.push(t, "3a97e37QBBJ35muZIj4c8j4", "DailyRechargeItem");
var n, a = this && this.__extends || (n = function(e, t) {
return (n = Object.setPrototypeOf || {
__proto__: []
} instanceof Array && function(e, t) {
e.__proto__ = t;
} || function(e, t) {
for (var o in t) Object.prototype.hasOwnProperty.call(t, o) && (e[o] = t[o]);
})(e, t);
}, function(e, t) {
n(e, t);
function o() {
this.constructor = e;
}
e.prototype = null === t ? Object.create(t) : (o.prototype = t.prototype, new o());
}), i = this && this.__decorate || function(e, t, o, n) {
var a, i = arguments.length, r = i < 3 ? t : null === n ? n = Object.getOwnPropertyDescriptor(t, o) : n;
if ("object" == typeof Reflect && "function" == typeof Reflect.decorate) r = Reflect.decorate(e, t, o, n); else for (var l = e.length - 1; l >= 0; l--) (a = e[l]) && (r = (i < 3 ? a(r) : i > 3 ? a(t, o, r) : a(t, o)) || r);
return i > 3 && r && Object.defineProperty(t, o, r), r;
};
Object.defineProperty(o, "__esModule", {
value: !0
});
var r = e("../../../../Game/fromework/helper/EventHelper"), l = e("../ActiveEvent"), s = cc._decorator, c = s.ccclass, u = s.property, d = function(e) {
a(t, e);
function t() {
var t = null !== e && e.apply(this, arguments) || this;
t.Deposit = null;
t.Bonus = null;
t.PayNum = null;
t._data = null;
return t;
}
t.prototype.refreshView = function(e) {
this._data = e;
this.Deposit.string = (Number(this._data.amount) + Number(this._data.deposit)).toString();
this.Bonus.string = this._data.bonus.toString();
this.PayNum.string = this._data.amount.toString();
};
t.prototype.onPayClicked = function() {
r.default.Instance.Global.emit(l.DailyRechargeEvent.DAILY_RECHARGE_PAY_CLICK, this._data);
};
i([ u(cc.Label) ], t.prototype, "Deposit", void 0);
i([ u(cc.Label) ], t.prototype, "Bonus", void 0);
i([ u(cc.Label) ], t.prototype, "PayNum", void 0);
return i([ c ], t);
}(cc.Component);
o.default = d;
cc._RF.pop();
}, {
"../../../../Game/fromework/helper/EventHelper": "EventHelper",
"../ActiveEvent": "ActiveEvent"
} ],
DailyRecharge: [ function(e, t, o) {
"use strict";
cc._RF.push(t, "57d6dQ7E3tMWbkBUcP85Lfe", "DailyRecharge");
var n, a = this && this.__extends || (n = function(e, t) {
return (n = Object.setPrototypeOf || {
__proto__: []
} instanceof Array && function(e, t) {
e.__proto__ = t;
} || function(e, t) {
for (var o in t) Object.prototype.hasOwnProperty.call(t, o) && (e[o] = t[o]);
})(e, t);
}, function(e, t) {
n(e, t);
function o() {
this.constructor = e;
}
e.prototype = null === t ? Object.create(t) : (o.prototype = t.prototype, new o());
}), i = this && this.__decorate || function(e, t, o, n) {
var a, i = arguments.length, r = i < 3 ? t : null === n ? n = Object.getOwnPropertyDescriptor(t, o) : n;
if ("object" == typeof Reflect && "function" == typeof Reflect.decorate) r = Reflect.decorate(e, t, o, n); else for (var l = e.length - 1; l >= 0; l--) (a = e[l]) && (r = (i < 3 ? a(r) : i > 3 ? a(t, o, r) : a(t, o)) || r);
return i > 3 && r && Object.defineProperty(t, o, r), r;
};
Object.defineProperty(o, "__esModule", {
value: !0
});
var r = e("../../../../Game/client/global/enum/game/Event"), l = e("../../../../Game/client/model/CommonModel"), s = e("../../../../Game/client/model/LanguageModel"), c = e("../../../../Game/fromework/helper/EventHelper"), u = e("../../../global/PopHelper"), d = e("../../../model/RedDotModel"), p = e("../../../model/WalletModel"), h = e("../../Wallet/WalletHelper"), f = e("../ActiveEvent"), _ = e("./DailyRechargeItem"), m = cc._decorator, y = m.ccclass, g = m.property, v = function(e) {
a(t, e);
function t() {
var t = null !== e && e.apply(this, arguments) || this;
t.Prefab_Item = null;
t.ItemParent = null;
t._data = null;
return t;
}
t.prototype.onEnable = function() {
c.default.Instance.Global.bind(r.WalletEvent.RECHARGE_GET_GOODS, this.onGetGoods, this);
c.default.Instance.Global.bind(f.DailyRechargeEvent.DAILY_RECHARGE_PAY_CLICK, this.onPayButtonClicked, this);
};
t.prototype.onDisable = function() {
c.default.Instance.Global.unbind(r.WalletEvent.RECHARGE_GET_GOODS, this.onGetGoods, this);
c.default.Instance.Global.unbind(f.DailyRechargeEvent.DAILY_RECHARGE_PAY_CLICK, this.onPayButtonClicked, this);
};
t.prototype.onGetGoods = function() {
var e = p.WalletProxy.Instance.rechargeGoods.get(this._data.id);
if (e) {
this.ItemParent.destroyAllChildren();
for (var t = Math.min(3, e.length), o = 0; o < t; o++) {
var n = cc.instantiate(this.Prefab_Item);
n.position = cc.Vec3.ZERO;
n.parent = this.ItemParent;
var a = new l.Common.AddCashData();
a.amount = e[o].amount;
a.deposit = e[o].deposit;
a.bonus = e[o].bonus;
n.getComponent(_.default).refreshView(a);
}
}
};
t.prototype.refreshView = function() {
var e = p.WalletProxy.Instance.getRechargeActiveByType(5);
this._data = e[0];
d.default.Instance.delRechargeRedDot(this._data);
p.WalletProxy.Instance.sendGetRechargeGoods(this._data.id, []);
};
t.prototype.onPayButtonClicked = function(e) {
var t = e.getUserData();
if (t) {
var o = t.amount, n = this._data ? this._data.id : 0;
p.WalletProxy.Instance.sendPayment(o, n, t.deposit, t.bonus, function(e) {
var t = JSON.parse(e.response);
h.default.Instance.onPayment(t);
});
} else u.PopHelper.Instance.showTips(s.default.getString("RECHARGE_INPUT_TIPS1"));
};
i([ g(cc.Prefab) ], t.prototype, "Prefab_Item", void 0);
i([ g(cc.Node) ], t.prototype, "ItemParent", void 0);
return i([ y ], t);
}(cc.Component);
o.default = v;
cc._RF.pop();
}, {
"../../../../Game/client/global/enum/game/Event": "Event",
"../../../../Game/client/model/CommonModel": "CommonModel",
"../../../../Game/client/model/LanguageModel": "LanguageModel",
"../../../../Game/fromework/helper/EventHelper": "EventHelper",
"../../../global/PopHelper": "PopHelper",
"../../../model/RedDotModel": "RedDotModel",
"../../../model/WalletModel": "WalletModel",
"../../Wallet/WalletHelper": "WalletHelper",
"../ActiveEvent": "ActiveEvent",
"./DailyRechargeItem": "DailyRechargeItem"
} ],
Dealer: [ function(e, t, o) {
"use strict";
cc._RF.push(t, "356f7XyG7FE84qvfFprfE/p", "Dealer");
var n, a = this && this.__extends || (n = function(e, t) {
return (n = Object.setPrototypeOf || {
__proto__: []
} instanceof Array && function(e, t) {
e.__proto__ = t;
} || function(e, t) {
for (var o in t) Object.prototype.hasOwnProperty.call(t, o) && (e[o] = t[o]);
})(e, t);
}, function(e, t) {
n(e, t);
function o() {
this.constructor = e;
}
e.prototype = null === t ? Object.create(t) : (o.prototype = t.prototype, new o());
}), i = this && this.__decorate || function(e, t, o, n) {
var a, i = arguments.length, r = i < 3 ? t : null === n ? n = Object.getOwnPropertyDescriptor(t, o) : n;
if ("object" == typeof Reflect && "function" == typeof Reflect.decorate) r = Reflect.decorate(e, t, o, n); else for (var l = e.length - 1; l >= 0; l--) (a = e[l]) && (r = (i < 3 ? a(r) : i > 3 ? a(t, o, r) : a(t, o)) || r);
return i > 3 && r && Object.defineProperty(t, o, r), r;
};
Object.defineProperty(o, "__esModule", {
value: !0
});
var r = e("../../Game/client/global/enum/game/Const"), l = e("../../Game/client/logic/game/GameHelper"), s = e("../../Game/fromework/helper/AudioHelper"), c = cc._decorator, u = c.ccclass, d = c.property, p = function(e) {
a(t, e);
function t() {
var t = null !== e && e.apply(this, arguments) || this;
t.show = null;
t.cardParent = null;
t.back = null;
t._isRunDealer = !1;
return t;
}
t.prototype.reset = function() {
this.show.active = !1;
this._isRunDealer = !1;
this.node.stopAllActions();
this.back.stopAllActions();
this.back.setPosition(cc.v2(0, 0));
};
t.prototype.alignmentToDealer = function(e) {
var t = this.node.parent.convertToWorldSpaceAR(this.node.getPosition());
e.setPosition(e.parent.convertToNodeSpaceAR(t));
e.scale = r.DESK_CARD_SCALE;
};
t.prototype.dealerHandCard = function(e, t, o) {
var n = this;
if (!this._isRunDealer) {
this.show.active = !0;
this.back.setPosition(cc.v2(0, 0));
e.forEach(function(e) {
n.alignmentToDealer(e.node);
e.node.active = !1;
});
var a = function() {
var a = cc.v2(0, t);
e.forEach(function(t, i) {
t.moveCard(.1, a, -1, 1, function() {
if (i == e.length - 1) {
o && o();
n._isRunDealer = !1;
}
}, !0, !1);
});
}, i = -e.length * r.CARD_SHOW_WIDTH / 2, l = function(o) {
var c = e[o];
if (c) {
c.node.active = !0;
var u = cc.v2(i + r.CARD_SHOW_WIDTH * o, t);
o++;
var d = cc.sequence(cc.callFunc(function() {
s.default.Instance.playBundleEffect(r.BundleSoundPath.common_discard);
c.moveCard(.2, u, 1, 1, function() {
c.flipCard(.5, cc.v3(0, 180, 0), !1, function() {
o == e.length - 1 && a();
});
}, !0, !1);
}), cc.delayTime(.08), cc.callFunc(function() {
l(o);
}));
n.node.runAction(d);
}
};
this._isRunDealer = !0;
l(0);
}
};
t.prototype.dealerOpenDeck = function(e, t, o) {
this.alignmentToDealer(e.node);
s.default.Instance.playBundleEffect(r.BundleSoundPath.common_discard);
e.moveCard(.35, t, r.DESK_CARD_SCALE, r.DESK_CARD_SCALE, function() {});
e.flipCard(.35, cc.v3(0, 180, 0), !1, function() {
o && o();
});
};
t.prototype.dealerWildCard = function(e, t, o) {
this.alignmentToDealer(e.node);
s.default.Instance.playBundleEffect(r.BundleSoundPath.common_discard);
e.moveCard(.35, t.sub(cc.v2(r.CARD_WIDTH * r.DESK_CARD_SCALE_WILD, 0)), r.DESK_CARD_SCALE_WILD, r.DESK_CARD_SCALE_WILD, function() {
e.flipCard(.12, cc.v3(0, -180, r.DESK_CARD_ROTATE_WILD), !1, function() {
e.moveCard(.24, t, r.DESK_CARD_SCALE_WILD, r.DESK_CARD_SCALE_WILD, function() {
l.GroupHelper.setIsShowWildCard(!0);
o && o();
}, !1);
});
}, !1);
};
t.prototype.moveToCloseDeck = function(e, t) {
var o = this;
this.back.setPosition(cc.v2(0, 0));
var n = cc.sequence(cc.moveTo(.35, e), cc.callFunc(function() {
o.show.active = !1;
o.back.setPosition(cc.v2(0, 0));
t && t();
o._isRunDealer = !1;
}));
this.back.runAction(n);
};
i([ d(cc.Node) ], t.prototype, "show", void 0);
i([ d(cc.Node) ], t.prototype, "cardParent", void 0);
i([ d(cc.Node) ], t.prototype, "back", void 0);
return i([ u ], t);
}(cc.Component);
o.default = p;
cc._RF.pop();
}, {
"../../Game/client/global/enum/game/Const": "Const",
"../../Game/client/logic/game/GameHelper": "GameHelper",
"../../Game/fromework/helper/AudioHelper": "AudioHelper"
} ],
DevTestScene: [ function(e, t, o) {
"use strict";
cc._RF.push(t, "3ba074S7ThBEpE6KzY8PDh+", "DevTestScene");
var n, a = this && this.__extends || (n = function(e, t) {
return (n = Object.setPrototypeOf || {
__proto__: []
} instanceof Array && function(e, t) {
e.__proto__ = t;
} || function(e, t) {
for (var o in t) Object.prototype.hasOwnProperty.call(t, o) && (e[o] = t[o]);
})(e, t);
}, function(e, t) {
n(e, t);
function o() {
this.constructor = e;
}
e.prototype = null === t ? Object.create(t) : (o.prototype = t.prototype, new o());
}), i = this && this.__decorate || function(e, t, o, n) {
var a, i = arguments.length, r = i < 3 ? t : null === n ? n = Object.getOwnPropertyDescriptor(t, o) : n;
if ("object" == typeof Reflect && "function" == typeof Reflect.decorate) r = Reflect.decorate(e, t, o, n); else for (var l = e.length - 1; l >= 0; l--) (a = e[l]) && (r = (i < 3 ? a(r) : i > 3 ? a(t, o, r) : a(t, o)) || r);
return i > 3 && r && Object.defineProperty(t, o, r), r;
};
Object.defineProperty(o, "__esModule", {
value: !0
});
var r = e("../../../Game/client/global/enum/game/Event"), l = e("../../../Game/fromework/helper/EventHelper"), s = e("../../../platform/Platform"), c = cc._decorator, u = c.ccclass, d = c.property, p = function(e) {
a(t, e);
function t() {
var t = null !== e && e.apply(this, arguments) || this;
t.label = null;
t.Img = null;
t.OK = null;
t.Photo = null;
t.Album = null;
t.Mask = null;
t._spriteFrame = null;
return t;
}
t.prototype.onClickGPS = function() {
this.label.string = "";
s.default.loginFb();
};
t.prototype.onClickAddress = function() {
this.label.string = "";
s.default.signInByGoogle();
};
t.prototype.onClickOnlyID = function() {
this.label.string = "";
this.label.string = s.default.getOnlyID();
};
t.prototype.onClickTakePhoto = function() {
s.default.takePhoto();
};
t.prototype.onClickPickAlbum = function() {
s.default.pickImageFromAlbum();
};
t.prototype.onClickOK = function() {
var e = this.Mask.getBoundingBox();
this._spriteFrame.setRect(e);
this._changeState(!1);
};
t.prototype._initNative = function() {
s.default.log("Native is init!");
};
t.prototype._bindCallback = function() {
var e = this;
l.default.Instance.Global.bind(r.PlatformEvent.PLATFORM_PICK_ALBUM_COMPLETED, function(t) {
var o = "" + t.getUserData();
e._setImg(o);
});
l.default.Instance.Global.bind(r.PlatformEvent.PLATFORM_TAKE_PHOTO_COMPLETED, function(t) {
var o = "" + t.getUserData();
e._setImg(o);
});
};
t.prototype._changeState = function(e) {
void 0 === e && (e = !1);
this.Photo.node.active = !e;
this.Album.node.active = !e;
this.Mask.active = e;
this.OK.node.active = e;
};
t.prototype._setImg = function(e) {
var t = this;
this.label.string = "";
this.label.string = e;
cc.loader.load(e, function(e, o) {
t._spriteFrame = new cc.SpriteFrame(o);
t.Img.spriteFrame = t._spriteFrame;
var n = t._spriteFrame.getOriginalSize(), a = t.Img.node.parent.width;
t.Img.node.width = a;
t.Img.node.height = n.height * (a / n.width);
t._spriteFrame.setOriginalSize(t.Img.node.getContentSize());
});
this._changeState(!0);
};
t.prototype.onLoad = function() {
this._initNative();
};
t.prototype.start = function() {
this._bindCallback();
};
i([ d(cc.Label) ], t.prototype, "label", void 0);
i([ d(cc.Sprite) ], t.prototype, "Img", void 0);
i([ d(cc.Button) ], t.prototype, "OK", void 0);
i([ d(cc.Button) ], t.prototype, "Photo", void 0);
i([ d(cc.Button) ], t.prototype, "Album", void 0);
i([ d(cc.Node) ], t.prototype, "Mask", void 0);
return i([ u ], t);
}(cc.Component);
o.default = p;
cc._RF.pop();
}, {
"../../../Game/client/global/enum/game/Event": "Event",
"../../../Game/fromework/helper/EventHelper": "EventHelper",
"../../../platform/Platform": "Platform"
} ],
DownNewLayer: [ function(e, t, o) {
"use strict";
cc._RF.push(t, "4bb00K/3MJGCa4S+HvqvxKN", "DownNewLayer");
var n, a = this && this.__extends || (n = function(e, t) {
return (n = Object.setPrototypeOf || {
__proto__: []
} instanceof Array && function(e, t) {
e.__proto__ = t;
} || function(e, t) {
for (var o in t) Object.prototype.hasOwnProperty.call(t, o) && (e[o] = t[o]);
})(e, t);
}, function(e, t) {
n(e, t);
function o() {
this.constructor = e;
}
e.prototype = null === t ? Object.create(t) : (o.prototype = t.prototype, new o());
}), i = this && this.__decorate || function(e, t, o, n) {
var a, i = arguments.length, r = i < 3 ? t : null === n ? n = Object.getOwnPropertyDescriptor(t, o) : n;
if ("object" == typeof Reflect && "function" == typeof Reflect.decorate) r = Reflect.decorate(e, t, o, n); else for (var l = e.length - 1; l >= 0; l--) (a = e[l]) && (r = (i < 3 ? a(r) : i > 3 ? a(t, o, r) : a(t, o)) || r);
return i > 3 && r && Object.defineProperty(t, o, r), r;
};
Object.defineProperty(o, "__esModule", {
value: !0
});
var r = e("../../../../Game/Script/global/GlobalValue"), l = e("../../../../Game/client/global/enum/game/Event"), s = e("../../../../Game/client/global/enum/game/Game"), c = e("../../../../Game/client/model/LanguageModel"), u = e("../../../../Game/fromework/global/Tools"), d = e("../../../../Game/fromework/helper/EventHelper"), p = e("../../../../Game/fromework/helper/UIHelper"), h = e("../../../../Game/fromework/mvvm/modelView/ViewModel"), f = e("../../../component/NumericLabel"), _ = e("../../../global/Global"), m = e("../../../global/PopHelper"), y = e("../../../model/PhoneModel"), g = e("../../../model/WalletModel"), v = cc._decorator, C = v.ccclass, b = v.property, I = function(e) {
a(t, e);
function t() {
var t = null !== e && e.apply(this, arguments) || this;
t.numMoney = null;
t.downButton = null;
t.bindPhone = null;
t.PhoneInput = null;
t.OTPInput = null;
t.SendOTPButton = null;
t.SendOTPButtonTitle = null;
t.Time = null;
t._otpPhoneNumber = "";
t._interval = -1;
return t;
}
t.prototype.onEnable = function() {
d.default.Instance.Global.bind(l.WalletEvent.KYC_MOBILE_BIND_CODE, this.refreshOtp, this);
d.default.Instance.Global.bind(l.WalletEvent.KYC_MOBILE_BIND_PHONE, this.onMobileBindPhone, this);
};
t.prototype.onDisable = function() {
d.default.Instance.Global.unbind(l.WalletEvent.KYC_MOBILE_BIND_CODE, this.refreshOtp, this);
d.default.Instance.Global.unbind(l.WalletEvent.KYC_MOBILE_BIND_PHONE, this.onMobileBindPhone, this);
};
t.prototype.start = function() {
if (_.Global.Instance.down_safe_reward && null != _.Global.Instance.down_safe_reward && Object.keys(_.Global.Instance.down_safe_reward).length > 0) for (var e in _.Global.Instance.down_safe_reward) if (_.Global.Instance.down_safe_reward[e] && _.Global.Instance.down_safe_reward[e] > 0) {
this.numMoney.string = _.Global.Instance.down_safe_reward[e];
break;
}
var t = h.VM.getValue("wallet.userPhone");
if (t && 0 != t) {
this.downButton.active = !0;
this.downButton.getChildByName("tipsLabel").getComponent(cc.Label).string = "Your bound mobile phone is " + t + ". \nIn the new version, you can get additional rewards by logging in to the game with your bound mobile phone.";
this.bindPhone.active = !1;
} else {
this.downButton.active = !1;
this.bindPhone.active = !0;
}
};
t.prototype.refreshPhone = function() {
var e = h.VM.getValue("wallet.userPhone");
if (e && 0 != e) {
this.downButton.active = !0;
this.downButton.getChildByName("tipsLabel").getComponent(cc.Label).string = "Your bound mobile phone is " + e + ". \nIn the new version, you can get additional rewards by logging in to the game with your bound mobile phone.";
this.bindPhone.active = !1;
} else {
this.downButton.active = !1;
this.bindPhone.active = !0;
}
};
t.prototype.downClick = function() {
var e = r.default.getInstance().InviteTargetLink;
e && "" != e || (e = "https://download.genevah.xyz");
cc.sys.openURL(e);
};
t.prototype.closeClick = function() {
p.default.Instance.removeMaskLayer(this.node, !0);
};
t.prototype.onSendOTpClicked = function() {
if (u.Tools.TStr.checkType(this.PhoneInput.string, "indiaPhone")) {
this._otpPhoneNumber = this.PhoneInput.string;
y.PhoneProxy.Instance.sendGetVerificationCode(s.GameEnum.VerificationType.SMS_TYPE_BIND_PHONE, this.PhoneInput.string);
} else m.PopHelper.Instance.showTips(c.default.getString("KYC_INPUT_TIP_1"));
};
t.prototype.onSaveClicked = function() {
var e = this.OTPInput.string;
null != e && "" != e ? g.WalletProxy.Instance.sendBindPhone(this._otpPhoneNumber, 91, e) : m.PopHelper.Instance.showTips(c.default.getString("KYC_INPUT_TIP_2"));
};
t.prototype.refreshOtp = function() {
var e = this, t = y.PhoneProxy.Instance.getCountDown(s.GameEnum.VerificationType.SMS_TYPE_BIND_PHONE), o = function() {
e.Time.string = t + "";
};
if (t <= 0) {
this.SendOTPButton.interactable = !0;
this.SendOTPButtonTitle.active = !0;
this.Time.node.active = !1;
} else {
this.SendOTPButton.interactable = !1;
this.SendOTPButtonTitle.active = !1;
this.Time.node.active = !0;
if (-1 != this._interval) {
clearInterval(this._interval);
this._interval = -1;
}
o();
this._interval = setInterval(function() {
t--;
if (!e || !e.node || !e.node.isValid || t <= 0) {
clearInterval(e._interval);
if (e.node) {
e.SendOTPButton.interactable = !0;
e.SendOTPButtonTitle.active = !0;
e.Time.node.active = !1;
}
} else o();
}, 1e3);
}
};
t.prototype.onMobileBindPhone = function(e) {
if (e.getUserData()) {
this.refreshPhone();
m.PopHelper.Instance.showTips("Binding successful!");
} else {
var t = {
title: c.default.getString("PROMPT_NOTICE"),
content: c.default.getString("KYC_OPT_FAILED"),
rightTitle: c.default.getString("COMMON_TRY_AGAIN"),
rightCallFunc: function() {}
};
m.PopHelper.Instance.showAlert(t, null);
}
};
i([ b(cc.Label) ], t.prototype, "numMoney", void 0);
i([ b(cc.Node) ], t.prototype, "downButton", void 0);
i([ b(cc.Node) ], t.prototype, "bindPhone", void 0);
i([ b(f.default) ], t.prototype, "PhoneInput", void 0);
i([ b(f.default) ], t.prototype, "OTPInput", void 0);
i([ b(cc.Button) ], t.prototype, "SendOTPButton", void 0);
i([ b(cc.Node) ], t.prototype, "SendOTPButtonTitle", void 0);
i([ b(cc.Label) ], t.prototype, "Time", void 0);
return i([ C ], t);
}(cc.Component);
o.default = I;
cc._RF.pop();
}, {
"../../../../Game/Script/global/GlobalValue": "GlobalValue",
"../../../../Game/client/global/enum/game/Event": "Event",
"../../../../Game/client/global/enum/game/Game": "Game",
"../../../../Game/client/model/LanguageModel": "LanguageModel",
"../../../../Game/fromework/global/Tools": "Tools",
"../../../../Game/fromework/helper/EventHelper": "EventHelper",
"../../../../Game/fromework/helper/UIHelper": "UIHelper",
"../../../../Game/fromework/mvvm/modelView/ViewModel": "ViewModel",
"../../../component/NumericLabel": "NumericLabel",
"../../../global/Global": "Global",
"../../../global/PopHelper": "PopHelper",
"../../../model/PhoneModel": "PhoneModel",
"../../../model/WalletModel": "WalletModel"
} ],
ErrorModel: [ function(e, t, o) {
"use strict";
cc._RF.push(t, "b1ca5l4Lb9LZLpgSnIHVrY8", "ErrorModel");
Object.defineProperty(o, "__esModule", {
value: !0
});
var n = e("../../Config"), a = e("../../Game/client/global/enum/game/Const"), i = e("../../Game/client/global/enum/game/Event"), r = e("../../Game/client/global/enum/game/Game"), l = e("../../Game/client/global/enum/net/S2C"), s = e("../../Game/client/model/LanguageModel"), c = e("../../Game/client/model/UpdateModel"), u = e("../../Game/fromework/global/Tools"), d = e("../../Game/fromework/helper/EventHelper"), p = e("../../Game/fromework/mvvm/modelView/ViewModel"), h = e("../../platform/Platform"), f = e("../../Composite/RedAndBlackFast/Script/RBFastEvent"), _ = e("../global/Global"), m = e("../global/PopHelper"), y = e("../logic/Wallet/WalletHelper"), g = e("./UserModel"), v = function() {
function e() {
this.CompositeBetNum = 0;
}
Object.defineProperty(e, "Instance", {
get: function() {
e._instance || (e._instance = new e());
return e._instance;
},
enumerable: !1,
configurable: !0
});
e.prototype.Init = function() {
d.default.Instance.Net.bind(l.S2C.ERROR.ERROR_CODE, this._onError, this);
};
e.prototype._restart = function() {
_.Global.Instance.restartGame();
};
e.prototype._onError = function(e) {
var t = this, o = e.getUserData();
if (null != o.r) {
if (o.c == r.GameEnum.ErrorCode.ROOM_JOIN_MAX) {
d.default.Instance.Global.emit("ErrorCode123");
return;
}
o.c == r.GameEnum.ErrorCode.ROOM_ENTER_ROOM_ERROR && d.default.Instance.Global.emit(i.ErrorCodeEvent.ERROR_EVENT_106 + o.r);
if (o.c == r.GameEnum.ErrorCode.NOT_ALLOW_LEAVE) {
m.PopHelper.Instance.showTips(s.default.getString("ERROR_TIPS_130"));
return;
}
if (o.c == r.GameEnum.ErrorCode.ROOM_USER_CURR_ERROR || o.c == r.GameEnum.ErrorCode.ROOM_USER_PLAY_ERROR || o.c == r.GameEnum.ErrorCode.ROOM_DRAW_CARD_ERROR || o.c == r.GameEnum.ErrorCode.ROOM_DISCARD_CARD_ERROR || o.c == r.GameEnum.ErrorCode.ROOM_USER_FINISH_ERROR || o.c == r.GameEnum.ErrorCode.ROOM_USER_DECLEAR_ERROR) {
if (o.r == p.VM.getValue("lobby.roomID")) d.default.Instance.Global.emit(i.GameEvent.TABLE_REFRESH_TABLE); else if (o.r == p.VM.getValue("lobby.roomIDFast")) d.default.Instance.Global.emit(f.RBFastEvent.TABLE_REFRESH_TABLE_FAST); else {
d.default.Instance.Global.emit(i.GameEvent.TABLE_REFRESH_TABLE);
d.default.Instance.Global.emit(f.RBFastEvent.TABLE_REFRESH_TABLE_FAST);
}
return;
}
if (o.c == r.GameEnum.ErrorCode.ROOM_NOT_EXIST || o.c == r.GameEnum.ErrorCode.ROOM_NOT_IN || o.c == r.GameEnum.ErrorCode.USER_NOT_EXIST) {
if (o.r == p.VM.getValue("lobby.roomID")) d.default.Instance.Global.emit(i.GameEvent.S2C_LEAVE_SINGLE); else if (o.r == p.VM.getValue("lobby.roomIDFast")) d.default.Instance.Global.emit(f.RBFastEvent.S2C_LEAVE_SINGLE_FAST); else {
d.default.Instance.Global.emit(i.GameEvent.S2C_LEAVE_SINGLE);
d.default.Instance.Global.emit(f.RBFastEvent.S2C_LEAVE_SINGLE_FAST);
}
return;
}
o.c == r.GameEnum.ErrorCode.ROOM_DEALER_LIST_FULL && m.PopHelper.Instance.showTips("The list is full");
o.c == r.GameEnum.ErrorCode.ROOM_DEALER_LIST_FEE_NOT_ENOUGH && m.PopHelper.Instance.showTips("The user requested not enough gold coins");
}
if (o.c != r.GameEnum.ErrorCode.USER_NOT_LOGIN && o.c != r.GameEnum.ErrorCode.USER_TOKEN_EXPIRED && o.c != r.GameEnum.ErrorCode.USER_TOKEN_ERR) if (o.c != r.GameEnum.ErrorCode.USER_CODE_FAIL) if (o.c != r.GameEnum.ErrorCode.USER_FROZEN) if (o.c != r.GameEnum.ErrorCode.SERVER_BUSY) if (o.c != r.GameEnum.ErrorCode.USER_PHONE_EXIST) if (o.c != r.GameEnum.ErrorCode.USER_PHONE_NOT_EXIST) {
if (o.c == r.GameEnum.ErrorCode.USER_PHONE_TOKEN_ERROR) {
g.default.Instance.phoneTokenIsTimeOut = !0;
var l = h.default.getOnlyID(), _ = h.default.getDeviceID();
h.default.log("Guest login onlyID:" + l);
b = {
packageName: h.default.getPackageName(),
onlyID: l,
device_info: _,
type: a.LoginType.Guest,
channel: n.Config.Channel,
platform: g.default.Instance.getPlatform(),
version: String(h.default.getVersionCode()),
hot_update_version: c.default.Instance.updateVersion,
afid: h.default.getAFID(),
advertising_id: h.default.getGoogleAdID(),
app_instance_id: h.default.getLogInstanceID(),
ad: h.default.getAdType()
};
g.default.Instance.sendLoginGuest(b);
}
if (o.c != r.GameEnum.ErrorCode.USER_CURRENCY_ERROR) if (o.c != r.GameEnum.ErrorCode.USER_CURRENCY_ERROR_FROZEN) {
if (o.c == r.GameEnum.ErrorCode.USER_BIND_OTHER_PLATFORM) {
b = {
title: s.default.getString("BIND_FAILURE_TITLE"),
content: s.default.getString("BIND_FAILURE_CONTENT"),
rightTitle: s.default.getString("TABLE_BTN_YES")
};
m.PopHelper.Instance.showAlert(b);
}
o.c != r.GameEnum.ErrorCode.ROOM_AUTO_BETTING ? o.c != r.GameEnum.ErrorCode.ACT_NOT_EXIST ? o.c != r.GameEnum.ErrorCode.LOTO_BET_ERROR ? o.c != r.GameEnum.ErrorCode.LOTO_GAME_STOP ? h.default.log("Error: " + o.c) : d.default.Instance.Global.emit("ErrorCode172") : d.default.Instance.Global.emit("ErrorCode173") : d.default.Instance.Global.emit("ErrorCode160") : m.PopHelper.Instance.showTips("Auto Bet");
} else {
var v = 0;
null != o.d && (v = u.Tools.TNumber.num2single(parseFloat(o.d)));
y.default.Instance.openRechargeAlert(this.CompositeBetNum, v);
} else d.default.Instance.Global.emit("ErrorCode" + o.c);
} else m.PopHelper.Instance.showTips(s.default.getString("WALLET_MOBILE_EXIST")); else m.PopHelper.Instance.showTips(s.default.getString("WALLET_MOBILE_BOUND")); else m.PopHelper.Instance.showTips(s.default.getString("ERROR_CODE_TIP_507")); else {
var C = c.default.Instance.serverConfig.client_tips_config.frozen_tips, b = {
content: C && "" != C ? C : s.default.getString("ERROR_CODE_TIP_32"),
rightTitle: s.default.getString("TABLE_BTN_YES"),
rightCallFunc: function() {
cc.game.end();
},
cancelCallFunc: function() {
cc.game.end();
}
};
m.PopHelper.Instance.showAlert(b);
} else m.PopHelper.Instance.showTips(s.default.getString("KYC_OPT_FAILED")); else {
b = {
title: s.default.getString("PROMPT_NOTICE"),
content: s.default.getString("COMMON_TIPS_RELOGIN"),
rightTitle: s.default.getString("TABLE_BTN_YES"),
rightCallFunc: function() {
t._restart();
},
cancelCallFunc: function() {
t._restart();
}
};
m.PopHelper.Instance.showAlert(b);
}
};
e._instance = null;
return e;
}();
o.default = v;
cc._RF.pop();
}, {
"../../Composite/RedAndBlackFast/Script/RBFastEvent": "RBFastEvent",
"../../Config": "Config",
"../../Game/client/global/enum/game/Const": "Const",
"../../Game/client/global/enum/game/Event": "Event",
"../../Game/client/global/enum/game/Game": "Game",
"../../Game/client/global/enum/net/S2C": "S2C",
"../../Game/client/model/LanguageModel": "LanguageModel",
"../../Game/client/model/UpdateModel": "UpdateModel",
"../../Game/fromework/global/Tools": "Tools",
"../../Game/fromework/helper/EventHelper": "EventHelper",
"../../Game/fromework/mvvm/modelView/ViewModel": "ViewModel",
"../../platform/Platform": "Platform",
"../global/Global": "Global",
"../global/PopHelper": "PopHelper",
"../logic/Wallet/WalletHelper": "WalletHelper",
"./UserModel": "UserModel"
} ],
EventHelper: [ function(e, t, o) {
"use strict";
cc._RF.push(t, "1ae14LaBNJI3oq2QqEH3SkX", "EventHelper");
Object.defineProperty(o, "__esModule", {
value: !0
});
var n = e("../../../client/global/Global"), a = e("../../../client/global/PopHelper"), i = e("../../Script/global/GlobalValue"), r = e("../global/Tools"), l = e("../global/event/EventWorker"), s = function() {
function e() {
var e = this;
this._net = null;
this._global = null;
this._workers = null;
this._curMaxId = 0;
this.accX = [];
this.accY = [];
this.accZ = [];
this.nativTimeArryScheduleCall = function() {
var t = cc.sys.getBatteryLevel();
n.Global.Instance.nativTimeArry.push(t);
n.Global.Instance.nativTimeArry.length > 60 && n.Global.Instance.nativTimeArry.splice(0, 1);
cc.sys.localStorage.setItem("MotionAccX", JSON.stringify(e.accX));
cc.sys.localStorage.setItem("MotionAccY", JSON.stringify(e.accY));
cc.sys.localStorage.setItem("MotionAccZ", JSON.stringify(e.accZ));
cc.sys.localStorage.setItem("nativTimeArry", JSON.stringify(n.Global.Instance.nativTimeArry));
if (n.Global.Instance.nativTimeArry.length >= 15) {
var o = r.Tools.TFloat.calculateVariance(n.Global.Instance.nativTimeArry), l = r.Tools.TFloat.calculateVariance(e.accX), s = r.Tools.TFloat.calculateVariance(e.accY), c = r.Tools.TFloat.calculateVariance(e.accZ), u = i.default.getInstance().isWhaleUser;
0 == o && l <= 1e-5 && s <= 1e-5 && c <= 1e-5 && cc.sys.isNative && cc.sys.os != cc.sys.OS_IOS && !u ? a.PopHelper.Instance.showAlert({
title: "Tips",
content: "The current device does not support it",
isBanCancel: !0
}) : cc.sys.localStorage.setItem("isPhone", "true");
}
};
this._init();
}
e.prototype._init = function() {
this._net = l.default.create("NetEvent");
this._global = l.default.create("GlobalEvent");
this._workers = new Map();
};
e.prototype.nativTimeArryScheduleOpen = function() {
var e = this;
this._global.root.addComponent(cc.Label).unschedule(this.nativTimeArryScheduleCall);
this.accX = cc.sys.localStorage.getItem("MotionAccX") ? JSON.parse(cc.sys.localStorage.getItem("MotionAccX")) : [];
this.accY = cc.sys.localStorage.getItem("MotionAccY") ? JSON.parse(cc.sys.localStorage.getItem("MotionAccY")) : [];
this.accZ = cc.sys.localStorage.getItem("MotionAccZ") ? JSON.parse(cc.sys.localStorage.getItem("MotionAccZ")) : [];
var t = cc.sys.localStorage.getItem("isPhone") ? cc.sys.localStorage.getItem("isPhone") : "false";
n.Global.Instance.nativTimeArry = cc.sys.localStorage.getItem("nativTimeArry") ? JSON.parse(cc.sys.localStorage.getItem("nativTimeArry")) : [];
if (n.Global.Instance.nativTimeArry.length >= 15) {
var o = r.Tools.TFloat.calculateVariance(n.Global.Instance.nativTimeArry), l = r.Tools.TFloat.calculateVariance(this.accX), s = r.Tools.TFloat.calculateVariance(this.accY), c = r.Tools.TFloat.calculateVariance(this.accZ), u = i.default.getInstance().isWhaleUser;
0 == o && l <= 1e-5 && s <= 1e-5 && c <= 1e-5 && cc.sys.isNative && cc.sys.os != cc.sys.OS_IOS && !u ? a.PopHelper.Instance.showAlert({
title: "Tips",
content: "The current device does not support it",
isBanCancel: !0
}) : cc.sys.localStorage.setItem("isPhone", "true");
}
if ("false" == t) {
this._global.root.addComponent(cc.Label).schedule(function() {
e.nativTimeArryScheduleCall();
}, 60);
cc.systemEvent.setAccelerometerEnabled(!0);
cc.systemEvent.on(cc.SystemEvent.EventType.DEVICEMOTION, function(t) {
e.accX.push(t.acc.x);
e.accY.push(t.acc.y);
e.accZ.push(t.acc.z);
e.accX.length > 900 && e.accX.splice(0, 1);
e.accY.length > 900 && e.accY.splice(0, 1);
e.accZ.length > 900 && e.accZ.splice(0, 1);
}, this);
}
};
e.prototype._creatorWorker = function() {
var e = l.default.create();
e.start();
this._workers.set(++this._curMaxId, e);
return this._curMaxId;
};
Object.defineProperty(e, "Instance", {
get: function() {
e._Instance || (e._Instance = new e());
return e._Instance;
},
enumerable: !1,
configurable: !0
});
Object.defineProperty(e.prototype, "Net", {
get: function() {
return this._net;
},
enumerable: !1,
configurable: !0
});
Object.defineProperty(e.prototype, "Global", {
get: function() {
return this._global;
},
enumerable: !1,
configurable: !0
});
e.prototype.start = function() {
this._net.start(!0);
this._global.start(!0);
};
e.prototype.getWorker = function() {
return this._creatorWorker();
};
e.prototype.removeWorker = function(e) {
var t = this._workers.get(e);
if (t) {
t.stop(!0);
this._workers.delete(e);
}
};
e.prototype.stop = function() {
this._net.stop(!0);
this._net = null;
n.Global.Instance.nativTimeArry = [];
this._global.root.addComponent(cc.Label).unschedule(this.nativTimeArryScheduleCall);
cc.systemEvent.off(cc.SystemEvent.EventType.DEVICEMOTION);
this._global.stop(!0);
this._global = null;
this._workers.forEach(function(e) {
e.stop(!0);
});
this._workers.clear();
e._Instance = null;
};
e._Instance = null;
return e;
}();
o.default = s;
cc._RF.pop();
}, {
"../../../client/global/Global": "Global",
"../../../client/global/PopHelper": "PopHelper",
"../../Script/global/GlobalValue": "GlobalValue",
"../global/Tools": "Tools",
"../global/event/EventWorker": "EventWorker"
} ],
EventWorker: [ function(e, t, o) {
"use strict";
cc._RF.push(t, "ce778BMTlFGL7G34NFDOlka", "EventWorker");
Object.defineProperty(o, "__esModule", {
value: !0
});
var n = function() {
function e(e) {
this._root = null;
this._persist = !1;
this._root = new cc.Node(e);
}
e.create = function(t) {
return new e(t);
};
Object.defineProperty(e.prototype, "root", {
get: function() {
return this._root;
},
enumerable: !1,
configurable: !0
});
e.prototype.bind = function(e, t, o, n) {
void 0 === o && (o = null);
void 0 === n && (n = !1);
return this._root.on(e, t, o, n);
};
e.prototype.emit = function(e, t) {
var o = new cc.Event.EventCustom(e, !0);
t && o.setUserData(t);
this._root && this._root.dispatchEvent(o);
};
e.prototype.unbind = function(e, t, o) {
void 0 === o && (o = null);
this._root && this._root.off(e, t, o);
};
e.prototype.unbindByTarget = function(e) {
this._root && this._root.targetOff(e);
};
e.prototype.start = function(e) {
void 0 === e && (e = !1);
cc.director.getScene().addChild(this._root);
(this._persist = e) && cc.game.addPersistRootNode(this._root);
};
e.prototype.stop = function(e) {
void 0 === e && (e = !1);
this._root.targetOff(this._root);
this._persist && cc.game.removePersistRootNode(this._root);
this._root.removeFromParent();
if (e) {
this._root.destroy();
this._root = null;
}
};
return e;
}();
o.default = n;
cc._RF.pop();
}, {} ],
Event: [ function(e, t, o) {
"use strict";
cc._RF.push(t, "12789e5Z2VO3YBKRS7otfnr", "Event");
Object.defineProperty(o, "__esModule", {
value: !0
});
o.ItemEvent = o.MarqueeEvent = o.LogEvent = o.SDKEvent = o.ErrorCodeEvent = o.InviteEvent = o.GameUIEvent = o.ShopEvent = o.PlatformEvent = o.TipsEvent = o.ServerEvent = o.IOSEvent = o.JavaEvent = o.PhoneEvent = o.LotteryEvent = o.ReferEvent = o.SignEvent = o.TeenPattiEvent = o.WalletEvent = o.RedDotEvent = o.VIPEvent = o.MonthCardEent = o.MailEvent = o.LobbyEvent = o.UserEvent = o.GameEvent = void 0;
o.GameEvent = {
S2C_ENTER_ROOM: "S2C_ENTER_ROOM",
S2C_SWITCH_ROOM: "S2C_SWITCH_ROOM",
S2C_ORDER_SHOW: "S2C_ORDER_SHOW",
S2C_ORDER_CONFIRM: "S2C_ORDER_CONFIRM",
S2C_CARD_SHOW: "S2C_CARD_SHOW",
S2C_CARD_CONFIRM: "S2C_CARD_CONFIRM",
S2C_START_ROOM: "S2C_START_ROOM",
S2C_DRAW: "S2C_DRAW",
S2C_DISCARD: "S2C_DISCARD",
S2C_FINISH: "S2C_FINISH",
S2C_DECLEAR_SUCCESS: "S2C_DECLEAR_SUCCESS",
S2C_SYNC_CARD: "S2C_SYNC_CARD",
S2C_DECLEAR_FAIL: "S2C_DECLEAR_FAIL",
S2C_RESET: "S2C_RESET",
S2C_LEAVE: "S2C_LEAVE",
S2C_LEAVE_SINGLE: "S2C_LEAVE_SINGLE",
S2C_DROP: "S2C_DROP",
S2C_DISMISS_ROOM: "S2C_DISMISS_ROOM",
S2C_AUTOSORT_SWITCH: "S2C_AUTOSORT_SWITCH",
S2C_AUTOSORT: "S2C_AUTOSORT",
S2C_KICK: "S2C_KICK",
S2C_AUTOPLAY: "S2C_AUTOPLAY",
S2C_SCORE_WINDOW: "S2C_SCORE_WINDOW",
S2C_INITIATE_SPLIT: "S2C_INITIATE_SPLIT",
S2C_SPLIT: "S2C_SPLIT",
S2C_SPLIT_RESULT: "S2C_SPLIT_RESULT",
S2C_REJOIN: "S2C_REJOIN",
S2C_READY: "S2C_READY",
S2C_INTERACT: "S2C_INTERACT",
S2C_SEE_CARD: "S2C_SEE_CARD",
S2C_WAGER: "S2C_WAGER",
S2C_INITIATE_COMPARE: "S2C_INITIATE_COMPARE",
S2C_CONFIRM_COMPARE: "S2C_CONFIRM_COMPARE",
S2C_GET_RECHARGE_AMOUNT: "S2C_GET_RECHARGE_AMOUNT",
S2C_INITIATE_RECHARGE: "S2C_INITIATE_RECHARGE",
S2C_FINISH_RECHARGE: "S2C_FINISH_RECHARGE",
S2C_AB_DEAL: "S2C_AB_DEAL",
S2C_AB_BET: "S2C_AB_BET",
S2C_AB_BET_BATCH: "S2C_AB_BET_BATCH",
S2C_AB_SHOW: "S2C_AB_SHOW",
S2C_AB_RANK: "S2C_AB_RANK",
S2C_DT_DEALER_LIST: "S2C_DT_DEALER_LIST",
S2C_SEND_AVAILABLE_BALANCE: "S2C_SEND_AVAILABLE_BALANCE",
TABLE_LEAVE_ROOM: "TABLE_LEAVE_ROOM",
TABLE_SWITCH_TABLE: "TABLE_SWITCH_TABLE",
TABLE_TOGGLE_REFRESH: "TABLE_TOGGLE_REFRESH",
TABLE_REFRESH_TABLE: "TABLE_REFRESH_TABLE",
TABLE_HEAD_SORT: "TABLE_HEAD_SORT",
CARD_REFRESH_COLOR: "CARD_REFRESH_COLOR",
GAME_GROUP_ADD_HERE: "GAME_GROUP_ADD_HERE",
GAME_GROUP_LEFT: "GAME_GROUP_LEFT",
GAME_GROUP_RIGHT: "GAME_GROUP_RIGHT",
SCORE_WINDOW_REFRESH_TIME: "SCORE_WINDOW_REFRESH_TIME",
SCORE_WINDOW_REFRESH_READY: "SCORE_WINDOW_REFRESH_READY",
SELF_HEAD_COUNTDOWN: "SELF_HEAD_COUNTDOWN",
SCORE_WINDOW_CLOSE: "SCORE_WINDOW_CLOSE",
HEAR_BEAT_DELAY: "HEAR_BEAT_DELAY"
};
o.UserEvent = {
USER_REGISTER_SUCCESS: "USER_REGISTER_SUCCESS",
USER_LOGIN_SUCCESS: "USER_LOGIN_SUCCESS",
USER_LOGIN_PHONE_OTP: "USER_LOGIN_PHONE_OTP",
USER_BIND_INVITE: "USER_BIND_INVITE",
USER_GET_SHARE_URL: "USER_GET_SHARE_URL",
USER_UPDATE_REWARD: "USER_UPDATE_REWARD",
USER_UPDATE_VIP_INFO: "USER_UPDATE_VIP_INFO"
};
o.LobbyEvent = {
LOBBY_JOIN: "LOBBY_JOIN",
LOBBY_GET_ROOMS: "LOBBY_GET_ROOMS",
LOBBY_GET_GAMES: "LOBBY_GET_GAMES",
LOBBY_ADVERT_GET: "LOBBY_ADVERT_GET",
LOBBY_ADVERT_REWARD: "LOBBY_ADVERT_REWARD",
LOBBY_SHOW_CHOOSEVIEW: "LOBBY_SHOW_CHOOSEVIEW",
LOBBY_CHOOSE_RUMMY: "LOBBY_CHOOSE_RUMMY",
LOBBY_CHOOSE_3PATTI: "LOBBY_CHOOSE_3PATTI",
LOBBY_REFRESH_CHAT: "LOBBY_REFRESH_CHAT",
LOBBY_REFRESH_NOTICE_BUTTON: "LOBBY_REFRESH_NOTICE_BUTTON"
};
o.MailEvent = {
MAIL_GET_LIST: "MAIL_GET_LIST",
MAIL_DETAIL_CLOSE: "MAIL_DETAIL_CLOSE"
};
o.MonthCardEent = {
MONTHCARD_GET_LIST: "MONTHCARD_GET_LIST",
MONTHCARD_CLOSE_VIEW: "MONTHCARD_CLOSE_VIEW"
};
o.VIPEvent = {
VIP_GET_CONGIF: "VIP_GET_CONGIF",
VIP_GET_GIFT_LIST: "VIP_GET_GIFT_LIST",
VIP_GET_WITHDRAW_RULE: "VIP_GET_WITHDRAW_RULE",
VIP_UI_CLOSE_SHOP: "VIP_UI_CLOSE_SHOP",
VIP_SHOP_BUY_FAILED: "VIP_SHOP_BUY_FAILED"
};
o.RedDotEvent = {
REFRESH_RED_DOT_DATA: "REFRESH_RED_DOT_DATA",
REFRESH_RED_DOT: "REFRESH_RED_DOT"
};
o.WalletEvent = {
ACTIVITY_SELECT: "ACTIVITY_SELECT",
STATE_DROP_SELECT: "STATE_DROP_SELECT",
RECENT_ITEM_CLICKED: "RECENT_ITEM_CLICKED",
KYC_SELECT_TOGGLE: "KYC_SELECT_TOGGLE",
RECHARGE_CLOSE_WEBVIEW: "RECHARGE_CLOSE_WEBVIEW",
RECHARGE_GET_GOODS: "RECHARGE_GET_GOODS",
RECHARGE_GET_USERINFO: "RECHARGE_GET_USERINFO",
RECENT_LOG_REFRESH: "RECENT_LOG_REFRESH",
RECENT_KYC_QUERY: "RECENT_KYC_QUERY",
RECENT_CHECK_PHONE_MAIL: "RECENT_CHECK_PHONE_MAIL",
KYC_MOBILE_BIND_CODE: "KYC_MOBILE_BIND_CODE",
KYC_MOBILE_CHANGE_CODE: "KYC_MOBILE_CHANGE_CODE",
KYC_MOBILE_BIND_PHONE: "KYC_MOBILE_BIND_PHONE",
KYC_MOBILE_BIND_EMAIL: "KYC_MOBILE_BIND_EMAIL",
KYC_APPLY_BACK: "KYC_APPLY_BACK",
RECHARGE_GET_CALCULATOR: "RECHARGE_GET_CALCULATOR",
RECHARGE_ACT_REFRESH: "RECHARGE_ACT_REFRESH",
WITHDRAW_CHECK_BANK: "WITHDRAW_CHECK_BANK",
WITHDRAW_SET_BANK: "WITHDRAW_SET_BANK",
WITHDRAW_APPLY: "WITHDRAW_APPLY",
WITHDRAW_CANCEL: "WITHDRAW_CANCEL",
WALLET_USER_GET_WALLET: "WALLET_USER_GET_WALLET",
WALLET_PAYMENT_TYPE: "WALLET_PAYMENT_TYPE",
WALLET_PAYMENT: "WALLET_PAYMENT",
REFRESH_NOTICE_REFRESH: "REFRESH_NOTICE_REFRESH",
REFRESH_BONUS_RECORD: "REFRESH_BONUS_RECORD",
BONUS_GET_UNREWARD: "BONUS_GET_UNREWARD",
BONUS_REWARD_UNREWARD: "BONUS_REWARD_UNREWARD",
ADDCASH_ITEM_CLICKED: "ADDCASH_ITEM_CLICKED",
ADDCASH_ITEM_ONLY_CLICKED: "ADDCASH_ITEM_ONLY_CLICKED",
RECHARGE_BROWSER_END: "RECHARGE_BROWSER_END"
};
o.TeenPattiEvent = {
TP_CLOSE_COMPATE: "TP_CLOSE_COMPATE"
};
o.SignEvent = {
SIGN_GET_USER_SIGNED: "SIGN_GET_USER_SIGNED",
SIGN_USER_SIGNED: "SIGN_USER_SIGNED"
};
o.ReferEvent = {
REFER_UI_REFRESH_BOX: "REFER_UI_REFRESH_BOX",
REFER_UI_REFRESH_LIST: "REFER_UI_REFRESH_LIST",
REFER_UI_GET_REWARD: "REFER_UI_GET_REWARD",
REFER_UI_GET_LEVEL: "REFER_UI_GET_LEVEL"
};
o.LotteryEvent = {
LOTTERY_GET_INFO: "LOTTERY_GET_INFO",
LOTTERY_DO_LOTTERY: "LOTTERY_DO_LOTTERY"
};
o.PhoneEvent = {
PHONE_CHECK_CODE: "PHONE_CHECK_CODE"
};
o.JavaEvent = {
JAVA_GOOGLEPLAY_SIGNIN_RESULT: "JAVA_GOOGLEPLAY_SIGNIN_RESULT"
};
o.IOSEvent = {
IOS_GAMECENTER_SIGNIN_RESULT: "IOS_GAMECENTER_SIGNIN_RESULT",
IOS_IAP_SUCCESS: "IOS_IAP_SUCCESS",
IOS_IAP_FAILED: "IOS_IAP_FAILED"
};
o.ServerEvent = {
SERVER_GAME_SERVICE: "SERVER_GAME_SERVICE",
SERVER_CONFIG: "SERVER_CONFIG",
HOT_UPDATE_NOTICE: "HOT_UPDATE_NOTICE"
};
o.TipsEvent = {
TIPS_READY_BUTTON_CLICKED: "TIPS_READY_BUTTON_CLICKED",
TIPS_SYSTEM_WITHDRAW_ALERT: "TIPS_SYSTEM_WITHDRAW_ALERT"
};
o.PlatformEvent = {
PLATFORM_GET_LOCATION: "PLATFORM_GET_LOCATION",
PLATFORM_PICK_ALBUM_CANCELED: "PLATFORM_PICK_ALBUM_CANCELED",
PLATFORM_TAKE_PHOTO_CANCELED: "PLATFORM_TAKE_PHOTO_CANCELED",
PLATFORM_PICK_ALBUM_COMPLETED: "PLATFORM_PICK_ALBUM_COMPLETED",
PLATFORM_TAKE_PHOTO_COMPLETED: "PLATFORM_TAKE_PHOTO_COMPLETED",
PLATFORM_COMPRESS_IMAGE_FAILED: "PLATFORM_COMPRESS_IMAGE_FAILED",
PLATFORM_COMPRESS_IMAGE_COMPLETED: "PLATFORM_COMPRESS_IMAGE_COMPLETED",
PLATFORM_APPSFLYER_CONVERSIONDATA_SUCCESS: "PLATFORM_APPSFLYER_CONVERSIONDATA_SUCCESS",
PLATFORM_APPSFLYER_CONVERSIONDATA_FAIL: "PLATFORM_APPSFLYER_CONVERSIONDATA_FAIL",
PLATFORM_APPSFLYER_APPOPEN_ATTRIBUTION: "PLATFORM_APPSFLYER_APPOPEN_ATTRIBUTION",
PLATFORM_APPSFLYER_ATTRIBUTION_FAILURE: "PLATFORM_APPSFLYER_ATTRIBUTION_FAILURE",
PLATFORM_FACEBOOK_LOGIN_SUCCESS: "PLATFORM_FACEBOOK_LOGIN_SUCCESS",
PLATFORM_FACEBOOK_LOGIN_CANCEL: "PLATFORM_FACEBOOK_LOGIN_CANCEL",
PLATFORM_FACEBOOK_LOGIN_ERROR: "PLATFORM_FACEBOOK_LOGIN_ERROR",
PLATFORM_FACEBOOK_USERINFO: "PLATFORM_FACEBOOK_USERINFO",
PLATFORM_FACEBOOK_USERINFO_ERROR: "PLATFORM_FACEBOOK_USERINFO_ERROR",
PLATFORM_FACEBOOK_SHARE_SUCCESS: "PLATFORM_FACEBOOK_SHARE_SUCCESS",
PLATFORM_FACEBOOK_SHARE_CANCEL: "PLATFORM_FACEBOOK_SHARE_CANCEL",
PLATFORM_FACEBOOK_SHARE_ERROR: "PLATFORM_FACEBOOK_SHARE_ERROR",
PLATFORM_PAYMENT_BACK: "PLATFORM_PAYMENT_BACK",
PLATFORM_PAYMENT_ERROR: "PLATFORM_PAYMENT_ERROR",
PLATFORM_CHECK_RESULT: "PLATFORM_CHECK_RESULT",
PLATFORM_ADMOB: "PLATFORM_ADMOB",
PLATFORM_REWARDEDAD: "PLATFORM_REWARDEDAD",
PLATFORM_INSTALL_REFERRER: "PLATFORM_INSTALL_REFERRER",
PLATFORM_FIREBASE_CREATELINK: "PLATFORM_FIREBASE_CREATELINK",
PLATFORM_FIREBASE_GETLINK: "PLATFORM_FIREBASE_GETLINK"
};
o.ShopEvent = {
SHOP_PRODUCT_LIST: "SHOP_PRODUCT_LIST",
SHOP_RECEIPT_CALLBACK: "SHOP_RECEIPT_CALLBACK"
};
o.GameUIEvent = {
CREATE_TABLE_SLIDER_UPDATE: "CREATE_TABLE_SLIDER_UPDATE",
NOTICE_IMAGE_CLOSE: "NOTICE_IMAGE_CLOSE",
LOTTERY_TANK_CLICK: "LOTTERY_TANK_CLICK",
BINDALERT_REFRESH_VIEW: "BINDALERT_REFRESH_VIEW",
LOBBY_CASH_JOIN: "LOBBY_CASH_JOIN",
LOBBY_PRACTICE_JOIN: "LOBBY_PRACTICE_JOIN",
SHOW_NUMBER_EDITBOX: "SHOW_NUMBER_EDITBOX",
HIDE_NUMBER_EDITBOX: "HIDE_NUMBER_EDITBOX",
REFRESH_CASH: "REFRESH_CASH"
};
o.InviteEvent = {
CREATE_LINK: "CREATE_LINK",
GET_LINK: "GET_LINK"
};
o.ErrorCodeEvent = {
ERROR_EVENT_106: "ERROR_EVENT_106"
};
o.SDKEvent = {
SDKEVENT_LOGIN: "SDKEVENT_LOGIN",
SDKEVENT_KYC_COMMIT: "SDKEVENT_KYC",
SDKEVENT_RECHARGE_COUNT: "SDKEVENT_PAY",
SDKEVENT_FIRST_LOGIN: "SDKEVENT_FIRST_LOGIN",
SDKEVENT_FIRST_GAMEING: "SDKEVENT_FIRST_GAMEING"
};
o.LogEvent = {
LOGEVENT_CLIENT: "LOGEVENT_CLIENT",
LOGEVENT_OTHER: "LOGEVENT_OTHER"
};
o.MarqueeEvent = {
PUSH_MESSAGE: "PUSH_MESSAGE",
PUSH_NOTICE: "PUSH_NOTICE"
};
o.ItemEvent = {
ITEM_REFRESH: "ITEM_REFRESH",
ITEM_ADD: "ITEM_ADD",
ITEM_REDUCE: "ITEM_REDUCE"
};
cc._RF.pop();
}, {} ],
ExchangeLayer: [ function(e, t, o) {
"use strict";
cc._RF.push(t, "6ea41F1gWpAOZ8AOWM1+ePg", "ExchangeLayer");
var n, a = this && this.__extends || (n = function(e, t) {
return (n = Object.setPrototypeOf || {
__proto__: []
} instanceof Array && function(e, t) {
e.__proto__ = t;
} || function(e, t) {
for (var o in t) Object.prototype.hasOwnProperty.call(t, o) && (e[o] = t[o]);
})(e, t);
}, function(e, t) {
n(e, t);
function o() {
this.constructor = e;
}
e.prototype = null === t ? Object.create(t) : (o.prototype = t.prototype, new o());
}), i = this && this.__decorate || function(e, t, o, n) {
var a, i = arguments.length, r = i < 3 ? t : null === n ? n = Object.getOwnPropertyDescriptor(t, o) : n;
if ("object" == typeof Reflect && "function" == typeof Reflect.decorate) r = Reflect.decorate(e, t, o, n); else for (var l = e.length - 1; l >= 0; l--) (a = e[l]) && (r = (i < 3 ? a(r) : i > 3 ? a(t, o, r) : a(t, o)) || r);
return i > 3 && r && Object.defineProperty(t, o, r), r;
};
Object.defineProperty(o, "__esModule", {
value: !0
});
var r = e("../../../../Game/client/global/enum/game/Const"), l = e("../../../../Game/fromework/global/Tools"), s = e("../../../../Game/fromework/helper/UIHelper"), c = e("../../../global/Global"), u = e("../../../global/PopHelper"), d = e("../../active/ActiveModel"), p = cc._decorator, h = p.ccclass, f = p.property, _ = function(e) {
a(t, e);
function t() {
var t = null !== e && e.apply(this, arguments) || this;
t.mainNode = null;
t.activiNode = null;
t.helpNode = null;
t.activeLayout = null;
t.activeItem = null;
t.timeLabel = null;
t.itemSpr = [];
t.exchangeData = null;
t.downTime = 0;
t.downTimeCall = null;
return t;
}
t.prototype.start = function() {
this.requstData();
};
t.prototype.requstData = function() {
var e = this;
d.ActiveProxy.Instance.getExchangeData(1, 0, function(t) {
if (e.node && e.node.isValid) {
e.exchangeData = t;
e.showActive();
}
});
};
t.prototype.showActive = function() {
var e = this;
if (this.node && this.node.isValid) if (this.exchangeData) if (0 == this.exchangeData.activeInfo.active) {
this.mainNode.active = !0;
this.activiNode.active = !1;
this.mainNode.getChildByName("witrawNum").getComponent(cc.Label).string = r.MoneySymbol + Number(this.exchangeData.widthdrawAmount);
this.mainNode.getChildByName("depositNum").getComponent(cc.Label).string = r.MoneySymbol + Number(this.exchangeData.widthdrawAmount) + " + " + r.MoneySymbol + Number(this.exchangeData.widthdrawAmount) * Number(this.exchangeData.rate);
Number(this.exchangeData.widthdrawAmount) <= 0 ? this.mainNode.getChildByName("exchangeButton").getComponent(cc.Button).interactable = !1 : this.mainNode.getChildByName("exchangeButton").getComponent(cc.Button).interactable = !0;
this.mainNode.getChildByName("rateLabel").getComponent(cc.Label).string = 100 * Number(this.exchangeData.rate) + "%";
this.mainNode.getChildByName("tipsLabel").getChildByName("num").getComponent(cc.Label).string = this.exchangeData.needMinAmount;
} else {
this.mainNode.active = !1;
this.activiNode.active = !0;
this.activiNode.getChildByName("witrawNum").getComponent(cc.Label).string = r.MoneySymbol + Number(this.exchangeData.widthdrawAmount);
this.activiNode.getChildByName("depositNum").getComponent(cc.Label).string = r.MoneySymbol + Number(this.exchangeData.widthdrawAmount) + " + " + r.MoneySymbol + Number(this.exchangeData.widthdrawAmount) * Number(this.exchangeData.rate);
this.showActiveList();
this.activiNode.getChildByName("rateLabel").getComponent(cc.Label).string = 100 * Number(this.exchangeData.rate) + "%";
this.activiNode.getChildByName("tipsLabel").getChildByName("num").getComponent(cc.Label).string = this.exchangeData.needMinAmount;
this.activiNode.getChildByName("tipsNum").getComponent(cc.Label).string = r.MoneySymbol + Number(this.exchangeData.activeInfo.allamount);
Number(this.exchangeData.widthdrawAmount) <= 0 ? this.activiNode.getChildByName("exchangeButton").getComponent(cc.Button).interactable = !1 : this.activiNode.getChildByName("exchangeButton").getComponent(cc.Button).interactable = !0;
this.downTime = this.exchangeData.activeInfo.createtime + this.exchangeData.activeInfo.cooltime - (Number(new Date().getTime()) / 1e3 - Number(c.Global.Instance.TimeDifference));
var t = l.Tools.TDate.second2Hour(this.downTime), o = String(t.hour), n = String(t.minu), a = String(t.sec);
t.hour < 10 && (o = "0" + t.hour);
t.minu < 10 && (n = "0" + t.minu);
t.sec < 10 && (a = "0" + t.sec);
this.timeLabel.string = o + ":" + n + ":" + a;
this.downTimeCall && this.unschedule(this.downTimeCall);
this.downTimeCall = function() {
e.downTime = e.downTime - 1;
var t = l.Tools.TDate.second2Hour(e.downTime), o = String(t.hour), n = String(t.minu), a = String(t.sec);
t.hour < 10 && (o = "0" + t.hour);
t.minu < 10 && (n = "0" + t.minu);
t.sec < 10 && (a = "0" + t.sec);
e.timeLabel.string = o + ":" + n + ":" + a;
if (e.downTime <= 0) {
e.requstData();
e.unschedule(e.downTimeCall);
}
};
this.downTime > 0 && this.schedule(this.downTimeCall, 1);
} else this.requstData();
};
t.prototype.showActiveList = function() {
if (this.exchangeData.activeInfo.activeConfig && this.exchangeData.activeInfo.activeConfig.length > 0) {
this.activeLayout.destroyAllChildren();
for (var e = 0; e < this.exchangeData.activeInfo.activeConfig.length; e++) {
var t = this.exchangeData.activeInfo.activeConfig[e], o = cc.instantiate(this.activeItem);
o.info = t;
o.active = !0;
o.parent = this.activeLayout;
o.getChildByName("numNeed").getComponent(cc.Label).string = r.MoneySymbol + Number(t.target);
o.getChildByName("reawd").getChildByName("num").getComponent(cc.Label).string = "" + Number(t.cash);
if (t.revieved) {
if (1 == t.revieved) {
o.getChildByName("icon").getComponent(cc.Sprite).spriteFrame = this.itemSpr[1];
o.getChildByName("finsh").active = !1;
o.getComponent(cc.Button).interactable = !0;
} else if (2 == t.revieved) {
o.getChildByName("icon").getComponent(cc.Sprite).spriteFrame = this.itemSpr[0];
o.getChildByName("finsh").active = !0;
o.getComponent(cc.Button).interactable = !1;
}
} else {
o.getChildByName("icon").getComponent(cc.Sprite).spriteFrame = this.itemSpr[0];
o.getChildByName("finsh").active = !1;
o.getComponent(cc.Button).interactable = !1;
}
}
}
};
t.prototype.closeClick = function() {
this.unschedule(this.downTimeCall);
s.default.Instance.removeMaskLayer(this.node, !0);
};
t.prototype.closeHelpClick = function() {
this.helpNode.active = !1;
};
t.prototype.helpClick = function() {
this.helpNode.active = !0;
};
t.prototype.exchangeClick = function() {
var e = this;
d.ActiveProxy.Instance.withdrawExchange(1, 0, function(t) {
u.PopHelper.Instance.showReward(c.Global.Instance.changeReward({
1: t.deposit
}), function() {
e.requstData();
});
});
};
t.prototype.reawdClick = function(e) {
var t = this, o = e.target;
d.ActiveProxy.Instance.receiveExchageActive(o.info.level, function() {
u.PopHelper.Instance.showReward(c.Global.Instance.changeReward({
1: o.info.cash
}), function() {
t.requstData();
});
});
};
i([ f(cc.Node) ], t.prototype, "mainNode", void 0);
i([ f(cc.Node) ], t.prototype, "activiNode", void 0);
i([ f(cc.Node) ], t.prototype, "helpNode", void 0);
i([ f(cc.Node) ], t.prototype, "activeLayout", void 0);
i([ f(cc.Node) ], t.prototype, "activeItem", void 0);
i([ f(cc.Label) ], t.prototype, "timeLabel", void 0);
i([ f(cc.SpriteFrame) ], t.prototype, "itemSpr", void 0);
return i([ h ], t);
}(cc.Component);
o.default = _;
cc._RF.pop();
}, {
"../../../../Game/client/global/enum/game/Const": "Const",
"../../../../Game/fromework/global/Tools": "Tools",
"../../../../Game/fromework/helper/UIHelper": "UIHelper",
"../../../global/Global": "Global",
"../../../global/PopHelper": "PopHelper",
"../../active/ActiveModel": "ActiveModel"
} ],
ExchangeWithdarwLayer: [ function(e, t, o) {
"use strict";
cc._RF.push(t, "bd12deheBlBkJQBm6zNwikm", "ExchangeWithdarwLayer");
var n, a = this && this.__extends || (n = function(e, t) {
return (n = Object.setPrototypeOf || {
__proto__: []
} instanceof Array && function(e, t) {
e.__proto__ = t;
} || function(e, t) {
for (var o in t) Object.prototype.hasOwnProperty.call(t, o) && (e[o] = t[o]);
})(e, t);
}, function(e, t) {
n(e, t);
function o() {
this.constructor = e;
}
e.prototype = null === t ? Object.create(t) : (o.prototype = t.prototype, new o());
}), i = this && this.__decorate || function(e, t, o, n) {
var a, i = arguments.length, r = i < 3 ? t : null === n ? n = Object.getOwnPropertyDescriptor(t, o) : n;
if ("object" == typeof Reflect && "function" == typeof Reflect.decorate) r = Reflect.decorate(e, t, o, n); else for (var l = e.length - 1; l >= 0; l--) (a = e[l]) && (r = (i < 3 ? a(r) : i > 3 ? a(t, o, r) : a(t, o)) || r);
return i > 3 && r && Object.defineProperty(t, o, r), r;
};
Object.defineProperty(o, "__esModule", {
value: !0
});
var r = e("../../../../Game/client/global/enum/game/Const"), l = e("../../../../Game/fromework/helper/UIHelper"), s = e("../../../global/Global"), c = e("../../../global/PopHelper"), u = e("../../active/ActiveModel"), d = cc._decorator, p = d.ccclass, h = d.property, f = function(e) {
a(t, e);
function t() {
var t = null !== e && e.apply(this, arguments) || this;
t.witrawNum = null;
t.exchangeButtonNum = null;
t.withdarwButtonNum = null;
t.tipsWithdarw = null;
t.tipsExchange = null;
t.rate = null;
t.callBack = null;
t.exchangeAmont = 0;
t.exchangSuccCall = null;
return t;
}
t.prototype.start = function() {
this.requstData();
};
t.prototype.requstData = function() {
var e = this;
u.ActiveProxy.Instance.getExchangeData(2, this.exchangeAmont, function(t) {
if (e.node && e.node.isValid) {
e.witrawNum.string = r.MoneySymbol + Number(t.widthdrawAmount);
e.exchangeButtonNum.string = "Get " + r.MoneySymbol + Number(t.depositAmont);
e.withdarwButtonNum.string = "Get " + r.MoneySymbol + Number(t.wAmont);
e.tipsWithdarw.string = "Handing Free: " + r.MoneySymbol + Number(t.fee);
e.tipsExchange.string = 100 * Number(t.rate) + "% cash more";
e.rate.string = 100 * Number(t.rate) + "% cash";
}
});
};
t.prototype.init = function(e, t, o) {
void 0 === t && (t = null);
this.callBack = t;
this.exchangSuccCall = o;
this.exchangeAmont = e;
};
t.prototype.withdarwClick = function() {
this.callBack && this.callBack();
this.closeClick();
};
t.prototype.exchangeClick = function() {
var e = this;
u.ActiveProxy.Instance.withdrawExchange(2, this.exchangeAmont, function(t) {
c.PopHelper.Instance.showReward(s.Global.Instance.changeReward({
1: t.deposit
}), function() {
e.requstData();
e.exchangSuccCall && e.exchangSuccCall();
e.closeClick();
});
});
};
t.prototype.closeClick = function() {
l.default.Instance.removeMaskLayer(this.node, !0);
};
i([ h(cc.Label) ], t.prototype, "witrawNum", void 0);
i([ h(cc.Label) ], t.prototype, "exchangeButtonNum", void 0);
i([ h(cc.Label) ], t.prototype, "withdarwButtonNum", void 0);
i([ h(cc.Label) ], t.prototype, "tipsWithdarw", void 0);
i([ h(cc.Label) ], t.prototype, "tipsExchange", void 0);
i([ h(cc.Label) ], t.prototype, "rate", void 0);
return i([ p ], t);
}(cc.Component);
o.default = f;
cc._RF.pop();
}, {
"../../../../Game/client/global/enum/game/Const": "Const",
"../../../../Game/fromework/helper/UIHelper": "UIHelper",
"../../../global/Global": "Global",
"../../../global/PopHelper": "PopHelper",
"../../active/ActiveModel": "ActiveModel"
} ],
FestivalEvent: [ function(e, t, o) {
"use strict";
cc._RF.push(t, "55683rl7lZBubWG9tbdfmWb", "FestivalEvent");
Object.defineProperty(o, "__esModule", {
value: !0
});
o.FestivalEvent = void 0;
o.FestivalEvent = {
FESTIVAL_GET_ACT_ALL: "FESTIVAL_GET_ACT_ALL",
FESTIVAL_GET_ACT_MAIN: "FESTIVAL_GET_ACT_MAIN",
FESTIVAL_ACT_EXCHANGE: "FESTIVAL_ACT_EXCHANGE",
FESTIVAL_ACT_GET_TASK_REWARD: "FESTIVAL_ACT_GET_TASK_REWARD",
FESTIVAL_ACT_LOTO: "FESTIVAL_ACT_LOTO",
FESTIVAL_UI_CLOSE: "FESTIVAL_UI_CLOSE",
FESTIVAL_UI_RECHARGE: "FESTIVAL_UI_RECHARGE",
HALL_MONTH_CARD_UI_RECHARGE: "HALL_MONTH_CARD_UI_RECHARGE"
};
cc._RF.pop();
}, {} ],
FestivalExchange: [ function(e, t, o) {
"use strict";
cc._RF.push(t, "01bfeNROQRBSZxYg0U+FEil", "FestivalExchange");
var n, a = this && this.__extends || (n = function(e, t) {
return (n = Object.setPrototypeOf || {
__proto__: []
} instanceof Array && function(e, t) {
e.__proto__ = t;
} || function(e, t) {
for (var o in t) Object.prototype.hasOwnProperty.call(t, o) && (e[o] = t[o]);
})(e, t);
}, function(e, t) {
n(e, t);
function o() {
this.constructor = e;
}
e.prototype = null === t ? Object.create(t) : (o.prototype = t.prototype, new o());
}), i = this && this.__decorate || function(e, t, o, n) {
var a, i = arguments.length, r = i < 3 ? t : null === n ? n = Object.getOwnPropertyDescriptor(t, o) : n;
if ("object" == typeof Reflect && "function" == typeof Reflect.decorate) r = Reflect.decorate(e, t, o, n); else for (var l = e.length - 1; l >= 0; l--) (a = e[l]) && (r = (i < 3 ? a(r) : i > 3 ? a(t, o, r) : a(t, o)) || r);
return i > 3 && r && Object.defineProperty(t, o, r), r;
};
Object.defineProperty(o, "__esModule", {
value: !0
});
var r = e("../../../Game/fromework/helper/UIHelper"), l = e("../Common/FestivalModel"), s = e("./FestivalItem"), c = cc._decorator, u = c.ccclass, d = c.property, p = function(e) {
a(t, e);
function t() {
var t = null !== e && e.apply(this, arguments) || this;
t.AlertPanel = null;
t.Item = null;
t.ItemParent = null;
t.Slider = null;
t.Progress = null;
t.SliderCount = null;
t._aid = 0;
t._cur = 0;
t._max = 0;
t._itemID = 0;
t._itemIndex = 0;
t._items = [];
return t;
}
t.prototype.onEnable = function() {
this.Slider.node.on(cc.Node.EventType.TOUCH_END, this.onSliderEnd, this);
this.Slider.node.on(cc.Node.EventType.TOUCH_CANCEL, this.onSliderEnd, this);
};
t.prototype.onDisable = function() {
this.Slider.node.off(cc.Node.EventType.TOUCH_END, this.onSliderEnd, this);
this.Slider.node.off(cc.Node.EventType.TOUCH_CANCEL, this.onSliderEnd, this);
};
t.prototype.openAction = function() {
this.AlertPanel.setPosition(cc.v2(0, this.node.height / 2 + this.AlertPanel.height / 2));
cc.tween(this.AlertPanel).to(.1, {
position: cc.Vec3.ZERO
}).start();
};
t.prototype.closeAction = function(e) {
var t = this;
cc.tween(this.AlertPanel).to(.1, {
position: cc.v3(0, -(this.node.height / 2 + this.AlertPanel.height / 2), 0)
}).call(function() {
e && e.apply(t);
}).start();
};
t.prototype.showView = function(e, t) {
this._aid = e;
var o = l.FestivalProxy.Instance.getActData(this._aid);
this._cur = 0;
this._max = l.FestivalProxy.Instance.getOptionalItemCount(this._aid);
if (null != t) {
this._itemID = t;
for (var n = 0; n < o.loto_item.length; n++) if (t == o.loto_item[n].id) {
this._itemIndex = n;
break;
}
} else {
this._itemID = o.loto_item[0].id;
this._itemIndex = 0;
}
this.refreshItem();
this.refreshSlider();
this.openAction();
};
t.prototype.refreshItemCountColor = function() {
for (var e = l.FestivalProxy.Instance.getActData(this._aid), t = 0; t < e.loto_item.length; t++) {
var o = e.loto_item[t], n = this._items[t];
o.id == this._itemID && this._cur > 0 ? n.Count.node.color = cc.Color.BLACK.fromHEX("#03F808") : n.Count.node.color = cc.Color.BLACK.fromHEX("#FFFFFF");
}
};
t.prototype.refreshItem = function() {
var e = l.FestivalProxy.Instance.getActData(this._aid);
this.ItemParent.destroyAllChildren();
this._items.length = 0;
for (var t = 0; t < e.loto_item.length; t++) {
var o = e.loto_item[t], n = l.FestivalProxy.Instance.getUserItemCount(this._aid, o.id), a = cc.instantiate(this.Item);
a.parent = this.ItemParent;
a.position = cc.Vec3.ZERO;
var i = a.getComponent(s.default);
i.CornerCount.node.active = !1;
i.Count.node.active = !0;
i.SelectToggle.node.active = !0;
i.AddButton.active = !1;
if (o.id == this._itemID) {
i.SelectToggle.isChecked = !0;
i.setCount(n + this._cur);
} else {
i.SelectToggle.isChecked = !1;
i.setCount(n);
}
i.setItemID(this._aid, o.id);
i.setSelectButtonFunc(this.onItemSelectClicked.bind(this));
this._items.push(i);
}
this.refreshItemCountColor();
};
t.prototype.onItemSelectClicked = function(e, t) {
var o = l.FestivalProxy.Instance.getActData(this._aid);
this._itemID = t;
for (var n = 0; n < o.loto_item.length; n++) {
var a = o.loto_item[n], i = l.FestivalProxy.Instance.getUserItemCount(this._aid, a.id), r = this._items[n];
if (a.id == this._itemID) {
r.SelectToggle.isChecked = !0;
r.setCount(i + this._cur);
this._itemIndex = n;
} else {
r.SelectToggle.isChecked = !1;
r.setCount(i);
}
}
this.refreshItemCountColor();
};
t.prototype.refreshSlider = function() {
this.SliderCount.string = "<color=#03F908>" + this._cur + "</c>/" + this._max;
var e = l.FestivalProxy.Instance.getActData(this._aid).loto_item[this._itemIndex], t = l.FestivalProxy.Instance.getUserItemCount(this._aid, e.id);
this._items[this._itemIndex].setCount(t + this._cur);
this.refreshItemCountColor();
};
t.prototype.onSlider = function() {
var e = this.Slider.progress;
this.Progress.progress = e;
var t = Math.floor(this._max * e);
if (t != this._cur) {
this._cur = t;
this.refreshSlider();
}
};
t.prototype.onSliderMoved = function() {
this.onSlider();
};
t.prototype.onSliderEnd = function() {
this.onSlider();
};
t.prototype.onSliderBtnClicked = function(e, t) {
var o = parseInt(t), n = this._cur + o;
n > this._max && (n = this._max);
n < 0 && (n = 0);
if (n != this._cur) {
this._cur = n;
var a = this._cur / this._max;
this.Slider.progress = a;
this.Progress.progress = a;
this.refreshSlider();
}
};
t.prototype.onChooseClicked = function() {
if (0 != this._cur) {
l.FestivalProxy.Instance.sendActExchange(this._aid, this._itemID, this._cur);
this.onCloseClicked();
}
};
t.prototype.onCloseClicked = function() {
var e = this;
this.closeAction(function() {
r.default.Instance.removeMaskLayer(e.node);
});
};
i([ d(cc.Node) ], t.prototype, "AlertPanel", void 0);
i([ d(cc.Prefab) ], t.prototype, "Item", void 0);
i([ d(cc.Node) ], t.prototype, "ItemParent", void 0);
i([ d(cc.Slider) ], t.prototype, "Slider", void 0);
i([ d(cc.ProgressBar) ], t.prototype, "Progress", void 0);
i([ d(cc.RichText) ], t.prototype, "SliderCount", void 0);
return i([ u ], t);
}(cc.Component);
o.default = p;
cc._RF.pop();
}, {
"../../../Game/fromework/helper/UIHelper": "UIHelper",
"../Common/FestivalModel": "FestivalModel",
"./FestivalItem": "FestivalItem"
} ],
FestivalItem: [ function(e, t, o) {
"use strict";
cc._RF.push(t, "fe77c+4U2dGLJbSwbFC4xpi", "FestivalItem");
var n, a = this && this.__extends || (n = function(e, t) {
return (n = Object.setPrototypeOf || {
__proto__: []
} instanceof Array && function(e, t) {
e.__proto__ = t;
} || function(e, t) {
for (var o in t) Object.prototype.hasOwnProperty.call(t, o) && (e[o] = t[o]);
})(e, t);
}, function(e, t) {
n(e, t);
function o() {
this.constructor = e;
}
e.prototype = null === t ? Object.create(t) : (o.prototype = t.prototype, new o());
}), i = this && this.__decorate || function(e, t, o, n) {
var a, i = arguments.length, r = i < 3 ? t : null === n ? n = Object.getOwnPropertyDescriptor(t, o) : n;
if ("object" == typeof Reflect && "function" == typeof Reflect.decorate) r = Reflect.decorate(e, t, o, n); else for (var l = e.length - 1; l >= 0; l--) (a = e[l]) && (r = (i < 3 ? a(r) : i > 3 ? a(t, o, r) : a(t, o)) || r);
return i > 3 && r && Object.defineProperty(t, o, r), r;
};
Object.defineProperty(o, "__esModule", {
value: !0
});
var r = e("../../../Game/fromework/global/ResLoader"), l = e("../../../platform/Platform"), s = cc._decorator, c = s.ccclass, u = s.property, d = function(e) {
a(t, e);
function t() {
var t = null !== e && e.apply(this, arguments) || this;
t.Icon = null;
t.CornerCount = null;
t.Count = null;
t.Mask = null;
t.AddButton = null;
t.AddIcon = null;
t.SelectToggle = null;
t._aid = 0;
t._itemID = 0;
t._addCallFunc = null;
t._selectCallFunc = null;
return t;
}
t.prototype.setCount = function(e) {
this.CornerCount.string = e.toString();
this.Count.string = e.toString();
};
t.prototype.setItemID = function(e, t) {
this._aid = e;
this._itemID = t;
this.refreshIcon();
};
t.prototype.setAddButtonFunc = function(e) {
this._addCallFunc = e;
};
t.prototype.setSelectButtonFunc = function(e) {
this._selectCallFunc = e;
};
t.prototype.refreshIcon = function() {
var e = this, t = "resources/Texture/Festival/Icon/festival_icon_" + this._itemID;
r.default.Instance.loadBundleRes(t, cc.SpriteFrame, function(o, n) {
o ? l.default.log("Festival " + e._aid + " load item image " + t + " failed") : e.Icon && e.Icon.node && e.Icon.node.isValid && (e.Icon.spriteFrame = n);
});
};
t.prototype.refreshItemIcon = function(e) {
var t = this, o = "resources/Texture/Item/item_icon_" + e;
r.default.Instance.loadBundleRes(o, cc.SpriteFrame, function(e, n) {
e ? l.default.log("Festival load item image " + o + " failed") : t.Icon && t.Icon.node && t.Icon.node.isValid && (t.Icon.spriteFrame = n);
});
};
t.prototype.onAddButtonClicked = function() {
this._addCallFunc && this._addCallFunc(this._aid, this._itemID);
};
t.prototype.onSelectClicked = function() {
this._selectCallFunc && this._selectCallFunc(this._aid, this._itemID);
};
i([ u(cc.Sprite) ], t.prototype, "Icon", void 0);
i([ u(cc.Label) ], t.prototype, "CornerCount", void 0);
i([ u(cc.Label) ], t.prototype, "Count", void 0);
i([ u(cc.Node) ], t.prototype, "Mask", void 0);
i([ u(cc.Node) ], t.prototype, "AddButton", void 0);
i([ u(cc.Node) ], t.prototype, "AddIcon", void 0);
i([ u(cc.Toggle) ], t.prototype, "SelectToggle", void 0);
return i([ c ], t);
}(cc.Component);
o.default = d;
cc._RF.pop();
}, {
"../../../Game/fromework/global/ResLoader": "ResLoader",
"../../../platform/Platform": "Platform"
} ],
FestivalModel: [ function(e, t, o) {
"use strict";
cc._RF.push(t, "07aab1IsbBDI51mYV7U/AFJ", "FestivalModel");
Object.defineProperty(o, "__esModule", {
value: !0
});
o.FestivalProxy = void 0;
var n = e("../../../Game/client/global/enum/game/Event"), a = e("../../../Game/client/global/enum/game/Game"), i = e("../../../Game/client/global/enum/net/C2S"), r = e("../../../Game/client/global/enum/net/S2C"), l = e("../../../Game/client/model/CommonModel"), s = e("../../../Game/fromework/helper/EventHelper"), c = e("../../../Game/fromework/mvvm/modelView/ViewModel"), u = e("../../../fromework/helper/NetHelper"), d = e("./FestivalEvent"), p = e("./FestivalStruct"), h = function() {
function e() {
this._allActivity = [];
this._actMap = new Map();
}
Object.defineProperty(e, "Instance", {
get: function() {
e._instance || (e._instance = new e());
return e._instance;
},
enumerable: !1,
configurable: !0
});
e.prototype.Init = function() {
s.default.Instance.Net.bind(r.S2C.ACT.ACT_ALL, this._onGetActAll, this);
s.default.Instance.Net.bind(r.S2C.ACT.ACT_MAIN, this._onGetActMain, this);
s.default.Instance.Net.bind(r.S2C.ACT.ACT_EXCHANGE, this._onActExchange, this);
s.default.Instance.Net.bind(r.S2C.ACT.ACT_GET_REWARD, this._onActGetTaskReward, this);
s.default.Instance.Net.bind(r.S2C.ACT.ACT_LOTO, this._onActLoto, this);
};
e.prototype.clear = function() {
s.default.Instance.Net.unbind(r.S2C.ACT.ACT_ALL, this._onGetActAll, this);
s.default.Instance.Net.unbind(r.S2C.ACT.ACT_MAIN, this._onGetActMain, this);
s.default.Instance.Net.unbind(r.S2C.ACT.ACT_EXCHANGE, this._onActExchange, this);
s.default.Instance.Net.unbind(r.S2C.ACT.ACT_GET_REWARD, this._onActGetTaskReward, this);
s.default.Instance.Net.unbind(r.S2C.ACT.ACT_LOTO, this._onActLoto, this);
this._allActivity.length = 0;
this._actMap.clear();
};
Object.defineProperty(e.prototype, "uid", {
get: function() {
return c.VM.getValue("user.uid");
},
enumerable: !1,
configurable: !0
});
Object.defineProperty(e.prototype, "token", {
get: function() {
return c.VM.getValue("user.token");
},
enumerable: !1,
configurable: !0
});
e.prototype.getAllActData = function() {
return this._allActivity;
};
e.prototype.getAllAct = function(e) {
for (var t = null, o = 0; o < this._allActivity.length; o++) if (this._allActivity[o].id == e) {
t = this._allActivity[o];
break;
}
return t;
};
e.prototype.getActivityState = function(e) {
for (var t = 3, o = 0; o < this._allActivity.length; o++) this._allActivity[o].id == e && (t = this._allActivity[o].state);
return t;
};
e.prototype.getCurrencyID = function(e) {
var t = this.getActData(e);
if (!t) return null;
for (var o = 0, n = 0; n < t.item_list.length; n++) if (2 == t.item_list[n].type) {
o = t.item_list[n].id;
break;
}
return o;
};
e.prototype.getOptionalID = function(e) {
var t = this.getActData(e);
if (!t) return null;
for (var o = 0, n = 0; n < t.item_list.length; n++) if (1 == t.item_list[n].type) {
o = t.item_list[n].id;
break;
}
return o;
};
e.prototype.getOptionalItemCount = function(e) {
var t = this.getOptionalID(e);
return this.getUserItemCount(e, t);
};
e.prototype.getActData = function(e) {
return this._actMap.has(e) ? this._actMap.get(e) : null;
};
e.prototype.getTaskByUI = function(e, t) {
var o = [], n = this.getActData(e);
if (!n) return o;
for (var a = 0; a < n.task.length; a++) {
var i = n.task[a];
i && i.ui == t && o.push(i);
}
return o;
};
e.prototype.getBoxTask = function(e) {
for (var t = this.getTaskByUI(e, 2), o = 0, n = 0, a = 0; a < t.length; a++) {
if (0 == t[a].state || 1 == t[a].state) {
o = a;
break;
}
n++;
}
var i = 5 * Math.floor(o / 5);
n != t.length - 1 && n != t.length || (i = t.length - 5);
var r = [];
for (a = i; a < i + 5; a++) null != t[a] && r.push(t[a]);
return r;
};
e.prototype.getUserItemCount = function(e, t) {
var o = this.getActData(e);
if (!o) return null;
for (var n = 0, a = 0; a < o.user_item.length; a++) if (o.user_item[a].id == t) {
n = o.user_item[a].count;
break;
}
return n;
};
e.prototype.checkLoto = function(e, t) {
var o = this.getActData(e);
if (!o) return null;
for (var n = !0, a = 0; a < o.loto_item.length; a++) {
var i = o.loto_item[a];
if (this.getUserItemCount(e, i.id) < i.count * t) {
n = !1;
break;
}
}
return n;
};
e.prototype.checkReddot = function(e) {
var t = this.getActData(e);
if (!t) return null;
var o = 0, i = 0, r = 0, l = 0;
t.task.forEach(function(e) {
1 == e.ui ? 1 == e.state && o++ : 2 == e.ui ? 1 == e.state && i++ : 3 == e.ui ? 1 == e.state && r++ : 4 == e.ui && 1 == e.state && l++;
});
s.default.Instance.Global.emit(n.RedDotEvent.REFRESH_RED_DOT_DATA, {
key: a.GameEnum.RedDotKey.FestivalTask + e + 1,
value: o
});
s.default.Instance.Global.emit(n.RedDotEvent.REFRESH_RED_DOT_DATA, {
key: a.GameEnum.RedDotKey.FestivalTask + e + 2,
value: i
});
s.default.Instance.Global.emit(n.RedDotEvent.REFRESH_RED_DOT_DATA, {
key: a.GameEnum.RedDotKey.FestivalTask + e + 3,
value: r
});
s.default.Instance.Global.emit(n.RedDotEvent.REFRESH_RED_DOT_DATA, {
key: a.GameEnum.RedDotKey.FestivalTask + e + 4,
value: l
});
var c = this.checkLoto(e, 10) ? 1 : 0;
s.default.Instance.Global.emit(n.RedDotEvent.REFRESH_RED_DOT_DATA, {
key: a.GameEnum.RedDotKey.FestivalLoto + e,
value: c
});
};
e.prototype._onGetActAll = function(e) {
var t = e.getUserData();
this._allActivity.length = 0;
for (var o = 0; o < t.act.length; o++) {
var n = new p.FestivalStruct.ActAll(t.act[o]);
this._allActivity.push(n);
}
s.default.Instance.Global.emit(d.FestivalEvent.FESTIVAL_GET_ACT_ALL);
};
e.prototype._onGetActMain = function(e) {
var t = e.getUserData();
if (null != t.act) {
var o = new p.FestivalStruct.Act(t.act);
this._actMap.set(o.id, o);
var n = this.getAllAct(o.id);
n && (n.state = t.act.state);
this.checkReddot(t.act.id);
}
s.default.Instance.Global.emit(d.FestivalEvent.FESTIVAL_GET_ACT_MAIN);
};
e.prototype._onActExchange = function(e) {
var t = e.getUserData(), o = this._actMap.get(t.act.id);
if (null != o) {
o.refresh(t.act);
var n = this.getAllAct(o.id);
n && (n.state = t.act.state);
}
for (var a = [], i = 0; i < t.reward_list.length; i++) {
var r = new l.Common.Reward(t.reward_list[i]);
a.push(r);
}
this.checkReddot(t.act.id);
s.default.Instance.Global.emit(d.FestivalEvent.FESTIVAL_ACT_EXCHANGE, a);
};
e.prototype._onActGetTaskReward = function(e) {
var t = e.getUserData(), o = this._actMap.get(t.act.id);
if (null != o) {
o.refresh(t.act);
var n = this.getAllAct(o.id);
n && (n.state = t.act.state);
}
for (var a = [], i = 0; i < t.reward_list.length; i++) {
var r = new l.Common.Reward(t.reward_list[i]);
a.push(r);
}
this.checkReddot(t.act.id);
s.default.Instance.Global.emit(d.FestivalEvent.FESTIVAL_ACT_GET_TASK_REWARD, a);
};
e.prototype._onActLoto = function(e) {
var t = e.getUserData(), o = this._actMap.get(t.act.id);
if (null != o) {
o.refresh(t.act);
var n = this.getAllAct(o.id);
n && (n.state = t.act.state);
}
for (var a = [], i = 0; i < t.reward_list.length; i++) {
var r = new l.Common.Reward(t.reward_list[i]);
a.push(r);
}
this.checkReddot(t.act.id);
s.default.Instance.Global.emit(d.FestivalEvent.FESTIVAL_ACT_LOTO, a);
};
e.prototype.sendGetActAll = function() {
var e = u.default.Instance.makeMsg(i.C2S.ACT_ALL, {
u: this.uid,
t: this.token
});
u.default.Instance.send(e);
};
e.prototype.sendGetActMain = function(e) {
var t = u.default.Instance.makeMsg(i.C2S.ACT_MAIN, {
u: this.uid,
t: this.token,
aid: e
});
u.default.Instance.send(t);
};
e.prototype.sendActExchange = function(e, t, o) {
var n = u.default.Instance.makeMsg(i.C2S.ACT_EXCHANGE, {
u: this.uid,
t: this.token,
aid: e,
item_id: t,
item_num: o
});
u.default.Instance.send(n);
};
e.prototype.sendActGetTaskReward = function(e, t) {
var o = u.default.Instance.makeMsg(i.C2S.ACT_GET_REWARD, {
u: this.uid,
t: this.token,
aid: e,
tid: t
});
u.default.Instance.send(o);
};
e.prototype.sendActLoto = function(e, t) {
var o = u.default.Instance.makeMsg(i.C2S.ACT_LOTO, {
u: this.uid,
t: this.token,
aid: e,
option: t
});
u.default.Instance.send(o);
};
e._instance = null;
return e;
}();
o.FestivalProxy = h;
cc._RF.pop();
}, {
"../../../Game/client/global/enum/game/Event": "Event",
"../../../Game/client/global/enum/game/Game": "Game",
"../../../Game/client/global/enum/net/C2S": "C2S",
"../../../Game/client/global/enum/net/S2C": "S2C",
"../../../Game/client/model/CommonModel": "CommonModel",
"../../../Game/fromework/helper/EventHelper": "EventHelper",
"../../../Game/fromework/mvvm/modelView/ViewModel": "ViewModel",
"../../../fromework/helper/NetHelper": "NetHelper",
"./FestivalEvent": "FestivalEvent",
"./FestivalStruct": "FestivalStruct"
} ],
FestivalRandomItem: [ function(e, t, o) {
"use strict";
cc._RF.push(t, "1952eUwiolP3bXNTd7PRVVI", "FestivalRandomItem");
var n, a = this && this.__extends || (n = function(e, t) {
return (n = Object.setPrototypeOf || {
__proto__: []
} instanceof Array && function(e, t) {
e.__proto__ = t;
} || function(e, t) {
for (var o in t) Object.prototype.hasOwnProperty.call(t, o) && (e[o] = t[o]);
})(e, t);
}, function(e, t) {
n(e, t);
function o() {
this.constructor = e;
}
e.prototype = null === t ? Object.create(t) : (o.prototype = t.prototype, new o());
}), i = this && this.__decorate || function(e, t, o, n) {
var a, i = arguments.length, r = i < 3 ? t : null === n ? n = Object.getOwnPropertyDescriptor(t, o) : n;
if ("object" == typeof Reflect && "function" == typeof Reflect.decorate) r = Reflect.decorate(e, t, o, n); else for (var l = e.length - 1; l >= 0; l--) (a = e[l]) && (r = (i < 3 ? a(r) : i > 3 ? a(t, o, r) : a(t, o)) || r);
return i > 3 && r && Object.defineProperty(t, o, r), r;
};
Object.defineProperty(o, "__esModule", {
value: !0
});
var r = e("../../../Game/client/model/LanguageModel"), l = e("../../../Game/fromework/global/Tools"), s = e("../../logic/Wallet/WalletHelper"), c = e("../../model/WalletModel"), u = e("../Common/FestivalModel"), d = cc._decorator, p = d.ccclass, h = d.property, f = function(e) {
a(t, e);
function t() {
var t = null !== e && e.apply(this, arguments) || this;
t.CashCount = null;
t.ItemCount = null;
t.CashLayout = null;
t.RewardButton = null;
t.RechargeButton = null;
t.Icon = null;
t.Frames_Icon = [];
t._aid = 0;
t._taskData = null;
return t;
}
t.prototype.refresh = function(e, t, o) {
this._aid = e;
this._taskData = t;
this.CashCount.string = this._taskData.target_show.toString();
this.Icon.spriteFrame = this.Frames_Icon[o];
var n = u.FestivalProxy.Instance.getCurrencyID(this._aid), a = Math.floor(this._taskData.count / this._taskData.target);
0 == a && (a = 1);
for (var i = 0, s = 0; s < this._taskData.reward_list.length; s++) this._taskData.reward_list[s].type == n && (i = this._taskData.reward_list[s].num);
this.ItemCount.string = l.Tools.TStr.replaceString(r.default.getString("FESTIVAL_RANDOM_TASK_ITEM"), {
num: i * a
});
var c = cc.find("Background/Label", this.RechargeButton).getComponent(cc.Label);
c && (c.string = r.default.getString("MoneySymbol") + this._taskData.target);
this.CashLayout.active = 0 == this._taskData.state;
this.RechargeButton.active = 0 == this._taskData.state;
this.RewardButton.active = 1 == this._taskData.state;
};
t.prototype.onRechargeClicked = function() {
var e = 0, t = c.WalletProxy.Instance.getRechargeActiveByType(7);
t && t[0] && (e = t[0].id);
s.default.Instance.openRechargeView(function() {}, this._taskData.target, e, 0, 0, 7);
};
t.prototype.onRewardClicked = function() {
1 == this._taskData.state && u.FestivalProxy.Instance.sendActGetTaskReward(this._aid, this._taskData.id);
};
i([ h(cc.Label) ], t.prototype, "CashCount", void 0);
i([ h(cc.RichText) ], t.prototype, "ItemCount", void 0);
i([ h(cc.Node) ], t.prototype, "CashLayout", void 0);
i([ h(cc.Node) ], t.prototype, "RewardButton", void 0);
i([ h(cc.Node) ], t.prototype, "RechargeButton", void 0);
i([ h(cc.Sprite) ], t.prototype, "Icon", void 0);
i([ h([ cc.SpriteFrame ]) ], t.prototype, "Frames_Icon", void 0);
return i([ p ], t);
}(cc.Component);
o.default = f;
cc._RF.pop();
}, {
"../../../Game/client/model/LanguageModel": "LanguageModel",
"../../../Game/fromework/global/Tools": "Tools",
"../../logic/Wallet/WalletHelper": "WalletHelper",
"../../model/WalletModel": "WalletModel",
"../Common/FestivalModel": "FestivalModel"
} ],
FestivalStruct: [ function(e, t, o) {
"use strict";
cc._RF.push(t, "4aeb8GRILZOILuC1yy5FMPY", "FestivalStruct");
Object.defineProperty(o, "__esModule", {
value: !0
});
o.FestivalStruct = void 0;
var n = e("../../../Game/client/model/CommonModel");
(function(e) {
var t = function() {
function e(e) {
this.id = 0;
this.name = "";
this.state = 0;
this.time_start = 0;
this.time_stop = 0;
this.time_end = 0;
e && this.refresh(e);
}
e.prototype.refresh = function(e) {
this.id = e.id;
this.name = e.name;
this.state = e.state;
this.time_start = e.time_start;
this.time_stop = e.time_stop;
this.time_end = e.time_end;
};
return e;
}();
e.ActAll = t;
var o = function() {
function e(e) {
this.id = 0;
this.type = 0;
this.count = 0;
e && this.refresh(e);
}
e.prototype.refresh = function(e) {
this.id = e.id;
this.type = null != e.type ? e.type : 0;
this.count = e.count;
};
return e;
}();
e.Item = o;
var a = function() {
function e(e) {
this.id = 0;
this.title = "";
this.target = 0;
this.target_show = 0;
this.reward_list = [];
this.type = 0;
this.item = 0;
this.count = 0;
this.state = 0;
this.item_target = "";
this.order = 0;
this.ui = 0;
e && this.refresh(e);
}
e.prototype.refresh = function(e) {
this.id = e.id;
this.title = e.title;
this.target = parseInt(e.target);
this.target_show = null != e.target_show ? parseInt(e.target_show) : 0;
this.type = parseInt(e.type);
this.item = parseInt(e.item);
this.count = parseInt(e.count);
this.state = parseInt(e.state);
this.item_target = e.item_target;
this.order = parseInt(e.order);
this.ui = parseInt(e.ui);
this.reward_list = [];
for (var t = 0; t < e.reward_list.length; t++) {
var o = new n.Common.Reward(e.reward_list[t]);
this.reward_list.push(o);
}
};
return e;
}();
e.Task = a;
var i = function() {
function e(e) {
this.id = 0;
this.name = "";
this.state = 0;
this.jackpot = 0;
this.jackpot_win_list = [];
this.item_list = [];
this.user_item = [];
this.loto_item = [];
this.loto_options = [];
this.task = [];
e && this.refresh(e);
}
e.prototype.refresh = function(e) {
e.id && (this.id = e.id);
e.name && (this.name = e.name);
e.state && (this.state = e.state);
e.jackpot && (this.jackpot = e.jackpot);
e.jackpot_win_list && (this.jackpot_win_list = e.jackpot_win_list);
e.loto_options && (this.loto_options = e.loto_options);
if (null != e.item_list) {
this.item_list = [];
for (var t = 0; t < e.item_list.length; t++) {
var n = new o(e.item_list[t]);
this.item_list.push(n);
}
}
if (null != e.user_item) {
this.user_item = [];
for (var i in e.user_item) {
(n = new o()).id = parseInt(i);
n.type = 0;
n.count = e.user_item[i];
this.user_item.push(n);
}
}
if (null != e.loto_item) {
this.loto_item = [];
for (var i in e.loto_item) {
(n = new o(e.loto_item[i])).id = parseInt(i);
n.type = 0;
n.count = e.loto_item[i];
this.loto_item.push(n);
}
}
if (null != e.task) {
this.task = [];
for (t = 0; t < e.task.length; t++) {
n = new a(e.task[t]);
this.task.push(n);
}
}
};
return e;
}();
e.Act = i;
})(o.FestivalStruct || (o.FestivalStruct = {}));
cc._RF.pop();
}, {
"../../../Game/client/model/CommonModel": "CommonModel"
} ],
FestivalTaskBox: [ function(e, t, o) {
"use strict";
cc._RF.push(t, "1bfd0EIjS9J0qsk04sxbKJc", "FestivalTaskBox");
var n, a = this && this.__extends || (n = function(e, t) {
return (n = Object.setPrototypeOf || {
__proto__: []
} instanceof Array && function(e, t) {
e.__proto__ = t;
} || function(e, t) {
for (var o in t) Object.prototype.hasOwnProperty.call(t, o) && (e[o] = t[o]);
})(e, t);
}, function(e, t) {
n(e, t);
function o() {
this.constructor = e;
}
e.prototype = null === t ? Object.create(t) : (o.prototype = t.prototype, new o());
}), i = this && this.__decorate || function(e, t, o, n) {
var a, i = arguments.length, r = i < 3 ? t : null === n ? n = Object.getOwnPropertyDescriptor(t, o) : n;
if ("object" == typeof Reflect && "function" == typeof Reflect.decorate) r = Reflect.decorate(e, t, o, n); else for (var l = e.length - 1; l >= 0; l--) (a = e[l]) && (r = (i < 3 ? a(r) : i > 3 ? a(t, o, r) : a(t, o)) || r);
return i > 3 && r && Object.defineProperty(t, o, r), r;
};
Object.defineProperty(o, "__esModule", {
value: !0
});
var r = e("../../../Game/client/model/LanguageModel"), l = e("../Common/FestivalModel"), s = cc._decorator, c = s.ccclass, u = s.property, d = function(e) {
a(t, e);
function t() {
var t = null !== e && e.apply(this, arguments) || this;
t.Progress = null;
t.InviteNum = null;
t.Conditions = [];
t.BoxParent = null;
t.BoxNode = null;
t._aid = 0;
t._dataList = [];
return t;
}
t.prototype.refreshView = function(e) {
this._aid = e;
this._dataList = l.FestivalProxy.Instance.getBoxTask(this._aid);
this.refreshCindition();
this.refreshBox();
this.refreshProgress();
};
t.prototype.refreshCindition = function() {
for (var e = 0; e < this.Conditions.length; e++) if (null != this._dataList[e]) {
this.Conditions[e].node.active = 2 != this._dataList[e].state;
this.Conditions[e].string = r.default.getString("MoneySymbol") + this._dataList[e].target.toString();
}
};
t.prototype.refreshBox = function() {
this.BoxParent.destroyAllChildren();
for (var e = l.FestivalProxy.Instance.getOptionalID(this._aid), t = l.FestivalProxy.Instance.getCurrencyID(this._aid), o = 0; o < this._dataList.length; o++) {
var n = this._dataList[o], a = cc.instantiate(this.BoxNode);
a.parent = this.BoxParent;
a.active = !0;
a.setPosition(cc.v3(128 * (o + 1), 12, 0));
for (var i = 0, r = 0, s = 0; s < n.reward_list.length; s++) {
n.reward_list[s].type == e && (i = n.reward_list[s].num);
n.reward_list[s].type == t && (r = n.reward_list[s].num);
}
var c = cc.find("Currency", a);
c.active = i > 0;
if (c.active) {
cc.find("Currency/Finish", a).active = 2 == n.state;
var u = cc.find("Currency/Count", a).getComponent(cc.Label);
u.string = i.toString();
u.node.active = i > 1;
}
cc.find("Currency/RedDot", a).active = 1 == n.state;
var d = cc.find("Random", a);
d.active = r > 0;
if (d.active) {
cc.find("Random/Finish", a).active = 2 == n.state;
var p = cc.find("Random/Count", a).getComponent(cc.Label);
p.string = r.toString();
p.node.active = i > 1;
}
cc.find("Finish", a).active = 2 == n.state;
var h = new cc.Component.EventHandler();
h.target = this.node;
h.component = "FestivalTaskBox";
h.handler = "onRewardClicked";
h.customEventData = String(o);
a.getComponent(cc.Button).clickEvents.push(h);
}
};
t.prototype.refreshProgress = function() {
for (var e = this._dataList[Math.max(this._dataList.length - 1, 0)].count, t = 0, o = this._dataList[Math.max(this._dataList.length - 1, 0)].target, n = 0, a = 0; a < this._dataList.length; a++) {
if (!(e >= this._dataList[a].target)) {
o = this._dataList[a].target;
break;
}
n++;
t = this._dataList[a].target;
}
var i = (e - t) / (o - t) * .2 + .2 * n;
i > 1 && (i = 1);
i < 0 && (i = 0);
this.Progress.progress = i;
this.InviteNum.string = e.toString();
};
t.prototype.onRewardClicked = function(e, t) {
var o = parseInt(t), n = this._dataList[o], a = this._dataList[Math.max(this._dataList.length - 1, 0)].count;
1 == n.state && a >= n.target ? l.FestivalProxy.Instance.sendActGetTaskReward(this._aid, n.id) : n.state;
};
i([ u(cc.ProgressBar) ], t.prototype, "Progress", void 0);
i([ u(cc.Label) ], t.prototype, "InviteNum", void 0);
i([ u([ cc.Label ]) ], t.prototype, "Conditions", void 0);
i([ u(cc.Node) ], t.prototype, "BoxParent", void 0);
i([ u(cc.Node) ], t.prototype, "BoxNode", void 0);
return i([ c ], t);
}(cc.Component);
o.default = d;
cc._RF.pop();
}, {
"../../../Game/client/model/LanguageModel": "LanguageModel",
"../Common/FestivalModel": "FestivalModel"
} ],
FestivalTaskItem: [ function(e, t, o) {
"use strict";
cc._RF.push(t, "8fd0ad26oZDcKO727VXG+TK", "FestivalTaskItem");
var n, a = this && this.__extends || (n = function(e, t) {
return (n = Object.setPrototypeOf || {
__proto__: []
} instanceof Array && function(e, t) {
e.__proto__ = t;
} || function(e, t) {
for (var o in t) Object.prototype.hasOwnProperty.call(t, o) && (e[o] = t[o]);
})(e, t);
}, function(e, t) {
n(e, t);
function o() {
this.constructor = e;
}
e.prototype = null === t ? Object.create(t) : (o.prototype = t.prototype, new o());
}), i = this && this.__decorate || function(e, t, o, n) {
var a, i = arguments.length, r = i < 3 ? t : null === n ? n = Object.getOwnPropertyDescriptor(t, o) : n;
if ("object" == typeof Reflect && "function" == typeof Reflect.decorate) r = Reflect.decorate(e, t, o, n); else for (var l = e.length - 1; l >= 0; l--) (a = e[l]) && (r = (i < 3 ? a(r) : i > 3 ? a(t, o, r) : a(t, o)) || r);
return i > 3 && r && Object.defineProperty(t, o, r), r;
};
Object.defineProperty(o, "__esModule", {
value: !0
});
var r = e("../../../Game/client/global/enum/game/Const"), l = e("../../../Game/client/global/enum/game/Event"), s = e("../../../Game/fromework/helper/EventHelper"), c = e("../../../Game/fromework/helper/UIHelper"), u = e("../../logic/Wallet/WalletHelper"), d = e("../Common/FestivalEvent"), p = e("../Common/FestivalModel"), h = cc._decorator, f = h.ccclass, _ = h.property, m = function(e) {
a(t, e);
function t() {
var t = null !== e && e.apply(this, arguments) || this;
t.Name = null;
t.Condition = null;
t.Icon = null;
t.IconFinish = null;
t.IconCount = null;
t.IconCheck = null;
t.RewardButton = null;
t.GoButton = null;
t.Finish = null;
t.IconFrames = [];
t._aid = 0;
t._taskData = null;
return t;
}
t.prototype.refresh = function(e, t) {
this._aid = e;
this._taskData = t;
this.Name.string = this._taskData.title;
this.Condition.string = "(<color=#03FF6B>" + this._taskData.count + "</c>/" + this._taskData.target + ")";
for (var o = p.FestivalProxy.Instance.getOptionalID(this._aid), n = p.FestivalProxy.Instance.getCurrencyID(this._aid), a = 0, i = 0, r = 0; r < this._taskData.reward_list.length; r++) {
this._taskData.reward_list[r].type == o && (a = this._taskData.reward_list[r].num);
this._taskData.reward_list[r].type == n && (i = this._taskData.reward_list[r].num);
}
if (a > 0) {
this.Icon.spriteFrame = this.IconFrames[0];
this.IconFinish.spriteFrame = this.IconFrames[0];
this.IconCount.string = a.toString();
this.IconCount.node.active = a > 1;
} else if (i > 0) {
this.Icon.spriteFrame = this.IconFrames[1];
this.IconFinish.spriteFrame = this.IconFrames[1];
this.IconCount.string = i.toString();
this.IconCount.node.active = i > 1;
}
this.IconFinish.node.active = 2 == this._taskData.state;
this.IconCheck.active = 2 == this._taskData.state;
this.Finish.active = 2 == this._taskData.state;
this.GoButton.active = 0 == this._taskData.state;
this.RewardButton.active = 1 == this._taskData.state;
};
t.prototype.onGoClicked = function() {
if (0 == this._taskData.state) {
1 == this._taskData.item || 4 == this._taskData.item || 6 == this._taskData.item || 10 == this._taskData.item ? s.default.Instance.Global.emit(l.GameUIEvent.LOBBY_CASH_JOIN, this._taskData.item_target) : 2 == this._taskData.item || 11 == this._taskData.item ? u.default.Instance.openRecharge() : 3 == this._taskData.item ? c.default.Instance.addBundleMaskLayer(r.BundleUIPath.MonthCard) : 5 == this._taskData.item && u.default.Instance.openReferearn();
s.default.Instance.Global.emit(d.FestivalEvent.FESTIVAL_UI_CLOSE);
}
};
t.prototype.onRewardClicked = function() {
1 == this._taskData.state && p.FestivalProxy.Instance.sendActGetTaskReward(this._aid, this._taskData.id);
};
i([ _(cc.Label) ], t.prototype, "Name", void 0);
i([ _(cc.RichText) ], t.prototype, "Condition", void 0);
i([ _(cc.Sprite) ], t.prototype, "Icon", void 0);
i([ _(cc.Sprite) ], t.prototype, "IconFinish", void 0);
i([ _(cc.Label) ], t.prototype, "IconCount", void 0);
i([ _(cc.Node) ], t.prototype, "IconCheck", void 0);
i([ _(cc.Node) ], t.prototype, "RewardButton", void 0);
i([ _(cc.Node) ], t.prototype, "GoButton", void 0);
i([ _(cc.Node) ], t.prototype, "Finish", void 0);
i([ _([ cc.SpriteFrame ]) ], t.prototype, "IconFrames", void 0);
return i([ f ], t);
}(cc.Component);
o.default = m;
cc._RF.pop();
}, {
"../../../Game/client/global/enum/game/Const": "Const",
"../../../Game/client/global/enum/game/Event": "Event",
"../../../Game/fromework/helper/EventHelper": "EventHelper",
"../../../Game/fromework/helper/UIHelper": "UIHelper",
"../../logic/Wallet/WalletHelper": "WalletHelper",
"../Common/FestivalEvent": "FestivalEvent",
"../Common/FestivalModel": "FestivalModel"
} ],
FestivalTask: [ function(e, t, o) {
"use strict";
cc._RF.push(t, "e15ea8nWXJAur4ytSTHOliY", "FestivalTask");
var n, a = this && this.__extends || (n = function(e, t) {
return (n = Object.setPrototypeOf || {
__proto__: []
} instanceof Array && function(e, t) {
e.__proto__ = t;
} || function(e, t) {
for (var o in t) Object.prototype.hasOwnProperty.call(t, o) && (e[o] = t[o]);
})(e, t);
}, function(e, t) {
n(e, t);
function o() {
this.constructor = e;
}
e.prototype = null === t ? Object.create(t) : (o.prototype = t.prototype, new o());
}), i = this && this.__decorate || function(e, t, o, n) {
var a, i = arguments.length, r = i < 3 ? t : null === n ? n = Object.getOwnPropertyDescriptor(t, o) : n;
if ("object" == typeof Reflect && "function" == typeof Reflect.decorate) r = Reflect.decorate(e, t, o, n); else for (var l = e.length - 1; l >= 0; l--) (a = e[l]) && (r = (i < 3 ? a(r) : i > 3 ? a(t, o, r) : a(t, o)) || r);
return i > 3 && r && Object.defineProperty(t, o, r), r;
};
Object.defineProperty(o, "__esModule", {
value: !0
});
var r = e("../../../Game/fromework/helper/EventHelper"), l = e("../../../Game/fromework/helper/UIHelper"), s = e("../../../fromework/component/TableView/TableList"), c = e("../Common/FestivalEvent"), u = e("../Common/FestivalModel"), d = e("./FestivalTaskBox"), p = e("./FestivalTaskItem"), h = cc._decorator, f = h.ccclass, _ = h.property, m = function(e) {
a(t, e);
function t() {
var t = null !== e && e.apply(this, arguments) || this;
t.TaskBox = null;
t.DailyProgress = null;
t.DailyCondition = null;
t.DailyIcon = null;
t.DailyIconFinish = null;
t.DailyIconCount = null;
t.DailyIconCheck = null;
t.DailyReddot = null;
t.IconFrames = [];
t.TaskList = null;
t.EndNode = null;
t._aid = 0;
t._dailyTask = null;
t._taskList = [];
return t;
}
t.prototype.onLoad = function() {
r.default.Instance.Global.bind(c.FestivalEvent.FESTIVAL_ACT_GET_TASK_REWARD, this.onGetTaskReward, this);
r.default.Instance.Global.bind(c.FestivalEvent.FESTIVAL_UI_CLOSE, this.onCloseClicked, this);
};
t.prototype.onDestroy = function() {
r.default.Instance.Global.unbind(c.FestivalEvent.FESTIVAL_ACT_GET_TASK_REWARD, this.onGetTaskReward, this);
r.default.Instance.Global.unbind(c.FestivalEvent.FESTIVAL_UI_CLOSE, this.onCloseClicked, this);
};
t.prototype.showView = function(e) {
this._aid = e;
var t = u.FestivalProxy.Instance.getActivityState(this._aid);
this.EndNode.active = 2 == t || 3 == t;
this.refreshBox();
this.refreshDaily();
this.refreshList();
};
t.prototype.onGetTaskReward = function() {
this.refreshBox();
this.refreshDaily();
this.refreshList();
};
t.prototype.refreshBox = function() {
this.TaskBox.refreshView(this._aid);
};
t.prototype.refreshDaily = function() {
var e = u.FestivalProxy.Instance.getTaskByUI(this._aid, 3);
if (e && e[0]) {
this._dailyTask = e[0];
this.DailyProgress.progress = this._dailyTask.count / this._dailyTask.target;
this.DailyCondition.string = "(<color=#03FF6B>" + this._dailyTask.count + "</c>/" + this._dailyTask.target + ")";
for (var t = u.FestivalProxy.Instance.getOptionalID(this._aid), o = u.FestivalProxy.Instance.getCurrencyID(this._aid), n = 0, a = 0, i = 0; i < this._dailyTask.reward_list.length; i++) {
this._dailyTask.reward_list[i].type == t && (n = this._dailyTask.reward_list[i].num);
this._dailyTask.reward_list[i].type == o && (a = this._dailyTask.reward_list[i].num);
}
if (n > 0) {
this.DailyIcon.spriteFrame = this.IconFrames[0];
this.DailyIconFinish.spriteFrame = this.IconFrames[0];
this.DailyIconCount.string = n.toString();
this.DailyIconCount.node.active = n > 1;
} else if (a > 0) {
this.DailyIcon.spriteFrame = this.IconFrames[1];
this.DailyIconFinish.spriteFrame = this.IconFrames[1];
this.DailyIconCount.string = a.toString();
this.DailyIconCount.node.active = a > 1;
}
this.DailyIconFinish.node.active = 2 == this._dailyTask.state;
this.DailyIconCheck.active = 2 == this._dailyTask.state;
this.DailyReddot.active = 1 == this._dailyTask.state;
}
};
t.prototype.refreshList = function() {
this._taskList = u.FestivalProxy.Instance.getTaskByUI(this._aid, 4);
this._taskList.sort(function(e, t) {
return e.order - t.order;
});
this._taskList && (this.TaskList.numItems = this._taskList.length);
};
t.prototype.onListRender = function(e, t) {
var o = this._taskList[t];
e.getComponent(p.default).refresh(this._aid, o);
};
t.prototype.onDailyRewardClicked = function() {
1 == this._dailyTask.state && u.FestivalProxy.Instance.sendActGetTaskReward(this._aid, this._dailyTask.id);
};
t.prototype.onCloseClicked = function() {
l.default.Instance.removeMaskLayer(this.node);
};
i([ _(d.default) ], t.prototype, "TaskBox", void 0);
i([ _(cc.ProgressBar) ], t.prototype, "DailyProgress", void 0);
i([ _(cc.RichText) ], t.prototype, "DailyCondition", void 0);
i([ _(cc.Sprite) ], t.prototype, "DailyIcon", void 0);
i([ _(cc.Sprite) ], t.prototype, "DailyIconFinish", void 0);
i([ _(cc.Label) ], t.prototype, "DailyIconCount", void 0);
i([ _(cc.Node) ], t.prototype, "DailyIconCheck", void 0);
i([ _(cc.Node) ], t.prototype, "DailyReddot", void 0);
i([ _([ cc.SpriteFrame ]) ], t.prototype, "IconFrames", void 0);
i([ _(s.default) ], t.prototype, "TaskList", void 0);
i([ _(cc.Node) ], t.prototype, "EndNode", void 0);
return i([ f ], t);
}(cc.Component);
o.default = m;
cc._RF.pop();
}, {
"../../../Game/fromework/helper/EventHelper": "EventHelper",
"../../../Game/fromework/helper/UIHelper": "UIHelper",
"../../../fromework/component/TableView/TableList": "TableList",
"../Common/FestivalEvent": "FestivalEvent",
"../Common/FestivalModel": "FestivalModel",
"./FestivalTaskBox": "FestivalTaskBox",
"./FestivalTaskItem": "FestivalTaskItem"
} ],
FestivalView: [ function(e, t, o) {
"use strict";
cc._RF.push(t, "8f2c0fwF3pKRJ35vkiagd70", "FestivalView");
var n, a = this && this.__extends || (n = function(e, t) {
return (n = Object.setPrototypeOf || {
__proto__: []
} instanceof Array && function(e, t) {
e.__proto__ = t;
} || function(e, t) {
for (var o in t) Object.prototype.hasOwnProperty.call(t, o) && (e[o] = t[o]);
})(e, t);
}, function(e, t) {
n(e, t);
function o() {
this.constructor = e;
}
e.prototype = null === t ? Object.create(t) : (o.prototype = t.prototype, new o());
}), i = this && this.__decorate || function(e, t, o, n) {
var a, i = arguments.length, r = i < 3 ? t : null === n ? n = Object.getOwnPropertyDescriptor(t, o) : n;
if ("object" == typeof Reflect && "function" == typeof Reflect.decorate) r = Reflect.decorate(e, t, o, n); else for (var l = e.length - 1; l >= 0; l--) (a = e[l]) && (r = (i < 3 ? a(r) : i > 3 ? a(t, o, r) : a(t, o)) || r);
return i > 3 && r && Object.defineProperty(t, o, r), r;
};
Object.defineProperty(o, "__esModule", {
value: !0
});
var r = e("../../../Game/client/global/enum/game/Const"), l = e("../../../Game/client/global/enum/game/Event"), s = e("../../../Game/client/global/enum/game/Game"), c = e("../../../Game/client/model/LanguageModel"), u = e("../../../Game/fromework/global/Tools"), d = e("../../../Game/fromework/helper/AudioHelper"), p = e("../../../Game/fromework/helper/EventHelper"), h = e("../../../Game/fromework/helper/UIHelper"), f = e("../../../fromework/component/TableView/TableList"), _ = e("../../component/RedDot"), m = e("../../global/PopHelper"), y = e("../../logic/Wallet/WalletHelper"), g = e("../Common/FestivalEvent"), v = e("../Common/FestivalModel"), C = e("./FestivalRandomItem"), b = cc._decorator, I = b.ccclass, E = b.property, S = function(e) {
a(t, e);
function t() {
var t = null !== e && e.apply(this, arguments) || this;
t.Jackpot = null;
t.JackpotUsers = [];
t.JackpotNone = null;
t.ExchangeTaskList = null;
t.ExchangeTips = null;
t.ExchangeEnd = null;
t.Effect = null;
t.EffectMask = null;
t.Item = null;
t.LotoTitle = null;
t.LotoItemParent = null;
t.LotoOneTitle = null;
t.LotoTenTitle = null;
t.LotoOneButton = null;
t.LotoTenButton = null;
t.DateLabel = null;
t.OptionalItemCount = null;
t.TaskReddot = null;
t.LotoReddot = null;
t._aid = 0;
t._items = [];
t._rechargeTask = null;
t._taskList = [];
return t;
}
t.prototype.onLoad = function() {
this.LotoOneButton.isNotPlaySound = !0;
this.LotoTenButton.isNotPlaySound = !0;
p.default.Instance.Global.bind(l.WalletEvent.RECHARGE_ACT_REFRESH, this.onActRefresh, this);
p.default.Instance.Global.bind(g.FestivalEvent.FESTIVAL_UI_RECHARGE, this.onRefreshWallet, this);
p.default.Instance.Global.bind("ErrorCode160", this.onActivityEnd, this);
p.default.Instance.Global.bind(g.FestivalEvent.FESTIVAL_GET_ACT_MAIN, this.onGetMainData, this);
p.default.Instance.Global.bind(g.FestivalEvent.FESTIVAL_ACT_LOTO, this.onLotoCallBack, this);
p.default.Instance.Global.bind(g.FestivalEvent.FESTIVAL_ACT_GET_TASK_REWARD, this.onGetTaskReward, this);
p.default.Instance.Global.bind(g.FestivalEvent.FESTIVAL_ACT_EXCHANGE, this.onExchange, this);
};
t.prototype.onDestroy = function() {
p.default.Instance.Global.unbind(l.WalletEvent.RECHARGE_ACT_REFRESH, this.onActRefresh, this);
p.default.Instance.Global.unbind(g.FestivalEvent.FESTIVAL_UI_RECHARGE, this.onRefreshWallet, this);
p.default.Instance.Global.unbind("ErrorCode160", this.onActivityEnd, this);
p.default.Instance.Global.unbind(g.FestivalEvent.FESTIVAL_GET_ACT_MAIN, this.onGetMainData, this);
p.default.Instance.Global.unbind(g.FestivalEvent.FESTIVAL_ACT_LOTO, this.onLotoCallBack, this);
p.default.Instance.Global.unbind(g.FestivalEvent.FESTIVAL_ACT_GET_TASK_REWARD, this.onGetTaskReward, this);
p.default.Instance.Global.unbind(g.FestivalEvent.FESTIVAL_ACT_EXCHANGE, this.onExchange, this);
};
t.prototype.showView = function() {};
t.prototype.onActRefresh = function() {
this.refreshItemExchange();
};
t.prototype.onRefreshWallet = function() {
v.FestivalProxy.Instance.sendGetActMain(this._aid);
};
t.prototype.onActivityEnd = function() {
var e = this, t = {
title: c.default.getString("PROMPT_NOTICE"),
content: c.default.getString("FESTIVAL_ERROR_160"),
leftTitle: c.default.getString("GENGXIN_QUEDING"),
leftCallFunc: function() {
e.onCloseClicked();
},
cancelCallFunc: function() {
e.onCloseClicked();
}
};
m.PopHelper.Instance.showAlert(t);
v.FestivalProxy.Instance.sendGetActAll();
};
t.prototype.onGetMainData = function() {
if (v.FestivalProxy.Instance.getActData(this._aid)) {
this.refreshDate();
this.refreshJackpot();
this.refreshItemExchange();
this.refreshOptionalCount();
this.initLotoItem();
this.refreshLotoTitle();
} else this.onCloseClicked();
};
t.prototype.onLotoCallBack = function(e) {
var t = e.getUserData();
this.playLotoAnimation(t);
this.refreshOptionalCount();
this.refreshLotoTitle();
this.refreshLotoItem();
};
t.prototype.onGetTaskReward = function(e) {
var t = e.getUserData();
m.PopHelper.Instance.showReward(t, function() {});
this.refreshItemExchange();
this.refreshOptionalCount();
this.refreshLotoItem();
this.refreshLotoTitle();
};
t.prototype.onExchange = function(e) {
var t = e.getUserData();
m.PopHelper.Instance.showReward(t, function() {});
this.refreshItemExchange();
this.refreshOptionalCount();
this.refreshLotoItem();
this.refreshLotoTitle();
};
t.prototype.bindReddotKey = function() {
this.TaskReddot.setBindKeys([ (s.GameEnum.RedDotKey.FestivalTask + this._aid + 2).toString(), (s.GameEnum.RedDotKey.FestivalTask + this._aid + 3).toString(), (s.GameEnum.RedDotKey.FestivalTask + this._aid + 4).toString() ]);
this.LotoReddot.setBindKeys([ (s.GameEnum.RedDotKey.FestivalLoto + this._aid).toString() ]);
};
t.prototype.refreshJackpot = function() {
var e = v.FestivalProxy.Instance.getActData(this._aid);
this.Jackpot.string = e.jackpot.toString();
for (var t = 0; t < this.JackpotUsers.length; t++) {
var o = this.JackpotUsers[t];
if (null != e.jackpot_win_list[t]) {
o.node.active = !0;
o.string = e.jackpot_win_list[t];
} else o.node.active = !1;
}
this.JackpotNone.active = 0 == e.jackpot_win_list.length;
};
t.prototype.onListRender = function(e, t) {
var o = this._taskList[t];
e.getComponent(C.default).refresh(this._aid, o, t);
};
t.prototype.refreshItemExchange = function() {
this._taskList = v.FestivalProxy.Instance.getTaskByUI(this._aid, 1);
if (this._taskList) {
this.ExchangeTaskList.numItems = this._taskList.length;
for (var e = !1, t = 0; t < this._taskList.length; t++) if (this._taskList[t].count >= this._taskList[t].target) {
e = !0;
break;
}
var o = v.FestivalProxy.Instance.getActivityState(this._aid);
this.ExchangeTips.active = e && (2 == o || 3 == o);
this.ExchangeEnd.active = !e && (2 == o || 3 == o);
}
};
t.prototype.refreshOptionalCount = function() {
var e = v.FestivalProxy.Instance.getOptionalItemCount(this._aid);
this.OptionalItemCount.node.parent.active = e > 0;
this.OptionalItemCount.string = e.toString();
};
t.prototype.playLotoAnimation = function() {};
t.prototype.refreshDate = function() {
var e = v.FestivalProxy.Instance.getAllAct(this._aid);
if (e) {
var t = u.Tools.TDate.format(1e3 * e.time_start, "MM dd", !0), o = u.Tools.TDate.format(1e3 * e.time_stop, "MM dd", !0), n = u.Tools.TDate.format(1e3 * e.time_end, "MM dd", !0);
1 == e.state ? this.DateLabel.string = "(" + t + " - " + o + ")" : this.DateLabel.string = u.Tools.TStr.replaceAll(c.default.getString("FESTIVAL_TIME_END"), "%{time}", n);
}
};
t.prototype.initLotoItem = function() {};
t.prototype.refreshLotoTitle = function() {
var e = v.FestivalProxy.Instance.getActData(this._aid);
this.LotoTitle.string = u.Tools.TStr.replaceAll(c.default.getString("FESTIVAL_LOTO_TIPS_" + this._aid), "%{count}", e.loto_item.length);
this.LotoOneTitle.string = c.default.getString("FESTIVAL_LOTO_ONE_" + this._aid);
this.LotoTenTitle.string = c.default.getString("FESTIVAL_LOTO_TEN_" + this._aid);
};
t.prototype.refreshLotoItem = function() {
for (var e = v.FestivalProxy.Instance.getActData(this._aid), t = v.FestivalProxy.Instance.getOptionalItemCount(this._aid), o = 0; o < e.loto_item.length; o++) {
var n = e.loto_item[o], a = v.FestivalProxy.Instance.getUserItemCount(this._aid, n.id), i = this._items[o];
i.AddButton.active = !0;
i.AddIcon.active = 0 == a && t > 0;
i.CornerCount.node.active = a > 0;
i.Mask.active = a <= 0;
i.setCount(a);
}
};
t.prototype.onJackpotHelpClicked = function() {
m.PopHelper.Instance.showTips(c.default.getString("FESTIVAL_JACKPOT_HELP_" + this._aid));
};
t.prototype.onRechargeClicked = function() {
y.default.Instance.openRecharge();
};
t.prototype.onTaskClicked = function() {};
t.prototype.onOptionalClicked = function() {};
t.prototype.onLotoClicked = function(e, t) {
var o = parseInt(t);
if (v.FestivalProxy.Instance.checkLoto(this._aid, o)) {
this.LotoOneButton.interactable = !1;
this.LotoTenButton.interactable = !1;
v.FestivalProxy.Instance.sendActLoto(this._aid, o);
} else m.PopHelper.Instance.showTips(c.default.getString("FESTIVAL_NO_MATERIAL"));
};
t.prototype.onCloseClicked = function() {
d.default.Instance.stopBGM();
d.default.Instance.playBGMBundle(r.BundleSoundPath.bgm_lobby);
h.default.Instance.removeLayer(this.node);
};
i([ E(cc.Label) ], t.prototype, "Jackpot", void 0);
i([ E([ cc.Label ]) ], t.prototype, "JackpotUsers", void 0);
i([ E(cc.Node) ], t.prototype, "JackpotNone", void 0);
i([ E(f.default) ], t.prototype, "ExchangeTaskList", void 0);
i([ E(cc.Node) ], t.prototype, "ExchangeTips", void 0);
i([ E(cc.Node) ], t.prototype, "ExchangeEnd", void 0);
i([ E(sp.Skeleton) ], t.prototype, "Effect", void 0);
i([ E(cc.Node) ], t.prototype, "EffectMask", void 0);
i([ E(cc.Prefab) ], t.prototype, "Item", void 0);
i([ E(cc.Label) ], t.prototype, "LotoTitle", void 0);
i([ E(cc.Node) ], t.prototype, "LotoItemParent", void 0);
i([ E(cc.Label) ], t.prototype, "LotoOneTitle", void 0);
i([ E(cc.Label) ], t.prototype, "LotoTenTitle", void 0);
i([ E(cc.Button) ], t.prototype, "LotoOneButton", void 0);
i([ E(cc.Button) ], t.prototype, "LotoTenButton", void 0);
i([ E(cc.Label) ], t.prototype, "DateLabel", void 0);
i([ E(cc.Label) ], t.prototype, "OptionalItemCount", void 0);
i([ E(_.default) ], t.prototype, "TaskReddot", void 0);
i([ E(_.default) ], t.prototype, "LotoReddot", void 0);
return i([ I ], t);
}(cc.Component);
o.default = S;
cc._RF.pop();
}, {
"../../../Game/client/global/enum/game/Const": "Const",
"../../../Game/client/global/enum/game/Event": "Event",
"../../../Game/client/global/enum/game/Game": "Game",
"../../../Game/client/model/LanguageModel": "LanguageModel",
"../../../Game/fromework/global/Tools": "Tools",
"../../../Game/fromework/helper/AudioHelper": "AudioHelper",
"../../../Game/fromework/helper/EventHelper": "EventHelper",
"../../../Game/fromework/helper/UIHelper": "UIHelper",
"../../../fromework/component/TableView/TableList": "TableList",
"../../component/RedDot": "RedDot",
"../../global/PopHelper": "PopHelper",
"../../logic/Wallet/WalletHelper": "WalletHelper",
"../Common/FestivalEvent": "FestivalEvent",
"../Common/FestivalModel": "FestivalModel",
"./FestivalRandomItem": "FestivalRandomItem"
} ],
FinishDeck: [ function(e, t, o) {
"use strict";
cc._RF.push(t, "c0665o02OBLno/4CjOmC4R0", "FinishDeck");
var n, a = this && this.__extends || (n = function(e, t) {
return (n = Object.setPrototypeOf || {
__proto__: []
} instanceof Array && function(e, t) {
e.__proto__ = t;
} || function(e, t) {
for (var o in t) Object.prototype.hasOwnProperty.call(t, o) && (e[o] = t[o]);
})(e, t);
}, function(e, t) {
n(e, t);
function o() {
this.constructor = e;
}
e.prototype = null === t ? Object.create(t) : (o.prototype = t.prototype, new o());
}), i = this && this.__decorate || function(e, t, o, n) {
var a, i = arguments.length, r = i < 3 ? t : null === n ? n = Object.getOwnPropertyDescriptor(t, o) : n;
if ("object" == typeof Reflect && "function" == typeof Reflect.decorate) r = Reflect.decorate(e, t, o, n); else for (var l = e.length - 1; l >= 0; l--) (a = e[l]) && (r = (i < 3 ? a(r) : i > 3 ? a(t, o, r) : a(t, o)) || r);
return i > 3 && r && Object.defineProperty(t, o, r), r;
};
Object.defineProperty(o, "__esModule", {
value: !0
});
var r = e("../../../Game/client/global/enum/game/Const"), l = cc._decorator, s = l.ccclass, c = l.property, u = function(e) {
a(t, e);
function t() {
var t = null !== e && e.apply(this, arguments) || this;
t.show = null;
t.lblFinish = null;
t.lightBorder = null;
return t;
}
t.prototype.reset = function() {
this.show.active = !1;
this.lightBorder.active = !1;
};
t.prototype.setSlotActive = function(e) {
this.show.active = e;
};
t.prototype.getFinishDeckPosInTarget = function(e) {
var t = this.node.parent.convertToWorldSpaceAR(this.node.getPosition());
return e.convertToNodeSpaceAR(t);
};
t.prototype.setLightBorderActive = function(e) {
this.lightBorder.active = e;
};
t.prototype.otherUserFinishAction = function(e, t, o) {
e.open = !1;
e.node.setPosition(t);
e.node.scale = r.OTHER_CARD_SCALE;
e.node.active = !0;
var n = this.node.parent.convertToWorldSpaceAR(this.node.getPosition()), a = e.node.parent.convertToNodeSpaceAR(n), i = cc.sequence(cc.spawn(cc.moveTo(.1, a), cc.scaleTo(.1, r.DESK_CARD_SCALE)), cc.delayTime(.1), cc.callFunc(function() {
e.open = !0;
o && o();
}));
e.node.runAction(i);
};
t.prototype.selfFinishAction = function(e, t) {
e.open = !0;
e.node.scale = r.HAND_CARD_SCALE;
e.node.active = !0;
var o = this.node.parent.convertToWorldSpaceAR(this.node.getPosition()), n = e.node.parent.convertToNodeSpaceAR(o), a = cc.sequence(cc.spawn(cc.moveTo(.1, n), cc.scaleTo(.1, r.DESK_CARD_SCALE)), cc.delayTime(.1), cc.callFunc(function() {
t && t();
}));
e.node.runAction(a);
};
t.prototype.finishMoveToOpen = function(e, t, o) {
e.node.setPosition(this.getFinishDeckPosInTarget(e.node.parent));
e.node.scale = r.DESK_CARD_SCALE;
e.open = !0;
e.node.active = !0;
var n = cc.sequence(cc.moveTo(.1, t), cc.callFunc(function() {
o && o();
}));
e.node.runAction(n);
};
i([ c(cc.Node) ], t.prototype, "show", void 0);
i([ c(cc.Label) ], t.prototype, "lblFinish", void 0);
i([ c(cc.Node) ], t.prototype, "lightBorder", void 0);
return i([ s ], t);
}(cc.Component);
o.default = u;
cc._RF.pop();
}, {
"../../../Game/client/global/enum/game/Const": "Const"
} ],
FirstAward: [ function(e, t, o) {
"use strict";
cc._RF.push(t, "a5414AGm/hLG6mJOfbnDqEi", "FirstAward");
var n, a = this && this.__extends || (n = function(e, t) {
return (n = Object.setPrototypeOf || {
__proto__: []
} instanceof Array && function(e, t) {
e.__proto__ = t;
} || function(e, t) {
for (var o in t) Object.prototype.hasOwnProperty.call(t, o) && (e[o] = t[o]);
})(e, t);
}, function(e, t) {
n(e, t);
function o() {
this.constructor = e;
}
e.prototype = null === t ? Object.create(t) : (o.prototype = t.prototype, new o());
}), i = this && this.__decorate || function(e, t, o, n) {
var a, i = arguments.length, r = i < 3 ? t : null === n ? n = Object.getOwnPropertyDescriptor(t, o) : n;
if ("object" == typeof Reflect && "function" == typeof Reflect.decorate) r = Reflect.decorate(e, t, o, n); else for (var l = e.length - 1; l >= 0; l--) (a = e[l]) && (r = (i < 3 ? a(r) : i > 3 ? a(t, o, r) : a(t, o)) || r);
return i > 3 && r && Object.defineProperty(t, o, r), r;
};
Object.defineProperty(o, "__esModule", {
value: !0
});
var r = e("../../../../Game/fromework/helper/UIHelper"), l = e("../../../../Game/fromework/mvvm/modelView/ViewModel"), s = e("../../../model/LobbyModel"), c = e("../../active/ActiveManager"), u = cc._decorator, d = u.ccclass, p = u.property, h = function(e) {
a(t, e);
function t() {
var t = null !== e && e.apply(this, arguments) || this;
t.PlayButton = null;
return t;
}
t.prototype.onLoad = function() {
var e = l.VM.getValue("user.guide_rtype");
this.PlayButton.active = e && "" != e;
};
t.prototype.onCloseClicked = function() {
r.default.Instance.removeMaskLayer(this.node);
c.default.Instance.openLoginActiveAlert();
};
t.prototype.onPlayBtnClicked = function() {
var e = l.VM.getValue("user.guide_rtype");
e && "" != e && s.default.Instance.sendJoinRoom(e);
r.default.Instance.removeMaskLayer(this.node);
};
i([ p(cc.Node) ], t.prototype, "PlayButton", void 0);
return i([ d ], t);
}(cc.Component);
o.default = h;
cc._RF.pop();
}, {
"../../../../Game/fromework/helper/UIHelper": "UIHelper",
"../../../../Game/fromework/mvvm/modelView/ViewModel": "ViewModel",
"../../../model/LobbyModel": "LobbyModel",
"../../active/ActiveManager": "ActiveManager"
} ],
FirstCharge: [ function(e, t, o) {
"use strict";
cc._RF.push(t, "9dbc4hwWthGeIM+bF/JgdrT", "FirstCharge");
var n, a = this && this.__extends || (n = function(e, t) {
return (n = Object.setPrototypeOf || {
__proto__: []
} instanceof Array && function(e, t) {
e.__proto__ = t;
} || function(e, t) {
for (var o in t) Object.prototype.hasOwnProperty.call(t, o) && (e[o] = t[o]);
})(e, t);
}, function(e, t) {
n(e, t);
function o() {
this.constructor = e;
}
e.prototype = null === t ? Object.create(t) : (o.prototype = t.prototype, new o());
}), i = this && this.__decorate || function(e, t, o, n) {
var a, i = arguments.length, r = i < 3 ? t : null === n ? n = Object.getOwnPropertyDescriptor(t, o) : n;
if ("object" == typeof Reflect && "function" == typeof Reflect.decorate) r = Reflect.decorate(e, t, o, n); else for (var l = e.length - 1; l >= 0; l--) (a = e[l]) && (r = (i < 3 ? a(r) : i > 3 ? a(t, o, r) : a(t, o)) || r);
return i > 3 && r && Object.defineProperty(t, o, r), r;
};
Object.defineProperty(o, "__esModule", {
value: !0
});
var r = e("../../../../Game/client/global/enum/game/Event"), l = e("../../../../Game/client/model/CommonModel"), s = e("../../../../Game/client/model/LanguageModel"), c = e("../../../../Game/fromework/helper/EventHelper"), u = e("../../../global/PopHelper"), d = e("../../../model/WalletModel"), p = e("../../Wallet/WalletHelper"), h = cc._decorator, f = h.ccclass, _ = h.property, m = function(e) {
a(t, e);
function t() {
var t = null !== e && e.apply(this, arguments) || this;
t.AlertPanel = null;
t.Deposit = null;
t.Bonus = null;
t.PayMoney = null;
t._cashData = null;
t._data = null;
t._amount = 0;
return t;
}
t.prototype.onEnable = function() {
c.default.Instance.Global.bind(r.WalletEvent.RECHARGE_GET_GOODS, this.refreshView, this);
};
t.prototype.onDisable = function() {
c.default.Instance.Global.unbind(r.WalletEvent.RECHARGE_GET_GOODS, this.refreshView, this);
};
t.prototype.onDestroy = function() {
this.unscheduleAllCallbacks();
};
t.prototype.show = function(e, t) {
this._data = e;
this._amount = t;
d.WalletProxy.Instance.sendGetRechargeGoods(e.id, []);
this.openAction();
};
t.prototype.close = function() {
this.unscheduleAllCallbacks();
this.closeAction(function() {});
};
t.prototype.refreshView = function() {
var e = d.WalletProxy.Instance.getRechargeAmountRate(this._data.id, this._amount);
if (e) {
this._cashData = new l.Common.AddCashData();
this._cashData.amount = this._amount;
this._cashData.deposit = e.deposit;
this._cashData.bonus = e.bonus;
this.Deposit.string = (this._cashData.deposit + this._cashData.amount).toString();
this.Bonus.string = this._cashData.bonus.toString();
this.PayMoney.string = s.default.getString("MoneySymbol") + this._cashData.amount;
} else this.close();
};
t.prototype.openAction = function() {
this.AlertPanel.setPosition(cc.v2(0, this.node.height / 2 + this.AlertPanel.height / 2));
this.AlertPanel.runAction(cc.moveTo(.1, cc.v2(0, 0)));
};
t.prototype.closeAction = function(e) {
var t = this, o = cc.moveTo(.1, cc.v2(0, -(this.node.height / 2 + this.AlertPanel.height / 2))), n = cc.callFunc(function() {
e && e.apply(t);
t.node.removeFromParent(!0);
t.node.destroy();
}), a = cc.sequence(o, n);
this.AlertPanel.runAction(a);
};
t.prototype.onPayButtonClicked = function() {
var e = this;
if (this._cashData) {
var t = this._cashData.amount, o = this._data ? this._data.id : 0;
d.WalletProxy.Instance.sendPayment(t, o, this._cashData.deposit, this._cashData.bonus, function(t) {
var o = JSON.parse(t.response);
p.default.Instance.onPayment(o);
1 == o.code && e.close();
});
} else u.PopHelper.Instance.showTips(s.default.getString("RECHARGE_INPUT_TIPS1"));
};
t.prototype.onBackClicked = function() {
this.close();
};
i([ _(cc.Node) ], t.prototype, "AlertPanel", void 0);
i([ _(cc.Label) ], t.prototype, "Deposit", void 0);
i([ _(cc.Label) ], t.prototype, "Bonus", void 0);
i([ _(cc.Label) ], t.prototype, "PayMoney", void 0);
return i([ f ], t);
}(cc.Component);
o.default = m;
cc._RF.pop();
}, {
"../../../../Game/client/global/enum/game/Event": "Event",
"../../../../Game/client/model/CommonModel": "CommonModel",
"../../../../Game/client/model/LanguageModel": "LanguageModel",
"../../../../Game/fromework/helper/EventHelper": "EventHelper",
"../../../global/PopHelper": "PopHelper",
"../../../model/WalletModel": "WalletModel",
"../../Wallet/WalletHelper": "WalletHelper"
} ],
Fromework: [ function(e, t, o) {
"use strict";
cc._RF.push(t, "3d31fQPuLdD5JnZ0wdiCkiU", "Fromework");
var n, a = this && this.__extends || (n = function(e, t) {
return (n = Object.setPrototypeOf || {
__proto__: []
} instanceof Array && function(e, t) {
e.__proto__ = t;
} || function(e, t) {
for (var o in t) Object.prototype.hasOwnProperty.call(t, o) && (e[o] = t[o]);
})(e, t);
}, function(e, t) {
n(e, t);
function o() {
this.constructor = e;
}
e.prototype = null === t ? Object.create(t) : (o.prototype = t.prototype, new o());
}), i = this && this.__decorate || function(e, t, o, n) {
var a, i = arguments.length, r = i < 3 ? t : null === n ? n = Object.getOwnPropertyDescriptor(t, o) : n;
if ("object" == typeof Reflect && "function" == typeof Reflect.decorate) r = Reflect.decorate(e, t, o, n); else for (var l = e.length - 1; l >= 0; l--) (a = e[l]) && (r = (i < 3 ? a(r) : i > 3 ? a(t, o, r) : a(t, o)) || r);
return i > 3 && r && Object.defineProperty(t, o, r), r;
};
Object.defineProperty(o, "__esModule", {
value: !0
});
o.Global = o.GroundState = void 0;
var r, l = e("./helper/EventHelper"), s = e("./helper/AudioHelper"), c = e("./helper/ConfigHelper"), u = e("./helper/UIHelper"), d = cc._decorator, p = d.ccclass, h = (d.property, 
d.menu);
cc.Button.prototype.changeInteractable = function(e, t) {
!this.__disabledSprite && t && (this.__disabledSprite = t);
this.__normalSprite || (this.__normalSprite = this._sprite.spriteFrame);
this.interactable = e;
if (e) this._sprite.spriteFrame = this.__normalSprite; else {
if (!t) return;
this._sprite.spriteFrame = this.__disabledSprite;
}
};
(function(e) {
e[e.MAIN = 0] = "MAIN";
e[e.SHOW = 1] = "SHOW";
e[e.HIDE = 2] = "HIDE";
e[e.MAX = 3] = "MAX";
})(r = o.GroundState || (o.GroundState = {}));
var f = function() {
function e() {
this._groundState = 0;
this._groundState = 0;
}
Object.defineProperty(e, "Instance", {
get: function() {
if (e._Instance) return e._Instance;
e._Instance = new e();
return e._Instance;
},
enumerable: !1,
configurable: !0
});
Object.defineProperty(e.prototype, "GroundState", {
get: function() {
return this._groundState;
},
enumerable: !1,
configurable: !0
});
e.prototype.init = function() {
this._groundState = r.SHOW;
};
e.prototype.onShow = function() {
this._groundState = r.SHOW;
};
e.prototype.onHide = function() {
this._groundState = r.HIDE;
};
e._Instance = null;
return e;
}();
o.Global = f;
var _ = function(e) {
a(t, e);
function t() {
return null !== e && e.apply(this, arguments) || this;
}
t.prototype._onGameShow = function() {
cc.audioEngine.resumeAll();
f.Instance.onShow();
};
t.prototype._onGameHide = function() {
cc.audioEngine.pauseAll();
f.Instance.onHide();
};
t.prototype.onLoad = function() {
l.default.Instance.Net.start(!0);
l.default.Instance.Global.start(!0);
s.default.Instance.init();
c.ConfigHelper.Instance.init();
u.default.Instance.init();
f.Instance.init();
cc.game.on(cc.game.EVENT_SHOW, this._onGameShow.bind(this));
cc.game.on(cc.game.EVENT_HIDE, this._onGameHide.bind(this));
};
t.prototype.onEnable = function() {};
t.prototype.onDisable = function() {};
t.prototype.onDestroy = function() {
cc.game.off(cc.game.EVENT_SHOW, this._onGameShow.bind(this));
cc.game.off(cc.game.EVENT_HIDE, this._onGameHide.bind(this));
};
t.prototype.start = function() {};
return i([ p, h("Fromework(框架初始化)") ], t);
}(cc.Component);
o.default = _;
cc._RF.pop();
}, {
"./helper/AudioHelper": "AudioHelper",
"./helper/ConfigHelper": "ConfigHelper",
"./helper/EventHelper": "EventHelper",
"./helper/UIHelper": "UIHelper"
} ],
GameHead: [ function(e, t, o) {
"use strict";
cc._RF.push(t, "22070mFNZhHZoc4kH7C/QzS", "GameHead");
var n, a = this && this.__extends || (n = function(e, t) {
return (n = Object.setPrototypeOf || {
__proto__: []
} instanceof Array && function(e, t) {
e.__proto__ = t;
} || function(e, t) {
for (var o in t) Object.prototype.hasOwnProperty.call(t, o) && (e[o] = t[o]);
})(e, t);
}, function(e, t) {
n(e, t);
function o() {
this.constructor = e;
}
e.prototype = null === t ? Object.create(t) : (o.prototype = t.prototype, new o());
}), i = this && this.__decorate || function(e, t, o, n) {
var a, i = arguments.length, r = i < 3 ? t : null === n ? n = Object.getOwnPropertyDescriptor(t, o) : n;
if ("object" == typeof Reflect && "function" == typeof Reflect.decorate) r = Reflect.decorate(e, t, o, n); else for (var l = e.length - 1; l >= 0; l--) (a = e[l]) && (r = (i < 3 ? a(r) : i > 3 ? a(t, o, r) : a(t, o)) || r);
return i > 3 && r && Object.defineProperty(t, o, r), r;
};
Object.defineProperty(o, "__esModule", {
value: !0
});
var r = e("../../Game/client/global/enum/game/Const"), l = e("../../Game/client/global/enum/game/Event"), s = e("../../Game/client/global/enum/game/Game"), c = e("../../Game/client/global/enum/game/UIUtils"), u = e("../../Game/client/model/LanguageModel"), d = e("../../Game/fromework/global/Tools"), p = e("../../Game/fromework/helper/AudioHelper"), h = e("../../Game/fromework/helper/EventHelper"), f = e("../../Game/fromework/mvvm/modelView/ViewModel"), _ = e("../../platform/Platform"), m = e("../model/GameModel"), y = e("../model/LobbyModel"), g = cc._decorator, v = g.ccclass, C = g.property, b = function(e) {
a(t, e);
function t() {
var t = null !== e && e.apply(this, arguments) || this;
t.userName = null;
t.ReadyIcon = null;
t.timeProgress = null;
t.userHead = null;
t.lCountDown = null;
t.gCountDown = null;
t.dSeat = null;
t.hasUser = null;
t.empty = null;
t.orderCardPos = null;
t.drawCardPos = null;
t.state = null;
t.Frame_CurHead = [];
t.PTSScore = null;
t.WinBorder = null;
t.isSelfHead = !1;
t._isCountDown = !1;
t._countDownTime = 0;
t._userData = null;
t._headUrl = "";
t._isFree = !0;
return t;
}
Object.defineProperty(t.prototype, "userData", {
get: function() {
return this._userData;
},
enumerable: !1,
configurable: !0
});
Object.defineProperty(t.prototype, "isFree", {
get: function() {
return this._isFree;
},
set: function(e) {
this._isFree = e;
e && this.reset();
},
enumerable: !1,
configurable: !0
});
t.prototype.reset = function() {
this.setEmpty(!0);
this.userName.string = "";
this._setTimeNodeActive(!1);
};
t.prototype.refreshState = function(e, t, o) {
void 0 === o && (o = 0);
this.WinBorder.active = 1 == e && 1 == t;
if (0 == e) {
this.state.node.parent.active = !0;
this.state.string = u.default.getString("TABLE_WAIT");
} else if (1 == e) if (2 == t || 3 == t) {
this.state.node.parent.active = !0;
this.state.string = u.default.getString("TABLE_DROPPED") + "\n" + o;
} else {
this.state.node.parent.active = !1;
this.state.string = "";
} else if (2 == e) {
this.state.node.parent.active = !0;
this.state.string = u.default.getString("TABLE_DROPPED") + "\n" + o;
} else if (3 == e) {
this.state.node.parent.active = !0;
this.state.string = u.default.getString("TABLE_DROPPED") + "\n" + o;
} else if (4 == e) {
this.state.node.parent.active = !0;
this.state.string = u.default.getString("GAME_USER_STATE_OUT");
} else if (5 == e) {
this.state.node.parent.active = !0;
this.state.string = u.default.getString("GAME_USER_STATE_AUTO");
}
};
t.prototype.startCountDown = function(e, t, o, n) {
var a = this;
void 0 === n && (n = !1);
if (!this._isCountDown) {
this._isCountDown = !0;
this._setTimeNodeActive(!0);
this.timeProgress.fillRange = 1;
this.timeProgress.node.color = cc.color(255, 241, 10);
var i = n ? t : e, s = this._countDownTime = Math.floor(i), c = Math.floor(.75 * this._countDownTime), u = this._countDownTime - c, d = 1 / this._countDownTime;
this.lCountDown.string = String(s);
this.gCountDown.string = String(t);
var m = cc.tween(this.timeProgress.node).to(u, {
color: cc.color(224, 35, 35)
}), y = cc.tween(this.timeProgress).call(function() {
a.lCountDown.string = String(s);
if (n) {
a.gCountDown.string = String(s);
if (a.isSelfHead && 5 == s) {
p.default.Instance.playBundleEffect(r.BundleSoundPath.rummy_five_seconds);
f.VM.getValue("lobbySet.isPlayVibration") && _.default.vibrator();
}
}
a.isSelfHead && h.default.Instance.Global.emit(l.GameEvent.SELF_HEAD_COUNTDOWN, {
isFaultTime: n,
countDown: s
});
--s == u && m.start();
}).by(1, {
fillRange: -d
});
cc.tween(this.timeProgress).repeat(s, y).call(function() {
a.lCountDown.string = "0";
n && (a.gCountDown.string = "0");
a._isCountDown = !1;
o && o();
}).start();
}
};
t.prototype._setTimeNodeActive = function(e) {
this.timeProgress.node.active = e;
this.lCountDown.node.parent.active = e;
this.gCountDown.node.parent.active = e;
if (!e) {
cc.Tween.stopAllByTarget(this.timeProgress);
cc.Tween.stopAllByTarget(this.timeProgress.node);
this.timeProgress.node.color = cc.color(255, 241, 10);
this.timeProgress.fillRange = 1;
this._isCountDown = !1;
}
};
t.prototype._setUserHeadImg = function(e) {
var t = !e.sex || 1 == e.sex, o = e.head_url;
_.default.log("GameHeadUrl:" + o);
if (null != o && "" != o) {
if (this._headUrl != o) {
this._headUrl = o;
c.UIUtils.updateHeadImage(o, this.userHead, cc.size(128, 128));
}
} else this.userHead.spriteFrame = t ? this.Frame_CurHead[0] : this.Frame_CurHead[1];
};
t.prototype.init = function(e, t) {
void 0 === t && (t = !0);
if (e) {
this.userName.string = d.Tools.TStr.ellipsisString(e.name, 12);
this.setEmpty(!1, t);
this._setTimeNodeActive(!1);
this._setUserHeadImg(e);
this.setPTSScore(e.tscore);
} else this.reset();
};
t.prototype.setDSeat = function(e) {
this.dSeat.active != e && (this.dSeat.active = e);
};
t.prototype.setEmpty = function(e, t) {
void 0 === t && (t = !0);
var o = e ? this.hasUser : this.empty, n = e ? this.empty : this.hasUser;
if (t) {
o.stopAllActions();
o.opacity = 255;
o.setPosition(cc.v2(0, 0));
o.active = !0;
n.stopAllActions();
n.opacity = 0;
n.setPosition(cc.v2(0, 100));
n.active = !0;
var a = cc.sequence(cc.spawn(cc.moveTo(.3, cc.v2(0, 0)), cc.fadeIn(.3)), cc.callFunc(function() {
n.active = !0;
n.opacity = 255;
n.setPosition(cc.v2(0, 0));
})), i = cc.sequence(cc.spawn(cc.moveTo(.3, cc.v2(0, 100)), cc.fadeOut(.3)), cc.callFunc(function() {
o.active = !1;
o.opacity = 255;
o.setPosition(cc.v2(0, 0));
n.runAction(a);
}));
o.runAction(i);
} else {
o.stopAllActions();
n.stopAllActions();
o.opacity = 255;
n.opacity = 255;
o.active = !1;
n.active = !0;
}
};
t.prototype.showCountDown = function(e, t, o) {
var n = this;
this.startCountDown(e, t, function() {
n.startCountDown(e, t, function() {
o && o();
}, !0);
}, !1);
};
t.prototype.hideCountDown = function() {
this._setTimeNodeActive(!1);
};
t.prototype.setPTSScore = function(e) {
if (this.PTSScore) {
var t = m.RoomModelManager.Instance.getModel(), o = y.default.Instance.getGamePlay(t.roomData.rtype);
if (this.isSelfHead || !o || o.cls != s.GameEnum.PlayType.RUMMY_POOL && o.cls != s.GameEnum.PlayType.RUMMY_DEALS) this.PTSScore.node.parent.active = !1; else {
this.PTSScore.node.parent.active = !0;
this.PTSScore.string = u.default.getString("GAME_HEAD_PTS") + e;
}
}
};
t.prototype.setReadyIcon = function(e) {
this.ReadyIcon.active = e;
};
i([ C(cc.Label) ], t.prototype, "userName", void 0);
i([ C(cc.Node) ], t.prototype, "ReadyIcon", void 0);
i([ C(cc.Sprite) ], t.prototype, "timeProgress", void 0);
i([ C(cc.Sprite) ], t.prototype, "userHead", void 0);
i([ C(cc.Label) ], t.prototype, "lCountDown", void 0);
i([ C(cc.Label) ], t.prototype, "gCountDown", void 0);
i([ C(cc.Node) ], t.prototype, "dSeat", void 0);
i([ C(cc.Node) ], t.prototype, "hasUser", void 0);
i([ C(cc.Node) ], t.prototype, "empty", void 0);
i([ C(cc.Node) ], t.prototype, "orderCardPos", void 0);
i([ C(cc.Node) ], t.prototype, "drawCardPos", void 0);
i([ C(cc.Label) ], t.prototype, "state", void 0);
i([ C([ cc.SpriteFrame ]) ], t.prototype, "Frame_CurHead", void 0);
i([ C(cc.Label) ], t.prototype, "PTSScore", void 0);
i([ C(cc.Node) ], t.prototype, "WinBorder", void 0);
i([ C(cc.Boolean) ], t.prototype, "isSelfHead", void 0);
return i([ v ], t);
}(cc.Component);
o.default = b;
cc._RF.pop();
}, {
"../../Game/client/global/enum/game/Const": "Const",
"../../Game/client/global/enum/game/Event": "Event",
"../../Game/client/global/enum/game/Game": "Game",
"../../Game/client/global/enum/game/UIUtils": "UIUtils",
"../../Game/client/model/LanguageModel": "LanguageModel",
"../../Game/fromework/global/Tools": "Tools",
"../../Game/fromework/helper/AudioHelper": "AudioHelper",
"../../Game/fromework/helper/EventHelper": "EventHelper",
"../../Game/fromework/mvvm/modelView/ViewModel": "ViewModel",
"../../platform/Platform": "Platform",
"../model/GameModel": "GameModel",
"../model/LobbyModel": "LobbyModel"
} ],
GameHelper: [ function(e, t, o) {
"use strict";
cc._RF.push(t, "e5be0HiT2FLXo4pAHN0uWu6", "GameHelper");
Object.defineProperty(o, "__esModule", {
value: !0
});
o.Countdown = o.GroupHelper = void 0;
var n = e("../../../../Game/client/global/enum/game/Const"), a = e("../../../../Game/client/global/enum/game/Game"), i = e("../../../../platform/Platform"), r = e("./sort/AutoSort");
(function(e) {
e.GroupDefaultWidth = function() {
var e = cc.winSize;
return e.height / e.width > .462 ? n.GROUP_DEFAULT_WIDTH_NARROW : n.GROUP_DEFAULT_WIDTH;
};
e.CardWidth = function() {
var e = cc.winSize;
return e.height / e.width > .462 ? n.CARD_WIDTH_NARROW : n.CARD_WIDTH;
};
e.CardShowWidth = function() {
var e = cc.winSize;
return e.height / e.width > .462 ? n.CARD_SHOW_WIDTH_NARROW : n.CARD_SHOW_WIDTH;
};
e.isBestDeclare = function(e, o, n, a) {
return t(e, o, n, a) <= t(r.default.Instance.getHands(e, o), o, n, a);
};
function t(e, t, n, i) {
var r = 0, l = !1, s = 0;
e.forEach(function(e) {
var n = o(e, t);
if (n == a.GameEnum.GroupType.PureSequence) {
l = !0;
r++;
} else n == a.GameEnum.GroupType.Sequence && r++;
});
e.forEach(function(e) {
var o = u(e, l, r, t, i);
s += o;
});
s > n && (s = n);
return s;
}
e.getTotalScore = t;
e.getPokerHands = function(e, t, n, i) {
var r = 0, l = !1, s = 0;
e.forEach(function(e) {
var n = o(e, t);
if (n == a.GameEnum.GroupType.PureSequence) {
l = !0;
r++;
} else n == a.GameEnum.GroupType.Sequence && r++;
});
e.forEach(function(e) {
var o = u(e, l, r, t, i);
s += o;
});
s > n && (s = n);
return {
hasPureSequence: l,
totalScore: s,
sequCount: r
};
};
function o(e, t) {
return p(e) ? a.GameEnum.GroupType.PureSequence : h(e, t) ? a.GameEnum.GroupType.Sequence : f(e, t) ? a.GameEnum.GroupType.Set : a.GameEnum.GroupType.Invalid;
}
e.getGroupType = o;
var i = !1;
e.isShowWildCard = function() {
return i;
};
e.setIsShowWildCard = function(e) {
i = e;
};
e.getIdx16 = function(e, t) {
return 16 * e + t;
};
function l(e) {
return 65 == e ? a.GameEnum.Pattern.LittleJoker : 66 == e ? a.GameEnum.Pattern.BigJoker : Math.floor(e / 16);
}
e.getPattern = l;
function s(e) {
return 65 == e || 66 == e;
}
e.isJoker = s;
function c(e) {
return e % 16;
}
e.getFigure = c;
function u(e, t, n, i, r) {
void 0 === t && (t = !1);
void 0 === n && (n = 0);
var l = 0, s = o(e, i);
s != a.GameEnum.GroupType.PureSequence && e.forEach(function(e) {
l += d(e, i) ? 0 : c(e) > 10 ? 10 : 1 == c(e) ? 10 : c(e);
});
t && s == a.GameEnum.GroupType.Sequence && (l = 0);
t && n >= (10 == r ? 1 : 2) && s == a.GameEnum.GroupType.Set && (l = 0);
return l;
}
e.getScore = u;
e.setWildCard = function(e) {
s(e);
};
function d(e, t) {
return c(t) == c(e) || s(e);
}
e.checkWild = d;
function p(e) {
if (e.length < 3) return !1;
for (var t = l(e[0]), o = 1, n = 13, a = e.length, i = 0, r = 0, s = 12, u = !1, d = !1, p = !1, h = 0, f = 0; f < e.length; f++) {
var _ = e[f];
if (l(_) != t) return !1;
var m = c(_);
i += m;
r += m;
if ((1 << m & h) > 0) return !1;
h |= 1 << m;
m > o && (o = m);
m < n && (n = m);
1 != m && m < s && (s = m);
if (1 == m) {
p = !0;
r += 13;
} else 12 == m ? u = !0 : 13 == m && (d = !0);
}
if (u && d && p) {
if ((14 + s) * a / 2 != r) return !1;
if (14 - s != a - 1) return !1;
} else {
if ((o + n) * a / 2 != i) return !1;
if (o - n != a - 1) return !1;
}
return !0;
}
e.checkPureSequence = p;
function h(e, t) {
if (e.length < 3) return !1;
for (var o = !1, n = 0, a = l(e[0]), i = 0; i < e.length; i++) if (!d(e[i], t)) {
a = l(e[i]);
break;
}
var r = [], s = [];
for (i = 0; i < e.length; i++) {
var u = e[i], p = 0;
if (d(u, t)) o = !0; else {
if (l(u) != a) return !1;
if ((1 << (p = c(u)) & n) > 0) return !1;
n |= 1 << p;
}
if (d(u, t)) {
r.push(0);
s.push(0);
} else if (1 == p) {
r.push(14);
s.push(1);
} else {
r.push(p);
s.push(p);
}
}
if (!o) return !1;
r.sort(function(e, t) {
return e - t;
});
s.sort(function(e, t) {
return e - t;
});
for (var h = 1, f = 0, _ = 0, m = 0, y = 0; h < r.length && h < s.length; ) {
0 == r[f] && _++;
0 != r[f] && (m += r[h] - r[f] - 1);
0 != s[f] && (y += s[h] - s[f] - 1);
f = h;
++h;
}
return _ >= m || _ >= y;
}
e.checkSequence = h;
function f(e, t) {
if (e.length < 3) return !1;
for (var o = c(e[0]), n = 0, a = 0; a < e.length; a++) if (!d(e[a], t)) {
o = c(e[a]);
break;
}
for (a = 0; a < e.length; a++) {
var i = e[a];
if (!d(i, t)) {
if (c(i) != o) return !1;
if ((1 << l(i) & n) > 0) return !1;
n |= 1 << l(i);
}
}
return !0;
}
e.checkSet = f;
})(o.GroupHelper || (o.GroupHelper = {}));
var l = function() {
function e(e, t, o, n, a) {
this._time = 0;
this._progress = null;
this._complete = null;
this._target = null;
this._intervalId = 0;
this._tag = 0;
this._tag = e;
this._time = t;
this._progress = o || function() {};
this._complete = n || function() {};
this._target = a;
this._begin();
}
Object.defineProperty(e.prototype, "time", {
get: function() {
return this._time;
},
set: function(e) {
this._time = e;
-1 == this._time ? this._end(!1) : this._time <= -99 || this._time <= 0 && this._end();
},
enumerable: !1,
configurable: !0
});
e.prototype._begin = function() {
var e = this;
this._intervalId = setInterval(function() {
e.time--;
e._target ? e._progress.call(e._target, e._time) : e._progress(e._time);
i.default.log(e.time);
}, 1e3);
};
e.prototype._end = function(t) {
void 0 === t && (t = !0);
clearInterval(this._intervalId);
this._target ? this._complete.call(this._target, t) : this._complete(t);
e.ObjMap.has(this._tag) && e.ObjMap.delete(this._tag);
};
e.deleta = function(t, o) {
void 0 === o && (o = !0);
e.ObjMap.has(t) && (e.ObjMap.get(t).time = o ? 0 : -1);
};
e.creat = function(t, o, n, a) {
void 0 === n && (n = null);
void 0 === a && (a = null);
var i = ++e.TAG;
e.ObjMap.set(i, new e(i, t, n, o, a));
return e.TAG;
};
e.clear = function() {
e.ObjMap.forEach(function(e) {
e.time = -1;
});
};
e.ObjMap = new Map();
e.TAG = 0;
return e;
}();
o.Countdown = l;
cc._RF.pop();
}, {
"../../../../Game/client/global/enum/game/Const": "Const",
"../../../../Game/client/global/enum/game/Game": "Game",
"../../../../platform/Platform": "Platform",
"./sort/AutoSort": "AutoSort"
} ],
GameInfo: [ function(e, t, o) {
"use strict";
cc._RF.push(t, "ff2c7M2f9BIPr66R9LOQneC", "GameInfo");
var n, a = this && this.__extends || (n = function(e, t) {
return (n = Object.setPrototypeOf || {
__proto__: []
} instanceof Array && function(e, t) {
e.__proto__ = t;
} || function(e, t) {
for (var o in t) Object.prototype.hasOwnProperty.call(t, o) && (e[o] = t[o]);
})(e, t);
}, function(e, t) {
n(e, t);
function o() {
this.constructor = e;
}
e.prototype = null === t ? Object.create(t) : (o.prototype = t.prototype, new o());
}), i = this && this.__decorate || function(e, t, o, n) {
var a, i = arguments.length, r = i < 3 ? t : null === n ? n = Object.getOwnPropertyDescriptor(t, o) : n;
if ("object" == typeof Reflect && "function" == typeof Reflect.decorate) r = Reflect.decorate(e, t, o, n); else for (var l = e.length - 1; l >= 0; l--) (a = e[l]) && (r = (i < 3 ? a(r) : i > 3 ? a(t, o, r) : a(t, o)) || r);
return i > 3 && r && Object.defineProperty(t, o, r), r;
};
Object.defineProperty(o, "__esModule", {
value: !0
});
var r = e("../../../Game/client/model/LanguageModel"), l = e("../../../Game/fromework/helper/UIHelper"), s = e("../../../Game/fromework/mvvm/modelView/ViewModel"), c = e("../../model/GameModel"), u = cc._decorator, d = u.ccclass, p = u.property, h = function(e) {
a(t, e);
function t() {
var t = null !== e && e.apply(this, arguments) || this;
t.Panel = null;
t.TableId = null;
t.PrintedJoker = null;
t.GameId = null;
t.Jokers = null;
t.PointValue = null;
t.Variant = null;
t.NumberOfDecks = null;
t.Drop1 = null;
t.Drop2 = null;
t.Drop3 = null;
return t;
}
t.prototype.openAction = function() {
this.Panel.setPosition(cc.v2(0, this.node.height / 2 + this.Panel.height / 2));
this.Panel.runAction(cc.moveTo(.1, cc.v2(0, 0)));
};
t.prototype.closeAction = function(e) {
var t = this;
this.Panel.runAction(cc.sequence(cc.moveTo(.1, cc.v2(0, -(this.node.height / 2 + this.Panel.height / 2))), cc.callFunc(function() {
e && e();
l.default.Instance.removeMaskLayer(t.node);
})));
};
t.prototype.refreshView = function() {
var e = c.RoomModelManager.Instance.getModel();
e || this.closeAction();
this.TableId.string = s.VM.getValue("lobby.roomID");
this.PrintedJoker.string = r.default.getString("GAMEINFO_1PERDECK");
this.GameId.string = "";
this.Jokers.string = r.default.getString("GAMEINFO_JOKERS");
this.PointValue.string = e.roomData.base + "";
this.Variant.string = r.default.getString("GAMEINFO_VARIANT");
this.NumberOfDecks.string = r.default.getString("GAMEINFO_DECKS");
this.Drop1.string = r.default.getString("GAMEINFO_DROP1");
this.Drop2.string = r.default.getString("GAMEINFO_DROP2");
this.Drop3.string = r.default.getString("GAMEINFO_DROP3");
};
t.prototype.InitView = function() {
this.refreshView();
this.openAction();
};
t.prototype.onCloseClicked = function() {
this.closeAction();
};
i([ p(cc.Node) ], t.prototype, "Panel", void 0);
i([ p(cc.Label) ], t.prototype, "TableId", void 0);
i([ p(cc.Label) ], t.prototype, "PrintedJoker", void 0);
i([ p(cc.Label) ], t.prototype, "GameId", void 0);
i([ p(cc.Label) ], t.prototype, "Jokers", void 0);
i([ p(cc.Label) ], t.prototype, "PointValue", void 0);
i([ p(cc.Label) ], t.prototype, "Variant", void 0);
i([ p(cc.Label) ], t.prototype, "NumberOfDecks", void 0);
i([ p(cc.Label) ], t.prototype, "Drop1", void 0);
i([ p(cc.Label) ], t.prototype, "Drop2", void 0);
i([ p(cc.Label) ], t.prototype, "Drop3", void 0);
return i([ d ], t);
}(cc.Component);
o.default = h;
cc._RF.pop();
}, {
"../../../Game/client/model/LanguageModel": "LanguageModel",
"../../../Game/fromework/helper/UIHelper": "UIHelper",
"../../../Game/fromework/mvvm/modelView/ViewModel": "ViewModel",
"../../model/GameModel": "GameModel"
} ],
GameManager: [ function(e, t, o) {
"use strict";
cc._RF.push(t, "b8c69VFAg1FW5BbQMNDkPzj", "GameManager");
var n, a = this && this.__extends || (n = function(e, t) {
return (n = Object.setPrototypeOf || {
__proto__: []
} instanceof Array && function(e, t) {
e.__proto__ = t;
} || function(e, t) {
for (var o in t) Object.prototype.hasOwnProperty.call(t, o) && (e[o] = t[o]);
})(e, t);
}, function(e, t) {
n(e, t);
function o() {
this.constructor = e;
}
e.prototype = null === t ? Object.create(t) : (o.prototype = t.prototype, new o());
}), i = this && this.__decorate || function(e, t, o, n) {
var a, i = arguments.length, r = i < 3 ? t : null === n ? n = Object.getOwnPropertyDescriptor(t, o) : n;
if ("object" == typeof Reflect && "function" == typeof Reflect.decorate) r = Reflect.decorate(e, t, o, n); else for (var l = e.length - 1; l >= 0; l--) (a = e[l]) && (r = (i < 3 ? a(r) : i > 3 ? a(t, o, r) : a(t, o)) || r);
return i > 3 && r && Object.defineProperty(t, o, r), r;
};
Object.defineProperty(o, "__esModule", {
value: !0
});
var r = e("../../../client/model/GameModel"), l = e("../../../client/teenpatti/model/TeenPattiModel"), s = e("../../AndarBahar/Script/ABModel"), c = e("../../DragonVSTiger/Script/DTModel"), u = e("../../LuckyDice/Script/LuckyDiceModel"), d = e("../../RedAndBlack/Script/RBModel"), p = e("../../Roulette/Script/RouletteModel"), h = e("../../SevenUpDown/Script/SUDModel"), f = e("../../TPWar/Script/TPWarModel"), _ = e("../../TraditionAndarBahar/Script/TraditionABModel"), m = e("../Utils/CompositeConst"), y = e("../Utils/CompositeUtil"), g = cc._decorator, v = g.ccclass, C = g.property, b = function(e) {
a(t, e);
function t() {
var t = null !== e && e.apply(this, arguments) || this;
t.GameMethod = m.PlayMethod.AndarBahar;
return t;
}
Object.defineProperty(t.prototype, "Proxy", {
get: function() {
switch (this.GameMethod) {
case m.PlayMethod.AndarBahar:
return s.default.Instance;

case m.PlayMethod.RedAndBlack:
return d.default.Instance;

case m.PlayMethod.LuckyDice:
return u.default.Instance;

case m.PlayMethod.DragonVSTiger:
return c.default.Instance;

case m.PlayMethod.SevenUpDown:
return h.default.Instance;

case m.PlayMethod.TraditionAndarBahar:
return _.default.Instance;

case m.PlayMethod.TPWar:
return f.default.Instance;

case m.PlayMethod.Roulette:
return p.default.Instance;
}
},
enumerable: !1,
configurable: !0
});
Object.defineProperty(t.prototype, "Model", {
get: function() {
switch (this.GameMethod) {
case m.PlayMethod.AndarBahar:
return s.ABModel.Instance;

case m.PlayMethod.RedAndBlack:
return d.RBModel.Instance;

case m.PlayMethod.LuckyDice:
return u.LuckyDiceModel.Instance;

case m.PlayMethod.DragonVSTiger:
return c.DTModel.Instance;

case m.PlayMethod.SevenUpDown:
return h.SUDModel.Instance;

case m.PlayMethod.TraditionAndarBahar:
return _.TraditionABModel.Instance;

case m.PlayMethod.TPWar:
return f.TPWarModel.Instance;

case m.PlayMethod.Roulette:
return p.RouletteModel.Instance;
}
},
enumerable: !1,
configurable: !0
});
t.prototype.init = function() {
y.default.getOddsManager().init(this.GameMethod);
y.default.getEffect().init(this.GameMethod);
y.default.getUI().GameMethod = this.GameMethod;
};
t.prototype.onLoad = function() {
l.default.Instance.destory();
r.default.Instance.destory();
this.Proxy.Init();
m.PlayMethod.TraditionAndarBahar != this.GameMethod && this.init();
};
t.prototype.onDestroy = function() {
this.Proxy.destory();
this.Model.clear();
};
t.prototype.start = function() {};
i([ C({
type: cc.Enum(m.PlayMethod)
}) ], t.prototype, "GameMethod", void 0);
return i([ v ], t);
}(cc.Component);
o.default = b;
cc._RF.pop();
}, {
"../../../client/model/GameModel": "GameModel",
"../../../client/teenpatti/model/TeenPattiModel": "TeenPattiModel",
"../../AndarBahar/Script/ABModel": "ABModel",
"../../DragonVSTiger/Script/DTModel": "DTModel",
"../../LuckyDice/Script/LuckyDiceModel": "LuckyDiceModel",
"../../RedAndBlack/Script/RBModel": "RBModel",
"../../Roulette/Script/RouletteModel": "RouletteModel",
"../../SevenUpDown/Script/SUDModel": "SUDModel",
"../../TPWar/Script/TPWarModel": "TPWarModel",
"../../TraditionAndarBahar/Script/TraditionABModel": "TraditionABModel",
"../Utils/CompositeConst": "CompositeConst",
"../Utils/CompositeUtil": "CompositeUtil"
} ],
GameModel: [ function(e, t, o) {
"use strict";
cc._RF.push(t, "ef1022GyWVIuLuHXsdznfmC", "GameModel");
Object.defineProperty(o, "__esModule", {
value: !0
});
o.RoomModelManager = o.RoomModel = o.ScoreRecord = void 0;
var n = e("../../Game/client/global/enum/game/Event"), a = e("../../Game/client/global/enum/game/Game"), i = e("../../Game/client/global/enum/net/C2S"), r = e("../../Game/client/global/enum/net/S2C"), l = e("../../Game/client/logic/game/GameHelper"), s = e("../../Game/client/model/CommonModel"), c = e("../../Game/fromework/global/Tools"), u = e("../../Game/fromework/helper/EventHelper"), d = e("../../Game/fromework/mvvm/modelView/ViewModel"), p = e("../../platform/Platform"), h = e("../../fromework/helper/NetHelper"), f = e("./LobbyModel"), _ = e("./WalletModel"), m = function() {
function e() {
this._roomModelMap = new Map();
}
Object.defineProperty(e, "Instance", {
get: function() {
e._instance || (e._instance = new e());
return e._instance;
},
enumerable: !1,
configurable: !0
});
e.prototype.setRecord = function(e, t) {
this._roomModelMap.set(e, t);
};
e.prototype.getRecord = function(e) {
return this._roomModelMap.has(e) ? this._roomModelMap.get(e) : null;
};
e._instance = null;
return e;
}();
o.ScoreRecord = m;
var y = function() {
function e() {
this.roomType = 0;
this.sTime = 0;
this.optData = new s.Common.OptData();
this.drawData = new s.Common.DrawData();
this.discardData = new s.Common.DiscardData();
this.finishData = new s.Common.FinishData();
this.declearData = new s.Common.DeclearData();
this.declearFailData = new s.Common.DeclearFailData();
this.dropData = new s.Common.DropData();
this.leaveData = new s.Common.LeaveData();
this.dismissData = new s.Common.DismissData();
this.recordData = new s.Common.RecordData();
this.scoreBoardData = new s.Common.ScoreBoardData();
this.rejoinData = new s.Common.RejoinData();
this.splitDataMap = new Map();
this.dealsResult = 0;
this.roomData = new s.Common.RoomData();
this.allUserData = new s.Common.AllUserData();
this.declearCards = [];
this.declearAutoSortCards = [];
this.orderCard = {};
this.handCards = [];
this.autoSortSwitch = !1;
this.syncCard = [];
this.is_recharge = !1;
}
Object.defineProperty(e.prototype, "roomId", {
get: function() {
return d.VM.getValue("lobby.roomID");
},
enumerable: !1,
configurable: !0
});
e.prototype.checkSelfState = function() {
var e = this.allUserData.getUserData(d.VM.getValue("user.uid"));
return e && (1 == e.state || 3 == e.state || 5 == e.state);
};
e.prototype.checkDrawClose = function() {
return !!this.checkOptUser() && 5 == this.optData.state && 0 == this.optData.cstate;
};
e.prototype.checkDrawOpen = function() {
if (this.checkOptUser() && 5 == this.optData.state && 0 == this.optData.cstate) {
var e = this.optData.last[this.optData.last.length - 1];
return !l.GroupHelper.checkWild(e, this.roomData.xcard) || 0 == this.optData.circle && 0 == this.optData.curr;
}
return !1;
};
e.prototype.checkDiscard = function() {
if (this.checkOptUser()) return 5 == this.optData.state && 1 == this.optData.cstate;
};
e.prototype.checkDraw = function() {
if (this.checkOptUser()) return 5 == this.optData.state && 0 == this.optData.cstate;
};
e.prototype.checkIsDeclear = function() {
var e = this.allUserData.getUserData(d.VM.getValue("user.uid"));
return !!e && 0 != e.res && 0 != e.state;
};
e.prototype.checkDrop = function() {
if (this.checkOptUser()) return 5 == this.optData.state && 0 == this.optData.cstate;
};
e.prototype.getCountDown = function() {
p.default.log("倒计时：", this.optData.dl, this.sTime);
return Math.ceil(this.optData.dl - this.sTime);
};
e.prototype.checkOptUser = function() {
return this.optData.order[this.optData.curr] == d.VM.getValue("user.uid");
};
e.prototype.getPlay = function() {
return this.roomData ? f.default.Instance.getGamePlay(this.roomData.rtype) : null;
};
return e;
}();
o.RoomModel = y;
var g = function() {
function e() {
this._model = null;
}
Object.defineProperty(e, "Instance", {
get: function() {
e._instance || (e._instance = new e());
return e._instance;
},
enumerable: !1,
configurable: !0
});
e.prototype.getModel = function() {
null == this._model && (this._model = new y());
return this._model;
};
e.prototype.clearModel = function() {
this._model = null;
};
e._instance = null;
return e;
}();
o.RoomModelManager = g;
var v = function() {
function e() {
this._orderShowTime = -1;
this._oldRoomType = "";
}
Object.defineProperty(e, "Instance", {
get: function() {
e._instance || (e._instance = new e());
return e._instance;
},
enumerable: !1,
configurable: !0
});
e.prototype.clear = function() {
if (0 != this._orderShowTime) {
l.Countdown.deleta(this._orderShowTime, !1);
this._orderShowTime = 0;
}
};
Object.defineProperty(e.prototype, "oldRoomType", {
get: function() {
return this._oldRoomType;
},
set: function(e) {
this._oldRoomType = e;
},
enumerable: !1,
configurable: !0
});
e.prototype.Init = function() {
u.default.Instance.Net.bind(r.S2C.GAME.ROOM_ENTER_ROOM, this._onEnterRoom, this);
u.default.Instance.Net.bind(r.S2C.GAME.ROOM_SWITCH_ROOM, this._onSwitchRoom, this);
u.default.Instance.Net.bind(r.S2C.GAME.ROOM_ORDER_SHOW, this._onOrderShow, this);
u.default.Instance.Net.bind(r.S2C.GAME.ROOM_ORDER_CONFIRM, this._onOrderConfirm, this);
u.default.Instance.Net.bind(r.S2C.GAME.ROOM_CARD_SHOW, this._onCardShow, this);
u.default.Instance.Net.bind(r.S2C.GAME.ROOM_CARD_CONFIRM, this._onCardConfirm, this);
u.default.Instance.Net.bind(r.S2C.GAME.ROOM_START_ROOM, this._onStartRoom, this);
u.default.Instance.Net.bind(r.S2C.GAME.ROOM_DRAW, this._onDraw, this);
u.default.Instance.Net.bind(r.S2C.GAME.ROOM_DISCARD, this._onDiscard, this);
u.default.Instance.Net.bind(r.S2C.GAME.ROOM_FINISH, this._onFinish, this);
u.default.Instance.Net.bind(r.S2C.GAME.ROOM_DECLEAR, this._onDeclear, this);
u.default.Instance.Net.bind(r.S2C.GAME.ROOM_SYNC_CARD, this._onSyncCard, this);
u.default.Instance.Net.bind(r.S2C.GAME.ROOM_DECLEAR_FAIL, this._onDeclearFail, this);
u.default.Instance.Net.bind(r.S2C.GAME.ROOM_RESET_ROOM, this._onResetRoom, this);
u.default.Instance.Net.bind(r.S2C.GAME.ROOM_LEAVE, this._onLeave, this);
u.default.Instance.Net.bind(r.S2C.GAME.ROOM_LEAVE_SINGLE, this._onLeaveSingle, this);
u.default.Instance.Net.bind(r.S2C.GAME.ROOM_DROP, this._onDrop, this);
u.default.Instance.Net.bind(r.S2C.GAME.ROOM_DISMISS, this._onDismiss, this);
u.default.Instance.Net.bind(r.S2C.GAME.ROOM_AUTOSORT_SWITCH, this._onAutoSortSwitch, this);
u.default.Instance.Net.bind(r.S2C.GAME.ROOM_AUTOSORT, this._onAutoSort, this);
u.default.Instance.Net.bind(r.S2C.GAME.ROOM_AUTOPLAY, this._onAutoPlay, this);
u.default.Instance.Net.bind(r.S2C.GAME.ROOM_SCORE_WINDOW, this._onScoreWindow, this);
u.default.Instance.Net.bind(r.S2C.GAME.ROOM_INITIATE_SPLIT, this._onInitiateSplit, this);
u.default.Instance.Net.bind(r.S2C.GAME.ROOM_SPLIT, this._onSplit, this);
u.default.Instance.Net.bind(r.S2C.GAME.ROOM_SPLIT_RESULT, this._onSplitResult, this);
u.default.Instance.Net.bind(r.S2C.GAME.ROOM_REJOIN, this._onRejoin, this);
u.default.Instance.Net.bind(r.S2C.GAME.ROOM_READY, this._onReady, this);
u.default.Instance.Net.bind(r.S2C.GAME.ROOM_SEND_AVAILABLE_BALANCE, this._onBalanceRefresh, this);
u.default.Instance.Net.bind(r.S2C.GAME.ROOM_KICK, this._onKick, this);
u.default.Instance.Global.bind(h.NetState.NET_WEBSOCKET_CONNECT_OPEN, this._onWsContented, this);
};
e.prototype.destory = function() {
u.default.Instance.Net.unbind(r.S2C.GAME.ROOM_ENTER_ROOM, this._onEnterRoom, this);
u.default.Instance.Net.unbind(r.S2C.GAME.ROOM_SWITCH_ROOM, this._onSwitchRoom, this);
u.default.Instance.Net.unbind(r.S2C.GAME.ROOM_ORDER_SHOW, this._onOrderShow, this);
u.default.Instance.Net.unbind(r.S2C.GAME.ROOM_ORDER_CONFIRM, this._onOrderConfirm, this);
u.default.Instance.Net.unbind(r.S2C.GAME.ROOM_CARD_SHOW, this._onCardShow, this);
u.default.Instance.Net.unbind(r.S2C.GAME.ROOM_CARD_CONFIRM, this._onCardConfirm, this);
u.default.Instance.Net.unbind(r.S2C.GAME.ROOM_START_ROOM, this._onStartRoom, this);
u.default.Instance.Net.unbind(r.S2C.GAME.ROOM_DRAW, this._onDraw, this);
u.default.Instance.Net.unbind(r.S2C.GAME.ROOM_DISCARD, this._onDiscard, this);
u.default.Instance.Net.unbind(r.S2C.GAME.ROOM_FINISH, this._onFinish, this);
u.default.Instance.Net.unbind(r.S2C.GAME.ROOM_DECLEAR, this._onDeclear, this);
u.default.Instance.Net.unbind(r.S2C.GAME.ROOM_SYNC_CARD, this._onSyncCard, this);
u.default.Instance.Net.unbind(r.S2C.GAME.ROOM_DECLEAR_FAIL, this._onDeclearFail, this);
u.default.Instance.Net.unbind(r.S2C.GAME.ROOM_RESET_ROOM, this._onResetRoom, this);
u.default.Instance.Net.unbind(r.S2C.GAME.ROOM_LEAVE, this._onLeave, this);
u.default.Instance.Net.unbind(r.S2C.GAME.ROOM_LEAVE_SINGLE, this._onLeaveSingle, this);
u.default.Instance.Net.unbind(r.S2C.GAME.ROOM_DROP, this._onDrop, this);
u.default.Instance.Net.unbind(r.S2C.GAME.ROOM_DISMISS, this._onDismiss, this);
u.default.Instance.Net.unbind(r.S2C.GAME.ROOM_AUTOSORT_SWITCH, this._onAutoSortSwitch, this);
u.default.Instance.Net.unbind(r.S2C.GAME.ROOM_AUTOSORT, this._onAutoSort, this);
u.default.Instance.Net.unbind(r.S2C.GAME.ROOM_AUTOPLAY, this._onAutoPlay, this);
u.default.Instance.Net.unbind(r.S2C.GAME.ROOM_SCORE_WINDOW, this._onScoreWindow, this);
u.default.Instance.Net.unbind(r.S2C.GAME.ROOM_INITIATE_SPLIT, this._onInitiateSplit, this);
u.default.Instance.Net.unbind(r.S2C.GAME.ROOM_SPLIT, this._onSplit, this);
u.default.Instance.Net.unbind(r.S2C.GAME.ROOM_SPLIT_RESULT, this._onSplitResult, this);
u.default.Instance.Net.unbind(r.S2C.GAME.ROOM_REJOIN, this._onRejoin, this);
u.default.Instance.Net.unbind(r.S2C.GAME.ROOM_READY, this._onReady, this);
u.default.Instance.Net.bind(r.S2C.GAME.ROOM_SEND_AVAILABLE_BALANCE, this._onBalanceRefresh, this);
u.default.Instance.Net.unbind(r.S2C.GAME.ROOM_KICK, this._onKick, this);
u.default.Instance.Global.unbind(h.NetState.NET_WEBSOCKET_CONNECT_OPEN, this._onWsContented, this);
this._oldRoomType = "";
};
Object.defineProperty(e.prototype, "uid", {
get: function() {
return d.VM.getValue("user.uid");
},
enumerable: !1,
configurable: !0
});
Object.defineProperty(e.prototype, "token", {
get: function() {
return d.VM.getValue("user.token");
},
enumerable: !1,
configurable: !0
});
Object.defineProperty(e.prototype, "roomID", {
get: function() {
return d.VM.getValue("lobby.roomID");
},
enumerable: !1,
configurable: !0
});
e.prototype.refreshWallet = function(e) {
if (e.currency_data) {
null != e.currency_data[a.GameEnum.MoneyType.CASH] && d.VM.setValue("wallet.total", e.currency_data[a.GameEnum.MoneyType.CASH]);
null != e.currency_data[a.GameEnum.MoneyType.PRACTICE] && d.VM.setValue("wallet.practice", e.currency_data[a.GameEnum.MoneyType.PRACTICE]);
null != e.currency_data[a.GameEnum.MoneyType.GOLD] && d.VM.setValue("wallet.gold", e.currency_data[a.GameEnum.MoneyType.GOLD]);
}
};
e.prototype.checkRoomID = function(e) {
return d.VM.getValue("lobby.roomID") == e;
};
e.prototype._onWsContented = function() {
var e = d.VM.getValue("lobby.roomID");
0 != e && this.sendEnterRoom(e);
};
e.prototype._onEnterRoom = function(e) {
var t = e.getUserData();
if (this.checkRoomID(t.rid)) {
var o = g.Instance.getModel();
o.sTime = t.stime;
o.allUserData.refresh(t.user_data);
o.roomData.refresh(t.room_data);
o.optData.refresh(t.room_data);
o.recordData.refresh(t.record);
if (t.user_card_data) {
o.autoSortSwitch = 1 == t.user_card_data.auto;
o.declearCards = t.user_card_data.declear;
o.handCards = t.user_card_data.hand;
o.declearAutoSortCards = t.user_card_data.declear_autosort;
o.syncCard = t.user_card_data.sync_card;
}
t.split_data && t.split_data.length > 0 && Object.keys(t.user_card_data).forEach(function(e) {
o.splitDataMap.set(parseInt(e), t.user_card_data[e]);
});
this.refreshWallet(t);
u.default.Instance.Global.emit(n.GameEvent.S2C_ENTER_ROOM, t.uid);
}
};
e.prototype._onSwitchRoom = function(e) {
var t = e.getUserData(), o = g.Instance.getModel();
this._oldRoomType = o.roomData.rtype;
d.VM.getValue("lobby.roomID") != t.r && d.VM.setValue("lobby.roomID", parseInt(t.r));
u.default.Instance.Global.emit(n.GameEvent.S2C_SWITCH_ROOM, t.r);
};
e.prototype._onOrderShow = function(e) {
var t = this, o = e.getUserData();
if (this.checkRoomID(o.rid)) {
var a = g.Instance.getModel();
a.optData.refresh(o.opt_data);
a.orderCard = o.order_card;
u.default.Instance.Global.emit(n.GameEvent.S2C_ORDER_SHOW);
this._orderShowTime = l.Countdown.creat(3, function() {
t._orderShowTime = -1;
t.sendOrderCongirm();
u.default.Instance.Global.emit(n.GameEvent.TABLE_HEAD_SORT);
});
}
};
e.prototype._onOrderConfirm = function(e) {
var t = e.getUserData();
this.checkRoomID(t.rid) && u.default.Instance.Global.emit(n.GameEvent.S2C_ORDER_CONFIRM);
};
e.prototype._onCardShow = function(e) {
var t = e.getUserData();
if (this.checkRoomID(t.rid)) {
var o = g.Instance.getModel();
o.roomData.refresh(t.room_data);
o.optData.refresh(t.room_data);
if (t.user_card_data) {
o.autoSortSwitch = 1 == t.user_card_data.auto;
o.declearCards = t.user_card_data.declear;
o.handCards = t.user_card_data.hand;
o.declearAutoSortCards = t.user_card_data.declear_autosort;
o.syncCard = t.user_card_data.sync_card;
}
o.recordData.firstCard = t.room_data.last[t.room_data.last.length - 1];
o.recordData.firstDraw = !1;
u.default.Instance.Global.emit(n.GameEvent.S2C_CARD_SHOW);
}
};
e.prototype._onCardConfirm = function(e) {
var t = e.getUserData();
if (this.checkRoomID(t.rid)) {
var o = g.Instance.getModel();
if (t.user_card_data) {
o.declearCards = t.user_card_data.declear;
o.handCards = t.user_card_data.hand;
o.declearAutoSortCards = t.user_card_data.declear_autosort;
o.syncCard = t.user_card_data.sync_card;
}
u.default.Instance.Global.emit(n.GameEvent.S2C_CARD_CONFIRM);
}
};
e.prototype._onStartRoom = function(e) {
var t = e.getUserData();
if (this.checkRoomID(t.rid)) {
var o = g.Instance.getModel();
o.sTime = t.stime;
o.roomData.refresh(t.room_data);
o.optData.refresh(t.room_data);
o.allUserData.refresh(t.user_data);
o.recordData.refresh(t.record);
u.default.Instance.Global.emit(n.GameEvent.S2C_START_ROOM);
}
};
e.prototype._onDraw = function(e) {
var t = e.getUserData();
if (this.checkRoomID(t.rid)) {
var o = g.Instance.getModel();
o.sTime = t.stime;
o.drawData.refresh(t);
o.optData.refresh(t.opt_data);
if (t.user_card_data) {
o.autoSortSwitch = 1 == t.user_card_data.auto;
o.declearCards = t.user_card_data.declear;
o.handCards = t.user_card_data.hand;
o.declearAutoSortCards = t.user_card_data.declear_autosort;
o.syncCard = t.user_card_data.sync_card;
}
o.checkOptUser() && (o.allUserData.getUserData(d.VM.getValue("user.uid")).draw = !0);
1 == t.dt && o.recordData.onDraw(t.lc_uid, t.card);
u.default.Instance.Global.emit(n.GameEvent.S2C_DRAW);
}
};
e.prototype._onDiscard = function(e) {
var t = e.getUserData();
if (this.checkRoomID(t.rid)) {
var o = g.Instance.getModel();
o.sTime = t.stime;
o.discardData.refresh(t);
o.optData.refresh(t.opt_data);
o.allUserData.refreshOptUser(t.user_data);
if (t.user_card_data) {
o.autoSortSwitch = 1 == t.user_card_data.auto;
o.declearCards = t.user_card_data.declear;
o.handCards = t.user_card_data.hand;
o.declearAutoSortCards = t.user_card_data.declear_autosort;
o.syncCard = t.user_card_data.sync_card;
}
o.recordData.onDiscard(t.uid, t.card);
u.default.Instance.Global.emit(n.GameEvent.S2C_DISCARD);
}
};
e.prototype._onFinish = function(e) {
var t = e.getUserData();
if (this.checkRoomID(t.rid)) {
var o = g.Instance.getModel();
o.sTime = t.stime;
o.finishData.refresh(t);
o.optData.refresh(t.opt_data);
o.allUserData.refreshOptUser(t.user_data);
if (t.user_card_data) {
o.declearCards = t.user_card_data.declear;
o.handCards = t.user_card_data.hand;
o.declearAutoSortCards = t.user_card_data.declear_autosort;
o.syncCard = t.user_card_data.sync_card;
}
u.default.Instance.Global.emit(n.GameEvent.S2C_FINISH);
}
};
e.prototype._onDeclear = function(e) {
var t = e.getUserData();
if (this.checkRoomID(t.rid)) {
var o = g.Instance.getModel();
o.sTime = t.stime;
o.optData.refresh(t.opt_data);
o.allUserData.refresh(t.declear_data.user_data);
o.declearData.refresh(t.declear_data);
u.default.Instance.Global.emit(n.GameEvent.S2C_DECLEAR_SUCCESS);
}
};
e.prototype._onSyncCard = function(e) {
var t = e.getUserData();
this.checkRoomID(t.rid) && u.default.Instance.Global.emit(n.GameEvent.S2C_SYNC_CARD);
};
e.prototype._onDeclearFail = function(e) {
var t = e.getUserData();
if (this.checkRoomID(t.rid)) {
var o = g.Instance.getModel();
o.sTime = t.stime;
o.declearFailData.refresh(t);
o.optData.refresh(t.opt_data);
o.allUserData.refreshOptUser(t.user_data);
if (t.user_card_data) {
o.declearCards = t.user_card_data.declear;
o.handCards = t.user_card_data.hand;
o.declearAutoSortCards = t.user_card_data.declear_autosort;
o.syncCard = t.user_card_data.sync_card;
}
u.default.Instance.Global.emit(n.GameEvent.S2C_DECLEAR_FAIL);
}
};
e.prototype._onResetRoom = function(e) {
var t = e.getUserData();
if (this.checkRoomID(t.rid)) {
var o = g.Instance.getModel();
o.sTime = t.stime;
o.optData.refresh(t.opt_data);
o.allUserData.refresh(t.declear_data.user_data);
o.declearData.refresh(t.declear_data);
o.allUserData.kickList = t.kick_data;
o.roomData.split = t.split;
o.dealsResult = t.deals_result;
null != t.is_recharge && (o.is_recharge = t.is_recharge);
null != o.roomData.round && o.roomData.round++;
this.refreshWallet(t);
var a = JSON.parse(cc.sys.localStorage.getItem(n.SDKEvent.SDKEVENT_FIRST_GAMEING));
if (!(a = null != a && a)) {
cc.sys.localStorage.setItem(n.SDKEvent.SDKEVENT_FIRST_GAMEING, JSON.stringify(!0));
p.default.logUnlockAchievement(n.SDKEvent.SDKEVENT_FIRST_GAMEING);
}
o.syncCard = [];
u.default.Instance.Global.emit(n.GameEvent.S2C_RESET);
}
};
e.prototype._onLeave = function(e) {
var t = e.getUserData();
if (this.checkRoomID(t.rid)) {
var o = g.Instance.getModel();
o.sTime = t.stime;
o.optData.refresh(t.opt_data);
o.allUserData.refresh(t.user_data);
o.leaveData.refresh(t);
u.default.Instance.Global.emit(n.GameEvent.S2C_LEAVE);
}
};
e.prototype._onLeaveSingle = function(e) {
var t = e.getUserData();
if (this.checkRoomID(t.rid) || 0 == d.VM.getValue("lobby.roomID")) {
var o = g.Instance.getModel();
o.sTime = t.stime;
o.leaveData.refresh(t);
u.default.Instance.Global.emit(n.GameEvent.S2C_LEAVE_SINGLE);
}
};
e.prototype._onDrop = function(e) {
var t = e.getUserData();
if (this.checkRoomID(t.rid)) {
var o = g.Instance.getModel();
o.sTime = t.stime;
o.dropData.refresh(t);
o.optData.refresh(t.opt_data);
o.allUserData.refreshOptUser(t.user_data);
this.refreshWallet(t);
u.default.Instance.Global.emit(n.GameEvent.S2C_DROP);
}
};
e.prototype._onDismiss = function(e) {
var t = e.getUserData();
if (this.checkRoomID(t.rid)) {
g.Instance.getModel().dismissData.refresh(t);
u.default.Instance.Global.emit(n.GameEvent.S2C_DISMISS_ROOM);
}
};
e.prototype._onBalanceRefresh = function(e) {
var t = e.getUserData();
if (!this.checkRoomID(t.rid)) {
var o = c.Tools.TNumber.numFixed(c.Tools.TNumber.num2single(t.total_fee), 2);
t.currency == a.GameEnum.MoneyType.CASH ? d.VM.setValue("wallet.total", o) : t.currency == a.GameEnum.MoneyType.PRACTICE ? d.VM.setValue("wallet.practice", o) : t.currency == a.GameEnum.MoneyType.GOLD && d.VM.setValue("wallet.gold", o);
_.WalletProxy.Instance.refreshWallet(t);
u.default.Instance.Global.emit(n.GameEvent.S2C_SEND_AVAILABLE_BALANCE);
}
};
e.prototype._onAutoSortSwitch = function(e) {
var t = e.getUserData();
if (this.checkRoomID(t.rid)) {
g.Instance.getModel().autoSortSwitch = 1 == t.switch;
u.default.Instance.Global.emit(n.GameEvent.S2C_AUTOSORT_SWITCH);
}
};
e.prototype._onAutoSort = function(e) {
var t = e.getUserData();
if (this.checkRoomID(t.rid)) {
var o = g.Instance.getModel();
if (t.user_card_data) {
o.autoSortSwitch = 1 == t.user_card_data.auto;
o.declearCards = t.user_card_data.declear;
o.handCards = t.user_card_data.hand;
o.declearAutoSortCards = t.user_card_data.declear_autosort;
o.syncCard = t.user_card_data.sync_card;
}
u.default.Instance.Global.emit(n.GameEvent.S2C_AUTOSORT);
}
};
e.prototype._onAutoPlay = function(e) {
var t = e.getUserData();
if (this.checkRoomID(t.rid)) {
var o = g.Instance.getModel();
o.sTime = t.stime;
o.allUserData.refreshOptUser(t.user_data);
o.optData.refresh(t.opt_data);
u.default.Instance.Global.emit(n.GameEvent.S2C_AUTOPLAY, t.user_data);
}
};
e.prototype._onScoreWindow = function(e) {
var t = e.getUserData();
if (this.checkRoomID(t.rid)) {
g.Instance.getModel().scoreBoardData.refresh(t.score_window);
u.default.Instance.Global.emit(n.GameEvent.S2C_SCORE_WINDOW);
}
};
e.prototype._onInitiateSplit = function(e) {
var t = e.getUserData();
if (this.checkRoomID(t.rid)) {
var o = g.Instance.getModel();
Object.keys(t.split_data).forEach(function(e) {
var n = new s.Common.SplitData(t.split_data[e]);
o.splitDataMap.set(parseInt(e), n);
});
o.optData.refresh(t.opt_data);
u.default.Instance.Global.emit(n.GameEvent.S2C_INITIATE_SPLIT);
}
};
e.prototype._onSplit = function(e) {
var t = e.getUserData();
if (this.checkRoomID(t.rid)) {
var o = g.Instance.getModel();
Object.keys(t.split_data).forEach(function(e) {
var n = new s.Common.SplitData(t.split_data[e]);
o.splitDataMap.set(parseInt(e), n);
});
u.default.Instance.Global.emit(n.GameEvent.S2C_SPLIT);
}
};
e.prototype._onSplitResult = function(e) {
var t = e.getUserData();
if (this.checkRoomID(t.rid)) {
var o = g.Instance.getModel();
Object.keys(t.split_data).forEach(function(e) {
var n = new s.Common.SplitData(t.split_data[e]);
o.splitDataMap.set(parseInt(e), n);
});
o.allUserData.refresh(t.user_data);
o.optData.refresh(t.opt_data);
u.default.Instance.Global.emit(n.GameEvent.S2C_SPLIT_RESULT);
}
};
e.prototype._onRejoin = function(e) {
var t = e.getUserData();
if (this.checkRoomID(t.rid)) {
var o = g.Instance.getModel();
o.rejoinData.refresh(t);
o.allUserData.refresh(t.user_data);
u.default.Instance.Global.emit(n.GameEvent.S2C_REJOIN);
}
};
e.prototype._onReady = function(e) {
var t = e.getUserData();
if (this.checkRoomID(t.rid)) {
var o = g.Instance.getModel();
o.sTime = t.stime;
var a = o.allUserData.getUserData(t.uid);
a && (a.confirm_state = t.confirm_state);
u.default.Instance.Global.emit(n.GameEvent.S2C_READY);
}
};
e.prototype._onKick = function(e) {
var t = e.getUserData();
this.checkRoomID(t.rid) && u.default.Instance.Global.emit(n.GameEvent.S2C_KICK);
};
e.prototype.sendEnterRoom = function(e, t) {
void 0 === t && (t = !0);
var o = h.default.Instance.makeMsg(i.C2S.ROOM_ENTER_ROOM, {
u: this.uid,
t: this.token,
r: e,
is_open: t
});
h.default.Instance.send(o);
};
e.prototype.sendSwitchRoom = function(e) {
var t = cc.Vec2.ZERO, o = h.default.Instance.makeMsg(i.C2S.ROOM_SWITCH_ROOM, {
u: this.uid,
t: this.token,
r: this.roomID,
rtype: e,
lng: t.y,
lat: t.x
});
h.default.Instance.send(o);
};
e.prototype.sendOrderCongirm = function() {
var e = h.default.Instance.makeMsg(i.C2S.ROOM_ORDER_CONFIRM, {
u: this.uid,
t: this.token,
r: this.roomID
});
h.default.Instance.send(e);
};
e.prototype.sendCardConfirm = function(e) {
var t = h.default.Instance.makeMsg(i.C2S.ROOM_CARD_CONFIRM, {
u: this.uid,
t: this.token,
r: this.roomID,
dc: e
});
h.default.Instance.send(t);
};
e.prototype.sendDraw = function(e) {
var t = h.default.Instance.makeMsg(i.C2S.ROOM_DRAW, {
u: this.uid,
t: this.token,
r: this.roomID,
dt: e
});
h.default.Instance.send(t);
};
e.prototype.sendDiscard = function(e, t) {
var o = h.default.Instance.makeMsg(i.C2S.ROOM_DISCARD, {
u: this.uid,
t: this.token,
r: this.roomID,
c: e,
dc: t
});
h.default.Instance.send(o);
};
e.prototype.sendFinish = function(e, t) {
var o = h.default.Instance.makeMsg(i.C2S.ROOM_FINISH, {
u: this.uid,
t: this.token,
r: this.roomID,
c: e,
dc: t
});
h.default.Instance.send(o);
};
e.prototype.sendDeclear = function(e) {
var t = h.default.Instance.makeMsg(i.C2S.ROOM_DECLEAR, {
u: this.uid,
t: this.token,
r: this.roomID,
dc: e
});
h.default.Instance.send(t);
};
e.prototype.sendSyncCard = function(e) {
var t = h.default.Instance.makeMsg(i.C2S.ROOM_SYNC_CARD, {
u: this.uid,
t: this.token,
r: this.roomID,
sync_card: e
});
h.default.Instance.send(t);
};
e.prototype.sendLeave = function(e, t) {
var o = null != t ? t : this.roomID, n = h.default.Instance.makeMsg(i.C2S.ROOM_LEAVE, {
u: this.uid,
t: this.token,
r: o,
is_deduct: e
});
h.default.Instance.send(n);
};
e.prototype.sendDrop = function() {
var e = h.default.Instance.makeMsg(i.C2S.ROOM_DROP, {
u: this.uid,
t: this.token,
r: this.roomID
});
h.default.Instance.send(e);
};
e.prototype.sendAutoSortSwitch = function(e) {
var t = h.default.Instance.makeMsg(i.C2S.ROOM_AUTOSORT_SWITCH, {
u: this.uid,
t: this.token,
r: this.roomID,
s: e ? 1 : 0
});
h.default.Instance.send(t);
};
e.prototype.sendAutoSort = function() {
var e = h.default.Instance.makeMsg(i.C2S.ROOM_AUTOSORT, {
u: this.uid,
t: this.token,
r: this.roomID
});
h.default.Instance.send(e);
};
e.prototype.sendAutoPlay = function() {
var e = h.default.Instance.makeMsg(i.C2S.ROOM_AUTOPLAY, {
u: this.uid,
t: this.token,
r: this.roomID
});
h.default.Instance.send(e);
};
e.prototype.sendScoreBoard = function() {
var e = h.default.Instance.makeMsg(i.C2S.ROOM_SCORE_WINDOW, {
u: this.uid,
t: this.token,
r: this.roomID
});
h.default.Instance.send(e);
};
e.prototype.sendInitiateSplit = function() {
var e = h.default.Instance.makeMsg(i.C2S.ROOM_INITIATE_SPLIT, {
u: this.uid,
t: this.token,
r: this.roomID
});
h.default.Instance.send(e);
};
e.prototype.sendSplit = function(e) {
var t = h.default.Instance.makeMsg(i.C2S.ROOM_SPLIT, {
u: this.uid,
t: this.token,
r: this.roomID,
s: e ? 1 : 0
});
h.default.Instance.send(t);
};
e.prototype.sendRejoin = function() {
var e = h.default.Instance.makeMsg(i.C2S.ROOM_REJOIN, {
u: this.uid,
t: this.token,
r: this.roomID
});
h.default.Instance.send(e);
};
e.prototype.sendReady = function() {
var e = h.default.Instance.makeMsg(i.C2S.ROOM_READY, {
u: this.uid,
t: this.token,
r: this.roomID
});
h.default.Instance.send(e);
};
e._instance = null;
return e;
}();
o.default = v;
cc._RF.pop();
}, {
"../../Game/client/global/enum/game/Event": "Event",
"../../Game/client/global/enum/game/Game": "Game",
"../../Game/client/global/enum/net/C2S": "C2S",
"../../Game/client/global/enum/net/S2C": "S2C",
"../../Game/client/logic/game/GameHelper": "GameHelper",
"../../Game/client/model/CommonModel": "CommonModel",
"../../Game/fromework/global/Tools": "Tools",
"../../Game/fromework/helper/EventHelper": "EventHelper",
"../../Game/fromework/mvvm/modelView/ViewModel": "ViewModel",
"../../fromework/helper/NetHelper": "NetHelper",
"../../platform/Platform": "Platform",
"./LobbyModel": "LobbyModel",
"./WalletModel": "WalletModel"
} ],
GameScene: [ function(e, t, o) {
"use strict";
cc._RF.push(t, "3d841iMJrlOT6BphuY0NWpW", "GameScene");
var n, a = this && this.__extends || (n = function(e, t) {
return (n = Object.setPrototypeOf || {
__proto__: []
} instanceof Array && function(e, t) {
e.__proto__ = t;
} || function(e, t) {
for (var o in t) Object.prototype.hasOwnProperty.call(t, o) && (e[o] = t[o]);
})(e, t);
}, function(e, t) {
n(e, t);
function o() {
this.constructor = e;
}
e.prototype = null === t ? Object.create(t) : (o.prototype = t.prototype, new o());
}), i = this && this.__decorate || function(e, t, o, n) {
var a, i = arguments.length, r = i < 3 ? t : null === n ? n = Object.getOwnPropertyDescriptor(t, o) : n;
if ("object" == typeof Reflect && "function" == typeof Reflect.decorate) r = Reflect.decorate(e, t, o, n); else for (var l = e.length - 1; l >= 0; l--) (a = e[l]) && (r = (i < 3 ? a(r) : i > 3 ? a(t, o, r) : a(t, o)) || r);
return i > 3 && r && Object.defineProperty(t, o, r), r;
};
Object.defineProperty(o, "__esModule", {
value: !0
});
var r = e("../../../Game/client/global/enum/game/Const"), l = e("../../../Game/fromework/global/Tools"), s = e("../../../Game/fromework/helper/AudioHelper"), c = e("../../../Game/fromework/helper/UIHelper"), u = e("../../component/NetworkDelay"), d = e("../../global/PopHelper"), p = e("../../model/GameModel"), h = e("../game/HearBeat"), f = e("../game/TableManager"), _ = cc._decorator, m = _.ccclass, y = _.property, g = _.menu, v = function(e) {
a(t, e);
function t() {
var t = null !== e && e.apply(this, arguments) || this;
t.TableManager = null;
t.Background = null;
t.UILayer = null;
t.TopLayer = null;
t.Time = null;
t._intervalID = -1;
return t;
}
t.prototype._initNetworkDelay = function() {
c.default.Instance.addBundleLayer(r.BundleUIPath.NetworkDelay, function(e) {
e.getComponent(u.default).init();
});
};
t.prototype.onLoad = function() {
var e = this;
s.default.Instance.stopBGM();
s.default.Instance.playBGMBundle(r.BundleSoundPath.bgm_game);
d.PopHelper.Instance.addLotoFastMarquee(this.TopLayer);
h.default.Instance.intervalTime = 5e3;
if (-1 != this._intervalID) {
clearInterval(this._intervalID);
this._intervalID = -1;
}
var t = new Date().getTime();
this.Time.string = l.Tools.TDate.format(t, "hh:mm:ss");
setInterval(function() {
t += 1e3;
if (e && e.Time && e.Time.node && e.Time.node.isValid) e.Time.string = l.Tools.TDate.format(t, "hh:mm:ss"); else if (-1 != e._intervalID) {
clearInterval(e._intervalID);
e._intervalID = -1;
}
}, 1e3);
};
t.prototype.onDestroy = function() {
if (-1 != this._intervalID) {
clearInterval(this._intervalID);
this._intervalID = -1;
}
p.default.Instance.destory();
};
t.prototype.start = function() {
c.default.Instance.setLayers(this.Background, this.UILayer, this.TopLayer);
this._initNetworkDelay();
p.default.Instance.Init();
this.TableManager.startGame();
};
i([ y(f.default) ], t.prototype, "TableManager", void 0);
i([ y(cc.Node) ], t.prototype, "Background", void 0);
i([ y(cc.Node) ], t.prototype, "UILayer", void 0);
i([ y(cc.Node) ], t.prototype, "TopLayer", void 0);
i([ y(cc.Label) ], t.prototype, "Time", void 0);
return i([ m, g("Scene/GameScene") ], t);
}(cc.Component);
o.default = v;
cc._RF.pop();
}, {
"../../../Game/client/global/enum/game/Const": "Const",
"../../../Game/fromework/global/Tools": "Tools",
"../../../Game/fromework/helper/AudioHelper": "AudioHelper",
"../../../Game/fromework/helper/UIHelper": "UIHelper",
"../../component/NetworkDelay": "NetworkDelay",
"../../global/PopHelper": "PopHelper",
"../../model/GameModel": "GameModel",
"../game/HearBeat": "HearBeat",
"../game/TableManager": "TableManager"
} ],
GameSetView: [ function(e, t, o) {
"use strict";
cc._RF.push(t, "a81f5ATL1lPIZmzqAf9yTGZ", "GameSetView");
var n, a = this && this.__extends || (n = function(e, t) {
return (n = Object.setPrototypeOf || {
__proto__: []
} instanceof Array && function(e, t) {
e.__proto__ = t;
} || function(e, t) {
for (var o in t) Object.prototype.hasOwnProperty.call(t, o) && (e[o] = t[o]);
})(e, t);
}, function(e, t) {
n(e, t);
function o() {
this.constructor = e;
}
e.prototype = null === t ? Object.create(t) : (o.prototype = t.prototype, new o());
}), i = this && this.__decorate || function(e, t, o, n) {
var a, i = arguments.length, r = i < 3 ? t : null === n ? n = Object.getOwnPropertyDescriptor(t, o) : n;
if ("object" == typeof Reflect && "function" == typeof Reflect.decorate) r = Reflect.decorate(e, t, o, n); else for (var l = e.length - 1; l >= 0; l--) (a = e[l]) && (r = (i < 3 ? a(r) : i > 3 ? a(t, o, r) : a(t, o)) || r);
return i > 3 && r && Object.defineProperty(t, o, r), r;
};
Object.defineProperty(o, "__esModule", {
value: !0
});
var r = e("../../../../Game/client/global/enum/game/Const"), l = e("../../../../Game/client/global/enum/game/Event"), s = e("../../../../Game/fromework/global/ResLoader"), c = e("../../../../Game/fromework/helper/AudioHelper"), u = e("../../../../Game/fromework/helper/EventHelper"), d = e("../../../../Game/fromework/helper/UIHelper"), p = e("../../../component/Card"), h = [ [ 55, 56, 57 ], [ 39, 40, 41 ], [ 23, 24, 25 ], [ 7, 8, 9 ] ], f = cc._decorator, _ = f.ccclass, m = f.property, y = function(e) {
a(t, e);
function t() {
var t = null !== e && e.apply(this, arguments) || this;
t.Panel = null;
t.Patterns = [];
t.Sound = null;
t.Vibration = null;
t.Color4Deck = null;
t._isSound = !0;
t._isVibration = !0;
t._isColor4 = !0;
return t;
}
t.prototype.openAction = function() {
this.Panel.setPosition(cc.v2(0, this.node.height / 2 + this.Panel.height / 2));
this.Panel.runAction(cc.moveTo(.1, cc.v2(0, 0)));
};
t.prototype.closeAction = function(e) {
var t = this;
this.Panel.runAction(cc.sequence(cc.moveTo(.1, cc.v2(0, -(this.node.height / 2 + this.Panel.height / 2))), cc.callFunc(function() {
e && e();
d.default.Instance.removeMaskLayer(t.node);
})));
};
t.prototype.onLoad = function() {
var e = this;
s.default.Instance.loadBundleRes(r.BundleUIPath.Card, cc.Prefab, function(t, o) {
t || h.forEach(function(t, n) {
var a = e.Patterns[n];
t.forEach(function(e) {
var t = cc.instantiate(o);
t.parent = a;
t.setPosition(cc.Vec3.ZERO);
t.setScale(.4);
t.getComponent(p.default).init(e, !0);
});
});
});
};
t.prototype.refreshView = function() {
this._isSound = c.default.Instance.valid;
var e = this.Sound.getChildByName(this._isSound ? "ToggleOn" : "ToggleOff").getComponent(cc.Toggle);
e && (e.isChecked = !0);
this._isVibration = JSON.parse(cc.sys.localStorage.getItem("Game_Audio_Vibration"));
null == this._isVibration && (this._isVibration = !0);
var t = this.Vibration.getChildByName(this._isVibration ? "ToggleOn" : "ToggleOff").getComponent(cc.Toggle);
t && (t.isChecked = !0);
this._isColor4 = JSON.parse(cc.sys.localStorage.getItem("Card_is4Color"));
null == this._isColor4 && (this._isColor4 = !1);
var o = this.Color4Deck.getChildByName(this._isColor4 ? "ToggleOn" : "ToggleOff").getComponent(cc.Toggle);
o && (o.isChecked = !0);
};
t.prototype.InitView = function() {
this.refreshView();
this.openAction();
};
t.prototype.onSoundToggle = function(e, t) {
var o = 1 == parseInt(t);
if (this._isSound != o) {
this._isSound = o;
if (o) {
c.default.Instance.turnOn();
c.default.Instance.playBGMBundle(r.BundleSoundPath.bgm_game);
c.default.Instance.effectVolume = 1;
} else c.default.Instance.turnOff();
}
};
t.prototype.onVibrationToggle = function(e, t) {
var o = 1 == parseInt(t);
if (this._isVibration != o) {
this._isVibration = o;
cc.sys.localStorage.setItem("Game_Audio_Vibration", JSON.stringify(o));
}
};
t.prototype.onColor4DeckToggle = function(e, t) {
var o = 1 == parseInt(t);
if (this._isColor4 != o) {
this._isColor4 = o;
cc.sys.localStorage.setItem("Card_is4Color", JSON.stringify(o));
u.default.Instance.Global.emit(l.GameEvent.CARD_REFRESH_COLOR, o);
}
};
t.prototype.onCloseClicked = function() {
this.closeAction();
};
i([ m(cc.Node) ], t.prototype, "Panel", void 0);
i([ m([ cc.Node ]) ], t.prototype, "Patterns", void 0);
i([ m(cc.Node) ], t.prototype, "Sound", void 0);
i([ m(cc.Node) ], t.prototype, "Vibration", void 0);
i([ m(cc.Node) ], t.prototype, "Color4Deck", void 0);
return i([ _ ], t);
}(cc.Component);
o.default = y;
cc._RF.pop();
}, {
"../../../../Game/client/global/enum/game/Const": "Const",
"../../../../Game/client/global/enum/game/Event": "Event",
"../../../../Game/fromework/global/ResLoader": "ResLoader",
"../../../../Game/fromework/helper/AudioHelper": "AudioHelper",
"../../../../Game/fromework/helper/EventHelper": "EventHelper",
"../../../../Game/fromework/helper/UIHelper": "UIHelper",
"../../../component/Card": "Card"
} ],
GameSetting: [ function(e, t, o) {
"use strict";
cc._RF.push(t, "88869K0UZBNJ43dQ5ZpgVZQ", "GameSetting");
var n, a = this && this.__extends || (n = function(e, t) {
return (n = Object.setPrototypeOf || {
__proto__: []
} instanceof Array && function(e, t) {
e.__proto__ = t;
} || function(e, t) {
for (var o in t) Object.prototype.hasOwnProperty.call(t, o) && (e[o] = t[o]);
})(e, t);
}, function(e, t) {
n(e, t);
function o() {
this.constructor = e;
}
e.prototype = null === t ? Object.create(t) : (o.prototype = t.prototype, new o());
}), i = this && this.__decorate || function(e, t, o, n) {
var a, i = arguments.length, r = i < 3 ? t : null === n ? n = Object.getOwnPropertyDescriptor(t, o) : n;
if ("object" == typeof Reflect && "function" == typeof Reflect.decorate) r = Reflect.decorate(e, t, o, n); else for (var l = e.length - 1; l >= 0; l--) (a = e[l]) && (r = (i < 3 ? a(r) : i > 3 ? a(t, o, r) : a(t, o)) || r);
return i > 3 && r && Object.defineProperty(t, o, r), r;
};
Object.defineProperty(o, "__esModule", {
value: !0
});
var r = e("../../../../Game/fromework/helper/EventHelper"), l = e("../../../../Game/fromework/helper/UIHelper"), s = e("../../../../Game/client/global/enum/game/Const"), c = e("../../../../Game/client/global/enum/game/Event"), u = e("../../../../Game/client/global/enum/game/Game"), d = e("../../../global/PopHelper"), p = e("../../../model/GameModel"), h = e("../../../../Game/client/model/LanguageModel"), f = e("../../../model/LobbyModel"), _ = e("../../game/GameInfo"), m = e("./GameSetView"), y = e("../../../teenpatti/ui/game/TeenPattiInfo"), g = e("../../../../Game/fromework/helper/AudioHelper"), v = e("../../../../Game/fromework/mvvm/modelView/ViewModel"), C = cc._decorator, b = C.ccclass, I = C.property, E = function(e) {
a(t, e);
function t() {
var t = null !== e && e.apply(this, arguments) || this;
t.MainPanel = null;
t.SoundPanel = null;
t.MusicProgress = null;
t.SoundProgress = null;
t.LastDeal = null;
t._isPlayAnimation = !1;
t._curPanel = null;
t._cls = u.GameEnum.PlayType.RUMMY_POINTS;
t._roomId = 0;
return t;
}
t.prototype.playInAnimation = function(e, t) {
var o = this;
if (!this._isPlayAnimation) {
this._isPlayAnimation = !0;
e.on(cc.Animation.EventType.FINISHED, function() {
o._isPlayAnimation = !1;
t && t();
}, this);
e.play("GameSettingIn");
}
};
t.prototype.playOutAnimation = function(e, t) {
var o = this;
if (!this._isPlayAnimation) {
this._isPlayAnimation = !0;
e.on(cc.Animation.EventType.FINISHED, function() {
o._isPlayAnimation = !1;
t && t();
}, this);
e.play("GameSettingOut");
}
};
t.prototype.setRoomId = function(e, t) {
this._cls = t;
this._roomId = e;
};
t.prototype.start = function() {
var e = JSON.parse(cc.sys.localStorage.getItem("Game_Audio_Vibration"));
null == e && (e = !0);
v.VM.setValue("lobbySet.music", 100 * g.default.Instance.bgmVolume);
v.VM.setValue("lobbySet.sound", 100 * g.default.Instance.effectVolume);
v.VM.setValue("lobbySet.isPlayVibration", e);
this.MusicProgress.progress = g.default.Instance.bgmVolume;
this.SoundProgress.progress = g.default.Instance.effectVolume;
this.MainPanel.active = !0;
this._curPanel = this.MainPanel;
this.playInAnimation(this.MainPanel.getComponent(cc.Animation));
};
t.prototype.onMusicChange = function(e) {
g.default.Instance.bgmVolume = e.progress;
this.MusicProgress.progress = e.progress;
};
t.prototype.onSoundChange = function(e) {
g.default.Instance.effectVolume = e.progress;
this.SoundProgress.progress = e.progress;
};
t.prototype.onSoundToggle = function(e, t) {
var o = parseInt(t), n = v.VM.getValue("lobbySet.isPlayVibration");
1 == o && (n = !n);
v.VM.setValue("lobbySet.isPlayVibration", n);
cc.sys.localStorage.setItem("Game_Audio_Vibration", JSON.stringify(n));
};
t.prototype.onGameSetClicked = function() {
var e = this;
l.default.Instance.addBundleMaskLayer(s.BundleUIPath.GameSetView, function(t) {
t.getComponent(m.default).InitView();
e.onCloseClicked();
});
};
t.prototype.onClickSound = function() {
var e = this;
this.playOutAnimation(this.MainPanel.getComponent(cc.Animation), function() {
e.MainPanel.active = !1;
e.SoundPanel.active = !0;
e._curPanel = e.SoundPanel;
e.playInAnimation(e.SoundPanel.getComponent(cc.Animation));
});
};
t.prototype.onGameInfoClicked = function() {
var e = this;
u.GameEnum.isRummy(this._cls) ? l.default.Instance.addBundleMaskLayer(s.BundleUIPath.GameInfo, function(t) {
t.getComponent(_.default).InitView();
e.onCloseClicked();
}) : u.GameEnum.isTeenpatti(this._cls) && l.default.Instance.addBundleMaskLayer("resources/prefab_tp/ui/game/TeenPattiInfo", function(t) {
t.getComponent(y.default).InitView(e._roomId);
e.onCloseClicked();
});
};
t.prototype.onLastDealClicked = function() {
var e = p.RoomModelManager.Instance.getModel(), t = f.default.Instance.getGamePlay(e.roomData.rtype);
if (t) {
var o;
(o = (t.cls == u.GameEnum.PlayType.RUMMY_POINTS || (t.cls, u.GameEnum.PlayType.RUMMY_TENCARD), 
p.ScoreRecord.Instance.getRecord(t.cls))) ? d.PopHelper.Instance.showScoreWindow(4, o) : d.PopHelper.Instance.showTips(h.default.getString("LAST_DEAL_TIPS"));
} else d.PopHelper.Instance.showTips(h.default.getString("LAST_DEAL_TIPS"));
};
t.prototype.onRefreshClicked = function() {
r.default.Instance.Global.emit(c.GameEvent.TABLE_REFRESH_TABLE);
this.onCloseClicked();
};
t.prototype.onHelpClicked = function() {
u.GameEnum.isRummy(this._cls) ? l.default.Instance.addBundleMaskLayer(s.BundleUIPath.HelpView) : u.GameEnum.isTeenpatti(this._cls) && l.default.Instance.addBundleMaskLayer("resources/prefab_tp/ui/game/HelpView_tp");
this.onCloseClicked();
};
t.prototype.onCloseClicked = function() {
var e = this;
this._curPanel && 1 == this._curPanel.active ? this.playOutAnimation(this._curPanel.getComponent(cc.Animation), function() {
l.default.Instance.removeMaskLayer(e.node);
}) : l.default.Instance.removeMaskLayer(this.node);
};
i([ I(cc.Node) ], t.prototype, "MainPanel", void 0);
i([ I(cc.Node) ], t.prototype, "SoundPanel", void 0);
i([ I(cc.ProgressBar) ], t.prototype, "MusicProgress", void 0);
i([ I(cc.ProgressBar) ], t.prototype, "SoundProgress", void 0);
i([ I(cc.Node) ], t.prototype, "LastDeal", void 0);
return i([ b ], t);
}(cc.Component);
o.default = E;
cc._RF.pop();
}, {
"../../../../Game/client/global/enum/game/Const": "Const",
"../../../../Game/client/global/enum/game/Event": "Event",
"../../../../Game/client/global/enum/game/Game": "Game",
"../../../../Game/client/model/LanguageModel": "LanguageModel",
"../../../../Game/fromework/helper/AudioHelper": "AudioHelper",
"../../../../Game/fromework/helper/EventHelper": "EventHelper",
"../../../../Game/fromework/helper/UIHelper": "UIHelper",
"../../../../Game/fromework/mvvm/modelView/ViewModel": "ViewModel",
"../../../global/PopHelper": "PopHelper",
"../../../model/GameModel": "GameModel",
"../../../model/LobbyModel": "LobbyModel",
"../../../teenpatti/ui/game/TeenPattiInfo": "TeenPattiInfo",
"../../game/GameInfo": "GameInfo",
"./GameSetView": "GameSetView"
} ],
Game: [ function(e, t, o) {
"use strict";
cc._RF.push(t, "0838eKT+TFIvp6qdGs8vknm", "Game");
Object.defineProperty(o, "__esModule", {
value: !0
});
o.GameEnum = void 0;
(function(e) {
var t;
(function(e) {
e[e.Spade = 3] = "Spade";
e[e.Heart = 2] = "Heart";
e[e.Club = 1] = "Club";
e[e.Diamond = 0] = "Diamond";
e[e.LittleJoker = 4] = "LittleJoker";
e[e.BigJoker = 5] = "BigJoker";
e[e.WildCard = 6] = "WildCard";
})(e.Pattern || (e.Pattern = {}));
(function(e) {
e[e.Invalid = 0] = "Invalid";
e[e.Sequence = 1] = "Sequence";
e[e.PureSequence = 2] = "PureSequence";
e[e.Set = 3] = "Set";
e[e.ValidSet = 4] = "ValidSet";
})(e.GroupType || (e.GroupType = {}));
(function(e) {
e[e.Hand = 0] = "Hand";
e[e.CloseDeck = 1] = "CloseDeck";
e[e.OpenDeck = 2] = "OpenDeck";
e[e.Other = 99] = "Other";
})(e.CardStatus || (e.CardStatus = {}));
e.RedDotKey = {
Mail: "Mail",
Notice: "Notice",
SignIn: "SignIn",
RechargeActivity: "RechargeActivity",
ServiceUnread: "ServiceUnread",
MonthCard: "MonthCard",
VIPShop: "VIPShop",
Refer: "Refer",
Task: "Task",
DailyTask: "DailyTask",
WeeklyTask: "WeeklyTask",
CareerTask: "CareerTask",
Festival: "Festival",
FestivalTask: "FestivalTask",
FestivalLoto: "FestivalLoto",
WorldCup: "WorldCup"
};
(function(e) {
e[e.USER_EXIST = 10] = "USER_EXIST";
e[e.USER_REG_FAILED = 11] = "USER_REG_FAILED";
e[e.USER_NOT_EXIST = 12] = "USER_NOT_EXIST";
e[e.USER_CURRENCY_ERROR = 13] = "USER_CURRENCY_ERROR";
e[e.USER_PHONE_NOT_EMPTY = 14] = "USER_PHONE_NOT_EMPTY";
e[e.EXCEED_MAX_SEND_COUNT = 15] = "EXCEED_MAX_SEND_COUNT";
e[e.USER_MARKET_SMS_CONTENT = 16] = "USER_MARKET_SMS_CONTENT";
e[e.USER_SMS_CODE_EMPTY = 17] = "USER_SMS_CODE_EMPTY";
e[e.USER_PHONE_EXIST = 18] = "USER_PHONE_EXIST";
e[e.USER_PHONE_NOT_EXIST = 19] = "USER_PHONE_NOT_EXIST";
e[e.SEND_CURRENCY_FAIL = 20] = "SEND_CURRENCY_FAIL";
e[e.ADD_USER_WALLET_FAIL = 21] = "ADD_USER_WALLET_FAIL";
e[e.ADD_USER_WALLET_LOG_FAIL = 22] = "ADD_USER_WALLET_LOG_FAIL";
e[e.UP_USER_WALLET_FAIL = 23] = "UP_USER_WALLET_FAIL";
e[e.USER_BIND_OTHER_PLATFORM = 24] = "USER_BIND_OTHER_PLATFORM";
e[e.USER_NOT_LOGIN = 25] = "USER_NOT_LOGIN";
e[e.USER_TOKEN_EXPIRED = 26] = "USER_TOKEN_EXPIRED";
e[e.USER_TOKEN_ERR = 27] = "USER_TOKEN_ERR";
e[e.USER_EMAIL_ERR = 28] = "USER_EMAIL_ERR";
e[e.USER_CODE_FAIL = 29] = "USER_CODE_FAIL";
e[e.BATCH_SEND_USER_NOT_EXIST = 30] = "BATCH_SEND_USER_NOT_EXIST";
e[e.SUBJECT_OR_BODY_NOT_EXIST = 31] = "SUBJECT_OR_BODY_NOT_EXIST";
e[e.USER_FROZEN = 32] = "USER_FROZEN";
e[e.USER_PHONE_TOKEN_ERROR = 33] = "USER_PHONE_TOKEN_ERROR";
e[e.USER_PHONE_BIND_FAILED = 34] = "USER_PHONE_BIND_FAILED";
e[e.USER_CODE_GET_FAILED = 35] = "USER_CODE_GET_FAILED";
e[e.LOGIC_DATA_ERROR = 36] = "LOGIC_DATA_ERROR";
e[e.USER_CURRENCY_ERROR_FROZEN = 37] = "USER_CURRENCY_ERROR_FROZEN";
e[e.ROOM_ID_INVALID = 100] = "ROOM_ID_INVALID";
e[e.ROOM_CREATE_ERROR = 101] = "ROOM_CREATE_ERROR";
e[e.ROOM_ID_ERROR = 102] = "ROOM_ID_ERROR";
e[e.ROOM_NOT_FINISH = 103] = "ROOM_NOT_FINISH";
e[e.ROOM_NOT_EXIST = 104] = "ROOM_NOT_EXIST";
e[e.ROOM_IS_FULL = 105] = "ROOM_IS_FULL";
e[e.ROOM_NOT_IN = 106] = "ROOM_NOT_IN";
e[e.ROOM_JOIN_FAILED = 107] = "ROOM_JOIN_FAILED";
e[e.ROOM_ALREADY_IN = 108] = "ROOM_ALREADY_IN";
e[e.ROOM_TIMER_ACT_ERROR = 109] = "ROOM_TIMER_ACT_ERROR";
e[e.ROOM_TIMER_ADD_FAILED = 110] = "ROOM_TIMER_ADD_FAILED";
e[e.ROOM_USER_CURR_ERROR = 111] = "ROOM_USER_CURR_ERROR";
e[e.ROOM_USER_PLAY_ERROR = 112] = "ROOM_USER_PLAY_ERROR";
e[e.ROOM_TYPE_ERROR = 113] = "ROOM_TYPE_ERROR";
e[e.ROOM_DRAW_CARD_ERROR = 114] = "ROOM_DRAW_CARD_ERROR";
e[e.ROOM_DISCARD_CARD_ERROR = 115] = "ROOM_DISCARD_CARD_ERROR";
e[e.ROOM_USER_ORDER_ERROR = 116] = "ROOM_USER_ORDER_ERROR";
e[e.ROOM_USER_CARD_ERROR = 117] = "ROOM_USER_CARD_ERROR";
e[e.ROOM_X_CARD_ERROR = 118] = "ROOM_X_CARD_ERROR";
e[e.ROOM_SCORE_ERROR = 119] = "ROOM_SCORE_ERROR";
e[e.ROOM_USER_FINISH_ERROR = 120] = "ROOM_USER_FINISH_ERROR";
e[e.ROOM_USER_DECLEAR_ERROR = 121] = "ROOM_USER_DECLEAR_ERROR";
e[e.ROOM_ROBOT_LEAVE_ERROR = 122] = "ROOM_ROBOT_LEAVE_ERROR";
e[e.ROOM_JOIN_MAX = 123] = "ROOM_JOIN_MAX";
e[e.ROOM_SPLIT_ERROR = 124] = "ROOM_SPLIT_ERROR";
e[e.ROOM_REJOIN_ERROR = 125] = "ROOM_REJOIN_ERROR";
e[e.ROOM_SCORE_WINDOW_ERROR = 126] = "ROOM_SCORE_WINDOW_ERROR";
e[e.ROOM_ENTER_ROOM_ERROR = 129] = "ROOM_ENTER_ROOM_ERROR";
e[e.NOT_ALLOW_LEAVE = 130] = "NOT_ALLOW_LEAVE";
e[e.ROOM_IS_STARTED = 131] = "ROOM_IS_STARTED";
e[e.ALREADY_BET = 132] = "ALREADY_BET";
e[e.ROOM_AUTO_BETTING = 133] = "ROOM_AUTO_BETTING";
e[e.ROOM_DEALER_LIST_FULL = 134] = "ROOM_DEALER_LIST_FULL";
e[e.ROOM_DEALER_LIST_FEE_NOT_ENOUGH = 135] = "ROOM_DEALER_LIST_FEE_NOT_ENOUGH";
e[e.ACT_NOT_EXIST = 160] = "ACT_NOT_EXIST";
e[e.LOTO_NOT_EXIST = 170] = "LOTO_NOT_EXIST";
e[e.LOTO_NOT_START = 171] = "LOTO_NOT_START";
e[e.LOTO_GAME_STOP = 172] = "LOTO_GAME_STOP";
e[e.LOTO_BET_ERROR = 173] = "LOTO_BET_ERROR";
e[e.SUCCEED = 200] = "SUCCEED";
e[e.DATA_INVALID = 501] = "DATA_INVALID";
e[e.FUNC_INVALID = 502] = "FUNC_INVALID";
e[e.PATH_INVALID = 503] = "PATH_INVALID";
e[e.CLASS_INVALID = 504] = "CLASS_INVALID";
e[e.ROUTE_INVALID = 505] = "ROUTE_INVALID";
e[e.RULE_INVALID = 506] = "RULE_INVALID";
e[e.SERVER_BUSY = 507] = "SERVER_BUSY";
e[e.SERVER_LIST_ISNULL = 600] = "SERVER_LIST_ISNULL";
e[e.SERVER_QU_ISNULL = 601] = "SERVER_QU_ISNULL";
})(e.ErrorCode || (e.ErrorCode = {}));
(function(e) {
e[e.RUMMY_POINTS = 1] = "RUMMY_POINTS";
e[e.RUMMY_POOL = 2] = "RUMMY_POOL";
e[e.RUMMY_TENCARD = 3] = "RUMMY_TENCARD";
e[e.RUMMY_DEALS = 4] = "RUMMY_DEALS";
e[e.TP_3PATTI = 5] = "TP_3PATTI";
e[e.TP_AK47 = 6] = "TP_AK47";
e[e.TP_JOKER = 7] = "TP_JOKER";
e[e.GAME_ANDARBAHAR = 8] = "GAME_ANDARBAHAR";
e[e.GAME_REDBLACK = 9] = "GAME_REDBLACK";
e[e.GAME_LUCKYDICE = 10] = "GAME_LUCKYDICE";
e[e.GAME_DRAGON_VS_TIGER = 11] = "GAME_DRAGON_VS_TIGER";
e[e.GAME_7UP7DOWN = 12] = "GAME_7UP7DOWN";
e[e.GAME_TRADITION_AB = 13] = "GAME_TRADITION_AB";
e[e.GAME_RB_FAST = 14] = "GAME_RB_FAST";
e[e.GAME_LOTO_FAST = 15] = "GAME_LOTO_FAST";
e[e.GAME_BLAST_SPACE = 16] = "GAME_BLAST_SPACE";
e[e.GAME_TP_WAR = 17] = "GAME_TP_WAR";
e[e.GAME_ROULETTE = 20] = "GAME_ROULETTE";
e[e.GAME_SLOT_200 = 200] = "GAME_SLOT_200";
e[e.GAME_SLOT_201 = 201] = "GAME_SLOT_201";
})(t = e.PlayType || (e.PlayType = {}));
e.isRummy = function(e) {
return e == t.RUMMY_POINTS || e == t.RUMMY_POOL || e == t.RUMMY_TENCARD || e == t.RUMMY_DEALS;
};
e.isTeenpatti = function(e) {
return e == t.TP_3PATTI || e == t.TP_AK47 || e == t.TP_JOKER;
};
(function(e) {
e[e.SHIELD_ARRAIGN = 0] = "SHIELD_ARRAIGN";
e[e.SHIELD_GUIDE = 1] = "SHIELD_GUIDE";
e[e.SHIELD_NORMAL = 2] = "SHIELD_NORMAL";
})(e.ShieldType || (e.ShieldType = {}));
(function(e) {
e[e.SMS_TYPE_BIND_PHONE = 1] = "SMS_TYPE_BIND_PHONE";
e[e.SMS_TYPE_PHONE_LOGIN = 2] = "SMS_TYPE_PHONE_LOGIN";
e[e.SMS_TYPE_BANK_CARD = 3] = "SMS_TYPE_BANK_CARD";
e[e.SMS_TYPE_CHANGE_PHONE = 4] = "SMS_TYPE_CHANGE_PHONE";
})(e.VerificationType || (e.VerificationType = {}));
(function(e) {
e[e.CASH = 1] = "CASH";
e[e.PRACTICE = 2] = "PRACTICE";
e[e.WITHDRAW = 3] = "WITHDRAW";
e[e.BONUS = 4] = "BONUS";
e[e.TOTAL_CASH = 5] = "TOTAL_CASH";
e[e.TOTAL_WITHDRAW = 6] = "TOTAL_WITHDRAW";
e[e.PROFIT_BONUS = 7] = "PROFIT_BONUS";
e[e.FREEZE = 8] = "FREEZE";
e[e.GOLD = 10] = "GOLD";
e[e.UNCLAIMEDBONUS = 16] = "UNCLAIMEDBONUS";
e.remainingWithAmt = "remainingWithAmt";
e.totalFlow = "totalFlow";
})(e.MoneyType || (e.MoneyType = {}));
(function(e) {
e[e.ROOM_BASE_STATE_NONE = 0] = "ROOM_BASE_STATE_NONE";
e[e.ROOM_BASE_STATE_WAIT = 1] = "ROOM_BASE_STATE_WAIT";
e[e.ROOM_BASE_STATE_MATCH = 2] = "ROOM_BASE_STATE_MATCH";
e[e.ROOM_BASE_STATE_COMPARE = 3] = "ROOM_BASE_STATE_COMPARE";
e[e.ROOM_BASE_STATE_SENDCARD = 4] = "ROOM_BASE_STATE_SENDCARD";
e[e.ROOM_BASE_STATE_START = 5] = "ROOM_BASE_STATE_START";
e[e.ROOM_BASE_STATE_FINISH = 6] = "ROOM_BASE_STATE_FINISH";
e[e.ROOM_BASE_STATE_DECLEAR = 7] = "ROOM_BASE_STATE_DECLEAR";
e[e.ROOM_BASE_STATE_SPLIT = 8] = "ROOM_BASE_STATE_SPLIT";
e[e.ROOM_BASE_STATE_END = 9] = "ROOM_BASE_STATE_END";
e[e.ROOM_BASE_STATE_COMPARE_CARD = 10] = "ROOM_BASE_STATE_COMPARE_CARD";
e[e.ROOM_BASE_STATE_RECHARGE = 11] = "ROOM_BASE_STATE_RECHARGE";
})(e.RoomState || (e.RoomState = {}));
(function(e) {
e[e.ROOM_USER_STATE_WATCH = 0] = "ROOM_USER_STATE_WATCH";
e[e.ROOM_USER_STATE_PLAY = 1] = "ROOM_USER_STATE_PLAY";
e[e.ROOM_USER_STATE_LEAVE = 2] = "ROOM_USER_STATE_LEAVE";
e[e.ROOM_USER_STATE_DROP = 3] = "ROOM_USER_STATE_DROP";
e[e.ROOM_USER_STATE_OUT = 4] = "ROOM_USER_STATE_OUT";
e[e.ROOM_USER_STATE_AUTO = 5] = "ROOM_USER_STATE_AUTO";
})(e.UserState || (e.UserState = {}));
(function(e) {
e[e.ROOM_USER_STATE_INIT = 0] = "ROOM_USER_STATE_INIT";
e[e.ROOM_USER_STATE_BLIND = 1] = "ROOM_USER_STATE_BLIND";
e[e.ROOM_USER_STATE_SEEN = 2] = "ROOM_USER_STATE_SEEN";
e[e.ROOM_USER_STATE_CHAAL = 3] = "ROOM_USER_STATE_CHAAL";
e[e.ROOM_USER_STATE_COMPARE = 4] = "ROOM_USER_STATE_COMPARE";
})(e.TP_UserState || (e.TP_UserState = {}));
(function(e) {
e[e.ROOM_USER_RESULT_PLAY = 0] = "ROOM_USER_RESULT_PLAY";
e[e.ROOM_USER_RESULT_WIN = 1] = "ROOM_USER_RESULT_WIN";
e[e.ROOM_USER_RESULT_LOSE = 2] = "ROOM_USER_RESULT_LOSE";
e[e.ROOM_USER_RESULT_DROP = 3] = "ROOM_USER_RESULT_DROP";
e[e.ROOM_USER_RESULT_OUT = 4] = "ROOM_USER_RESULT_OUT";
})(e.UserResult || (e.UserResult = {}));
})(o.GameEnum || (o.GameEnum = {}));
cc._RF.pop();
}, {} ],
GeneratorManager: [ function(e, t, o) {
"use strict";
cc._RF.push(t, "68233QOK45On6Rh5sWqDv5F", "GeneratorManager");
var n, a = this && this.__extends || (n = function(e, t) {
return (n = Object.setPrototypeOf || {
__proto__: []
} instanceof Array && function(e, t) {
e.__proto__ = t;
} || function(e, t) {
for (var o in t) Object.prototype.hasOwnProperty.call(t, o) && (e[o] = t[o]);
})(e, t);
}, function(e, t) {
n(e, t);
function o() {
this.constructor = e;
}
e.prototype = null === t ? Object.create(t) : (o.prototype = t.prototype, new o());
}), i = this && this.__decorate || function(e, t, o, n) {
var a, i = arguments.length, r = i < 3 ? t : null === n ? n = Object.getOwnPropertyDescriptor(t, o) : n;
if ("object" == typeof Reflect && "function" == typeof Reflect.decorate) r = Reflect.decorate(e, t, o, n); else for (var l = e.length - 1; l >= 0; l--) (a = e[l]) && (r = (i < 3 ? a(r) : i > 3 ? a(t, o, r) : a(t, o)) || r);
return i > 3 && r && Object.defineProperty(t, o, r), r;
};
Object.defineProperty(o, "__esModule", {
value: !0
});
var r = e("../../../Game/client/global/enum/game/Const"), l = e("../../../Game/client/global/enum/game/Event"), s = e("../../../Game/fromework/helper/AudioHelper"), c = e("../../../Game/fromework/helper/EventHelper"), u = e("../Utils/CompositeEvent"), d = e("../Utils/CompositeModel"), p = e("../Utils/CompositeUtil"), h = cc._decorator.ccclass, f = function(e) {
a(t, e);
function t() {
return null !== e && e.apply(this, arguments) || this;
}
t.prototype._onGameHide = function() {
this.unscheduleAllCallbacks();
};
t.prototype._onBet = function(e) {
var t = this, o = e.getUserData();
o.bet_batch_data.forEach(function(e, n) {
e.detail.forEach(function(e, a) {
for (var i = 0, l = function() {
var e = {
index: 0,
betData: []
};
e.index = p.default.getGeneratorIndex(o.uid);
var l = p.default.getOddsManager().getPosInRect(n), h = new d.ChipDataStruct(a / 1e3, l, n);
e.betData.push(h);
t.scheduleOnce(function() {
c.default.Instance.Global.emit(u.ChipGeneratorEvent.GENERATOR_BET, e);
s.default.Instance.playBundleEffect(r.BundleSoundPath.common_chip);
}, i);
i += .2;
}, h = 0; h < e; h++) l();
});
});
};
t.prototype._onBetBatch = function(e) {
var t = this;
e.getUserData().forEach(function(e, o) {
e.detail.forEach(function(e, n) {
var a = {
index: 0,
betData: []
};
a.index = 6;
for (var i = 0; i < e; i++) {
var l = p.default.getOddsManager().getPosInRect(o), h = new d.ChipDataStruct(n / 1e3, l, o);
a.betData.push(h);
}
t.scheduleOnce(function() {
c.default.Instance.Global.emit(u.ChipGeneratorEvent.GENERATOR_BET, a);
s.default.Instance.playBundleEffect(r.BundleSoundPath.common_chip);
}, 2 * Math.random());
});
});
};
t.prototype.onEnable = function() {
c.default.Instance.Global.bind(l.GameEvent.S2C_AB_BET, this._onBet, this);
c.default.Instance.Global.bind(l.GameEvent.S2C_AB_BET_BATCH, this._onBetBatch, this);
};
t.prototype.onDisable = function() {
c.default.Instance.Global.unbind(l.GameEvent.S2C_AB_BET, this._onBet, this);
c.default.Instance.Global.unbind(l.GameEvent.S2C_AB_BET_BATCH, this._onBetBatch, this);
};
t.prototype.onLoad = function() {
cc.game.on(cc.game.EVENT_HIDE, this._onGameHide, this);
};
t.prototype.start = function() {};
return i([ h ], t);
}(cc.Component);
o.default = f;
cc._RF.pop();
}, {
"../../../Game/client/global/enum/game/Const": "Const",
"../../../Game/client/global/enum/game/Event": "Event",
"../../../Game/fromework/helper/AudioHelper": "AudioHelper",
"../../../Game/fromework/helper/EventHelper": "EventHelper",
"../Utils/CompositeEvent": "CompositeEvent",
"../Utils/CompositeModel": "CompositeModel",
"../Utils/CompositeUtil": "CompositeUtil"
} ],
GlobalNotice: [ function(e, t, o) {
"use strict";
cc._RF.push(t, "b620fULDl5BH7Oj22Jg5KO7", "GlobalNotice");
var n, a = this && this.__extends || (n = function(e, t) {
return (n = Object.setPrototypeOf || {
__proto__: []
} instanceof Array && function(e, t) {
e.__proto__ = t;
} || function(e, t) {
for (var o in t) Object.prototype.hasOwnProperty.call(t, o) && (e[o] = t[o]);
})(e, t);
}, function(e, t) {
n(e, t);
function o() {
this.constructor = e;
}
e.prototype = null === t ? Object.create(t) : (o.prototype = t.prototype, new o());
}), i = this && this.__decorate || function(e, t, o, n) {
var a, i = arguments.length, r = i < 3 ? t : null === n ? n = Object.getOwnPropertyDescriptor(t, o) : n;
if ("object" == typeof Reflect && "function" == typeof Reflect.decorate) r = Reflect.decorate(e, t, o, n); else for (var l = e.length - 1; l >= 0; l--) (a = e[l]) && (r = (i < 3 ? a(r) : i > 3 ? a(t, o, r) : a(t, o)) || r);
return i > 3 && r && Object.defineProperty(t, o, r), r;
};
Object.defineProperty(o, "__esModule", {
value: !0
});
var r = e("../../Game/client/global/enum/game/Event"), l = e("../../Game/client/model/CommonModel"), s = e("../../Game/fromework/helper/EventHelper"), c = e("../../platform/Platform"), u = cc._decorator, d = u.ccclass, p = u.property, h = function(e) {
a(t, e);
function t() {
var t = null !== e && e.apply(this, arguments) || this;
t.Background = null;
t.Mask = null;
t.Notice = null;
t.Icon = null;
t.Message = null;
t.Icon_Frames = [];
t.Speed = 200;
t._messageList = [];
t._noticeData = null;
t._isPlay = !1;
t._noticeNodePool = new cc.NodePool();
return t;
}
t.prototype.onLoad = function() {
this.Notice.x = this.Mask.width / 2;
this.Notice.active = !1;
s.default.Instance.Global.bind(r.MarqueeEvent.PUSH_NOTICE, this.onNotice, this);
};
t.prototype.onDestroy = function() {
this.unscheduleAllCallbacks();
s.default.Instance.Global.unbind(r.MarqueeEvent.PUSH_NOTICE, this.onNotice, this);
};
t.prototype.startNoticeInsert = function() {
var e = this;
this.unscheduleAllCallbacks();
this.schedule(function() {
c.default.log(e._noticeData);
c.default.log(e._messageList);
if (e._noticeData && e._noticeData.ed_t > 0) {
e._noticeData.ed_t -= e._noticeData.iv_t;
if (e._messageList.length < 10) {
var t = new l.Common.MarqueeNoticeData(e._noticeData);
e._messageList.push(t);
}
e._isPlay || e.PlayMarquee();
} else {
e._noticeData = null;
e.unscheduleAllCallbacks();
}
}, this._noticeData.iv_t);
};
t.prototype.onNotice = function(e) {
var t, o = e.getUserData();
if (1 == (null == o ? void 0 : o.type)) {
this._messageList = this._messageList.filter(function(e) {
return 1 != e.type && 3 != e.type;
});
this._messageList.unshift(o);
} else if (3 == (null === (t = null == o ? void 0 : o[0]) || void 0 === t ? void 0 : t.type)) this._messageList = o.slice(); else {
this._messageList = this._messageList.filter(function(e) {
return 1 == e.type;
});
this._messageList.push(o);
}
this._isPlay || this.PlayMarquee();
};
t.prototype.PlayMarquee = function() {
var e = this;
if (this && this.node && this.node.isValid) if (0 != this._messageList.length) {
var t = this._messageList.shift();
this._messageList.push(t);
if (null != t) {
var o = this._noticeNodePool.get() || cc.instantiate(this.Notice);
o.parent = this.Mask;
o.active = !0;
this._isPlay = !0;
this.Background.active = !0;
this.Mask.active = !0;
var n = o.getChildByName("Icon").getComponent(cc.Sprite), a = o.getChildByName("NoticeText").getComponent(cc.RichText);
n.spriteFrame = this.Icon_Frames[1 == t.type ? 0 : 3 == t.type ? 2 : 1];
a.node.color = 3 !== t.type ? new cc.Color(255, 229, 144) : new cc.Color(255, 255, 255);
a.string = t.msg;
a._updateRichText();
o.x = this.Mask.width / 2;
o.getComponent(cc.Layout).updateLayout();
var i = this.Mask.width + o.width, r = i / this.Speed;
c.default.log("Notice Time: " + r + "s");
cc.tween(o).call(function() {
e.scheduleOnce(function() {
0 != e._messageList.length && e.PlayMarquee();
}, r / 3 * 2);
}).by(r, {
x: -i
}).call(function() {
e.scheduleOnce(function() {
e._noticeNodePool.put(o);
if (0 == e._messageList.length) {
e._isPlay = !1;
e.Background.active = !1;
e.Mask.active = !1;
}
});
}).start();
} else {
this._isPlay = !1;
this.Background.active = !1;
this.Mask.active = !1;
}
} else {
this._isPlay = !1;
this.Background.active = !1;
this.Mask.active = !1;
} else {
this._isPlay = !1;
this.Background.active = !1;
this.Mask.active = !1;
}
};
i([ p(cc.Node) ], t.prototype, "Background", void 0);
i([ p(cc.Node) ], t.prototype, "Mask", void 0);
i([ p(cc.Node) ], t.prototype, "Notice", void 0);
i([ p(cc.Sprite) ], t.prototype, "Icon", void 0);
i([ p(cc.RichText) ], t.prototype, "Message", void 0);
i([ p([ cc.SpriteFrame ]) ], t.prototype, "Icon_Frames", void 0);
i([ p(cc.Float) ], t.prototype, "Speed", void 0);
return i([ d ], t);
}(cc.Component);
o.default = h;
cc._RF.pop();
}, {
"../../Game/client/global/enum/game/Event": "Event",
"../../Game/client/model/CommonModel": "CommonModel",
"../../Game/fromework/helper/EventHelper": "EventHelper",
"../../platform/Platform": "Platform"
} ],
GlobalValue: [ function(e, t, o) {
"use strict";
cc._RF.push(t, "f83c7JveNxCWKdPKQ/x9mcK", "GlobalValue");
var n = this && this.__decorate || function(e, t, o, n) {
var a, i = arguments.length, r = i < 3 ? t : null === n ? n = Object.getOwnPropertyDescriptor(t, o) : n;
if ("object" == typeof Reflect && "function" == typeof Reflect.decorate) r = Reflect.decorate(e, t, o, n); else for (var l = e.length - 1; l >= 0; l--) (a = e[l]) && (r = (i < 3 ? a(r) : i > 3 ? a(t, o, r) : a(t, o)) || r);
return i > 3 && r && Object.defineProperty(t, o, r), r;
};
Object.defineProperty(o, "__esModule", {
value: !0
});
var a = cc._decorator.ccclass, i = function() {
function e() {
this._func_level = 0;
this._popOnce = !1;
this._popSignClose = !1;
this._isCashGame = !1;
this._OpenHotUpdate = !1;
this._HttpServerUrl = "";
this._WebSocketUrl = "";
this._WalletUrl = "";
this._ServiceUrl = "";
this._InviteLink = "https://share.rang-rummy.com";
this._domainUriPrefix = "https://rang-rummy.com";
this._InviteTargetLink = "";
this._zone = "";
this._InviteMinVersion = 1;
this._isWhaleUser = !1;
}
t = e;
Object.defineProperty(e.prototype, "func_level", {
get: function() {
return this._func_level;
},
set: function(e) {
this._func_level = e;
},
enumerable: !1,
configurable: !0
});
Object.defineProperty(e.prototype, "isPopView", {
get: function() {
return this._popOnce;
},
set: function(e) {
this._popOnce = e;
},
enumerable: !1,
configurable: !0
});
Object.defineProperty(e.prototype, "isPopClose", {
get: function() {
return this._popSignClose;
},
set: function(e) {
this._popSignClose = e;
},
enumerable: !1,
configurable: !0
});
Object.defineProperty(e.prototype, "isCashGame", {
get: function() {
return this._isCashGame;
},
set: function(e) {
this._isCashGame = e;
},
enumerable: !1,
configurable: !0
});
Object.defineProperty(e.prototype, "OpenHotUpdate", {
get: function() {
return this._OpenHotUpdate;
},
set: function(e) {
this._OpenHotUpdate = e;
},
enumerable: !1,
configurable: !0
});
Object.defineProperty(e.prototype, "HttpServerUrl", {
get: function() {
return this._HttpServerUrl;
},
set: function(e) {
this._HttpServerUrl = e;
},
enumerable: !1,
configurable: !0
});
Object.defineProperty(e.prototype, "WebSocketUrl", {
get: function() {
return this._WebSocketUrl;
},
set: function(e) {
this._WebSocketUrl = e;
},
enumerable: !1,
configurable: !0
});
Object.defineProperty(e.prototype, "WalletUrl", {
get: function() {
return this._WalletUrl;
},
set: function(e) {
this._WalletUrl = e;
},
enumerable: !1,
configurable: !0
});
Object.defineProperty(e.prototype, "ServiceUrl", {
get: function() {
return this._ServiceUrl;
},
set: function(e) {
this._ServiceUrl = e;
},
enumerable: !1,
configurable: !0
});
Object.defineProperty(e.prototype, "InviteLink", {
get: function() {
return this._InviteLink;
},
set: function(e) {
this._InviteLink = e;
},
enumerable: !1,
configurable: !0
});
Object.defineProperty(e.prototype, "domainUriPrefix", {
get: function() {
return this._domainUriPrefix;
},
set: function(e) {
this._domainUriPrefix = e;
},
enumerable: !1,
configurable: !0
});
Object.defineProperty(e.prototype, "InviteTargetLink", {
get: function() {
return this._InviteTargetLink;
},
set: function(e) {
this._InviteTargetLink = e;
},
enumerable: !1,
configurable: !0
});
Object.defineProperty(e.prototype, "zone", {
get: function() {
return this._zone;
},
set: function(e) {
this._zone = e;
},
enumerable: !1,
configurable: !0
});
Object.defineProperty(e.prototype, "InviteMinVersion", {
get: function() {
return this._InviteMinVersion;
},
set: function(e) {
this._InviteMinVersion = e;
},
enumerable: !1,
configurable: !0
});
Object.defineProperty(e.prototype, "isWhaleUser", {
get: function() {
return this._isWhaleUser;
},
set: function(e) {
this._isWhaleUser = e;
},
enumerable: !1,
configurable: !0
});
e.getInstance = function() {
t._Instance || (t._Instance = new t());
return t._Instance;
};
var t;
e._Instance = null;
return t = n([ a ], e);
}();
o.default = i;
cc._RF.pop();
}, {} ],
Global: [ function(e, t, o) {
"use strict";
cc._RF.push(t, "1fed7BmaHRE0rIg27Pv9GmC", "Global");
Object.defineProperty(o, "__esModule", {
value: !0
});
o.Global = void 0;
var n = e("../../Game/client/global/enum/game/Const"), a = e("../../Game/client/global/enum/game/Event"), i = e("../../Game/client/global/enum/game/Game"), r = e("../../Game/client/model/CommonModel"), l = e("../../Game/client/model/UpdateModel"), s = e("../../Game/fromework/helper/EventHelper"), c = e("../../Game/fromework/mvvm/modelView/ViewModel"), u = e("../../Composite/LuckyLotoFast/Script/LotoFastModel"), d = e("../../Composite/RedAndBlackFast/Script/RBFastModel"), p = e("../../fromework/helper/NetHelper"), h = e("../../Slots/Common/SlotProxy"), f = e("../Festival/Common/FestivalModel"), _ = e("../logic/active/ActiveEvent"), m = e("../logic/active/ActiveManager"), y = e("../logic/active/ActiveModel"), g = e("../logic/ui/Challenga/ChallengeModel"), v = e("../logic/ui/Task/TaskModel"), C = e("../logic/Wallet/WalletHelper"), b = e("../model/AddCashVIPModel"), I = e("../model/ErrorModel"), E = e("../model/InviteModel"), S = e("../model/ItemModel"), T = e("../model/LobbyModel"), R = e("../model/MailModel"), O = e("../model/MarqueeModel"), A = e("../model/MonthCardModel"), P = e("../model/PhoneModel"), M = e("../model/RecentModel"), G = e("../model/RedDotModel"), w = e("../model/ReferModel"), D = e("../model/SingModel"), L = e("../model/TreasureModel"), B = e("../model/UserModel"), N = e("../model/VIPModel"), k = e("../model/WalletModel"), F = e("../teenpatti/model/TeenPattiModel"), H = e("./PopHelper"), U = e("../../Game/BundleManager"), V = function() {
function e() {
this.isCurLoginRegist = !1;
this.TimeDifference = 0;
this.resetTime = 0;
this.serverTime = 0;
this.selectAddCashPrice = 1e3;
this.nativTimeArry = [];
this.isFirstLoginLobby = !0;
this.down_safe_reward = null;
this.down_safe_trigger = !1;
this.tipHandNum = 500;
this.downNewLayerTime = null;
this.login_reward = null;
}
Object.defineProperty(e, "Instance", {
get: function() {
e._instance || (e._instance = new e());
return e._instance;
},
enumerable: !1,
configurable: !0
});
e.prototype.loginRequest = function(e) {
var t = this, o = [], n = 0, i = function() {
if (10 == ++n) {
c();
e && e(o);
}
}, r = function() {
k.WalletProxy.Instance.activityList.forEach(function(e) {
1 != e.type && 5 != e.type || k.WalletProxy.Instance.sendGetRechargeGoods(e.id, []);
});
i();
}, l = function(e) {
var t = e.getUserData();
o = Object.keys(t);
i();
}, c = function() {
s.default.Instance.Global.unbind(a.LobbyEvent.LOBBY_GET_GAMES, i, t);
s.default.Instance.Global.unbind(a.WalletEvent.WALLET_USER_GET_WALLET, i, t);
s.default.Instance.Global.unbind(a.WalletEvent.RECHARGE_GET_USERINFO, i, t);
s.default.Instance.Global.unbind(a.WalletEvent.RECHARGE_ACT_REFRESH, r, t);
s.default.Instance.Global.unbind(_.BrokeEvent.BROKE_GET_BROKE_DATA, i, t);
s.default.Instance.Global.unbind(a.MonthCardEent.MONTHCARD_GET_LIST, i, t);
s.default.Instance.Global.unbind(a.LobbyEvent.LOBBY_GET_ROOMS, l, t);
s.default.Instance.Global.unbind(a.UserEvent.USER_GET_SHARE_URL, i, t);
s.default.Instance.Global.unbind(_.RechargeSuperEvent.RECHARGE_GET_SUPER_DATA, i, t);
s.default.Instance.Global.unbind(_.RechargeLuckyEvent.RECHARGE_GET_LUCKY_DATA, i, t);
};
(function() {
s.default.Instance.Global.bind(a.LobbyEvent.LOBBY_GET_GAMES, i, t);
s.default.Instance.Global.bind(a.WalletEvent.WALLET_USER_GET_WALLET, i, t);
s.default.Instance.Global.bind(a.WalletEvent.RECHARGE_GET_USERINFO, i, t);
s.default.Instance.Global.bind(a.WalletEvent.RECHARGE_ACT_REFRESH, r, t);
s.default.Instance.Global.bind(_.BrokeEvent.BROKE_GET_BROKE_DATA, i, t);
s.default.Instance.Global.bind(a.MonthCardEent.MONTHCARD_GET_LIST, i, t);
s.default.Instance.Global.bind(a.LobbyEvent.LOBBY_GET_ROOMS, l, t);
s.default.Instance.Global.bind(a.UserEvent.USER_GET_SHARE_URL, i, t);
s.default.Instance.Global.bind(_.RechargeSuperEvent.RECHARGE_GET_SUPER_DATA, i, t);
s.default.Instance.Global.bind(_.RechargeLuckyEvent.RECHARGE_GET_LUCKY_DATA, i, t);
})();
T.default.Instance.sendGetGames();
k.WalletProxy.Instance.UserRechargeInfo();
k.WalletProxy.Instance.sendGetUserWallet();
k.WalletProxy.Instance.sendGetRechargeUserInfo();
k.WalletProxy.Instance.sendPhoneMailState();
k.WalletProxy.Instance.sendGetActivityList();
y.ActiveProxy.Instance.sendGetBrokeActive();
A.MonthCardProxy.Instance.sendGetMonthCardList(4);
T.default.Instance.sendGetRooms();
w.ReferProxy.Instance.sendGetShareUrl();
y.ActiveProxy.Instance.sendGetRechargeSuperActiveInfo();
y.ActiveProxy.Instance.sendGetRechargeLuckyActiveInfo();
y.ActiveProxy.Instance.getRechargeBonusNew(1, null);
D.default.Instance.sendGetUserSigned();
S.ItemProxy.Instance.sendGetUserItem();
A.MonthCardProxy.Instance.sendGetNewMonthCardList();
y.ActiveProxy.Instance.getExchangeData(1, 0, null);
k.WalletProxy.Instance.getBonusData(null);
};
e.prototype.initModel = function() {
I.default.Instance.Init();
B.default.Instance.Init();
T.default.Instance.Init();
R.default.Instance.Init();
k.WalletProxy.Instance.Init();
G.default.Instance.Init();
D.default.Instance.Init();
P.PhoneProxy.Instance.Init();
A.MonthCardProxy.Instance.Init();
N.VIPProxy.Instance.Init();
H.PopHelper.Instance.Init();
u.default.Instance.Init();
d.default.Instance.Init();
O.default.Instance.Init();
C.default.Instance.Init();
m.default.Instance.Init();
y.ActiveProxy.Instance.Init();
w.ReferProxy.Instance.Init();
E.InviteModel.Instance.Init();
v.TaskProxy.Instance.Init();
G.RedDotProxy.Instance.Init();
f.FestivalProxy.Instance.Init();
M.RecentProxy.Instance.Init();
S.ItemProxy.Instance.Init();
g.ChallengeModel.Instance.Init();
b.AddCashVIPProxy.Instance.Init();
L.TreasureProxy.Instance.Init();
};
e.prototype.restartGame = function() {
s.default.Instance.stop();
p.default.Instance.dropWS();
T.default.Instance.clear();
R.default.Instance.clear();
G.default.Instance.clear();
k.WalletProxy.Instance.clear();
H.PopHelper.Instance.clear();
O.default.Instance.destory();
l.default.Instance.clear();
P.PhoneProxy.Instance.clear();
C.default.Instance.destory();
m.default.Instance.clear();
y.ActiveProxy.Instance.clear();
w.ReferProxy.Instance.clear();
E.InviteModel.Instance.clear();
v.TaskProxy.Instance.clear();
G.RedDotProxy.Instance.clear();
f.FestivalProxy.Instance.clear();
M.RecentProxy.Instance.clear();
S.ItemProxy.Instance.clear();
g.ChallengeModel.Instance.clear();
b.AddCashVIPProxy.Instance.clear();
L.TreasureProxy.Instance.clear();
cc.game.restart();
};
e.prototype.choiceScene = function(e) {
var t = 1 == e.length && (parseInt(e[0]) == i.GameEnum.PlayType.GAME_RB_FAST || parseInt(e[0]) == i.GameEnum.PlayType.GAME_LOTO_FAST);
if (0 == e.length || t) {
if (t) {
d.default.Instance.isOpenWindow = !1;
d.default.Instance.sendEnterRoom(c.VM.getValue("lobby.roomIDFast"));
}
U.default.getInstance().enterBundleScene(n.Scene.Lobby);
} else for (var o = 0; o < e.length; o++) {
var a = parseInt(e[o]);
i.GameEnum.isRummy(a) && U.default.getInstance().enterBundleScene(n.Scene.Game);
if (i.GameEnum.isTeenpatti(a)) {
F.default.Instance.cls = a;
U.default.getInstance().enterBundleScene(n.Scene.TeenPatti);
}
a == i.GameEnum.PlayType.GAME_ANDARBAHAR && U.default.getInstance().enterBundleScene(n.Scene.AndarBahar);
a == i.GameEnum.PlayType.GAME_REDBLACK && U.default.getInstance().enterBundleScene(n.Scene.RedAndBlack);
a == i.GameEnum.PlayType.GAME_LUCKYDICE && U.default.getInstance().enterBundleScene(n.Scene.LuckyDice);
a == i.GameEnum.PlayType.GAME_DRAGON_VS_TIGER && U.default.getInstance().enterBundleScene(n.Scene.DragonVSTiger);
a == i.GameEnum.PlayType.GAME_7UP7DOWN && U.default.getInstance().enterBundleScene(n.Scene.SevenUpDown);
a == i.GameEnum.PlayType.GAME_TRADITION_AB && U.default.getInstance().enterBundleScene(n.Scene.TraditionAndarBahar);
a == i.GameEnum.PlayType.GAME_BLAST_SPACE && U.default.getInstance().enterBundleScene(n.Scene.BlastSpace);
a == i.GameEnum.PlayType.GAME_TP_WAR && U.default.getInstance().enterBundleScene(n.Scene.TPWar);
a == i.GameEnum.PlayType.GAME_ROULETTE && U.default.getInstance().enterBundleScene(n.Scene.Roulette);
if (a == i.GameEnum.PlayType.GAME_RB_FAST) {
d.default.Instance.isOpenWindow = !1;
d.default.Instance.sendEnterRoom(c.VM.getValue("lobby.roomIDFast"));
}
if (a == i.GameEnum.PlayType.GAME_LOTO_FAST) {
d.default.Instance.isOpenWindow = !1;
d.default.Instance.sendEnterRoom(c.VM.getValue("lobby.roomIDFast"));
}
if (a == i.GameEnum.PlayType.GAME_SLOT_200) {
h.default.Instance.cls = 200;
U.default.getInstance().enterBundleScene(n.Scene.Slot);
}
if (a == i.GameEnum.PlayType.GAME_SLOT_201) {
h.default.Instance.cls = 201;
U.default.getInstance().enterBundleScene(n.Scene.Slot);
}
}
};
e.prototype.changeReward = function(e) {
var t = [];
if (!e || "" == e || null == e) return t;
if (e[i.GameEnum.MoneyType.CASH] && 0 != e[i.GameEnum.MoneyType.CASH]) {
(o = new r.Common.Reward()).rtype = 1;
o.type = i.GameEnum.MoneyType.CASH;
o.num = e[i.GameEnum.MoneyType.CASH];
t.push(o);
}
if (e[i.GameEnum.MoneyType.WITHDRAW] && 0 != e[i.GameEnum.MoneyType.WITHDRAW]) {
(o = new r.Common.Reward()).rtype = 1;
o.type = i.GameEnum.MoneyType.WITHDRAW;
o.num = e[i.GameEnum.MoneyType.WITHDRAW];
t.push(o);
}
if (e[i.GameEnum.MoneyType.BONUS] && 0 != e[i.GameEnum.MoneyType.BONUS]) {
(o = new r.Common.Reward()).rtype = 1;
o.type = i.GameEnum.MoneyType.BONUS;
o.num = e[i.GameEnum.MoneyType.BONUS];
t.push(o);
}
if (e[i.GameEnum.MoneyType.GOLD] && 0 != e[i.GameEnum.MoneyType.GOLD]) {
var o;
(o = new r.Common.Reward()).rtype = 1;
o.type = i.GameEnum.MoneyType.GOLD;
o.num = e[i.GameEnum.MoneyType.GOLD];
t.push(o);
}
return t;
};
e._instance = null;
return e;
}();
o.Global = V;
cc._RF.pop();
}, {
"../../Composite/LuckyLotoFast/Script/LotoFastModel": "LotoFastModel",
"../../Composite/RedAndBlackFast/Script/RBFastModel": "RBFastModel",
"../../Game/BundleManager": "BundleManager",
"../../Game/client/global/enum/game/Const": "Const",
"../../Game/client/global/enum/game/Event": "Event",
"../../Game/client/global/enum/game/Game": "Game",
"../../Game/client/model/CommonModel": "CommonModel",
"../../Game/client/model/UpdateModel": "UpdateModel",
"../../Game/fromework/helper/EventHelper": "EventHelper",
"../../Game/fromework/mvvm/modelView/ViewModel": "ViewModel",
"../../Slots/Common/SlotProxy": "SlotProxy",
"../../fromework/helper/NetHelper": "NetHelper",
"../Festival/Common/FestivalModel": "FestivalModel",
"../logic/Wallet/WalletHelper": "WalletHelper",
"../logic/active/ActiveEvent": "ActiveEvent",
"../logic/active/ActiveManager": "ActiveManager",
"../logic/active/ActiveModel": "ActiveModel",
"../logic/ui/Challenga/ChallengeModel": "ChallengeModel",
"../logic/ui/Task/TaskModel": "TaskModel",
"../model/AddCashVIPModel": "AddCashVIPModel",
"../model/ErrorModel": "ErrorModel",
"../model/InviteModel": "InviteModel",
"../model/ItemModel": "ItemModel",
"../model/LobbyModel": "LobbyModel",
"../model/MailModel": "MailModel",
"../model/MarqueeModel": "MarqueeModel",
"../model/MonthCardModel": "MonthCardModel",
"../model/PhoneModel": "PhoneModel",
"../model/RecentModel": "RecentModel",
"../model/RedDotModel": "RedDotModel",
"../model/ReferModel": "ReferModel",
"../model/SingModel": "SingModel",
"../model/TreasureModel": "TreasureModel",
"../model/UserModel": "UserModel",
"../model/VIPModel": "VIPModel",
"../model/WalletModel": "WalletModel",
"../teenpatti/model/TeenPattiModel": "TeenPattiModel",
"./PopHelper": "PopHelper"
} ],
GoldSliverCard: [ function(e, t, o) {
"use strict";
cc._RF.push(t, "f59d0ZZGElDJbV1mAuMNtQ6", "GoldSliverCard");
var n, a = this && this.__extends || (n = function(e, t) {
return (n = Object.setPrototypeOf || {
__proto__: []
} instanceof Array && function(e, t) {
e.__proto__ = t;
} || function(e, t) {
for (var o in t) Object.prototype.hasOwnProperty.call(t, o) && (e[o] = t[o]);
})(e, t);
}, function(e, t) {
n(e, t);
function o() {
this.constructor = e;
}
e.prototype = null === t ? Object.create(t) : (o.prototype = t.prototype, new o());
}), i = this && this.__decorate || function(e, t, o, n) {
var a, i = arguments.length, r = i < 3 ? t : null === n ? n = Object.getOwnPropertyDescriptor(t, o) : n;
if ("object" == typeof Reflect && "function" == typeof Reflect.decorate) r = Reflect.decorate(e, t, o, n); else for (var l = e.length - 1; l >= 0; l--) (a = e[l]) && (r = (i < 3 ? a(r) : i > 3 ? a(t, o, r) : a(t, o)) || r);
return i > 3 && r && Object.defineProperty(t, o, r), r;
};
Object.defineProperty(o, "__esModule", {
value: !0
});
var r = cc._decorator, l = r.ccclass, s = r.property, c = e("../../../../Game/client/global/enum/game/Const"), u = e("../../../../Game/fromework/helper/EventHelper"), d = e("../../../../Game/fromework/helper/UIHelper"), p = e("../../../../Game/fromework/mvvm/modelView/ViewModel"), h = e("../../../component/pop/tipsHand"), f = e("../../../Festival/Common/FestivalEvent"), _ = e("../../../global/Global"), m = e("../../../global/PopHelper"), y = e("../../../model/MonthCardModel"), g = e("../../active/ActiveModel"), v = e("../../Wallet/WalletHelper"), C = function(e) {
a(t, e);
function t() {
var t = null !== e && e.apply(this, arguments) || this;
t.gold = null;
t.sliver = null;
t.zhuan = null;
t.isFirstOpen = !1;
return t;
}
t.prototype.onLoad = function() {
u.default.Instance.Global.bind(f.FestivalEvent.HALL_MONTH_CARD_UI_RECHARGE, this.getData, this);
u.default.Instance.Global.bind("onGetGoldSliverData", this.showData, this);
};
t.prototype.onDisable = function() {
u.default.Instance.Global.unbind(f.FestivalEvent.HALL_MONTH_CARD_UI_RECHARGE, this.getData, this);
u.default.Instance.Global.unbind("onGetGoldSliverData", this.showData, this);
};
t.prototype.show = function(e) {
e && (this.isFirstOpen = e);
};
t.prototype.showData = function() {
var e, t, o, n = y.MonthCardProxy.Instance.goldSliverData;
if (n && null != n && this.node) {
var a = null == n ? void 0 : n.all_month_card[1], i = null == n ? void 0 : n.all_month_card[0], r = null == n ? void 0 : n.all_month_card[2], l = [];
if (i && null != i) {
var s = this.sliver.getChildByName("money"), u = this.sliver.getChildByName("detaile"), d = this.sliver.getChildByName("detaile1"), f = this.sliver.getChildByName("buy"), g = f.getChildByName("Label"), C = f.getChildByName("Times"), b = i.deposit + Number(i.day_deposit) * Number(i.day);
s.getComponent(cc.Label).string = c.MoneySymbol + i.deposit + "+" + c.MoneySymbol + i.day_deposit + "X" + i.day + "=" + c.MoneySymbol + b;
u.getComponent(cc.Label).string = "Get " + c.MoneySymbol + i.deposit + " right now";
d.getComponent(cc.Label).string = "Cash " + c.MoneySymbol + i.day_deposit + " X " + i.day + " days";
f.getChildByName("Label").getComponent(cc.Label).string = c.MoneySymbol + " " + i.price;
C.getComponent(cc.Label).string = (null !== (e = null == i ? void 0 : i.recieveCount) && void 0 !== e ? e : 0) + "/" + i.day;
this.sliver.getChildByName("rate").getComponent(cc.Label).string = (b / i.price * 100).toFixed(0) + "%";
f.off("click");
f.on("click", function() {
(null == i ? void 0 : i.recieveCount) ? n.today_flow < i.day_need_flow ? m.PopHelper.Instance.showTips("Total wins and losses ₹" + i.day_need_flow + "\n are required to receive cash") : y.MonthCardProxy.Instance.sendNewMonthCardReward(5, i.id) : v.default.Instance.openRechargeView(function() {}, i.price, 0, i.id);
});
f.getComponent(cc.Button).interactable = !(null == i ? void 0 : i.recieveCount) || 0 == i.recieved;
g.active = !(null == i ? void 0 : i.recieveCount);
C.active = !!(null == i ? void 0 : i.recieveCount);
f.getChildByName("tipsHand").active = !1;
f.getChildByName("RedDot").active = !1;
if (f.getComponent(cc.Button).interactable && g.active) {
if (i.price <= p.VM.getValue("wallet.withdraw") && i.price <= p.VM.getValue("wallet.remainingWithAmt") && p.VM.getValue("wallet.totalRecharge") > 0 && i.price >= _.Global.Instance.tipHandNum) {
var I = {
nodeBuy: f,
buyNum: i.price
};
l.push(I);
}
} else f.getComponent(cc.Button).interactable && (null == i ? void 0 : i.recieveCount) && n.today_flow >= i.day_need_flow && (f.getChildByName("RedDot").active = !0);
}
if (a && null != a) {
var E = this.gold.getChildByName("money"), S = this.gold.getChildByName("detaile"), T = this.gold.getChildByName("detaile1"), R = this.gold.getChildByName("buy"), O = (g = R.getChildByName("Label"), 
C = R.getChildByName("Times"), a.deposit + Number(a.day_deposit) * Number(a.day));
E.getComponent(cc.Label).string = c.MoneySymbol + a.deposit + "+" + c.MoneySymbol + a.day_deposit + "X" + a.day + "=" + c.MoneySymbol + O;
S.getComponent(cc.Label).string = "Get " + c.MoneySymbol + a.deposit + " right now";
T.getComponent(cc.Label).string = "Cash " + c.MoneySymbol + a.day_deposit + " X " + a.day + " days";
R.getChildByName("Label").getComponent(cc.Label).string = c.MoneySymbol + " " + a.price;
C.getComponent(cc.Label).string = (null !== (t = null == a ? void 0 : a.recieveCount) && void 0 !== t ? t : 0) + "/" + a.day;
this.gold.getChildByName("rate").getComponent(cc.Label).string = (O / a.price * 100).toFixed(0) + "%";
R.off("click");
R.on("click", function() {
(null == a ? void 0 : a.recieveCount) ? n.today_flow < a.day_need_flow ? m.PopHelper.Instance.showTips("Total wins and losses ₹" + a.day_need_flow + "\n are required to receive cash") : y.MonthCardProxy.Instance.sendNewMonthCardReward(5, a.id) : v.default.Instance.openRechargeView(function() {}, a.price, 0, a.id);
});
R.getComponent(cc.Button).interactable = !(null == a ? void 0 : a.recieveCount) || 0 == a.recieved;
g.active = !(null == a ? void 0 : a.recieveCount);
C.active = !!a.recieveCount;
R.getChildByName("tipsHand").active = !1;
R.getChildByName("RedDot").active = !1;
if (R.getComponent(cc.Button).interactable && g.active) {
if (a.price <= p.VM.getValue("wallet.withdraw") && a.price <= p.VM.getValue("wallet.remainingWithAmt") && p.VM.getValue("wallet.totalRecharge") > 0 && a.price >= _.Global.Instance.tipHandNum) {
var A = {
nodeBuy: R,
buyNum: a.price
};
l.push(A);
}
} else R.getComponent(cc.Button).interactable && (null == a ? void 0 : a.recieveCount) && n.today_flow >= a.day_need_flow && (R.getChildByName("RedDot").active = !0);
}
if (r && null != r) {
var P = this.zhuan.getChildByName("money"), M = this.zhuan.getChildByName("detaile"), G = this.zhuan.getChildByName("detaile1"), w = this.zhuan.getChildByName("buy");
g = w.getChildByName("Label"), C = w.getChildByName("Times"), b = r.deposit + Number(r.day_deposit) * Number(r.day);
P.getComponent(cc.Label).string = c.MoneySymbol + r.deposit + "+" + c.MoneySymbol + r.day_deposit + "X" + r.day + "=" + c.MoneySymbol + b;
M.getComponent(cc.Label).string = "Get " + c.MoneySymbol + r.deposit + " right now";
G.getComponent(cc.Label).string = "Cash " + c.MoneySymbol + r.day_deposit + " X " + r.day + " days";
w.getChildByName("Label").getComponent(cc.Label).string = c.MoneySymbol + " " + r.price;
C.getComponent(cc.Label).string = (null !== (o = null == r ? void 0 : r.recieveCount) && void 0 !== o ? o : 0) + "/" + r.day;
this.zhuan.getChildByName("rate").getComponent(cc.Label).string = (b / r.price * 100).toFixed(0) + "%";
w.off("click");
w.on("click", function() {
(null == r ? void 0 : r.recieveCount) ? n.today_flow < r.day_need_flow ? m.PopHelper.Instance.showTips("Total wins and losses ₹" + r.day_need_flow + "\n are required to receive cash") : y.MonthCardProxy.Instance.sendNewMonthCardReward(5, r.id) : v.default.Instance.openRechargeView(function() {}, r.price, 0, r.id);
});
w.getComponent(cc.Button).interactable = !(null == r ? void 0 : r.recieveCount) || 0 == r.recieved;
g.active = !(null == r ? void 0 : r.recieveCount);
C.active = !!(null == r ? void 0 : r.recieveCount);
w.getChildByName("tipsHand").active = !1;
w.getChildByName("RedDot").active = !1;
if (w.getComponent(cc.Button).interactable && g.active) {
if (r.price <= p.VM.getValue("wallet.withdraw") && r.price <= p.VM.getValue("wallet.remainingWithAmt") && p.VM.getValue("wallet.totalRecharge") > 0 && r.price >= _.Global.Instance.tipHandNum) {
var D = {
nodeBuy: w,
buyNum: r.price
};
l.push(D);
}
} else w.getComponent(cc.Button).interactable && (null == r ? void 0 : r.recieveCount) && n.today_flow >= r.day_need_flow && (w.getChildByName("RedDot").active = !0);
}
if (l.length > 0) {
l[l.length - 1].nodeBuy.getChildByName("tipsHand").active = !0;
l[l.length - 1].nodeBuy.getChildByName("tipsHand").getComponent(h.default).show(l[l.length - 1].buyNum);
}
}
};
t.prototype.getData = function() {
y.MonthCardProxy.Instance.sendGetNewMonthCardList();
};
t.prototype.start = function() {
this.showData();
};
t.prototype.closeClick = function() {
d.default.Instance.removeMaskLayer(this.node, !0);
this.isFirstOpen && (g.ActiveProxy.Instance.alreadyBuy ? u.default.Instance.Global.emit("openLoginAlert") : d.default.Instance.addBundleMaskLayer(c.BundleUIPath.WelComeBonus));
};
i([ s(cc.Node) ], t.prototype, "gold", void 0);
i([ s(cc.Node) ], t.prototype, "sliver", void 0);
i([ s(cc.Node) ], t.prototype, "zhuan", void 0);
return i([ l ], t);
}(cc.Component);
o.default = C;
cc._RF.pop();
}, {
"../../../../Game/client/global/enum/game/Const": "Const",
"../../../../Game/fromework/helper/EventHelper": "EventHelper",
"../../../../Game/fromework/helper/UIHelper": "UIHelper",
"../../../../Game/fromework/mvvm/modelView/ViewModel": "ViewModel",
"../../../Festival/Common/FestivalEvent": "FestivalEvent",
"../../../component/pop/tipsHand": "tipsHand",
"../../../global/Global": "Global",
"../../../global/PopHelper": "PopHelper",
"../../../model/MonthCardModel": "MonthCardModel",
"../../Wallet/WalletHelper": "WalletHelper",
"../../active/ActiveModel": "ActiveModel"
} ],
Group: [ function(e, t, o) {
"use strict";
cc._RF.push(t, "bd96fiovJxNp72bYW/Ps5u0", "Group");
var n, a = this && this.__extends || (n = function(e, t) {
return (n = Object.setPrototypeOf || {
__proto__: []
} instanceof Array && function(e, t) {
e.__proto__ = t;
} || function(e, t) {
for (var o in t) Object.prototype.hasOwnProperty.call(t, o) && (e[o] = t[o]);
})(e, t);
}, function(e, t) {
n(e, t);
function o() {
this.constructor = e;
}
e.prototype = null === t ? Object.create(t) : (o.prototype = t.prototype, new o());
}), i = this && this.__decorate || function(e, t, o, n) {
var a, i = arguments.length, r = i < 3 ? t : null === n ? n = Object.getOwnPropertyDescriptor(t, o) : n;
if ("object" == typeof Reflect && "function" == typeof Reflect.decorate) r = Reflect.decorate(e, t, o, n); else for (var l = e.length - 1; l >= 0; l--) (a = e[l]) && (r = (i < 3 ? a(r) : i > 3 ? a(t, o, r) : a(t, o)) || r);
return i > 3 && r && Object.defineProperty(t, o, r), r;
};
Object.defineProperty(o, "__esModule", {
value: !0
});
var r = e("../../Game/client/global/enum/game/Event"), l = e("../../Game/client/global/enum/game/Game"), s = e("../../Game/client/model/LanguageModel"), c = e("../../Game/fromework/global/Tools"), u = e("../../Game/fromework/helper/EventHelper"), d = cc._decorator, p = d.ccclass, h = d.property, f = function(e) {
a(t, e);
function t() {
var t = null !== e && e.apply(this, arguments) || this;
t.GroupBack = null;
t.AddButtonBack = null;
t.GroupLayer = null;
t.GroupScore = null;
t.LeftBtn = null;
t.RightBtn = null;
t.AddButton = null;
t.Frame_Back = new Array();
t.Frame_Button_Back = new Array();
t._groupType = 0;
t._score = 0;
return t;
}
Object.defineProperty(t.prototype, "groupType", {
get: function() {
return this._groupType;
},
enumerable: !1,
configurable: !0
});
Object.defineProperty(t.prototype, "score", {
get: function() {
return this._score;
},
enumerable: !1,
configurable: !0
});
t.prototype.init = function(e, t, o, n) {
void 0 === n && (n = 0);
this._groupType = e;
this._score = t;
if (e == l.GameEnum.GroupType.Invalid) if (0 == t) {
this.GroupBack.spriteFrame = this.Frame_Back[2];
this.AddButtonBack.spriteFrame = this.Frame_Button_Back[2];
this.GroupScore.string = s.default.getString("GROUP_JOKER");
} else {
this.GroupBack.spriteFrame = this.Frame_Back[0];
this.AddButtonBack.spriteFrame = this.Frame_Button_Back[0];
this.GroupScore.string = s.default.getString("TABLE_INVALID") + c.Tools.TStr.replaceAll("(score)", "score", t);
} else {
if (e == l.GameEnum.GroupType.PureSequence) {
this.GroupBack.spriteFrame = this.Frame_Back[2];
this.AddButtonBack.spriteFrame = this.Frame_Button_Back[2];
this.GroupScore.string = s.default.getString("TABLE_PS");
}
if (e == l.GameEnum.GroupType.Sequence) {
var a = s.default.getString("TABLE_SEQUENCE");
this.GroupBack.spriteFrame = this.Frame_Back[o ? 2 : 1];
this.AddButtonBack.spriteFrame = this.Frame_Button_Back[o ? 2 : 1];
this.GroupScore.string = o ? a : a + c.Tools.TStr.replaceAll("(score)", "score", t);
}
if (e == l.GameEnum.GroupType.Set) {
a = s.default.getString("TABLE_SET");
var i = 0 == t;
this.GroupBack.spriteFrame = this.Frame_Back[i ? 3 : 1];
this.AddButtonBack.spriteFrame = this.Frame_Button_Back[i ? 3 : 1];
this.GroupScore.string = i ? a : a + c.Tools.TStr.replaceAll("(score)", "score", t);
}
}
if (-1 == n) {
this.LeftBtn.active = !1;
this.RightBtn.active = !0;
} else if (1 == n) {
this.LeftBtn.active = !0;
this.RightBtn.active = !1;
} else if (0 == n) {
this.LeftBtn.active = !0;
this.RightBtn.active = !0;
}
};
t.prototype.initNoDetail = function(e, t, o, n) {
void 0 === n && (n = !0);
this._groupType = e;
this._score = t;
if (e == l.GameEnum.GroupType.Invalid) if (0 == t) {
this.GroupBack.spriteFrame = this.Frame_Back[2];
this.AddButtonBack.spriteFrame = this.Frame_Button_Back[2];
this.GroupScore.string = "";
} else {
this.GroupBack.spriteFrame = this.Frame_Back[0];
this.AddButtonBack.spriteFrame = this.Frame_Button_Back[0];
this.GroupScore.string = n ? s.default.getString("TABLE_INVALID") : "";
} else {
if (e == l.GameEnum.GroupType.PureSequence) {
this.GroupBack.spriteFrame = this.Frame_Back[2];
this.AddButtonBack.spriteFrame = this.Frame_Button_Back[2];
this.GroupScore.string = n ? s.default.getString("TABLE_PS") : "";
}
if (e == l.GameEnum.GroupType.Sequence) {
this.GroupBack.spriteFrame = this.Frame_Back[o ? 2 : 1];
this.AddButtonBack.spriteFrame = this.Frame_Button_Back[o ? 2 : 1];
this.GroupScore.string = n ? s.default.getString("TABLE_SEQUENCE") : "";
}
if (e == l.GameEnum.GroupType.Set) {
this.GroupBack.spriteFrame = this.Frame_Back[0 == t ? 3 : 1];
this.AddButtonBack.spriteFrame = this.Frame_Button_Back[0 == t ? 3 : 1];
this.GroupScore.string = n ? s.default.getString("TABLE_SET") : "";
}
}
this.LeftBtn.active = !1;
this.RightBtn.active = !1;
};
t.prototype.setAddButton = function(e) {
this.AddButton.active = e;
};
t.prototype.onAddBtnClicked = function() {
u.default.Instance.Global.emit(r.GameEvent.GAME_GROUP_ADD_HERE, this);
};
t.prototype.onMoveBtnClicked = function(e, t) {
var o = parseInt(t);
-1 == o && u.default.Instance.Global.emit(r.GameEvent.GAME_GROUP_LEFT, this);
1 == o && u.default.Instance.Global.emit(r.GameEvent.GAME_GROUP_RIGHT, this);
};
i([ h(cc.Sprite) ], t.prototype, "GroupBack", void 0);
i([ h(cc.Sprite) ], t.prototype, "AddButtonBack", void 0);
i([ h(cc.Node) ], t.prototype, "GroupLayer", void 0);
i([ h(cc.Label) ], t.prototype, "GroupScore", void 0);
i([ h(cc.Node) ], t.prototype, "LeftBtn", void 0);
i([ h(cc.Node) ], t.prototype, "RightBtn", void 0);
i([ h(cc.Node) ], t.prototype, "AddButton", void 0);
i([ h([ cc.SpriteFrame ]) ], t.prototype, "Frame_Back", void 0);
i([ h([ cc.SpriteFrame ]) ], t.prototype, "Frame_Button_Back", void 0);
return i([ p ], t);
}(cc.Component);
o.default = f;
cc._RF.pop();
}, {
"../../Game/client/global/enum/game/Event": "Event",
"../../Game/client/global/enum/game/Game": "Game",
"../../Game/client/model/LanguageModel": "LanguageModel",
"../../Game/fromework/global/Tools": "Tools",
"../../Game/fromework/helper/EventHelper": "EventHelper"
} ],
GuideScene: [ function(e, t, o) {
"use strict";
cc._RF.push(t, "53de8APl61AZo2hIEnVQDaO", "GuideScene");
var n, a = this && this.__extends || (n = function(e, t) {
return (n = Object.setPrototypeOf || {
__proto__: []
} instanceof Array && function(e, t) {
e.__proto__ = t;
} || function(e, t) {
for (var o in t) Object.prototype.hasOwnProperty.call(t, o) && (e[o] = t[o]);
})(e, t);
}, function(e, t) {
n(e, t);
function o() {
this.constructor = e;
}
e.prototype = null === t ? Object.create(t) : (o.prototype = t.prototype, new o());
}), i = this && this.__decorate || function(e, t, o, n) {
var a, i = arguments.length, r = i < 3 ? t : null === n ? n = Object.getOwnPropertyDescriptor(t, o) : n;
if ("object" == typeof Reflect && "function" == typeof Reflect.decorate) r = Reflect.decorate(e, t, o, n); else for (var l = e.length - 1; l >= 0; l--) (a = e[l]) && (r = (i < 3 ? a(r) : i > 3 ? a(t, o, r) : a(t, o)) || r);
return i > 3 && r && Object.defineProperty(t, o, r), r;
};
Object.defineProperty(o, "__esModule", {
value: !0
});
var r = e("../../../Game/fromework/helper/UIHelper"), l = cc._decorator, s = l.ccclass, c = l.property, u = function(e) {
a(t, e);
function t() {
var t = null !== e && e.apply(this, arguments) || this;
t.Background = null;
t.UILayer = null;
t.TopLayer = null;
return t;
}
t.prototype.start = function() {
r.default.Instance.setLayers(this.Background, this.UILayer, this.TopLayer);
};
i([ c(cc.Node) ], t.prototype, "Background", void 0);
i([ c(cc.Node) ], t.prototype, "UILayer", void 0);
i([ c(cc.Node) ], t.prototype, "TopLayer", void 0);
return i([ s ], t);
}(cc.Component);
o.default = u;
cc._RF.pop();
}, {
"../../../Game/fromework/helper/UIHelper": "UIHelper"
} ],
Guide: [ function(e, t, o) {
"use strict";
cc._RF.push(t, "905f70aZA1BNLoy1mfuzfOo", "Guide");
var n, a = this && this.__extends || (n = function(e, t) {
return (n = Object.setPrototypeOf || {
__proto__: []
} instanceof Array && function(e, t) {
e.__proto__ = t;
} || function(e, t) {
for (var o in t) Object.prototype.hasOwnProperty.call(t, o) && (e[o] = t[o]);
})(e, t);
}, function(e, t) {
n(e, t);
function o() {
this.constructor = e;
}
e.prototype = null === t ? Object.create(t) : (o.prototype = t.prototype, new o());
}), i = this && this.__decorate || function(e, t, o, n) {
var a, i = arguments.length, r = i < 3 ? t : null === n ? n = Object.getOwnPropertyDescriptor(t, o) : n;
if ("object" == typeof Reflect && "function" == typeof Reflect.decorate) r = Reflect.decorate(e, t, o, n); else for (var l = e.length - 1; l >= 0; l--) (a = e[l]) && (r = (i < 3 ? a(r) : i > 3 ? a(t, o, r) : a(t, o)) || r);
return i > 3 && r && Object.defineProperty(t, o, r), r;
};
Object.defineProperty(o, "__esModule", {
value: !0
});
var r = e("../../../Game/client/global/enum/game/Const"), l = e("../../../Game/client/global/enum/game/Game"), s = e("../../../Game/client/logic/game/GameHelper"), c = e("../../../Game/fromework/global/Tools"), u = e("../../component/Card"), d = e("../../component/Dealer"), p = e("../../component/deck/CloseDeck"), h = e("../../component/deck/FinishDeck"), f = e("../../component/deck/OpenDeck"), _ = e("../../component/GameHead"), m = e("../../component/Group"), y = cc._decorator, g = y.ccclass, v = y.property, C = function(e) {
a(t, e);
function t() {
var t = null !== e && e.apply(this, arguments) || this;
t.Prefab_Group = null;
t.Prefab_Card = null;
t.Table = null;
t.Dealer = null;
t.OpenDeck = null;
t.FinishDeck = null;
t.CloseDeck = null;
t.FinishBtn = null;
t.GroupBtn = null;
t.DiscardBtn = null;
t.SelfHead = null;
t.OtherHead = null;
t._xcard = 12;
t._handFromClient = [];
t._groups = [];
t._cards = [];
return t;
}
Object.defineProperty(t.prototype, "roomId", {
get: function() {
return 11;
},
enumerable: !1,
configurable: !0
});
t.prototype.getGroupWidth = function(e) {
return (e - 1) * r.CARD_SHOW_WIDTH + r.GROUP_DEFAULT_WIDTH;
};
t.prototype._creatGroups = function(e) {
var t = this, o = 0;
e.forEach(function(e) {
o += t.getGroupWidth(e.length);
});
var n = 0, a = -o / 2, i = 0, c = !1;
e.forEach(function(e) {
var o = s.GroupHelper.getGroupType(e, t._xcard);
if (o == l.GameEnum.GroupType.PureSequence) {
c = !0;
i++;
} else o == l.GameEnum.GroupType.Sequence && i++;
});
e.forEach(function(e) {
var o = t.getGroupWidth(e.length), l = a + n + o / 2;
n += o;
var u = cc.instantiate(t.Prefab_Group);
u.width = o;
u.position = cc.v3(l, -205, 0);
u.zIndex = r.GROUP_ZINDEX;
u.parent = t.Table;
var d = u.getComponent(m.default), p = s.GroupHelper.getGroupType(e, t._xcard), h = s.GroupHelper.getScore(e, c, i, t._xcard, null);
d.init(p, h, !1);
t._groups.push(d);
});
};
t.prototype._creatCards = function(e) {
var t = this;
e.forEach(function(e, o) {
var n = t._groups[o].node, a = n.x - n.width / 2 + (r.GROUP_DEFAULT_WIDTH - r.CARD_WIDTH) / 2 + r.CARD_WIDTH / 2, i = [];
e.forEach(function(e, o) {
var n = cc.instantiate(t.Prefab_Card).getComponent(u.default);
n.node.parent = t.Table;
n.init(e, !0, t._xcard);
n.pos = cc.v2(a + o * r.CARD_SHOW_WIDTH, -127);
i.push(n);
});
t._cards.push(i);
});
};
t.prototype.resetGroups = function(e) {
this._groups.forEach(function(e) {
e.node.removeFromParent(!0);
e.node.destroy();
});
this._groups.splice(0);
this._creatGroups(e);
};
t.prototype.resetCards = function(e) {
this._cards.forEach(function(e) {
e.forEach(function(e) {
e.node.removeFromParent(!0);
e.node.destroy();
});
e.splice(0);
});
this._cards.splice(0);
this._creatCards(e);
};
t.prototype.creatHand = function(e) {
this._handFromClient = c.Tools.TArray.deepCopy(e);
this._creatGroups(e);
this._creatCards(e);
};
i([ v(cc.Prefab) ], t.prototype, "Prefab_Group", void 0);
i([ v(cc.Prefab) ], t.prototype, "Prefab_Card", void 0);
i([ v(cc.Node) ], t.prototype, "Table", void 0);
i([ v(d.default) ], t.prototype, "Dealer", void 0);
i([ v(f.default) ], t.prototype, "OpenDeck", void 0);
i([ v(h.default) ], t.prototype, "FinishDeck", void 0);
i([ v(p.default) ], t.prototype, "CloseDeck", void 0);
i([ v(cc.Node) ], t.prototype, "FinishBtn", void 0);
i([ v(cc.Node) ], t.prototype, "GroupBtn", void 0);
i([ v(cc.Node) ], t.prototype, "DiscardBtn", void 0);
i([ v(_.default) ], t.prototype, "SelfHead", void 0);
i([ v(_.default) ], t.prototype, "OtherHead", void 0);
return i([ g ], t);
}(cc.Component);
o.default = C;
cc._RF.pop();
}, {
"../../../Game/client/global/enum/game/Const": "Const",
"../../../Game/client/global/enum/game/Game": "Game",
"../../../Game/client/logic/game/GameHelper": "GameHelper",
"../../../Game/fromework/global/Tools": "Tools",
"../../component/Card": "Card",
"../../component/Dealer": "Dealer",
"../../component/GameHead": "GameHead",
"../../component/Group": "Group",
"../../component/deck/CloseDeck": "CloseDeck",
"../../component/deck/FinishDeck": "FinishDeck",
"../../component/deck/OpenDeck": "OpenDeck"
} ],
HeadManager: [ function(e, t, o) {
"use strict";
cc._RF.push(t, "e1433SbCuxIvawr38gsEf/y", "HeadManager");
var n, a = this && this.__extends || (n = function(e, t) {
return (n = Object.setPrototypeOf || {
__proto__: []
} instanceof Array && function(e, t) {
e.__proto__ = t;
} || function(e, t) {
for (var o in t) Object.prototype.hasOwnProperty.call(t, o) && (e[o] = t[o]);
})(e, t);
}, function(e, t) {
n(e, t);
function o() {
this.constructor = e;
}
e.prototype = null === t ? Object.create(t) : (o.prototype = t.prototype, new o());
}), i = this && this.__decorate || function(e, t, o, n) {
var a, i = arguments.length, r = i < 3 ? t : null === n ? n = Object.getOwnPropertyDescriptor(t, o) : n;
if ("object" == typeof Reflect && "function" == typeof Reflect.decorate) r = Reflect.decorate(e, t, o, n); else for (var l = e.length - 1; l >= 0; l--) (a = e[l]) && (r = (i < 3 ? a(r) : i > 3 ? a(t, o, r) : a(t, o)) || r);
return i > 3 && r && Object.defineProperty(t, o, r), r;
};
Object.defineProperty(o, "__esModule", {
value: !0
});
var r = e("../../Game/fromework/mvvm/modelView/ViewModel"), l = e("./GameHead"), s = [ cc.v2(500, 130), cc.v2(255, 220), cc.v2(0, 250), cc.v2(-255, 220), cc.v2(-500, 130) ], c = function() {
this.userHead = null;
this.sIndex = 0;
this.uid = 0;
}, u = cc._decorator, d = u.ccclass, p = u.property, h = function(e) {
a(t, e);
function t() {
var t = null !== e && e.apply(this, arguments) || this;
t.Prefab_OtherHead = null;
t.selfHead = null;
t._isInit = !1;
t._other = [];
t.isPlayHeadAction = !0;
return t;
}
t.prototype.init = function(e) {
if (2 == e) {
(o = cc.instantiate(this.Prefab_OtherHead)).setPosition(s[2]);
this.node.addChild(o);
(n = new c()).userHead = o.getComponent(l.default);
n.sIndex = 0;
n.uid = 0;
this._other.push(n);
}
if (6 == e) for (var t = 0; t < 5; t++) {
var o, n;
(o = cc.instantiate(this.Prefab_OtherHead)).setPosition(s[t]);
this.node.addChild(o);
(n = new c()).userHead = o.getComponent(l.default);
n.sIndex = t;
n.uid = 0;
this._other.push(n);
}
};
t.prototype.addNewUser = function(e) {
for (var t = 0; t < this._other.length; t++) {
var o = this._other[t];
if (0 == o.uid && 1 == o.userHead.isFree) {
o.userHead.isFree = !1;
o.userHead.init(e, this.isPlayHeadAction);
o.uid = e.uid;
return;
}
}
};
t.prototype.getSeatByUid = function(e) {
for (var t = 0; t < this._other.length; t++) if (this._other[t].uid == e) return this._other[t];
return null;
};
t.prototype.isSelf = function(e) {
return e == r.VM.getValue("user.uid");
};
t.prototype.refreshUserCount = function(e) {
if (!this._isInit) {
this._isInit = !0;
this.init(e);
}
};
t.prototype.refresh = function(e) {
var t = this;
this._other.forEach(function(t) {
if (0 != t.uid && !e.allUserData.userMap.has(t.uid)) {
t.userHead.isFree = !0;
t.uid = 0;
}
});
e.allUserData.userMap.forEach(function(e, o) {
if (t.isSelf(o)) {
if (1 == t.selfHead.isFree) {
t.selfHead.isFree = !1;
t.selfHead.init(e);
}
} else t._other.some(function(e) {
return e.uid == o;
}) || t.addNewUser(e);
});
this.refreshUser(e);
};
t.prototype.refreshUser = function(e) {
var t = this;
e.allUserData.userMap.forEach(function(o, n) {
var a = null;
if (a = n == r.VM.getValue("user.uid") ? t.selfHead : t.getSeatByUid(n).userHead) {
a.refreshState(o.state, o.res, o.score);
a.setPTSScore(o.tscore);
a.setReadyIcon(4 == o.confirm_state && e.roomData.ready_switch && 2 == e.optData.state);
if (1 != o.state && 5 != o.state || 0 != o.res) a.hideCountDown(); else {
var i = e.getCountDown() - o.protect, l = o.protect;
if (i <= 0) {
i = 0;
l = e.getCountDown();
}
if (5 == e.optData.state || 6 == e.optData.state) if (o.uid == e.optData.order[e.optData.curr]) {
6 == e.optData.state && a.hideCountDown();
a.showCountDown(i, l);
} else a.hideCountDown(); else 7 == e.optData.state && 0 == o.res ? a.showCountDown(i, l) : a.hideCountDown();
}
a.setDSeat(o.uid == e.optData.order[e.optData.order.length - 1]);
}
});
};
t.prototype.hideAllCountDown = function() {
this.selfHead && this.selfHead.hideCountDown();
this._other.forEach(function(e) {
e && e.userHead && e.userHead.hideCountDown();
});
};
t.prototype.reset = function() {
this.selfHead.isFree = !0;
this._other.forEach(function(e) {
e.userHead.node.removeFromParent(!0);
e.userHead.node.destroy();
});
this._other.splice(0);
this._isInit = !1;
};
t.prototype.userSort = function(e, t) {
var o = this;
if (!(e.order.length <= 2)) {
var n = e.order.concat(), a = r.VM.getValue("user.uid"), i = n.indexOf(a);
this._other.forEach(function(e) {
if (0 != e.uid || 0 == e.userHead.isFree) {
e.userHead.isFree = !0;
e.uid = 0;
}
});
0 != i ? (n = n.concat(n.splice(0, i))).shift() : n.shift();
n.forEach(function(e, n) {
var a = t.getUserData(e), i = o._other[n];
i.userHead.isFree = !1;
i.userHead.init(a);
i.uid = e;
});
}
};
t.prototype.getOrderCardPos = function(e) {
if (this.isSelf(e)) return this.selfHead.orderCardPos.parent.convertToWorldSpaceAR(this.selfHead.orderCardPos.getPosition());
var t = this.getSeatByUid(e);
return t ? t.userHead.orderCardPos.parent.convertToWorldSpaceAR(t.userHead.orderCardPos.getPosition()) : cc.v2(0, 0);
};
t.prototype.getHeadPosInTarget = function(e, t) {
var o = this.getSeatByUid(t);
if (o) {
var n = o.userHead.drawCardPos.parent.convertToWorldSpaceAR(o.userHead.drawCardPos.getPosition());
return e.convertToNodeSpaceAR(n);
}
return cc.Vec2.ZERO;
};
i([ p(cc.Prefab) ], t.prototype, "Prefab_OtherHead", void 0);
i([ p(l.default) ], t.prototype, "selfHead", void 0);
return i([ d ], t);
}(cc.Component);
o.default = h;
cc._RF.pop();
}, {
"../../Game/fromework/mvvm/modelView/ViewModel": "ViewModel",
"./GameHead": "GameHead"
} ],
HearBeat: [ function(e, t, o) {
"use strict";
cc._RF.push(t, "e60df0mw8ZOJ4Odbkqf937n", "HearBeat");
Object.defineProperty(o, "__esModule", {
value: !0
});
var n = e("../../../Game/client/global/enum/game/Event"), a = e("../../../Game/client/global/enum/net/C2S"), i = e("../../../Game/client/global/enum/net/S2C"), r = e("../../../Game/fromework/helper/EventHelper"), l = e("../../../Game/fromework/mvvm/modelView/ViewModel"), s = e("../../../platform/Platform"), c = e("../../../fromework/helper/NetHelper"), u = function() {
function e() {
this._intervalTime = 0;
this._timeoutFuncID = -1;
this._hearBeatFuncID = -1;
this._begun = !1;
this._sendTime = 0;
this._delay = 0;
this._begun = !1;
this._intervalTime = 0;
this._timeoutFuncID = -1;
this._hearBeatFuncID = -1;
this._sendTime = 0;
this._delay = 0;
}
Object.defineProperty(e.prototype, "uid", {
get: function() {
return l.VM.getValue("user.uid");
},
enumerable: !1,
configurable: !0
});
Object.defineProperty(e.prototype, "begun", {
get: function() {
return this._begun;
},
enumerable: !1,
configurable: !0
});
Object.defineProperty(e.prototype, "intervalTime", {
set: function(e) {
this._intervalTime = e;
},
enumerable: !1,
configurable: !0
});
Object.defineProperty(e, "Instance", {
get: function() {
e._Instance || (e._Instance = new e());
return e._Instance;
},
enumerable: !1,
configurable: !0
});
e.prototype._onReceiveHearBeat = function() {
this._sendHearBeat();
this._delay = new Date().getTime() - this._sendTime;
this._sendTime = 0;
this._delay > this._intervalTime && (this._delay = this._intervalTime);
r.default.Instance.Global.emit(n.GameEvent.HEAR_BEAT_DELAY, this._delay);
};
e.prototype._sendHearBeat = function() {
var e = this;
s.default.log("----------sendHearBeat");
this._endHearBeat();
this._hearBeatFuncID = setTimeout(function() {
var t = c.default.Instance.makeMsg(a.C2S.HB, {
u: e.uid
});
e._sendTime = new Date().getTime();
c.default.Instance.send(t);
e._timeoutFuncID = setTimeout(function() {
c.default.Instance.closeWS();
}, e._intervalTime);
}, this._intervalTime);
};
e.prototype._beginHearBeat = function() {
this._sendHearBeat();
this._begun = !0;
};
e.prototype._endHearBeat = function() {
-1 != this._hearBeatFuncID && clearTimeout(this._hearBeatFuncID);
-1 != this._timeoutFuncID && clearTimeout(this._timeoutFuncID);
this._hearBeatFuncID = -1;
this._timeoutFuncID = -1;
this._begun = !1;
};
e.prototype.begin = function() {
s.default.log("----------beginHearBeat");
this._beginHearBeat();
r.default.Instance.Net.bind(i.S2C.HB.HB, this._onReceiveHearBeat, this);
};
e.prototype.end = function() {
s.default.log("----------endHearBeat");
this._endHearBeat();
r.default.Instance.Net.unbind(i.S2C.HB.HB, this._onReceiveHearBeat, this);
};
e._Instance = null;
return e;
}();
o.default = u;
cc._RF.pop();
}, {
"../../../Game/client/global/enum/game/Event": "Event",
"../../../Game/client/global/enum/net/C2S": "C2S",
"../../../Game/client/global/enum/net/S2C": "S2C",
"../../../Game/fromework/helper/EventHelper": "EventHelper",
"../../../Game/fromework/mvvm/modelView/ViewModel": "ViewModel",
"../../../fromework/helper/NetHelper": "NetHelper",
"../../../platform/Platform": "Platform"
} ],
HelpView: [ function(e, t, o) {
"use strict";
cc._RF.push(t, "60d61723idFw7DkgIFW4lU9", "HelpView");
var n, a = this && this.__extends || (n = function(e, t) {
return (n = Object.setPrototypeOf || {
__proto__: []
} instanceof Array && function(e, t) {
e.__proto__ = t;
} || function(e, t) {
for (var o in t) Object.prototype.hasOwnProperty.call(t, o) && (e[o] = t[o]);
})(e, t);
}, function(e, t) {
n(e, t);
function o() {
this.constructor = e;
}
e.prototype = null === t ? Object.create(t) : (o.prototype = t.prototype, new o());
}), i = this && this.__decorate || function(e, t, o, n) {
var a, i = arguments.length, r = i < 3 ? t : null === n ? n = Object.getOwnPropertyDescriptor(t, o) : n;
if ("object" == typeof Reflect && "function" == typeof Reflect.decorate) r = Reflect.decorate(e, t, o, n); else for (var l = e.length - 1; l >= 0; l--) (a = e[l]) && (r = (i < 3 ? a(r) : i > 3 ? a(t, o, r) : a(t, o)) || r);
return i > 3 && r && Object.defineProperty(t, o, r), r;
};
Object.defineProperty(o, "__esModule", {
value: !0
});
var r = e("../../../../Game/fromework/helper/UIHelper"), l = e("../../../component/Card"), s = [ {
pos: cc.v2(-546.955, 0),
scale: 1,
zIndex: -2
}, {
pos: cc.v2(-300.257, 0),
scale: 1,
zIndex: -1
}, {
pos: cc.v2(42.287, 0),
scale: 1,
zIndex: 5
}, {
pos: cc.v2(209.598, 0),
scale: 1,
zIndex: 6
}, {
pos: cc.v2(378.463, 0),
scale: 1,
zIndex: 7
}, {
pos: cc.v2(546.251, 0),
scale: 1,
zIndex: 8
} ], c = [ {
pos: cc.v2(-568.161, 0),
scale: 1,
zIndex: 0
}, {
pos: cc.v2(-510.161, 0),
scale: 1,
zIndex: 1
}, {
pos: cc.v2(-452.161, 0),
scale: 1,
zIndex: 2
}, {
pos: cc.v2(-249.494, 0),
scale: 1,
zIndex: 3
}, {
pos: cc.v2(-191.494, 0),
scale: 1,
zIndex: 4
}, {
pos: cc.v2(-133.494, 0),
scale: 1,
zIndex: 5
}, {
pos: cc.v2(70.557, 0),
scale: 1,
zIndex: 6
}, {
pos: cc.v2(128.557, 0),
scale: 1,
zIndex: 7
}, {
pos: cc.v2(186.557, 0),
scale: 1,
zIndex: 8
}, {
pos: cc.v2(244.557, 0),
scale: 1,
zIndex: 9
}, {
pos: cc.v2(446.062, 0),
scale: 1,
zIndex: 10
}, {
pos: cc.v2(504.062, 0),
scale: 1,
zIndex: 11
}, {
pos: cc.v2(562.062, 0),
scale: 1,
zIndex: 12
} ], u = [ {
pos: cc.v2(-374.186, 0),
scale: 1,
zIndex: 0
}, {
pos: cc.v2(-316.186, 0),
scale: 1,
zIndex: 1
}, {
pos: cc.v2(-258.186, 0),
scale: 1,
zIndex: 2
}, {
pos: cc.v2(-75.665, 0),
scale: 1,
zIndex: 3
}, {
pos: cc.v2(-17.665, 0),
scale: 1,
zIndex: 4
}, {
pos: cc.v2(40.335, 0),
scale: 1,
zIndex: 5
}, {
pos: cc.v2(220.835, 0),
scale: 1,
zIndex: 6
}, {
pos: cc.v2(278.835, 0),
scale: 1,
zIndex: 7
}, {
pos: cc.v2(336.835, 0),
scale: 1,
zIndex: 8
} ], d = [ {
pos: cc.v2(-613.42, 52),
scale: 1,
zIndex: 3
}, {
pos: cc.v2(-555.42, 52),
scale: 1,
zIndex: 4
}, {
pos: cc.v2(-497.42, 0),
scale: 1,
zIndex: 5
}, {
pos: cc.v2(-304.35, 0),
scale: 1,
zIndex: 6
}, {
pos: cc.v2(-246.35, 0),
scale: 1,
zIndex: 7
}, {
pos: cc.v2(-188.35, 0),
scale: 1,
zIndex: 8
}, {
pos: cc.v2(3.41, 0),
scale: 1,
zIndex: 9
}, {
pos: cc.v2(61.41, 0),
scale: 1,
zIndex: 10
}, {
pos: cc.v2(119.41, 0),
scale: 1,
zIndex: 11
}, {
pos: cc.v2(177.41, 0),
scale: 1,
zIndex: 12
}, {
pos: cc.v2(370.521, 52),
scale: 1,
zIndex: 13
}, {
pos: cc.v2(428.521, 0),
scale: 1,
zIndex: 14
}, {
pos: cc.v2(619.634, 0),
scale: 1,
zIndex: 15
} ], p = [ {
pos: cc.v2(-614.687, 0),
scale: 1,
zIndex: 1
}, {
pos: cc.v2(-556.687, 0),
scale: 1,
zIndex: 2
}, {
pos: cc.v2(-498.687, 0),
scale: 1,
zIndex: 3
}, {
pos: cc.v2(-306, 0),
scale: 1,
zIndex: 4
}, {
pos: cc.v2(-248, 0),
scale: 1,
zIndex: 5
}, {
pos: cc.v2(-190, 0),
scale: 1,
zIndex: 6
}, {
pos: cc.v2(1, 0),
scale: 1,
zIndex: 7
}, {
pos: cc.v2(59, 0),
scale: 1,
zIndex: 8
}, {
pos: cc.v2(117, 0),
scale: 1,
zIndex: 9
}, {
pos: cc.v2(175, 0),
scale: 1,
zIndex: 10
}, {
pos: cc.v2(368, 0),
scale: 1,
zIndex: 11
}, {
pos: cc.v2(426, 65),
scale: 1,
zIndex: 12
}, {
pos: cc.v2(620, 0),
scale: 1,
zIndex: 13
} ], h = [ {
pos: cc.v2(-623.181, 0),
scale: 1,
zIndex: 1
}, {
pos: cc.v2(-565.181, 0),
scale: 1,
zIndex: 2
}, {
pos: cc.v2(-507.181, 0),
scale: 1,
zIndex: 3
}, {
pos: cc.v2(-314.111, 0),
scale: 1,
zIndex: 4
}, {
pos: cc.v2(-256.111, 0),
scale: 1,
zIndex: 5
}, {
pos: cc.v2(-198.111, 0),
scale: 1,
zIndex: 6
}, {
pos: cc.v2(-6.351, 0),
scale: 1,
zIndex: 7
}, {
pos: cc.v2(51.649, 0),
scale: 1,
zIndex: 8
}, {
pos: cc.v2(109.649, 0),
scale: 1,
zIndex: 9
}, {
pos: cc.v2(167.649, 0),
scale: 1,
zIndex: 10
}, {
pos: cc.v2(360.76, 0),
scale: 1,
zIndex: 11
}, {
pos: cc.v2(418.76, 0),
scale: 1,
zIndex: 12
}, {
pos: cc.v2(609.873, 52),
scale: 1,
zIndex: 13
} ], f = [ {
pos: cc.v2(-290, 0),
scale: 1,
zIndex: 0
}, {
pos: cc.v2(-90, 0),
scale: 1,
zIndex: 1
}, {
pos: cc.v2(90, 0),
scale: 1,
zIndex: 2
}, {
pos: cc.v2(290, 0),
scale: 1,
zIndex: 3
} ], _ = [ {
pos: cc.v2(-689.471, 0),
scale: 1,
zIndex: 0
}, {
pos: cc.v2(-631.471, 0),
scale: 1,
zIndex: 1
}, {
pos: cc.v2(-573.471, 0),
scale: 1,
zIndex: 2
}, {
pos: cc.v2(-371.155, 0),
scale: 1,
zIndex: 3
}, {
pos: cc.v2(-313.155, 0),
scale: 1,
zIndex: 4
}, {
pos: cc.v2(-255.155, 0),
scale: 1,
zIndex: 5
}, {
pos: cc.v2(-50.212, 0),
scale: 1,
zIndex: 6
}, {
pos: cc.v2(7.788, 0),
scale: 1,
zIndex: 7
}, {
pos: cc.v2(65.788, 0),
scale: 1,
zIndex: 8
}, {
pos: cc.v2(123.788, 0),
scale: 1,
zIndex: 9
}, {
pos: cc.v2(325.668, 0),
scale: 1,
zIndex: 10
}, {
pos: cc.v2(383.668, 0),
scale: 1,
zIndex: 11
}, {
pos: cc.v2(441.668, 0),
scale: 1,
zIndex: 12
} ], m = [ {
pos: cc.v2(-670, 0),
scale: 1,
zIndex: 1
}, {
pos: cc.v2(-612, 0),
scale: 1,
zIndex: 2
}, {
pos: cc.v2(-554, 0),
scale: 1,
zIndex: 3
}, {
pos: cc.v2(-354, 0),
scale: 1,
zIndex: 4
}, {
pos: cc.v2(-296, 0),
scale: 1,
zIndex: 5
}, {
pos: cc.v2(-238, 0),
scale: 1,
zIndex: 6
}, {
pos: cc.v2(-35, 0),
scale: 1,
zIndex: 7
}, {
pos: cc.v2(23, 0),
scale: 1,
zIndex: 8
}, {
pos: cc.v2(81, 0),
scale: 1,
zIndex: 9
}, {
pos: cc.v2(139, 0),
scale: 1,
zIndex: 10
}, {
pos: cc.v2(337, 0),
scale: 1,
zIndex: 11
}, {
pos: cc.v2(395, 0),
scale: 1,
zIndex: 12
}, {
pos: cc.v2(453, 0),
scale: 1,
zIndex: 13
}, {
pos: cc.v2(652.226, 52),
scale: 1,
zIndex: 14
} ], y = [ {
pos: cc.v2(-468, 0),
scale: 1,
zIndex: 0
}, {
pos: cc.v2(-410, 0),
scale: 1,
zIndex: 1
}, {
pos: cc.v2(-352, 0),
scale: 1,
zIndex: 2
}, {
pos: cc.v2(-84, 0),
scale: 1,
zIndex: 3
}, {
pos: cc.v2(-26, 0),
scale: 1,
zIndex: 4
}, {
pos: cc.v2(32, 0),
scale: 1,
zIndex: 5
}, {
pos: cc.v2(289, 0),
scale: 1,
zIndex: 6
}, {
pos: cc.v2(347, 0),
scale: 1,
zIndex: 7
}, {
pos: cc.v2(405, 0),
scale: 1,
zIndex: 8
}, {
pos: cc.v2(463, 0),
scale: 1,
zIndex: 9
} ], g = cc._decorator, v = g.ccclass, C = g.property, b = function(e) {
a(t, e);
function t() {
var t = null !== e && e.apply(this, arguments) || this;
t.Views = [];
t.Card_Prefab = null;
t.Detail1Cards = null;
t.Detail2Cards = null;
t.Detail3Cards = null;
t.Detail4Cards = null;
t.Detail5Cards = null;
t.Detail6Cards = null;
t.Detail7Cards_1 = null;
t.Detail7Cards_2 = null;
t.Detail8Cards = null;
t.Detail9Cards = null;
t._currIndex = -1;
return t;
}
t.prototype.refreshDetail1 = function() {
var e = this, t = [ 66, 42, 58, 42, 26, 10 ];
s.forEach(function(o, n) {
var a = cc.instantiate(e.Card_Prefab);
a.parent = e.Detail1Cards;
a.setPosition(o.pos);
a.setScale(o.scale);
a.zIndex = o.zIndex;
var i = a.getComponent(l.default);
i.init(t[n], !0, 42);
i.WildCard.node.active = 0 != n;
});
};
t.prototype.refreshDetail2 = function() {
var e = this, t = [ 55, 56, 57, 43, 45, 66, 1, 2, 4, 42, 21, 55, 27 ];
c.forEach(function(o, n) {
var a = cc.instantiate(e.Card_Prefab);
a.parent = e.Detail2Cards;
a.setPosition(o.pos);
a.setScale(o.scale);
a.zIndex = o.zIndex;
var i = a.getComponent(l.default);
i.init(t[n], !0, 42);
i.WildCard.node.active = 9 == n;
});
};
t.prototype.refreshDetail3 = function() {
var e = this, t = [ 56, 66, 24, 43, 11, 27, 10, 53, 5 ];
u.forEach(function(o, n) {
var a = cc.instantiate(e.Card_Prefab);
a.parent = e.Detail3Cards;
a.setPosition(o.pos);
a.setScale(o.scale);
a.zIndex = o.zIndex;
var i = a.getComponent(l.default);
i.init(t[n], !0, 42);
i.WildCard.node.active = 6 == n;
});
};
t.prototype.refreshDetail4 = function() {
var e = this, t = [ 55, 56, 25, 35, 5, 18, 34, 18, 4, 43, 54, 21, 1 ];
d.forEach(function(o, n) {
var a = cc.instantiate(e.Card_Prefab);
a.parent = e.Detail4Cards;
a.setPosition(o.pos);
a.setScale(o.scale);
a.zIndex = o.zIndex;
a.getComponent(l.default).init(t[n], !0, 0);
});
};
t.prototype.refreshDetail5 = function() {
var e = this, t = [ 55, 56, 57, 8, 9, 11, 34, 35, 36, 37, 50, 10, 3 ];
p.forEach(function(o, n) {
var a = cc.instantiate(e.Card_Prefab);
a.parent = e.Detail5Cards;
a.setPosition(o.pos);
a.setScale(o.scale);
a.zIndex = o.zIndex;
a.getComponent(l.default).init(t[n], !0, 0);
});
};
t.prototype.refreshDetail6 = function() {
var e = this, t = [ 55, 56, 57, 35, 57, 23, 34, 35, 36, 37, 50, 37, 3 ];
h.forEach(function(o, n) {
var a = cc.instantiate(e.Card_Prefab);
a.parent = e.Detail6Cards;
a.setPosition(o.pos);
a.setScale(o.scale);
a.zIndex = o.zIndex;
a.getComponent(l.default).init(t[n], !0, 0);
});
};
t.prototype.refreshDetail7 = function() {
var e = this, t = [ 33, 45, 44, 43 ];
f.forEach(function(o, n) {
var a = cc.instantiate(e.Card_Prefab);
a.parent = e.Detail7Cards_1;
a.setPosition(o.pos);
a.setScale(o.scale);
a.zIndex = o.zIndex;
a.getComponent(l.default).init(t[n], !0, 0);
});
var o = [ 59, 60, 61, 50, 51, 66, 1, 3, 4, 42, 19, 57, 27 ];
_.forEach(function(t, n) {
var a = cc.instantiate(e.Card_Prefab);
a.parent = e.Detail7Cards_2;
a.setPosition(t.pos);
a.setScale(t.scale);
a.zIndex = t.zIndex;
var i = a.getComponent(l.default);
i.init(o[n], !0, 0);
i.WildCard.node.active = 9 == n;
});
};
t.prototype.refreshDetail8 = function() {
var e = this, t = [ 59, 60, 61, 33, 34, 66, 3, 4, 6, 42, 22, 38, 6, 21 ];
m.forEach(function(o, n) {
var a = cc.instantiate(e.Card_Prefab);
a.parent = e.Detail8Cards;
a.setPosition(o.pos);
a.setScale(o.scale);
a.zIndex = o.zIndex;
var i = a.getComponent(l.default);
i.init(t[n], !0, 0);
i.WildCard.node.active = 9 == n;
});
};
t.prototype.refreshDetail9 = function() {
var e = this, t = [ 59, 60, 61, 35, 36, 66, 6, 54, 38, 22 ];
y.forEach(function(o, n) {
var a = cc.instantiate(e.Card_Prefab);
a.parent = e.Detail9Cards;
a.setPosition(o.pos);
a.setScale(o.scale);
a.zIndex = o.zIndex;
a.getComponent(l.default).init(t[n], !0, 0);
});
};
t.prototype.onLoad = function() {
this.refreshDetail1();
this.refreshDetail2();
this.refreshDetail3();
this.refreshDetail4();
this.refreshDetail5();
this.refreshDetail6();
this.refreshDetail7();
this.refreshDetail8();
this.refreshDetail9();
};
t.prototype.onToggleClicked = function(e, t) {
var o = parseInt(t);
if (this._currIndex != o) {
this._currIndex = o;
this.Views.forEach(function(e, t) {
e.active = t == o;
});
}
};
t.prototype.onCloseClicked = function() {
r.default.Instance.removeMaskLayer(this.node);
};
i([ C([ cc.Node ]) ], t.prototype, "Views", void 0);
i([ C(cc.Prefab) ], t.prototype, "Card_Prefab", void 0);
i([ C(cc.Node) ], t.prototype, "Detail1Cards", void 0);
i([ C(cc.Node) ], t.prototype, "Detail2Cards", void 0);
i([ C(cc.Node) ], t.prototype, "Detail3Cards", void 0);
i([ C(cc.Node) ], t.prototype, "Detail4Cards", void 0);
i([ C(cc.Node) ], t.prototype, "Detail5Cards", void 0);
i([ C(cc.Node) ], t.prototype, "Detail6Cards", void 0);
i([ C(cc.Node) ], t.prototype, "Detail7Cards_1", void 0);
i([ C(cc.Node) ], t.prototype, "Detail7Cards_2", void 0);
i([ C(cc.Node) ], t.prototype, "Detail8Cards", void 0);
i([ C(cc.Node) ], t.prototype, "Detail9Cards", void 0);
return i([ v ], t);
}(cc.Component);
o.default = b;
cc._RF.pop();
}, {
"../../../../Game/fromework/helper/UIHelper": "UIHelper",
"../../../component/Card": "Card"
} ],
ImageLoader: [ function(e, t, o) {
"use strict";
cc._RF.push(t, "9e12d4Un9VKmbms4FKff+7C", "ImageLoader");
var n, a = this && this.__extends || (n = function(e, t) {
return (n = Object.setPrototypeOf || {
__proto__: []
} instanceof Array && function(e, t) {
e.__proto__ = t;
} || function(e, t) {
for (var o in t) Object.prototype.hasOwnProperty.call(t, o) && (e[o] = t[o]);
})(e, t);
}, function(e, t) {
n(e, t);
function o() {
this.constructor = e;
}
e.prototype = null === t ? Object.create(t) : (o.prototype = t.prototype, new o());
}), i = this && this.__decorate || function(e, t, o, n) {
var a, i = arguments.length, r = i < 3 ? t : null === n ? n = Object.getOwnPropertyDescriptor(t, o) : n;
if ("object" == typeof Reflect && "function" == typeof Reflect.decorate) r = Reflect.decorate(e, t, o, n); else for (var l = e.length - 1; l >= 0; l--) (a = e[l]) && (r = (i < 3 ? a(r) : i > 3 ? a(t, o, r) : a(t, o)) || r);
return i > 3 && r && Object.defineProperty(t, o, r), r;
};
Object.defineProperty(o, "__esModule", {
value: !0
});
var r = e("../../Game/fromework/global/Tools"), l = e("../../platform/Platform"), s = cc._decorator, c = s.ccclass, u = (s.property, 
s.requireComponent), d = function(e) {
a(t, e);
function t() {
return null !== e && e.apply(this, arguments) || this;
}
t.prototype.saveAndLoad = function(e) {
var t = this, o = jsb.fileUtils.getWritablePath() + "UserImagePath/";
l.default.log("dirpath ->", o);
l.default.log("UserImagePath Size:", jsb.fileUtils.getFileSize(o + "202dfe473e100c18f54b48f416fe124b.png"));
var n = r.Tools.JSMD5.md5(e), a = o + n + ".png";
l.default.log("filePath ->", a);
var i = function(e) {
cc.assetManager.loadRemote(e, {
ext: ".png"
}, function(e, o) {
e ? l.default.log("[ImageLoader:]load fileUrl error:" + e) : !e && t && t.node && t.node.isValid && (t.node.getComponent(cc.Sprite).spriteFrame = new cc.SpriteFrame(o));
});
};
if (jsb.fileUtils.isFileExist(a)) {
l.default.log("Remote is find ->" + a);
i(a);
} else {
var s = function(e) {
if ("undefined" != typeof e) {
jsb.fileUtils.isDirectoryExist(o) ? l.default.log("路径exist") : jsb.fileUtils.createDirectory(o);
if (jsb.fileUtils.writeDataToFile(new Uint8Array(e), a)) {
l.default.log("Remote write file successed.");
i(a);
} else l.default.log("Remote write file failed.");
} else l.default.log("Remote download file failed.");
}, c = new XMLHttpRequest();
c.onreadystatechange = function() {
l.default.log("xhr.readyState  " + c.readyState);
l.default.log("xhr.status  " + c.status);
4 === c.readyState && (200 === c.status ? s(c.response) : s(null));
};
c.responseType = "arraybuffer";
c.open("GET", e, !0);
c.send();
}
};
t.prototype.setUrl = function(e, t) {
var o = this;
cc.sys.isNative && jsb.fileUtils ? this.saveAndLoad(e) : cc.assetManager.loadRemote(e, {
ext: ".png"
}, function(e, n) {
t && t(e);
e ? l.default.log("[ImageLoader:]load filePath error:" + e) : !e && o && o.node && o.node.isValid && (o.node.getComponent(cc.Sprite).spriteFrame = new cc.SpriteFrame(n));
});
};
return i([ c, u(cc.Sprite) ], t);
}(cc.Component);
o.default = d;
cc._RF.pop();
}, {
"../../Game/fromework/global/Tools": "Tools",
"../../platform/Platform": "Platform"
} ],
InviteModel: [ function(e, t, o) {
"use strict";
cc._RF.push(t, "c7f06h3UsVMEbiKYXvYj3r7", "InviteModel");
Object.defineProperty(o, "__esModule", {
value: !0
});
o.InviteModel = void 0;
var n = e("../../Game/client/global/enum/game/Event"), a = e("../../Game/fromework/global/Tools"), i = e("../../Game/fromework/helper/EventHelper"), r = e("../../Game/fromework/mvvm/modelView/ViewModel"), l = e("../../platform/Platform"), s = e("./ReferModel"), c = function() {
function e() {
this._createCallFunc = null;
this._getCallFunc = null;
this._createLink = "";
this._getLink = "";
}
Object.defineProperty(e, "Instance", {
get: function() {
e._instance || (e._instance = new e());
return e._instance;
},
enumerable: !1,
configurable: !0
});
e.prototype.Init = function() {
i.default.Instance.Global.bind(n.PlatformEvent.PLATFORM_FIREBASE_CREATELINK, this.onLinkCreate, this);
i.default.Instance.Global.bind(n.PlatformEvent.PLATFORM_FIREBASE_GETLINK, this.onLinkGet, this);
};
e.prototype.clear = function() {
i.default.Instance.Global.unbind(n.PlatformEvent.PLATFORM_FIREBASE_CREATELINK, this.onLinkCreate, this);
i.default.Instance.Global.unbind(n.PlatformEvent.PLATFORM_FIREBASE_GETLINK, this.onLinkGet, this);
};
Object.defineProperty(e.prototype, "createLink", {
get: function() {
return this._createLink;
},
enumerable: !1,
configurable: !0
});
Object.defineProperty(e.prototype, "getLink", {
get: function() {
return this._getLink;
},
enumerable: !1,
configurable: !0
});
e.prototype.getLinkUid = function() {
var e = a.Tools.TUrl.getQueryString(this._getLink);
l.default.log("getLinkUid", this._getLink, e.invite_id);
return e ? e.invite_id : 0;
};
e.prototype.getLinkRoomID = function() {
var e = a.Tools.TUrl.getQueryString(this._getLink);
return e ? e.room_id : 0;
};
e.prototype.onLinkCreate = function(e) {
var t = e.getUserData();
this._createLink = t;
if (this._createCallFunc) {
this._createCallFunc();
this._createCallFunc = null;
}
i.default.Instance.Global.emit(n.InviteEvent.CREATE_LINK, t);
};
e.prototype.onLinkGet = function(e) {
var t = e.getUserData();
l.default.log("onLinkGet", t);
if ("" != t) {
this._getLink = t;
if (this._getCallFunc) {
this._getCallFunc();
this._getCallFunc = null;
}
i.default.Instance.Global.emit(n.InviteEvent.GET_LINK, t);
}
};
e.prototype.refreshDynamicLink = function(e, t) {
void 0 === t && (t = 0);
this._createCallFunc = e;
var o = {};
o.invite_id = r.VM.getValue("user.uid");
o.room_id = t;
s.ReferProxy.Instance.getReferUrl(o);
};
e.prototype.getDynamicLink = function(e) {
this._getCallFunc = e;
};
e._instance = null;
return e;
}();
o.InviteModel = c;
cc._RF.pop();
}, {
"../../Game/client/global/enum/game/Event": "Event",
"../../Game/fromework/global/Tools": "Tools",
"../../Game/fromework/helper/EventHelper": "EventHelper",
"../../Game/fromework/mvvm/modelView/ViewModel": "ViewModel",
"../../platform/Platform": "Platform",
"./ReferModel": "ReferModel"
} ],
ItemModel: [ function(e, t, o) {
"use strict";
cc._RF.push(t, "0b2d0TkJtJKuZmYpnNvDJfl", "ItemModel");
Object.defineProperty(o, "__esModule", {
value: !0
});
o.ItemProxy = void 0;
var n = e("../../Game/client/global/enum/game/Event"), a = e("../../Game/client/global/enum/net/C2S"), i = e("../../Game/client/global/enum/net/S2C"), r = e("../../Game/fromework/helper/ConfigHelper"), l = e("../../Game/fromework/helper/EventHelper"), s = e("../../Game/fromework/mvvm/modelView/ViewModel"), c = e("../../fromework/helper/NetHelper"), u = e("../global/PopHelper"), d = function() {
function e() {
this._itemMap = new Map();
}
Object.defineProperty(e, "Instance", {
get: function() {
e._instance || (e._instance = new e());
return e._instance;
},
enumerable: !1,
configurable: !0
});
e.prototype.Init = function() {
l.default.Instance.Net.bind(i.S2C.ITEM.ITEM_GET_USER_ITEM, this._onGetUserItem, this);
l.default.Instance.Net.bind(i.S2C.ITEM.ITEM_ADD_USER_ITEM, this._onAddUserItem, this);
l.default.Instance.Net.bind(i.S2C.ITEM.ITEM_REDUCE_USER_ITEM, this._onReduceUserItem, this);
};
e.prototype.clear = function() {
l.default.Instance.Net.unbind(i.S2C.ITEM.ITEM_GET_USER_ITEM, this._onGetUserItem, this);
l.default.Instance.Net.unbind(i.S2C.ITEM.ITEM_ADD_USER_ITEM, this._onAddUserItem, this);
l.default.Instance.Net.unbind(i.S2C.ITEM.ITEM_REDUCE_USER_ITEM, this._onReduceUserItem, this);
this._itemMap.clear();
};
Object.defineProperty(e.prototype, "uid", {
get: function() {
return s.VM.getValue("user.uid");
},
enumerable: !1,
configurable: !0
});
Object.defineProperty(e.prototype, "token", {
get: function() {
return s.VM.getValue("user.token");
},
enumerable: !1,
configurable: !0
});
e.prototype.getItemCount = function(e) {
return this._itemMap.has(e) ? this._itemMap.get(e) : 0;
};
e.prototype._onGetUserItem = function(e) {
var t = this, o = e.getUserData();
this._itemMap.clear();
if (null != o.items) {
var a = Object.keys(null == o ? void 0 : o.items);
null != a && a.forEach(function(e) {
t._itemMap.set(parseInt(e), o.items[e]);
});
}
l.default.Instance.Global.emit(n.ItemEvent.ITEM_REFRESH);
};
e.prototype._onAddUserItem = function(e) {
var t = this, o = e.getUserData();
if (null != o.items) {
var a = Object.keys(null == o ? void 0 : o.items);
null != a && a.forEach(function(e) {
t._itemMap.has(parseInt(e)) ? t._itemMap.set(parseInt(e), t._itemMap.get(parseInt(e)) + parseInt(o.items[e])) : t._itemMap.set(parseInt(e), parseInt(o.items[e]));
var n = r.ConfigHelper.Instance.getLine("item", e);
n && 1 == n.type && u.PopHelper.Instance.showSlotItemAlert(parseInt(e));
});
}
l.default.Instance.Global.emit(n.ItemEvent.ITEM_ADD);
};
e.prototype._onReduceUserItem = function(e) {
var t = this, o = e.getUserData();
if (null != o.items) {
var a = Object.keys(null == o ? void 0 : o.items);
null != a && a.forEach(function(e) {
t._itemMap.has(parseInt(e)) && t._itemMap.set(parseInt(e), t._itemMap.get(parseInt(e)) - parseInt(o.items[e]));
});
}
l.default.Instance.Global.emit(n.ItemEvent.ITEM_REDUCE);
};
e.prototype.sendGetUserItem = function() {
var e = c.default.Instance.makeMsg(a.C2S.ITEM_GET_USER_ITEM, {
u: this.uid,
t: this.token
});
c.default.Instance.send(e);
};
e._instance = null;
return e;
}();
o.ItemProxy = d;
cc._RF.pop();
}, {
"../../Game/client/global/enum/game/Event": "Event",
"../../Game/client/global/enum/net/C2S": "C2S",
"../../Game/client/global/enum/net/S2C": "S2C",
"../../Game/fromework/helper/ConfigHelper": "ConfigHelper",
"../../Game/fromework/helper/EventHelper": "EventHelper",
"../../Game/fromework/mvvm/modelView/ViewModel": "ViewModel",
"../../fromework/helper/NetHelper": "NetHelper",
"../global/PopHelper": "PopHelper"
} ],
JsonOb: [ function(e, t, o) {
"use strict";
cc._RF.push(t, "19a7apFfVxCIYqA2s0Uq6G9", "JsonOb");
Object.defineProperty(o, "__esModule", {
value: !0
});
o.JsonOb = void 0;
var n = Object.prototype, a = {
obj: "[object Object]",
array: "[object Array]"
}, i = [ "push", "pop", "shift", "unshift", "sort", "reverse", "splice" ], r = function() {
function e(e, t) {
n.toString.call(e) !== a.obj && n.toString.call(e) !== a.array && Platform.error("请传入一个对象或数组");
this._callback = t;
this.observe(e);
}
e.prototype.observe = function(e, t) {
var o = this;
n.toString.call(e) === a.array && this.overrideArrayProto(e, t);
Object.keys(e).forEach(function(i) {
var r = o, l = e[i], s = t && t.slice();
s ? s.push(i) : s = [ i ];
Object.defineProperty(e, i, {
get: function() {
return l;
},
set: function(e) {
if (l !== e) {
"[object Object]" === n.toString.call(e) && r.observe(e, s);
r._callback(e, l, s);
l = e;
}
}
});
n.toString.call(e[i]) !== a.obj && n.toString.call(e[i]) !== a.array || o.observe(e[i], s);
}, this);
};
e.prototype.overrideArrayProto = function(e, t) {
var o, n = Array.prototype, a = Object.create(Array.prototype), r = this;
i.forEach(function(e) {
Object.defineProperty(a, e, {
value: function() {
var a = this.slice();
o = n[e].apply(this, arguments);
r.observe(this, t);
r._callback(this, a, t);
return o;
}
});
});
e.__proto__ = a;
};
return e;
}();
o.JsonOb = r;
cc._RF.pop();
}, {} ],
KongQueKaLayer: [ function(e, t, o) {
"use strict";
cc._RF.push(t, "6aaediJqBRNXofvi/U5UxZL", "KongQueKaLayer");
var n, a = this && this.__extends || (n = function(e, t) {
return (n = Object.setPrototypeOf || {
__proto__: []
} instanceof Array && function(e, t) {
e.__proto__ = t;
} || function(e, t) {
for (var o in t) Object.prototype.hasOwnProperty.call(t, o) && (e[o] = t[o]);
})(e, t);
}, function(e, t) {
n(e, t);
function o() {
this.constructor = e;
}
e.prototype = null === t ? Object.create(t) : (o.prototype = t.prototype, new o());
}), i = this && this.__decorate || function(e, t, o, n) {
var a, i = arguments.length, r = i < 3 ? t : null === n ? n = Object.getOwnPropertyDescriptor(t, o) : n;
if ("object" == typeof Reflect && "function" == typeof Reflect.decorate) r = Reflect.decorate(e, t, o, n); else for (var l = e.length - 1; l >= 0; l--) (a = e[l]) && (r = (i < 3 ? a(r) : i > 3 ? a(t, o, r) : a(t, o)) || r);
return i > 3 && r && Object.defineProperty(t, o, r), r;
};
Object.defineProperty(o, "__esModule", {
value: !0
});
var r = e("../../../global/Global"), l = e("../../../../Game/fromework/helper/UIHelper"), s = e("../../../global/PopHelper"), c = e("../../active/ActiveModel"), u = e("../../../component/pop/tipsHand"), d = cc._decorator, p = d.ccclass, h = d.property, f = function(e) {
a(t, e);
function t() {
var t = null !== e && e.apply(this, arguments) || this;
t.layer1 = null;
t.layer2 = null;
t.detailLayer = null;
t.btnleft = null;
t.btnright = null;
t.btnClose = null;
t.num = null;
t.maxValue = null;
t.getValue = null;
t.layer1AddCash = null;
t.layer2AddCash = null;
t.layer2GetReceived = null;
t.showValue1 = null;
t.showValue2 = null;
t.showValue3 = null;
t.ownblue = null;
t.ownGreen = null;
t.LayerItem = null;
t.ItemScoll = null;
t.itemSpr = [];
t.itemIconSpr = [];
t.buyNum = 1;
t.getKongQueKaData = null;
t.currentItem = 0;
t.isBuyCard = !1;
t.canBuyTime = 10;
t.maxCountSelect = 10;
t.bInit = !1;
return t;
}
t.prototype.start = function() {
var e = this;
s.PopHelper.Instance.showWaiting(0, "loading...");
c.ActiveProxy.Instance.getKongQueKaData(function(t) {
if (t) {
s.PopHelper.Instance.hideWaiting();
e.bInit = !0;
e.getKongQueKaData = t;
e.intLayer1Info(t);
}
});
};
t.prototype.toggleClick = function(e, t) {
if (0 == Number(t)) {
this.layer1.active = !0;
this.layer2.active = !1;
} else {
this.layer1.active = !1;
this.layer2.active = !0;
}
};
t.prototype.intLayer1Info = function(e) {
var t = this;
if (e && e.cards && null != e.cards && this.node.isValid) {
this.ItemScoll.destroyAllChildren();
var o = 0, n = function(n) {
if (e.cards.hasOwnProperty(n)) {
var i = e.cards[n], r = cc.instantiate(a.LayerItem);
r.active = !0;
r.getComponent(cc.Sprite).tag = n;
a.ItemScoll.addChild(r);
r.getComponent(cc.Sprite).spriteFrame = o <= 3 ? a.itemSpr[o] : a.itemSpr[0];
r.getChildByName("kongque1").getComponent(cc.Sprite).spriteFrame = o <= 3 ? a.itemIconSpr[o] : a.itemIconSpr[0];
r.getChildByName("moneyLabel").getComponent(cc.Label).string = (i.deposit / 1e3).toString();
r.getChildByName("cardLabel").getComponent(cc.Label).string = (i.deposit / 1e3).toString() + " CARD";
for (var l = 0; l < 10; l++) {
var s = "rewardNode" + (l + 1), c = r.getChildByName("itemLayout").getChildByName(s).getChildByName("rewardLabel").getComponent(cc.Label);
c && c.isValid && (c.getComponent(cc.Label).string = i.percents[l] + "%");
i.own == l + 1 && (r.getChildByName("itemLayout").getChildByName(s).getChildByName("xuanzhong").active = !0);
}
r.on(cc.Node.EventType.TOUCH_END, function() {
t.onItemClick(r.getComponent(cc.Sprite).tag);
}, a);
o += 1;
}
}, a = this;
for (var i in e.cards) n(i);
}
var r = e.cards[0], l = e.cards[1], s = e.schedule, c = e.drew;
this.showValue1.getComponent(cc.Label).string = (Number(s[1]) / 1e3).toString();
this.showValue2.getComponent(cc.Label).string = (Number(s[2]) / 1e3).toString();
this.showValue3.getComponent(cc.Label).string = (Number(s[3]) / 1e3).toString();
this.ownblue.getComponent(cc.Label).string = r.own;
this.ownGreen.getComponent(cc.Label).string = l.own;
this.layer2GetReceived.node.getChildByName("text").getComponent(cc.Label).string = (Number(s[0]) / 1e3).toString();
this.layer2GetReceived.node.getChildByName("receicedTag").active = !!c;
this.layer2GetReceived.interactable = !c;
this.canBuyTime = e.max_own_count;
this.isBuyCard = Number(r.own + l.own) > 0;
this.maxValue.string = this.canBuyTime.toString();
this.scheduleOnce(function() {
t.onItemClick(0);
});
};
t.prototype.onItemClick = function(e) {
if (this.bInit) {
this.ItemScoll.children.forEach(function(t) {
t && t.getComponent(cc.Sprite).tag && t.getComponent(cc.Sprite).tag == e ? t.getChildByName("xuanzhong").active = !0 : t.getChildByName("xuanzhong").active = !1;
});
this.currentItem = Number(e);
this.maxCountSelect = Number(this.canBuyTime) - Number(this.getKongQueKaData.cards[Number(e)].own);
this.buyNum = 1;
this.num.string = this.buyNum.toString();
this.btnleft.interactable = !1;
this.btnright.interactable = !0;
this.layer1UpdateBuyPrice();
}
};
t.prototype.layer1UpdateBuyPrice = function() {
this.layer1AddCash.node.getChildByName("text").getComponent(cc.Label).string = "₹" + this.buyNum * Number(this.getKongQueKaData.cards[this.currentItem].priceQf) / 1e3;
this.getValue.string = (Number(this.getKongQueKaData.cards[this.currentItem].deposit) / 1e3).toString();
this.layer1AddCash.node.getChildByName("tipsHand").active = !1;
this.layer1AddCash.node.getChildByName("tipsHand").active = !0;
this.layer1AddCash.node.getChildByName("tipsHand").getComponent(u.default).show(this.buyNum * Number(this.getKongQueKaData.cards[this.currentItem].priceQf) / 1e3);
if (this.buyNum * Number(this.getKongQueKaData.cards[this.currentItem].priceQf) / 1e3 >= 2e4) {
this.btnright.interactable = !1;
s.PopHelper.Instance.showTips("The maximum limit for a single purchase is 20,000, and more cards can be purchased multiple times.");
}
};
t.prototype.TreasureLeft = function() {
if (this.bInit && this.buyNum > 1) {
this.buyNum = this.buyNum - 1;
this.buyNum <= 1 && (this.btnleft.interactable = !1);
this.btnright.interactable = !0;
this.num.string = this.buyNum.toString();
this.layer1UpdateBuyPrice();
}
};
t.prototype.TreasureRight = function() {
if (this.bInit && this.buyNum < this.maxCountSelect) {
this.buyNum = this.buyNum + 1;
if (this.buyNum >= this.maxCountSelect) {
s.PopHelper.Instance.showTips("Maximum of 10 cards of each type");
this.btnright.interactable = !1;
}
2 == this.buyNum && (this.btnleft.interactable = !0);
this.num.string = this.buyNum.toString();
this.layer1UpdateBuyPrice();
}
};
t.prototype.onLayer1AddCash = function() {
if (this.bInit) {
this.closeClick();
var e = Number(this.num.string);
this.getKongQueKaData && null != this.getKongQueKaData && c.ActiveProxy.Instance.BuyKongQueKaData(this.getKongQueKaData.cards[this.currentItem].id, e, this.buyNum, function() {});
}
};
t.prototype.onGetRecievedClick = function() {
var e = this;
if (this.bInit) if (this.getKongQueKaData.drew) s.PopHelper.Instance.showTips("aready received"); else if ("0" != this.layer2GetReceived.node.getChildByName("text").getComponent(cc.Label).string) {
var t = this.getKongQueKaData.schedule.condit_flow;
this.getKongQueKaData.schedule.flow < t ? s.PopHelper.Instance.showTips("Total wins and losses ₹" + t + "\n are required to receive cash") : c.ActiveProxy.Instance.ReceiveKongQueKaData(function(t) {
s.PopHelper.Instance.showReward(r.Global.Instance.changeReward({
1: t.cash / 1e3
}), function() {
c.ActiveProxy.Instance.getKongQueKaData(function(t) {
if (t) {
e.getKongQueKaData = t;
e.intLayer1Info(t);
}
});
});
});
} else s.PopHelper.Instance.showTips("no receive cash");
};
t.prototype.closeClick = function() {
l.default.Instance.removeMaskLayer(this.node, !0);
};
t.prototype.openDetail = function() {
this.detailLayer.active = !0;
};
t.prototype.closeDetail = function() {
this.detailLayer.active = !1;
};
t.prototype.goToBuy = function() {
this.node.getChildByName("UINode").getChildByName("buttonToggleContainer").getChildByName("toggle1").getComponent(cc.Toggle).isChecked = !0;
this.layer1.active = !0;
this.layer2.active = !1;
};
i([ h(cc.Node) ], t.prototype, "layer1", void 0);
i([ h(cc.Node) ], t.prototype, "layer2", void 0);
i([ h(cc.Node) ], t.prototype, "detailLayer", void 0);
i([ h(cc.Button) ], t.prototype, "btnleft", void 0);
i([ h(cc.Button) ], t.prototype, "btnright", void 0);
i([ h(cc.Button) ], t.prototype, "btnClose", void 0);
i([ h(cc.Label) ], t.prototype, "num", void 0);
i([ h(cc.Label) ], t.prototype, "maxValue", void 0);
i([ h(cc.Label) ], t.prototype, "getValue", void 0);
i([ h(cc.Button) ], t.prototype, "layer1AddCash", void 0);
i([ h(cc.Button) ], t.prototype, "layer2AddCash", void 0);
i([ h(cc.Button) ], t.prototype, "layer2GetReceived", void 0);
i([ h(cc.Label) ], t.prototype, "showValue1", void 0);
i([ h(cc.Label) ], t.prototype, "showValue2", void 0);
i([ h(cc.Label) ], t.prototype, "showValue3", void 0);
i([ h(cc.Label) ], t.prototype, "ownblue", void 0);
i([ h(cc.Label) ], t.prototype, "ownGreen", void 0);
i([ h(cc.Node) ], t.prototype, "LayerItem", void 0);
i([ h(cc.Node) ], t.prototype, "ItemScoll", void 0);
i([ h(cc.SpriteFrame) ], t.prototype, "itemSpr", void 0);
i([ h(cc.SpriteFrame) ], t.prototype, "itemIconSpr", void 0);
return i([ p ], t);
}(cc.Component);
o.default = f;
cc._RF.pop();
}, {
"../../../../Game/fromework/helper/UIHelper": "UIHelper",
"../../../component/pop/tipsHand": "tipsHand",
"../../../global/Global": "Global",
"../../../global/PopHelper": "PopHelper",
"../../active/ActiveModel": "ActiveModel"
} ],
LanguageModel: [ function(e, t, o) {
"use strict";
cc._RF.push(t, "235a5iNpGFIrb4tNvv0eZ4B", "LanguageModel");
Object.defineProperty(o, "__esModule", {
value: !0
});
o.LanguageType = void 0;
var n = e("../../../Game/BundleManager"), a = e("../../fromework/helper/ConfigHelper"), i = e("../../../Game/fromework/mvvm/modelView/ViewModel"), r = e("../../fromework/global/Tools"), l = e("../../Script/global/GlobalValue"), s = e("../global/enum/game/Const");
o.LanguageType = {
en: "en",
hindi: "hindi"
};
var c = function() {
function e() {
this._curLang = "en";
}
Object.defineProperty(e, "Instance", {
get: function() {
e._instance || (e._instance = new e());
return e._instance;
},
enumerable: !1,
configurable: !0
});
e.prototype.getLanguageConfig = function() {
return l.default.getInstance().isCashGame ? a.ConfigHelper.Instance.getConfig("language") : a.ConfigHelper.Instance.getConfig("languagearr");
};
e.getString = function(e) {
var t = i.VM.getValue("Language." + e);
t && (t = r.Tools.TStr.replaceAll(t, "%{money}", i.VM.getValue("Language.MoneySymbol")));
return t || "";
};
e.prototype.Init = function() {
var e = this;
this._curLang = JSON.parse(cc.sys.localStorage.getItem("LanguageType"));
this._curLang = null == this._curLang ? o.LanguageType.en : this._curLang;
var t = this.getLanguageConfig(), n = {};
t.forEach(function(t) {
n[t.id] = t[e._curLang];
});
n.MoneySymbol = l.default.getInstance().isCashGame ? s.MoneySymbol : s.FailMoneySymbol;
null != i.VM.get("Language") && i.VM.remove("Language");
i.VM.add(n, "Language");
};
e.prototype.getCurLanguage = function() {
return this._curLang;
};
e.prototype.changeLanguage = function(e) {
if (this._curLang != e) {
this.getLanguageConfig().forEach(function(t, o) {
i.VM.setValue("Language." + o, t[e]);
});
this._curLang = e;
cc.sys.localStorage.setItem("LanguageType", JSON.stringify(e));
n.default.getInstance().enterBundleScene(s.Scene.Lobby);
}
};
e._instance = null;
return e;
}();
o.default = c;
cc._RF.pop();
}, {
"../../../Game/BundleManager": "BundleManager",
"../../../Game/fromework/mvvm/modelView/ViewModel": "ViewModel",
"../../Script/global/GlobalValue": "GlobalValue",
"../../fromework/global/Tools": "Tools",
"../../fromework/helper/ConfigHelper": "ConfigHelper",
"../global/enum/game/Const": "Const"
} ],
LaunchScene: [ function(e, t, o) {
"use strict";
cc._RF.push(t, "17ca8K9jXpETrn2HUuNFp4f", "LaunchScene");
var n, a = this && this.__extends || (n = function(e, t) {
return (n = Object.setPrototypeOf || {
__proto__: []
} instanceof Array && function(e, t) {
e.__proto__ = t;
} || function(e, t) {
for (var o in t) Object.prototype.hasOwnProperty.call(t, o) && (e[o] = t[o]);
})(e, t);
}, function(e, t) {
n(e, t);
function o() {
this.constructor = e;
}
e.prototype = null === t ? Object.create(t) : (o.prototype = t.prototype, new o());
}), i = this && this.__decorate || function(e, t, o, n) {
var a, i = arguments.length, r = i < 3 ? t : null === n ? n = Object.getOwnPropertyDescriptor(t, o) : n;
if ("object" == typeof Reflect && "function" == typeof Reflect.decorate) r = Reflect.decorate(e, t, o, n); else for (var l = e.length - 1; l >= 0; l--) (a = e[l]) && (r = (i < 3 ? a(r) : i > 3 ? a(t, o, r) : a(t, o)) || r);
return i > 3 && r && Object.defineProperty(t, o, r), r;
};
Object.defineProperty(o, "__esModule", {
value: !0
});
var r = e("../../../platform/Platform"), l = e("../../../Game/BundleManager"), s = e("../../../Game/Script/global/GlobalValue"), c = e("../../../Game/ShellProxy"), u = e("../../../Game/client/global/enum/game/Const"), d = e("../../../Game/client/global/enum/game/Event"), p = e("../../../Game/client/model/LanguageModel"), h = e("../../../Game/client/model/UpdateModel"), f = e("../../../Game/fromework/global/ResLoader"), _ = e("../../../Game/fromework/helper/AudioHelper"), m = e("../../../Game/fromework/helper/ConfigHelper"), y = e("../../../Game/fromework/helper/UIHelper"), g = e("../../../Game/fromework/mvvm/modelView/ViewModel"), v = e("../../../fromework/helper/NetHelper"), C = e("../../global/Global"), b = e("../../model/UserModel"), I = e("../game/HearBeat"), E = e("../../../Config"), S = e("../../../fromework/net/NetWebSocket"), T = e("../../../platform/Log"), R = e("../../../Game/fromework/jslib/Base64IN"), O = e("../../../Game/fromework/helper/EventHelper"), A = cc._decorator, P = A.ccclass, M = A.property, G = A.menu, w = function(e) {
a(t, e);
function t() {
var t = null !== e && e.apply(this, arguments) || this;
t.Background = null;
t.UILayer = null;
t.TopLayer = null;
t.dtSum = 0;
t.progressNode = null;
return t;
}
t.prototype.onEnable = function() {
O.default.Instance.Global.bind(v.NetState.NET_WEBSOCKET_CONNECT_OPEN, this._onConnected, this);
O.default.Instance.Global.bind(d.UserEvent.USER_LOGIN_SUCCESS, this._onLoginSuccess, this);
O.default.Instance.Global.bind(d.ServerEvent.SERVER_CONFIG, this.reciveServerConfig, this);
O.default.Instance.Global.bind(d.ServerEvent.SERVER_GAME_SERVICE, this.checkEntry, this);
};
t.prototype.onDisable = function() {
O.default.Instance.Global.unbind(v.NetState.NET_WEBSOCKET_CONNECT_OPEN, this._onConnected, this);
O.default.Instance.Global.unbind(d.UserEvent.USER_LOGIN_SUCCESS, this._onLoginSuccess, this);
O.default.Instance.Global.unbind(d.ServerEvent.SERVER_CONFIG, this.reciveServerConfig, this);
O.default.Instance.Global.unbind(d.ServerEvent.SERVER_GAME_SERVICE, this.checkEntry, this);
};
t.prototype.onLoad = function() {
T.default.log("LaunchScene  onLoad");
window.base64Ex = R.default.getInstance();
O.default.Instance.Net.start(!0);
O.default.Instance.Global.start(!0);
_.default.Instance.init();
m.ConfigHelper.Instance.init();
y.default.Instance.init();
c.default.Instance.Init();
h.default.Instance.Init();
y.default.Instance.setLayers(this.Background, this.UILayer, this.TopLayer);
cc.game.on(cc.game.EVENT_SHOW, function() {
cc.audioEngine.resumeAll();
S.default.Instance.readyState == WebSocket.OPEN ? I.default.Instance.begun || I.default.Instance.begin() : v.default.Instance.connect();
});
cc.game.on(cc.game.EVENT_HIDE, function() {
cc.audioEngine.pauseAll();
I.default.Instance.end();
});
var e = JSON.parse(cc.sys.localStorage.getItem("Game_Audio_Vibration"));
null == e && (e = !0);
g.VM.setValue("lobbySet.isPlayVibration", e);
this.progressNode = this.UILayer.getChildByName("progressBar");
this.progressNode.active = !0;
this.progressNode.getComponent(cc.ProgressBar).progress = 0;
};
t.prototype.update = function(e) {
this.dtSum += 6 * e / 20;
this.dtSum >= 1 && (this.dtSum = 0);
this.progressNode.getComponent(cc.ProgressBar).progress = this.dtSum;
};
t.prototype.start = function() {
v.default.Instance;
v.default.Instance.HttpUrl = s.default.getInstance().HttpServerUrl;
h.default.Instance.updateVersion = r.default.getVersionCode();
m.ConfigHelper.Instance.loadAllConfig("resources/config", null, function() {
p.default.Instance.Init();
T.default.log("LaunchScene start  sendGetServerConfig");
c.default.Instance.sendGetServerConfig("");
});
};
t.prototype.reciveServerConfig = function() {
T.default.log("LaunchScene reciveServerConfig 0 ");
this.startLaunch();
};
t.prototype.checkEntry = function() {
T.default.log("LaunchScene checkEntry 0 ");
c.default.Instance.sendGetServerConfig("");
};
t.prototype._onLoginSuccess = function() {
if (v.default.Instance.getConnectState() != WebSocket.OPEN && v.default.Instance.getConnectState() != WebSocket.CONNECTING) {
I.default.Instance.intervalTime = 15e3;
v.default.Instance.WebSocketUrl = s.default.getInstance().WebSocketUrl;
v.default.Instance.connect();
} else this._onConnected(null);
};
t.prototype._onConnected = function() {
C.Global.Instance.loginRequest(function(e) {
C.Global.Instance.choiceScene(e);
});
};
t.prototype.preLoad = function() {
var e = this;
T.default.log("LaunchScene preLoad 0 ");
for (var t = [ u.BundleUIPath.Waiting, u.BundleUIPath.TableBoard ], o = 0, n = 0; n < t.length; n++) f.default.Instance.loadBundleRes(t[n], cc.Prefab, function() {
o++;
T.default.log("LaunchScene preLoad -  " + o);
o == t.length && e.startGame();
});
};
t.prototype.startLaunch = function() {
C.Global.Instance.initModel();
this.preLoad();
};
t.prototype.startGame = function() {
if (JSON.parse(cc.sys.localStorage.getItem("isRelogin")) || !cc.sys.isNative) {
cc.sys.localStorage.setItem("isRelogin", "false");
l.default.getInstance().enterBundleScene(u.Scene.Login);
} else {
var e = JSON.parse(cc.sys.localStorage.getItem("LastLoginParam"));
if (null == e) if (h.default.Instance.serverConfig.guest_switch) {
var t = r.default.getOnlyID(), o = r.default.getDeviceID();
T.default.log("Guest login onlyID:" + t);
var n = {
packageName: r.default.getPackageName(),
onlyID: t,
device_info: o,
type: u.LoginType.Guest,
channel: E.Config.Channel,
platform: b.default.Instance.getPlatform(),
version: String(r.default.getVersionCode()),
hot_update_version: h.default.Instance.updateVersion,
afid: r.default.getAFID(),
advertising_id: r.default.getGoogleAdID(),
app_instance_id: r.default.getLogInstanceID(),
ad: r.default.getAdType()
};
b.default.Instance.sendLoginGuest(n);
} else l.default.getInstance().enterBundleScene(u.Scene.Login); else {
e.packageName = r.default.getPackageName();
e.onlyID = r.default.getOnlyID();
e.device_info = r.default.getDeviceID();
e.channel = E.Config.Channel;
e.platform = b.default.Instance.getPlatform();
e.version = String(r.default.getVersionCode());
e.hot_update_version = h.default.Instance.updateVersion;
e.afid = r.default.getAFID();
e.advertising_id = r.default.getGoogleAdID();
e.app_instance_id = r.default.getLogInstanceID();
e.ad = r.default.getAdType();
if (e.type == u.LoginType.Phone) {
if (!e.login_token) {
l.default.getInstance().enterBundleScene(u.Scene.Login);
return;
}
b.default.Instance.sendLoginPhoneToken(e);
} else e.type == u.LoginType.Guest ? b.default.Instance.sendLoginGuest(e) : b.default.Instance.sendLoginOther(e);
}
}
};
i([ M(cc.Node) ], t.prototype, "Background", void 0);
i([ M(cc.Node) ], t.prototype, "UILayer", void 0);
i([ M(cc.Node) ], t.prototype, "TopLayer", void 0);
return i([ P, G("Scene/LaunchScene") ], t);
}(cc.Component);
o.default = w;
cc._RF.pop();
}, {
"../../../Config": "Config",
"../../../Game/BundleManager": "BundleManager",
"../../../Game/Script/global/GlobalValue": "GlobalValue",
"../../../Game/ShellProxy": "ShellProxy",
"../../../Game/client/global/enum/game/Const": "Const",
"../../../Game/client/global/enum/game/Event": "Event",
"../../../Game/client/model/LanguageModel": "LanguageModel",
"../../../Game/client/model/UpdateModel": "UpdateModel",
"../../../Game/fromework/global/ResLoader": "ResLoader",
"../../../Game/fromework/helper/AudioHelper": "AudioHelper",
"../../../Game/fromework/helper/ConfigHelper": "ConfigHelper",
"../../../Game/fromework/helper/EventHelper": "EventHelper",
"../../../Game/fromework/helper/UIHelper": "UIHelper",
"../../../Game/fromework/jslib/Base64IN": "Base64IN",
"../../../Game/fromework/mvvm/modelView/ViewModel": "ViewModel",
"../../../fromework/helper/NetHelper": "NetHelper",
"../../../fromework/net/NetWebSocket": "NetWebSocket",
"../../../platform/Log": "Log",
"../../../platform/Platform": "Platform",
"../../global/Global": "Global",
"../../model/UserModel": "UserModel",
"../game/HearBeat": "HearBeat"
} ],
ListViewItem: [ function(e, t, o) {
"use strict";
cc._RF.push(t, "3cb60PtpS5Gd61ciugtDKMR", "ListViewItem");
var n, a = this && this.__extends || (n = function(e, t) {
return (n = Object.setPrototypeOf || {
__proto__: []
} instanceof Array && function(e, t) {
e.__proto__ = t;
} || function(e, t) {
for (var o in t) Object.prototype.hasOwnProperty.call(t, o) && (e[o] = t[o]);
})(e, t);
}, function(e, t) {
n(e, t);
function o() {
this.constructor = e;
}
e.prototype = null === t ? Object.create(t) : (o.prototype = t.prototype, new o());
}), i = this && this.__decorate || function(e, t, o, n) {
var a, i = arguments.length, r = i < 3 ? t : null === n ? n = Object.getOwnPropertyDescriptor(t, o) : n;
if ("object" == typeof Reflect && "function" == typeof Reflect.decorate) r = Reflect.decorate(e, t, o, n); else for (var l = e.length - 1; l >= 0; l--) (a = e[l]) && (r = (i < 3 ? a(r) : i > 3 ? a(t, o, r) : a(t, o)) || r);
return i > 3 && r && Object.defineProperty(t, o, r), r;
};
Object.defineProperty(o, "__esModule", {
value: !0
});
var r = cc._decorator, l = r.ccclass, s = r.property, c = r.menu, u = function(e) {
a(t, e);
function t() {
var t = null !== e && e.apply(this, arguments) || this;
t.onInitItemEvents = [];
t.onEnterScorllViewEvents = [];
t.onExitScorllViewEvents = [];
t.isShowing = !1;
return t;
}
t.prototype.OnInitItem = function(e, t) {
0 != this.onInitItemEvents.length && this.onInitItemEvents.forEach(function(o) {
o.emit([ e, t ]);
});
};
t.prototype.OnEnterListView = function() {
0 != this.onEnterScorllViewEvents.length && this.onEnterScorllViewEvents.forEach(function(e) {
e.emit([]);
});
};
t.prototype.OnExitListView = function() {
0 != this.onExitScorllViewEvents.length && this.onExitScorllViewEvents.forEach(function(e) {
e.emit([]);
});
};
t.prototype.start = function() {};
i([ s({
type: [ cc.Component.EventHandler ],
tooltip: "初始化Item回调"
}) ], t.prototype, "onInitItemEvents", void 0);
i([ s({
type: [ cc.Component.EventHandler ],
tooltip: "进入ListView时回调"
}) ], t.prototype, "onEnterScorllViewEvents", void 0);
i([ s({
type: [ cc.Component.EventHandler ],
tooltip: "离开ListView时回调"
}) ], t.prototype, "onExitScorllViewEvents", void 0);
return i([ l, c("Widget/ListView(列表控件)/ListViewItem (列表视图填充物组件)") ], t);
}(cc.Component);
o.default = u;
cc._RF.pop();
}, {} ],
ListView: [ function(e, t, o) {
"use strict";
cc._RF.push(t, "dff0dKQ/j1EbY/nozN58/9d", "ListView");
var n, a = this && this.__extends || (n = function(e, t) {
return (n = Object.setPrototypeOf || {
__proto__: []
} instanceof Array && function(e, t) {
e.__proto__ = t;
} || function(e, t) {
for (var o in t) Object.prototype.hasOwnProperty.call(t, o) && (e[o] = t[o]);
})(e, t);
}, function(e, t) {
n(e, t);
function o() {
this.constructor = e;
}
e.prototype = null === t ? Object.create(t) : (o.prototype = t.prototype, new o());
}), i = this && this.__decorate || function(e, t, o, n) {
var a, i = arguments.length, r = i < 3 ? t : null === n ? n = Object.getOwnPropertyDescriptor(t, o) : n;
if ("object" == typeof Reflect && "function" == typeof Reflect.decorate) r = Reflect.decorate(e, t, o, n); else for (var l = e.length - 1; l >= 0; l--) (a = e[l]) && (r = (i < 3 ? a(r) : i > 3 ? a(t, o, r) : a(t, o)) || r);
return i > 3 && r && Object.defineProperty(t, o, r), r;
}, r = this && this.__awaiter || function(e, t, o, n) {
return new (o || (o = Promise))(function(a, i) {
function r(e) {
try {
s(n.next(e));
} catch (e) {
i(e);
}
}
function l(e) {
try {
s(n.throw(e));
} catch (e) {
i(e);
}
}
function s(e) {
e.done ? a(e.value) : (t = e.value, t instanceof o ? t : new o(function(e) {
e(t);
})).then(r, l);
var t;
}
s((n = n.apply(e, t || [])).next());
});
}, l = this && this.__generator || function(e, t) {
var o, n, a, i, r = {
label: 0,
sent: function() {
if (1 & a[0]) throw a[1];
return a[1];
},
trys: [],
ops: []
};
return i = {
next: l(0),
throw: l(1),
return: l(2)
}, "function" == typeof Symbol && (i[Symbol.iterator] = function() {
return this;
}), i;
function l(e) {
return function(t) {
return s([ e, t ]);
};
}
function s(i) {
if (o) throw new TypeError("Generator is already executing.");
for (;r; ) try {
if (o = 1, n && (a = 2 & i[0] ? n.return : i[0] ? n.throw || ((a = n.return) && a.call(n), 
0) : n.next) && !(a = a.call(n, i[1])).done) return a;
(n = 0, a) && (i = [ 2 & i[0], a.value ]);
switch (i[0]) {
case 0:
case 1:
a = i;
break;

case 4:
r.label++;
return {
value: i[1],
done: !1
};

case 5:
r.label++;
n = i[1];
i = [ 0 ];
continue;

case 7:
i = r.ops.pop();
r.trys.pop();
continue;

default:
if (!(a = r.trys, a = a.length > 0 && a[a.length - 1]) && (6 === i[0] || 2 === i[0])) {
r = 0;
continue;
}
if (3 === i[0] && (!a || i[1] > a[0] && i[1] < a[3])) {
r.label = i[1];
break;
}
if (6 === i[0] && r.label < a[1]) {
r.label = a[1];
a = i;
break;
}
if (a && r.label < a[2]) {
r.label = a[2];
r.ops.push(i);
break;
}
a[2] && r.ops.pop();
r.trys.pop();
continue;
}
i = t.call(e, r);
} catch (e) {
i = [ 6, e ];
n = 0;
} finally {
o = a = 0;
}
if (5 & i[0]) throw i[1];
return {
value: i[0] ? i[1] : void 0,
done: !0
};
}
};
Object.defineProperty(o, "__esModule", {
value: !0
});
var s = e("../../../platform/Platform"), c = e("./ListViewItem"), u = cc._decorator, d = u.ccclass, p = u.property, h = u.menu, f = function(e) {
a(t, e);
function t() {
var t = null !== e && e.apply(this, arguments) || this;
t.DefaultItem = null;
t.VisualView = null;
t.Frame = !1;
t.Duration = 1;
t.scrollView = null;
t.layout = null;
t._visualBox = null;
t._datas = new Array();
t._scrollIndex = -1;
t._scrollTime = 0;
return t;
}
t.prototype._init = function() {
this.scrollView = this.node.getComponent(cc.ScrollView);
this.layout = this.scrollView.content.getComponent(cc.Layout);
this._datas = new Array();
};
t.prototype.refreshVisualBox = function() {
this._visualBox = this.VisualView.getBoundingBoxToWorld();
};
t.prototype._setItem = function(e, t) {
if (!(t < 0 || t > this._datas.length - 1)) {
var o = this.scrollView.content.children[t];
o && o.getComponent(c.default).OnInitItem(e, t);
}
};
t.prototype._addItem = function(e, t) {
var o = this, n = cc.instantiate(this.DefaultItem);
n.getComponent(c.default).OnInitItem(e, t);
this.scrollView.content.addChild(n);
this.scheduleOnce(function() {
o._checkItemShow(n);
});
};
t.prototype._insertItem = function(e, t) {
var o = this, n = cc.instantiate(this.DefaultItem);
n.getComponent(c.default).OnInitItem(e, t);
this.scrollView.content.insertChild(n, t);
this.scheduleOnce(function() {
o._onScrollingDrawCallOpt();
});
};
t.prototype._load = function(e) {
for (var t = 0; t < e.length; ++t) this._addItem(e[t], t);
if (this && this.scrollView && this.scrollView.content) {
var o = this.scrollView.content.getComponent(cc.Layout);
o && o.updateLayout();
}
};
t.prototype._getItemGenerator = function(e) {
var t;
return l(this, function(o) {
switch (o.label) {
case 0:
t = 0;
o.label = 1;

case 1:
return t < e.length ? [ 4, this._addItem(e[t], t) ] : [ 3, 4 ];

case 2:
o.sent();
o.label = 3;

case 3:
++t;
return [ 3, 1 ];

case 4:
return [ 2 ];
}
});
};
t.prototype._framingLoad = function(e) {
return r(this, void 0, void 0, function() {
return l(this, function(t) {
switch (t.label) {
case 0:
return [ 4, this.executePreFrame(this._getItemGenerator(e), this.Duration) ];

case 1:
t.sent();
if (-1 != this._scrollIndex) {
this.scrollToIndex(this._scrollIndex, this._scrollTime);
this._scrollIndex = -1;
this._scrollTime = 0;
}
return [ 2 ];
}
});
});
};
t.prototype.executePreFrame = function(e, t) {
var o = this;
return new Promise(function(n) {
var a = e, i = function() {
for (var e = new Date().getTime(), r = a.next(); ;r = a.next()) {
if (null == r || r.done) {
n(null);
return;
}
if (new Date().getTime() - e > t) {
o.scheduleOnce(function() {
i();
});
return;
}
}
};
i();
});
};
t.prototype._checkItemShow = function(e) {
if (e && e.isValid) {
var t = null;
try {
t = e.getComponent(c.default);
} catch (e) {
s.default.error(e);
return;
}
if (null != t) {
null == this._visualBox && this.refreshVisualBox();
if (e.getBoundingBoxToWorld().intersects(this._visualBox)) {
if (!t.isShowing) {
t.isShowing = !0;
t.OnEnterListView();
}
} else if (t.isShowing) {
t.isShowing = !1;
t.OnExitListView();
}
}
}
};
t.prototype._onScrollingDrawCallOpt = function() {
var e = this;
0 != this.scrollView.content.childrenCount && this.scrollView.content.children.forEach(function(t) {
e._checkItemShow(t);
});
};
t.prototype._refreshView = function() {
for (var e = this.scrollView.content.children.length - 1; e >= 0; e--) {
var t = this.scrollView.content.children[e];
t.removeFromParent();
t.destroy();
}
this.Frame ? this._framingLoad(this._datas) : this._load(this._datas);
};
Object.defineProperty(t.prototype, "datas", {
get: function() {
return this._datas;
},
set: function(e) {
this._datas.splice(0);
this._datas = e;
this._refreshView();
},
enumerable: !1,
configurable: !0
});
t.prototype.getItem = function(e) {
return e < 0 || e > this._datas.length - 1 ? null : this.scrollView.content.children[e];
};
t.prototype.getAllItems = function() {
return this.scrollView.content.children;
};
t.prototype.changeItem = function(e, t, o) {
void 0 === o && (o = !1);
this._setItem(e, t);
o && this._datas.splice(t, 1, e);
};
t.prototype.addItems = function(e, t) {
void 0 === t && (t = !1);
for (var o = 0; o < e.length; o++) {
this._addItem(e[o], o);
t && this._datas.push(e[o]);
}
};
t.prototype.insertItems = function(e, t, o) {
void 0 === o && (o = !1);
for (var n = 0, a = t; n < e.length; n++, a++) this._insertItem(e[n], a);
o && this._datas.splice(t, 0, e);
};
t.prototype.removeItem = function(e) {
var t = this.getItem(e);
t && t.removeFromParent();
t.destroy();
this._datas.splice(e, 1);
};
t.prototype.removeAllItems = function() {
for (var e = this.scrollView.content.children.length - 1; e >= 0; e--) {
var t = this.scrollView.content.children[e];
t.removeFromParent();
t.destroy();
}
this._datas.splice(0);
};
t.prototype.scrollToIndex = function(e, t) {
var o = this.getItem(e);
if (null != o) {
var n = cc.Vec2.ZERO;
this.scrollView.horizontal ? n.x = o.width * e : this.scrollView.vertical && (n.y = o.height * e);
var a = this.scrollView.getMaxScrollOffset();
n.x > a.x && (n.x = a.x);
n.y > a.y && (n.y = a.y);
this.scrollView.scrollToOffset(n, t);
} else {
this._scrollIndex = e;
this._scrollTime = t;
}
};
t.prototype.__preload = function() {
this._init();
};
t.prototype.start = function() {};
t.prototype.update = function() {};
t.prototype.onEnable = function() {
this.node.on("scrolling", this._onScrollingDrawCallOpt, this);
};
t.prototype.onDisable = function() {
this.node.off("scrolling", this._onScrollingDrawCallOpt, this);
};
i([ p({
type: cc.Prefab,
tooltip: "默认项"
}) ], t.prototype, "DefaultItem", void 0);
i([ p({
type: cc.Node,
tooltip: "可视区域"
}) ], t.prototype, "VisualView", void 0);
i([ p({
tooltip: "是否分帧加载"
}) ], t.prototype, "Frame", void 0);
i([ p({
tooltip: "分配给每帧的时间，单位毫秒，仅在开启分帧加载时有用",
visible: function() {
return 0 != this.Frame;
}
}) ], t.prototype, "Duration", void 0);
return i([ d, h("Widget/ListView(列表控件)/ListView (列表视图组件)") ], t);
}(cc.Component);
o.default = f;
cc._RF.pop();
}, {
"../../../platform/Platform": "Platform",
"./ListViewItem": "ListViewItem"
} ],
LoadingScene: [ function(e, t, o) {
"use strict";
cc._RF.push(t, "49a87u/lcFBPbURfvZoMV5w", "LoadingScene");
var n, a = this && this.__extends || (n = function(e, t) {
return (n = Object.setPrototypeOf || {
__proto__: []
} instanceof Array && function(e, t) {
e.__proto__ = t;
} || function(e, t) {
for (var o in t) Object.prototype.hasOwnProperty.call(t, o) && (e[o] = t[o]);
})(e, t);
}, function(e, t) {
n(e, t);
function o() {
this.constructor = e;
}
e.prototype = null === t ? Object.create(t) : (o.prototype = t.prototype, new o());
}), i = this && this.__decorate || function(e, t, o, n) {
var a, i = arguments.length, r = i < 3 ? t : null === n ? n = Object.getOwnPropertyDescriptor(t, o) : n;
if ("object" == typeof Reflect && "function" == typeof Reflect.decorate) r = Reflect.decorate(e, t, o, n); else for (var l = e.length - 1; l >= 0; l--) (a = e[l]) && (r = (i < 3 ? a(r) : i > 3 ? a(t, o, r) : a(t, o)) || r);
return i > 3 && r && Object.defineProperty(t, o, r), r;
};
Object.defineProperty(o, "__esModule", {
value: !0
});
var r = e("../../../Game/BundleManager"), l = e("../../../Game/client/global/enum/game/Const"), s = e("../../../Game/fromework/helper/ConfigHelper"), c = cc._decorator, u = c.ccclass, d = c.property, p = c.menu, h = function(e) {
a(t, e);
function t() {
var t = null !== e && e.apply(this, arguments) || this;
t.LoadingBar = null;
return t;
}
t.prototype.onLoad = function() {
this.LoadingBar.progress = 0;
};
t.prototype.start = function() {
var e = this;
s.ConfigHelper.Instance.loadAllConfig("resources/config", function(t, o) {
e.LoadingBar.progress = t / o / 2;
}, function() {
r.default.getInstance().preloadBundleScene(l.Scene.Login, function(t, o) {
e.LoadingBar.progress = .5 + t / o;
}, function() {
r.default.getInstance().enterBundleScene(l.Scene.Login);
});
});
};
i([ d(cc.ProgressBar) ], t.prototype, "LoadingBar", void 0);
return i([ u, p("Scene/LoadingScene") ], t);
}(cc.Component);
o.default = h;
cc._RF.pop();
}, {
"../../../Game/BundleManager": "BundleManager",
"../../../Game/client/global/enum/game/Const": "Const",
"../../../Game/fromework/helper/ConfigHelper": "ConfigHelper"
} ],
LobbyLogic: [ function(e, t, o) {
"use strict";
cc._RF.push(t, "0bdf3Rq0r9Ft4pEMSRx/bNw", "LobbyLogic");
Object.defineProperty(o, "__esModule", {
value: !0
});
var n = e("../../../model/UserModel"), a = e("../../Wallet/WalletHelper"), i = e("../../../global/Global"), r = e("../../../model/WalletModel"), l = e("../../active/ActiveEvent"), s = e("../../active/ActiveModel"), c = e("../../../Festival/Common/FestivalEvent"), u = e("../../../../Game/fromework/mvvm/modelView/ViewModel"), d = e("../../../../Game/fromework/helper/EventHelper"), p = e("../../../../Game/client/global/enum/game/Event"), h = e("../../../../Game/Script/global/GlobalValue"), f = e("../../../../Game/client/global/enum/game/Game"), _ = e("../../../global/PopHelper"), m = e("../../../model/LobbyModel"), y = e("../../../../Game/client/model/LanguageModel"), g = e("../../../../Game/fromework/helper/UIHelper"), v = e("../../../../Game/client/global/enum/game/Const"), C = e("../../../../Game/client/model/UpdateModel"), b = e("../../../../platform/Platform"), I = e("../AddCashVIP/AddCashEvent"), E = function() {
function e(e) {
this._lobbyUI = null;
this._lobbyUI = e;
}
e.prototype.bindEvent = function() {
u.VM.bindPath("user.headUrl", this._lobbyUI.refreshHeadImage, this._lobbyUI);
d.default.Instance.Global.bind("LobbyButtonClicked_Update", this.onUpdateClicked, this);
d.default.Instance.Global.bind("LobbyButtonClicked_UpdateReceive", this.onUpdateReceiveClicked, this);
d.default.Instance.Global.bind("LobbyButtonClicked_Shop", this.onShopClicked, this);
d.default.Instance.Global.bind("LobbyButtonClicked_Help", this.onHelpClicked, this);
d.default.Instance.Global.bind(p.GameUIEvent.REFRESH_CASH, this.onRefreshCash, this);
d.default.Instance.Global.bind(p.LobbyEvent.LOBBY_GET_GAMES, this.onGetGames, this);
d.default.Instance.Global.bind(p.RedDotEvent.REFRESH_RED_DOT_DATA, this.onGetAllFestival, this);
d.default.Instance.Global.bind(c.FestivalEvent.FESTIVAL_GET_ACT_ALL, this.onGetAllFestival, this);
d.default.Instance.Global.bind(p.LobbyEvent.LOBBY_REFRESH_CHAT, this.onRefreshChat, this);
d.default.Instance.Global.bind(p.LobbyEvent.LOBBY_REFRESH_NOTICE_BUTTON, this.onRefreshNoticeButton, this);
d.default.Instance.Global.bind(p.GameUIEvent.LOBBY_CASH_JOIN, this.onCashJoin, this);
d.default.Instance.Global.bind(p.GameUIEvent.LOBBY_PRACTICE_JOIN, this.onPracticeJoin, this);
d.default.Instance.Global.bind(p.UserEvent.USER_UPDATE_REWARD, this.onUpdateReward, this);
d.default.Instance.Global.bind(p.WalletEvent.WALLET_USER_GET_WALLET, this.onWalletRefresh, this);
d.default.Instance.Global.bind(p.WalletEvent.REFRESH_NOTICE_REFRESH, this.refreshNotice, this);
d.default.Instance.Global.bind(p.WalletEvent.BONUS_GET_UNREWARD, this.refreshBonus, this);
d.default.Instance.Global.bind(p.MonthCardEent.MONTHCARD_GET_LIST, this.refreshCoupons, this);
d.default.Instance.Global.bind(l.BrokeEvent.BROKE_GET_BROKE_DATA, this.refreshBroke, this);
d.default.Instance.Global.bind(p.WalletEvent.RECHARGE_CLOSE_WEBVIEW, this.onRechargeBack, this);
d.default.Instance.Global.bind(l.RechargeSuperEvent.RECHARGE_GET_SUPER_DATA, this.refreshSuper, this);
d.default.Instance.Global.bind(l.RechargeSuperEvent.RECHARGE_GET_SUPER_PAY, this.refreshSuper, this);
d.default.Instance.Global.bind(l.RechargeSuperEvent.RECHARGE_GET_SUPER_RECEIVE, this.refreshSuper, this);
d.default.Instance.Global.bind(l.RechargeLuckyEvent.RECHARGE_GET_LUCKY_DATA, this.refreshLucky, this);
d.default.Instance.Global.bind(l.RechargeLuckyEvent.RECHARGE_GET_LUCKY_PAY, this.refreshLucky, this);
d.default.Instance.Global.bind(p.MonthCardEent.MONTHCARD_GET_LIST, this.onGetList, this);
d.default.Instance.Global.bind(c.FestivalEvent.HALL_MONTH_CARD_UI_RECHARGE, this.onHallMonthGetSucess, this);
d.default.Instance.Global.bind("withdrawFinger", this.onWithdrawFinger, this);
d.default.Instance.Global.bind("openLoginAlert", this.openLoginAlert, this);
d.default.Instance.Global.bind("onGetGoldSliverData", this.showGoldCardRedDotData, this);
d.default.Instance.Global.bind(I.AddCashEvent.ADD_CASH_REDDOT, this.refreshAddCashReddot, this);
d.default.Instance.Global.bind("openPlayList", this.openPlayList, this);
d.default.Instance.Global.bind("referExchangeRed", this.referExchangeRed, this);
d.default.Instance.Global.bind(p.SignEvent.SIGN_GET_USER_SIGNED, this.onPacketCallFunc, this);
d.default.Instance.Global.bind("creatorCoinActToMyHead", this.creatorCoinActToMyHead, this);
};
e.prototype.unbindEvent = function() {
u.VM.bindPath("user.headUrl", this._lobbyUI.refreshHeadImage, this._lobbyUI);
d.default.Instance.Global.unbind("LobbyButtonClicked_Update", this.onUpdateClicked, this);
d.default.Instance.Global.unbind("LobbyButtonClicked_UpdateReceive", this.onUpdateReceiveClicked, this);
d.default.Instance.Global.unbind("LobbyButtonClicked_Shop", this.onShopClicked, this);
d.default.Instance.Global.unbind("LobbyButtonClicked_Help", this.onHelpClicked, this);
d.default.Instance.Global.unbind(p.GameUIEvent.REFRESH_CASH, this.onRefreshCash, this);
d.default.Instance.Global.unbind(p.LobbyEvent.LOBBY_GET_GAMES, this.onGetGames, this);
d.default.Instance.Global.unbind(p.RedDotEvent.REFRESH_RED_DOT_DATA, this.onGetAllFestival, this);
d.default.Instance.Global.unbind(c.FestivalEvent.FESTIVAL_GET_ACT_ALL, this.onGetAllFestival, this);
d.default.Instance.Global.unbind(p.LobbyEvent.LOBBY_REFRESH_CHAT, this.onRefreshChat, this);
d.default.Instance.Global.unbind(p.LobbyEvent.LOBBY_REFRESH_NOTICE_BUTTON, this.onRefreshNoticeButton, this);
d.default.Instance.Global.unbind(p.GameUIEvent.LOBBY_CASH_JOIN, this.onCashJoin, this);
d.default.Instance.Global.unbind(p.GameUIEvent.LOBBY_PRACTICE_JOIN, this.onPracticeJoin, this);
d.default.Instance.Global.unbind(p.UserEvent.USER_UPDATE_REWARD, this.onUpdateReward, this);
d.default.Instance.Global.unbind(p.WalletEvent.WALLET_USER_GET_WALLET, this.onWalletRefresh, this);
d.default.Instance.Global.unbind(p.WalletEvent.REFRESH_NOTICE_REFRESH, this.refreshNotice, this);
d.default.Instance.Global.unbind(p.WalletEvent.BONUS_GET_UNREWARD, this.refreshBonus, this);
d.default.Instance.Global.unbind(p.MonthCardEent.MONTHCARD_GET_LIST, this.refreshCoupons, this);
d.default.Instance.Global.unbind(l.BrokeEvent.BROKE_GET_BROKE_DATA, this.refreshBroke, this);
d.default.Instance.Global.unbind(p.WalletEvent.RECHARGE_CLOSE_WEBVIEW, this.onRechargeBack, this);
d.default.Instance.Global.unbind(l.RechargeSuperEvent.RECHARGE_GET_SUPER_DATA, this.refreshSuper, this);
d.default.Instance.Global.unbind(l.RechargeSuperEvent.RECHARGE_GET_SUPER_PAY, this.refreshSuper, this);
d.default.Instance.Global.unbind(l.RechargeSuperEvent.RECHARGE_GET_SUPER_RECEIVE, this.refreshSuper, this);
d.default.Instance.Global.unbind(l.RechargeLuckyEvent.RECHARGE_GET_LUCKY_DATA, this.refreshLucky, this);
d.default.Instance.Global.unbind(l.RechargeLuckyEvent.RECHARGE_GET_LUCKY_PAY, this.refreshLucky, this);
d.default.Instance.Global.unbind(p.MonthCardEent.MONTHCARD_GET_LIST, this.onGetList, this);
d.default.Instance.Global.unbind(c.FestivalEvent.HALL_MONTH_CARD_UI_RECHARGE, this.onHallMonthGetSucess, this);
d.default.Instance.Global.unbind("withdrawFinger", this.onWithdrawFinger, this);
d.default.Instance.Global.unbind("openLoginAlert", this.openLoginAlert, this);
d.default.Instance.Global.unbind("onGetGoldSliverData", this.showGoldCardRedDotData, this);
d.default.Instance.Global.unbind(I.AddCashEvent.ADD_CASH_REDDOT, this.refreshAddCashReddot, this);
d.default.Instance.Global.unbind("openPlayList", this.openPlayList, this);
d.default.Instance.Global.unbind("referExchangeRed", this.referExchangeRed, this);
d.default.Instance.Global.unbind("creatorCoinActToMyHead", this.creatorCoinActToMyHead, this);
d.default.Instance.Global.unbind(p.SignEvent.SIGN_GET_USER_SIGNED, this.onPacketCallFunc, this);
};
e.prototype.onLoad = function() {
cc.game.on(cc.game.EVENT_SHOW, this.onRechargeBack, this);
};
e.prototype.onDestroy = function() {
cc.game.off(cc.game.EVENT_SHOW, this.onRechargeBack, this);
};
e.prototype.checkGoldLoginReward = function() {
if (!h.default.getInstance().isCashGame) {
var e = u.VM.getValue("user.daily_reward");
if (null != e[f.GameEnum.MoneyType.GOLD]) {
_.PopHelper.Instance.showReward(i.Global.Instance.changeReward(e), function() {});
u.VM.setValue("user.daily_reward", []);
}
}
};
e.prototype.onRefreshCash = function() {
this._lobbyUI.refreshLobby();
this._lobbyUI.PlayList.refreshCash();
};
e.prototype.onGetGames = function() {
this._lobbyUI.refreshPlayButton();
};
e.prototype.onRefreshNoticeButton = function() {
this._lobbyUI.refreshNoticeButton();
};
e.prototype.onGetAllFestival = function() {};
e.prototype.onRefreshChat = function() {
this._lobbyUI.refreshChat();
};
e.prototype.onCashJoin = function(e) {
var t = e.getUserData(), o = m.default.Instance.getGamePlay(t);
if (o) {
if (o.currency == f.GameEnum.MoneyType.GOLD && o.min_entry > u.VM.getValue("wallet.gold")) {
var n = {
content: y.default.getString("COMMON_TIPS_CASH"),
leftTitle: y.default.getString("SIGN_BACK"),
leftCallFunc: function() {}
};
_.PopHelper.Instance.showAlert(n);
return;
}
if (o.currency == f.GameEnum.MoneyType.CASH && o.min_entry > u.VM.getValue("wallet.total")) {
a.default.Instance.openRechargeAlert(o.min_entry);
return;
}
if (1 == o.free_limit && u.VM.getValue("wallet.totalRecharge") <= 0) {
a.default.Instance.openRechargeAlert(100, 0, !1);
return;
}
m.default.Instance.sendJoinRoom(o.rtype);
} else b.default.log("Can not find room");
};
e.prototype.onPracticeJoin = function(e) {
var t = e.getUserData(), o = m.default.Instance.getGamePlay(t);
o ? m.default.Instance.sendJoinRoom(o.rtype) : b.default.log("Can not find room");
};
e.prototype.onUpdateReward = function(e) {
var t = e.getUserData();
t.result ? _.PopHelper.Instance.showReward(i.Global.Instance.changeReward(t.reward), function() {}, y.default.getString("GENG_CHENGGONG")) : _.PopHelper.Instance.showTips(t.msg);
};
e.prototype.onWalletRefresh = function() {};
e.prototype.refreshNotice = function() {
this._lobbyUI.refreshBanner();
};
e.prototype.refreshBonus = function() {
this._lobbyUI.refreshBonusButton();
};
e.prototype.refreshCoupons = function() {
this._lobbyUI.refreshCouponsButton();
};
e.prototype.refreshBroke = function() {
this._lobbyUI.refreshBrokeButton();
};
e.prototype.refreshSuper = function() {
this._lobbyUI.refreshSuperButton();
};
e.prototype.refreshLucky = function() {
this._lobbyUI.refreshLuckyButton();
};
e.prototype.onRechargeBack = function() {
if (n.default.checkSwitch(n.ClientSwitch.CLIENT_FUNC_SWITCH_WEB)) {
r.WalletProxy.Instance.startRechargeAmtTime(30);
r.WalletProxy.Instance.sendGetUserWallet();
}
s.ActiveProxy.Instance.sendGetBrokeActive();
r.WalletProxy.Instance.sendGetActivityList();
};
e.prototype.onUserHeadClicked = function() {
g.default.Instance.addBundleMaskLayer(v.BundleUIPath.UserSetting);
};
e.prototype.onUpdateClicked = function() {
if (C.default.Instance.isJumpHotUpdate) {
cc.sys.localStorage.setItem("isUpdateInLobby", JSON.stringify(!0));
i.Global.Instance.restartGame();
} else this.onUpdateReceiveClicked();
};
e.prototype.onUpdateReceiveClicked = function() {
C.default.Instance.isJumpHotUpdate ? this.onUpdateClicked() : n.default.Instance.sendUpdateReward();
};
e.prototype.onShopClicked = function() {
a.default.Instance.openShop();
};
e.prototype.onHelpClicked = function() {
g.default.Instance.addBundleMaskLayer(v.BundleUIPath.HelpView);
};
e.prototype.onGetList = function() {
this._lobbyUI.onGetList();
};
e.prototype.onHallMonthGetSucess = function() {
this._lobbyUI.onHallMonthGetSucess();
};
e.prototype.onWithdrawFinger = function(e) {
b.default.log("get_user_wallet onWithdrawFinger", e.getUserData());
this._lobbyUI.withdrawFinger(!!e.getUserData());
};
e.prototype.openLoginAlert = function() {
this._lobbyUI.openLoginAlert();
};
e.prototype.showGoldCardRedDotData = function() {
this._lobbyUI.showGoldCardRedDotData();
};
e.prototype.refreshAddCashReddot = function(e) {
b.default.log("ADD_CASH_REDDOT", e.getUserData());
this._lobbyUI.AddCashVIPButton.getChildByName("RedDot").active = !!e.getUserData();
};
e.prototype.openPlayList = function(e) {
var t = e.getUserData();
this._lobbyUI.openPlayList(t);
};
e.prototype.referExchangeRed = function() {
this._lobbyUI.referExchangeRed();
};
e.prototype.onPacketCallFunc = function() {
this._lobbyUI.refreshSignButton();
};
e.prototype.creatorCoinActToMyHead = function() {
this._lobbyUI.creatorCoinActToMyHead();
};
return e;
}();
o.default = E;
cc._RF.pop();
}, {
"../../../../Game/Script/global/GlobalValue": "GlobalValue",
"../../../../Game/client/global/enum/game/Const": "Const",
"../../../../Game/client/global/enum/game/Event": "Event",
"../../../../Game/client/global/enum/game/Game": "Game",
"../../../../Game/client/model/LanguageModel": "LanguageModel",
"../../../../Game/client/model/UpdateModel": "UpdateModel",
"../../../../Game/fromework/helper/EventHelper": "EventHelper",
"../../../../Game/fromework/helper/UIHelper": "UIHelper",
"../../../../Game/fromework/mvvm/modelView/ViewModel": "ViewModel",
"../../../../platform/Platform": "Platform",
"../../../Festival/Common/FestivalEvent": "FestivalEvent",
"../../../global/Global": "Global",
"../../../global/PopHelper": "PopHelper",
"../../../model/LobbyModel": "LobbyModel",
"../../../model/UserModel": "UserModel",
"../../../model/WalletModel": "WalletModel",
"../../Wallet/WalletHelper": "WalletHelper",
"../../active/ActiveEvent": "ActiveEvent",
"../../active/ActiveModel": "ActiveModel",
"../AddCashVIP/AddCashEvent": "AddCashEvent"
} ],
LobbyModel: [ function(e, t, o) {
"use strict";
cc._RF.push(t, "1c70frAJg5PJrG+OZTa/qSk", "LobbyModel");
Object.defineProperty(o, "__esModule", {
value: !0
});
o.lobby = o.LobbyModel = void 0;
var n = e("../../fromework/helper/NetHelper"), a = e("./UserModel"), i = e("../../Game/client/model/CommonModel"), r = e("../../Game/fromework/helper/EventHelper"), l = e("../../Game/client/global/enum/net/S2C"), s = e("../../Game/fromework/mvvm/modelView/ViewModel"), c = e("../../Game/client/global/enum/game/Game"), u = e("../../Game/Script/global/GlobalValue"), d = e("../../Game/client/global/enum/game/Event"), p = e("../../Game/client/global/enum/net/C2S"), h = function() {
this.roomID = 0;
this.roomIDFast = 0;
this.total = 0;
this.plays = new Map();
};
o.LobbyModel = h;
o.lobby = new h();
s.VM.add(o.lobby, "lobby");
var f = function() {
function e() {
this.kickRoomType = "";
this.playOrder = [];
this.playListOffset = cc.Vec2.ZERO;
}
Object.defineProperty(e, "Instance", {
get: function() {
e._instance || (e._instance = new e());
return e._instance;
},
enumerable: !1,
configurable: !0
});
e.prototype.Init = function() {
r.default.Instance.Net.bind(l.S2C.LOBBY.LOBBY_JOIN, this._onJoinRoom, this);
r.default.Instance.Net.bind(l.S2C.LOBBY.LOBBY_GET_ROOMS, this._onGetRooms, this);
r.default.Instance.Net.bind(l.S2C.LOBBY.LOBBY_GET_GAMES, this._onGetGames, this);
r.default.Instance.Net.bind(l.S2C.GAME.ROOM_FUNC_LEVEL, this._onFuncLevel, this);
r.default.Instance.Global.bind(n.NetState.NET_WEBSOCKET_CONNECT_OPEN, this._onWsContented, this);
};
e.prototype.clear = function() {
this.kickRoomType = "";
this.playListOffset = cc.Vec2.ZERO;
};
e.prototype.getRoomID = function() {
var e = s.VM.getValue("lobby.rooms"), t = 0, o = 0;
e.forEach(function(e, n) {
if (0 != e) {
t = e;
o = n;
}
});
return {
rid: t,
cls: o
};
};
e.prototype.checkRummy = function() {
for (var e = s.VM.getValue("lobby.plays"), t = 1; t <= 4; t++) if (e.has(t) && e.get(t).length > 0) return !0;
return !1;
};
e.prototype.checkGamePlay = function(e) {
var t = s.VM.getValue("lobby.plays");
return !!t.has(e) && t.get(e).length > 0;
};
e.prototype.getGamePlayByCls = function(e) {
var t = s.VM.getValue("lobby.plays");
return t.has(e) ? t.get(e) : [];
};
e.prototype.getGamePlay = function(e) {
var t = s.VM.getValue("lobby.plays"), o = null;
t.forEach(function(t) {
t.forEach(function(t) {
t.rtype == e && (o = t);
});
});
return o;
};
e.prototype.getGamePlayByType = function(e, t, o, n) {
var a = this.getGamePlayByCls(e), i = [];
a.forEach(function(a) {
a.cls == e && a.currency == t && (null != o ? o == a.deals_round && i.push(a) : null != n ? n == a.pool_score && i.push(a) : i.push(a));
});
return i;
};
e.prototype.getMinEntryByCash = function(t, o) {
var n = e.Instance.getGamePlay(t);
if (!n) return null;
var a = e.Instance.getGamePlayByType(n.cls, n.currency), i = null;
a.forEach(function(e) {
n.cls != c.GameEnum.PlayType.RUMMY_POINTS && n.cls != c.GameEnum.PlayType.RUMMY_TENCARD || n.max == e.max && o >= e.min_entry && (null == i ? i = e : i.min_entry < e.min_entry && (i = e));
n.cls, c.GameEnum.PlayType.RUMMY_POOL;
n.cls, c.GameEnum.PlayType.RUMMY_DEALS;
});
return i;
};
e.prototype.getPlayByBenchmark = function(e, t) {
var o = null;
e.forEach(function(e) {
t >= e.min_entry && (null != o ? e.cls == c.GameEnum.PlayType.RUMMY_POINTS ? o.min_entry == e.min_entry ? o.max > e.max && (o = e) : o.min_entry <= e.min_entry && (o = e) : e.cls == c.GameEnum.PlayType.RUMMY_TENCARD ? o.min_entry == e.min_entry ? o.max > e.max && (o = e) : o.min_entry <= e.min_entry && (o = e) : e.cls == c.GameEnum.PlayType.RUMMY_DEALS ? o.min_entry == e.min_entry ? o.deals_round > e.deals_round && (o = e) : o.min_entry <= e.min_entry && (o = e) : e.cls == c.GameEnum.PlayType.RUMMY_POOL ? o.min_entry == e.min_entry ? o.pool_score > e.pool_score && o.max > e.max && (o = e) : o.min_entry <= e.min_entry && (o = e) : c.GameEnum.isTeenpatti(e.cls) && (o.min_entry == e.min_entry ? o.max > e.max && (o = e) : o.min_entry <= e.min_entry && (o = e)) : o = e);
});
return o;
};
e.prototype.getRecommendPlay = function(t, o) {
void 0 === o && (o = !1);
if (!t || 0 == t.length) return null;
var n = u.default.getInstance().isCashGame ? s.VM.getValue("wallet.total") : s.VM.getValue("wallet.gold");
return e.Instance.getPlayByBenchmark(t, n);
};
e.prototype.getLastPlay = function(t, o, n, a) {
var i = s.VM.getValue("user.uid"), r = cc.sys.localStorage.getItem(i + "LastPlay|" + t + "|" + o + "|" + n + "|" + a);
return e.Instance.getGamePlay(r);
};
e.prototype.setLastPlay = function(e) {
var t = s.VM.getValue("user.uid");
cc.sys.localStorage.setItem(t + "LastPlay|" + e.cls + "|" + e.currency + "|" + e.deals_round + "|" + e.pool_score, e.rtype);
};
e.prototype.getPlaySwitch = function(e) {
for (var t = 0; t < this.playOrder.length; t++) {
var o = this.playOrder[t];
if (o.c == e) return o;
}
return null;
};
e.prototype._onWsContented = function() {
this.sendHome();
};
e.prototype._onJoinRoom = function(e) {
var t = e.getUserData(), o = this.getGamePlay(t.room_type);
o.cls == c.GameEnum.PlayType.GAME_RB_FAST || o.cls == c.GameEnum.PlayType.GAME_LOTO_FAST ? s.VM.setValue("lobby.roomIDFast", parseInt(t.r)) : s.VM.setValue("lobby.roomID", parseInt(t.r));
!o || o.currency != c.GameEnum.MoneyType.CASH && o.currency != c.GameEnum.MoneyType.GOLD || this.setLastPlay(o);
r.default.Instance.Global.emit(d.LobbyEvent.LOBBY_JOIN, {
play: o,
rid: parseInt(t.r)
});
};
e.prototype._onGetRooms = function(e) {
for (var t = e.getUserData(), o = 0, n = 0, a = Object.keys(t.r_cls), i = 0; i < a.length; i++) {
var l = parseInt(a[i]);
l == c.GameEnum.PlayType.GAME_RB_FAST || l == c.GameEnum.PlayType.GAME_LOTO_FAST ? n = t.r_cls[l] : o = t.r_cls[l];
}
s.VM.setValue("lobby.roomIDFast", n);
s.VM.setValue("lobby.roomID", o);
r.default.Instance.Global.emit(d.LobbyEvent.LOBBY_GET_ROOMS, t.r_cls);
};
e.prototype._onGetGames = function(e) {
var t = e.getUserData(), o = t.g;
s.VM.getValue("lobby.plays").clear();
var n = new Map(), a = function(e) {
var t = o[e], a = [];
t.forEach(function(e) {
var t = new i.Play(e);
a.push(t);
});
n.set(parseInt(e), a);
};
for (var l in o) a(l);
s.VM.setValue("lobby.plays", n);
s.VM.setValue("lobby.total", t.total);
if (null != t.s) {
this.playOrder.length = 0;
for (var l in t.s) {
var c = t.s[l];
this.playOrder.push(c);
}
this.playOrder.sort(function(e, t) {
return e.o - t.o;
});
}
r.default.Instance.Global.emit(d.LobbyEvent.LOBBY_GET_GAMES);
};
e.prototype._onFuncLevel = function(e) {
var t = e.getUserData();
if (null != t) {
var o = t.func_level;
null != o && a.default.Instance.setArriagn(o);
var n = t.org_func_switch;
null != n && s.VM.setValue("user.org_func_switch", n);
this.sendGetGames();
r.default.Instance.Global.emit(d.GameUIEvent.REFRESH_CASH);
}
};
e.prototype.sendJoinRoom = function(e) {
var t = this, o = s.VM.getValue("user.uid");
if (cc.sys.isNative) {
var a = function() {
r.default.Instance.Global.unbind(d.PlatformEvent.PLATFORM_GET_LOCATION, a, t);
var i = cc.Vec2.ZERO, l = n.default.Instance.makeMsg(p.C2S.LOBBY_JOIN, {
u: o,
rtype: e,
lng: i.y,
lat: i.x,
t: s.VM.getValue("user.token")
});
n.default.Instance.send(l);
};
a(null);
} else {
var i = n.default.Instance.makeMsg(p.C2S.LOBBY_JOIN, {
u: o,
rtype: e,
lng: 0,
lat: 0,
t: s.VM.getValue("user.token")
});
n.default.Instance.send(i);
}
};
e.prototype.sendGetRooms = function() {
var e = s.VM.getValue("user.uid"), t = s.VM.getValue("user.token"), o = n.default.Instance.makeMsg(p.C2S.LOBBY_GET_ROOMS, {
u: e,
t: t
});
n.default.Instance.send(o);
};
e.prototype.sendGetGames = function() {
var e = s.VM.getValue("user.uid"), t = s.VM.getValue("user.token"), o = n.default.Instance.makeMsg(p.C2S.LOBBY_GET_GAMES, {
u: e,
t: t
});
n.default.Instance.send(o);
};
e.prototype.sendHome = function() {
var e = s.VM.getValue("user.uid"), t = s.VM.getValue("user.token"), o = n.default.Instance.makeMsg(p.C2S.LOBBY_HOME, {
u: e,
t: t
});
n.default.Instance.send(o);
};
e._instance = null;
return e;
}();
o.default = f;
cc._RF.pop();
}, {
"../../Game/Script/global/GlobalValue": "GlobalValue",
"../../Game/client/global/enum/game/Event": "Event",
"../../Game/client/global/enum/game/Game": "Game",
"../../Game/client/global/enum/net/C2S": "C2S",
"../../Game/client/global/enum/net/S2C": "S2C",
"../../Game/client/model/CommonModel": "CommonModel",
"../../Game/fromework/helper/EventHelper": "EventHelper",
"../../Game/fromework/mvvm/modelView/ViewModel": "ViewModel",
"../../fromework/helper/NetHelper": "NetHelper",
"./UserModel": "UserModel"
} ],
LobbyRoomItem: [ function(e, t, o) {
"use strict";
cc._RF.push(t, "a570c2TrpdNs61vT0NNyePI", "LobbyRoomItem");
var n, a = this && this.__extends || (n = function(e, t) {
return (n = Object.setPrototypeOf || {
__proto__: []
} instanceof Array && function(e, t) {
e.__proto__ = t;
} || function(e, t) {
for (var o in t) Object.prototype.hasOwnProperty.call(t, o) && (e[o] = t[o]);
})(e, t);
}, function(e, t) {
n(e, t);
function o() {
this.constructor = e;
}
e.prototype = null === t ? Object.create(t) : (o.prototype = t.prototype, new o());
}), i = this && this.__decorate || function(e, t, o, n) {
var a, i = arguments.length, r = i < 3 ? t : null === n ? n = Object.getOwnPropertyDescriptor(t, o) : n;
if ("object" == typeof Reflect && "function" == typeof Reflect.decorate) r = Reflect.decorate(e, t, o, n); else for (var l = e.length - 1; l >= 0; l--) (a = e[l]) && (r = (i < 3 ? a(r) : i > 3 ? a(t, o, r) : a(t, o)) || r);
return i > 3 && r && Object.defineProperty(t, o, r), r;
};
Object.defineProperty(o, "__esModule", {
value: !0
});
var r = e("../../../global/PopHelper"), l = e("../../../../Game/client/global/enum/game/Game"), s = e("../../../../Game/client/global/enum/game/UIUtils"), c = e("../../../../Game/client/model/LanguageModel"), u = e("../../../../Game/fromework/helper/ConfigHelper"), d = e("../../../../Game/fromework/mvvm/modelView/ViewModel"), p = e("../../../model/LobbyModel"), h = e("../../../model/UserModel"), f = e("../../Wallet/WalletHelper"), _ = e("../../../../platform/Platform"), m = cc._decorator, y = m.ccclass, g = m.property, v = function(e) {
a(t, e);
function t() {
var t = null !== e && e.apply(this, arguments) || this;
t.Back = null;
t.Name = null;
t.PointValue = null;
t.MaxPayout = null;
t.PotLimit = null;
t.ActivePlayers = null;
t.PlayBtnSprite = null;
t.PlayNowLabel = null;
t.PlayerNum = null;
t.PlayerCount = [];
t.HotNode = null;
t.SelectedMask = null;
t.Button_Frames = [];
t.Item_Frames = [];
t._data = null;
t._index = -1;
t.isAddCash = !1;
return t;
}
t.prototype.onItemInitCallFunc = function(e, t) {
this._data = e;
this.SelectedMask.active = !1;
this._index = t;
var o = !1;
e.currency == l.GameEnum.MoneyType.CASH && null != e.max_entry && 0 != e.max_entry && (o = d.VM.getValue("wallet.total") < e.min_entry || d.VM.getValue("wallet.total") > e.max_entry);
if (l.GameEnum.isRummy(e.cls)) {
this.Name.string = this._data.name;
this.PointValue.string = e.currency == l.GameEnum.MoneyType.CASH ? c.default.getString("COMMON_RUPEE") + e.base : "Free";
this.PotLimit.string = e.currency == l.GameEnum.MoneyType.CASH ? c.default.getString("COMMON_RUPEE") + e.min_entry : "Free";
this.PotLimit.node.active = !0;
this.PotLimit.node.x = -69;
this.MaxPayout.node.active = !1;
this.PlayerNum.active = !0;
} else if (l.GameEnum.isTeenpatti(e.cls)) {
this.Name.string = c.default.getString("COMMON_RUPEE") + e.base;
null == e.max_entry || 0 == e.max_entry ? this.PointValue.string = c.default.getString("COMMON_RUPEE") + e.chaal_limit : this.PointValue.string = c.default.getString("COMMON_RUPEE") + e.chaal_limit + " - " + e.max_entry;
this.PotLimit.node.active = !0;
this.PotLimit.node.x = 50;
this.MaxPayout.node.active = !1;
this.PlayerNum.active = !1;
this.PotLimit.string = c.default.getString("COMMON_RUPEE") + e.pot_limit;
} else if (e.cls == l.GameEnum.PlayType.GAME_TRADITION_AB) {
this.Name.string = c.default.getString("COMMON_RUPEE") + e.base;
this.PointValue.string = c.default.getString("COMMON_RUPEE") + e.max_bet;
this.PotLimit.node.active = !1;
this.MaxPayout.node.active = !0;
this.PlayerNum.active = !1;
this.MaxPayout.string = c.default.getString("COMMON_RUPEE") + e.max_payout;
}
this.ActivePlayers.string = String(e.playing) + " " + c.default.getString("GAME_USER_STATE_PLAYING");
var n = u.ConfigHelper.Instance.getValue("fontcolor", "LOBBY_ROOM_ITEM_NORMAL", "color"), a = u.ConfigHelper.Instance.getValue("fontcolor", "LOBBY_ROOM_ITEM_ADDCASH", "color"), i = u.ConfigHelper.Instance.getValue("fontcolor", "DATING_XIAOREN_GOU", "color"), r = u.ConfigHelper.Instance.getValue("fontcolor", "DATING_XIAOREN_NOGOU", "color"), p = u.ConfigHelper.Instance.getValue("fontcolor", "LOBBY_ROOM_ITEM_PLAYNOW_NORMAL", "color"), f = u.ConfigHelper.Instance.getValue("fontcolor", "LOBBY_ROOM_ITEM_PLAYNOW_ADDCASH", "color");
if (h.default.checkSwitch(h.ClientSwitch.CLIENT_FUNC_SWITCH_PLAY_NOW)) {
var _ = d.VM.getValue("wallet.totalRecharge") > 0, m = !0;
e.base <= .5 && (m = !1);
this._data.currency == l.GameEnum.MoneyType.CASH && (this.isAddCash = e.min_entry > d.VM.getValue("wallet.total"));
this._data.currency == l.GameEnum.MoneyType.GOLD && (this.isAddCash = e.min_entry > d.VM.getValue("wallet.gold"));
m && !_ && (this.isAddCash = !0);
this.Back.spriteFrame = this.Item_Frames[this.isAddCash ? t % 2 + 2 : t % 2];
this.isAddCash ? s.UIUtils.setGray(this.PlayBtnSprite.node, !1, !0) : s.UIUtils.setGray(this.PlayBtnSprite.node, o, !0);
this.PlayBtnSprite.spriteFrame = this.Button_Frames[this.isAddCash ? 1 : 0];
this.PlayNowLabel.string = this.isAddCash ? c.default.getString("DT_AC") : c.default.getString("DT_BUTTON");
s.UIUtils.setNodeColor(this.PlayNowLabel.node, this.isAddCash ? f : p);
s.UIUtils.setNodeColor(this.Name.node, this.isAddCash ? a : n);
s.UIUtils.setNodeColor(this.PointValue.node, this.isAddCash ? a : n);
s.UIUtils.setNodeColor(this.PotLimit.node, this.isAddCash ? a : n);
s.UIUtils.setNodeColor(this.MaxPayout.node, this.isAddCash ? a : n);
s.UIUtils.setNodeColor(this.ActivePlayers.node, this.isAddCash ? a : n);
for (var y = 0; y < this.PlayerCount.length; y++) {
this.PlayerCount[y].active = y < e.max;
s.UIUtils.setNodeColor(this.PlayerCount[y], this.isAddCash ? r : i);
}
} else {
this.Back.spriteFrame = this.Item_Frames[t % 2];
this.PlayBtnSprite.spriteFrame = this.Button_Frames[0];
this.PlayNowLabel.string = c.default.getString("DT_BUTTON");
s.UIUtils.setNodeColor(this.PlayNowLabel.node, p);
s.UIUtils.setNodeColor(this.Name.node, n);
s.UIUtils.setNodeColor(this.PointValue.node, n);
s.UIUtils.setNodeColor(this.PotLimit.node, n);
s.UIUtils.setNodeColor(this.MaxPayout.node, n);
s.UIUtils.setNodeColor(this.ActivePlayers.node, n);
for (y = 0; y < this.PlayerCount.length; y++) {
this.PlayerCount[y].active = y < e.max;
s.UIUtils.setNodeColor(this.PlayerCount[y], i);
}
}
};
t.prototype.onItemEnterCallFunc = function() {
this.node.opacity = 255;
};
t.prototype.onItemExitCallFunc = function() {
this.node.opacity = 0;
};
t.prototype.onCellClicked = function() {
this.SelectedMask.active = !0;
this.SelectedMask.runAction(cc.sequence(cc.fadeIn(.025), cc.fadeOut(.025)));
var e = p.default.Instance.getPlaySwitch(this._data.cls);
this._data.cls >= l.GameEnum.PlayType.RUMMY_POINTS && this._data.cls <= l.GameEnum.PlayType.TP_JOKER && e.s;
this._data.currency == l.GameEnum.MoneyType.CASH && null != this._data.max_entry && 0 != this._data.max_entry && d.VM.getValue("wallet.total") > this._data.max_entry && !this.isAddCash ? r.PopHelper.Instance.showTips(c.default.getString("COMMON_MAX_ENTRY_TIPS")) : this.onCashJoin(this._data.rtype);
};
t.prototype.onCashJoin = function(e) {
var t = p.default.Instance.getGamePlay(e);
if (t) {
if (t.currency == l.GameEnum.MoneyType.GOLD && this.isAddCash) {
var o = {
content: c.default.getString("COMMON_TIPS_CASH"),
leftTitle: c.default.getString("SIGN_BACK"),
leftCallFunc: function() {}
};
r.PopHelper.Instance.showAlert(o);
return;
}
if (t.currency == l.GameEnum.MoneyType.CASH && this.isAddCash) {
f.default.Instance.openRechargeAlert(t.min_entry);
return;
}
if (1 == t.free_limit && d.VM.getValue("wallet.totalRecharge") <= 0) {
f.default.Instance.openRechargeAlert(100, 0, !1);
return;
}
p.default.Instance.sendJoinRoom(t.rtype);
} else _.default.log("Can not find room");
};
i([ g(cc.Sprite) ], t.prototype, "Back", void 0);
i([ g(cc.Label) ], t.prototype, "Name", void 0);
i([ g(cc.Label) ], t.prototype, "PointValue", void 0);
i([ g(cc.Label) ], t.prototype, "MaxPayout", void 0);
i([ g(cc.Label) ], t.prototype, "PotLimit", void 0);
i([ g(cc.Label) ], t.prototype, "ActivePlayers", void 0);
i([ g(cc.Sprite) ], t.prototype, "PlayBtnSprite", void 0);
i([ g(cc.Label) ], t.prototype, "PlayNowLabel", void 0);
i([ g(cc.Node) ], t.prototype, "PlayerNum", void 0);
i([ g([ cc.Node ]) ], t.prototype, "PlayerCount", void 0);
i([ g(cc.Node) ], t.prototype, "HotNode", void 0);
i([ g(cc.Node) ], t.prototype, "SelectedMask", void 0);
i([ g([ cc.SpriteFrame ]) ], t.prototype, "Button_Frames", void 0);
i([ g([ cc.SpriteFrame ]) ], t.prototype, "Item_Frames", void 0);
return i([ y ], t);
}(cc.Component);
o.default = v;
cc._RF.pop();
}, {
"../../../../Game/client/global/enum/game/Game": "Game",
"../../../../Game/client/global/enum/game/UIUtils": "UIUtils",
"../../../../Game/client/model/LanguageModel": "LanguageModel",
"../../../../Game/fromework/helper/ConfigHelper": "ConfigHelper",
"../../../../Game/fromework/mvvm/modelView/ViewModel": "ViewModel",
"../../../../platform/Platform": "Platform",
"../../../global/PopHelper": "PopHelper",
"../../../model/LobbyModel": "LobbyModel",
"../../../model/UserModel": "UserModel",
"../../Wallet/WalletHelper": "WalletHelper"
} ],
LobbyRoomList: [ function(e, t, o) {
"use strict";
cc._RF.push(t, "47f2ddvo1dJFbN1xNhXXip4", "LobbyRoomList");
var n, a = this && this.__extends || (n = function(e, t) {
return (n = Object.setPrototypeOf || {
__proto__: []
} instanceof Array && function(e, t) {
e.__proto__ = t;
} || function(e, t) {
for (var o in t) Object.prototype.hasOwnProperty.call(t, o) && (e[o] = t[o]);
})(e, t);
}, function(e, t) {
n(e, t);
function o() {
this.constructor = e;
}
e.prototype = null === t ? Object.create(t) : (o.prototype = t.prototype, new o());
}), i = this && this.__decorate || function(e, t, o, n) {
var a, i = arguments.length, r = i < 3 ? t : null === n ? n = Object.getOwnPropertyDescriptor(t, o) : n;
if ("object" == typeof Reflect && "function" == typeof Reflect.decorate) r = Reflect.decorate(e, t, o, n); else for (var l = e.length - 1; l >= 0; l--) (a = e[l]) && (r = (i < 3 ? a(r) : i > 3 ? a(t, o, r) : a(t, o)) || r);
return i > 3 && r && Object.defineProperty(t, o, r), r;
};
Object.defineProperty(o, "__esModule", {
value: !0
});
var r = e("../../../../Game/Script/global/GlobalValue"), l = e("../../../../Game/client/global/enum/game/Game"), s = e("../../../../Game/client/model/LanguageModel"), c = e("../../../../Game/fromework/mvvm/modelView/ViewModel"), u = e("../../../../fromework/component/listView/ListView"), d = e("../../../model/LobbyModel"), p = cc._decorator, h = p.ccclass, f = p.property, _ = function(e) {
a(t, e);
function t() {
var t = null !== e && e.apply(this, arguments) || this;
t.RoomList = null;
t.PlayToggle = null;
t.PlayParent = null;
t.CashToggle = null;
t.PracticeToggle = null;
t.GameTypeParent = null;
t.GameType = null;
t.PointValue = null;
t.MaxPlayer = null;
t.PotLimit = null;
t.TP3Patti = null;
t.Rummy = null;
t.TPJoker = null;
t.TPAK47 = null;
t.TraditionAB = null;
t._ui = null;
t._logic = null;
t._cls = null;
t._currency = l.GameEnum.MoneyType.CASH;
return t;
}
t.prototype.init = function(e, t) {
this._ui = e;
this._logic = t;
this.refreshCash();
};
t.prototype.refreshCash = function() {
var e = r.default.getInstance().isCashGame, t = d.default.Instance.getPlaySwitch(l.GameEnum.PlayType.TP_3PATTI);
this.TP3Patti.active = e && t && (2 == t.s || 3 == t.s);
var o = d.default.Instance.getPlaySwitch(l.GameEnum.PlayType.RUMMY_POINTS);
this.Rummy.active = e && o && (2 == o.s || 3 == o.s);
var n = d.default.Instance.getPlaySwitch(l.GameEnum.PlayType.TP_JOKER);
this.TPJoker.active = e && n && (2 == n.s || 3 == n.s);
var a = d.default.Instance.getPlaySwitch(l.GameEnum.PlayType.TP_AK47);
this.TPAK47.active = e && a && (2 == a.s || 3 == a.s);
var i = d.default.Instance.getPlaySwitch(l.GameEnum.PlayType.GAME_TRADITION_AB);
this.TraditionAB.active = e && i && (2 == i.s || 3 == i.s);
};
t.prototype.refreshData = function(e) {
this._cls = e;
this.PracticeToggle.node.active = l.GameEnum.isRummy(e) && !1;
if (null == e) {
if (null == this._cls) if (l.GameEnum.isRummy(e)) this._currency = this.CashToggle.isChecked ? l.GameEnum.MoneyType.CASH : l.GameEnum.MoneyType.PRACTICE; else if (l.GameEnum.isTeenpatti(e)) {
this._currency = l.GameEnum.MoneyType.CASH;
this.CashToggle.isChecked = !0;
} else if (e == l.GameEnum.PlayType.GAME_TRADITION_AB) {
this._currency = l.GameEnum.MoneyType.CASH;
this.CashToggle.isChecked = !0;
}
} else {
this._cls = e;
this._currency = l.GameEnum.MoneyType.CASH;
this.CashToggle.isChecked = !0;
}
this.refreshGameType();
this.refreshListView();
};
t.prototype.refreshGameType = function() {
if (l.GameEnum.isRummy(this._cls)) {
this.GameType.string = "Game Type";
this.PointValue.string = "Point Value";
this.MaxPlayer.string = "Max Players";
this.PotLimit.string = "Min Entry";
this.MaxPlayer.node.active = !0;
this.PotLimit.node.x = -69;
this.GameTypeParent.getChildByName("Rummy").getComponent(cc.Toggle).isChecked = !0;
} else if (l.GameEnum.isTeenpatti(this._cls)) {
this.GameType.string = s.default.getString("TP_BOOT");
this.PointValue.string = s.default.getString("CHAAL_LIMIT");
this.MaxPlayer.string = s.default.getString("DT_MP");
this.PotLimit.string = s.default.getString("POT_LIMIT");
this.MaxPlayer.node.active = !1;
this.PotLimit.node.x = 50;
var e = null;
this._cls == l.GameEnum.PlayType.TP_3PATTI ? e = this.GameTypeParent.getChildByName("3Patti").getComponent(cc.Toggle) : this._cls == l.GameEnum.PlayType.TP_JOKER ? e = this.GameTypeParent.getChildByName("Joker").getComponent(cc.Toggle) : this._cls == l.GameEnum.PlayType.TP_AK47 && (e = this.GameTypeParent.getChildByName("AK47").getComponent(cc.Toggle));
e && (e.isChecked = !0);
} else if (this._cls == l.GameEnum.PlayType.GAME_TRADITION_AB) {
this.GameType.string = s.default.getString("MIN_BET");
this.PointValue.string = s.default.getString("MAX_BET");
this.PotLimit.string = s.default.getString("MAX_PAYOUT");
this.MaxPlayer.node.active = !1;
this.PotLimit.node.x = -69;
this.GameTypeParent.getChildByName("TraditionAB").getComponent(cc.Toggle).isChecked = !0;
}
};
t.prototype.getPlayList = function(e, t) {
var o = d.default.Instance.getGamePlayByType(e, t);
r.default.getInstance().isCashGame || (o = o.filter(function(e) {
return e.min_entry <= c.VM.getValue("wallet.total");
}));
o.sort(function(e, t) {
return e.min_entry != t.min_entry ? e.min_entry - t.min_entry : e.base != t.base ? e.base - t.base : e.max != t.max ? e.max - t.max : 0 != e.pool_score && 0 != t.pool_score ? e.pool_score - t.pool_score : 0 != e.deals_round && 0 != t.deals_round ? e.deals_round - t.deals_round : -1;
});
if (l.GameEnum.isRummy(e) || l.GameEnum.isTeenpatti(e)) {
var n = c.VM.getValue("wallet.totalRecharge");
return o.filter(function(e) {
return n > 4e4 ? e.base > .5 : n > 5e3 ? e.base > .1 : n > 500 ? e.base > .05 : !(n >= 90) || e.base > .01;
});
}
return o;
};
t.prototype.refreshListView = function() {
var e = this, t = this.getPlayList(this._cls, this._currency);
this.RoomList.datas = t;
var o = JSON.parse(cc.sys.localStorage.getItem("isRecharge" + c.VM.getValue("user.uid")));
(o = null != o && o) && cc.sys.localStorage.setItem("isRecharge" + c.VM.getValue("user.uid"), JSON.stringify(!1));
var n = d.default.Instance.getRecommendPlay(t, o);
if (null != n) {
var a = t.indexOf(n);
l.GameEnum.isTeenpatti(this._cls) && a > 0 && a--;
-1 != a && this.scheduleOnce(function() {
e && e.node && e.node.isValid && e.RoomList.scrollToIndex(a, 0);
});
}
};
t.prototype.onPlayClicked = function(e, t) {
var o = parseInt(t);
if (this._cls != o) {
this._cls = o;
this.refreshListView();
}
};
t.prototype.onGameTypeClicked = function(e, t) {
var o = parseInt(t);
this.refreshData(o);
};
t.prototype.onMoneyTypeClicked = function(e, t) {
var o = parseInt(t);
this._currency = o;
this.refreshData(this._cls);
};
t.prototype.onCloseClicked = function() {
this._ui.closePlayList();
};
i([ f(u.default) ], t.prototype, "RoomList", void 0);
i([ f(cc.Node) ], t.prototype, "PlayToggle", void 0);
i([ f(cc.Node) ], t.prototype, "PlayParent", void 0);
i([ f(cc.Toggle) ], t.prototype, "CashToggle", void 0);
i([ f(cc.Toggle) ], t.prototype, "PracticeToggle", void 0);
i([ f(cc.Node) ], t.prototype, "GameTypeParent", void 0);
i([ f(cc.Label) ], t.prototype, "GameType", void 0);
i([ f(cc.Label) ], t.prototype, "PointValue", void 0);
i([ f(cc.Label) ], t.prototype, "MaxPlayer", void 0);
i([ f(cc.Label) ], t.prototype, "PotLimit", void 0);
i([ f(cc.Node) ], t.prototype, "TP3Patti", void 0);
i([ f(cc.Node) ], t.prototype, "Rummy", void 0);
i([ f(cc.Node) ], t.prototype, "TPJoker", void 0);
i([ f(cc.Node) ], t.prototype, "TPAK47", void 0);
i([ f(cc.Node) ], t.prototype, "TraditionAB", void 0);
return i([ h ], t);
}(cc.Component);
o.default = _;
cc._RF.pop();
}, {
"../../../../Game/Script/global/GlobalValue": "GlobalValue",
"../../../../Game/client/global/enum/game/Game": "Game",
"../../../../Game/client/model/LanguageModel": "LanguageModel",
"../../../../Game/fromework/mvvm/modelView/ViewModel": "ViewModel",
"../../../../fromework/component/listView/ListView": "ListView",
"../../../model/LobbyModel": "LobbyModel"
} ],
LobbyRoomPractice: [ function(e, t, o) {
"use strict";
cc._RF.push(t, "13174YPfe5N+4BhImBW0kwi", "LobbyRoomPractice");
var n, a = this && this.__extends || (n = function(e, t) {
return (n = Object.setPrototypeOf || {
__proto__: []
} instanceof Array && function(e, t) {
e.__proto__ = t;
} || function(e, t) {
for (var o in t) Object.prototype.hasOwnProperty.call(t, o) && (e[o] = t[o]);
})(e, t);
}, function(e, t) {
n(e, t);
function o() {
this.constructor = e;
}
e.prototype = null === t ? Object.create(t) : (o.prototype = t.prototype, new o());
}), i = this && this.__decorate || function(e, t, o, n) {
var a, i = arguments.length, r = i < 3 ? t : null === n ? n = Object.getOwnPropertyDescriptor(t, o) : n;
if ("object" == typeof Reflect && "function" == typeof Reflect.decorate) r = Reflect.decorate(e, t, o, n); else for (var l = e.length - 1; l >= 0; l--) (a = e[l]) && (r = (i < 3 ? a(r) : i > 3 ? a(t, o, r) : a(t, o)) || r);
return i > 3 && r && Object.defineProperty(t, o, r), r;
};
Object.defineProperty(o, "__esModule", {
value: !0
});
var r = e("../../../../Game/fromework/helper/EventHelper"), l = e("../../../global/PopHelper"), s = e("../../../../Game/client/model/LanguageModel"), c = e("../../../model/LobbyModel"), u = e("../../../../Game/client/global/enum/game/Event"), d = e("../../../../Game/client/global/enum/game/Game"), p = e("../../../../platform/Platform"), h = cc._decorator, f = h.ccclass, _ = h.property, m = function(e) {
a(t, e);
function t() {
var t = null !== e && e.apply(this, arguments) || this;
t.Title = null;
t.Point = null;
t.Deals = null;
t.Pool = null;
t._logic = null;
t._cls = d.GameEnum.PlayType.RUMMY_POINTS;
t._currency = d.GameEnum.MoneyType.PRACTICE;
t._poolType = 101;
t._dealsType = 2;
t._playerType = 2;
return t;
}
t.prototype.init = function(e) {
this._logic = e;
};
t.prototype.refreshData = function() {
this.refreshView();
};
t.prototype.refreshView = function() {
this.Point.active = this._cls == d.GameEnum.PlayType.RUMMY_POINTS || this._cls == d.GameEnum.PlayType.RUMMY_TENCARD;
this.Pool.active = this._cls == d.GameEnum.PlayType.RUMMY_POOL;
this.Deals.active = this._cls == d.GameEnum.PlayType.RUMMY_DEALS;
this._cls != d.GameEnum.PlayType.RUMMY_POINTS && this._cls != d.GameEnum.PlayType.RUMMY_TENCARD || (this.Title.string = s.default.getString("PRACTICE_RUMMY_POINT"));
this._cls == d.GameEnum.PlayType.RUMMY_POOL && (this.Title.string = s.default.getString("PRACTICE_RUMMY_POOL"));
this._cls == d.GameEnum.PlayType.RUMMY_DEALS && (this.Title.string = s.default.getString("PRACTICE_RUMMY_DEALS"));
};
t.prototype.onClsClicked = function(e, t) {
this._cls = parseInt(t);
this.refreshView();
};
t.prototype.onPlayerTypeClicked = function(e, t) {
this._playerType = parseInt(t);
};
t.prototype.onPoolTypeClicked = function(e, t) {
this._poolType = parseInt(t);
};
t.prototype.onDealsTypeClicked = function(e, t) {
this._dealsType = parseInt(t);
};
t.prototype.onPlayButtonClicked = function() {
var e = this, t = c.default.Instance.getGamePlayByType(this._cls, this._currency), o = null;
t.forEach(function(t) {
t.cls == d.GameEnum.PlayType.RUMMY_POINTS && t.max == e._playerType && t.currency == e._currency && (o = t);
t.cls == d.GameEnum.PlayType.RUMMY_POOL && t.max == e._playerType && t.pool_score == e._poolType && t.currency == e._currency && (o = t);
t.cls == d.GameEnum.PlayType.RUMMY_TENCARD && t.max == e._playerType && t.currency == e._currency && (o = t);
t.cls == d.GameEnum.PlayType.RUMMY_DEALS && t.max == e._playerType && t.deals_round == e._dealsType && t.currency == e._currency && (o = t);
});
o ? r.default.Instance.Global.emit(u.GameUIEvent.LOBBY_PRACTICE_JOIN, o.rtype) : p.default.log("Can not find this play!");
};
t.prototype.onTipsClicked = function() {
var e = "", t = "";
if (this._cls == d.GameEnum.PlayType.RUMMY_POINTS) {
e = s.default.getString("PLAY_TIP_POINT_TITLE");
t = s.default.getString("PLAY_TIP_POINT_CONTENT");
}
if (this._cls == d.GameEnum.PlayType.RUMMY_TENCARD) {
e = s.default.getString("PLAY_TIP_10CAED_TITLE");
t = s.default.getString("PLAY_TIP_10CAED_CONTENT");
}
if (this._cls == d.GameEnum.PlayType.RUMMY_POOL) {
e = s.default.getString("PLAY_TIP_POOL_TITLE");
t = s.default.getString("PLAY_TIP_POOL_CONTENT");
}
if (this._cls == d.GameEnum.PlayType.RUMMY_DEALS) {
e = s.default.getString("PLAY_TIP_DEALS_TITLE");
t = s.default.getString("PLAY_TIP_DEALS_CONTENT");
}
if ("" != e && "" != t) {
var o = {
title: e,
content: t,
leftTitle: s.default.getString("COMMON_CLOSE")
};
l.PopHelper.Instance.showAlert(o);
}
};
i([ _(cc.Label) ], t.prototype, "Title", void 0);
i([ _(cc.Node) ], t.prototype, "Point", void 0);
i([ _(cc.Node) ], t.prototype, "Deals", void 0);
i([ _(cc.Node) ], t.prototype, "Pool", void 0);
return i([ f ], t);
}(cc.Component);
o.default = m;
cc._RF.pop();
}, {
"../../../../Game/client/global/enum/game/Event": "Event",
"../../../../Game/client/global/enum/game/Game": "Game",
"../../../../Game/client/model/LanguageModel": "LanguageModel",
"../../../../Game/fromework/helper/EventHelper": "EventHelper",
"../../../../platform/Platform": "Platform",
"../../../global/PopHelper": "PopHelper",
"../../../model/LobbyModel": "LobbyModel"
} ],
LobbyRoomSlider: [ function(e, t, o) {
"use strict";
cc._RF.push(t, "95c7cPX5QZAlouWe+nhUl27", "LobbyRoomSlider");
var n, a = this && this.__extends || (n = function(e, t) {
return (n = Object.setPrototypeOf || {
__proto__: []
} instanceof Array && function(e, t) {
e.__proto__ = t;
} || function(e, t) {
for (var o in t) Object.prototype.hasOwnProperty.call(t, o) && (e[o] = t[o]);
})(e, t);
}, function(e, t) {
n(e, t);
function o() {
this.constructor = e;
}
e.prototype = null === t ? Object.create(t) : (o.prototype = t.prototype, new o());
}), i = this && this.__decorate || function(e, t, o, n) {
var a, i = arguments.length, r = i < 3 ? t : null === n ? n = Object.getOwnPropertyDescriptor(t, o) : n;
if ("object" == typeof Reflect && "function" == typeof Reflect.decorate) r = Reflect.decorate(e, t, o, n); else for (var l = e.length - 1; l >= 0; l--) (a = e[l]) && (r = (i < 3 ? a(r) : i > 3 ? a(t, o, r) : a(t, o)) || r);
return i > 3 && r && Object.defineProperty(t, o, r), r;
};
Object.defineProperty(o, "__esModule", {
value: !0
});
var r = e("../../../../Game/fromework/helper/EventHelper"), l = e("../../../component/CurrencySlider"), s = e("../../../../Game/client/global/enum/game/Game"), c = e("../../../../Game/client/model/LanguageModel"), u = e("../../../../Game/Script/global/GlobalValue"), d = e("../../../model/LobbyModel"), p = e("../../../../Game/fromework/mvvm/modelView/ViewModel"), h = e("../../../../Game/client/global/enum/game/Event"), f = e("../../../../platform/Platform"), _ = cc._decorator, m = _.ccclass, y = _.property, g = function(e) {
a(t, e);
function t() {
var t = null !== e && e.apply(this, arguments) || this;
t.PlayerType = null;
t.PoolType = null;
t.DealsType = null;
t.ActivityPlayer = null;
t.MinEntry = null;
t.Slider = null;
t.QuickStart = null;
t.QuickStartMoney = null;
t._logic = null;
t._cls = s.GameEnum.PlayType.RUMMY_POINTS;
t._currency = null;
t._poolType = 101;
t._dealsType = 2;
t._playerType = 2;
t._curBase = 0;
t._quickStartType = "";
return t;
}
t.prototype.getBaseAry = function() {
var e = this, t = d.default.Instance.getGamePlayByType(this._cls, this._currency), o = [], n = 0;
t.forEach(function(t) {
if ((e._cls == s.GameEnum.PlayType.RUMMY_POINTS || e._cls == s.GameEnum.PlayType.RUMMY_TENCARD) && t.currency == e._currency && t.max == e._playerType) {
o.indexOf(t.base) < 0 && o.push(t.base);
n += t.playing;
}
if (e._cls == s.GameEnum.PlayType.RUMMY_DEALS && t.currency == e._currency && t.max == e._playerType && t.deals_round == e._dealsType) {
o.indexOf(t.base) < 0 && o.push(t.base);
n += t.playing;
}
if (e._cls == s.GameEnum.PlayType.RUMMY_POOL && t.currency == e._currency && t.max == e._playerType && t.pool_score == e._poolType) {
o.indexOf(t.base) < 0 && o.push(t.base);
n += t.playing;
}
});
this.ActivityPlayer.string = String(n);
o.sort(function(e, t) {
return e - t;
});
return o;
};
t.prototype.getPlayByBase = function(e) {
var t = this, o = d.default.Instance.getGamePlayByType(this._cls, this._currency), n = null;
o.forEach(function(o) {
t._cls != s.GameEnum.PlayType.RUMMY_POINTS && t._cls != s.GameEnum.PlayType.RUMMY_TENCARD || o.currency == t._currency && o.max == t._playerType && o.base == e && (n = o);
t._cls == s.GameEnum.PlayType.RUMMY_DEALS && o.currency == t._currency && o.max == t._playerType && o.deals_round == t._dealsType && o.base == e && (n = o);
t._cls == s.GameEnum.PlayType.RUMMY_POOL && o.currency == t._currency && o.max == t._playerType && o.pool_score == t._poolType && o.base == e && (n = o);
});
return n;
};
t.prototype.init = function(e) {
this._logic = e;
this._cls = s.GameEnum.PlayType.RUMMY_POINTS;
this._currency = u.default.getInstance().isCashGame ? s.GameEnum.MoneyType.CASH : s.GameEnum.MoneyType.GOLD;
this.refreshSlider();
};
t.prototype.refreshData = function(e) {
this._cls = e;
this._currency = u.default.getInstance().isCashGame ? s.GameEnum.MoneyType.CASH : s.GameEnum.MoneyType.GOLD;
this.refreshSlider();
this.refreshQuickStart();
};
t.prototype.refreshQuickStart = function() {
var e = JSON.parse(cc.sys.localStorage.getItem("isRecharge" + p.VM.getValue("user.uid")));
(e = null != e && e) && cc.sys.localStorage.setItem("isRecharge" + p.VM.getValue("user.uid"), JSON.stringify(!1));
var t;
t = this._cls == s.GameEnum.PlayType.RUMMY_DEALS ? d.default.Instance.getGamePlayByType(this._cls, this._currency, this._dealsType) : this._cls == s.GameEnum.PlayType.RUMMY_POOL ? d.default.Instance.getGamePlayByType(this._cls, this._currency, null, this._poolType) : d.default.Instance.getGamePlayByType(this._cls, this._currency);
var o = d.default.Instance.getRecommendPlay(t, e);
if (o) {
this.QuickStart.active = !0;
this.QuickStartMoney.string = c.default.getString("MoneySymbol") + o.base;
this._quickStartType = o.rtype;
} else {
this.QuickStart.active = !1;
this._quickStartType = "";
}
};
t.prototype.refreshSlider = function() {
var e = this;
this.PoolType.active = this._cls == s.GameEnum.PlayType.RUMMY_POOL;
this.DealsType.active = this._cls == s.GameEnum.PlayType.RUMMY_DEALS;
this.PlayerType.active = this._cls != s.GameEnum.PlayType.RUMMY_DEALS;
var t = this.getBaseAry();
this.Slider.updateCurrency(t, function(t) {
e.onSlider(t);
});
this.onSlider(t[0]);
};
t.prototype.onSlider = function(e) {
this._curBase = e;
var t = this.getPlayByBase(e);
t ? this.MinEntry.string = c.default.getString("DT_ME") + " = " + c.default.getString("COMMON_RUPEE") + t.min_entry : f.default.log("onSlider Error:" + e);
};
t.prototype.onPlayerTypeClicked = function(e, t) {
var o = parseInt(t);
this._playerType = o;
this.refreshSlider();
};
t.prototype.onPoolTypeClicked = function(e, t) {
var o = parseInt(t);
this._poolType = o;
this.refreshSlider();
};
t.prototype.onDealsTypeClicked = function(e, t) {
var o = parseInt(t);
this._dealsType = o;
this.refreshSlider();
};
t.prototype.onPlayButtonClicked = function() {
var e = this, t = d.default.Instance.getGamePlayByType(this._cls, this._currency), o = null;
t.forEach(function(t) {
t.cls == s.GameEnum.PlayType.RUMMY_POINTS && t.max == e._playerType && t.base == e._curBase && (o = t);
t.cls == s.GameEnum.PlayType.RUMMY_POOL && t.max == e._playerType && t.pool_score == e._poolType && t.base == e._curBase && (o = t);
t.cls == s.GameEnum.PlayType.RUMMY_TENCARD && t.max == e._playerType && t.base == e._curBase && (o = t);
t.cls == s.GameEnum.PlayType.RUMMY_DEALS && t.max == e._playerType && t.deals_round == e._dealsType && t.base == e._curBase && (o = t);
});
o ? r.default.Instance.Global.emit(h.GameUIEvent.LOBBY_CASH_JOIN, o.rtype) : f.default.log("Can not find this play!");
};
t.prototype.onQuickStartClicked = function() {
"" != this._quickStartType ? r.default.Instance.Global.emit(h.GameUIEvent.LOBBY_CASH_JOIN, this._quickStartType) : f.default.log("Can not find this play!");
};
i([ y(cc.Node) ], t.prototype, "PlayerType", void 0);
i([ y(cc.Node) ], t.prototype, "PoolType", void 0);
i([ y(cc.Node) ], t.prototype, "DealsType", void 0);
i([ y(cc.Label) ], t.prototype, "ActivityPlayer", void 0);
i([ y(cc.Label) ], t.prototype, "MinEntry", void 0);
i([ y(l.default) ], t.prototype, "Slider", void 0);
i([ y(cc.Node) ], t.prototype, "QuickStart", void 0);
i([ y(cc.Label) ], t.prototype, "QuickStartMoney", void 0);
return i([ m ], t);
}(cc.Component);
o.default = g;
cc._RF.pop();
}, {
"../../../../Game/Script/global/GlobalValue": "GlobalValue",
"../../../../Game/client/global/enum/game/Event": "Event",
"../../../../Game/client/global/enum/game/Game": "Game",
"../../../../Game/client/model/LanguageModel": "LanguageModel",
"../../../../Game/fromework/helper/EventHelper": "EventHelper",
"../../../../Game/fromework/mvvm/modelView/ViewModel": "ViewModel",
"../../../../platform/Platform": "Platform",
"../../../component/CurrencySlider": "CurrencySlider",
"../../../model/LobbyModel": "LobbyModel"
} ],
LobbyScene: [ function(e, t, o) {
"use strict";
cc._RF.push(t, "70da8R64W1P8rqqXzNkS/sg", "LobbyScene");
var n, a = this && this.__extends || (n = function(e, t) {
return (n = Object.setPrototypeOf || {
__proto__: []
} instanceof Array && function(e, t) {
e.__proto__ = t;
} || function(e, t) {
for (var o in t) Object.prototype.hasOwnProperty.call(t, o) && (e[o] = t[o]);
})(e, t);
}, function(e, t) {
n(e, t);
function o() {
this.constructor = e;
}
e.prototype = null === t ? Object.create(t) : (o.prototype = t.prototype, new o());
}), i = this && this.__decorate || function(e, t, o, n) {
var a, i = arguments.length, r = i < 3 ? t : null === n ? n = Object.getOwnPropertyDescriptor(t, o) : n;
if ("object" == typeof Reflect && "function" == typeof Reflect.decorate) r = Reflect.decorate(e, t, o, n); else for (var l = e.length - 1; l >= 0; l--) (a = e[l]) && (r = (i < 3 ? a(r) : i > 3 ? a(t, o, r) : a(t, o)) || r);
return i > 3 && r && Object.defineProperty(t, o, r), r;
};
Object.defineProperty(o, "__esModule", {
value: !0
});
var r = e("../../model/MailModel"), l = e("../../model/MonthCardModel"), s = e("../../model/RedDotModel"), c = e("../../model/SingModel"), u = e("../../model/UserModel"), d = e("../../model/WalletModel"), p = e("../../teenpatti/model/TeenPattiModel"), h = e("../Wallet/WalletHelper"), f = e("../active/ActiveModel"), _ = e("../../model/ReferModel"), m = e("../../Festival/Common/FestivalModel"), y = e("../../model/ItemModel"), g = e("../../../Game/fromework/helper/EventHelper"), v = e("../../../Game/client/global/enum/game/Event"), C = e("../../../Game/fromework/helper/AudioHelper"), b = e("../../../Game/client/global/enum/game/Const"), I = e("../../model/LobbyModel"), E = e("../../../Game/fromework/helper/UIHelper"), S = e("../../../Game/Script/global/GlobalValue"), T = e("../../../Game/client/model/LanguageModel"), R = e("../../../Game/fromework/global/Tools"), O = e("../../../Game/client/global/enum/game/Game"), A = e("../../../Game/BundleManager"), P = e("../../model/AddCashVIPModel"), M = e("../../global/PopHelper"), G = e("../../../Slots/Common/SlotProxy"), w = cc._decorator, D = w.ccclass, L = w.property, B = w.menu, N = function(e) {
a(t, e);
function t() {
var t = null !== e && e.apply(this, arguments) || this;
t.Background = null;
t.UILayer = null;
t.TopLayer = null;
return t;
}
t.prototype.onEnable = function() {
g.default.Instance.Global.bind(v.LobbyEvent.LOBBY_JOIN, this._onJoinRoom, this);
};
t.prototype.onDisable = function() {
g.default.Instance.Global.unbind(v.LobbyEvent.LOBBY_JOIN, this._onJoinRoom, this);
};
t.prototype.onLoad = function() {
var e = this;
C.default.Instance.stopBGM();
C.default.Instance.playBGMBundle(b.BundleSoundPath.bgm_lobby);
I.default.Instance.sendHome();
E.default.Instance.setLayers(this.Background, this.UILayer, this.TopLayer);
E.default.Instance.addBundleLayer(b.BundleUIPath.LobbyView);
this.refreshRedDot();
d.WalletProxy.Instance.sendGetUserWallet();
S.default.getInstance().isCashGame && this.scheduleOnce(function() {
e.checkBankruptcy();
e.checkTPTimeOut();
});
if (u.default.Instance.phoneTokenIsTimeOut) {
var t = {
content: T.default.getString("LONGIN_PHONE_TOKEN_FAILED"),
leftTitle: T.default.getString("TABLE_BTN_YES")
};
M.PopHelper.Instance.showAlert(t);
}
};
t.prototype.onDestroy = function() {
this.unscheduleAllCallbacks();
};
t.prototype.start = function() {};
t.prototype.refreshRedDot = function() {
r.default.Instance.sendEmailList();
s.RedDotProxy.Instance.sendGetRedDotStatus();
c.default.Instance.sendGetUserSigned();
d.WalletProxy.Instance.sendGetActivityList();
d.WalletProxy.Instance.sendGetNotice();
d.WalletProxy.Instance.sendGetRechargeGoods(0, []);
l.MonthCardProxy.Instance.sendGetMonthCardList();
h.default.Instance.getServiceUnreadCount();
d.WalletProxy.Instance.sendGetBonusUnaccalimed();
d.WalletProxy.Instance.sendPhoneMailState();
f.ActiveProxy.Instance.sendGetBrokeActive();
_.ReferProxy.Instance.sendGetInviteBox();
m.FestivalProxy.Instance.sendGetActAll();
y.ItemProxy.Instance.sendGetUserItem();
P.AddCashVIPProxy.Instance.getVipInfo();
};
t.prototype.checkBankruptcy = function() {
if (S.default.getInstance().isCashGame) {
var e = I.default.Instance.kickRoomType;
if ("" != e) {
var t = I.default.Instance.getGamePlay(e);
if (t) {
I.default.Instance.kickRoomType = "";
h.default.Instance.openRechargeAlert(t.min_entry, 0, !0, function(e) {
e && e.node && e.node.isValid;
});
}
}
}
};
t.prototype.checkTPTimeOut = function() {
if (0 != p.default.Instance.lose_fee) {
var e = {
title: T.default.getString("PROMPT_NOTICE"),
content: R.Tools.TStr.replaceString(T.default.getString("TP_TIMEOUT_CONTENT"), {
num: p.default.Instance.lose_fee
}),
rightTitle: T.default.getString("TABLE_BTN_YES")
};
p.default.Instance.lose_fee = 0;
M.PopHelper.Instance.showAlert(e);
}
};
t.prototype._onJoinRoom = function(e) {
var t = e.getUserData();
if (O.GameEnum.isRummy(t.play.cls)) A.default.getInstance().enterBundleScene(b.Scene.Game); else if (O.GameEnum.isTeenpatti(t.play.cls)) {
p.default.Instance.cls = t.play.cls;
A.default.getInstance().enterBundleScene(b.Scene.TeenPatti);
} else if (t.play.cls == O.GameEnum.PlayType.GAME_ANDARBAHAR) A.default.getInstance().enterBundleScene(b.Scene.AndarBahar); else if (t.play.cls == O.GameEnum.PlayType.GAME_REDBLACK) A.default.getInstance().enterBundleScene(b.Scene.RedAndBlack); else if (t.play.cls == O.GameEnum.PlayType.GAME_LUCKYDICE) A.default.getInstance().enterBundleScene(b.Scene.LuckyDice); else if (t.play.cls == O.GameEnum.PlayType.GAME_DRAGON_VS_TIGER) A.default.getInstance().enterBundleScene(b.Scene.DragonVSTiger); else if (t.play.cls == O.GameEnum.PlayType.GAME_7UP7DOWN) A.default.getInstance().enterBundleScene(b.Scene.SevenUpDown); else if (t.play.cls == O.GameEnum.PlayType.GAME_TRADITION_AB) A.default.getInstance().enterBundleScene(b.Scene.TraditionAndarBahar); else if (t.play.cls == O.GameEnum.PlayType.GAME_BLAST_SPACE) A.default.getInstance().enterBundleScene(b.Scene.BlastSpace); else if (t.play.cls == O.GameEnum.PlayType.GAME_TP_WAR) A.default.getInstance().enterBundleScene(b.Scene.TPWar); else if (t.play.cls == O.GameEnum.PlayType.GAME_ROULETTE) A.default.getInstance().enterBundleScene(b.Scene.Roulette); else if (t.play.cls == O.GameEnum.PlayType.GAME_RB_FAST) E.default.Instance.addBundleMaskLayer(b.BundleUIPath.RBFast, null, M.PopZindex.RBFast); else if (t.play.cls == O.GameEnum.PlayType.GAME_LOTO_FAST) E.default.Instance.addBundleMaskLayer(b.BundleUIPath.LotoFast, null, M.PopZindex.RBFast); else if (t.play.cls == O.GameEnum.PlayType.GAME_SLOT_200) {
G.default.Instance.cls = 200;
A.default.getInstance().enterBundleScene(b.Scene.Slot);
} else if (t.play.cls == O.GameEnum.PlayType.GAME_SLOT_201) {
G.default.Instance.cls = 201;
A.default.getInstance().enterBundleScene(b.Scene.Slot);
}
};
i([ L(cc.Node) ], t.prototype, "Background", void 0);
i([ L(cc.Node) ], t.prototype, "UILayer", void 0);
i([ L(cc.Node) ], t.prototype, "TopLayer", void 0);
return i([ D, B("Scene/LobbyScene") ], t);
}(cc.Component);
o.default = N;
cc._RF.pop();
}, {
"../../../Game/BundleManager": "BundleManager",
"../../../Game/Script/global/GlobalValue": "GlobalValue",
"../../../Game/client/global/enum/game/Const": "Const",
"../../../Game/client/global/enum/game/Event": "Event",
"../../../Game/client/global/enum/game/Game": "Game",
"../../../Game/client/model/LanguageModel": "LanguageModel",
"../../../Game/fromework/global/Tools": "Tools",
"../../../Game/fromework/helper/AudioHelper": "AudioHelper",
"../../../Game/fromework/helper/EventHelper": "EventHelper",
"../../../Game/fromework/helper/UIHelper": "UIHelper",
"../../../Slots/Common/SlotProxy": "SlotProxy",
"../../Festival/Common/FestivalModel": "FestivalModel",
"../../global/PopHelper": "PopHelper",
"../../model/AddCashVIPModel": "AddCashVIPModel",
"../../model/ItemModel": "ItemModel",
"../../model/LobbyModel": "LobbyModel",
"../../model/MailModel": "MailModel",
"../../model/MonthCardModel": "MonthCardModel",
"../../model/RedDotModel": "RedDotModel",
"../../model/ReferModel": "ReferModel",
"../../model/SingModel": "SingModel",
"../../model/UserModel": "UserModel",
"../../model/WalletModel": "WalletModel",
"../../teenpatti/model/TeenPattiModel": "TeenPattiModel",
"../Wallet/WalletHelper": "WalletHelper",
"../active/ActiveModel": "ActiveModel"
} ],
LobbySetting: [ function(e, t, o) {
"use strict";
cc._RF.push(t, "106a0KFo1FAh4PE6acsJdwC", "LobbySetting");
var n, a = this && this.__extends || (n = function(e, t) {
return (n = Object.setPrototypeOf || {
__proto__: []
} instanceof Array && function(e, t) {
e.__proto__ = t;
} || function(e, t) {
for (var o in t) Object.prototype.hasOwnProperty.call(t, o) && (e[o] = t[o]);
})(e, t);
}, function(e, t) {
n(e, t);
function o() {
this.constructor = e;
}
e.prototype = null === t ? Object.create(t) : (o.prototype = t.prototype, new o());
}), i = this && this.__decorate || function(e, t, o, n) {
var a, i = arguments.length, r = i < 3 ? t : null === n ? n = Object.getOwnPropertyDescriptor(t, o) : n;
if ("object" == typeof Reflect && "function" == typeof Reflect.decorate) r = Reflect.decorate(e, t, o, n); else for (var l = e.length - 1; l >= 0; l--) (a = e[l]) && (r = (i < 3 ? a(r) : i > 3 ? a(t, o, r) : a(t, o)) || r);
return i > 3 && r && Object.defineProperty(t, o, r), r;
};
Object.defineProperty(o, "__esModule", {
value: !0
});
var r = e("../../../../Config"), l = e("../../../../Game/Script/global/GlobalValue"), s = e("../../../../Game/fromework/helper/AudioHelper"), c = e("../../../../Game/fromework/helper/UIHelper"), u = e("../../../../Game/fromework/mvvm/modelView/ViewModel"), d = e("../../../global/PopHelper"), p = e("../../../../Game/client/model/LanguageModel"), h = e("../../Wallet/WalletHelper"), f = e("../../../global/Global"), _ = e("../../../../platform/Platform"), m = new function() {
this.music = 0;
this.sound = 0;
this.volumeMax = 100;
this.isDisableAll = !1;
this.isPlayVibration = !0;
this.isPlayTimeOver = !0;
this.isPlayOwnRound = !0;
}();
u.VM.add(m, "lobbySet");
var y = cc._decorator, g = y.ccclass, v = y.property, C = function(e) {
a(t, e);
function t() {
var t = null !== e && e.apply(this, arguments) || this;
t.Layout = null;
t.MainPanel = null;
t.LanguagePanel = null;
t.SoundPanel = null;
t.TermsPanel = null;
t.MainSound = null;
t.MainLanguage = null;
t.MainTerms = null;
t.MainFeedBack = null;
t.MainGuide = null;
t.MusicProgress = null;
t.SoundProgress = null;
t.versionLabel = null;
t._isPlayAnimation = !1;
t._curPanel = null;
t._selectLang = "";
return t;
}
t.prototype.playInAnimation = function(e, t) {
var o = this;
if (!this._isPlayAnimation) {
this._isPlayAnimation = !0;
e.on(cc.Animation.EventType.FINISHED, function() {
o._isPlayAnimation = !1;
t && t();
}, this);
e.play("SettingRightIn");
}
};
t.prototype.playOutAnimation = function(e, t) {
var o = this;
if (!this._isPlayAnimation) {
this._isPlayAnimation = !0;
e.on(cc.Animation.EventType.FINISHED, function() {
o._isPlayAnimation = !1;
t && t();
}, this);
e.play("SettingRightOut");
}
};
t.prototype.onLoad = function() {
var e = l.default.getInstance().isCashGame;
this.MainFeedBack.active = e;
this.MainGuide.active = e;
this.MainTerms.active = e;
};
t.prototype.start = function() {
var e = this.LanguagePanel.getChildByName(p.default.Instance.getCurLanguage());
e && (e.getComponent(cc.Toggle).isChecked = !0);
u.VM.setValue("lobbySet.music", 100 * s.default.Instance.bgmVolume);
u.VM.setValue("lobbySet.sound", 100 * s.default.Instance.effectVolume);
var t = JSON.parse(cc.sys.localStorage.getItem("Game_Audio_Vibration"));
null == t && (t = !0);
u.VM.setValue("lobbySet.isPlayVibration", t);
this.MusicProgress.progress = s.default.Instance.bgmVolume;
this.SoundProgress.progress = s.default.Instance.effectVolume;
this.MainPanel.active = !0;
this.SoundPanel.active = !0;
this._curPanel = this.SoundPanel;
this.playInAnimation(this.Layout.getComponent(cc.Animation));
this.versionLabel.string = "GameVer: " + _.default.getGameVersion();
};
t.prototype.onClickLanguage = function() {
this.SoundPanel.active = !1;
this.LanguagePanel.active = !0;
this.TermsPanel.active = !1;
};
t.prototype.onClickSound = function() {
this.SoundPanel.active = !0;
this.LanguagePanel.active = !1;
this.TermsPanel.active = !1;
};
t.prototype.onClickTermsPrivaci = function() {
this.SoundPanel.active = !1;
this.LanguagePanel.active = !1;
this.TermsPanel.active = !0;
};
t.prototype.onLanguageToggle = function(e, t) {
if ("" != t && this._selectLang != t) {
this._selectLang = t;
p.default.Instance.changeLanguage(this._selectLang);
}
};
t.prototype.onMusicChange = function(e) {
s.default.Instance.bgmVolume = e.progress;
this.MusicProgress.progress = e.progress;
};
t.prototype.onSoundChange = function(e) {
s.default.Instance.effectVolume = e.progress;
this.SoundProgress.progress = e.progress;
};
t.prototype.onSoundToggle = function(e, t) {
var o = parseInt(t), n = u.VM.getValue("lobbySet.isPlayVibration");
1 == o && (n = !n);
u.VM.setValue("lobbySet.isPlayVibration", n);
cc.sys.localStorage.setItem("Game_Audio_Vibration", JSON.stringify(n));
};
t.prototype.onClickTerms = function() {
this.onCloseClicked();
l.default.getInstance().isCashGame && cc.sys.openURL(r.Config.TermsServiceUrl);
};
t.prototype.onPrivacyClicked = function() {
this.onCloseClicked();
l.default.getInstance().isCashGame && cc.sys.openURL(r.Config.PrivatePolicyUrl);
};
t.prototype.onContactUsClicked = function() {
this.onCloseClicked();
l.default.getInstance().isCashGame && cc.sys.openURL(r.Config.ContactUsUrl);
};
t.prototype.onGuildClicked = function() {
d.PopHelper.Instance.showTips(p.default.getString("PROMPT_COME"));
};
t.prototype.onFeedbackClicked = function() {
h.default.Instance.openSerciveView();
};
t.prototype.onClickLogOut = function() {
cc.sys.localStorage.setItem("isRelogin", "true");
f.Global.Instance.restartGame();
};
t.prototype.onCloseClicked = function() {
var e = this;
this.playOutAnimation(this.Layout.getComponent(cc.Animation), function() {
c.default.Instance.removeMaskLayer(e.node);
});
};
i([ v(cc.Node) ], t.prototype, "Layout", void 0);
i([ v(cc.Node) ], t.prototype, "MainPanel", void 0);
i([ v(cc.Node) ], t.prototype, "LanguagePanel", void 0);
i([ v(cc.Node) ], t.prototype, "SoundPanel", void 0);
i([ v(cc.Node) ], t.prototype, "TermsPanel", void 0);
i([ v(cc.Node) ], t.prototype, "MainSound", void 0);
i([ v(cc.Node) ], t.prototype, "MainLanguage", void 0);
i([ v(cc.Node) ], t.prototype, "MainTerms", void 0);
i([ v(cc.Node) ], t.prototype, "MainFeedBack", void 0);
i([ v(cc.Node) ], t.prototype, "MainGuide", void 0);
i([ v(cc.ProgressBar) ], t.prototype, "MusicProgress", void 0);
i([ v(cc.ProgressBar) ], t.prototype, "SoundProgress", void 0);
i([ v(cc.Label) ], t.prototype, "versionLabel", void 0);
return i([ g ], t);
}(cc.Component);
o.default = C;
cc._RF.pop();
}, {
"../../../../Config": "Config",
"../../../../Game/Script/global/GlobalValue": "GlobalValue",
"../../../../Game/client/model/LanguageModel": "LanguageModel",
"../../../../Game/fromework/helper/AudioHelper": "AudioHelper",
"../../../../Game/fromework/helper/UIHelper": "UIHelper",
"../../../../Game/fromework/mvvm/modelView/ViewModel": "ViewModel",
"../../../../platform/Platform": "Platform",
"../../../global/Global": "Global",
"../../../global/PopHelper": "PopHelper",
"../../Wallet/WalletHelper": "WalletHelper"
} ],
LobbyView: [ function(e, t, o) {
"use strict";
cc._RF.push(t, "7da136sHfFMbpcADtGl/uAe", "LobbyView");
var n, a = this && this.__extends || (n = function(e, t) {
return (n = Object.setPrototypeOf || {
__proto__: []
} instanceof Array && function(e, t) {
e.__proto__ = t;
} || function(e, t) {
for (var o in t) Object.prototype.hasOwnProperty.call(t, o) && (e[o] = t[o]);
})(e, t);
}, function(e, t) {
n(e, t);
function o() {
this.constructor = e;
}
e.prototype = null === t ? Object.create(t) : (o.prototype = t.prototype, new o());
}), i = this && this.__decorate || function(e, t, o, n) {
var a, i = arguments.length, r = i < 3 ? t : null === n ? n = Object.getOwnPropertyDescriptor(t, o) : n;
if ("object" == typeof Reflect && "function" == typeof Reflect.decorate) r = Reflect.decorate(e, t, o, n); else for (var l = e.length - 1; l >= 0; l--) (a = e[l]) && (r = (i < 3 ? a(r) : i > 3 ? a(t, o, r) : a(t, o)) || r);
return i > 3 && r && Object.defineProperty(t, o, r), r;
};
Object.defineProperty(o, "__esModule", {
value: !0
});
var r = e("../../../global/PopHelper"), l = e("../../../model/InviteModel"), s = e("../../../model/LobbyModel"), c = e("../../../model/MonthCardModel"), u = e("../../../model/ReferModel"), d = e("../../../model/UserModel"), p = e("../../../model/WalletModel"), h = e("../../active/ActiveManager"), f = e("../../active/ActiveModel"), _ = e("../../Wallet/WalletHelper"), m = e("../UserInfo/UserInfo"), y = e("./LobbyLogic"), g = e("./LobbyRoomList"), v = e("../../../global/Global"), C = e("../../../model/RedDotModel"), b = e("../../../model/RecentModel"), I = e("../Recent/RecentPayView"), E = e("../../../model/MarqueeModel"), S = e("../../../../Game/Script/global/GlobalValue"), T = e("../../../../Game/fromework/mvvm/modelView/ViewModel"), R = e("../../../../Game/client/global/enum/game/Event"), O = e("../../../../Game/fromework/helper/EventHelper"), A = e("../../../../platform/Platform"), P = e("../../../../Game/fromework/global/Tools"), M = e("../../../../Game/fromework/global/ResLoader"), G = e("../../../../Game/client/global/enum/game/UIUtils"), w = e("../../../../Game/client/model/LanguageModel"), D = e("../../../../Game/client/global/enum/game/Game"), L = e("../../../../Game/fromework/helper/UIHelper"), B = e("../../../../Game/client/global/enum/game/Const"), N = e("../MonthCard/MonthCardLobbyView"), k = e("../../../model/SingModel"), F = e("../Bonus/WelComeBonus"), H = e("../MonthCard/GoldSliverCard"), U = e("../../../model/AddCashVIPModel"), V = e("../AddCashVIP/AddCashVIP"), x = e("../AddCashVIP/AddCashEvent"), W = e("../Challenga/ChallengeModel"), j = e("../SignLayer/SignLayer"), K = e("../../../../Game/fromework/helper/AudioHelper"), Y = cc._decorator, J = Y.ccclass, z = Y.property, q = {
1: "resources/Spine/Lobby/gameIconNew/Rummy/tn",
5: "resources/Spine/Lobby/gameIconNew/3Patti/16Xiang",
6: "resources/Spine/Lobby/gameIconNew/ak47/akm",
7: "resources/Spine/Lobby/gameIconNew/tpJoke/houzi",
8: "resources/Spine/Lobby/gameIconNew/AndarBahar/6Ying",
9: "resources/Spine/Lobby/gameIconNew/RedBlack/7ShiZi",
10: "resources/Spine/Lobby/gameIconNew/LuckyDice/kongque",
11: "resources/Spine/Lobby/gameIconNew/DragonTiger/2Laohu",
12: "resources/Spine/Lobby/gameIconNew/7Up7Down/5Niu",
13: "resources/Spine/Lobby/gameIconNew/TraditionAndarBahar/long",
14: "resources/Spine/Lobby/gameIconNew/RedBlack/7ShiZi",
15: "resources/Spine/Lobby/gameIconNew/LuckyLoto/15ShiZi",
16: "resources/Spine/Lobby/gameIconNew/BlastSpace/huojian",
17: "resources/Spine/Lobby/gameIconNew/TPWar/guowang_wanghou",
20: "resources/Spine/Lobby/gameIconNew/Roulette/CarRoulette",
200: "resources/Spine/Lobby/gameIconNew/Slot200/laohuji01",
201: "resources/Spine/Lobby/gameIconNew/Slot201/laohuji02"
}, X = {
1: "RUMMY",
5: "TEEN PATTI",
6: "AK 47",
7: "TP JOKER",
8: "ANDAR BAHAR",
9: "RED VS BLACK",
10: "JHNDI MUNDA",
11: "DRAGON TIGER",
12: "7 UP DOWN",
13: "AB BACCARAT",
14: "RED VS BLACK",
15: "LUCKY LOTO",
16: "BLAST SPACEX",
17: "TP WAR",
20: "CAR ROULETTE",
200: "GANESH",
201: "TEMPLE"
}, Z = function(e) {
a(t, e);
function t() {
var t = null !== e && e.apply(this, arguments) || this;
t.PlayList = null;
t.UserHeadImage = null;
t.TopRechargeButton = null;
t.WalletButton = null;
t.BottomRechargeButton = null;
t.CardDropView = null;
t.CardDropPanel = null;
t.UserBonus = null;
t.UserCash = null;
t.UserGold = null;
t.ReferButton = null;
t.ReferShareButton = null;
t.CouponsButton = null;
t.BonusButton = null;
t.BrokeButton = null;
t.SuperButton = null;
t.LuckyButton = null;
t.TaskButton = null;
t.NotCashGame = null;
t.ChatNode = null;
t.ChatContent = null;
t.ChatIgnoreButton = null;
t.ChatConfirmButton = null;
t.ChatCheckButton = null;
t.MoreButton = null;
t.EMailButton = null;
t.SupportButton = null;
t.DetailButton = null;
t.NoticeButton = null;
t.SignRedPot = null;
t.Banner = null;
t.BannerContent = null;
t.BannerItem = null;
t.PlayScrollView = null;
t.PlayView = null;
t.PlayItem = null;
t.cardButton = null;
t.AddCashVIPButton = null;
t.menuLayer = null;
t.BonusGiftButton = null;
t.btnSign = null;
t.coinSprFra = null;
t._logic = null;
t._bannerList = [];
t._bannerIndex = 0;
t._bannerTimeID = -1;
t._lobbyChatType = b.LobbyChatType.None;
t.BannerItemUp = null;
t.BannerItemUpSprite = [];
t.BannerItemUpIndex = 0;
t.bShow = !1;
t.ExchangeDownTime = 0;
t.tiemCall = null;
return t;
}
t.prototype.onEnable = function() {
this._logic.bindEvent();
};
t.prototype.onDisable = function() {
this._logic.unbindEvent();
};
t.prototype.onLoad = function() {
var e = this;
this._logic = new y.default(this);
this._logic.onLoad();
this.PlayList.init(this, this._logic);
this.refreshLobby();
r.PopHelper.Instance.addLotoFastMarquee(this.node);
var t = c.MonthCardProxy.Instance.monthCardAll, o = t.all_month_card[0], n = t.all_month_card[1], a = t.all_month_card[2];
if (o && n && a) {
var i, l = 0;
2 == o.card_status && 1 == o.tag ? l = 1 : 2 == n.card_status && 1 == n.tag ? l = 2 : 2 == a.card_status && 1 == a.tag ? l = 3 : 1 == o.card_status && o.remaining_days <= o.renew_num ? l = 1 : 1 == n.card_status && n.remaining_days <= n.renew_num ? l = 2 : 1 == a.card_status && a.remaining_days <= a.renew_num ? l = 3 : 2 == o.card_status && 0 == o.tag ? l = 1 : 2 == n.card_status && 0 == n.tag ? l = 2 : 2 == a.card_status && 0 == a.tag && (l = 3);
i = 0 != l;
this.BannerItemUpIndex = l;
this.BannerItemUp.active = i;
if (i) {
var s = this.BannerItemUp.getChildByName("animation").getComponent(sp.Skeleton);
s.skeletonData = this.BannerItemUpSprite[l - 1];
s.premultipliedAlpha = !1;
s.setAnimation(0, "animation", !0);
}
this.bShow = i;
if (0 == d.userSoundHavePlay.SOUND_LOBBY_BOSS) {
K.default.Instance.playBundleEffect("resources/sound/tipEffect/Boss", !1, null, !1, !0);
d.userSoundHavePlay.SOUND_LOBBY_BOSS = 1;
}
}
this.scheduleOnce(function() {
O.default.Instance.Global.emit(R.TipsEvent.TIPS_SYSTEM_WITHDRAW_ALERT);
E.default.Instance.sendLobbyGetSystemNotice();
});
c.MonthCardProxy.Instance.sendGetMonthCardList();
this.withdrawFinger(!!T.VM.getValue("wallet.withdrawFinger"));
this.cardButton.getChildByName("RedDot").active = !1;
this.showGoldCardRedDotData();
W.ChallengeModel.Instance.getChallengeInfo();
f.ActiveProxy.Instance.alreadyBuy ? this.BonusGiftButton.active = !1 : this.BonusGiftButton.active = !0;
if (f.ActiveProxy.Instance.isOpenExchangeActive) {
this.node.getChildByName("Bottom").getChildByName("Right").getChildByName("exchangeButton").active = !0;
this.referExchangeRed();
} else this.node.getChildByName("Bottom").getChildByName("Right").getChildByName("exchangeButton").active = !1;
v.Global.Instance.isFirstLoginLobby && 0 == v.Global.Instance.isCurLoginRegist && !A.default.isOfflinePackage() && cc.sys.os !== cc.sys.OS_IOS && L.default.Instance.addBundleMaskLayer(B.BundleUIPath.DownNewLayer, function() {}, 20);
v.Global.Instance.down_safe_trigger && v.Global.Instance.isFirstLoginLobby && r.PopHelper.Instance.showReward(v.Global.Instance.changeReward(v.Global.Instance.down_safe_reward), null);
if (v.Global.Instance.isFirstLoginLobby && v.Global.Instance.login_reward && null != v.Global.Instance.login_reward && Object.keys(v.Global.Instance.login_reward).length > 0) {
this.scheduleOnce(function() {
e.creatorCoinActToMyHead();
});
r.PopHelper.Instance.showReward(v.Global.Instance.changeReward(v.Global.Instance.login_reward), function() {
e.popUpLayer();
}, null, !0);
} else this.popUpLayer();
v.Global.Instance.isFirstLoginLobby = !1;
};
t.prototype.popUpLayer = function() {
if (!h.default.Instance._loginSignBool) {
var e = k.default.Instance.signDatas;
if (e) {
var t = null == e ? void 0 : e.sign_day;
if (!t || t <= 0 || !e) {
this.btnSign.node.active = !1;
S.default.getInstance().isPopView = !0;
}
}
if (1 == d.default.checkSwitch(d.ClientSwitch.CLIENT_FUNC_SWITCH_SIGN) && S.default.getInstance().isCashGame && !S.default.getInstance().isPopView) {
S.default.getInstance().isPopView = !0;
e && L.default.Instance.addBundleMaskLayer(B.BundleUIPath.SignLayer, function(e) {
e.getComponent(j.default).show(!0);
});
} else if (h.default.Instance._loginBonusBool) ; else {
var o = c.MonthCardProxy.Instance.goldSliverData;
if (o && null != o) {
var n = o.all_month_card[1], a = o.all_month_card[0];
1 == n.card_status || 1 == a.card_status ? f.ActiveProxy.Instance.alreadyBuy ? this.openLoginAlert() : L.default.Instance.addBundleMaskLayer(B.BundleUIPath.WelComeBonus, function(e) {
e.getComponent(F.default).show(!0);
}) : L.default.Instance.addBundleMaskLayer(B.BundleUIPath.GoldSliverCard, function(e) {
e.getComponent(H.default).show(!0);
});
h.default.Instance._loginBonusBool = !0;
}
}
}
};
t.prototype.referExchangeRed = function() {
var e = this;
this.node.getChildByName("Bottom").getChildByName("Right").getChildByName("exchangeButton").active = f.ActiveProxy.Instance.isOpenExchangeActive;
if (f.ActiveProxy.Instance.isOpenExchangeActive) {
T.VM.getValue("wallet.withdraw") > 100 ? this.node.getChildByName("Bottom").getChildByName("Right").getChildByName("exchangeButton").getChildByName("RedDot").active = !0 : this.node.getChildByName("Bottom").getChildByName("Right").getChildByName("exchangeButton").getChildByName("RedDot").active = !1;
if (f.ActiveProxy.Instance.ExchangeData) if (f.ActiveProxy.Instance.ExchangeData.activeInfo && f.ActiveProxy.Instance.ExchangeData.activeInfo.active && 1 == f.ActiveProxy.Instance.ExchangeData.activeInfo.active) {
this.node.getChildByName("Bottom").getChildByName("Right").getChildByName("exchangeButton").getChildByName("time").active = !0;
this.node.getChildByName("Bottom").getChildByName("Right").getChildByName("exchangeButton").getChildByName("exchangeTime").active = !0;
this.ExchangeDownTime = f.ActiveProxy.Instance.ExchangeData.activeInfo.createtime + f.ActiveProxy.Instance.ExchangeData.activeInfo.cooltime - (Number(new Date().getTime()) / 1e3 - Number(v.Global.Instance.TimeDifference));
var t = P.Tools.TDate.second2Hour(this.ExchangeDownTime), o = String(t.hour), n = String(t.minu), a = String(t.sec);
t.hour < 10 && (o = "0" + t.hour);
t.minu < 10 && (n = "0" + t.minu);
t.sec < 10 && (a = "0" + t.sec);
this.node.getChildByName("Bottom").getChildByName("Right").getChildByName("exchangeButton").getChildByName("time").getComponent(cc.Label).string = o + ":" + n + ":" + a;
this.tiemCall && this.node.getChildByName("Bottom").getChildByName("Right").getChildByName("exchangeButton").getComponent(cc.Component).unschedule(this.tiemCall);
this.tiemCall = function() {
e.ExchangeDownTime = e.ExchangeDownTime - 1;
var t = P.Tools.TDate.second2Hour(e.ExchangeDownTime), o = String(t.hour), n = String(t.minu), a = String(t.sec);
t.hour < 10 && (o = "0" + t.hour);
t.minu < 10 && (n = "0" + t.minu);
t.sec < 10 && (a = "0" + t.sec);
e.node.getChildByName("Bottom").getChildByName("Right").getChildByName("exchangeButton").getChildByName("time").getComponent(cc.Label).string = o + ":" + n + ":" + a;
e.ExchangeDownTime <= 0 && e.node.getChildByName("Bottom").getChildByName("Right").getChildByName("exchangeButton").getComponent(cc.Component).unschedule(e.tiemCall);
};
this.node.getChildByName("Bottom").getChildByName("Right").getChildByName("exchangeButton").getComponent(cc.Component).schedule(this.tiemCall, 1);
} else {
this.node.getChildByName("Bottom").getChildByName("Right").getChildByName("exchangeButton").getChildByName("time").active = !1;
this.node.getChildByName("Bottom").getChildByName("Right").getChildByName("exchangeButton").getChildByName("exchangeTime").active = !1;
}
}
};
t.prototype.openLoginAlert = function() {
S.default.getInstance().isCashGame ? h.default.Instance.openLoginFuncAlert(this.bShow, this.BannerItemUpIndex) : T.VM.setValue("user.isFirstLogin", !1);
};
t.prototype.withdrawFinger = function(e) {
var t = this.node.getChildByName("UserView").getChildByName("handWithdraw");
t.active = !!e;
t.stopAllActions();
t.scale = 1;
e && t.runAction(cc.sequence(cc.scaleTo(.5, 1.2), cc.scaleTo(.5, 1), cc.delayTime(.2)).repeatForever());
};
t.prototype.onDestroy = function() {
this.unscheduleAllCallbacks();
this._logic.unbindEvent();
this._logic.onDestroy();
this._bannerList.splice(0);
if (-1 != this._bannerTimeID) {
clearTimeout(this._bannerTimeID);
this._bannerTimeID = -1;
}
};
t.prototype.refreshLobby = function() {
var e = S.default.getInstance().isCashGame;
this.TopRechargeButton.active = !1;
this.BottomRechargeButton.active = e;
this.WalletButton.active = e;
this.UserBonus.active = e;
this.UserCash.active = e;
this.UserGold.active = !e;
this.BonusButton.active = e;
this.CouponsButton.active = 1 == d.default.checkSwitch(d.ClientSwitch.CLIENT_FUNC_SWITCH_MONTH_CARD) && e;
this.BrokeButton.active = !1;
this.ReferButton.active = 1 == d.default.checkSwitch(d.ClientSwitch.CLIENT_FUNC_SWITCH_REFER) && e;
this.ReferShareButton.active = 0 == d.default.checkSwitch(d.ClientSwitch.CLIENT_FUNC_SWITCH_REFER) && 1 == d.default.checkSwitch(d.ClientSwitch.CLIENT_FUNC_SWITCH_GP_SHARE) && e;
this.SupportButton.active = e;
this.TaskButton.active = !1;
this.checkActivity(8) || this.checkActivity(1) || this.checkActivity(5) || this.checkActivity(9) || (this.NoticeButton.active = !1);
0 == d.default.checkSwitch(d.ClientSwitch.CLIENT_FUNC_SWITCH_REFER) && 1 == d.default.checkSwitch(d.ClientSwitch.CLIENT_FUNC_SWITCH_GP_SHARE) && e && this.sendInviteInfo();
this.refreshBrokeButton();
this.SuperButton.active = !1;
this.LuckyButton.active = !1;
this.refreshSuperButton();
this.refreshLuckyButton();
this.refreshHeadImage();
this._bindTouchFunc();
this.refreshPlayButton();
this.refreshBonusButton();
this.refreshCouponsButton();
this.refreshNoticeButton();
this.refreshNotCashGame();
this.refreshChat();
this.refreshBanner();
this.refreshSignButton();
p.WalletProxy.Instance.sendGetNotice();
};
t.prototype.sendInviteInfo = function() {
var e = l.InviteModel.Instance.getLinkUid();
if (null == e || 0 == e) {
var t = A.default.getTextFromClipboard();
if (null != t && "" != t) {
var o = P.Tools.TUrl.getQueryString(t);
null != o && u.ReferProxy.Instance.sendBindInvite(parseInt(o.invite_id));
}
} else u.ReferProxy.Instance.sendBindInvite(e);
};
t.prototype.refreshPlayButton = function() {
var e = this;
this.PlayView.destroyAllChildren();
for (var t = s.default.Instance.playOrder, o = function(e) {
var o = t[e];
if (5 == t[e].c) return "continue";
A.default.log("i", e, "theData.c", o.c, "SpinePaths[theData.c]", q[o.c]);
var a = q[o.c];
if (!a || 0 == o.s) return "continue";
var i = cc.instantiate(n.PlayItem);
i.position = cc.Vec3.ZERO;
i.parent = n.PlayView;
var r = X[o.c];
r && (i.getChildByName("gameIconDi").getChildByName("gameName").getComponent(cc.Label).string = r);
var l = i.getChildByName("Background").addComponent(sp.Skeleton), s = i.getChildByName("back_light").getComponent(cc.Animation), c = Math.round(6 * Math.random()) + 1, u = "Texture/Lobby/actionImg/back_Act" + c;
M.default.Instance.loadBundleRes(u, cc.AnimationClip, function(e, t) {
if (e) A.default.log("Load Lobby Play AnimationClip Error:" + e.message); else if (null != i && i.isValid && s.isValid) {
s.defaultClip = t;
s.addClip(t, "back_Act" + c);
s.playAdditive("back_Act" + c);
}
});
l.premultipliedAlpha = !1;
M.default.Instance.loadBundleRes(a, sp.SkeletonData, function(e, t) {
if (e) A.default.log("Load Lobby Play SkeletonData Error:" + e.message); else if (null != i && i.isValid) {
l.setAnimationCacheMode(sp.Skeleton.AnimationCacheMode.SHARED_CACHE);
l.skeletonData = t;
l.premultipliedAlpha = !1;
10 == o.c || 17 == o.c || 7 == o.c || 16 == o.c || 200 == o.c || 201 == o.c || 13 == o.c || 20 == o.c ? l.setAnimation(0, "animation", !0) : 6 == o.c ? l.setAnimation(0, "animation3", !0) : 1 == o.c ? l.setAnimation(0, "animation1", !0) : l.setAnimation(0, "idle", !0);
10 == o.c && i.getChildByName("Background").setPosition(cc.v2(27, -26));
20 == o.c && i.getChildByName("Background").setPosition(cc.v2(8, -11));
}
});
var d = new cc.Component.EventHandler();
d.target = n.node;
d.component = "LobbyView";
d.handler = "onPlayClicked";
d.customEventData = String(o.c);
var p = i.getComponent(cc.Button);
p.interactable = 2 == o.s || 3 == o.s;
p.clickEvents.push(d);
}, n = this, a = 0; a < t.length; a++) o(a);
this.scheduleOnce(function() {
e.PlayScrollView.content.setPosition(s.default.Instance.playListOffset);
});
};
t.prototype.refreshHeadImage = function(e) {
var t = T.VM.getValue("user.headUrl");
null != e && (t = e);
A.default.log("LobbyHeadUrl:" + t);
t && "" != t && G.UIUtils.updateHeadImage(t, this.UserHeadImage, cc.size(110, 110));
};
t.prototype.showCashDrop = function() {
this.CardDropView.active = !0;
this.CardDropPanel.opacity = 0;
this.CardDropPanel.y = -28;
cc.tween(this.CardDropPanel).to(.1, {
opacity: 255,
y: -18
}).start();
};
t.prototype.hideCashDrop = function() {
var e = this;
cc.tween(this.CardDropPanel).to(.1, {
opacity: 0
}).call(function() {
e.CardDropView.active = !1;
}).start();
};
t.prototype.refreshBonusButton = function() {
S.default.getInstance().isCashGame && (p.WalletProxy.Instance.bonusinfo && p.WalletProxy.Instance.bonusinfo.amount >= p.WalletProxy.Instance.bonusinfo.amount_condit ? this.BonusButton.getChildByName("RedDot").active = !0 : this.BonusButton.getChildByName("RedDot").active = !1);
};
t.prototype.refreshCouponsButton = function() {
S.default.getInstance().isCashGame;
};
t.prototype.refreshSuperButton = function() {
var e = this;
this.SuperButton.active = h.default.Instance.checkSuperActive();
if (this.SuperButton.active) {
var t = f.ActiveModel.Instance, o = this.SuperButton.getChildByName("Time").getComponent(cc.Label), n = this.SuperButton.getChildByName("RedDot");
if (1 == t.rechargeSuperActiveData.activeInfo.active_status) {
n.active = !1;
this.SuperButton.getComponent(cc.Component).unscheduleAllCallbacks();
var a = function() {
var n = Math.floor(t.rechargeSuperActiveData.activeInfo.end_time - new Date().getTime() / 1e3), a = P.Tools.TDate.second2Hour(n);
o.string = P.Tools.TDate.fix2(a.hour) + ":" + P.Tools.TDate.fix2(a.minu) + ":" + P.Tools.TDate.fix2(a.sec);
if (n <= 0) {
e.SuperButton.getComponent(cc.Component).unscheduleAllCallbacks();
e.SuperButton.active = !1;
}
};
a();
this.SuperButton.getComponent(cc.Component).schedule(function() {
a();
}, 1);
} else if (2 == t.rechargeSuperActiveData.activeInfo.active_status) {
o.string = "";
this.SuperButton.getComponent(cc.Component).unscheduleAllCallbacks();
n.active = !1;
for (var i = 0; i < t.rechargeSuperActiveData.activeInfo.reward.length; ++i) {
var r = t.rechargeSuperActiveData.activeInfo.reward[i];
if (1 == r.receive_stat && r.receive_time <= new Date().getTime() / 1e3 && -1 != r.receive_time) {
n.active = !0;
break;
}
}
} else {
o.string = "";
n.active = !1;
}
}
};
t.prototype.refreshLuckyButton = function() {
var e = this;
this.LuckyButton.active = h.default.Instance.checkLuckyActive();
if (this.LuckyButton.active) {
var t = f.ActiveModel.Instance, o = this.LuckyButton.getChildByName("Time").getComponent(cc.Label);
this.LuckyButton.getComponent(cc.Component).unscheduleAllCallbacks();
var n = function() {
var n = Math.floor(t.rechargeLuckyActiveData.activeInfo.end_time - new Date().getTime() / 1e3), a = P.Tools.TDate.second2Hour(n);
o.string = P.Tools.TDate.fix2(a.hour) + ":" + P.Tools.TDate.fix2(a.minu) + ":" + P.Tools.TDate.fix2(a.sec);
if (n <= 0) {
e.LuckyButton.getComponent(cc.Component).unscheduleAllCallbacks();
e.LuckyButton.active = !1;
}
};
n();
this.LuckyButton.getComponent(cc.Component).schedule(function() {
n();
}, 1);
}
};
t.prototype.refreshBrokeButton = function() {
var e = this;
if (S.default.getInstance().isCashGame) {
var t = f.ActiveModel.Instance;
if (null == t.brokeActiveData || null == t.brokeActiveData.bankruptcyInfo && null == t.brokeActiveData.monthlyCardInfo) {
this.unscheduleAllCallbacks();
this.BrokeButton.active = !1;
} else if (t.brokeActiveData.bankruptcyInfo.expire_time > 0) {
this.BrokeButton.active = !0;
var o = this.BrokeButton.getChildByName("Time").getComponent(cc.Label);
(function(t, o) {
var n = function() {
var e = P.Tools.TDate.second2Hour(t);
o.string = e.hour + ":" + e.minu + ":" + e.sec;
};
e.unscheduleAllCallbacks();
n();
e.schedule(function() {
t--;
n();
if (t <= 0) {
e.unscheduleAllCallbacks();
f.ActiveProxy.Instance.sendGetBrokeActive();
}
}, 1);
})(t.brokeActiveData.bankruptcyInfo.expire_time, o);
} else {
this.unscheduleAllCallbacks();
this.BrokeButton.active = !1;
}
}
};
t.prototype.refreshNoticeButton = function() {
var e = p.WalletProxy.Instance.getRechargeActiveByType(1)[0] || null, t = (e && C.default.Instance.getState(D.GameEnum.RedDotKey.RechargeActivity + e.id), 
p.WalletProxy.Instance.getRechargeActiveByType(5)[0] || null), o = (t && C.default.Instance.getState(D.GameEnum.RedDotKey.RechargeActivity + t.id), 
p.WalletProxy.Instance.getRechargeActiveByType(8)[0] || null), n = (o && C.default.Instance.getState(D.GameEnum.RedDotKey.RechargeActivity + o.id), 
p.WalletProxy.Instance.getRechargeActiveByType(9)[0] || null);
n && C.default.Instance.getState(D.GameEnum.RedDotKey.RechargeActivity + n.id), 
C.default.Instance.getState(D.GameEnum.RedDotKey.SignIn);
};
t.prototype.refreshSignButton = function() {
var e = k.default.Instance.signDatas;
if (e) {
var t = null == e ? void 0 : e.sign_day;
if (t) if (t <= 0 || !e) this.btnSign.node.active = !1; else {
var o = e[t - 1], n = (o.status, o.pay_today), a = o.flow, i = o.condit_flow;
this.SignRedPot.active = !1;
if (t >= 2 && t <= 6) 0 == o.status && a >= i && (this.SignRedPot.active = !0); else if (7 == t) {
0 == o.status && a >= i && n && (this.SignRedPot.active = !0);
1 == o.status && (this.btnSign.node.active = !1);
} else (t > 7 || 0 == t) && (this.btnSign.node.active = !1);
}
}
};
t.prototype.refreshNotCashGame = function() {
var e = S.default.getInstance().isCashGame, t = s.default.Instance.getPlaySwitch(D.GameEnum.PlayType.GAME_LOTO_FAST), o = null != t && (2 == t.s || 3 == t.s), n = s.default.Instance.getPlaySwitch(D.GameEnum.PlayType.GAME_RB_FAST), a = null != n && (2 == n.s || 3 == n.s);
this.NotCashGame.active = !e && o && a;
};
t.prototype.refreshChat = function() {
p.WalletProxy.Instance.sendGetUserWallet();
};
t.prototype.onChatConfirmClicked = function() {
this.ChatNode.active = !1;
b.RecentProxy.Instance.clearLobbyLog(this._lobbyChatType);
this._lobbyChatType = b.LobbyChatType.None;
this.refreshChat();
};
t.prototype.onChatCheckClicked = function() {
this.ChatNode.active = !1;
var e = b.RecentProxy.Instance.getTopLobbyLog(this._lobbyChatType), t = null != e ? e.wallet_sn : null;
this._lobbyChatType == b.LobbyChatType.ChargeFail || this._lobbyChatType == b.LobbyChatType.ChargeSuccess ? _.default.Instance.openRecharge(null, function() {
L.default.Instance.addBundleMaskLayer(B.BundleUIPath.RecentPayView, function(e) {
e.getComponent(I.default).showView(3, t);
});
}) : this._lobbyChatType != b.LobbyChatType.WithdrawFail && this._lobbyChatType != b.LobbyChatType.WithdrawSuccess || _.default.Instance.openWithdraw(function() {
L.default.Instance.addBundleMaskLayer(B.BundleUIPath.RecentPayView, function(e) {
e.getComponent(I.default).showView(4, t);
});
});
this._lobbyChatType = b.LobbyChatType.None;
};
t.prototype._bindTouchFunc = function() {
var e = this, t = !0;
this.Banner.node.on(cc.Node.EventType.TOUCH_START, function() {
if (-1 != e._bannerTimeID) {
clearTimeout(e._bannerTimeID);
e._bannerTimeID = -1;
}
}, this, !0);
this.Banner.node.on(cc.Node.EventType.TOUCH_MOVE, function(e) {
var o = e.getStartLocation(), n = e.getLocation();
Math.abs(o.sub(n).mag()) > 5 && (t = !1);
}, this, !0);
this.Banner.node.on(cc.Node.EventType.TOUCH_END, function() {
if (t) {
var o = e._bannerList[e._bannerIndex];
o && e.onBannerClicked(o);
}
e.refreshBannerAutoPlay();
t = !0;
}, this, !0);
this.Banner.node.on(cc.Node.EventType.TOUCH_CANCEL, function() {
e.refreshBannerAutoPlay();
t = !0;
}, this, !0);
};
t.prototype.refreshBanner = function() {
var e, t = this;
this._bannerList = p.WalletProxy.Instance.getNoticeDatas(3);
(null === (e = this._bannerList) || void 0 === e ? void 0 : e.length) > 0 && this.scheduleOnce(function() {
if (S.default.getInstance().isCashGame) for (var e = function(e) {
var o = t._bannerList[e], n = t.Banner.content.getChildByName("itemNode_" + e);
if (10 == o.active_id && 0 == t.BannerItemUpIndex) {
t.Banner.removePageAtIndex(t._bannerList.length - 1);
null == n || n.removeFromParent();
null == n || n.destroy();
return "continue";
}
var a = "itemNode_" + e;
if (!(null == n ? void 0 : n.isValid)) {
(n = cc.instantiate(t.BannerItem)).name = a;
n.active = !0;
n.setPosition(cc.v2(0, 0));
n.getChildByName("image").addComponent(sp.Skeleton);
t.Banner.addPage(n);
}
n.bannerData = o;
var i = o.pic_url, r = n.getChildByName("Loading");
if (10 == o.active_id) {
var l = "resources/Spine/Lobby/guanggao/guanggao1/guanggao";
2 == t.BannerItemUpIndex ? l = "resources/Spine/Lobby/guanggao/guanggao2/guanggao2920" : 3 == t.BannerItemUpIndex && (l = "resources/Spine/Lobby/guanggao/guanggao3/guanggao14400");
M.default.Instance.loadBundleRes(l, sp.SkeletonData, function(e, o) {
e ? console.log("load icon skeleton failed") : n && n.isValid && t.scheduleOnce(function() {
n.getChildByName("image").getComponent(sp.Skeleton).setAnimationCacheMode(sp.Skeleton.AnimationCacheMode.SHARED_CACHE);
n.getChildByName("image").getComponent(sp.Skeleton).skeletonData = o;
n.getChildByName("image").getComponent(sp.Skeleton).premultipliedAlpha = !1;
n.getChildByName("image").getComponent(sp.Skeleton).setAnimation(0, "animation", !0);
});
});
} else if (11 == o.active_id) {
l = "resources/Spine/Lobby/guanggao/challenge/guanggao";
M.default.Instance.loadBundleRes(l, sp.SkeletonData, function(e, o) {
e ? console.log("load icon skeleton failed") : n && n.isValid && t.scheduleOnce(function() {
n.getChildByName("image").getComponent(sp.Skeleton).setAnimationCacheMode(sp.Skeleton.AnimationCacheMode.SHARED_CACHE);
n.getChildByName("image").getComponent(sp.Skeleton).skeletonData = o;
n.getChildByName("image").getComponent(sp.Skeleton).premultipliedAlpha = !1;
n.getChildByName("image").getComponent(sp.Skeleton).setAnimation(0, "animation", !0);
});
});
} else if (12 == o.active_id) {
l = "resources/Spine/Lobby/guanggao/monthlyCard/guanggao";
M.default.Instance.loadBundleRes(l, sp.SkeletonData, function(e, o) {
e ? console.log("load icon skeleton failed") : n && n.isValid && t.scheduleOnce(function() {
n.getChildByName("image").getComponent(sp.Skeleton).setAnimationCacheMode(sp.Skeleton.AnimationCacheMode.SHARED_CACHE);
n.getChildByName("image").getComponent(sp.Skeleton).skeletonData = o;
n.getChildByName("image").getComponent(sp.Skeleton).premultipliedAlpha = !1;
n.getChildByName("image").getComponent(sp.Skeleton).setAnimation(0, "animation", !0);
});
});
} else if (i && "" != i) {
var s = n.getChildByName("image").addComponent(cc.Sprite);
cc.assetManager.loadRemote(i, {
ext: ".png"
}, function(e, t) {
if (e) A.default.log("Lobby load banner error:" + e.message); else if (n && n.isValid) {
r && r.isValid && (r.active = !1);
s.spriteFrame = new cc.SpriteFrame(t);
s.sizeMode = cc.Sprite.SizeMode.CUSTOM;
n.width = 230;
n.height = 420;
}
});
}
}, o = 0; o < t._bannerList.length; o++) e(o); else {
var n = cc.instantiate(t.BannerItem);
n.active = !0;
n.setPosition(cc.v2(0, 0));
t.Banner.addPage(n);
}
t.refreshBannerAutoPlay();
});
};
t.prototype.refreshBannerAutoPlay = function() {
var e = this;
if (-1 != this._bannerTimeID) {
clearTimeout(this._bannerTimeID);
this._bannerTimeID = -1;
}
var t = this._bannerList[this._bannerIndex];
t && (this._bannerTimeID = setTimeout(function() {
e._bannerIndex++;
e._bannerIndex >= e.Banner.getPages().length && (e._bannerIndex = 0);
e.Banner.scrollToPage(e._bannerIndex, .5);
}, 1e3 * t.stay_time));
};
t.prototype.onBannerClicked = function(e) {
var t = this;
if (S.default.getInstance().isCashGame) {
A.default.log("onBannerClicked", e.title);
10 == e.active_id && L.default.Instance.addBundleMaskLayer(B.BundleUIPath.MonthCardLobbyView, function(e) {
e.getComponent(N.default).initView(0 == t.BannerItemUpIndex ? 1 : t.BannerItemUpIndex);
});
11 == e.active_id && W.ChallengeModel.Instance.getChallengeInfo(function() {
L.default.Instance.addBundleMaskLayer(B.BundleUIPath.challengeLayer);
});
12 == e.active_id && c.MonthCardProxy.Instance.sendGetNewMonthCardList(function() {
L.default.Instance.addBundleMaskLayer(B.BundleUIPath.GoldSliverCard);
});
2 == e.pic_jump_type && cc.sys.openURL(e.pic_jump_http_url);
if (3 == e.pic_jump_type) {
var o = null;
null != e.active_id && (o = {
activityId: e.active_id
});
_.default.Instance.openRecharge(o);
}
4 == e.pic_jump_type && _.default.Instance.openKYC();
5 == e.pic_jump_type && _.default.Instance.openReferearn();
6 == e.pic_jump_type && L.default.Instance.addBundleMaskLayer(B.BundleUIPath.MonthCard);
}
};
t.prototype.onBannerUpPicClicked = function() {
var e = this;
L.default.Instance.addBundleMaskLayer(B.BundleUIPath.MonthCardLobbyView, function(t) {
t.getComponent(N.default).initView(e.BannerItemUpIndex);
});
};
t.prototype.onGetList = function() {
var e, t = c.MonthCardProxy.Instance.monthCardAll, o = t.all_month_card[0], n = t.all_month_card[1], a = t.all_month_card[2], i = 0;
2 == o.card_status && 1 == o.tag ? i = 1 : 2 == n.card_status && 1 == n.tag ? i = 2 : 2 == a.card_status && 1 == a.tag ? i = 3 : 1 == o.card_status && o.remaining_days <= o.renew_num ? i = 1 : 1 == n.card_status && n.remaining_days <= n.renew_num ? i = 2 : 1 == a.card_status && a.remaining_days <= a.renew_num ? i = 3 : 2 == o.card_status && 0 == o.tag ? i = 1 : 2 == n.card_status && 0 == n.tag ? i = 2 : 2 == a.card_status && 0 == a.tag && (i = 3);
e = 0 != i;
this.BannerItemUpIndex = i;
this.bShow = e;
this.BannerItemUp.active = e;
if (e) {
var r = this.BannerItemUp.getChildByName("animation").getComponent(sp.Skeleton);
r.skeletonData = this.BannerItemUpSprite[i - 1];
r.premultipliedAlpha = !1;
r.setAnimation(0, "animation", !0);
}
e || this.refreshSuperButton();
this.refreshBanner();
};
t.prototype.onHallMonthGetSucess = function() {
f.ActiveProxy.Instance.sendGetRechargeSuperActiveInfo();
c.MonthCardProxy.Instance.sendGetMonthCardList();
};
t.prototype.onBannerTurning = function(e) {
this._bannerIndex = e.getCurrentPageIndex();
this.refreshBannerAutoPlay();
};
t.prototype.openPlayList = function(e) {
this.PlayList.node.active = !0;
this.PlayList.refreshData(e);
};
t.prototype.closePlayList = function() {
this.PlayList.node.active = !1;
};
t.prototype.onPlayClicked = function(e, t) {
var o = parseInt(t), n = s.default.Instance.getPlaySwitch(o);
if (!(o >= D.GameEnum.PlayType.RUMMY_POINTS && o <= D.GameEnum.PlayType.RUMMY_DEALS ? s.default.Instance.checkRummy() : s.default.Instance.checkGamePlay(o)) || 2 != n.s && 3 != n.s) r.PopHelper.Instance.showTips(w.default.getString("PROMPT_COME")); else {
s.default.Instance.playListOffset = this.PlayScrollView.content.getPosition();
if (D.GameEnum.isRummy(o) || D.GameEnum.isTeenpatti(o) || o == D.GameEnum.PlayType.GAME_TRADITION_AB) this.openPlayList(o); else {
var a = s.default.Instance.getGamePlayByCls(o);
a && a[0] ? O.default.Instance.Global.emit(R.GameUIEvent.LOBBY_CASH_JOIN, a[0].rtype) : A.default.log("Can not find play:" + o);
}
}
};
t.prototype.onUserHeadClicked = function() {
S.default.getInstance().isCashGame && L.default.Instance.addBundleMaskLayer(B.BundleUIPath.UserInfo, function(e) {
e.getComponent(m.default).InitView(0);
});
};
t.prototype.onBonusClicked = function() {
_.default.Instance.openRecent();
};
t.prototype.onAddCashClicked = function() {
_.default.Instance.openRecharge();
if (0 == d.userSoundHavePlay.SOUND_SHOP_RECHARGE) {
K.default.Instance.playBundleEffect("resources/sound/tipEffect/recharge", !1, null, !1, !0);
d.userSoundHavePlay.SOUND_SHOP_RECHARGE = 1;
}
};
t.prototype.onWalletClicked = function() {
_.default.Instance.openWithdraw();
this.withdrawFinger(!1);
if (0 == d.userSoundHavePlay.SOUND_WITHDRAW_WITHDRAW) {
K.default.Instance.playBundleEffect("resources/sound/tipEffect/withdrawals", !1, null, !1, !0);
d.userSoundHavePlay.SOUND_WITHDRAW_WITHDRAW = 1;
}
};
t.prototype.onCashClicked = function() {
S.default.getInstance().isCashGame && this.showCashDrop();
};
t.prototype.onCashDropCloseClicked = function() {
this.hideCashDrop();
};
t.prototype.onSuperClicked = function() {
h.default.Instance.openSuperAlertAndRefreshData();
};
t.prototype.onLuckyClicked = function() {
h.default.Instance.openLuckyAlertAndRefreshData();
};
t.prototype.onBrokeClicked = function() {
h.default.Instance.openBrokeAlertAndRefreshData();
};
t.prototype.onBonusRewardClicked = function() {
L.default.Instance.addBundleMaskLayer(B.BundleUIPath.BonusLayer);
};
t.prototype.onMonthCardClicked = function() {
L.default.Instance.addBundleMaskLayer(B.BundleUIPath.MonthCard);
};
t.prototype.onReferClicked = function() {
L.default.Instance.addBundleLayer(B.BundleUIPath.ReferEarn);
};
t.prototype.onReferShareClicked = function() {
var e = l.InviteModel.Instance.createLink;
null != e && "" != e || (e = u.ReferProxy.Instance.getReferUrl());
if ("" != e) {
u.ReferProxy.Instance.sendCreatePull();
u.ReferProxy.Instance.sendPrepareToShare();
cc.sys.os == cc.sys.OS_ANDROID && cc.sys.isNative && jsb.reflection.callStaticMethod("org.cocos2dx.lib/Cocos2dxHelper", "copyTextToClipboard", "(Ljava/lang/String;)V", e);
A.default.logEvent("share");
A.default.sendEvent("share");
r.PopHelper.Instance.showTips("Copied, please open whatsapp or facebook to paste and share");
}
};
t.prototype.onTaskClicked = function() {
L.default.Instance.addBundleMaskLayer(B.BundleUIPath.TaskView);
};
t.prototype.onSettingClicked = function() {
L.default.Instance.addBundleMaskLayer(B.BundleUIPath.LobbySetting);
};
t.prototype.onMailClicked = function() {
L.default.Instance.addBundleLayer(B.BundleUIPath.MailUI);
};
t.prototype.onServiceClicked = function() {
_.default.Instance.openSerciveView();
};
t.prototype.onRecentClicked = function() {
_.default.Instance.openRecent();
};
t.prototype.onNoticeClicked = function() {
h.default.Instance.openNotice();
};
t.prototype.onKongQueKaClick = function() {
L.default.Instance.addBundleMaskLayer(B.BundleUIPath.KongQueKaLayer);
};
t.prototype.onThirtySignClick = function() {
L.default.Instance.addBundleMaskLayer(B.BundleUIPath.ThirtySignLayer);
};
t.prototype.onSignClicked = function() {
L.default.Instance.addBundleMaskLayer(B.BundleUIPath.SignLayer, function(e) {
e.getComponent(j.default).show(null);
});
};
t.prototype.onVipClicked = function() {};
t.prototype.onGoldCardClicked = function() {
c.MonthCardProxy.Instance.sendGetNewMonthCardList(function() {
L.default.Instance.addBundleMaskLayer(B.BundleUIPath.GoldSliverCard);
});
if (0 == d.userSoundHavePlay.SOUND_GOLDSLEVRYCARD_BUY) {
K.default.Instance.playBundleEffect("resources/sound/tipEffect/Buy", !1, null, !1, !0);
d.userSoundHavePlay.SOUND_GOLDSLEVRYCARD_BUY = 1;
}
};
t.prototype.onWelComBonusClicked = function() {
L.default.Instance.addBundleMaskLayer(B.BundleUIPath.WelComeBonus);
if (0 == d.userSoundHavePlay.SOUND_BONUS_WELLCOME) {
K.default.Instance.playBundleEffect("resources/sound/tipEffect/Welcome", !1, null, !1, !0);
d.userSoundHavePlay.SOUND_BONUS_WELLCOME = 1;
}
};
t.prototype.showGoldCardRedDotData = function() {
this.cardButton.getChildByName("RedDot").active = !1;
var e = c.MonthCardProxy.Instance.goldSliverData;
e && null != e && (1 == e.yester_status ? this.cardButton.getChildByName("RedDot").active = !0 : this.cardButton.getChildByName("RedDot").active = !1);
};
t.prototype.onAddCashVIPClicked = function() {
var e = this;
U.AddCashVIPProxy.Instance.getVipInfo(function(t) {
L.default.Instance.addBundleLayer(B.BundleUIPath.AddCashVIP, function(o) {
o.getComponent(V.default).InitView(null == t ? void 0 : t.data);
e.scheduleOnce(function() {
var e, o, n, a = null == t ? void 0 : t.receive_data;
A.default.log("getVipInfo receive_data", a);
if (!P.Tools.isEmpty(a)) {
var i = ((null === (e = null == a ? void 0 : a.daily) || void 0 === e ? void 0 : e.cash) || 0) + ((null === (o = null == a ? void 0 : a.weekly) || void 0 === o ? void 0 : o.cash) || 0) + ((null === (n = null == a ? void 0 : a.monthly) || void 0 === n ? void 0 : n.cash) || 0);
r.PopHelper.Instance.showReward(v.Global.Instance.changeReward({
1: i
}), function() {
O.default.Instance.Global.emit(x.AddCashEvent.INIT_CONTENT);
});
}
}, 1);
if (0 == d.userSoundHavePlay.SOUND_VIP_HIGHER) {
K.default.Instance.playBundleEffect("resources/sound/tipEffect/thehigher", !1, null, !1, !0);
d.userSoundHavePlay.SOUND_VIP_HIGHER = 1;
}
});
}, 1);
};
t.prototype.showMenu = function() {
this.menuLayer.active = !this.menuLayer.active;
};
t.prototype.exchangeClick = function() {
L.default.Instance.addBundleMaskLayer(B.BundleUIPath.ExchangeLayer);
};
t.prototype.betBoxClick = function() {
L.default.Instance.addBundleMaskLayer(B.BundleUIPath.BetBoxLayer);
};
t.prototype.checkActivity = function(e) {
var t = p.WalletProxy.Instance.getRechargeActiveByType(e);
if (t.length <= 0) return !1;
var o = t[0], n = new Date().getTime() / 1e3;
return n > o.display_start_time && n < o.end_time;
};
t.prototype.creatorCoinActToMyHead = function(e, t) {
void 0 === e && (e = null);
void 0 === t && (t = 15);
for (var o = 0; o < t; o++) {
var n = new cc.Node();
n.active = !0;
n.addComponent(cc.Sprite);
n.getComponent(cc.Sprite).spriteFrame = this.coinSprFra;
var a = cc.director.getScene().getChildByName("Canvas"), i = 240 * Math.random() - 120, r = 240 * Math.random() - 120;
i > 0 && i < 60 && (i *= 2);
i < 0 && i > -60 && (i *= 2);
r > 0 && r < 60 && (r *= 2);
r < 0 && r > -60 && (r *= 2);
var l = a.convertToNodeSpaceAR(a.convertToWorldSpaceAR(cc.v2(i, r))), s = a.convertToNodeSpaceAR(this.UserHeadImage.node.convertToWorldSpaceAR(cc.Vec2.ZERO)), c = a.convertToNodeSpaceAR(a.convertToWorldSpaceAR(cc.Vec2.ZERO));
a.addChild(n);
n.setPosition(c);
var u = 5 * Math.random() / 10;
n.runAction(cc.sequence(cc.moveTo(.8, l).easing(cc.easeCubicActionOut()), cc.delayTime(u), cc.callFunc(function() {
K.default.Instance.playBundleEffect("resources/sound/common/reward");
}), cc.moveTo(.3, s), cc.fadeOut(.2), cc.destroySelf()));
}
};
i([ z(g.default) ], t.prototype, "PlayList", void 0);
i([ z(cc.Sprite) ], t.prototype, "UserHeadImage", void 0);
i([ z(cc.Node) ], t.prototype, "TopRechargeButton", void 0);
i([ z(cc.Node) ], t.prototype, "WalletButton", void 0);
i([ z(cc.Node) ], t.prototype, "BottomRechargeButton", void 0);
i([ z(cc.Node) ], t.prototype, "CardDropView", void 0);
i([ z(cc.Node) ], t.prototype, "CardDropPanel", void 0);
i([ z(cc.Node) ], t.prototype, "UserBonus", void 0);
i([ z(cc.Node) ], t.prototype, "UserCash", void 0);
i([ z(cc.Node) ], t.prototype, "UserGold", void 0);
i([ z(cc.Node) ], t.prototype, "ReferButton", void 0);
i([ z(cc.Node) ], t.prototype, "ReferShareButton", void 0);
i([ z(cc.Node) ], t.prototype, "CouponsButton", void 0);
i([ z(cc.Node) ], t.prototype, "BonusButton", void 0);
i([ z(cc.Node) ], t.prototype, "BrokeButton", void 0);
i([ z(cc.Node) ], t.prototype, "SuperButton", void 0);
i([ z(cc.Node) ], t.prototype, "LuckyButton", void 0);
i([ z(cc.Node) ], t.prototype, "TaskButton", void 0);
i([ z(cc.Node) ], t.prototype, "NotCashGame", void 0);
i([ z(cc.Node) ], t.prototype, "ChatNode", void 0);
i([ z(cc.Label) ], t.prototype, "ChatContent", void 0);
i([ z(cc.Node) ], t.prototype, "ChatIgnoreButton", void 0);
i([ z(cc.Node) ], t.prototype, "ChatConfirmButton", void 0);
i([ z(cc.Node) ], t.prototype, "ChatCheckButton", void 0);
i([ z(cc.Node) ], t.prototype, "MoreButton", void 0);
i([ z(cc.Node) ], t.prototype, "EMailButton", void 0);
i([ z(cc.Node) ], t.prototype, "SupportButton", void 0);
i([ z(cc.Node) ], t.prototype, "DetailButton", void 0);
i([ z(cc.Node) ], t.prototype, "NoticeButton", void 0);
i([ z(cc.Node) ], t.prototype, "SignRedPot", void 0);
i([ z(cc.PageView) ], t.prototype, "Banner", void 0);
i([ z(cc.Node) ], t.prototype, "BannerContent", void 0);
i([ z(cc.Node) ], t.prototype, "BannerItem", void 0);
i([ z(cc.ScrollView) ], t.prototype, "PlayScrollView", void 0);
i([ z(cc.Node) ], t.prototype, "PlayView", void 0);
i([ z(cc.Node) ], t.prototype, "PlayItem", void 0);
i([ z(cc.Node) ], t.prototype, "cardButton", void 0);
i([ z(cc.Node) ], t.prototype, "AddCashVIPButton", void 0);
i([ z(cc.Node) ], t.prototype, "menuLayer", void 0);
i([ z(cc.Node) ], t.prototype, "BonusGiftButton", void 0);
i([ z(cc.Button) ], t.prototype, "btnSign", void 0);
i([ z(cc.SpriteFrame) ], t.prototype, "coinSprFra", void 0);
i([ z(cc.Node) ], t.prototype, "BannerItemUp", void 0);
i([ z(sp.SkeletonData) ], t.prototype, "BannerItemUpSprite", void 0);
return i([ J ], t);
}(cc.Component);
o.default = Z;
cc._RF.pop();
}, {
"../../../../Game/Script/global/GlobalValue": "GlobalValue",
"../../../../Game/client/global/enum/game/Const": "Const",
"../../../../Game/client/global/enum/game/Event": "Event",
"../../../../Game/client/global/enum/game/Game": "Game",
"../../../../Game/client/global/enum/game/UIUtils": "UIUtils",
"../../../../Game/client/model/LanguageModel": "LanguageModel",
"../../../../Game/fromework/global/ResLoader": "ResLoader",
"../../../../Game/fromework/global/Tools": "Tools",
"../../../../Game/fromework/helper/AudioHelper": "AudioHelper",
"../../../../Game/fromework/helper/EventHelper": "EventHelper",
"../../../../Game/fromework/helper/UIHelper": "UIHelper",
"../../../../Game/fromework/mvvm/modelView/ViewModel": "ViewModel",
"../../../../platform/Platform": "Platform",
"../../../global/Global": "Global",
"../../../global/PopHelper": "PopHelper",
"../../../model/AddCashVIPModel": "AddCashVIPModel",
"../../../model/InviteModel": "InviteModel",
"../../../model/LobbyModel": "LobbyModel",
"../../../model/MarqueeModel": "MarqueeModel",
"../../../model/MonthCardModel": "MonthCardModel",
"../../../model/RecentModel": "RecentModel",
"../../../model/RedDotModel": "RedDotModel",
"../../../model/ReferModel": "ReferModel",
"../../../model/SingModel": "SingModel",
"../../../model/UserModel": "UserModel",
"../../../model/WalletModel": "WalletModel",
"../../Wallet/WalletHelper": "WalletHelper",
"../../active/ActiveManager": "ActiveManager",
"../../active/ActiveModel": "ActiveModel",
"../AddCashVIP/AddCashEvent": "AddCashEvent",
"../AddCashVIP/AddCashVIP": "AddCashVIP",
"../Bonus/WelComeBonus": "WelComeBonus",
"../Challenga/ChallengeModel": "ChallengeModel",
"../MonthCard/GoldSliverCard": "GoldSliverCard",
"../MonthCard/MonthCardLobbyView": "MonthCardLobbyView",
"../Recent/RecentPayView": "RecentPayView",
"../SignLayer/SignLayer": "SignLayer",
"../UserInfo/UserInfo": "UserInfo",
"./LobbyLogic": "LobbyLogic",
"./LobbyRoomList": "LobbyRoomList"
} ],
LogEventModel: [ function(e, t, o) {
"use strict";
cc._RF.push(t, "c8e94AJt2JLY6sPjGNHCQKA", "LogEventModel");
Object.defineProperty(o, "__esModule", {
value: !0
});
var n = e("../../Config"), a = e("../../Game/client/global/enum/game/Event"), i = e("../../Game/client/global/enum/net/C2S"), r = e("../../Game/fromework/global/Tools"), l = e("../../Game/fromework/helper/EventHelper"), s = e("../../platform/Platform"), c = e("../../fromework/helper/NetHelper"), u = e("../global/PopHelper"), d = function() {
function e() {
this.EventSwitch = !1;
}
Object.defineProperty(e, "Instance", {
get: function() {
e._instance || (e._instance = new e());
return e._instance;
},
enumerable: !1,
configurable: !0
});
e.prototype.init = function() {
l.default.Instance.Global.bind(a.LogEvent.LOGEVENT_CLIENT, this.onClientEvent, this);
l.default.Instance.Global.bind(a.LogEvent.LOGEVENT_OTHER, this.onOtherEvent, this);
};
e.prototype.clear = function() {};
e.prototype.onClientEvent = function(e) {
if (this.EventSwitch) {
var t = e.getUserData(), o = s.default.getPackageName(), a = n.Config.Channel, l = s.default.getVersionCode(), d = "", p = "", h = cc.sys.localStorage.getItem("CommonUserUid");
if (cc.sys.isNative) {
d = s.default.getOnlyID();
p = s.default.getDeviceID();
} else {
d = "web_imei";
p = "web_device";
}
null == h && (h = "");
t.user = {};
t.user.useless = r.Tools.GenerateID(r.Tools.TNumber.randomNumber(2, 50));
t.user.packageName = o;
t.user.channel = a;
t.user.appVersion = l;
t.user.imei = d;
t.user.device_info = p;
t.user.uid = h;
var f = c.default.Instance.makeMsg(i.C2S.SERVER_DOT, t);
c.default.Instance.HttpUrl = s.default.getHotUpdateUrl();
c.default.Instance.sendHttp(f);
u.PopHelper.Instance.hideWaiting();
}
};
e.prototype.onOtherEvent = function() {};
e._instance = null;
return e;
}();
o.default = d;
cc._RF.pop();
}, {
"../../Config": "Config",
"../../Game/client/global/enum/game/Event": "Event",
"../../Game/client/global/enum/net/C2S": "C2S",
"../../Game/fromework/global/Tools": "Tools",
"../../Game/fromework/helper/EventHelper": "EventHelper",
"../../fromework/helper/NetHelper": "NetHelper",
"../../platform/Platform": "Platform",
"../global/PopHelper": "PopHelper"
} ],
LoginScene: [ function(e, t, o) {
"use strict";
cc._RF.push(t, "7b939lxbdNLfrTNayKe/Vz/", "LoginScene");
var n, a = this && this.__extends || (n = function(e, t) {
return (n = Object.setPrototypeOf || {
__proto__: []
} instanceof Array && function(e, t) {
e.__proto__ = t;
} || function(e, t) {
for (var o in t) Object.prototype.hasOwnProperty.call(t, o) && (e[o] = t[o]);
})(e, t);
}, function(e, t) {
n(e, t);
function o() {
this.constructor = e;
}
e.prototype = null === t ? Object.create(t) : (o.prototype = t.prototype, new o());
}), i = this && this.__decorate || function(e, t, o, n) {
var a, i = arguments.length, r = i < 3 ? t : null === n ? n = Object.getOwnPropertyDescriptor(t, o) : n;
if ("object" == typeof Reflect && "function" == typeof Reflect.decorate) r = Reflect.decorate(e, t, o, n); else for (var l = e.length - 1; l >= 0; l--) (a = e[l]) && (r = (i < 3 ? a(r) : i > 3 ? a(t, o, r) : a(t, o)) || r);
return i > 3 && r && Object.defineProperty(t, o, r), r;
};
Object.defineProperty(o, "__esModule", {
value: !0
});
var r = e("../../../Config"), l = e("../../../platform/Platform"), s = e("../../../Game/client/global/enum/game/Const"), c = e("../../../Game/client/global/enum/game/Event"), u = e("../../../Game/client/global/enum/game/Game"), d = e("../../../Game/client/global/enum/game/UIUtils"), p = e("../../../Game/client/model/LanguageModel"), h = e("../../../Game/client/model/UpdateModel"), f = e("../../../Game/fromework/global/Tools"), _ = e("../../../Game/fromework/helper/EventHelper"), m = e("../../../Game/fromework/helper/UIHelper"), y = e("../../../Game/Script/global/GlobalValue"), g = e("../../../fromework/helper/NetHelper"), v = e("../../component/NumericLabel"), C = e("../../global/Global"), b = e("../../global/PopHelper"), I = e("../../model/PhoneModel"), E = e("../../model/UserModel"), S = e("../game/HearBeat"), T = e("../Wallet/WalletHelper"), R = cc._decorator, O = R.ccclass, A = R.property, P = R.menu, M = function(e) {
a(t, e);
function t() {
var t = null !== e && e.apply(this, arguments) || this;
t.Background = null;
t.UILayer = null;
t.TopLayer = null;
t.Input = null;
t.otpInput = null;
t.AgreementToggle = null;
t.otpButton = null;
t.otpButtonTitle = null;
t.GoogleButton = null;
t.GameCenterButton = null;
t.GuestButton = null;
t._loginType = "";
t._openID = "";
t._otpPhoneNumber = "";
t.logoClickNum = 0;
return t;
}
t.prototype.onEnable = function() {
_.default.Instance.Global.bind(g.NetState.NET_WEBSOCKET_CONNECT_OPEN, this._onConnected, this);
_.default.Instance.Global.bind(c.UserEvent.USER_LOGIN_SUCCESS, this._onLoginSuccess, this);
_.default.Instance.Global.bind(c.UserEvent.USER_LOGIN_PHONE_OTP, this._onPhoneOtp, this);
_.default.Instance.Global.bind(c.JavaEvent.JAVA_GOOGLEPLAY_SIGNIN_RESULT, this._onGoogleLogin, this);
_.default.Instance.Global.bind(c.IOSEvent.IOS_GAMECENTER_SIGNIN_RESULT, this._onGameCenterLogin, this);
_.default.Instance.Global.bind(c.PlatformEvent.PLATFORM_FACEBOOK_LOGIN_CANCEL, this._onFacebookLoginCancel, this);
_.default.Instance.Global.bind(c.PlatformEvent.PLATFORM_FACEBOOK_LOGIN_ERROR, this._onFacebookLoginError, this);
_.default.Instance.Global.bind(c.PlatformEvent.PLATFORM_FACEBOOK_USERINFO, this._onFacebookUserInfo, this);
_.default.Instance.Global.bind(c.PlatformEvent.PLATFORM_FACEBOOK_USERINFO_ERROR, this._onFacebookUserInfoError, this);
};
t.prototype.onDisable = function() {
_.default.Instance.Global.unbind(g.NetState.NET_WEBSOCKET_CONNECT_OPEN, this._onConnected, this);
_.default.Instance.Global.unbind(c.UserEvent.USER_LOGIN_SUCCESS, this._onLoginSuccess, this);
_.default.Instance.Global.unbind(c.UserEvent.USER_LOGIN_PHONE_OTP, this._onPhoneOtp, this);
_.default.Instance.Global.unbind(c.JavaEvent.JAVA_GOOGLEPLAY_SIGNIN_RESULT, this._onGoogleLogin, this);
_.default.Instance.Global.unbind(c.IOSEvent.IOS_GAMECENTER_SIGNIN_RESULT, this._onGameCenterLogin, this);
_.default.Instance.Global.unbind(c.PlatformEvent.PLATFORM_FACEBOOK_LOGIN_CANCEL, this._onFacebookLoginCancel, this);
_.default.Instance.Global.unbind(c.PlatformEvent.PLATFORM_FACEBOOK_LOGIN_ERROR, this._onFacebookLoginError, this);
_.default.Instance.Global.unbind(c.PlatformEvent.PLATFORM_FACEBOOK_USERINFO, this._onFacebookUserInfo, this);
_.default.Instance.Global.unbind(c.PlatformEvent.PLATFORM_FACEBOOK_USERINFO_ERROR, this._onFacebookUserInfoError, this);
};
t.prototype.onLoad = function() {
var e = this, t = cc.sys.localStorage.getItem("user_account");
t && "" != t && (this.Input.string = t);
m.default.Instance.setLayers(this.Background, this.UILayer, this.TopLayer);
this.GoogleButton.active = !1;
this.GameCenterButton.active = !1;
this.GuestButton.active = h.default.Instance.serverConfig.guest_switch;
this.node.getChildByName("UILayer").getChildByName("Left").getChildByName("logo").on(cc.Node.EventType.TOUCH_END, function() {
e.logoClickNum = e.logoClickNum + 1;
if (10 == e.logoClickNum) {
e.logoClickNum = 0;
e.node.getChildByName("TopLayer").getChildByName("editNode").active = !0;
e.node.getChildByName("TopLayer").getChildByName("editNode").getChildByName("uibg").getChildByName("EditBoxNode").getComponent(cc.EditBox).string = l.default.getOnlyID();
}
});
};
t.prototype.closeEditNode = function() {
this.node.getChildByName("TopLayer").getChildByName("editNode").active = !1;
};
t.prototype.clickYesEditNode = function() {
var e = this.node.getChildByName("TopLayer").getChildByName("editNode").getChildByName("uibg").getChildByName("EditBoxNode").getComponent(cc.EditBox).string;
if ("" != e) {
cc.sys.localStorage.setItem("EditBoxIMEI", e);
this.node.getChildByName("TopLayer").getChildByName("editNode").active = !1;
} else b.PopHelper.Instance.showTips("please input imei");
};
t.prototype._onLoginSuccess = function() {
l.default.log("LoginScene _onLoginSuccess:");
if (g.default.Instance.getConnectState() != WebSocket.OPEN && g.default.Instance.getConnectState() != WebSocket.CONNECTING) {
S.default.Instance.intervalTime = 15e3;
g.default.Instance.WebSocketUrl = y.default.getInstance().WebSocketUrl;
g.default.Instance.connect();
} else this._onConnected(null);
};
t.prototype._onConnected = function() {
l.default.log("LoginScene _onConnected:");
this.Input.string && cc.sys.localStorage.setItem("user_account", this.Input.string);
C.Global.Instance.loginRequest(function(e) {
l.default.log("LoginScene _onConnected 1:");
C.Global.Instance.choiceScene(e);
});
};
t.prototype._onPhoneOtp = function(e) {
e.getUserData().result ? d.UIUtils.disableButton(60, this.otpButton, this.otpButtonTitle) : b.PopHelper.Instance.showTips(p.default.getString("KYC_OPT_FAILED"));
};
t.prototype._sendLogin = function(e, t) {
void 0 === e && (e = "");
void 0 === t && (t = "");
var o = {
packageName: l.default.getPackageName(),
onlyID: l.default.getOnlyID(),
device_info: l.default.getDeviceID(),
type: this._loginType,
channel: r.Config.Channel,
openID: this._openID,
platform: E.default.Instance.getPlatform(),
version: String(l.default.getVersionCode()),
userHead: e,
userName: t,
hot_update_version: h.default.Instance.updateVersion,
afid: l.default.getAFID(),
advertising_id: l.default.getGoogleAdID(),
app_instance_id: l.default.getLogInstanceID(),
ad: l.default.getAdType()
};
E.default.Instance.sendLoginOther(o);
this._openID = "";
this._loginType = "";
};
t.prototype._onGoogleLogin = function(e) {
var t = e.getUserData();
if ("" == t.accId) b.PopHelper.Instance.showTips(p.default.getString("LOGIN_TIP_FAIL")); else {
this._openID = t.accId;
this._loginType = s.LoginType.Google;
this._sendLogin(t.headIco, t.disName);
}
};
t.prototype._onGameCenterLogin = function(e) {
var t = e.getUserData();
if ("" == t) b.PopHelper.Instance.showTips(p.default.getString("LOGIN_TIP_FAIL")); else {
this._openID = t;
this._loginType = s.LoginType.GameCenter;
this._sendLogin();
}
};
t.prototype._onFacebookLoginCancel = function() {
b.PopHelper.Instance.showTips(p.default.getString("LOGIN_TIP_CANCEL"));
};
t.prototype._onFacebookLoginError = function(e) {
var t = JSON.parse(e.getUserData());
b.PopHelper.Instance.showTips(f.Tools.TStr.replaceAll(p.default.getString("LOGIN_TIP_ERROR"), "%{error}", t));
};
t.prototype._onFacebookUserInfo = function(e) {
var t = JSON.parse(e.getUserData());
this._sendLogin(t.icon, t.name);
};
t.prototype._onFacebookUserInfoError = function(e) {
JSON.parse(e.getUserData());
this._sendLogin();
};
t.prototype._checkAgreement = function() {
if (this.AgreementToggle.isChecked) return !0;
b.PopHelper.Instance.showTips(p.default.getString("LOGIN_TIP_AGREEMENT"));
return !1;
};
t.prototype.onClickPrivatePolicy = function() {
y.default.getInstance().isCashGame && cc.sys.openURL(r.Config.PrivatePolicyUrl);
};
t.prototype.onClickPhone = function() {
if (this._checkAgreement()) if (f.Tools.TStr.checkType(this.Input.string, "indiaPhone")) {
var e = this.otpInput.string;
if ("" != e) {
var t = {
packageName: l.default.getPackageName(),
onlyID: l.default.getOnlyID(),
device_info: l.default.getDeviceID(),
type: s.LoginType.Phone,
channel: r.Config.Channel,
platform: E.default.Instance.getPlatform(),
version: String(l.default.getVersionCode()),
phoneNumber: this._otpPhoneNumber,
ac: "91",
cd: e,
hot_update_version: h.default.Instance.updateVersion,
afid: l.default.getAFID(),
advertising_id: l.default.getGoogleAdID(),
app_instance_id: l.default.getLogInstanceID(),
ad: l.default.getAdType()
};
E.default.Instance.sendLoginPhone(t);
} else b.PopHelper.Instance.showTips("please enter verification code");
} else b.PopHelper.Instance.showTips(p.default.getString("KYC_INPUT_TIP_1"));
};
t.prototype.onClickPhoneOtp = function() {
if (this._checkAgreement()) if (cc.sys.isNative) if (f.Tools.TStr.checkType(this.Input.string, "indiaPhone")) {
this._otpPhoneNumber = this.Input.string;
I.PhoneProxy.Instance.sendCenterGetVerificationCode(u.GameEnum.VerificationType.SMS_TYPE_PHONE_LOGIN, this.Input.string);
} else b.PopHelper.Instance.showTips(p.default.getString("KYC_INPUT_TIP_1")); else {
var e = {
packageName: l.default.getPackageName(),
onlyID: this.Input.string,
device_info: this.Input.string,
type: s.LoginType.Guest,
channel: r.Config.Channel,
platform: E.default.Instance.getPlatform(),
version: String(l.default.getVersionCode()),
hot_update_version: h.default.Instance.updateVersion,
afid: l.default.getAFID(),
advertising_id: l.default.getGoogleAdID(),
app_instance_id: l.default.getLogInstanceID(),
ad: l.default.getAdType()
};
if ("" == e.onlyID) {
var t = f.Tools.GenerateUUID();
e.onlyID = t;
this.Input.string = t;
}
E.default.Instance.sendLoginGuest(e);
}
};
t.prototype.onClickGuest = function() {
if (this._checkAgreement() && cc.sys.isNative) {
var e = {
packageName: l.default.getPackageName(),
onlyID: l.default.getOnlyID(),
device_info: l.default.getDeviceID(),
type: s.LoginType.Guest,
channel: r.Config.Channel,
platform: E.default.Instance.getPlatform(),
version: String(l.default.getVersionCode()),
hot_update_version: h.default.Instance.updateVersion,
afid: l.default.getAFID(),
advertising_id: l.default.getGoogleAdID(),
app_instance_id: l.default.getLogInstanceID(),
ad: l.default.getAdType()
};
E.default.Instance.sendLoginGuest(e);
}
};
t.prototype.onClickGoogle = function() {
this._checkAgreement() && cc.sys.os == cc.sys.OS_ANDROID && cc.sys.isNative && l.default.signInByGoogle();
};
t.prototype.onClickGameCenter = function() {
this._checkAgreement() && cc.sys.os == cc.sys.OS_IOS && cc.sys.isNative;
};
t.prototype.onClickFacebook = function() {
this._checkAgreement() && cc.sys.isNative && l.default.loginFb();
};
t.prototype.onClickService = function() {
T.default.Instance.openSerciveView();
};
i([ A(cc.Node) ], t.prototype, "Background", void 0);
i([ A(cc.Node) ], t.prototype, "UILayer", void 0);
i([ A(cc.Node) ], t.prototype, "TopLayer", void 0);
i([ A(v.default) ], t.prototype, "Input", void 0);
i([ A(v.default) ], t.prototype, "otpInput", void 0);
i([ A(cc.Toggle) ], t.prototype, "AgreementToggle", void 0);
i([ A(cc.Button) ], t.prototype, "otpButton", void 0);
i([ A(cc.Label) ], t.prototype, "otpButtonTitle", void 0);
i([ A(cc.Node) ], t.prototype, "GoogleButton", void 0);
i([ A(cc.Node) ], t.prototype, "GameCenterButton", void 0);
i([ A(cc.Node) ], t.prototype, "GuestButton", void 0);
return i([ O, P("Scene/LoginScene") ], t);
}(cc.Component);
o.default = M;
cc._RF.pop();
}, {
"../../../Config": "Config",
"../../../Game/Script/global/GlobalValue": "GlobalValue",
"../../../Game/client/global/enum/game/Const": "Const",
"../../../Game/client/global/enum/game/Event": "Event",
"../../../Game/client/global/enum/game/Game": "Game",
"../../../Game/client/global/enum/game/UIUtils": "UIUtils",
"../../../Game/client/model/LanguageModel": "LanguageModel",
"../../../Game/client/model/UpdateModel": "UpdateModel",
"../../../Game/fromework/global/Tools": "Tools",
"../../../Game/fromework/helper/EventHelper": "EventHelper",
"../../../Game/fromework/helper/UIHelper": "UIHelper",
"../../../fromework/helper/NetHelper": "NetHelper",
"../../../platform/Platform": "Platform",
"../../component/NumericLabel": "NumericLabel",
"../../global/Global": "Global",
"../../global/PopHelper": "PopHelper",
"../../model/PhoneModel": "PhoneModel",
"../../model/UserModel": "UserModel",
"../Wallet/WalletHelper": "WalletHelper",
"../game/HearBeat": "HearBeat"
} ],
Log: [ function(e, t, o) {
"use strict";
cc._RF.push(t, "04fd98tz6VP+5vHq6/p7dn8", "Log");
var n = this && this.__decorate || function(e, t, o, n) {
var a, i = arguments.length, r = i < 3 ? t : null === n ? n = Object.getOwnPropertyDescriptor(t, o) : n;
if ("object" == typeof Reflect && "function" == typeof Reflect.decorate) r = Reflect.decorate(e, t, o, n); else for (var l = e.length - 1; l >= 0; l--) (a = e[l]) && (r = (i < 3 ? a(r) : i > 3 ? a(t, o, r) : a(t, o)) || r);
return i > 3 && r && Object.defineProperty(t, o, r), r;
};
Object.defineProperty(o, "__esModule", {
value: !0
});
var a = cc._decorator.ccclass, i = function() {
function e() {}
t = e;
e.debug = function() {
for (var e = [], o = 0; o < arguments.length; o++) e[o] = arguments[o];
t.showLog && console.debug(JSON.stringify(e));
};
e.log = function() {
for (var e = [], o = 0; o < arguments.length; o++) e[o] = arguments[o];
t.showLog && console.log(JSON.stringify(e));
};
e.warn = function() {
for (var e = [], o = 0; o < arguments.length; o++) e[o] = arguments[o];
t.showLog && console.log(JSON.stringify(e));
};
e.info = function() {
for (var e = [], o = 0; o < arguments.length; o++) e[o] = arguments[o];
t.showLog && console.info(JSON.stringify(e));
};
e.error = function() {
for (var e = [], o = 0; o < arguments.length; o++) e[o] = arguments[o];
t.showLog && console.error(JSON.stringify(e));
};
var t;
e.showLog = !0;
return t = n([ a ], e);
}();
o.default = i;
cc._RF.pop();
}, {} ],
LongTouchComponent: [ function(e, t, o) {
"use strict";
cc._RF.push(t, "d2e64ueLQ9KP5uyNDg3U/ZK", "LongTouchComponent");
var n, a = this && this.__extends || (n = function(e, t) {
return (n = Object.setPrototypeOf || {
__proto__: []
} instanceof Array && function(e, t) {
e.__proto__ = t;
} || function(e, t) {
for (var o in t) Object.prototype.hasOwnProperty.call(t, o) && (e[o] = t[o]);
})(e, t);
}, function(e, t) {
n(e, t);
function o() {
this.constructor = e;
}
e.prototype = null === t ? Object.create(t) : (o.prototype = t.prototype, new o());
}), i = this && this.__decorate || function(e, t, o, n) {
var a, i = arguments.length, r = i < 3 ? t : null === n ? n = Object.getOwnPropertyDescriptor(t, o) : n;
if ("object" == typeof Reflect && "function" == typeof Reflect.decorate) r = Reflect.decorate(e, t, o, n); else for (var l = e.length - 1; l >= 0; l--) (a = e[l]) && (r = (i < 3 ? a(r) : i > 3 ? a(t, o, r) : a(t, o)) || r);
return i > 3 && r && Object.defineProperty(t, o, r), r;
};
Object.defineProperty(o, "__esModule", {
value: !0
});
var r = cc._decorator, l = r.ccclass, s = r.property, c = function(e) {
a(t, e);
function t() {
var t = null !== e && e.apply(this, arguments) || this;
t.touchInterval = .1;
t.enableMultiTouching = !1;
t.longTouchEvents = [];
t._touchCounter = 0;
t._isTouching = !1;
return t;
}
t.prototype.onEnable = function() {
this.node.on(cc.Node.EventType.TOUCH_START, this._onTouchStart, this);
this.node.on(cc.Node.EventType.TOUCH_END, this._onTouchEnd, this);
this.node.on(cc.Node.EventType.TOUCH_CANCEL, this._onTouchCancel, this);
};
t.prototype.onDisable = function() {
this.node.off(cc.Node.EventType.TOUCH_START, this._onTouchStart, this);
this.node.off(cc.Node.EventType.TOUCH_END, this._onTouchEnd, this);
this.node.off(cc.Node.EventType.TOUCH_CANCEL, this._onTouchCancel, this);
};
t.prototype._onTouchStart = function(e) {
if (!this.enableMultiTouching) {
if (this._isTouching) return;
this.node.getBoundingBoxToWorld().contains(e.getLocation()) ? this._isTouching = !0 : this._isTouching = !1;
if (this._isTouching) {
this.publishOneTouch();
this.schedule(this._touchCounterCallback, this.touchInterval);
}
}
};
t.prototype._onTouchEnd = function() {
this._isTouching = !1;
this._touchCounter = 0;
this.unschedule(this._touchCounterCallback);
};
t.prototype._onTouchCancel = function() {
this._isTouching = !1;
this._touchCounter = 0;
this.unschedule(this._touchCounterCallback);
};
t.prototype._touchCounterCallback = function() {
this._isTouching ? this.publishOneTouch() : this.unschedule(this._touchCounterCallback);
};
t.prototype.publishOneTouch = function() {
var e = this;
if (this._isTouching) {
this._touchCounter++;
this.longTouchEvents.forEach(function(t) {
t.emit([ e._touchCounter ]);
});
}
};
i([ s({
tooltip: "触摸回调间隔（秒）。假如为0.1，那么1秒内会回调10次 ${longTouchEvents} 事件数组"
}) ], t.prototype, "touchInterval", void 0);
i([ s({
readonly: !0,
tooltip: "是否支持多点触控（当前还不支持）"
}) ], t.prototype, "enableMultiTouching", void 0);
i([ s({
type: [ cc.Component.EventHandler ],
tooltip: "回调事件数组，每间隔 ${toucheInterval}s 回调一次"
}) ], t.prototype, "longTouchEvents", void 0);
return i([ l ], t);
}(cc.Component);
o.default = c;
cc._RF.pop();
}, {} ],
LotoFastBigWinner: [ function(e, t, o) {
"use strict";
cc._RF.push(t, "93191ah669I0ajPaJUlp4Fe", "LotoFastBigWinner");
var n, a = this && this.__extends || (n = function(e, t) {
return (n = Object.setPrototypeOf || {
__proto__: []
} instanceof Array && function(e, t) {
e.__proto__ = t;
} || function(e, t) {
for (var o in t) Object.prototype.hasOwnProperty.call(t, o) && (e[o] = t[o]);
})(e, t);
}, function(e, t) {
n(e, t);
function o() {
this.constructor = e;
}
e.prototype = null === t ? Object.create(t) : (o.prototype = t.prototype, new o());
}), i = this && this.__decorate || function(e, t, o, n) {
var a, i = arguments.length, r = i < 3 ? t : null === n ? n = Object.getOwnPropertyDescriptor(t, o) : n;
if ("object" == typeof Reflect && "function" == typeof Reflect.decorate) r = Reflect.decorate(e, t, o, n); else for (var l = e.length - 1; l >= 0; l--) (a = e[l]) && (r = (i < 3 ? a(r) : i > 3 ? a(t, o, r) : a(t, o)) || r);
return i > 3 && r && Object.defineProperty(t, o, r), r;
};
Object.defineProperty(o, "__esModule", {
value: !0
});
var r = e("../../../Game/client/global/enum/game/Const"), l = e("../../../Game/client/global/enum/game/UIUtils"), s = e("../../../Game/fromework/global/Tools"), c = e("../../../Game/fromework/helper/EventHelper"), u = e("../../../Game/fromework/helper/UIHelper"), d = e("../../../client/global/PopHelper"), p = e("./LotoFastEvent"), h = e("./LotoFastModel"), f = e("./LotoFastRecordAlert"), _ = cc._decorator, m = _.ccclass, y = _.property, g = function(e) {
a(t, e);
function t() {
var t = null !== e && e.apply(this, arguments) || this;
t.Icon_Empty = null;
t.Node_Title = null;
t.Node_Name = null;
t.Node_Money = null;
t.Icon_Image = null;
t.Name_Text = null;
t.Money_Value = null;
t.SpriteFrame_Man = null;
t.SpriteFrame_Woman = null;
t._icon_url = "";
return t;
}
t.prototype.onEnable = function() {
c.default.Instance.Global.bind(p.LotoFastGameEvent.GAME_RECONNECT, this.rehresh, this);
c.default.Instance.Global.bind(p.LotoFastEvent.S2C_RESET_FAST, this.rehresh, this);
};
t.prototype.onDisable = function() {
c.default.Instance.Global.unbind(p.LotoFastGameEvent.GAME_RECONNECT, this.rehresh, this);
c.default.Instance.Global.unbind(p.LotoFastEvent.S2C_RESET_FAST, this.rehresh, this);
};
t.prototype.onDestroy = function() {};
t.prototype.rehresh = function() {
var e = h.LotoFastModel.Instance;
if (null != e.bigWinnerData) {
this.Icon_Empty.active = !1;
this.Node_Title.active = !0;
this.Node_Name.active = !0;
this.Node_Money.active = !0;
this.Icon_Image.node.active = !0;
this._refreshIcon(e.bigWinnerData.head_url);
this._refreshName(e.bigWinnerData.name);
this._refreshMoney(e.bigWinnerData.win_fee);
} else {
this.Icon_Empty.active = !0;
this.Node_Title.active = !1;
this.Node_Name.active = !1;
this.Node_Money.active = !1;
this.Icon_Image.node.active = !1;
}
};
t.prototype._refreshIcon = function(e, t) {
var o = this, n = !t || 1 == t;
if (null == e) {
this._icon_url = null;
this.Icon_Image.node.active = !1;
this.Icon_Empty.active = !0;
this.Icon_Image.spriteFrame = n ? this.SpriteFrame_Man : this.SpriteFrame_Woman;
this.Icon_Image.node.width = 100;
this.Icon_Image.node.height = 100;
} else if ("" == e) {
this._icon_url = "";
this.Icon_Image.node.active = !0;
this.Icon_Empty.active = !1;
this.Icon_Image.spriteFrame = n ? this.SpriteFrame_Man : this.SpriteFrame_Woman;
this.Icon_Image.node.width = 100;
this.Icon_Image.node.height = 100;
} else if (this._icon_url != e) {
this._icon_url = e;
l.UIUtils.updateHeadImage(e, this.Icon_Image, cc.size(100, 100), function(e) {
if (o && o.Icon_Image && o.Icon_Image.isValid) {
o.Icon_Image.node.active = e;
o.Icon_Empty.active = !e;
}
});
}
};
t.prototype._refreshName = function(e) {
this.Node_Name.active = !0;
this.Name_Text.string = s.Tools.TStr.ellipsisString(e, 12);
};
t.prototype._refreshMoney = function(e) {
this.Node_Money.active = !0;
this.Money_Value.string = "" + s.Tools.TNumber.numFixed(e, 1);
};
t.prototype.onBigWinnerClicked = function() {
u.default.Instance.addBundleMaskLayer(r.BundleUIPath.LotoFastRecordAlert, function(e) {
e.getComponent(f.default).InitView(2);
}, d.PopZindex.RBFast + 1);
};
i([ y(cc.Node) ], t.prototype, "Icon_Empty", void 0);
i([ y(cc.Node) ], t.prototype, "Node_Title", void 0);
i([ y(cc.Node) ], t.prototype, "Node_Name", void 0);
i([ y(cc.Node) ], t.prototype, "Node_Money", void 0);
i([ y(cc.Sprite) ], t.prototype, "Icon_Image", void 0);
i([ y(cc.Label) ], t.prototype, "Name_Text", void 0);
i([ y(cc.Label) ], t.prototype, "Money_Value", void 0);
i([ y(cc.SpriteFrame) ], t.prototype, "SpriteFrame_Man", void 0);
i([ y(cc.SpriteFrame) ], t.prototype, "SpriteFrame_Woman", void 0);
return i([ m ], t);
}(cc.Component);
o.default = g;
cc._RF.pop();
}, {
"../../../Game/client/global/enum/game/Const": "Const",
"../../../Game/client/global/enum/game/UIUtils": "UIUtils",
"../../../Game/fromework/global/Tools": "Tools",
"../../../Game/fromework/helper/EventHelper": "EventHelper",
"../../../Game/fromework/helper/UIHelper": "UIHelper",
"../../../client/global/PopHelper": "PopHelper",
"./LotoFastEvent": "LotoFastEvent",
"./LotoFastModel": "LotoFastModel",
"./LotoFastRecordAlert": "LotoFastRecordAlert"
} ],
LotoFastDealer: [ function(e, t, o) {
"use strict";
cc._RF.push(t, "0f4d9eoawtOR58uXXg+8290", "LotoFastDealer");
var n, a = this && this.__extends || (n = function(e, t) {
return (n = Object.setPrototypeOf || {
__proto__: []
} instanceof Array && function(e, t) {
e.__proto__ = t;
} || function(e, t) {
for (var o in t) Object.prototype.hasOwnProperty.call(t, o) && (e[o] = t[o]);
})(e, t);
}, function(e, t) {
n(e, t);
function o() {
this.constructor = e;
}
e.prototype = null === t ? Object.create(t) : (o.prototype = t.prototype, new o());
}), i = this && this.__decorate || function(e, t, o, n) {
var a, i = arguments.length, r = i < 3 ? t : null === n ? n = Object.getOwnPropertyDescriptor(t, o) : n;
if ("object" == typeof Reflect && "function" == typeof Reflect.decorate) r = Reflect.decorate(e, t, o, n); else for (var l = e.length - 1; l >= 0; l--) (a = e[l]) && (r = (i < 3 ? a(r) : i > 3 ? a(t, o, r) : a(t, o)) || r);
return i > 3 && r && Object.defineProperty(t, o, r), r;
};
Object.defineProperty(o, "__esModule", {
value: !0
});
var r = e("../../../Game/client/global/enum/game/Const"), l = e("../../../Game/fromework/global/ResLoader"), s = e("../../../Game/fromework/helper/EventHelper"), c = e("../../../platform/Platform"), u = e("../../../client/teenpatti/model/TeenPattiStruct"), d = e("../../Common/Component/CompositeCard"), p = e("./LotoFastEvent"), h = e("./LotoFastModel"), f = cc._decorator, _ = f.ccclass, m = f.property, y = function(e) {
a(t, e);
function t() {
var t = null !== e && e.apply(this, arguments) || this;
t.CardParent = null;
t.CountDown = null;
t.Time = null;
t.CardType = null;
t._cards = [];
return t;
}
t.prototype.onEnable = function() {
s.default.Instance.Global.bind(p.LotoFastGameEvent.GAME_RECONNECT, this.onReconnect, this);
s.default.Instance.Global.bind(p.LotoFastUIEvent.UI_EFFECT_START_BET, this.onStartBet, this);
s.default.Instance.Global.bind(p.LotoFastUIEvent.UI_EFFECT_STOP_BET, this.onStopBet, this);
s.default.Instance.Global.bind(p.LotoFastEvent.S2C_DEAL_FAST, this.onDeal, this);
s.default.Instance.Global.bind(p.LotoFastEvent.S2C_SHOW_FAST, this.onShow, this);
s.default.Instance.Global.bind(p.LotoFastEvent.S2C_RESET_FAST, this.onReset, this);
};
t.prototype.onDisable = function() {
s.default.Instance.Global.unbind(p.LotoFastGameEvent.GAME_RECONNECT, this.onReconnect, this);
s.default.Instance.Global.unbind(p.LotoFastUIEvent.UI_EFFECT_START_BET, this.onStartBet, this);
s.default.Instance.Global.unbind(p.LotoFastUIEvent.UI_EFFECT_STOP_BET, this.onStopBet, this);
s.default.Instance.Global.unbind(p.LotoFastEvent.S2C_DEAL_FAST, this.onDeal, this);
s.default.Instance.Global.unbind(p.LotoFastEvent.S2C_SHOW_FAST, this.onShow, this);
s.default.Instance.Global.unbind(p.LotoFastEvent.S2C_RESET_FAST, this.onReset, this);
};
t.prototype.onLoad = function() {
this.CardType.node.active = !1;
this.CountDown.active = !1;
};
t.prototype.onDestroy = function() {
this.unscheduleAllCallbacks();
};
t.prototype.destroyCard = function() {
this.CardParent.destroyAllChildren();
this._cards = [];
};
t.prototype.createCard = function(e) {
var t = this;
this.destroyCard();
l.default.Instance.loadBundleRes(r.BundleUIPath.CompositeCard, cc.Prefab, function(o, n) {
if (o) c.default.log("LotoFastDealer Can Not Load CompositeCard!"); else {
for (var a = 0; a < 3; a++) {
var i = cc.instantiate(n);
i.scale = .74;
i.active = !0;
i.parent = t.CardParent;
i.setPosition(cc.Vec2.ZERO);
var r = i.getComponent(d.default);
r.init(0, !1);
t._cards.push(r);
}
e && e();
}
});
};
t.prototype.setCards = function(e, t) {
this._cards.forEach(function(o, n) {
o && o.isValid && o.init(null != e[n] ? e[n] : 0, t);
});
};
t.prototype.playCardType = function(e) {
var t = "";
if (e == u.TeenPattiCardType.HighCard || e == u.TeenPattiCardType.HighCardA) t = "HIGH CARD"; else if (e == u.TeenPattiCardType.Pair) t = "PAIR"; else if (e == u.TeenPattiCardType.Color) t = "COLOR"; else if (e == u.TeenPattiCardType.Sequence) t = "SEQ"; else if (e == u.TeenPattiCardType.PureSequence) t = "PURE SEQ"; else if (e == u.TeenPattiCardType.Trail) {
t = "SET";
s.default.Instance.Global.emit(p.LotoFastUIEvent.UI_EFFECT_JACKPOT);
}
this.CardType.string = t;
this.CardType.node.active = !0;
this.CountDown.active = !1;
};
t.prototype.onReconnect = function() {
var e = this, t = h.LotoFastModel.Instance;
this.createCard(function() {
if (2 == t.roomData.state) {
e.setCards([ 0, 0, 0 ], !1);
e.onStartBet();
} else if (3 == t.roomData.state) {
e.setCards(t.show_card, !0);
var o = u.TeenPattiCheckTools.checkCardType(t.show_card);
e.playCardType(o);
}
});
};
t.prototype.onStartBet = function() {
var e = this, t = h.LotoFastModel.Instance.getCountDown();
this.CardType.node.active = !1;
this.CountDown.active = !0;
this.Time.string = t + "";
var o = function() {
t--;
if (e.Time && e.Time.isValid) if (t < 0) {
e.Time.string = "0";
e.unscheduleAllCallbacks();
} else e.Time.string = t + "";
};
this.schedule(o, 1);
o();
};
t.prototype.onStopBet = function() {};
t.prototype.onDeal = function() {
var e = this;
this.createCard(function() {
e.setCards([ 0, 0, 0 ], !1);
});
};
t.prototype.onShow = function() {
var e = this, t = h.LotoFastModel.Instance;
this.createCard(function() {
var o = function() {
e._cards[2].init(t.show_card[2], !1);
e._cards[2].flipCard(.7, cc.v3(0, -180, 0), !1, function() {
e.scheduleOnce(function() {
var o = u.TeenPattiCheckTools.checkCardType(t.show_card);
e.playCardType(o);
s.default.Instance.Global.emit(p.LotoFastUIEvent.UI_ODDS_SHOW_WIN);
}, .3);
});
}, n = function() {
e._cards[1].init(t.show_card[1], !1);
e._cards[1].flipCard(.5, cc.v3(0, -180, 0), !1, function() {
e.scheduleOnce(o, .2);
});
};
e._cards[0].init(t.show_card[0], !1);
e._cards[0].flipCard(.5, cc.v3(0, -180, 0), !1, function() {
n();
});
});
};
t.prototype.onReset = function() {};
i([ m(cc.Node) ], t.prototype, "CardParent", void 0);
i([ m(cc.Node) ], t.prototype, "CountDown", void 0);
i([ m(cc.Label) ], t.prototype, "Time", void 0);
i([ m(cc.Label) ], t.prototype, "CardType", void 0);
return i([ _ ], t);
}(cc.Component);
o.default = y;
cc._RF.pop();
}, {
"../../../Game/client/global/enum/game/Const": "Const",
"../../../Game/fromework/global/ResLoader": "ResLoader",
"../../../Game/fromework/helper/EventHelper": "EventHelper",
"../../../client/teenpatti/model/TeenPattiStruct": "TeenPattiStruct",
"../../../platform/Platform": "Platform",
"../../Common/Component/CompositeCard": "CompositeCard",
"./LotoFastEvent": "LotoFastEvent",
"./LotoFastModel": "LotoFastModel"
} ],
LotoFastEvent: [ function(e, t, o) {
"use strict";
cc._RF.push(t, "9346b8E5ddPpZT8hFnd4X4A", "LotoFastEvent");
Object.defineProperty(o, "__esModule", {
value: !0
});
o.LotoFastOddsEvent = o.LotoFastGameEvent = o.LotoFastUIEvent = o.LotoFastEvent = void 0;
o.LotoFastEvent = {
S2C_ENTER_ROOM_FAST: "S2C_ENTER_ROOM_FAST",
S2C_SWITCH_ROOM_FAST: "S2C_SWITCH_ROOM_FAST",
S2C_RESET_FAST: "S2C_RESET_FAST",
S2C_LEAVE_FAST: "S2C_LEAVE_FAST",
S2C_LEAVE_SINGLE_FAST: "S2C_LEAVE_SINGLE_FAST",
S2C_DISMISS_ROOM_FAST: "S2C_DISMISS_ROOM_FAST",
S2C_INTERACT_FAST: "S2C_INTERACT_FAST",
S2C_DEAL_FAST: "S2C_DEAL_FAST",
S2C_BET_FAST: "S2C_BET_FAST",
S2C_BET_BATCH_FAST: "S2C_BET_BATCH_FAST",
S2C_SHOW_FAST: "S2C_SHOW_FAST",
S2C_RANK_FAST: "S2C_RANK_FAST",
S2C_AUTO_PLAY_FAST: "S2C_AUTO_PLAY_FAST",
S2C_REPEAT_BET_FAST: "S2C_REPEAT_BET_FAST",
S2C_JACKPOT_RECORD_FAST: "S2C_JACKPOT_RECORD_FAST",
S2C_USER_RECORD_FAST: "S2C_USER_RECORD_FAST",
S2C_WINNER_RECORD_FAST: "S2C_WINNER_RECORD_FAST",
TABLE_REFRESH_TABLE_FAST: "TABLE_REFRESH_TABLE_FAST",
TABLE_REPEAT_BET_ERROR: "TABLE_REPEAT_BET_ERROR"
};
o.LotoFastUIEvent = {
UI_EFFECT_START_BET: "UI_EFFECT_START_BET_FAST",
UI_EFFECT_STOP_BET: "UI_EFFECT_STOP_BET_FAST",
UI_INIT_ODDS_AMOUNT: "UI_INIT_ODDS_AMOUNT",
UI_EFFECT_JACKPOT: "UI_EFFECT_JACKPOT",
UI_JACKPOT_REFRESH_TIME: "UI_JACKPOT_REFRESH_TIME",
UI_JACKPOT_REFRESH_MONEY: "UI_JACKPOT_REFRESH_MONEY",
UI_ODDS_SHOW_WIN: "UI_ODDS_SHOW_WIN"
};
o.LotoFastGameEvent = {
GAME_RECONNECT: "GAME_RECONNECT_FAST",
GAME_JOIN_MARQUEE: "GAME_JOIN_MARQUEE"
};
o.LotoFastOddsEvent = {
ODDS_BET_CHANGED_ALL: "ODDS_BET_CHANGED_ALL_FAST",
ODDS_BET_CHANGED_SELF: "ODDS_BET_CHANGED_SELF_FAST",
ODDS_BET_BUTTON_CLICK: "ODDS_BET_BUTTON_CLICK_FAST"
};
cc._RF.pop();
}, {} ],
LotoFastHelp: [ function(e, t, o) {
"use strict";
cc._RF.push(t, "d4e2c+tDpNGK4j1XnHfgBjR", "LotoFastHelp");
var n, a = this && this.__extends || (n = function(e, t) {
return (n = Object.setPrototypeOf || {
__proto__: []
} instanceof Array && function(e, t) {
e.__proto__ = t;
} || function(e, t) {
for (var o in t) Object.prototype.hasOwnProperty.call(t, o) && (e[o] = t[o]);
})(e, t);
}, function(e, t) {
n(e, t);
function o() {
this.constructor = e;
}
e.prototype = null === t ? Object.create(t) : (o.prototype = t.prototype, new o());
}), i = this && this.__decorate || function(e, t, o, n) {
var a, i = arguments.length, r = i < 3 ? t : null === n ? n = Object.getOwnPropertyDescriptor(t, o) : n;
if ("object" == typeof Reflect && "function" == typeof Reflect.decorate) r = Reflect.decorate(e, t, o, n); else for (var l = e.length - 1; l >= 0; l--) (a = e[l]) && (r = (i < 3 ? a(r) : i > 3 ? a(t, o, r) : a(t, o)) || r);
return i > 3 && r && Object.defineProperty(t, o, r), r;
};
Object.defineProperty(o, "__esModule", {
value: !0
});
var r = e("../../../Game/fromework/global/Tools"), l = e("./LotoFastModel"), s = [ "Split the jackpot * %{rate}%", "Win = bet * %{rate}", "Win = bet * %{rate}", "Win = bet * %{rate}", "Win = bet * %{rate}", "Win = bet * %{rate}" ], c = cc._decorator, u = c.ccclass, d = c.property, p = function(e) {
a(t, e);
function t() {
var t = null !== e && e.apply(this, arguments) || this;
t.RateLabels = [];
return t;
}
t.prototype.onLoad = function() {
for (var e = l.LotoFastModel.Instance, t = 0; t < this.RateLabels.length; t++) {
var o = this.RateLabels[t];
o && o.isValid && (o.string = r.Tools.TStr.replaceAll(s[t], "%{rate}", e.bet_options[t].x));
}
};
i([ d([ cc.Label ]) ], t.prototype, "RateLabels", void 0);
return i([ u ], t);
}(cc.Component);
o.default = p;
cc._RF.pop();
}, {
"../../../Game/fromework/global/Tools": "Tools",
"./LotoFastModel": "LotoFastModel"
} ],
LotoFastJackPotRecordItem: [ function(e, t, o) {
"use strict";
cc._RF.push(t, "b8736ordvRMab7abUXgRRgX", "LotoFastJackPotRecordItem");
var n, a = this && this.__extends || (n = function(e, t) {
return (n = Object.setPrototypeOf || {
__proto__: []
} instanceof Array && function(e, t) {
e.__proto__ = t;
} || function(e, t) {
for (var o in t) Object.prototype.hasOwnProperty.call(t, o) && (e[o] = t[o]);
})(e, t);
}, function(e, t) {
n(e, t);
function o() {
this.constructor = e;
}
e.prototype = null === t ? Object.create(t) : (o.prototype = t.prototype, new o());
}), i = this && this.__decorate || function(e, t, o, n) {
var a, i = arguments.length, r = i < 3 ? t : null === n ? n = Object.getOwnPropertyDescriptor(t, o) : n;
if ("object" == typeof Reflect && "function" == typeof Reflect.decorate) r = Reflect.decorate(e, t, o, n); else for (var l = e.length - 1; l >= 0; l--) (a = e[l]) && (r = (i < 3 ? a(r) : i > 3 ? a(t, o, r) : a(t, o)) || r);
return i > 3 && r && Object.defineProperty(t, o, r), r;
};
Object.defineProperty(o, "__esModule", {
value: !0
});
var r = e("../../../Game/client/global/enum/game/Const"), l = e("../../../Game/fromework/global/ResLoader"), s = e("../../../Game/fromework/global/Tools"), c = e("../../../platform/Platform"), u = e("../../Common/Component/CompositeCard"), d = cc._decorator, p = d.ccclass, h = d.property, f = function(e) {
a(t, e);
function t() {
var t = null !== e && e.apply(this, arguments) || this;
t.CardParent = null;
t.Time = null;
t.Winner = null;
t.Win = null;
t._data = null;
t._index = -1;
return t;
}
t.prototype.onItemInitCallFunc = function(e, t) {
var o = this;
this._data = e;
this._index = t;
this.CardParent.destroyAllChildren();
l.default.Instance.loadBundleRes(r.BundleUIPath.CompositeCard, cc.Prefab, function(e, t) {
if (e) c.default.log("LotoFastDealer Can Not Load CompositeCard!"); else for (var n = 0; n < 3; n++) {
var a = cc.instantiate(t);
a.scale = .33;
a.active = !0;
a.parent = o.CardParent;
a.setPosition(cc.Vec2.ZERO);
a.getComponent(u.default).init(null != o._data.show_card[n] ? o._data.show_card[n] : 0, !0);
}
});
this.Time.string = s.Tools.TDate.format(1e3 * this._data.time, "MM/dd hh:mm:ss");
this.Winner.string = this._data.winner + "";
this.Win.string = this._data.win_fee + "";
};
t.prototype.onItemEnterCallFunc = function() {
this.node.opacity = 255;
};
t.prototype.onItemExitCallFunc = function() {
this.node.opacity = 0;
};
i([ h(cc.Node) ], t.prototype, "CardParent", void 0);
i([ h(cc.Label) ], t.prototype, "Time", void 0);
i([ h(cc.Label) ], t.prototype, "Winner", void 0);
i([ h(cc.Label) ], t.prototype, "Win", void 0);
return i([ p ], t);
}(cc.Component);
o.default = f;
cc._RF.pop();
}, {
"../../../Game/client/global/enum/game/Const": "Const",
"../../../Game/fromework/global/ResLoader": "ResLoader",
"../../../Game/fromework/global/Tools": "Tools",
"../../../platform/Platform": "Platform",
"../../Common/Component/CompositeCard": "CompositeCard"
} ],
LotoFastJackPot: [ function(e, t, o) {
"use strict";
cc._RF.push(t, "3f1426OamZL2ZIwdznoSu24", "LotoFastJackPot");
var n, a = this && this.__extends || (n = function(e, t) {
return (n = Object.setPrototypeOf || {
__proto__: []
} instanceof Array && function(e, t) {
e.__proto__ = t;
} || function(e, t) {
for (var o in t) Object.prototype.hasOwnProperty.call(t, o) && (e[o] = t[o]);
})(e, t);
}, function(e, t) {
n(e, t);
function o() {
this.constructor = e;
}
e.prototype = null === t ? Object.create(t) : (o.prototype = t.prototype, new o());
}), i = this && this.__decorate || function(e, t, o, n) {
var a, i = arguments.length, r = i < 3 ? t : null === n ? n = Object.getOwnPropertyDescriptor(t, o) : n;
if ("object" == typeof Reflect && "function" == typeof Reflect.decorate) r = Reflect.decorate(e, t, o, n); else for (var l = e.length - 1; l >= 0; l--) (a = e[l]) && (r = (i < 3 ? a(r) : i > 3 ? a(t, o, r) : a(t, o)) || r);
return i > 3 && r && Object.defineProperty(t, o, r), r;
};
Object.defineProperty(o, "__esModule", {
value: !0
});
var r = e("../../../Game/client/global/enum/game/Const"), l = e("../../../Game/fromework/global/Tools"), s = e("../../../Game/fromework/helper/EventHelper"), c = e("../../../Game/fromework/helper/UIHelper"), u = e("../../../client/global/PopHelper"), d = e("./LotoFastEvent"), p = e("./LotoFastRecordAlert"), h = cc._decorator, f = h.ccclass, _ = h.property, m = function(e) {
a(t, e);
function t() {
var t = null !== e && e.apply(this, arguments) || this;
t.DragonBonus = null;
t.Money = null;
t.Time = null;
return t;
}
t.prototype.onEnable = function() {
s.default.Instance.Global.bind(d.LotoFastEvent.S2C_DEAL_FAST, this.onDeal, this);
s.default.Instance.Global.bind(d.LotoFastEvent.S2C_SHOW_FAST, this.onShow, this);
s.default.Instance.Global.bind(d.LotoFastUIEvent.UI_JACKPOT_REFRESH_TIME, this.refreshTime, this);
s.default.Instance.Global.bind(d.LotoFastUIEvent.UI_JACKPOT_REFRESH_MONEY, this.refreshMoney, this);
};
t.prototype.onDisable = function() {
s.default.Instance.Global.unbind(d.LotoFastEvent.S2C_DEAL_FAST, this.onDeal, this);
s.default.Instance.Global.unbind(d.LotoFastEvent.S2C_SHOW_FAST, this.onShow, this);
s.default.Instance.Global.unbind(d.LotoFastUIEvent.UI_JACKPOT_REFRESH_TIME, this.refreshTime, this);
s.default.Instance.Global.unbind(d.LotoFastUIEvent.UI_JACKPOT_REFRESH_MONEY, this.refreshMoney, this);
};
t.prototype.onDestroy = function() {
this.unscheduleAllCallbacks();
};
t.prototype.onDeal = function() {
this.DragonBonus.armatureName = "Armature";
this.DragonBonus.playAnimation("animation_betting", 0);
};
t.prototype.onShow = function() {
this.DragonBonus.armatureName = "Armature";
this.DragonBonus.playAnimation("animation_stopbetting", 0);
};
t.prototype.refreshTime = function(e) {
var t = this, o = e.getUserData().startTime;
(isNaN(o) || o < 0) && (o = 0);
this.unscheduleAllCallbacks();
var n = function() {
var e = l.Tools.TDate.second2Hour(o);
t.Time.string = l.Tools.TDate.fix2(e.hour) + ":" + l.Tools.TDate.fix2(e.minu) + ":" + l.Tools.TDate.fix2(e.sec);
};
this.schedule(function() {
o++;
n();
}, 1);
n();
};
t.prototype.refreshMoney = function(e) {
var t = e.getUserData().money;
isNaN(t) && (t = 0);
this.Money.string = t.toFixed(2);
};
t.prototype.onJackPotClicked = function() {
c.default.Instance.addBundleMaskLayer(r.BundleUIPath.LotoFastRecordAlert, function(e) {
e.getComponent(p.default).InitView(0);
}, u.PopZindex.RBFast + 1);
};
i([ _(dragonBones.ArmatureDisplay) ], t.prototype, "DragonBonus", void 0);
i([ _(cc.Label) ], t.prototype, "Money", void 0);
i([ _(cc.Label) ], t.prototype, "Time", void 0);
return i([ f ], t);
}(cc.Component);
o.default = m;
cc._RF.pop();
}, {
"../../../Game/client/global/enum/game/Const": "Const",
"../../../Game/fromework/global/Tools": "Tools",
"../../../Game/fromework/helper/EventHelper": "EventHelper",
"../../../Game/fromework/helper/UIHelper": "UIHelper",
"../../../client/global/PopHelper": "PopHelper",
"./LotoFastEvent": "LotoFastEvent",
"./LotoFastRecordAlert": "LotoFastRecordAlert"
} ],
LotoFastManager: [ function(e, t, o) {
"use strict";
cc._RF.push(t, "79d65qH/1RMqKHGiEX0pJjB", "LotoFastManager");
var n, a = this && this.__extends || (n = function(e, t) {
return (n = Object.setPrototypeOf || {
__proto__: []
} instanceof Array && function(e, t) {
e.__proto__ = t;
} || function(e, t) {
for (var o in t) Object.prototype.hasOwnProperty.call(t, o) && (e[o] = t[o]);
})(e, t);
}, function(e, t) {
n(e, t);
function o() {
this.constructor = e;
}
e.prototype = null === t ? Object.create(t) : (o.prototype = t.prototype, new o());
}), i = this && this.__decorate || function(e, t, o, n) {
var a, i = arguments.length, r = i < 3 ? t : null === n ? n = Object.getOwnPropertyDescriptor(t, o) : n;
if ("object" == typeof Reflect && "function" == typeof Reflect.decorate) r = Reflect.decorate(e, t, o, n); else for (var l = e.length - 1; l >= 0; l--) (a = e[l]) && (r = (i < 3 ? a(r) : i > 3 ? a(t, o, r) : a(t, o)) || r);
return i > 3 && r && Object.defineProperty(t, o, r), r;
};
Object.defineProperty(o, "__esModule", {
value: !0
});
var r = e("../../../Game/Script/global/GlobalValue"), l = e("../../../Game/client/global/enum/game/Const"), s = e("../../../Game/client/global/enum/game/Event"), c = e("../../../Game/client/global/enum/game/Game"), u = e("../../../Game/fromework/helper/EventHelper"), d = e("../../../Game/fromework/helper/UIHelper"), p = e("../../../platform/Platform"), h = e("../../../client/global/PopHelper"), f = e("../../../client/model/LobbyModel"), _ = e("../../../fromework/component/ButtonBlock"), m = e("./LotoFastEvent"), y = e("./LotoFastModel"), g = cc._decorator, v = g.ccclass, C = g.property, b = function(e) {
a(t, e);
function t() {
var t = null !== e && e.apply(this, arguments) || this;
t.Bones = null;
t._anamationName = "";
return t;
}
t.prototype.onEnable = function() {
u.default.Instance.Global.bind(s.GameUIEvent.REFRESH_CASH, this.onRefreshCash, this);
u.default.Instance.Global.bind(s.LobbyEvent.LOBBY_JOIN, this.onJoin, this);
u.default.Instance.Global.bind(m.LotoFastEvent.S2C_ENTER_ROOM_FAST, this.refreshEffect, this);
u.default.Instance.Global.bind(m.LotoFastEvent.S2C_BET_FAST, this.refreshEffect, this);
u.default.Instance.Global.bind(m.LotoFastEvent.S2C_RESET_FAST, this.refreshEffect, this);
u.default.Instance.Global.bind(m.LotoFastEvent.S2C_DISMISS_ROOM_FAST, this.refreshEffect, this);
u.default.Instance.Global.bind(m.LotoFastEvent.S2C_AUTO_PLAY_FAST, this.refreshEffect, this);
u.default.Instance.Global.bind(m.LotoFastGameEvent.GAME_JOIN_MARQUEE, this.onLotoFastClicked, this);
};
t.prototype.onDisable = function() {
u.default.Instance.Global.unbind(s.GameUIEvent.REFRESH_CASH, this.onRefreshCash, this);
u.default.Instance.Global.unbind(s.LobbyEvent.LOBBY_JOIN, this.onJoin, this);
u.default.Instance.Global.unbind(m.LotoFastEvent.S2C_ENTER_ROOM_FAST, this.refreshEffect, this);
u.default.Instance.Global.unbind(m.LotoFastEvent.S2C_BET_FAST, this.refreshEffect, this);
u.default.Instance.Global.unbind(m.LotoFastEvent.S2C_RESET_FAST, this.refreshEffect, this);
u.default.Instance.Global.unbind(m.LotoFastEvent.S2C_DISMISS_ROOM_FAST, this.refreshEffect, this);
u.default.Instance.Global.unbind(m.LotoFastEvent.S2C_AUTO_PLAY_FAST, this.refreshEffect, this);
u.default.Instance.Global.unbind(m.LotoFastGameEvent.GAME_JOIN_MARQUEE, this.onLotoFastClicked, this);
};
t.prototype.onLoad = function() {
this.onRefreshCash();
};
t.prototype.onRefreshCash = function() {
var e = this.node.getChildByName("Button"), t = r.default.getInstance().isCashGame, o = f.default.Instance.getPlaySwitch(c.GameEnum.PlayType.GAME_LOTO_FAST), n = null != o && (2 == o.s || 3 == o.s);
if (t && n) {
this.Bones && (this.Bones.node.active = !0);
this.refreshEffect();
e.getComponent(cc.Button).interactable = !0;
e && e.isValid && (e.addComponent(_.default).BlockTime = 1);
} else {
this.Bones && (this.Bones.node.active = !1);
e.getComponent(cc.Button).interactable = !1;
}
};
t.prototype.refreshEffect = function() {
if (this.Bones) {
y.LotoFastModel.Instance;
var e = "animation_run";
if (this._anamationName != e) {
this._anamationName = e;
this.Bones.armatureName = "Armature";
this.Bones.playAnimation(this._anamationName, 0);
}
}
};
t.prototype.onJoin = function(e) {
e.getUserData().play.cls == c.GameEnum.PlayType.GAME_LOTO_FAST && d.default.Instance.addBundleMaskLayer(l.BundleUIPath.LotoFast, null, h.PopZindex.RBFast);
};
t.prototype.onLotoFastClicked = function() {
var e = f.default.Instance.getGamePlayByCls(c.GameEnum.PlayType.GAME_LOTO_FAST);
if (e && e[0]) {
y.default.Instance.isOpenWindow = !0;
f.default.Instance.sendJoinRoom(e[0].rtype);
} else p.default.log("Can not find play:" + c.GameEnum.PlayType.GAME_LOTO_FAST);
};
i([ C(dragonBones.ArmatureDisplay) ], t.prototype, "Bones", void 0);
return i([ v ], t);
}(cc.Component);
o.default = b;
cc._RF.pop();
}, {
"../../../Game/Script/global/GlobalValue": "GlobalValue",
"../../../Game/client/global/enum/game/Const": "Const",
"../../../Game/client/global/enum/game/Event": "Event",
"../../../Game/client/global/enum/game/Game": "Game",
"../../../Game/fromework/helper/EventHelper": "EventHelper",
"../../../Game/fromework/helper/UIHelper": "UIHelper",
"../../../client/global/PopHelper": "PopHelper",
"../../../client/model/LobbyModel": "LobbyModel",
"../../../fromework/component/ButtonBlock": "ButtonBlock",
"../../../platform/Platform": "Platform",
"./LotoFastEvent": "LotoFastEvent",
"./LotoFastModel": "LotoFastModel"
} ],
LotoFastMarquee: [ function(e, t, o) {
"use strict";
cc._RF.push(t, "8becczIRP9C+b1iY5Cm905P", "LotoFastMarquee");
var n, a = this && this.__extends || (n = function(e, t) {
return (n = Object.setPrototypeOf || {
__proto__: []
} instanceof Array && function(e, t) {
e.__proto__ = t;
} || function(e, t) {
for (var o in t) Object.prototype.hasOwnProperty.call(t, o) && (e[o] = t[o]);
})(e, t);
}, function(e, t) {
n(e, t);
function o() {
this.constructor = e;
}
e.prototype = null === t ? Object.create(t) : (o.prototype = t.prototype, new o());
}), i = this && this.__decorate || function(e, t, o, n) {
var a, i = arguments.length, r = i < 3 ? t : null === n ? n = Object.getOwnPropertyDescriptor(t, o) : n;
if ("object" == typeof Reflect && "function" == typeof Reflect.decorate) r = Reflect.decorate(e, t, o, n); else for (var l = e.length - 1; l >= 0; l--) (a = e[l]) && (r = (i < 3 ? a(r) : i > 3 ? a(t, o, r) : a(t, o)) || r);
return i > 3 && r && Object.defineProperty(t, o, r), r;
};
Object.defineProperty(o, "__esModule", {
value: !0
});
var r = e("../../../Game/Script/global/GlobalValue"), l = e("../../../Game/client/global/enum/game/Event"), s = e("../../../Game/client/model/LanguageModel"), c = e("../../../Game/fromework/global/Tools"), u = e("../../../Game/fromework/helper/EventHelper"), d = e("./LotoFastEvent"), p = cc._decorator, h = p.ccclass, f = p.property, _ = function(e) {
a(t, e);
function t() {
var t = null !== e && e.apply(this, arguments) || this;
t.Panel = null;
t.Back = null;
t.Title = null;
t.MoneyLabel = null;
t.PlayerLabel = null;
t.Cls = -1;
t.LablePosX = 0;
return t;
}
t.prototype.onEnable = function() {
u.default.Instance.Global.bind(l.MarqueeEvent.PUSH_MESSAGE, this.onMessage, this);
};
t.prototype.onDisable = function() {
u.default.Instance.Global.unbind(l.MarqueeEvent.PUSH_MESSAGE, this.onMessage, this);
};
t.prototype.onLoad = function() {
this.Panel.y = this.Panel.height + 100;
this.Panel.active = !1;
this.LablePosX = this.MoneyLabel.node.x;
};
t.prototype.checkRoomType = function(e) {
var t = e.split("_"), o = null != t[0] ? t[0] : null;
return null != o && parseInt(o) == this.Cls;
};
t.prototype.onMessage = function(e) {
if (r.default.getInstance().isCashGame) for (var t = e.getUserData(), o = 0; o < t.length; o++) {
var n = t[o];
if (n && this.checkRoomType(n.rtype)) {
this.PlayMarquee(n);
break;
}
}
};
t.prototype.PlayMarquee = function(e) {
var t = this;
e.param && e.param.cash && (e.param.cash = c.Tools.TNumber.num2single(parseFloat(e.param.cash)));
this.MoneyLabel.string = c.Tools.TStr.replaceAll(s.default.getString("LOTOFAST_MARQUEE_1"), "%{cash}", e.param.cash);
this.PlayerLabel.string = c.Tools.TStr.replaceAll(s.default.getString("LOTOFAST_MARQUEE_2"), "%{player}", e.param.player);
this.Panel.stopAllActions();
var o = this.Panel.height + 100;
this.Panel.y = o;
this.Panel.active = !0;
this.Back.active = !1;
this.Title.active = !1;
this.MoneyLabel.node.opacity = 0;
this.MoneyLabel.node.x = this.LablePosX - 50;
this.PlayerLabel.node.opacity = 0;
this.PlayerLabel.node.x = this.LablePosX - 50;
cc.tween(this.Panel).to(.2, {
y: 0
}).call(function() {
t.Back.active = !0;
t.Title.active = !0;
t.Title.getComponent(sp.Skeleton).setAnimation(0, "animation_jackpot_fall", !1);
t.Title.getComponent(sp.Skeleton).setCompleteListener(function() {
t.Title.getComponent(sp.Skeleton).setAnimation(0, "animation_jackpot_streamer", !0);
});
cc.tween(t.MoneyLabel.node).delay(.5).to(.1, {
x: t.LablePosX,
opacity: 255
}).start();
cc.tween(t.PlayerLabel.node).delay(.5).to(.1, {
x: t.LablePosX,
opacity: 255
}).start();
}).delay(6).to(.2, {
y: o
}).call(function() {
t.Title.active = !1;
t.Panel.active = !1;
}).start();
};
t.prototype.onPanelClicked = function() {
u.default.Instance.Global.emit(d.LotoFastGameEvent.GAME_JOIN_MARQUEE);
};
i([ f(cc.Node) ], t.prototype, "Panel", void 0);
i([ f(cc.Node) ], t.prototype, "Back", void 0);
i([ f(cc.Node) ], t.prototype, "Title", void 0);
i([ f(cc.Label) ], t.prototype, "MoneyLabel", void 0);
i([ f(cc.Label) ], t.prototype, "PlayerLabel", void 0);
i([ f(cc.Integer) ], t.prototype, "Cls", void 0);
return i([ h ], t);
}(cc.Component);
o.default = _;
cc._RF.pop();
}, {
"../../../Game/Script/global/GlobalValue": "GlobalValue",
"../../../Game/client/global/enum/game/Event": "Event",
"../../../Game/client/model/LanguageModel": "LanguageModel",
"../../../Game/fromework/global/Tools": "Tools",
"../../../Game/fromework/helper/EventHelper": "EventHelper",
"./LotoFastEvent": "LotoFastEvent"
} ],
LotoFastModel: [ function(e, t, o) {
"use strict";
cc._RF.push(t, "3829bJyzO9N3KbYsbrC4XgQ", "LotoFastModel");
Object.defineProperty(o, "__esModule", {
value: !0
});
o.LotoFastModel = void 0;
var n = e("../../../Game/client/global/enum/game/Event"), a = e("../../../Game/client/global/enum/game/Game"), i = e("../../../Game/client/global/enum/net/C2S"), r = e("../../../Game/client/global/enum/net/S2C"), l = e("../../../Game/fromework/global/Tools"), s = e("../../../Game/fromework/helper/EventHelper"), c = e("../../../Game/fromework/mvvm/modelView/ViewModel"), u = e("../../../platform/Platform"), d = e("../../../client/logic/game/HearBeat"), p = e("../../../client/model/ErrorModel"), h = e("../../../client/model/WalletModel"), f = e("../../../client/teenpatti/model/TeenPattiStruct"), _ = e("../../../fromework/helper/NetHelper"), m = e("../../Common/Utils/CompositeConst"), y = e("./LotoFastEvent"), g = e("./LotoFastStruct"), v = function() {
function e() {
this.sTime = 0;
this.total_fee = 0;
this.roomData = new g.LotoFastStruct.RoomData();
this.userData = null;
this.declearData = new g.LotoFastStruct.DeclearData();
this.playerBetRecord = [];
this.roomBetRecord = [];
this.deal_card = [];
this.show_card = [];
this.win_options = [];
this.bet_limit = 0;
this.declearHistory = new g.LotoFastStruct.DeclearHistory();
this.bigWinnerData = new g.LotoFastStruct.BigWinnerData();
this.bet_fee_currency = [];
this.bet_options = [];
this.jackpot_record = [];
this.user_record = [];
this.big_winner_record = [];
this.jackpot_total_pool = 0;
this.jackpot_time = 0;
this.jackpot_round = 0;
}
Object.defineProperty(e, "Instance", {
get: function() {
e._instance || (e._instance = new e());
return e._instance;
},
enumerable: !1,
configurable: !0
});
e.prototype.clear = function() {
null != e._instance && (e._instance = null);
};
e.prototype.getCountDown = function() {
u.default.log("get count down:", this.roomData.dl, this.sTime);
return Math.ceil(this.roomData.dl - this.sTime);
};
e.prototype.getBetAmount = function() {
var e = 0;
this.playerBetRecord.forEach(function(t) {
e += t.amount;
});
return e;
};
e.prototype.refreshUserData = function(e) {
this.userData = new g.LotoFastStruct.UserData(e);
this.refreshPlayerRecord(e.bet_record);
this.total_fee = l.Tools.TNumber.num2single(e.total_fee);
};
e.prototype.refreshRoomRecord = function(e) {
this.roomBetRecord.splice(0);
this.roomBetRecord = g.LotoFastStruct.getBetRecordArray(e);
for (var t = 0; t < this.roomBetRecord.length; t++) s.default.Instance.Global.emit(y.LotoFastOddsEvent.ODDS_BET_CHANGED_ALL, {
index: t,
self: null,
all: this.roomBetRecord[t].amount
});
};
e.prototype.refreshPlayerRecord = function(e) {
this.playerBetRecord.splice(0);
this.playerBetRecord = g.LotoFastStruct.getBetRecordArray(e);
for (var t = 0; t < this.playerBetRecord.length; t++) s.default.Instance.Global.emit(y.LotoFastOddsEvent.ODDS_BET_CHANGED_SELF, {
index: t,
self: this.playerBetRecord[t].amount,
all: null
});
};
e.prototype.getWinFee = function(e) {
var t = this.declearData.bet_record[e];
return t ? t.amount : 0;
};
e.prototype.checkRecharge = function() {
return c.VM.getValue("wallet.totalRecharge") >= m.COMPOSITE_MIN_RECHARGE;
};
e._instance = null;
return e;
}();
o.LotoFastModel = v;
var C = function() {
function e() {
this._recordCount = 10;
this.jackPotPage = 0;
this._jackPotTotal = 10;
this.userPage = 0;
this._userTotal = 10;
this.winnerPage = 0;
this._winnerTotal = 10;
this.isOpenWindow = !1;
}
Object.defineProperty(e, "Instance", {
get: function() {
e._instance || (e._instance = new e());
return e._instance;
},
enumerable: !1,
configurable: !0
});
Object.defineProperty(e.prototype, "cls", {
get: function() {
return a.GameEnum.PlayType.GAME_LOTO_FAST;
},
enumerable: !1,
configurable: !0
});
e.prototype.Init = function() {
s.default.Instance.Net.bind(r.S2C.GAME.ROOM_ENTER_ROOM, this._onEnterRoom, this);
s.default.Instance.Net.bind(r.S2C.GAME.ROOM_SWITCH_ROOM, this._onSwitchRoom, this);
s.default.Instance.Net.bind(r.S2C.GAME.ROOM_DEAL, this._onDeal, this);
s.default.Instance.Net.bind(r.S2C.GAME.ROOM_START_BET, this._onStartBet, this);
s.default.Instance.Net.bind(r.S2C.GAME.ROOM_BET, this._onBet, this);
s.default.Instance.Net.bind(r.S2C.GAME.ROOM_BET_BATCH, this._onBetBatch, this);
s.default.Instance.Net.bind(r.S2C.GAME.ROOM_STOP_BET, this._onStopBet, this);
s.default.Instance.Net.bind(r.S2C.GAME.ROOM_SHOW, this._onShow, this);
s.default.Instance.Net.bind(r.S2C.GAME.ROOM_RESET_ROOM, this._onResetRoom, this);
s.default.Instance.Net.bind(r.S2C.GAME.ROOM_AUTOPLAY, this._onAutoPlay, this);
s.default.Instance.Net.bind(r.S2C.GAME.ROOM_REPEAT_BET, this._onRepeatBet, this);
s.default.Instance.Net.bind(r.S2C.GAME.ROOM_GET_JACKPOT_HISTORY, this._onGetJackPotHistory, this);
s.default.Instance.Net.bind(r.S2C.GAME.ROOM_USER_RECORD, this._onUserRecord, this);
s.default.Instance.Net.bind(r.S2C.GAME.ROOM_BIGWINNER_RECORD, this._onBigWinnerRecord, this);
s.default.Instance.Net.bind(r.S2C.GAME.ROOM_INTERACT, this._onInteract, this);
s.default.Instance.Net.bind(r.S2C.GAME.ROOM_LEAVE, this._onLeave, this);
s.default.Instance.Net.bind(r.S2C.GAME.ROOM_LEAVE_SINGLE, this._onLeaveSingle, this);
s.default.Instance.Net.bind(r.S2C.GAME.ROOM_DISMISS, this._onDismiss, this);
s.default.Instance.Net.bind(r.S2C.GAME.ROOM_SEND_AVAILABLE_BALANCE, this._onBalanceRefresh, this);
s.default.Instance.Global.bind(_.NetState.NET_WEBSOCKET_CONNECT_OPEN, this._onWsContented, this);
};
e.prototype.destory = function() {
s.default.Instance.Net.unbind(r.S2C.GAME.ROOM_ENTER_ROOM, this._onEnterRoom, this);
s.default.Instance.Net.unbind(r.S2C.GAME.ROOM_SWITCH_ROOM, this._onSwitchRoom, this);
s.default.Instance.Net.unbind(r.S2C.GAME.ROOM_DEAL, this._onDeal, this);
s.default.Instance.Net.unbind(r.S2C.GAME.ROOM_START_BET, this._onStartBet, this);
s.default.Instance.Net.unbind(r.S2C.GAME.ROOM_BET, this._onBet, this);
s.default.Instance.Net.unbind(r.S2C.GAME.ROOM_BET_BATCH, this._onBetBatch, this);
s.default.Instance.Net.unbind(r.S2C.GAME.ROOM_STOP_BET, this._onStopBet, this);
s.default.Instance.Net.unbind(r.S2C.GAME.ROOM_SHOW, this._onShow, this);
s.default.Instance.Net.unbind(r.S2C.GAME.ROOM_RESET_ROOM, this._onResetRoom, this);
s.default.Instance.Net.unbind(r.S2C.GAME.ROOM_AUTOPLAY, this._onAutoPlay, this);
s.default.Instance.Net.unbind(r.S2C.GAME.ROOM_REPEAT_BET, this._onRepeatBet, this);
s.default.Instance.Net.unbind(r.S2C.GAME.ROOM_GET_JACKPOT_HISTORY, this._onGetJackPotHistory, this);
s.default.Instance.Net.unbind(r.S2C.GAME.ROOM_USER_RECORD, this._onUserRecord, this);
s.default.Instance.Net.unbind(r.S2C.GAME.ROOM_BIGWINNER_RECORD, this._onBigWinnerRecord, this);
s.default.Instance.Net.unbind(r.S2C.GAME.ROOM_INTERACT, this._onInteract, this);
s.default.Instance.Net.unbind(r.S2C.GAME.ROOM_LEAVE, this._onLeave, this);
s.default.Instance.Net.unbind(r.S2C.GAME.ROOM_LEAVE_SINGLE, this._onLeaveSingle, this);
s.default.Instance.Net.unbind(r.S2C.GAME.ROOM_DISMISS, this._onDismiss, this);
s.default.Instance.Net.unbind(r.S2C.GAME.ROOM_SEND_AVAILABLE_BALANCE, this._onBalanceRefresh, this);
s.default.Instance.Global.unbind(_.NetState.NET_WEBSOCKET_CONNECT_OPEN, this._onWsContented, this);
this.clear();
};
e.prototype.clear = function() {
this._recordCount = 10;
this.jackPotPage = 0;
this._jackPotTotal = 10;
this.userPage = 0;
this._userTotal = 10;
this.winnerPage = 0;
this._winnerTotal = 10;
this.isOpenWindow = !1;
};
e.prototype._onWsContented = function() {
d.default.Instance.begin();
var e = c.VM.getValue("lobby.roomIDFast");
0 != e && this.sendEnterRoom(e);
};
Object.defineProperty(e.prototype, "roomID", {
get: function() {
return c.VM.getValue("lobby.roomIDFast");
},
enumerable: !1,
configurable: !0
});
Object.defineProperty(e.prototype, "uid", {
get: function() {
return c.VM.getValue("user.uid");
},
enumerable: !1,
configurable: !0
});
Object.defineProperty(e.prototype, "token", {
get: function() {
return c.VM.getValue("user.token");
},
enumerable: !1,
configurable: !0
});
e.prototype.checkRoomID = function(e) {
return e == this.cls;
};
e.prototype.checkRoomType = function(e) {
var t = e.split("_"), o = -1;
null != t && null != t[0] && (o = parseInt(t[0]));
return o == a.GameEnum.PlayType.GAME_RB_FAST;
};
e.prototype._onEnterRoom = function(e) {
var t = e.getUserData();
if (this.checkRoomID(t.cls)) {
var o = v.Instance;
o.sTime = t.stime;
o.bet_fee_currency = t.bet_fee_currency;
o.bet_options = t.bet_options;
o.refreshUserData(t.user_data);
o.declearHistory.refresh(t.declear_history);
s.default.Instance.Global.emit(y.LotoFastUIEvent.UI_INIT_ODDS_AMOUNT);
o.roomData.refresh(t.room_data);
o.refreshRoomRecord(t.bet_data);
o.bet_limit = l.Tools.TNumber.num2single(t.bet_limit);
null != t.declear_data && o.declearData.refresh(t.declear_data);
o.deal_card = t.room_data.deal_card;
o.show_card = t.room_data.show_card;
o.win_options = t.win_options;
t.bigwinner_info ? o.bigWinnerData.refresh(t.bigwinner_info) : t.bigwinner_info = null;
o.jackpot_total_pool = l.Tools.TNumber.numFixed(l.Tools.TNumber.num2single(t.jackpot_total_pool), 2);
o.jackpot_time = t.stime - t.last_jackpot_time;
o.jackpot_round = t.last_jackpot_round;
s.default.Instance.Global.emit(y.LotoFastUIEvent.UI_JACKPOT_REFRESH_TIME, {
startTime: o.jackpot_time
});
s.default.Instance.Global.emit(y.LotoFastUIEvent.UI_JACKPOT_REFRESH_MONEY, {
money: o.jackpot_total_pool
});
s.default.Instance.Global.emit(y.LotoFastGameEvent.GAME_RECONNECT, t.uid);
s.default.Instance.Global.emit(y.LotoFastEvent.S2C_ENTER_ROOM_FAST, t.uid);
}
};
e.prototype._onSwitchRoom = function(e) {
var t = e.getUserData();
if (this.checkRoomType(t.room_type)) {
c.VM.getValue("lobby.roomIDFast") != t.r && c.VM.setValue("lobby.roomIDFast", parseInt(t.r));
s.default.Instance.Global.emit(y.LotoFastEvent.S2C_SWITCH_ROOM_FAST, t.r);
}
};
e.prototype._onDeal = function(e) {
var t = e.getUserData();
if (this.checkRoomID(t.cls)) {
var o = v.Instance;
o.sTime = t.stime;
o.roomData.refresh(t.room_data);
o.refreshUserData(t.user_data);
o.deal_card = t.room_data.deal_card;
o.show_card = t.room_data.show_card;
o.declearData = null;
o.declearData = new g.LotoFastStruct.DeclearData();
s.default.Instance.Global.emit(y.LotoFastEvent.S2C_DEAL_FAST, {
wildCard: o.deal_card[0]
});
}
};
e.prototype._onStartBet = function(e) {
var t = e.getUserData();
if (this.checkRoomID(t.cls)) {
var o = v.Instance;
o.sTime = t.stime;
o.roomData.refresh(t.room_data);
o.deal_card = t.room_data.deal_card;
o.show_card = t.room_data.show_card;
s.default.Instance.Global.emit(y.LotoFastUIEvent.UI_EFFECT_START_BET);
}
};
e.prototype._onBet = function(e) {
var t = e.getUserData();
if (this.checkRoomID(t.cls) && null != t.bet_user && t.bet_user.uid == this.uid) {
var o = v.Instance;
o.sTime = t.stime;
if (null != t.bet_err && 1 == t.bet_err) {
var n = l.Tools.TNumber.num2single(t.bet_total);
s.default.Instance.Global.emit(y.LotoFastEvent.TABLE_REPEAT_BET_ERROR, {
bet_total: n
});
} else {
o.refreshRoomRecord(t.bet_data);
o.refreshPlayerRecord(t.bet_user.bet_record);
o.total_fee = l.Tools.TNumber.num2single(t.bet_user.total_fee);
o.userData.total_fee = l.Tools.TNumber.num2single(t.bet_user.total_fee);
o.userData.auto = t.bet_user.auto;
o.userData.repeat = t.bet_user.repeat;
var a = g.LotoFastStruct.getBetRecordArray(t.bet_user.bet_batch_data);
s.default.Instance.Global.emit(y.LotoFastEvent.S2C_BET_FAST, {
bet_batch_data: a,
uid: t.bet_user.uid
});
o.jackpot_total_pool = l.Tools.TNumber.numFixed(l.Tools.TNumber.num2single(t.jackpot_total_pool), 2);
s.default.Instance.Global.emit(y.LotoFastUIEvent.UI_JACKPOT_REFRESH_MONEY, {
money: o.jackpot_total_pool
});
}
}
};
e.prototype._onBetBatch = function(e) {
var t = e.getUserData();
if (this.checkRoomID(t.cls)) {
var o = v.Instance;
o.sTime = t.stime;
o.refreshRoomRecord(t.bet_data);
var n = g.LotoFastStruct.getBetRecordArray(t.bet_batch_data);
o.jackpot_total_pool = l.Tools.TNumber.numFixed(l.Tools.TNumber.num2single(t.jackpot_total_pool), 2);
s.default.Instance.Global.emit(y.LotoFastUIEvent.UI_JACKPOT_REFRESH_MONEY, {
money: o.jackpot_total_pool
});
s.default.Instance.Global.emit(y.LotoFastEvent.S2C_BET_BATCH_FAST, n);
}
};
e.prototype._onStopBet = function(e) {
var t = e.getUserData();
if (this.checkRoomID(t.cls)) {
var o = v.Instance;
o.sTime = t.stime;
o.roomData.refresh(t.room_data);
o.deal_card = t.room_data.deal_card;
o.show_card = t.room_data.show_card;
s.default.Instance.Global.emit(y.LotoFastUIEvent.UI_EFFECT_STOP_BET);
}
};
e.prototype._onShow = function(e) {
var t = e.getUserData();
if (this.checkRoomID(t.cls)) {
var o = v.Instance, n = new g.LotoFastStruct.HistoryData({
d: t.room_data.show_card
});
o.declearHistory.addHistory(n);
o.sTime = t.stime;
o.roomData.refresh(t.room_data);
o.deal_card = t.room_data.deal_card;
o.show_card = t.room_data.show_card;
o.win_options = t.win_options;
o.refreshRoomRecord(t.bet_data);
o.declearData.refresh(t.declear_data);
if (f.TeenPattiCheckTools.checkCardType(t.room_data.show_card) == f.TeenPattiCardType.Trail) {
o.jackpot_time = 0;
o.jackpot_round = 0;
setTimeout(function() {
s.default.Instance.Global.emit(y.LotoFastUIEvent.UI_JACKPOT_REFRESH_TIME, {
startTime: o.jackpot_time
});
}, 2e3);
} else o.jackpot_round++;
s.default.Instance.Global.emit(y.LotoFastEvent.S2C_SHOW_FAST);
}
};
e.prototype._onResetRoom = function(e) {
var t = e.getUserData();
if (this.checkRoomID(t.cls)) {
var o = v.Instance;
o.sTime = t.stime;
o.roomData.refresh(t.room_data);
o.refreshUserData(t.user_data);
o.deal_card = t.room_data.deal_card;
o.show_card = t.room_data.show_card;
t.bigwinner_info ? o.bigWinnerData.refresh(t.bigwinner_info) : t.bigwinner_info = null;
null != t.kick_data && null != t.kick_data[this.uid] && (o.userData.auto = !1);
o.jackpot_total_pool = l.Tools.TNumber.numFixed(l.Tools.TNumber.num2single(t.jackpot_total_pool), 2);
s.default.Instance.Global.emit(y.LotoFastUIEvent.UI_JACKPOT_REFRESH_MONEY, {
money: o.jackpot_total_pool
});
s.default.Instance.Global.emit(y.LotoFastEvent.S2C_RESET_FAST);
}
};
e.prototype._onAutoPlay = function(e) {
var t = e.getUserData();
if (this.checkRoomID(t.cls)) {
var o = v.Instance;
o.sTime = t.stime;
o.refreshUserData(t.user_data);
s.default.Instance.Global.emit(y.LotoFastEvent.S2C_AUTO_PLAY_FAST);
}
};
e.prototype._onRepeatBet = function(e) {
var t = e.getUserData();
if (this.checkRoomID(t.cls)) {
var o = v.Instance;
o.sTime = t.stime;
if (null != t.bet_err && 1 == t.bet_err) {
var n = l.Tools.TNumber.num2single(t.bet_total);
s.default.Instance.Global.emit(y.LotoFastEvent.TABLE_REPEAT_BET_ERROR, {
bet_total: n
});
} else {
o.refreshUserData(t.user_data);
o.refreshRoomRecord(t.bet_data);
s.default.Instance.Global.emit(y.LotoFastEvent.S2C_REPEAT_BET_FAST);
}
}
};
e.prototype._onGetJackPotHistory = function(e) {
var t = e.getUserData();
if (this.checkRoomID(t.cls)) {
var o = v.Instance;
o.sTime = t.stime;
t.total >= 10 && (this._jackPotTotal = t.total);
t.page_data.forEach(function(e) {
var t = new g.LotoFastStruct.JackPotRecord(e);
o.jackpot_record.push(t);
});
s.default.Instance.Global.emit(y.LotoFastEvent.S2C_JACKPOT_RECORD_FAST);
}
};
e.prototype._onUserRecord = function(e) {
var t = e.getUserData();
if (this.checkRoomID(t.cls)) {
var o = v.Instance;
o.sTime = t.stime;
t.total >= 10 && (this._userTotal = t.total);
t.page_data.forEach(function(e) {
var t = new g.LotoFastStruct.UserRecord(e);
o.user_record.push(t);
});
s.default.Instance.Global.emit(y.LotoFastEvent.S2C_USER_RECORD_FAST);
}
};
e.prototype._onBigWinnerRecord = function(e) {
var t = e.getUserData();
if (this.checkRoomID(t.cls)) {
var o = v.Instance;
o.sTime = t.stime;
t.total >= 10 && (this._winnerTotal = t.total);
t.page_data.forEach(function(e) {
var t = new g.LotoFastStruct.BigWinnerRecord(e);
o.big_winner_record.push(t);
});
s.default.Instance.Global.emit(y.LotoFastEvent.S2C_WINNER_RECORD_FAST);
}
};
e.prototype._onInteract = function(e) {
var t = e.getUserData();
this.checkRoomID(t.cls) && s.default.Instance.Global.emit(y.LotoFastEvent.S2C_INTERACT_FAST, t);
};
e.prototype._onLeave = function(e) {
var t = e.getUserData();
if (this.checkRoomID(t.cls)) {
v.Instance.sTime = t.stime;
s.default.Instance.Global.emit(y.LotoFastEvent.S2C_LEAVE_FAST);
}
};
e.prototype._onLeaveSingle = function(e) {
var t = e.getUserData();
if (this.checkRoomID(t.cls) || 0 == c.VM.getValue("lobby.roomIDFast")) {
v.Instance.sTime = t.stime;
s.default.Instance.Global.emit(y.LotoFastEvent.S2C_LEAVE_SINGLE_FAST, t);
}
};
e.prototype._onDismiss = function(e) {
var t = e.getUserData();
if (this.checkRoomID(t.cls)) {
var o = v.Instance;
o.userData && (o.userData.auto = !1);
s.default.Instance.Global.emit(y.LotoFastEvent.S2C_DISMISS_ROOM_FAST, t);
}
};
e.prototype._onBalanceRefresh = function(e) {
var t = e.getUserData();
if (!this.checkRoomID(t.rid)) {
var o = v.Instance, a = l.Tools.TNumber.num2single(t.total_fee);
o.total_fee = a;
o.userData && (o.userData.total_fee = a);
h.WalletProxy.Instance.refreshWallet(t);
s.default.Instance.Global.emit(n.GameEvent.S2C_SEND_AVAILABLE_BALANCE);
}
};
e.prototype.sendEnterRoom = function(e) {
var t = _.default.Instance.makeMsg(i.C2S.ROOM_ENTER_ROOM, {
u: this.uid,
t: this.token,
r: e,
is_open: this.isOpenWindow
});
_.default.Instance.send(t);
};
e.prototype.sendBet = function(e, t) {
var o = l.Tools.TNumber.num2thousand(e);
p.default.Instance.CompositeBetNum = e;
var n = _.default.Instance.makeMsg(i.C2S.ROOM_BET, {
u: this.uid,
t: this.token,
r: this.roomID,
fee: o,
option: t
});
_.default.Instance.send(n);
};
e.prototype.sendAutoPlay = function() {
var e = _.default.Instance.makeMsg(i.C2S.ROOM_AUTOPLAY, {
u: this.uid,
t: this.token,
r: this.roomID
});
_.default.Instance.send(e);
};
e.prototype.sendRepeatBet = function() {
var e = _.default.Instance.makeMsg(i.C2S.ROOM_REPEAT_BET, {
u: this.uid,
t: this.token,
r: this.roomID
});
_.default.Instance.send(e);
};
e.prototype.sendJackPotRecord = function() {
if (Math.ceil(this._jackPotTotal / this._recordCount) >= this.jackPotPage + 1) {
this.jackPotPage++;
var e = _.default.Instance.makeMsg(i.C2S.ROOM_GET_JACKPOT_HISTORY, {
u: this.uid,
t: this.token,
r: this.roomID,
page: this.jackPotPage,
count: this._recordCount
});
_.default.Instance.send(e);
}
};
e.prototype.sendUserRecord = function() {
if (0 == this._userTotal || Math.ceil(this._userTotal / this._recordCount) >= this.userPage + 1) {
this.userPage++;
var e = _.default.Instance.makeMsg(i.C2S.ROOM_USER_RECORD, {
u: this.uid,
t: this.token,
r: this.roomID,
page: this.userPage,
count: this._recordCount
});
_.default.Instance.send(e);
}
};
e.prototype.sendWinnerRecord = function() {
if (Math.ceil(this._winnerTotal / this._recordCount) >= this.winnerPage + 1) {
this.winnerPage++;
var e = _.default.Instance.makeMsg(i.C2S.ROOM_BIGWINNER_RECORD, {
u: this.uid,
t: this.token,
r: this.roomID,
page: this.winnerPage,
count: this._recordCount
});
_.default.Instance.send(e);
}
};
e.prototype.sendInteract = function(e, t, o) {
var n;
n = o ? {
u: this.uid,
t: this.token,
r: this.roomID,
to_u: e,
opt_type: t,
opt_val: o
} : {
u: this.uid,
t: this.token,
r: this.roomID,
to_u: e,
opt_type: t
};
var a = _.default.Instance.makeMsg(i.C2S.ROOM_INTERACT, n);
_.default.Instance.send(a);
};
e.prototype.sendRank = function(e, t) {
var o = _.default.Instance.makeMsg(i.C2S.ROOM_RANK, {
u: this.uid,
t: this.token,
r: this.roomID,
page: e,
count: t
});
_.default.Instance.send(o);
};
e.prototype.sendLeave = function() {
var e = _.default.Instance.makeMsg(i.C2S.ROOM_LEAVE, {
u: this.uid,
t: this.token,
r: this.roomID
});
_.default.Instance.send(e);
};
e._instance = null;
return e;
}();
o.default = C;
cc._RF.pop();
}, {
"../../../Game/client/global/enum/game/Event": "Event",
"../../../Game/client/global/enum/game/Game": "Game",
"../../../Game/client/global/enum/net/C2S": "C2S",
"../../../Game/client/global/enum/net/S2C": "S2C",
"../../../Game/fromework/global/Tools": "Tools",
"../../../Game/fromework/helper/EventHelper": "EventHelper",
"../../../Game/fromework/mvvm/modelView/ViewModel": "ViewModel",
"../../../client/logic/game/HearBeat": "HearBeat",
"../../../client/model/ErrorModel": "ErrorModel",
"../../../client/model/WalletModel": "WalletModel",
"../../../client/teenpatti/model/TeenPattiStruct": "TeenPattiStruct",
"../../../fromework/helper/NetHelper": "NetHelper",
"../../../platform/Platform": "Platform",
"../../Common/Utils/CompositeConst": "CompositeConst",
"./LotoFastEvent": "LotoFastEvent",
"./LotoFastStruct": "LotoFastStruct"
} ],
LotoFastOdds: [ function(e, t, o) {
"use strict";
cc._RF.push(t, "24fdcnblhdMTazo92wMasuc", "LotoFastOdds");
var n, a = this && this.__extends || (n = function(e, t) {
return (n = Object.setPrototypeOf || {
__proto__: []
} instanceof Array && function(e, t) {
e.__proto__ = t;
} || function(e, t) {
for (var o in t) Object.prototype.hasOwnProperty.call(t, o) && (e[o] = t[o]);
})(e, t);
}, function(e, t) {
n(e, t);
function o() {
this.constructor = e;
}
e.prototype = null === t ? Object.create(t) : (o.prototype = t.prototype, new o());
}), i = this && this.__decorate || function(e, t, o, n) {
var a, i = arguments.length, r = i < 3 ? t : null === n ? n = Object.getOwnPropertyDescriptor(t, o) : n;
if ("object" == typeof Reflect && "function" == typeof Reflect.decorate) r = Reflect.decorate(e, t, o, n); else for (var l = e.length - 1; l >= 0; l--) (a = e[l]) && (r = (i < 3 ? a(r) : i > 3 ? a(t, o, r) : a(t, o)) || r);
return i > 3 && r && Object.defineProperty(t, o, r), r;
};
Object.defineProperty(o, "__esModule", {
value: !0
});
var r = e("../../../Game/client/global/enum/game/UIUtils"), l = e("../../../Game/client/model/LanguageModel"), s = e("../../../Game/fromework/helper/EventHelper"), c = e("./LotoFastEvent"), u = e("./LotoFastModel"), d = cc._decorator, p = d.ccclass, h = d.property, f = function(e) {
a(t, e);
function t() {
var t = null !== e && e.apply(this, arguments) || this;
t.Index = 0;
t.AllAmount = null;
t.Amount = null;
t.BetButton = null;
t.Rate = null;
t.LightNodes = [];
return t;
}
t.prototype.onEnable = function() {
s.default.Instance.Global.bind(c.LotoFastGameEvent.GAME_RECONNECT, this.onReconnect, this);
s.default.Instance.Global.bind(c.LotoFastEvent.S2C_DEAL_FAST, this.onDeal, this);
s.default.Instance.Global.bind(c.LotoFastEvent.S2C_BET_BATCH_FAST, this.onBetAll, this);
s.default.Instance.Global.bind(c.LotoFastOddsEvent.ODDS_BET_CHANGED_SELF, this.onBetSelf, this);
s.default.Instance.Global.bind(c.LotoFastUIEvent.UI_ODDS_SHOW_WIN, this.onShow, this);
s.default.Instance.Global.bind(c.LotoFastEvent.S2C_RESET_FAST, this.onReset, this);
};
t.prototype.onDisable = function() {
s.default.Instance.Global.unbind(c.LotoFastGameEvent.GAME_RECONNECT, this.onReconnect, this);
s.default.Instance.Global.unbind(c.LotoFastEvent.S2C_DEAL_FAST, this.onDeal, this);
s.default.Instance.Global.unbind(c.LotoFastEvent.S2C_BET_BATCH_FAST, this.onBetAll, this);
s.default.Instance.Global.unbind(c.LotoFastOddsEvent.ODDS_BET_CHANGED_SELF, this.onBetSelf, this);
s.default.Instance.Global.unbind(c.LotoFastUIEvent.UI_ODDS_SHOW_WIN, this.onShow, this);
s.default.Instance.Global.unbind(c.LotoFastEvent.S2C_RESET_FAST, this.onReset, this);
};
t.prototype.setAllAmount = function(e) {
this.AllAmount.string = l.default.getString("MoneySymbol") + e;
};
t.prototype.setAmount = function(e) {
this.Amount.string = l.default.getString("MoneySymbol") + e;
};
t.prototype.setLight = function(e, t) {
void 0 === t && (t = 255);
this.LightNodes.forEach(function(o) {
o.active = e;
o.opacity = t;
});
};
t.prototype.playTwinkle = function() {
this.LightNodes.forEach(function(e) {
var t = cc.tween(e).to(.5, {
opacity: 255
}).to(.5, {
opacity: 0
});
cc.tween(e).then(t).repeat(2).to(.5, {
opacity: 255
}).start();
});
};
t.prototype.setButton = function(e) {
r.UIUtils.setGray(this.BetButton, e, !0);
this.BetButton.getComponent(cc.Button).interactable = !e;
};
t.prototype.onReconnect = function() {
var e = u.LotoFastModel.Instance;
0 == this.Index ? this.Rate.string = l.default.getString("LOTO_JACKPOT_LINE_FEED") + e.bet_options[this.Index].x + "%" : this.Rate.string = e.bet_options[this.Index].x + "X";
if (2 == e.roomData.state) {
var t = e.roomBetRecord[this.Index] ? e.roomBetRecord[this.Index].amount : 0, o = e.playerBetRecord[this.Index] ? e.playerBetRecord[this.Index].amount : 0;
this.setAllAmount(t);
this.setAmount(o);
this.setLight(!1);
this.setButton(!1);
} else if (3 == e.roomData.state) {
var n = e.win_options.indexOf(this.Index) >= 0;
this.setLight(n);
this.setButton(!n);
} else this.onReset();
};
t.prototype.onDeal = function() {
this.setAllAmount(0);
this.setAmount(0);
this.setLight(!1);
this.setButton(!1);
};
t.prototype.onBetAll = function() {
var e = u.LotoFastModel.Instance, t = e.roomBetRecord[this.Index] ? e.roomBetRecord[this.Index].amount : 0;
this.setAllAmount(t);
};
t.prototype.onBetSelf = function(e) {
var t = e.getUserData();
t.index == this.Index && this.setAmount(t.self);
};
t.prototype.onShow = function() {
var e = u.LotoFastModel.Instance.win_options.indexOf(this.Index) >= 0;
this.setLight(e, 0);
this.setButton(!e);
this.playTwinkle();
};
t.prototype.onReset = function() {};
t.prototype.onBetClicked = function() {
s.default.Instance.Global.emit(c.LotoFastOddsEvent.ODDS_BET_BUTTON_CLICK, {
index: this.Index
});
};
i([ h(cc.Integer) ], t.prototype, "Index", void 0);
i([ h(cc.Label) ], t.prototype, "AllAmount", void 0);
i([ h(cc.Label) ], t.prototype, "Amount", void 0);
i([ h(cc.Node) ], t.prototype, "BetButton", void 0);
i([ h(cc.Label) ], t.prototype, "Rate", void 0);
i([ h([ cc.Node ]) ], t.prototype, "LightNodes", void 0);
return i([ p ], t);
}(cc.Component);
o.default = f;
cc._RF.pop();
}, {
"../../../Game/client/global/enum/game/UIUtils": "UIUtils",
"../../../Game/client/model/LanguageModel": "LanguageModel",
"../../../Game/fromework/helper/EventHelper": "EventHelper",
"./LotoFastEvent": "LotoFastEvent",
"./LotoFastModel": "LotoFastModel"
} ],
LotoFastRecordAlert: [ function(e, t, o) {
"use strict";
cc._RF.push(t, "c4973uBrLZCoLfE9r5wG3sd", "LotoFastRecordAlert");
var n, a = this && this.__extends || (n = function(e, t) {
return (n = Object.setPrototypeOf || {
__proto__: []
} instanceof Array && function(e, t) {
e.__proto__ = t;
} || function(e, t) {
for (var o in t) Object.prototype.hasOwnProperty.call(t, o) && (e[o] = t[o]);
})(e, t);
}, function(e, t) {
n(e, t);
function o() {
this.constructor = e;
}
e.prototype = null === t ? Object.create(t) : (o.prototype = t.prototype, new o());
}), i = this && this.__decorate || function(e, t, o, n) {
var a, i = arguments.length, r = i < 3 ? t : null === n ? n = Object.getOwnPropertyDescriptor(t, o) : n;
if ("object" == typeof Reflect && "function" == typeof Reflect.decorate) r = Reflect.decorate(e, t, o, n); else for (var l = e.length - 1; l >= 0; l--) (a = e[l]) && (r = (i < 3 ? a(r) : i > 3 ? a(t, o, r) : a(t, o)) || r);
return i > 3 && r && Object.defineProperty(t, o, r), r;
};
Object.defineProperty(o, "__esModule", {
value: !0
});
var r = e("../../../Game/fromework/global/Tools"), l = e("../../../Game/fromework/helper/EventHelper"), s = e("../../../Game/fromework/helper/UIHelper"), c = e("../../../fromework/component/listView/ListView"), u = e("./LotoFastEvent"), d = e("./LotoFastModel"), p = [ "SET", "PURE %{rate}X", "SEQ %{rate}X", "COLOR %{rate}X", "PAIR %{rate}X", "HIGH CARD %{rate}X" ], h = cc._decorator, f = h.ccclass, _ = h.property, m = function(e) {
a(t, e);
function t() {
var t = null !== e && e.apply(this, arguments) || this;
t.Toggles = [];
t.JackPotRecord = null;
t.UserRecord = null;
t.WinnerRecord = null;
t.JackPotList = null;
t.UserList = null;
t.WinnerList = null;
t.UserListNone = null;
t.MyListRates = [];
t._curType = -1;
return t;
}
t.prototype.onEnable = function() {
l.default.Instance.Global.bind(u.LotoFastEvent.S2C_JACKPOT_RECORD_FAST, this.refreshJackPot, this);
l.default.Instance.Global.bind(u.LotoFastEvent.S2C_USER_RECORD_FAST, this.refreshUser, this);
l.default.Instance.Global.bind(u.LotoFastEvent.S2C_WINNER_RECORD_FAST, this.refreshWinner, this);
this.JackPotList.node.on("scroll-to-bottom", this.loadMoreJackPotPage, this);
this.UserList.node.on("scroll-to-bottom", this.loadMoreUserPage, this);
this.WinnerList.node.on("scroll-to-bottom", this.loadMoreWinnerPage, this);
};
t.prototype.onDisable = function() {
l.default.Instance.Global.unbind(u.LotoFastEvent.S2C_JACKPOT_RECORD_FAST, this.refreshJackPot, this);
l.default.Instance.Global.unbind(u.LotoFastEvent.S2C_USER_RECORD_FAST, this.refreshUser, this);
l.default.Instance.Global.unbind(u.LotoFastEvent.S2C_WINNER_RECORD_FAST, this.refreshWinner, this);
this.JackPotList.node.off("scroll-to-bottom", this.loadMoreJackPotPage, this);
this.UserList.node.off("scroll-to-bottom", this.loadMoreUserPage, this);
this.WinnerList.node.off("scroll-to-bottom", this.loadMoreWinnerPage, this);
};
t.prototype.onLoad = function() {
for (var e = d.LotoFastModel.Instance, t = 0; t < this.MyListRates.length; t++) {
var o = this.MyListRates[t];
o && o.isValid && (o.string = r.Tools.TStr.replaceAll(p[t], "%{rate}", e.bet_options[t].x));
}
};
t.prototype.InitView = function(e) {
if (null == e || 0 == e) {
this.Toggles[0].isChecked = !0;
this.onJackPotRecordClicked();
} else if (1 == e) {
this.Toggles[1].isChecked = !0;
this.onUserRecordClicked();
} else if (2 == e) {
this.Toggles[2].isChecked = !0;
this.onWinnerRecordClicked();
}
};
t.prototype.loadMoreJackPotPage = function() {
d.default.Instance.sendJackPotRecord();
};
t.prototype.loadMoreUserPage = function() {
d.default.Instance.sendUserRecord();
};
t.prototype.loadMoreWinnerPage = function() {
d.default.Instance.sendWinnerRecord();
};
t.prototype.refreshJackPot = function() {
var e = d.LotoFastModel.Instance;
this.JackPotList.datas = e.jackpot_record.concat();
};
t.prototype.refreshUser = function() {
var e = d.LotoFastModel.Instance.user_record.concat();
this.UserList.datas = e;
this.UserListNone.active = 0 == e.length;
};
t.prototype.refreshWinner = function() {
var e = d.LotoFastModel.Instance;
this.WinnerList.datas = e.big_winner_record.concat();
};
t.prototype.onJackPotRecordClicked = function() {
if (0 != this._curType) {
this._curType = 0;
var e = d.LotoFastModel.Instance;
this.JackPotRecord.active = !0;
this.UserRecord.active = !1;
this.WinnerRecord.active = !1;
d.default.Instance.userPage = 0;
e.user_record.splice(0);
d.default.Instance.winnerPage = 0;
e.big_winner_record.splice(0);
d.default.Instance.sendJackPotRecord();
}
};
t.prototype.onUserRecordClicked = function() {
if (1 != this._curType) {
this._curType = 1;
var e = d.LotoFastModel.Instance;
this.JackPotRecord.active = !1;
this.UserRecord.active = !0;
this.WinnerRecord.active = !1;
d.default.Instance.jackPotPage = 0;
e.jackpot_record.splice(0);
d.default.Instance.winnerPage = 0;
e.big_winner_record.splice(0);
d.default.Instance.sendUserRecord();
}
};
t.prototype.onWinnerRecordClicked = function() {
if (2 != this._curType) {
this._curType = 2;
var e = d.LotoFastModel.Instance;
this.JackPotRecord.active = !1;
this.UserRecord.active = !1;
this.WinnerRecord.active = !0;
d.default.Instance.jackPotPage = 0;
e.jackpot_record.splice(0);
d.default.Instance.userPage = 0;
e.user_record.splice(0);
d.default.Instance.sendWinnerRecord();
}
};
t.prototype.onCloseClicked = function() {
var e = d.LotoFastModel.Instance;
d.default.Instance.jackPotPage = 0;
e.jackpot_record.splice(0);
d.default.Instance.userPage = 0;
e.user_record.splice(0);
d.default.Instance.winnerPage = 0;
e.big_winner_record.splice(0);
s.default.Instance.removeMaskLayer(this.node, !0);
};
i([ _([ cc.Toggle ]) ], t.prototype, "Toggles", void 0);
i([ _(cc.Node) ], t.prototype, "JackPotRecord", void 0);
i([ _(cc.Node) ], t.prototype, "UserRecord", void 0);
i([ _(cc.Node) ], t.prototype, "WinnerRecord", void 0);
i([ _(c.default) ], t.prototype, "JackPotList", void 0);
i([ _(c.default) ], t.prototype, "UserList", void 0);
i([ _(c.default) ], t.prototype, "WinnerList", void 0);
i([ _(cc.Node) ], t.prototype, "UserListNone", void 0);
i([ _([ cc.Label ]) ], t.prototype, "MyListRates", void 0);
return i([ f ], t);
}(cc.Component);
o.default = m;
cc._RF.pop();
}, {
"../../../Game/fromework/global/Tools": "Tools",
"../../../Game/fromework/helper/EventHelper": "EventHelper",
"../../../Game/fromework/helper/UIHelper": "UIHelper",
"../../../fromework/component/listView/ListView": "ListView",
"./LotoFastEvent": "LotoFastEvent",
"./LotoFastModel": "LotoFastModel"
} ],
LotoFastRecordSmall: [ function(e, t, o) {
"use strict";
cc._RF.push(t, "684f05aO0RJP4vwg02zcWIm", "LotoFastRecordSmall");
var n, a = this && this.__extends || (n = function(e, t) {
return (n = Object.setPrototypeOf || {
__proto__: []
} instanceof Array && function(e, t) {
e.__proto__ = t;
} || function(e, t) {
for (var o in t) Object.prototype.hasOwnProperty.call(t, o) && (e[o] = t[o]);
})(e, t);
}, function(e, t) {
n(e, t);
function o() {
this.constructor = e;
}
e.prototype = null === t ? Object.create(t) : (o.prototype = t.prototype, new o());
}), i = this && this.__decorate || function(e, t, o, n) {
var a, i = arguments.length, r = i < 3 ? t : null === n ? n = Object.getOwnPropertyDescriptor(t, o) : n;
if ("object" == typeof Reflect && "function" == typeof Reflect.decorate) r = Reflect.decorate(e, t, o, n); else for (var l = e.length - 1; l >= 0; l--) (a = e[l]) && (r = (i < 3 ? a(r) : i > 3 ? a(t, o, r) : a(t, o)) || r);
return i > 3 && r && Object.defineProperty(t, o, r), r;
};
Object.defineProperty(o, "__esModule", {
value: !0
});
var r = e("../../../Game/client/global/enum/game/Const"), l = e("../../../Game/fromework/global/Tools"), s = e("../../../Game/fromework/helper/EventHelper"), c = e("../../../Game/fromework/helper/UIHelper"), u = e("../../../client/global/PopHelper"), d = e("../../../client/teenpatti/model/TeenPattiStruct"), p = e("../../RedAndBlackFast/Script/RBFastEvent"), h = e("./LotoFastModel"), f = cc._decorator, _ = f.ccclass, m = f.property, y = function(e) {
a(t, e);
function t() {
var t = null !== e && e.apply(this, arguments) || this;
t.TopRecordParent = null;
t.TopRecordItem = null;
t.winCountAll = null;
t.winCounts = [];
t.Light = null;
t.Frames_Item = [];
t.Color_SET = cc.Color.WHITE;
t.Color_PURE = cc.Color.WHITE;
t.Color_SEQ = cc.Color.WHITE;
t.Color_COLOR = cc.Color.WHITE;
t.Color_PAIR = cc.Color.WHITE;
t.Color_HIGH = cc.Color.WHITE;
t.MaxCount = 11;
return t;
}
t.prototype.onEnable = function() {
s.default.Instance.Global.bind(p.RBFastEvent.S2C_ENTER_ROOM_FAST, this._onEnterRoom, this);
s.default.Instance.Global.bind(p.RBFastEvent.S2C_DEAL_FAST, this._onDeal, this);
};
t.prototype.onDisable = function() {
s.default.Instance.Global.unbind(p.RBFastEvent.S2C_ENTER_ROOM_FAST, this._onEnterRoom, this);
s.default.Instance.Global.unbind(p.RBFastEvent.S2C_DEAL_FAST, this._onDeal, this);
};
t.prototype.onLoad = function() {
this.refreshTopLabel();
this.refreshTopRecord(!1);
};
t.prototype._onEnterRoom = function() {
this.refreshTopLabel();
this.refreshTopRecord(!1);
};
t.prototype._onDeal = function() {
this.refreshTopLabel();
this.refreshTopRecord(!0);
};
t.prototype.refreshTopLabel = function() {
var e = h.LotoFastModel.Instance.declearHistory.getWinCount();
null != this.winCountAll && (this.winCountAll.string = l.Tools.TStr.replaceAll("Nearly %{num} rounds:", "%{num}", e.total));
if (0 != this.winCounts.length) {
this.winCounts[0].string = e.set + "";
this.winCounts[1].string = e.pure + "";
this.winCounts[2].string = e.seq + "";
this.winCounts[3].string = e.color + "";
this.winCounts[4].string = e.pair + "";
this.winCounts[5].string = e.high + "";
}
};
t.prototype.refreshTopRecord = function(e) {
var t = this;
void 0 === e && (e = !1);
var o = h.LotoFastModel.Instance;
this.TopRecordParent.destroyAllChildren();
for (var n = o.declearHistory.getSimpleHistory(this.MaxCount), a = 0; a < n.length; a++) {
var i = n[a], r = cc.instantiate(this.TopRecordItem);
r.active = !0;
r.setPosition(cc.Vec2.ZERO);
r.parent = this.TopRecordParent;
var l = r.getChildByName("Background").getComponent(cc.Sprite);
l.spriteFrame = this.Frames_Item[i.cardType == d.TeenPattiCardType.Trail ? 1 : 0];
i.cardType == d.TeenPattiCardType.HighCard || i.cardType == d.TeenPattiCardType.HighCardA ? l.node.color = this.Color_HIGH : i.cardType == d.TeenPattiCardType.Pair ? l.node.color = this.Color_PAIR : i.cardType == d.TeenPattiCardType.Color ? l.node.color = this.Color_COLOR : i.cardType == d.TeenPattiCardType.Sequence ? l.node.color = this.Color_SEQ : i.cardType == d.TeenPattiCardType.PureSequence ? l.node.color = this.Color_PURE : i.cardType == d.TeenPattiCardType.Trail ? l.node.color = this.Color_SET : l.node.color = cc.Color.WHITE;
var s = r.getChildByName("Points").getComponent(cc.Label);
s && (s.string = i.getTypeString());
}
if (e && null != this.Light) {
this.TopRecordParent.getComponent(cc.Layout).updateLayout();
var c = this.TopRecordParent.children[this.TopRecordParent.children.length - 1], u = c.parent.convertToWorldSpaceAR(c.position), p = this.Light.node.parent.convertToNodeSpaceAR(u);
this.Light.node.position = p;
this.Light.node.active = !0;
this.Light.armatureName = "Armature";
this.Light.once(dragonBones.EventObject.COMPLETE, function() {
t.Light.node.active = !1;
}, this);
this.Light.playAnimation("animation_new_details", 1);
}
};
t.prototype.onRecordClicked = function() {
c.default.Instance.addBundleMaskLayer(r.BundleUIPath.LotoFastRecord, null, u.PopZindex.RBFast + 1);
};
i([ m(cc.Node) ], t.prototype, "TopRecordParent", void 0);
i([ m(cc.Node) ], t.prototype, "TopRecordItem", void 0);
i([ m(cc.Label) ], t.prototype, "winCountAll", void 0);
i([ m([ cc.Label ]) ], t.prototype, "winCounts", void 0);
i([ m(dragonBones.ArmatureDisplay) ], t.prototype, "Light", void 0);
i([ m([ cc.SpriteFrame ]) ], t.prototype, "Frames_Item", void 0);
i([ m(cc.Color) ], t.prototype, "Color_SET", void 0);
i([ m(cc.Color) ], t.prototype, "Color_PURE", void 0);
i([ m(cc.Color) ], t.prototype, "Color_SEQ", void 0);
i([ m(cc.Color) ], t.prototype, "Color_COLOR", void 0);
i([ m(cc.Color) ], t.prototype, "Color_PAIR", void 0);
i([ m(cc.Color) ], t.prototype, "Color_HIGH", void 0);
i([ m ], t.prototype, "MaxCount", void 0);
return i([ _ ], t);
}(cc.Component);
o.default = y;
cc._RF.pop();
}, {
"../../../Game/client/global/enum/game/Const": "Const",
"../../../Game/fromework/global/Tools": "Tools",
"../../../Game/fromework/helper/EventHelper": "EventHelper",
"../../../Game/fromework/helper/UIHelper": "UIHelper",
"../../../client/global/PopHelper": "PopHelper",
"../../../client/teenpatti/model/TeenPattiStruct": "TeenPattiStruct",
"../../RedAndBlackFast/Script/RBFastEvent": "RBFastEvent",
"./LotoFastModel": "LotoFastModel"
} ],
LotoFastRecord: [ function(e, t, o) {
"use strict";
cc._RF.push(t, "a9af9zvnilCHZmiWFMBE3st", "LotoFastRecord");
var n, a = this && this.__extends || (n = function(e, t) {
return (n = Object.setPrototypeOf || {
__proto__: []
} instanceof Array && function(e, t) {
e.__proto__ = t;
} || function(e, t) {
for (var o in t) Object.prototype.hasOwnProperty.call(t, o) && (e[o] = t[o]);
})(e, t);
}, function(e, t) {
n(e, t);
function o() {
this.constructor = e;
}
e.prototype = null === t ? Object.create(t) : (o.prototype = t.prototype, new o());
}), i = this && this.__decorate || function(e, t, o, n) {
var a, i = arguments.length, r = i < 3 ? t : null === n ? n = Object.getOwnPropertyDescriptor(t, o) : n;
if ("object" == typeof Reflect && "function" == typeof Reflect.decorate) r = Reflect.decorate(e, t, o, n); else for (var l = e.length - 1; l >= 0; l--) (a = e[l]) && (r = (i < 3 ? a(r) : i > 3 ? a(t, o, r) : a(t, o)) || r);
return i > 3 && r && Object.defineProperty(t, o, r), r;
};
Object.defineProperty(o, "__esModule", {
value: !0
});
var r = e("../../../Game/client/model/LanguageModel"), l = e("../../../Game/fromework/global/Tools"), s = e("../../../Game/fromework/helper/EventHelper"), c = e("../../../Game/fromework/helper/UIHelper"), u = e("../../../client/teenpatti/model/TeenPattiStruct"), d = e("./LotoFastEvent"), p = e("./LotoFastModel"), h = cc._decorator, f = h.ccclass, _ = h.property, m = function(e) {
a(t, e);
function t() {
var t = null !== e && e.apply(this, arguments) || this;
t.RecordParent = null;
t.RecordItem = null;
t.BottomContent = null;
t.JackPotRound = null;
t.Frames_Item = [];
t.Color_SET = cc.Color.WHITE;
t.Color_PURE = cc.Color.WHITE;
t.Color_SEQ = cc.Color.WHITE;
t.Color_COLOR = cc.Color.WHITE;
t.Color_PAIR = cc.Color.WHITE;
t.Color_HIGH = cc.Color.WHITE;
return t;
}
t.prototype.onEnable = function() {
s.default.Instance.Global.bind(d.LotoFastEvent.S2C_ENTER_ROOM_FAST, this._onEnterRoom, this);
s.default.Instance.Global.bind(d.LotoFastEvent.S2C_DEAL_FAST, this._onDeal, this);
};
t.prototype.onDisable = function() {
s.default.Instance.Global.unbind(d.LotoFastEvent.S2C_ENTER_ROOM_FAST, this._onEnterRoom, this);
s.default.Instance.Global.unbind(d.LotoFastEvent.S2C_DEAL_FAST, this._onDeal, this);
};
t.prototype.onLoad = function() {
this.refreshRecord();
};
t.prototype._onEnterRoom = function() {
this.refreshRecord();
};
t.prototype._onDeal = function() {
this.refreshRecord();
};
t.prototype.refreshRecord = function() {
var e = p.LotoFastModel.Instance;
this.JackPotRound.string = l.Tools.TStr.replaceAll(r.default.getString("JACKPOT_DRAWS_LEFT"), "%{round}", e.jackpot_round);
this.RecordParent.destroyAllChildren();
for (var t = e.declearHistory.getComplexHistory(11), o = 0, n = 0; n < t.length; n++) {
var a = t[n], i = 45.5 + 91 * n;
a.length > o && (o = a.length);
for (var s = 0; s < a.length; s++) {
var c = a[s], d = -(22.75 + 45.5 * s), h = cc.instantiate(this.RecordItem);
h.active = !0;
h.setPosition(cc.v2(i, d));
h.parent = this.RecordParent;
var f = h.getChildByName("Background").getComponent(cc.Sprite);
f.spriteFrame = this.Frames_Item[c.cardType == u.TeenPattiCardType.Trail ? 1 : 0];
c.cardType == u.TeenPattiCardType.HighCard || c.cardType == u.TeenPattiCardType.HighCardA ? f.node.color = this.Color_HIGH : c.cardType == u.TeenPattiCardType.Pair ? f.node.color = this.Color_PAIR : c.cardType == u.TeenPattiCardType.Color ? f.node.color = this.Color_COLOR : c.cardType == u.TeenPattiCardType.Sequence ? f.node.color = this.Color_SEQ : c.cardType == u.TeenPattiCardType.PureSequence ? f.node.color = this.Color_PURE : c.cardType == u.TeenPattiCardType.Trail ? f.node.color = this.Color_SET : f.node.color = cc.Color.WHITE;
var _ = h.getChildByName("Points").getComponent(cc.Label);
_ && (_.string = c.getTypeString());
}
}
this.BottomContent.height = 45.5 * o;
};
t.prototype.onCloseClicked = function() {
c.default.Instance.removeMaskLayer(this.node, !0);
};
i([ _(cc.Node) ], t.prototype, "RecordParent", void 0);
i([ _(cc.Node) ], t.prototype, "RecordItem", void 0);
i([ _(cc.Node) ], t.prototype, "BottomContent", void 0);
i([ _(cc.Label) ], t.prototype, "JackPotRound", void 0);
i([ _([ cc.SpriteFrame ]) ], t.prototype, "Frames_Item", void 0);
i([ _(cc.Color) ], t.prototype, "Color_SET", void 0);
i([ _(cc.Color) ], t.prototype, "Color_PURE", void 0);
i([ _(cc.Color) ], t.prototype, "Color_SEQ", void 0);
i([ _(cc.Color) ], t.prototype, "Color_COLOR", void 0);
i([ _(cc.Color) ], t.prototype, "Color_PAIR", void 0);
i([ _(cc.Color) ], t.prototype, "Color_HIGH", void 0);
return i([ f ], t);
}(cc.Component);
o.default = m;
cc._RF.pop();
}, {
"../../../Game/client/model/LanguageModel": "LanguageModel",
"../../../Game/fromework/global/Tools": "Tools",
"../../../Game/fromework/helper/EventHelper": "EventHelper",
"../../../Game/fromework/helper/UIHelper": "UIHelper",
"../../../client/teenpatti/model/TeenPattiStruct": "TeenPattiStruct",
"./LotoFastEvent": "LotoFastEvent",
"./LotoFastModel": "LotoFastModel"
} ],
LotoFastStruct: [ function(e, t, o) {
"use strict";
cc._RF.push(t, "6bcdbLrdFxJFb/EhE9wKKos", "LotoFastStruct");
Object.defineProperty(o, "__esModule", {
value: !0
});
o.LotoFastStruct = void 0;
var n = e("../../../Game/fromework/global/Tools"), a = e("../../../client/teenpatti/model/TeenPattiStruct"), i = e("./LotoFastModel");
(function(e) {
function t(e) {
for (var t = i.LotoFastModel.Instance.bet_options.length, o = [], n = null != e ? e : [], a = 0; a < t; a++) null == o[a] ? o[a] = new l(n[a]) : o[a].refresh(n[a]);
return o;
}
e.getBetRecordArray = t;
var o = function() {
function e(e) {
this.rid = 0;
this.rtype = "";
this.state = 0;
this.dl = 0;
this.round = 0;
e && this.refresh(e);
}
e.prototype.refresh = function(e) {
this.rid = e.rid;
this.rtype = e.rtype;
this.state = e.state;
this.dl = e.dl;
this.round = e.round;
};
return e;
}();
e.RoomData = o;
var r = function() {
function e(e) {
this.uid = 0;
this.state = 0;
this.auto = !1;
this.repeat = !1;
this.res = 0;
this.total_fee = 0;
e && this.refresh(e);
}
e.prototype.refresh = function(e) {
this.uid = e.uid;
this.state = e.state;
this.auto = e.auto;
this.repeat = e.repeat;
this.res = e.res;
this.total_fee = n.Tools.TNumber.num2single(e.total_fee);
};
return e;
}();
e.UserData = r;
var l = function() {
function e(e) {
this.detail = new Map();
this.amount = 0;
e && this.refresh(e);
}
e.prototype.refresh = function(e) {
for (var t = i.LotoFastModel.Instance, o = null != e.detail ? e.detail : [], a = 0; a < t.bet_fee_currency.length; a++) this.detail.set(t.bet_fee_currency[a], null != o[t.bet_fee_currency[a]] ? o[t.bet_fee_currency[a]] : 0);
this.amount = null != e.amount ? n.Tools.TNumber.num2single(e.amount) : 0;
};
return e;
}();
e.BetRecord = l;
var s = function() {
function e(e) {
this.bet_record = [];
this.win_fee = 0;
this.total_fee = 0;
e && this.refresh(e);
}
e.prototype.refresh = function(e) {
this.win_fee = n.Tools.TNumber.num2single(e.win_fee);
this.total_fee = n.Tools.TNumber.num2single(e.total_fee);
this.bet_record.splice(0);
this.bet_record = t(e.bet_record);
};
return e;
}();
e.DeclearData = s;
var c = function() {
function e(e) {
this.cards = [];
this.cardType = a.TeenPattiCardType.HighCard;
e && this.refresh(e);
}
e.prototype.refresh = function(e) {
this.cards = e.d;
this.cardType = a.TeenPattiCheckTools.checkCardType(this.cards);
this.cardType == a.TeenPattiCardType.HighCardA && (this.cardType = a.TeenPattiCardType.HighCard);
};
e.prototype.getTypeString = function() {
var e = this.cardType;
return e == a.TeenPattiCardType.HighCard || e == a.TeenPattiCardType.HighCardA ? "HIGH" : e == a.TeenPattiCardType.Pair ? "PAIR" : e == a.TeenPattiCardType.Color ? "COLOR" : e == a.TeenPattiCardType.Sequence ? "SEQ" : e == a.TeenPattiCardType.PureSequence ? "PURE" : e == a.TeenPattiCardType.Trail ? "SET" : void 0;
};
return e;
}();
e.HistoryData = c;
var u = function() {
function e(e) {
this.historyArray = [];
e && this.refresh(e);
}
e.prototype.refresh = function(e) {
var t = this;
this.historyArray.splice(0);
e.forEach(function(e) {
var o = new c(e);
t.historyArray.push(o);
});
};
e.prototype.getWinCount = function() {
var e = 0, t = 0, o = 0, n = 0, i = 0, r = 0, l = 0;
this.historyArray.forEach(function(s) {
var c = s.cardType;
c == a.TeenPattiCardType.HighCard || c == a.TeenPattiCardType.HighCardA ? l++ : c == a.TeenPattiCardType.Pair ? r++ : c == a.TeenPattiCardType.Color ? i++ : c == a.TeenPattiCardType.Sequence ? n++ : c == a.TeenPattiCardType.PureSequence ? o++ : c == a.TeenPattiCardType.Trail && t++;
e++;
});
return {
total: e,
set: t,
pure: o,
seq: n,
color: i,
pair: r,
high: l
};
};
e.prototype.addHistory = function(e) {
100 == this.historyArray.length && this.historyArray.shift();
this.historyArray.push(e);
};
e.prototype.getSimpleHistory = function(e) {
for (var t = [], o = this.historyArray.length - 1; o >= 0; o--) {
var n = this.historyArray[o];
t.unshift(n);
if (t.length == e) break;
}
return t;
};
e.prototype.getComplexHistory = function(e) {
for (var t = [], o = -1, n = this.historyArray.length - 1; n >= 0; n--) {
var a = this.historyArray[n];
if (o != a.cardType) {
if (t.length == e) break;
o = a.cardType;
t.unshift([]);
}
t[0].length != e && t[0].unshift(a);
}
return t;
};
return e;
}();
e.DeclearHistory = u;
var d = function() {
function e(e) {
this.show_card = [];
this.time = 0;
this.winner = 0;
this.win_fee = 0;
e && this.refresh(e);
}
e.prototype.refresh = function(e) {
this.show_card = e.d;
this.time = e.t;
this.winner = e.winner;
this.win_fee = n.Tools.TNumber.numFixed(n.Tools.TNumber.num2single(e.w), 2);
};
return e;
}();
e.JackPotRecord = d;
var p = function() {
function e(e) {
this.show_card = [];
this.win_options = [];
this.time = 0;
this.bet_data = [];
this.win_fee = 0;
e && this.refresh(e);
}
e.prototype.refresh = function(e) {
this.show_card = e.d;
this.win_options = e.o;
this.time = e.t;
this.bet_data = e.b;
this.win_fee = n.Tools.TNumber.numFixed(n.Tools.TNumber.num2single(e.w), 2);
};
e.prototype.getBetAmount = function(e) {
if (null == this.bet_data[e]) return 0;
var t = this.bet_data[e], o = Object.keys(t), a = 0;
o.forEach(function(e) {
a += n.Tools.TNumber.num2single(parseInt(e)) * t[e];
});
return a;
};
return e;
}();
e.UserRecord = p;
var h = function() {
function e(e) {
this.name = "";
this.url = "";
this.time = 0;
this.bet_amount = 0;
this.win_fee = 0;
e && this.refresh(e);
}
e.prototype.refresh = function(e) {
this.name = e.n;
this.url = e.h;
this.time = e.t;
this.bet_amount = n.Tools.TNumber.num2single(e.b);
this.win_fee = n.Tools.TNumber.num2single(e.w);
};
return e;
}();
e.BigWinnerRecord = h;
var f = function() {
function e(e) {
this.head_url = "";
this.name = "";
this.win_fee = 0;
this.head_url = "";
this.name = "";
this.win_fee = 0;
e && this.refresh(e);
}
e.prototype.refresh = function(e) {
this.name = e.n;
this.head_url = e.h;
this.win_fee = n.Tools.TNumber.num2single(e.w);
};
return e;
}();
e.BigWinnerData = f;
})(o.LotoFastStruct || (o.LotoFastStruct = {}));
cc._RF.pop();
}, {
"../../../Game/fromework/global/Tools": "Tools",
"../../../client/teenpatti/model/TeenPattiStruct": "TeenPattiStruct",
"./LotoFastModel": "LotoFastModel"
} ],
LotoFastTips: [ function(e, t, o) {
"use strict";
cc._RF.push(t, "241b5iI5cZCC54YDCE04cG8", "LotoFastTips");
var n, a = this && this.__extends || (n = function(e, t) {
return (n = Object.setPrototypeOf || {
__proto__: []
} instanceof Array && function(e, t) {
e.__proto__ = t;
} || function(e, t) {
for (var o in t) Object.prototype.hasOwnProperty.call(t, o) && (e[o] = t[o]);
})(e, t);
}, function(e, t) {
n(e, t);
function o() {
this.constructor = e;
}
e.prototype = null === t ? Object.create(t) : (o.prototype = t.prototype, new o());
}), i = this && this.__decorate || function(e, t, o, n) {
var a, i = arguments.length, r = i < 3 ? t : null === n ? n = Object.getOwnPropertyDescriptor(t, o) : n;
if ("object" == typeof Reflect && "function" == typeof Reflect.decorate) r = Reflect.decorate(e, t, o, n); else for (var l = e.length - 1; l >= 0; l--) (a = e[l]) && (r = (i < 3 ? a(r) : i > 3 ? a(t, o, r) : a(t, o)) || r);
return i > 3 && r && Object.defineProperty(t, o, r), r;
};
Object.defineProperty(o, "__esModule", {
value: !0
});
var r = e("../../../Game/fromework/helper/EventHelper"), l = e("./LotoFastEvent"), s = e("./LotoFastModel"), c = cc._decorator, u = c.ccclass, d = c.property, p = function(e) {
a(t, e);
function t() {
var t = null !== e && e.apply(this, arguments) || this;
t.Index = 0;
t.Template = null;
t.TipParent = null;
t.MoveRange = 30;
t._amount = 0;
return t;
}
t.prototype.onEnable = function() {
r.default.Instance.Global.bind(l.LotoFastGameEvent.GAME_RECONNECT, this.onReconnect, this);
r.default.Instance.Global.bind(l.LotoFastEvent.S2C_BET_BATCH_FAST, this.onBet, this);
r.default.Instance.Global.bind(l.LotoFastEvent.S2C_SHOW_FAST, this.onShow, this);
r.default.Instance.Global.bind(l.LotoFastEvent.S2C_RESET_FAST, this.onReset, this);
r.default.Instance.Global.bind(l.LotoFastUIEvent.UI_INIT_ODDS_AMOUNT, this.initAmount, this);
};
t.prototype.onDisable = function() {
r.default.Instance.Global.unbind(l.LotoFastGameEvent.GAME_RECONNECT, this.onReconnect, this);
r.default.Instance.Global.unbind(l.LotoFastEvent.S2C_BET_BATCH_FAST, this.onBet, this);
r.default.Instance.Global.unbind(l.LotoFastEvent.S2C_SHOW_FAST, this.onShow, this);
r.default.Instance.Global.unbind(l.LotoFastEvent.S2C_RESET_FAST, this.onReset, this);
r.default.Instance.Global.unbind(l.LotoFastUIEvent.UI_INIT_ODDS_AMOUNT, this.initAmount, this);
};
t.prototype.initAmount = function() {
var e = s.LotoFastModel.Instance;
this._amount = e.roomBetRecord[this.Index] ? e.roomBetRecord[this.Index].amount : 0;
};
t.prototype.runTipsAction = function(e) {
if (!(e <= 0)) {
var t = cc.instantiate(this.Template);
t.active = !0;
t.position = cc.Vec3.ZERO;
t.parent = this.TipParent;
t.getChildByName("Tips").getComponent(cc.Label).string = "+" + e;
cc.tween(t).by(1.5, {
y: this.MoveRange,
opacity: -255
}).call(function() {
if (t && t.isValid) {
t.removeFromParent(!0);
t.destroy();
}
}).start();
}
};
t.prototype.onReconnect = function() {
var e = s.LotoFastModel.Instance;
2 != e.roomData.state && 3 != e.roomData.state || (this._amount = e.roomBetRecord[this.Index] ? e.roomBetRecord[this.Index].amount : 0);
};
t.prototype.onBet = function() {
var e = s.LotoFastModel.Instance, t = e.roomBetRecord[this.Index] ? e.roomBetRecord[this.Index].amount : 0;
this.runTipsAction(t - this._amount);
this._amount = t;
};
t.prototype.onShow = function() {
var e = s.LotoFastModel.Instance.getWinFee(this.Index);
0 != e && this.runTipsAction(e);
};
t.prototype.onReset = function() {
this.TipParent.children.forEach(function(e) {
e.stopAllActions();
});
this.TipParent.destroyAllChildren();
this._amount = 0;
};
i([ d(cc.Integer) ], t.prototype, "Index", void 0);
i([ d(cc.Node) ], t.prototype, "Template", void 0);
i([ d(cc.Node) ], t.prototype, "TipParent", void 0);
i([ d(cc.Float) ], t.prototype, "MoveRange", void 0);
return i([ u ], t);
}(cc.Component);
o.default = p;
cc._RF.pop();
}, {
"../../../Game/fromework/helper/EventHelper": "EventHelper",
"./LotoFastEvent": "LotoFastEvent",
"./LotoFastModel": "LotoFastModel"
} ],
LotoFastUserRecordItem: [ function(e, t, o) {
"use strict";
cc._RF.push(t, "0998534jp5OFID9XUO2aD03", "LotoFastUserRecordItem");
var n, a = this && this.__extends || (n = function(e, t) {
return (n = Object.setPrototypeOf || {
__proto__: []
} instanceof Array && function(e, t) {
e.__proto__ = t;
} || function(e, t) {
for (var o in t) Object.prototype.hasOwnProperty.call(t, o) && (e[o] = t[o]);
})(e, t);
}, function(e, t) {
n(e, t);
function o() {
this.constructor = e;
}
e.prototype = null === t ? Object.create(t) : (o.prototype = t.prototype, new o());
}), i = this && this.__decorate || function(e, t, o, n) {
var a, i = arguments.length, r = i < 3 ? t : null === n ? n = Object.getOwnPropertyDescriptor(t, o) : n;
if ("object" == typeof Reflect && "function" == typeof Reflect.decorate) r = Reflect.decorate(e, t, o, n); else for (var l = e.length - 1; l >= 0; l--) (a = e[l]) && (r = (i < 3 ? a(r) : i > 3 ? a(t, o, r) : a(t, o)) || r);
return i > 3 && r && Object.defineProperty(t, o, r), r;
};
Object.defineProperty(o, "__esModule", {
value: !0
});
var r = e("../../../Game/client/model/LanguageModel"), l = e("../../../Game/fromework/global/Tools"), s = cc._decorator, c = s.ccclass, u = s.property, d = function(e) {
a(t, e);
function t() {
var t = null !== e && e.apply(this, arguments) || this;
t.Labels_Bet = [];
t.Sprites_Bet = [];
t.Time = null;
t.Result = null;
t.Total = null;
t.Frames_Result = [];
t.Color_Lose = null;
t.Color_Win = null;
t._data = null;
t._index = -1;
return t;
}
t.prototype.onItemInitCallFunc = function(e, t) {
this._data = e;
this._index = t;
for (var o = 0; o < 6; o++) {
var n = this.Labels_Bet[o], a = this.Sprites_Bet[o], i = this._data.win_options.indexOf(o) >= 0, s = this._data.getBetAmount(o);
n.string = s + "";
a.node.active = s > 0;
a.spriteFrame = this.Frames_Result[i ? 0 : 1];
}
this.Time.string = l.Tools.TDate.format(1e3 * this._data.time, "MM/dd/yyyy hh:mm:ss");
this.Result.node.color = this._data.win_fee > 0 ? this.Color_Win : this.Color_Lose;
this.Total.string = this._data.win_fee + "";
var c = this._data.win_options[0];
0 == c ? this.Result.string = r.default.getString("LOTO_FAST_CardType6") : 1 == c ? this.Result.string = r.default.getString("LOTO_FAST_CardType7") : 2 == c ? this.Result.string = r.default.getString("LOTO_FAST_CardType4") : 3 == c ? this.Result.string = r.default.getString("LOTO_FAST_CardType3") : 4 == c ? this.Result.string = r.default.getString("LOTO_FAST_CardType2") : 5 == c && (this.Result.string = r.default.getString("LOTO_FAST_CardType1"));
};
t.prototype.onItemEnterCallFunc = function() {
this.node.opacity = 255;
};
t.prototype.onItemExitCallFunc = function() {
this.node.opacity = 0;
};
i([ u([ cc.Label ]) ], t.prototype, "Labels_Bet", void 0);
i([ u([ cc.Sprite ]) ], t.prototype, "Sprites_Bet", void 0);
i([ u(cc.Label) ], t.prototype, "Time", void 0);
i([ u(cc.Label) ], t.prototype, "Result", void 0);
i([ u(cc.Label) ], t.prototype, "Total", void 0);
i([ u([ cc.SpriteFrame ]) ], t.prototype, "Frames_Result", void 0);
i([ u(cc.Color) ], t.prototype, "Color_Lose", void 0);
i([ u(cc.Color) ], t.prototype, "Color_Win", void 0);
return i([ c ], t);
}(cc.Component);
o.default = d;
cc._RF.pop();
}, {
"../../../Game/client/model/LanguageModel": "LanguageModel",
"../../../Game/fromework/global/Tools": "Tools"
} ],
LotoFastWinnerRecordItem: [ function(e, t, o) {
"use strict";
cc._RF.push(t, "446502xZMVKRbOMciHovxX9", "LotoFastWinnerRecordItem");
var n, a = this && this.__extends || (n = function(e, t) {
return (n = Object.setPrototypeOf || {
__proto__: []
} instanceof Array && function(e, t) {
e.__proto__ = t;
} || function(e, t) {
for (var o in t) Object.prototype.hasOwnProperty.call(t, o) && (e[o] = t[o]);
})(e, t);
}, function(e, t) {
n(e, t);
function o() {
this.constructor = e;
}
e.prototype = null === t ? Object.create(t) : (o.prototype = t.prototype, new o());
}), i = this && this.__decorate || function(e, t, o, n) {
var a, i = arguments.length, r = i < 3 ? t : null === n ? n = Object.getOwnPropertyDescriptor(t, o) : n;
if ("object" == typeof Reflect && "function" == typeof Reflect.decorate) r = Reflect.decorate(e, t, o, n); else for (var l = e.length - 1; l >= 0; l--) (a = e[l]) && (r = (i < 3 ? a(r) : i > 3 ? a(t, o, r) : a(t, o)) || r);
return i > 3 && r && Object.defineProperty(t, o, r), r;
};
Object.defineProperty(o, "__esModule", {
value: !0
});
var r = e("../../../Game/client/global/enum/game/UIUtils"), l = e("../../../Game/client/model/LanguageModel"), s = e("../../../Game/fromework/global/Tools"), c = cc._decorator, u = c.ccclass, d = c.property, p = function(e) {
a(t, e);
function t() {
var t = null !== e && e.apply(this, arguments) || this;
t.UserHead = null;
t.Name = null;
t.Time = null;
t.BetAmount = null;
t.Win = null;
t._data = null;
t._index = -1;
return t;
}
t.prototype.onItemInitCallFunc = function(e, t) {
this._data = e;
this._index = t;
this._data.url && "" != this._data.url && r.UIUtils.updateHeadImage(this._data.url, this.UserHead, cc.size(102, 102));
this.Name.string = s.Tools.TStr.ellipsisString(this._data.name, 20);
this.Time.string = s.Tools.TDate.format(1e3 * this._data.time, "MM/dd/yyyy hh:mm:ss");
this.BetAmount.string = l.default.getString("MoneySymbol") + this._data.bet_amount + "";
this.Win.string = l.default.getString("MoneySymbol") + this._data.win_fee + "";
};
t.prototype.onItemEnterCallFunc = function() {
this.node.opacity = 255;
};
t.prototype.onItemExitCallFunc = function() {
this.node.opacity = 0;
};
i([ d(cc.Sprite) ], t.prototype, "UserHead", void 0);
i([ d(cc.Label) ], t.prototype, "Name", void 0);
i([ d(cc.Label) ], t.prototype, "Time", void 0);
i([ d(cc.Label) ], t.prototype, "BetAmount", void 0);
i([ d(cc.Label) ], t.prototype, "Win", void 0);
return i([ u ], t);
}(cc.Component);
o.default = p;
cc._RF.pop();
}, {
"../../../Game/client/global/enum/game/UIUtils": "UIUtils",
"../../../Game/client/model/LanguageModel": "LanguageModel",
"../../../Game/fromework/global/Tools": "Tools"
} ],
LotoFast: [ function(e, t, o) {
"use strict";
cc._RF.push(t, "386433LHw1Owo65euvVM2t7", "LotoFast");
var n, a = this && this.__extends || (n = function(e, t) {
return (n = Object.setPrototypeOf || {
__proto__: []
} instanceof Array && function(e, t) {
e.__proto__ = t;
} || function(e, t) {
for (var o in t) Object.prototype.hasOwnProperty.call(t, o) && (e[o] = t[o]);
})(e, t);
}, function(e, t) {
n(e, t);
function o() {
this.constructor = e;
}
e.prototype = null === t ? Object.create(t) : (o.prototype = t.prototype, new o());
}), i = this && this.__decorate || function(e, t, o, n) {
var a, i = arguments.length, r = i < 3 ? t : null === n ? n = Object.getOwnPropertyDescriptor(t, o) : n;
if ("object" == typeof Reflect && "function" == typeof Reflect.decorate) r = Reflect.decorate(e, t, o, n); else for (var l = e.length - 1; l >= 0; l--) (a = e[l]) && (r = (i < 3 ? a(r) : i > 3 ? a(t, o, r) : a(t, o)) || r);
return i > 3 && r && Object.defineProperty(t, o, r), r;
};
Object.defineProperty(o, "__esModule", {
value: !0
});
var r = e("../../../client/logic/Wallet/WalletHelper"), l = e("../../../Game/client/model/LanguageModel"), s = e("../../../client/model/LobbyModel"), c = e("../../../client/model/UserModel"), u = e("./LotoFastEvent"), d = e("./LotoFastModel"), p = e("./LotoFastRecordAlert"), h = e("../../../Game/fromework/helper/EventHelper"), f = e("../../../Game/client/global/enum/game/Event"), _ = e("../../../Game/Script/global/GlobalValue"), m = e("../../../Game/fromework/mvvm/modelView/ViewModel"), y = e("../../../Game/fromework/global/Tools"), g = e("../../../Game/client/global/enum/game/UIUtils"), v = e("../../../Game/fromework/helper/UIHelper"), C = e("../../../Game/fromework/helper/AudioHelper"), b = e("../../../Game/client/global/enum/game/Const"), I = e("../../../client/global/PopHelper"), E = cc._decorator, S = E.ccclass, T = E.property, R = function(e) {
a(t, e);
function t() {
var t = null !== e && e.apply(this, arguments) || this;
t.ChipSubButton = null;
t.ChipAddButton = null;
t.ChipMaxButton = null;
t.RepeatButton = null;
t.RechargeButton = null;
t.Money = null;
t.BetAmount = null;
t.DragonBonus = null;
t._chipIndex = 0;
t._isLeave = !1;
return t;
}
t.prototype.onEnable = function() {
h.default.Instance.Global.bind(u.LotoFastGameEvent.GAME_RECONNECT, this.onReconnect, this);
h.default.Instance.Global.bind(u.LotoFastEvent.S2C_SWITCH_ROOM_FAST, this.onSwitchRoom, this);
h.default.Instance.Global.bind(u.LotoFastEvent.S2C_DEAL_FAST, this.refreshRepeat, this);
h.default.Instance.Global.bind(u.LotoFastEvent.S2C_RESET_FAST, this.refreshRepeat, this);
h.default.Instance.Global.bind(u.LotoFastEvent.S2C_AUTO_PLAY_FAST, this.refreshRepeat, this);
h.default.Instance.Global.bind(u.LotoFastEvent.S2C_BET_FAST, this.refreshRepeat, this);
h.default.Instance.Global.bind(f.GameEvent.S2C_SEND_AVAILABLE_BALANCE, this.refreshMoney, this);
h.default.Instance.Global.bind(u.LotoFastEvent.S2C_BET_FAST, this.refreshMoney, this);
h.default.Instance.Global.bind(u.LotoFastEvent.S2C_SHOW_FAST, this.refreshMoney, this);
h.default.Instance.Global.bind(u.LotoFastEvent.S2C_RESET_FAST, this.refreshMoney, this);
h.default.Instance.Global.bind(u.LotoFastEvent.S2C_LEAVE_SINGLE_FAST, this.onLeave, this);
h.default.Instance.Global.bind(u.LotoFastUIEvent.UI_EFFECT_JACKPOT, this.playJackPotEffect, this);
h.default.Instance.Global.bind(u.LotoFastOddsEvent.ODDS_BET_BUTTON_CLICK, this.onBetClicked, this);
h.default.Instance.Global.bind(u.LotoFastEvent.TABLE_REFRESH_TABLE_FAST, this._joinRoom, this);
h.default.Instance.Global.bind(u.LotoFastEvent.TABLE_REPEAT_BET_ERROR, this._onRepeatBetError, this);
};
t.prototype.onDisable = function() {
h.default.Instance.Global.unbind(u.LotoFastGameEvent.GAME_RECONNECT, this.onReconnect, this);
h.default.Instance.Global.unbind(u.LotoFastEvent.S2C_SWITCH_ROOM_FAST, this.onSwitchRoom, this);
h.default.Instance.Global.unbind(u.LotoFastEvent.S2C_DEAL_FAST, this.refreshRepeat, this);
h.default.Instance.Global.unbind(u.LotoFastEvent.S2C_RESET_FAST, this.refreshRepeat, this);
h.default.Instance.Global.unbind(u.LotoFastEvent.S2C_AUTO_PLAY_FAST, this.refreshRepeat, this);
h.default.Instance.Global.unbind(u.LotoFastEvent.S2C_BET_FAST, this.refreshRepeat, this);
h.default.Instance.Global.unbind(f.GameEvent.S2C_SEND_AVAILABLE_BALANCE, this.refreshMoney, this);
h.default.Instance.Global.unbind(u.LotoFastEvent.S2C_BET_FAST, this.refreshMoney, this);
h.default.Instance.Global.unbind(u.LotoFastEvent.S2C_SHOW_FAST, this.refreshMoney, this);
h.default.Instance.Global.unbind(u.LotoFastEvent.S2C_RESET_FAST, this.refreshMoney, this);
h.default.Instance.Global.unbind(u.LotoFastEvent.S2C_LEAVE_SINGLE_FAST, this.onLeave, this);
h.default.Instance.Global.unbind(u.LotoFastUIEvent.UI_EFFECT_JACKPOT, this.playJackPotEffect, this);
h.default.Instance.Global.unbind(u.LotoFastOddsEvent.ODDS_BET_BUTTON_CLICK, this.onBetClicked, this);
h.default.Instance.Global.unbind(u.LotoFastEvent.TABLE_REFRESH_TABLE_FAST, this._joinRoom, this);
h.default.Instance.Global.unbind(u.LotoFastEvent.TABLE_REPEAT_BET_ERROR, this._onRepeatBetError, this);
};
t.prototype.onLoad = function() {
cc.game.on(cc.game.EVENT_SHOW, this._joinRoom, this);
this.RechargeButton.active = _.default.getInstance().isCashGame || c.default.checkOrganicSwitch(c.OrganicSwitch.ORGANIC_FUNC_SWITCH_RECHARGE);
this._chipIndex = parseInt(cc.sys.localStorage.getItem(m.VM.getValue("user.uid") + "LotoFastChipIndex"));
(null == this._chipIndex || isNaN(this._chipIndex)) && (this._chipIndex = 0);
this._isLeave = !1;
this._joinRoom();
};
t.prototype.onDestroy = function() {
cc.game.off(cc.game.EVENT_SHOW, this._joinRoom, this);
this._isLeave || d.default.Instance.sendLeave();
d.default.Instance.isOpenWindow = !1;
};
t.prototype._joinRoom = function() {
var e = m.VM.getValue("lobby.roomIDFast");
d.default.Instance.isOpenWindow = !0;
d.default.Instance.sendEnterRoom(e);
};
t.prototype._onRepeatBetError = function(e) {
var t = e.getUserData().bet_total;
r.default.Instance.openRechargeAlert(t, 0);
};
t.prototype.refreshChipButtons = function() {
var e = d.LotoFastModel.Instance;
this.ChipSubButton.interactable = 0 != this._chipIndex;
this.ChipAddButton.interactable = this._chipIndex != e.bet_fee_currency.length - 1;
this.ChipMaxButton.interactable = this._chipIndex != e.bet_fee_currency.length - 1;
var t = e.bet_fee_currency[this._chipIndex];
this.BetAmount.string = y.Tools.TNumber.num2single(t) + "";
};
t.prototype.refreshRepeat = function() {
var e = d.LotoFastModel.Instance;
this.RepeatButton.interactable = e.userData.repeat;
g.UIUtils.setGray(this.RepeatButton.node, !e.userData.repeat, !0);
};
t.prototype.refreshMoney = function() {
var e = d.LotoFastModel.Instance;
this.Money.string = l.default.getString("MoneySymbol") + y.Tools.TNumber.numFixed(e.total_fee, 1);
};
t.prototype.onReconnect = function() {
this.refreshChipButtons();
this.refreshRepeat();
this.refreshMoney();
};
t.prototype.onSwitchRoom = function(e) {
var t = e.getUserData();
d.default.Instance.sendEnterRoom(t);
};
t.prototype.onLeave = function() {
d.default.Instance.isOpenWindow = !1;
m.VM.setValue("lobby.roomIDFast", 0);
this && this.node && this.node.isValid && v.default.Instance.removeMaskLayer(this.node, !0);
};
t.prototype.onBetClicked = function(e) {
var t = d.LotoFastModel.Instance, o = e.getUserData().index, n = y.Tools.TNumber.num2single(t.bet_fee_currency[this._chipIndex]), a = s.default.Instance.getGamePlay(t.roomData.rtype), i = s.default.Instance.getPlaySwitch(a.cls);
if (i && (!i || 3 != i.s) || t.checkRecharge()) if (2 == t.roomData.state) if (t.total_fee >= n) if (t.getBetAmount() + n <= t.bet_limit) {
cc.sys.localStorage.setItem(m.VM.getValue("user.uid") + "LotoFastChipIndex", String(this._chipIndex));
d.default.Instance.sendBet(n, o);
} else {
var c = y.Tools.TStr.replaceAll(l.default.getString("COMPOSITE_BET_MAX"), "%{num}", t.bet_limit);
I.PopHelper.Instance.showTips(c);
} else r.default.Instance.openRechargeAlert(n, 0); else {
C.default.Instance.playBundleEffect(b.BundleSoundPath.composite_odds_stop);
I.PopHelper.Instance.showTips(l.default.getString("COMPOSITE_TIPS_WAIT"));
} else r.default.Instance.openRechargeAlert(100, 0, !1);
};
t.prototype.playJackPotEffect = function() {
var e = this;
this.DragonBonus.parent.active = !0;
this.DragonBonus.getComponent(sp.Skeleton).setAnimation(0, "animation_jackpot", !1);
this.DragonBonus.getComponent(sp.Skeleton).setCompleteListener(function() {
e.DragonBonus.parent.active = !1;
});
};
t.prototype.onSubClicked = function() {
d.LotoFastModel.Instance;
if (0 != this._chipIndex) {
this._chipIndex--;
this.refreshChipButtons();
}
};
t.prototype.onAddClicked = function() {
var e = d.LotoFastModel.Instance;
if (this._chipIndex != e.bet_fee_currency.length - 1) {
this._chipIndex++;
this.refreshChipButtons();
}
};
t.prototype.onMaxClicked = function() {
var e = d.LotoFastModel.Instance;
this._chipIndex = e.bet_fee_currency.length - 1;
this.refreshChipButtons();
};
t.prototype.onRepeatClicked = function() {
var e = d.LotoFastModel.Instance, t = (y.Tools.TNumber.num2single(e.bet_fee_currency[this._chipIndex]), 
s.default.Instance.getGamePlay(e.roomData.rtype)), o = s.default.Instance.getPlaySwitch(t.cls);
if (o && (!o || 3 != o.s) || e.checkRecharge()) {
if (e.userData.repeat) if (2 == e.roomData.state) d.default.Instance.sendRepeatBet(); else {
C.default.Instance.playBundleEffect(b.BundleSoundPath.composite_odds_stop);
I.PopHelper.Instance.showTips(l.default.getString("COMPOSITE_TIPS_WAIT"));
}
} else r.default.Instance.openRechargeAlert(100, 0, !1);
};
t.prototype.onHelpClicked = function() {
v.default.Instance.addBundleMaskLayer(b.BundleUIPath.LotoFastHelp, null, I.PopZindex.RBFast + 1);
};
t.prototype.onRecordClicked = function() {
v.default.Instance.addBundleMaskLayer(b.BundleUIPath.LotoFastRecordAlert, function(e) {
e.getComponent(p.default).InitView(1);
}, I.PopZindex.RBFast + 1);
};
t.prototype.onRechargeClicked = function() {
r.default.Instance.openRecharge();
};
t.prototype.onCloseClicked = function() {
this._isLeave = !0;
d.default.Instance.sendLeave();
};
i([ T(cc.Button) ], t.prototype, "ChipSubButton", void 0);
i([ T(cc.Button) ], t.prototype, "ChipAddButton", void 0);
i([ T(cc.Button) ], t.prototype, "ChipMaxButton", void 0);
i([ T(cc.Button) ], t.prototype, "RepeatButton", void 0);
i([ T(cc.Node) ], t.prototype, "RechargeButton", void 0);
i([ T(cc.Label) ], t.prototype, "Money", void 0);
i([ T(cc.Label) ], t.prototype, "BetAmount", void 0);
i([ T(cc.Node) ], t.prototype, "DragonBonus", void 0);
return i([ S ], t);
}(cc.Component);
o.default = R;
cc._RF.pop();
}, {
"../../../Game/Script/global/GlobalValue": "GlobalValue",
"../../../Game/client/global/enum/game/Const": "Const",
"../../../Game/client/global/enum/game/Event": "Event",
"../../../Game/client/global/enum/game/UIUtils": "UIUtils",
"../../../Game/client/model/LanguageModel": "LanguageModel",
"../../../Game/fromework/global/Tools": "Tools",
"../../../Game/fromework/helper/AudioHelper": "AudioHelper",
"../../../Game/fromework/helper/EventHelper": "EventHelper",
"../../../Game/fromework/helper/UIHelper": "UIHelper",
"../../../Game/fromework/mvvm/modelView/ViewModel": "ViewModel",
"../../../client/global/PopHelper": "PopHelper",
"../../../client/logic/Wallet/WalletHelper": "WalletHelper",
"../../../client/model/LobbyModel": "LobbyModel",
"../../../client/model/UserModel": "UserModel",
"./LotoFastEvent": "LotoFastEvent",
"./LotoFastModel": "LotoFastModel",
"./LotoFastRecordAlert": "LotoFastRecordAlert"
} ],
LuckyDiceDealer: [ function(e, t, o) {
"use strict";
cc._RF.push(t, "74912gj0A5AwqhGgn2k0jup", "LuckyDiceDealer");
var n, a = this && this.__extends || (n = function(e, t) {
return (n = Object.setPrototypeOf || {
__proto__: []
} instanceof Array && function(e, t) {
e.__proto__ = t;
} || function(e, t) {
for (var o in t) Object.prototype.hasOwnProperty.call(t, o) && (e[o] = t[o]);
})(e, t);
}, function(e, t) {
n(e, t);
function o() {
this.constructor = e;
}
e.prototype = null === t ? Object.create(t) : (o.prototype = t.prototype, new o());
}), i = this && this.__decorate || function(e, t, o, n) {
var a, i = arguments.length, r = i < 3 ? t : null === n ? n = Object.getOwnPropertyDescriptor(t, o) : n;
if ("object" == typeof Reflect && "function" == typeof Reflect.decorate) r = Reflect.decorate(e, t, o, n); else for (var l = e.length - 1; l >= 0; l--) (a = e[l]) && (r = (i < 3 ? a(r) : i > 3 ? a(t, o, r) : a(t, o)) || r);
return i > 3 && r && Object.defineProperty(t, o, r), r;
};
Object.defineProperty(o, "__esModule", {
value: !0
});
var r = e("../../../Game/client/global/enum/game/Const"), l = e("../../../Game/client/global/enum/game/Event"), s = e("../../../Game/fromework/global/Tools"), c = e("../../../Game/fromework/helper/AudioHelper"), u = e("../../../Game/fromework/helper/EventHelper"), d = e("../../../platform/Platform"), p = e("../../Common/Utils/CompositeConst"), h = e("../../Common/Utils/CompositeEvent"), f = e("../../Common/Utils/CompositeUtil"), _ = cc._decorator, m = _.ccclass, y = _.property, g = [ "lucky_dice_0", "lucky_dice_5", "lucky_dice_1", "lucky_dice_3", "lucky_dice_2", "lucky_dice_4" ], v = [ cc.v2(-80, 30), cc.v2(0, 30), cc.v2(80, 30), cc.v2(-80, -30), cc.v2(0, -30), cc.v2(80, -30) ], C = function(e) {
a(t, e);
function t() {
var t = null !== e && e.apply(this, arguments) || this;
t.DiceNode = null;
t.DiceImageNode = null;
t.DiceCup = null;
t.DiceParent = null;
t.TargetNodes = [];
t.Frames_Dice = [];
t._diceAry = [];
return t;
}
t.prototype.onEnable = function() {
u.default.Instance.Global.bind(h.CompositeGameEvent.GAME_RECONNECT, this.onReconnect, this);
u.default.Instance.Global.bind(l.GameEvent.S2C_AB_DEAL, this.onDealerCard, this);
u.default.Instance.Global.bind(l.GameEvent.S2C_AB_SHOW, this.onShowCard, this);
u.default.Instance.Global.bind(l.GameEvent.S2C_RESET, this.onReset, this);
};
t.prototype.onDisable = function() {
u.default.Instance.Global.unbind(h.CompositeGameEvent.GAME_RECONNECT, this.onReconnect, this);
u.default.Instance.Global.unbind(l.GameEvent.S2C_AB_DEAL, this.onDealerCard, this);
u.default.Instance.Global.unbind(l.GameEvent.S2C_AB_SHOW, this.onShowCard, this);
u.default.Instance.Global.unbind(l.GameEvent.S2C_RESET, this.onReset, this);
};
t.prototype.onLoad = function() {
cc.game.on(cc.game.EVENT_SHOW, this._onReset, this);
};
t.prototype.onDestroy = function() {
this.unscheduleAllCallbacks();
cc.game.off(cc.game.EVENT_SHOW, this._onReset, this);
};
t.prototype._onReset = function() {
this._diceAry.forEach(function(e) {
e && e.stopAllActions();
});
this.DiceCup.off(dragonBones.EventObject.COMPLETE);
this.DiceParent.destroyAllChildren();
this._diceAry.splice(0);
};
t.prototype.createDice = function() {
this._onReset();
for (var e = 0; e < 6; e++) {
var t = cc.instantiate(this.DiceNode);
t.active = !1;
t.scale = 1;
t.setPosition(this.DiceCup.node.position.x, this.DiceCup.node.position.y + 40);
t.parent = this.DiceParent;
this._diceAry.push(t);
}
};
t.prototype.getRandomTarget = function(e) {
var t = e.getBoundingBox(), o = s.Tools.TNumber.randomNumber(t.xMin, t.xMax), n = s.Tools.TNumber.randomNumber(t.yMin, t.yMax);
d.default.log(t.xMax, t.xMax);
return cc.v2(o, n);
};
t.prototype.getOddsPostion = function(e) {
for (var t = new Map(), o = [], n = 0; n < e.length; n++) {
var a = e[n];
t.has(a) || t.set(a, 0);
var i = t.get(a), r = p.OddsPosition[p.PlayMethod.LuckyDice][a], l = v[i];
i++;
t.set(a, i);
o.push(cc.v2(r.x + l.x, r.y + l.y));
}
return o;
};
t.prototype.onReconnect = function() {
var e = f.default.Game.Model;
this._onReset();
this.DiceCup.playAnimation("dice_close", 1);
if (3 == e.roomData.state && 0 != e.show_card.length) {
for (var t = this.getOddsPostion(e.show_card), o = 0; o < 6; o++) {
var n = cc.instantiate(this.DiceImageNode);
n.active = !0;
n.scale = .55;
n.setPosition(t[o]);
n.parent = this.DiceParent;
n.getComponent(cc.Sprite).spriteFrame = this.Frames_Dice[e.show_card[o]];
this._diceAry.push(n);
}
u.default.Instance.Global.emit(h.OddsEvent.ODDS_RECYCLING);
}
};
t.prototype.onDealerCard = function() {
u.default.Instance.Global.emit(h.CompositeUIEvent.UI_PLAY_START_BET);
};
t.prototype.onShowCard = function() {
var e = this, t = f.default.Game.Model;
this.createDice();
var o = function() {
for (var o = e.getOddsPostion(t.show_card), n = function(n) {
var a = t.show_card[n], i = e._diceAry[n];
i.active = !0;
i.scale = .1;
i.dice = a;
e.scheduleOnce(function() {
if (e && e.node && e.node.isValid && i && i.isValid) {
var t = i.getComponent(dragonBones.ArmatureDisplay);
if (t) {
t.armatureName = "Armature";
t.playAnimation(g[a], 1);
var r = e.getRandomTarget(e.TargetNodes[n]), l = cc.jumpTo(1.17 - .1, r, s.Tools.TNumber.randomNumber(50, 100), s.Tools.TNumber.randomNumber(2, 4)), c = cc.scaleTo(1.17 - .1, 1), d = cc.jumpBy(.1, cc.v2(-40, 0), 15, 1), p = cc.spawn(l.easing(cc.easeIn(2)), c), f = cc.callFunc(function() {
0 == n && cc.tween(e.node).call(function() {
u.default.Instance.Global.emit(h.OddsEvent.ODDS_SHOW_WIN);
}).delay(2.5).call(function() {
u.default.Instance.Global.emit(h.OddsEvent.ODDS_RECYCLING);
}).start();
}), _ = cc.sequence(p, d, cc.delayTime(1), cc.spawn(cc.moveTo(.5, o[n]), cc.scaleTo(.5, .55)), f);
i.runAction(_);
}
}
}, .3 * Math.random());
c.default.Instance.playBundleEffect(r.BundleSoundPath.composite_dice_drop);
}, a = 0; a < e._diceAry.length; a++) n(a);
};
this.DiceCup.armatureName = "Armature";
this.DiceCup.once(dragonBones.EventObject.COMPLETE, function() {
e.DiceCup.once(dragonBones.EventObject.COMPLETE, function() {
e.DiceCup.playAnimation("dice_close", 1);
});
e.DiceCup.playAnimation("dice_open", 1);
o();
}, this);
this.DiceCup.playAnimation("dice_roller", 1);
c.default.Instance.playBundleEffect(r.BundleSoundPath.composite_dice_shake);
};
t.prototype.onReset = function() {
this._onReset();
};
i([ y(cc.Node) ], t.prototype, "DiceNode", void 0);
i([ y(cc.Node) ], t.prototype, "DiceImageNode", void 0);
i([ y(dragonBones.ArmatureDisplay) ], t.prototype, "DiceCup", void 0);
i([ y(cc.Node) ], t.prototype, "DiceParent", void 0);
i([ y([ cc.Node ]) ], t.prototype, "TargetNodes", void 0);
i([ y([ cc.SpriteFrame ]) ], t.prototype, "Frames_Dice", void 0);
return i([ m ], t);
}(cc.Component);
o.default = C;
cc._RF.pop();
}, {
"../../../Game/client/global/enum/game/Const": "Const",
"../../../Game/client/global/enum/game/Event": "Event",
"../../../Game/fromework/global/Tools": "Tools",
"../../../Game/fromework/helper/AudioHelper": "AudioHelper",
"../../../Game/fromework/helper/EventHelper": "EventHelper",
"../../../platform/Platform": "Platform",
"../../Common/Utils/CompositeConst": "CompositeConst",
"../../Common/Utils/CompositeEvent": "CompositeEvent",
"../../Common/Utils/CompositeUtil": "CompositeUtil"
} ],
LuckyDiceHelp: [ function(e, t, o) {
"use strict";
cc._RF.push(t, "fec1ajPHWZBZpC0CPY+WSWy", "LuckyDiceHelp");
var n, a = this && this.__extends || (n = function(e, t) {
return (n = Object.setPrototypeOf || {
__proto__: []
} instanceof Array && function(e, t) {
e.__proto__ = t;
} || function(e, t) {
for (var o in t) Object.prototype.hasOwnProperty.call(t, o) && (e[o] = t[o]);
})(e, t);
}, function(e, t) {
n(e, t);
function o() {
this.constructor = e;
}
e.prototype = null === t ? Object.create(t) : (o.prototype = t.prototype, new o());
}), i = this && this.__decorate || function(e, t, o, n) {
var a, i = arguments.length, r = i < 3 ? t : null === n ? n = Object.getOwnPropertyDescriptor(t, o) : n;
if ("object" == typeof Reflect && "function" == typeof Reflect.decorate) r = Reflect.decorate(e, t, o, n); else for (var l = e.length - 1; l >= 0; l--) (a = e[l]) && (r = (i < 3 ? a(r) : i > 3 ? a(t, o, r) : a(t, o)) || r);
return i > 3 && r && Object.defineProperty(t, o, r), r;
};
Object.defineProperty(o, "__esModule", {
value: !0
});
var r = e("../../Common/Utils/CompositeUtil"), l = cc._decorator, s = l.ccclass, c = l.property, u = function(e) {
a(t, e);
function t() {
var t = null !== e && e.apply(this, arguments) || this;
t.Rate_2 = null;
t.Rate_3 = null;
t.Rate_4 = null;
t.Rate_5 = null;
t.Rate_6 = null;
return t;
}
t.prototype.onLoad = function() {
var e = r.default.Game.Model;
this.Rate_2.string = "Win = bet*" + e.bet_options[0][2];
this.Rate_3.string = "Win = bet*" + e.bet_options[0][3];
this.Rate_4.string = "Win = bet*" + e.bet_options[0][4];
this.Rate_5.string = "Win = bet*" + e.bet_options[0][5];
this.Rate_6.string = "Win = bet*" + e.bet_options[0][6];
};
i([ c(cc.Label) ], t.prototype, "Rate_2", void 0);
i([ c(cc.Label) ], t.prototype, "Rate_3", void 0);
i([ c(cc.Label) ], t.prototype, "Rate_4", void 0);
i([ c(cc.Label) ], t.prototype, "Rate_5", void 0);
i([ c(cc.Label) ], t.prototype, "Rate_6", void 0);
return i([ s ], t);
}(cc.Component);
o.default = u;
cc._RF.pop();
}, {
"../../Common/Utils/CompositeUtil": "CompositeUtil"
} ],
LuckyDiceModel: [ function(e, t, o) {
"use strict";
cc._RF.push(t, "102f9ysy6lFD4GlURW2SVG0", "LuckyDiceModel");
var n, a = this && this.__extends || (n = function(e, t) {
return (n = Object.setPrototypeOf || {
__proto__: []
} instanceof Array && function(e, t) {
e.__proto__ = t;
} || function(e, t) {
for (var o in t) Object.prototype.hasOwnProperty.call(t, o) && (e[o] = t[o]);
})(e, t);
}, function(e, t) {
n(e, t);
function o() {
this.constructor = e;
}
e.prototype = null === t ? Object.create(t) : (o.prototype = t.prototype, new o());
});
Object.defineProperty(o, "__esModule", {
value: !0
});
o.LuckyDiceModel = void 0;
var i = e("../../../Game/client/global/enum/game/Event"), r = e("../../../Game/client/global/enum/game/Game"), l = e("../../../Game/client/global/enum/net/C2S"), s = e("../../../Game/client/global/enum/net/S2C"), c = e("../../../Game/fromework/global/Tools"), u = e("../../../Game/fromework/helper/EventHelper"), d = e("../../../Game/fromework/mvvm/modelView/ViewModel"), p = e("../../../client/logic/game/HearBeat"), h = e("../../../client/model/ErrorModel"), f = e("../../../fromework/helper/NetHelper"), _ = e("../../Common/Utils/CompositeProxy"), m = e("./LuckyDiceStruct"), y = function(e) {
a(t, e);
function t() {
var t = null !== e && e.apply(this, arguments) || this;
t.declearHistory = new m.LuckyDiceStruct.DeclearHistory();
t.bet_fee_currency = [];
t.bet_options = [];
return t;
}
Object.defineProperty(t, "Instance", {
get: function() {
t._instance || (t._instance = new t());
return t._instance;
},
enumerable: !1,
configurable: !0
});
t.prototype.clear = function() {
null != t._instance && (t._instance = null);
};
t.prototype.getOddsRate = function(e) {
var t = this.bet_options[e], o = 0;
this.show_card.forEach(function(t) {
t == e && o++;
});
return null != t[o] ? t[o] : 0;
};
t.prototype.getCompensationCash = function() {
for (var e = new Map(), t = 0; t < this.win_options.length; t++) {
var o = this.roomBetRecord[this.win_options[t]];
if (0 != o.amount) {
var n = this.getOddsRate(this.win_options[t]);
e.set(this.win_options[t], o.amount * (n - 1));
}
}
return e;
};
t.prototype.getWinFee = function(e) {
var t = new Map();
if (this.declearData.user_data.has(String(e))) for (var o = this.declearData.user_data.get(String(e)), n = 0; n < o.bet_record.length; n++) {
var a = o.bet_record[n];
if (0 != a.amount) {
var i = t.has(n) ? t.get(n) : 0, r = this.getOddsRate(n);
t.set(n, i + a.amount * r);
}
}
return t;
};
t._instance = null;
return t;
}(_.CompositeModel);
o.LuckyDiceModel = y;
var g = function(e) {
a(t, e);
function t() {
return null !== e && e.apply(this, arguments) || this;
}
Object.defineProperty(t, "Instance", {
get: function() {
t._instance || (t._instance = new t());
return t._instance;
},
enumerable: !1,
configurable: !0
});
t.prototype.Init = function() {
u.default.Instance.Net.bind(s.S2C.GAME.ROOM_ENTER_ROOM, this._onEnterRoom, this);
u.default.Instance.Net.bind(s.S2C.GAME.ROOM_SWITCH_ROOM, this._onSwitchRoom, this);
u.default.Instance.Net.bind(s.S2C.GAME.ROOM_DEAL, this._onDeal, this);
u.default.Instance.Net.bind(s.S2C.GAME.ROOM_START_BET, this._onStartBet, this);
u.default.Instance.Net.bind(s.S2C.GAME.ROOM_BET, this._onBet, this);
u.default.Instance.Net.bind(s.S2C.GAME.ROOM_BET_BATCH, this._onBetBatch, this);
u.default.Instance.Net.bind(s.S2C.GAME.ROOM_STOP_BET, this._onStopBet, this);
u.default.Instance.Net.bind(s.S2C.GAME.ROOM_SHOW, this._onShow, this);
u.default.Instance.Net.bind(s.S2C.GAME.ROOM_RESET_ROOM, this._onResetRoom, this);
u.default.Instance.Net.bind(s.S2C.GAME.ROOM_INTERACT, this._onInteract, this);
u.default.Instance.Net.bind(s.S2C.GAME.ROOM_RANK, this._onRank, this);
u.default.Instance.Net.bind(s.S2C.GAME.ROOM_LEAVE, this._onLeave, this);
u.default.Instance.Net.bind(s.S2C.GAME.ROOM_LEAVE_SINGLE, this._onLeaveSingle, this);
u.default.Instance.Net.bind(s.S2C.GAME.ROOM_DISMISS, this._onDismiss, this);
u.default.Instance.Net.bind(s.S2C.GAME.ROOM_SEND_AVAILABLE_BALANCE, this._onBalanceRefresh, this);
u.default.Instance.Global.bind(f.NetState.NET_WEBSOCKET_CONNECT_OPEN, this._onWsContented, this);
};
t.prototype.destory = function() {
u.default.Instance.Net.unbind(s.S2C.GAME.ROOM_ENTER_ROOM, this._onEnterRoom, this);
u.default.Instance.Net.unbind(s.S2C.GAME.ROOM_SWITCH_ROOM, this._onSwitchRoom, this);
u.default.Instance.Net.unbind(s.S2C.GAME.ROOM_DEAL, this._onDeal, this);
u.default.Instance.Net.unbind(s.S2C.GAME.ROOM_START_BET, this._onStartBet, this);
u.default.Instance.Net.unbind(s.S2C.GAME.ROOM_BET, this._onBet, this);
u.default.Instance.Net.unbind(s.S2C.GAME.ROOM_BET_BATCH, this._onBetBatch, this);
u.default.Instance.Net.unbind(s.S2C.GAME.ROOM_STOP_BET, this._onStopBet, this);
u.default.Instance.Net.unbind(s.S2C.GAME.ROOM_SHOW, this._onShow, this);
u.default.Instance.Net.unbind(s.S2C.GAME.ROOM_RESET_ROOM, this._onResetRoom, this);
u.default.Instance.Net.unbind(s.S2C.GAME.ROOM_INTERACT, this._onInteract, this);
u.default.Instance.Net.unbind(s.S2C.GAME.ROOM_RANK, this._onRank, this);
u.default.Instance.Net.unbind(s.S2C.GAME.ROOM_LEAVE, this._onLeave, this);
u.default.Instance.Net.unbind(s.S2C.GAME.ROOM_LEAVE_SINGLE, this._onLeaveSingle, this);
u.default.Instance.Net.unbind(s.S2C.GAME.ROOM_DISMISS, this._onDismiss, this);
u.default.Instance.Net.unbind(s.S2C.GAME.ROOM_SEND_AVAILABLE_BALANCE, this._onBalanceRefresh, this);
u.default.Instance.Global.unbind(f.NetState.NET_WEBSOCKET_CONNECT_OPEN, this._onWsContented, this);
};
t.prototype.clear = function() {};
t.prototype._onWsContented = function() {
p.default.Instance.begin();
var e = d.VM.getValue("lobby.roomID");
0 != e && this.sendEnterRoom(e);
};
Object.defineProperty(t.prototype, "roomID", {
get: function() {
return d.VM.getValue("lobby.roomID");
},
enumerable: !1,
configurable: !0
});
t.prototype.checkRoomID = function(e) {
return d.VM.getValue("lobby.roomID") == e;
};
t.prototype.checkRoomType = function(e) {
var t = e.split("_"), o = -1;
null != t && null != t[0] && (o = parseInt(t[0]));
return o == r.GameEnum.PlayType.GAME_LUCKYDICE;
};
t.prototype._onEnterRoom = function(t) {
var o = t.getUserData();
if (this.checkRoomID(o.rid)) {
var n = y.Instance;
if (null != o.user_data && o.uid == this.uid) {
n.bet_fee_currency = o.bet_fee_currency;
n.bet_options = o.bet_options;
o.declear_history && n.declearHistory.refresh(o.declear_history);
}
e.prototype._onEnterRoom.call(this, o, n);
}
};
t.prototype._onSwitchRoom = function(e) {
var t = e.getUserData();
if (this.checkRoomType(t.room_type)) {
d.VM.getValue("lobby.roomID") != t.r && d.VM.setValue("lobby.roomID", parseInt(t.r));
u.default.Instance.Global.emit(i.GameEvent.S2C_SWITCH_ROOM, t.r);
}
};
t.prototype._onDeal = function(t) {
var o = t.getUserData();
if (this.checkRoomID(o.rid)) {
var n = y.Instance;
e.prototype._onDeal.call(this, o, n);
}
};
t.prototype._onStartBet = function(t) {
var o = t.getUserData();
if (this.checkRoomID(o.rid)) {
var n = y.Instance;
e.prototype._onStartBet.call(this, o, n);
}
};
t.prototype._onBet = function(t) {
var o = t.getUserData();
if (this.checkRoomID(o.rid)) {
var n = y.Instance;
e.prototype._onBet.call(this, o, n);
}
};
t.prototype._onBetBatch = function(t) {
var o = t.getUserData();
if (this.checkRoomID(o.rid)) {
var n = y.Instance;
e.prototype._onBetBatch.call(this, o, n);
}
};
t.prototype._onStopBet = function(t) {
var o = t.getUserData();
if (this.checkRoomID(o.rid)) {
var n = y.Instance;
e.prototype._onStopBet.call(this, o, n);
}
};
t.prototype._onShow = function(t) {
var o = t.getUserData();
if (this.checkRoomID(o.rid)) {
var n = y.Instance, a = new m.LuckyDiceStruct.HistoryData({
d: o.room_data.show_card
});
n.declearHistory.addHistory(a);
e.prototype._onShow.call(this, o, n);
}
};
t.prototype._onResetRoom = function(t) {
var o = t.getUserData();
if (this.checkRoomID(o.rid)) {
var n = y.Instance;
e.prototype._onResetRoom.call(this, o, n);
}
};
t.prototype._onInteract = function(t) {
var o = t.getUserData();
if (this.checkRoomID(o.rid)) {
var n = y.Instance;
e.prototype._onInteract.call(this, o, n);
}
};
t.prototype._onRank = function(t) {
var o = t.getUserData();
if (this.checkRoomID(o.rid)) {
var n = y.Instance;
e.prototype._onRank.call(this, o, n);
}
};
t.prototype._onLeave = function(t) {
var o = t.getUserData();
if (this.checkRoomID(o.rid)) {
var n = y.Instance;
e.prototype._onLeave.call(this, o, n);
}
};
t.prototype._onLeaveSingle = function(t) {
var o = t.getUserData();
if (this.checkRoomID(o.rid) || 0 == d.VM.getValue("lobby.roomID")) {
var n = y.Instance;
e.prototype._onLeaveSingle.call(this, o, n);
}
};
t.prototype._onDismiss = function(t) {
var o = t.getUserData();
if (this.checkRoomID(o.rid)) {
var n = y.Instance;
e.prototype._onDismiss.call(this, o, n);
}
};
t.prototype._onBalanceRefresh = function(t) {
var o = t.getUserData();
if (!this.checkRoomID(o.rid)) {
var n = y.Instance;
e.prototype._onBalanceRefresh.call(this, o, n);
}
};
t.prototype.sendEnterRoom = function(e, t) {
void 0 === t && (t = !0);
var o = f.default.Instance.makeMsg(l.C2S.ROOM_ENTER_ROOM, {
u: this.uid,
t: this.token,
r: e,
is_open: t
});
f.default.Instance.send(o);
};
t.prototype.sendBet = function(e, t) {
var o = c.Tools.TNumber.num2thousand(e);
h.default.Instance.CompositeBetNum = e;
var n = f.default.Instance.makeMsg(l.C2S.ROOM_BET, {
u: this.uid,
t: this.token,
r: this.roomID,
fee: o,
option: t
});
f.default.Instance.send(n);
};
t.prototype.sendInteract = function(e, t, o) {
var n;
n = o ? {
u: this.uid,
t: this.token,
r: this.roomID,
to_u: e,
opt_type: t,
opt_val: o
} : {
u: this.uid,
t: this.token,
r: this.roomID,
to_u: e,
opt_type: t
};
var a = f.default.Instance.makeMsg(l.C2S.ROOM_INTERACT, n);
f.default.Instance.send(a);
};
t.prototype.sendRank = function(e, t) {
var o = f.default.Instance.makeMsg(l.C2S.ROOM_RANK, {
u: this.uid,
t: this.token,
r: this.roomID,
page: e,
count: t
});
f.default.Instance.send(o);
};
t.prototype.sendLeave = function() {
var e = f.default.Instance.makeMsg(l.C2S.ROOM_LEAVE, {
u: this.uid,
t: this.token,
r: this.roomID
});
f.default.Instance.send(e);
};
t._instance = null;
return t;
}(_.CompositeProxy);
o.default = g;
cc._RF.pop();
}, {
"../../../Game/client/global/enum/game/Event": "Event",
"../../../Game/client/global/enum/game/Game": "Game",
"../../../Game/client/global/enum/net/C2S": "C2S",
"../../../Game/client/global/enum/net/S2C": "S2C",
"../../../Game/fromework/global/Tools": "Tools",
"../../../Game/fromework/helper/EventHelper": "EventHelper",
"../../../Game/fromework/mvvm/modelView/ViewModel": "ViewModel",
"../../../client/logic/game/HearBeat": "HearBeat",
"../../../client/model/ErrorModel": "ErrorModel",
"../../../fromework/helper/NetHelper": "NetHelper",
"../../Common/Utils/CompositeProxy": "CompositeProxy",
"./LuckyDiceStruct": "LuckyDiceStruct"
} ],
LuckyDiceRecordSmall: [ function(e, t, o) {
"use strict";
cc._RF.push(t, "78990b9419EkLP4B7qzEdrx", "LuckyDiceRecordSmall");
var n, a = this && this.__extends || (n = function(e, t) {
return (n = Object.setPrototypeOf || {
__proto__: []
} instanceof Array && function(e, t) {
e.__proto__ = t;
} || function(e, t) {
for (var o in t) Object.prototype.hasOwnProperty.call(t, o) && (e[o] = t[o]);
})(e, t);
}, function(e, t) {
n(e, t);
function o() {
this.constructor = e;
}
e.prototype = null === t ? Object.create(t) : (o.prototype = t.prototype, new o());
}), i = this && this.__decorate || function(e, t, o, n) {
var a, i = arguments.length, r = i < 3 ? t : null === n ? n = Object.getOwnPropertyDescriptor(t, o) : n;
if ("object" == typeof Reflect && "function" == typeof Reflect.decorate) r = Reflect.decorate(e, t, o, n); else for (var l = e.length - 1; l >= 0; l--) (a = e[l]) && (r = (i < 3 ? a(r) : i > 3 ? a(t, o, r) : a(t, o)) || r);
return i > 3 && r && Object.defineProperty(t, o, r), r;
};
Object.defineProperty(o, "__esModule", {
value: !0
});
var r = e("../../../Game/client/global/enum/game/Event"), l = e("../../../Game/fromework/helper/EventHelper"), s = e("../../Common/Utils/CompositeConst"), c = e("./LuckyDiceModel"), u = cc._decorator, d = u.ccclass, p = u.property, h = function(e) {
a(t, e);
function t() {
var t = null !== e && e.apply(this, arguments) || this;
t.DiceParents = [];
t.DiceItem = null;
t.Color_Win = null;
t.Color_Lose = null;
t.Light = null;
t.EffectParent = null;
t.startOffset = 3;
t.offset = 2;
t.MaxCount = 13;
return t;
}
t.prototype.onEnable = function() {
l.default.Instance.Global.bind(r.GameEvent.S2C_ENTER_ROOM, this._onEnterRoom, this);
l.default.Instance.Global.bind(r.GameEvent.S2C_RESET, this._onResetRoom, this);
};
t.prototype.onDisable = function() {
l.default.Instance.Global.unbind(r.GameEvent.S2C_ENTER_ROOM, this._onEnterRoom, this);
l.default.Instance.Global.unbind(r.GameEvent.S2C_RESET, this._onResetRoom, this);
};
t.prototype.onLoad = function() {
this.refreshParent();
this.refreshTopRecord(!1);
};
t.prototype._onEnterRoom = function() {
this.refreshTopRecord(!1);
};
t.prototype._onResetRoom = function() {
this.refreshTopRecord(!0);
};
t.prototype.refreshParent = function() {
for (var e = 0; e < this.DiceParents.length; e++) this.DiceParents[e], s.OddsPosition[s.PlayMethod.LuckyDice][e], 
s.OddsComponentData[s.PlayMethod.LuckyDice][e];
};
t.prototype.refreshTopRecord = function(e) {
void 0 === e && (e = !1);
for (var t = c.LuckyDiceModel.Instance, o = 0; o < this.DiceParents.length; o++) (i = this.DiceParents[o]).destroyAllChildren();
var n = t.declearHistory.getSimpleHistory(this.MaxCount);
for (o = 0; o < n.length; o++) for (var a = 0; a < this.DiceParents.length; a++) {
var i = this.DiceParents[a], r = n[o].getCount(a), l = cc.instantiate(this.DiceItem);
if (a >= 3) {
this.startOffset = 6;
this.offset = 4.6;
} else {
this.startOffset = 5;
this.offset = 2;
}
var s = this.startOffset + l.width / 2 + o * l.width + (o - 1) * this.offset - i.width / 2;
l.active = !0;
l.setPosition(s, 0);
l.parent = i;
l.getChildByName("Background").getComponent(cc.Sprite).spriteFrame = r >= 2 ? this.Color_Win : this.Color_Lose;
l.getChildByName("Points").getComponent(cc.Label).string = r >= 1 ? r + "" : "-";
}
if (e && null != this.Light) {
this.EffectParent.destroyAllChildren();
var u = function(e) {
var t = d.DiceParents[e], o = t.children[t.children.length - 1], n = cc.instantiate(d.Light), a = n.getComponent(dragonBones.ArmatureDisplay);
n.active = !0;
n.parent = d.EffectParent;
var i = o.convertToWorldSpaceAR(cc.v3(0, 0, 0)), r = n.parent.convertToNodeSpaceAR(i);
n.position = r;
a.armatureName = "Armature";
a.once(dragonBones.EventObject.COMPLETE, function() {
n.removeFromParent(!0);
n.destroy();
}, d);
a.playAnimation("animation_new_details", 1);
}, d = this;
for (a = 0; a < this.DiceParents.length; a++) u(a);
}
};
i([ p([ cc.Node ]) ], t.prototype, "DiceParents", void 0);
i([ p(cc.Node) ], t.prototype, "DiceItem", void 0);
i([ p(cc.SpriteFrame) ], t.prototype, "Color_Win", void 0);
i([ p(cc.SpriteFrame) ], t.prototype, "Color_Lose", void 0);
i([ p(cc.Node) ], t.prototype, "Light", void 0);
i([ p(cc.Node) ], t.prototype, "EffectParent", void 0);
i([ p({
type: cc.Enum(s.PlayMethod)
}) ], t.prototype, "startOffset", void 0);
i([ p ], t.prototype, "MaxCount", void 0);
return i([ d ], t);
}(cc.Component);
o.default = h;
cc._RF.pop();
}, {
"../../../Game/client/global/enum/game/Event": "Event",
"../../../Game/fromework/helper/EventHelper": "EventHelper",
"../../Common/Utils/CompositeConst": "CompositeConst",
"./LuckyDiceModel": "LuckyDiceModel"
} ],
LuckyDiceRecord: [ function(e, t, o) {
"use strict";
cc._RF.push(t, "5f5caG2cddFh7iysT7tI17T", "LuckyDiceRecord");
var n, a = this && this.__extends || (n = function(e, t) {
return (n = Object.setPrototypeOf || {
__proto__: []
} instanceof Array && function(e, t) {
e.__proto__ = t;
} || function(e, t) {
for (var o in t) Object.prototype.hasOwnProperty.call(t, o) && (e[o] = t[o]);
})(e, t);
}, function(e, t) {
n(e, t);
function o() {
this.constructor = e;
}
e.prototype = null === t ? Object.create(t) : (o.prototype = t.prototype, new o());
}), i = this && this.__decorate || function(e, t, o, n) {
var a, i = arguments.length, r = i < 3 ? t : null === n ? n = Object.getOwnPropertyDescriptor(t, o) : n;
if ("object" == typeof Reflect && "function" == typeof Reflect.decorate) r = Reflect.decorate(e, t, o, n); else for (var l = e.length - 1; l >= 0; l--) (a = e[l]) && (r = (i < 3 ? a(r) : i > 3 ? a(t, o, r) : a(t, o)) || r);
return i > 3 && r && Object.defineProperty(t, o, r), r;
};
Object.defineProperty(o, "__esModule", {
value: !0
});
var r = e("../../../Game/fromework/helper/UIHelper"), l = e("./LuckyDiceModel"), s = cc._decorator, c = s.ccclass, u = s.property, d = function(e) {
a(t, e);
function t() {
var t = null !== e && e.apply(this, arguments) || this;
t.BottomContent = null;
t.BottomRecordParent = null;
t.BottomRecordItem = null;
t.Color_Win = null;
t.Color_Lose = null;
return t;
}
t.prototype.onLoad = function() {
this.refreshBottomRecord();
};
t.prototype.refreshBottomRecord = function() {
var e = l.LuckyDiceModel.Instance;
this.BottomRecordParent.destroyAllChildren();
for (var t = e.declearHistory.getSimpleHistory(17), o = 0; o < t.length; o++) for (var n = t[o], a = 27 + 54 * (o + 1), i = 0; i < 6; i++) {
var r = n.getCount(i);
if (0 != r) {
var s = -(27 + 54 * i), c = cc.instantiate(this.BottomRecordItem);
c.active = !0;
c.setPosition(cc.v2(a, s));
c.parent = this.BottomRecordParent;
c.getChildByName("Background").getComponent(cc.Sprite).spriteFrame = r >= 2 ? this.Color_Win : this.Color_Lose;
c.getChildByName("Points").getComponent(cc.Label).string = r >= 1 ? r + "" : "-";
}
}
};
t.prototype.onCloseClicked = function() {
r.default.Instance.removeMaskLayer(this.node, !0);
};
i([ u(cc.Node) ], t.prototype, "BottomContent", void 0);
i([ u(cc.Node) ], t.prototype, "BottomRecordParent", void 0);
i([ u(cc.Node) ], t.prototype, "BottomRecordItem", void 0);
i([ u(cc.SpriteFrame) ], t.prototype, "Color_Win", void 0);
i([ u(cc.SpriteFrame) ], t.prototype, "Color_Lose", void 0);
return i([ c ], t);
}(cc.Component);
o.default = d;
cc._RF.pop();
}, {
"../../../Game/fromework/helper/UIHelper": "UIHelper",
"./LuckyDiceModel": "LuckyDiceModel"
} ],
LuckyDiceStruct: [ function(e, t, o) {
"use strict";
cc._RF.push(t, "f7c9bkkesVOO7mCQrIzFeep", "LuckyDiceStruct");
Object.defineProperty(o, "__esModule", {
value: !0
});
o.LuckyDiceStruct = void 0;
(function(e) {
var t = function() {
function e(e) {
this.show = [];
e && this.refresh(e);
}
e.prototype.refresh = function(e) {
this.show = e.d;
};
e.prototype.getCount = function(e) {
var t = 0;
this.show.forEach(function(o) {
o == e && t++;
});
return t;
};
return e;
}();
e.HistoryData = t;
var o = function() {
function e(e) {
this.historyArray = [];
e && this.refresh(e);
}
e.prototype.refresh = function(e) {
var o = this;
this.historyArray.splice(0);
e.forEach(function(e) {
var n = new t(e);
o.historyArray.push(n);
});
};
e.prototype.addHistory = function(e) {
100 == this.historyArray.length && this.historyArray.shift();
this.historyArray.push(e);
};
e.prototype.getSimpleHistory = function(e) {
for (var t = [], o = this.historyArray.length - 1; o >= 0; o--) {
var n = this.historyArray[o];
t.unshift(n);
if (t.length == e) break;
}
return t;
};
return e;
}();
e.DeclearHistory = o;
})(o.LuckyDiceStruct || (o.LuckyDiceStruct = {}));
cc._RF.pop();
}, {} ],
MailCashApplication: [ function(e, t, o) {
"use strict";
cc._RF.push(t, "35ae9i8QrtJbKbWIQJ+XVHk", "MailCashApplication");
var n, a = this && this.__extends || (n = function(e, t) {
return (n = Object.setPrototypeOf || {
__proto__: []
} instanceof Array && function(e, t) {
e.__proto__ = t;
} || function(e, t) {
for (var o in t) Object.prototype.hasOwnProperty.call(t, o) && (e[o] = t[o]);
})(e, t);
}, function(e, t) {
n(e, t);
function o() {
this.constructor = e;
}
e.prototype = null === t ? Object.create(t) : (o.prototype = t.prototype, new o());
}), i = this && this.__decorate || function(e, t, o, n) {
var a, i = arguments.length, r = i < 3 ? t : null === n ? n = Object.getOwnPropertyDescriptor(t, o) : n;
if ("object" == typeof Reflect && "function" == typeof Reflect.decorate) r = Reflect.decorate(e, t, o, n); else for (var l = e.length - 1; l >= 0; l--) (a = e[l]) && (r = (i < 3 ? a(r) : i > 3 ? a(t, o, r) : a(t, o)) || r);
return i > 3 && r && Object.defineProperty(t, o, r), r;
};
Object.defineProperty(o, "__esModule", {
value: !0
});
var r = cc._decorator, l = r.ccclass, s = r.property, c = function(e) {
a(t, e);
function t() {
var t = null !== e && e.apply(this, arguments) || this;
t.UserId = null;
t.TransactionId = null;
t.CashAmount = null;
t.CashTo = null;
t.Status = null;
t.APProvedTime = null;
t.OtherContent = null;
return t;
}
t.prototype.init = function(e) {
this.UserId.string = e.body.nickname;
this.TransactionId.string = e.body.transaction_id;
this.CashAmount.string = e.body.withdrawal_amount;
this.CashTo.string = e.body.withdrawal_to;
this.Status.string = e.body.withdrawal_status;
this.APProvedTime.string = e.body.approved_time;
this.OtherContent.string = e.body.other_content;
};
i([ s(cc.Label) ], t.prototype, "UserId", void 0);
i([ s(cc.Label) ], t.prototype, "TransactionId", void 0);
i([ s(cc.Label) ], t.prototype, "CashAmount", void 0);
i([ s(cc.Label) ], t.prototype, "CashTo", void 0);
i([ s(cc.Label) ], t.prototype, "Status", void 0);
i([ s(cc.Label) ], t.prototype, "APProvedTime", void 0);
i([ s(cc.Label) ], t.prototype, "OtherContent", void 0);
return i([ l ], t);
}(cc.Component);
o.default = c;
cc._RF.pop();
}, {} ],
MailCashResult: [ function(e, t, o) {
"use strict";
cc._RF.push(t, "215530gJ1pKJ7rUOEGsYIVc", "MailCashResult");
var n, a = this && this.__extends || (n = function(e, t) {
return (n = Object.setPrototypeOf || {
__proto__: []
} instanceof Array && function(e, t) {
e.__proto__ = t;
} || function(e, t) {
for (var o in t) Object.prototype.hasOwnProperty.call(t, o) && (e[o] = t[o]);
})(e, t);
}, function(e, t) {
n(e, t);
function o() {
this.constructor = e;
}
e.prototype = null === t ? Object.create(t) : (o.prototype = t.prototype, new o());
}), i = this && this.__decorate || function(e, t, o, n) {
var a, i = arguments.length, r = i < 3 ? t : null === n ? n = Object.getOwnPropertyDescriptor(t, o) : n;
if ("object" == typeof Reflect && "function" == typeof Reflect.decorate) r = Reflect.decorate(e, t, o, n); else for (var l = e.length - 1; l >= 0; l--) (a = e[l]) && (r = (i < 3 ? a(r) : i > 3 ? a(t, o, r) : a(t, o)) || r);
return i > 3 && r && Object.defineProperty(t, o, r), r;
};
Object.defineProperty(o, "__esModule", {
value: !0
});
var r = cc._decorator, l = r.ccclass, s = r.property, c = function(e) {
a(t, e);
function t() {
var t = null !== e && e.apply(this, arguments) || this;
t.UserId = null;
t.MailTime = null;
t.TransactionId = null;
t.CashAmount = null;
t.RefundTo = null;
t.Status = null;
t.Reason = null;
t.ReasonDetail = null;
t.RefundTime = null;
t.SuccessColor = null;
t.FailColor = null;
return t;
}
t.prototype.init = function(e) {
this.UserId.string = e.body.nickname;
this.MailTime.string = e.body.reason;
this.TransactionId.string = e.body.transaction_id;
this.CashAmount.string = e.body.withdrawal_amount;
this.RefundTo.string = e.body.withdrawal_to;
this.Status.string = e.body.withdrawal_status;
this.ReasonDetail.string = e.body.reason;
this.RefundTime.string = e.body.refund_time;
this.Reason.node.color = 5 == e.email_type ? this.SuccessColor : this.FailColor;
this.ReasonDetail.node.color = 5 == e.email_type ? this.SuccessColor : this.FailColor;
};
i([ s(cc.Label) ], t.prototype, "UserId", void 0);
i([ s(cc.Label) ], t.prototype, "MailTime", void 0);
i([ s(cc.Label) ], t.prototype, "TransactionId", void 0);
i([ s(cc.Label) ], t.prototype, "CashAmount", void 0);
i([ s(cc.Label) ], t.prototype, "RefundTo", void 0);
i([ s(cc.Label) ], t.prototype, "Status", void 0);
i([ s(cc.Label) ], t.prototype, "Reason", void 0);
i([ s(cc.Label) ], t.prototype, "ReasonDetail", void 0);
i([ s(cc.Label) ], t.prototype, "RefundTime", void 0);
i([ s(cc.Color) ], t.prototype, "SuccessColor", void 0);
i([ s(cc.Color) ], t.prototype, "FailColor", void 0);
return i([ l ], t);
}(cc.Component);
o.default = c;
cc._RF.pop();
}, {} ],
MailDetail: [ function(e, t, o) {
"use strict";
cc._RF.push(t, "3e7b0elDtVJHYDREcFnfKhh", "MailDetail");
var n, a = this && this.__extends || (n = function(e, t) {
return (n = Object.setPrototypeOf || {
__proto__: []
} instanceof Array && function(e, t) {
e.__proto__ = t;
} || function(e, t) {
for (var o in t) Object.prototype.hasOwnProperty.call(t, o) && (e[o] = t[o]);
})(e, t);
}, function(e, t) {
n(e, t);
function o() {
this.constructor = e;
}
e.prototype = null === t ? Object.create(t) : (o.prototype = t.prototype, new o());
}), i = this && this.__decorate || function(e, t, o, n) {
var a, i = arguments.length, r = i < 3 ? t : null === n ? n = Object.getOwnPropertyDescriptor(t, o) : n;
if ("object" == typeof Reflect && "function" == typeof Reflect.decorate) r = Reflect.decorate(e, t, o, n); else for (var l = e.length - 1; l >= 0; l--) (a = e[l]) && (r = (i < 3 ? a(r) : i > 3 ? a(t, o, r) : a(t, o)) || r);
return i > 3 && r && Object.defineProperty(t, o, r), r;
};
Object.defineProperty(o, "__esModule", {
value: !0
});
var r = e("../../../../Game/fromework/global/Tools"), l = e("../../../../Game/fromework/helper/EventHelper"), s = e("../../../../Game/fromework/helper/UIHelper"), c = e("../../../../Game/client/global/enum/game/Event"), u = e("./MailCashApplication"), d = e("./MailCashResult"), p = e("./MailNormal"), h = e("./MailRecharge"), f = cc._decorator, _ = f.ccclass, m = f.property, y = function(e) {
a(t, e);
function t() {
var t = null !== e && e.apply(this, arguments) || this;
t.Title = null;
t.Date = null;
t.MailNormal = null;
t.MailRecharge = null;
t.MailCashApplication = null;
t.MailCashResult = null;
return t;
}
t.prototype.init = function(e) {
this.Title.string = e.subject;
this.Date.string = r.Tools.TDate.format(1e3 * e.send_time, "dd/MM/yyyy");
0 != e.email_type && 1 != e.email_type && 2 != e.email_type || this.MailNormal.init(e);
3 == e.email_type && this.MailRecharge.init(e);
4 == e.email_type && this.MailCashApplication.init(e);
5 != e.email_type && 6 != e.email_type || this.MailCashResult.init(e);
this.MailNormal.node.active = 0 == e.email_type || 1 == e.email_type || 2 == e.email_type;
this.MailRecharge.node.active = 3 == e.email_type;
this.MailCashApplication.node.active = 4 == e.email_type;
this.MailCashResult.node.active = 5 == e.email_type || 6 == e.email_type;
};
t.prototype.onCloseClicked = function() {
s.default.Instance.removeMaskLayer(this.node);
l.default.Instance.Global.emit(c.MailEvent.MAIL_DETAIL_CLOSE);
};
i([ m(cc.Label) ], t.prototype, "Title", void 0);
i([ m(cc.Label) ], t.prototype, "Date", void 0);
i([ m(p.default) ], t.prototype, "MailNormal", void 0);
i([ m(h.default) ], t.prototype, "MailRecharge", void 0);
i([ m(u.default) ], t.prototype, "MailCashApplication", void 0);
i([ m(d.default) ], t.prototype, "MailCashResult", void 0);
return i([ _ ], t);
}(cc.Component);
o.default = y;
cc._RF.pop();
}, {
"../../../../Game/client/global/enum/game/Event": "Event",
"../../../../Game/fromework/global/Tools": "Tools",
"../../../../Game/fromework/helper/EventHelper": "EventHelper",
"../../../../Game/fromework/helper/UIHelper": "UIHelper",
"./MailCashApplication": "MailCashApplication",
"./MailCashResult": "MailCashResult",
"./MailNormal": "MailNormal",
"./MailRecharge": "MailRecharge"
} ],
MailItem: [ function(e, t, o) {
"use strict";
cc._RF.push(t, "938060qeQRJK6LjCmfV9WSh", "MailItem");
var n, a = this && this.__extends || (n = function(e, t) {
return (n = Object.setPrototypeOf || {
__proto__: []
} instanceof Array && function(e, t) {
e.__proto__ = t;
} || function(e, t) {
for (var o in t) Object.prototype.hasOwnProperty.call(t, o) && (e[o] = t[o]);
})(e, t);
}, function(e, t) {
n(e, t);
function o() {
this.constructor = e;
}
e.prototype = null === t ? Object.create(t) : (o.prototype = t.prototype, new o());
}), i = this && this.__decorate || function(e, t, o, n) {
var a, i = arguments.length, r = i < 3 ? t : null === n ? n = Object.getOwnPropertyDescriptor(t, o) : n;
if ("object" == typeof Reflect && "function" == typeof Reflect.decorate) r = Reflect.decorate(e, t, o, n); else for (var l = e.length - 1; l >= 0; l--) (a = e[l]) && (r = (i < 3 ? a(r) : i > 3 ? a(t, o, r) : a(t, o)) || r);
return i > 3 && r && Object.defineProperty(t, o, r), r;
};
Object.defineProperty(o, "__esModule", {
value: !0
});
var r = e("../../../../Game/fromework/global/Tools"), l = e("../../../../Game/fromework/helper/UIHelper"), s = e("../../../../Game/client/global/enum/game/Const"), c = e("../../../model/MailModel"), u = e("./MailDetail"), d = cc._decorator, p = d.ccclass, h = d.property, f = function(e) {
a(t, e);
function t() {
var t = null !== e && e.apply(this, arguments) || this;
t.Back = null;
t.HeadBack = null;
t.Icon = null;
t.Title = null;
t.Detail = null;
t.Date = null;
t.Back_Frames = [];
t.Head_Frames = [];
t.Icon_Frames = [];
t.Font_Colors = [];
t.ClickButton = null;
t._data = null;
return t;
}
t.prototype.onItemInitCallFunc = function(e) {
this._data = e;
var t = 0 == this._data.is_read ? 1 : 0;
this.Back.spriteFrame = this.Back_Frames[t];
this.Icon.spriteFrame = this.Icon_Frames[t];
this.Title.node.color = this.Font_Colors[t];
this.Detail.node.color = this.Font_Colors[t];
this.Date.node.color = this.Font_Colors[t];
this.Title.string = this._data.subject;
0 == e.email_type && (this.Detail.string = this._data.body);
1 == e.email_type && (this.Detail.string = this._data.body.content);
2 == e.email_type && (this.Detail.string = this._data.body.content);
3 == e.email_type && (this.Detail.string = this._data.body.other_content);
4 == e.email_type && (this.Detail.string = this._data.body.other_content);
5 == e.email_type && (this.Detail.string = this._data.body.fixed_content);
6 == e.email_type && (this.Detail.string = this._data.body.fixed_content);
this.Date.string = r.Tools.TDate.format(1e3 * this._data.send_time, "dd/MM/yyyy");
};
t.prototype.onItemEnterCallFunc = function() {
this.node.opacity = 255;
this.ClickButton.interactable = !0;
};
t.prototype.onItemExitCallFunc = function() {
this.node.opacity = 0;
this.ClickButton.interactable = !1;
};
t.prototype.onCellClicked = function() {
var e = this;
0 == this._data.is_read && c.default.Instance.sendChangeStatus(this._data._id);
l.default.Instance.addBundleMaskLayer(s.BundleUIPath.MailDetail, function(t) {
t.getComponent(u.default).init(e._data);
});
};
i([ h(cc.Sprite) ], t.prototype, "Back", void 0);
i([ h(cc.Sprite) ], t.prototype, "HeadBack", void 0);
i([ h(cc.Sprite) ], t.prototype, "Icon", void 0);
i([ h(cc.Label) ], t.prototype, "Title", void 0);
i([ h(cc.Label) ], t.prototype, "Detail", void 0);
i([ h(cc.Label) ], t.prototype, "Date", void 0);
i([ h([ cc.SpriteFrame ]) ], t.prototype, "Back_Frames", void 0);
i([ h([ cc.SpriteFrame ]) ], t.prototype, "Head_Frames", void 0);
i([ h([ cc.SpriteFrame ]) ], t.prototype, "Icon_Frames", void 0);
i([ h([ cc.Color ]) ], t.prototype, "Font_Colors", void 0);
i([ h(cc.Button) ], t.prototype, "ClickButton", void 0);
return i([ p ], t);
}(cc.Component);
o.default = f;
cc._RF.pop();
}, {
"../../../../Game/client/global/enum/game/Const": "Const",
"../../../../Game/fromework/global/Tools": "Tools",
"../../../../Game/fromework/helper/UIHelper": "UIHelper",
"../../../model/MailModel": "MailModel",
"./MailDetail": "MailDetail"
} ],
MailModel: [ function(e, t, o) {
"use strict";
cc._RF.push(t, "86be6MGBIhJkZMpsAOkoA78", "MailModel");
Object.defineProperty(o, "__esModule", {
value: !0
});
var n = e("../../Game/client/global/enum/game/Event"), a = e("../../Game/client/global/enum/net/C2S"), i = e("../../Game/client/global/enum/net/S2C"), r = e("../../Game/fromework/helper/EventHelper"), l = e("../../Game/fromework/mvvm/modelView/ViewModel"), s = e("../../fromework/helper/NetHelper"), c = function() {
function e() {
this._serverTime = 0;
this._mailDataList = [];
}
Object.defineProperty(e, "Instance", {
get: function() {
e._instance || (e._instance = new e());
return e._instance;
},
enumerable: !1,
configurable: !0
});
e.prototype.Init = function() {
r.default.Instance.Net.bind(i.S2C.MAIL.EMAIL_LIST, this._onEmailList, this);
r.default.Instance.Net.bind(i.S2C.MAIL.EMAIL_CHANGE_STATUS, this._onChangeStatus, this);
};
e.prototype.clear = function() {
this._serverTime = 0;
this._mailDataList.splice(0);
this._mailDataList = [];
};
e.prototype.getMailList = function() {
return this._mailDataList.concat();
};
e.prototype.sortMailList = function() {
this._mailDataList.length > 0 && this._mailDataList.sort(function(e, t) {
return e.is_read == t.is_read ? new Date(1e3 * e.send_time).getTime() - new Date(1e3 * t.send_time).getTime() : e.is_read - t.is_read;
});
};
e.prototype._onChangeStatus = function(e) {
var t = e.getUserData(), o = this._mailDataList.find(function(e) {
return e._id == t.id && 0 == e.is_read;
});
if (o) {
o.is_read = 1;
var n = JSON.parse(cc.sys.localStorage.getItem("Mail_Read_list" + l.VM.getValue("user.uid")));
if (!(n = n || []).find(function(e) {
return e._id == t.id;
})) {
n.push(o);
cc.sys.localStorage.setItem("Mail_Read_list" + l.VM.getValue("user.uid"), JSON.stringify(n));
}
}
this._mailDataList.forEach(function(e) {
e.is_read;
});
};
e.prototype._onEmailList = function(e) {
var t = this, o = e.getUserData();
this._serverTime = 1e3 * o.stime;
o.data.length;
var a = o.data, i = JSON.parse(cc.sys.localStorage.getItem("Mail_Read_list" + l.VM.getValue("user.uid")));
i = (i = i || []).filter(function(e) {
var o = new Date(1e3 * e.send_time).getTime();
return t._serverTime - o < 6048e5;
});
this._mailDataList = a.concat(i);
this.sortMailList();
r.default.Instance.Global.emit(n.MailEvent.MAIL_GET_LIST);
};
e.prototype.sendEmailList = function() {
var e = s.default.Instance.makeMsg(a.C2S.EMAIL_LIST, {
u: l.VM.getValue("user.uid"),
t: l.VM.getValue("user.token")
});
s.default.Instance.send(e);
};
e.prototype.sendChangeStatus = function(e) {
var t = s.default.Instance.makeMsg(a.C2S.EMAIL_CHANGE_STATUS, {
id: e,
u: l.VM.getValue("user.uid"),
t: l.VM.getValue("user.token")
});
s.default.Instance.send(t);
};
e._instance = null;
return e;
}();
o.default = c;
cc._RF.pop();
}, {
"../../Game/client/global/enum/game/Event": "Event",
"../../Game/client/global/enum/net/C2S": "C2S",
"../../Game/client/global/enum/net/S2C": "S2C",
"../../Game/fromework/helper/EventHelper": "EventHelper",
"../../Game/fromework/mvvm/modelView/ViewModel": "ViewModel",
"../../fromework/helper/NetHelper": "NetHelper"
} ],
MailNormal: [ function(e, t, o) {
"use strict";
cc._RF.push(t, "78072iJL21HR4JIWfggAoWC", "MailNormal");
var n, a = this && this.__extends || (n = function(e, t) {
return (n = Object.setPrototypeOf || {
__proto__: []
} instanceof Array && function(e, t) {
e.__proto__ = t;
} || function(e, t) {
for (var o in t) Object.prototype.hasOwnProperty.call(t, o) && (e[o] = t[o]);
})(e, t);
}, function(e, t) {
n(e, t);
function o() {
this.constructor = e;
}
e.prototype = null === t ? Object.create(t) : (o.prototype = t.prototype, new o());
}), i = this && this.__decorate || function(e, t, o, n) {
var a, i = arguments.length, r = i < 3 ? t : null === n ? n = Object.getOwnPropertyDescriptor(t, o) : n;
if ("object" == typeof Reflect && "function" == typeof Reflect.decorate) r = Reflect.decorate(e, t, o, n); else for (var l = e.length - 1; l >= 0; l--) (a = e[l]) && (r = (i < 3 ? a(r) : i > 3 ? a(t, o, r) : a(t, o)) || r);
return i > 3 && r && Object.defineProperty(t, o, r), r;
};
Object.defineProperty(o, "__esModule", {
value: !0
});
var r = cc._decorator, l = r.ccclass, s = r.property, c = function(e) {
a(t, e);
function t() {
var t = null !== e && e.apply(this, arguments) || this;
t.Detail = null;
return t;
}
t.prototype.init = function(e) {
"string" == typeof e.body ? this.Detail.string = e.body : this.Detail.string = e.body.nickname + "\n" + e.body.content;
};
i([ s(cc.Label) ], t.prototype, "Detail", void 0);
return i([ l ], t);
}(cc.Component);
o.default = c;
cc._RF.pop();
}, {} ],
MailRecharge: [ function(e, t, o) {
"use strict";
cc._RF.push(t, "b828c22nulLdocLvDiHgSpU", "MailRecharge");
var n, a = this && this.__extends || (n = function(e, t) {
return (n = Object.setPrototypeOf || {
__proto__: []
} instanceof Array && function(e, t) {
e.__proto__ = t;
} || function(e, t) {
for (var o in t) Object.prototype.hasOwnProperty.call(t, o) && (e[o] = t[o]);
})(e, t);
}, function(e, t) {
n(e, t);
function o() {
this.constructor = e;
}
e.prototype = null === t ? Object.create(t) : (o.prototype = t.prototype, new o());
}), i = this && this.__decorate || function(e, t, o, n) {
var a, i = arguments.length, r = i < 3 ? t : null === n ? n = Object.getOwnPropertyDescriptor(t, o) : n;
if ("object" == typeof Reflect && "function" == typeof Reflect.decorate) r = Reflect.decorate(e, t, o, n); else for (var l = e.length - 1; l >= 0; l--) (a = e[l]) && (r = (i < 3 ? a(r) : i > 3 ? a(t, o, r) : a(t, o)) || r);
return i > 3 && r && Object.defineProperty(t, o, r), r;
};
Object.defineProperty(o, "__esModule", {
value: !0
});
var r = cc._decorator, l = r.ccclass, s = r.property, c = function(e) {
a(t, e);
function t() {
var t = null !== e && e.apply(this, arguments) || this;
t.TransactionId = null;
t.DepositAmount = null;
t.JoinedActivity = null;
t.TotalGet = null;
t.Cash = null;
t.Bonus = null;
t.DepositTime = null;
t.OtherContent = null;
return t;
}
t.prototype.init = function(e) {
this.TransactionId.string = e.body.transaction_id;
this.DepositAmount.string = e.body.deposited_amount;
this.JoinedActivity.string = e.body.joined_activity;
this.TotalGet.string = e.body.total_get;
this.Cash.string = e.body.cash;
this.Bonus.string = e.body.bonus_cash;
this.DepositTime.string = e.body.deposit_time;
this.OtherContent.string = e.body.other_content;
};
i([ s(cc.Label) ], t.prototype, "TransactionId", void 0);
i([ s(cc.Label) ], t.prototype, "DepositAmount", void 0);
i([ s(cc.Label) ], t.prototype, "JoinedActivity", void 0);
i([ s(cc.Label) ], t.prototype, "TotalGet", void 0);
i([ s(cc.Label) ], t.prototype, "Cash", void 0);
i([ s(cc.Label) ], t.prototype, "Bonus", void 0);
i([ s(cc.Label) ], t.prototype, "DepositTime", void 0);
i([ s(cc.Label) ], t.prototype, "OtherContent", void 0);
return i([ l ], t);
}(cc.Component);
o.default = c;
cc._RF.pop();
}, {} ],
MailUI: [ function(e, t, o) {
"use strict";
cc._RF.push(t, "d6622Bp3chC94Q7Saq2Xh7N", "MailUI");
var n, a = this && this.__extends || (n = function(e, t) {
return (n = Object.setPrototypeOf || {
__proto__: []
} instanceof Array && function(e, t) {
e.__proto__ = t;
} || function(e, t) {
for (var o in t) Object.prototype.hasOwnProperty.call(t, o) && (e[o] = t[o]);
})(e, t);
}, function(e, t) {
n(e, t);
function o() {
this.constructor = e;
}
e.prototype = null === t ? Object.create(t) : (o.prototype = t.prototype, new o());
}), i = this && this.__decorate || function(e, t, o, n) {
var a, i = arguments.length, r = i < 3 ? t : null === n ? n = Object.getOwnPropertyDescriptor(t, o) : n;
if ("object" == typeof Reflect && "function" == typeof Reflect.decorate) r = Reflect.decorate(e, t, o, n); else for (var l = e.length - 1; l >= 0; l--) (a = e[l]) && (r = (i < 3 ? a(r) : i > 3 ? a(t, o, r) : a(t, o)) || r);
return i > 3 && r && Object.defineProperty(t, o, r), r;
};
Object.defineProperty(o, "__esModule", {
value: !0
});
var r = e("../../../../fromework/component/listView/ListView"), l = e("../../../../Game/fromework/helper/EventHelper"), s = e("../../../../Game/fromework/helper/UIHelper"), c = e("../../../../Game/client/global/enum/game/Event"), u = e("../../../../Game/client/global/enum/game/Game"), d = e("../../../model/MailModel"), p = cc._decorator, h = p.ccclass, f = p.property, _ = function(e) {
a(t, e);
function t() {
var t = null !== e && e.apply(this, arguments) || this;
t.ListView = null;
t.EnptyNode = null;
return t;
}
t.prototype.onEnable = function() {
l.default.Instance.Global.bind(c.MailEvent.MAIL_GET_LIST, this.refreshList, this);
l.default.Instance.Global.bind(c.MailEvent.MAIL_DETAIL_CLOSE, this.refreshList, this);
};
t.prototype.onDisable = function() {
l.default.Instance.Global.unbind(c.MailEvent.MAIL_GET_LIST, this.refreshList, this);
l.default.Instance.Global.unbind(c.MailEvent.MAIL_DETAIL_CLOSE, this.refreshList, this);
};
t.prototype.start = function() {
d.default.Instance.sendEmailList();
l.default.Instance.Global.emit(c.RedDotEvent.REFRESH_RED_DOT_DATA, {
key: u.GameEnum.RedDotKey.Mail,
value: 0
});
};
t.prototype.refreshList = function() {
var e = d.default.Instance.getMailList();
this.ListView.datas = e;
this.EnptyNode.active = 0 == e.length;
};
t.prototype.onCloseClicked = function() {
s.default.Instance.removeLayer(this.node);
};
i([ f(r.default) ], t.prototype, "ListView", void 0);
i([ f(cc.Node) ], t.prototype, "EnptyNode", void 0);
return i([ h ], t);
}(cc.Component);
o.default = _;
cc._RF.pop();
}, {
"../../../../Game/client/global/enum/game/Event": "Event",
"../../../../Game/client/global/enum/game/Game": "Game",
"../../../../Game/fromework/helper/EventHelper": "EventHelper",
"../../../../Game/fromework/helper/UIHelper": "UIHelper",
"../../../../fromework/component/listView/ListView": "ListView",
"../../../model/MailModel": "MailModel"
} ],
MarqueeModel: [ function(e, t, o) {
"use strict";
cc._RF.push(t, "890ebqdbA5ClqhyyUoMLiD6", "MarqueeModel");
Object.defineProperty(o, "__esModule", {
value: !0
});
var n = e("../../Game/client/global/enum/game/Event"), a = e("../../Game/client/global/enum/net/C2S"), i = e("../../Game/client/global/enum/net/S2C"), r = e("../../Game/client/model/CommonModel"), l = e("../../Game/fromework/helper/EventHelper"), s = e("../../Game/fromework/mvvm/modelView/ViewModel"), c = e("../../fromework/helper/NetHelper"), u = function() {
function e() {}
Object.defineProperty(e, "Instance", {
get: function() {
e._instance || (e._instance = new e());
return e._instance;
},
enumerable: !1,
configurable: !0
});
e.prototype.Init = function() {
l.default.Instance.Net.bind(i.S2C.SYSTEM.SYSTEM_MSG, this._onSystemMsg, this);
l.default.Instance.Net.bind(i.S2C.SYSTEM.SYSTEM_GAMEHALLMARQUEE, this._onSystemGamehallmarquee, this);
l.default.Instance.Net.bind(i.S2C.GAME.ROOM_SYSTEM_NOTICE, this._onSystemNotice, this);
l.default.Instance.Net.bind(i.S2C.LOBBY.LOBBY_GET_SYSTEM_NOTICE, this._onLobbyGetSystemNotice, this);
};
e.prototype.destory = function() {
l.default.Instance.Net.unbind(i.S2C.SYSTEM.SYSTEM_MSG, this._onSystemMsg, this);
l.default.Instance.Net.unbind(i.S2C.SYSTEM.SYSTEM_GAMEHALLMARQUEE, this._onSystemGamehallmarquee, this);
l.default.Instance.Net.unbind(i.S2C.GAME.ROOM_SYSTEM_NOTICE, this._onSystemNotice, this);
l.default.Instance.Net.unbind(i.S2C.LOBBY.LOBBY_GET_SYSTEM_NOTICE, this._onLobbyGetSystemNotice, this);
};
Object.defineProperty(e.prototype, "uid", {
get: function() {
return s.VM.getValue("user.uid");
},
enumerable: !1,
configurable: !0
});
Object.defineProperty(e.prototype, "token", {
get: function() {
return s.VM.getValue("user.token");
},
enumerable: !1,
configurable: !0
});
e.prototype._onSystemMsg = function(e) {
var t = e.getUserData(), o = [];
t.d.forEach(function(e) {
var n = new r.Common.MarqueeData();
n.id = t.id;
n.rid = t.r;
n.rtype = t.rtype;
n.param = e;
o.push(n);
});
l.default.Instance.Global.emit(n.MarqueeEvent.PUSH_MESSAGE, o);
};
e.prototype._onSystemGamehallmarquee = function(e) {
var t = (e.getUserData() || []).map(function(e, t) {
var o = new r.Common.MarqueeNoticeData({
type: 3,
msg: "" + t,
iv_t: 0,
ed_t: 6
});
e.bet ? o.msg = "<color=#31FFA5>" + e.name + "</color> win <color=#F9FD69>₹" + e.amount + "</color> with <color=#FE2E2E>₹" + e.bet + "</color> in <color=#31FFA5>" + e.cls_name + "</color>" : o.msg = "<color=#31FFA5>" + e.name + "</color> win <color=#F9FD69>₹" + e.amount + "</color> in <color=#31FFA5>" + e.cls_name + "</color>";
return o;
});
t.length > 0 && l.default.Instance.Global.emit(n.MarqueeEvent.PUSH_NOTICE, t);
};
e.prototype._onSystemNotice = function(e) {
var t = e.getUserData(), o = new r.Common.MarqueeNoticeData(t);
l.default.Instance.Global.emit(n.MarqueeEvent.PUSH_NOTICE, o);
};
e.prototype._onLobbyGetSystemNotice = function(e) {
var t = e.getUserData();
if (t && t.data && null != t.data[0]) {
var o = new r.Common.MarqueeNoticeData(t.data[0]);
l.default.Instance.Global.emit(n.MarqueeEvent.PUSH_NOTICE, o);
}
};
e.prototype.sendLobbyGetSystemNotice = function() {
var e = c.default.Instance.makeMsg(a.C2S.LOBBY_GET_SYSTEM_NOTICE, {
u: this.uid,
t: this.token
});
c.default.Instance.send(e);
};
e._instance = null;
return e;
}();
o.default = u;
cc._RF.pop();
}, {
"../../Game/client/global/enum/game/Event": "Event",
"../../Game/client/global/enum/net/C2S": "C2S",
"../../Game/client/global/enum/net/S2C": "S2C",
"../../Game/client/model/CommonModel": "CommonModel",
"../../Game/fromework/helper/EventHelper": "EventHelper",
"../../Game/fromework/mvvm/modelView/ViewModel": "ViewModel",
"../../fromework/helper/NetHelper": "NetHelper"
} ],
Marquee: [ function(e, t, o) {
"use strict";
cc._RF.push(t, "0bc82qir2BJ7pjg2oQ6/zCO", "Marquee");
var n, a = this && this.__extends || (n = function(e, t) {
return (n = Object.setPrototypeOf || {
__proto__: []
} instanceof Array && function(e, t) {
e.__proto__ = t;
} || function(e, t) {
for (var o in t) Object.prototype.hasOwnProperty.call(t, o) && (e[o] = t[o]);
})(e, t);
}, function(e, t) {
n(e, t);
function o() {
this.constructor = e;
}
e.prototype = null === t ? Object.create(t) : (o.prototype = t.prototype, new o());
}), i = this && this.__decorate || function(e, t, o, n) {
var a, i = arguments.length, r = i < 3 ? t : null === n ? n = Object.getOwnPropertyDescriptor(t, o) : n;
if ("object" == typeof Reflect && "function" == typeof Reflect.decorate) r = Reflect.decorate(e, t, o, n); else for (var l = e.length - 1; l >= 0; l--) (a = e[l]) && (r = (i < 3 ? a(r) : i > 3 ? a(t, o, r) : a(t, o)) || r);
return i > 3 && r && Object.defineProperty(t, o, r), r;
};
Object.defineProperty(o, "__esModule", {
value: !0
});
var r = e("../../Game/client/global/enum/game/Event"), l = e("../../Game/client/model/LanguageModel"), s = e("../../Game/fromework/global/Tools"), c = e("../../Game/fromework/helper/EventHelper"), u = cc._decorator, d = u.ccclass, p = u.property, h = function(e) {
a(t, e);
function t() {
var t = null !== e && e.apply(this, arguments) || this;
t.Mask = null;
t.Message = null;
t.Speed = 200;
t.Cls = -1;
t._messageList = [];
t._isPlay = !1;
return t;
}
t.prototype.onEnable = function() {
c.default.Instance.Global.bind(r.MarqueeEvent.PUSH_MESSAGE, this.onMessage, this);
};
t.prototype.onDisable = function() {
c.default.Instance.Global.unbind(r.MarqueeEvent.PUSH_MESSAGE, this.onMessage, this);
};
t.prototype.checkRoomType = function(e) {
var t = e.split("_"), o = null != t[0] ? t[0] : null;
return null != o && parseInt(o) == this.Cls;
};
t.prototype.onMessage = function(e) {
var t = this;
e.getUserData().forEach(function(e) {
t.checkRoomType(e.rtype) && t._messageList.push(e);
});
this._isPlay || this.PlayMarquee();
};
t.prototype.PlayMarquee = function() {
var e = this;
if (0 != this._messageList.length) {
var t = this._messageList.shift();
if (null != t) {
this._isPlay = !0;
t.param && t.param.cash && (t.param.cash = s.Tools.TNumber.num2single(parseFloat(t.param.cash)));
this.Message.string = s.Tools.TStr.replaceString(l.default.getString(t.id), t.param);
this.Message._updateRichText();
this.Message.node.x = this.Mask.width / 2;
var o = this.Mask.width + this.Message.node.width, n = o / this.Speed;
cc.tween(this.Message.node).by(n, {
x: -o
}).call(function() {
0 != e._messageList.length ? e.PlayMarquee() : e._isPlay = !1;
}).start();
} else this._isPlay = !1;
} else this._isPlay = !1;
};
i([ p(cc.Node) ], t.prototype, "Mask", void 0);
i([ p(cc.RichText) ], t.prototype, "Message", void 0);
i([ p(cc.Float) ], t.prototype, "Speed", void 0);
i([ p(cc.Integer) ], t.prototype, "Cls", void 0);
return i([ d ], t);
}(cc.Component);
o.default = h;
cc._RF.pop();
}, {
"../../Game/client/global/enum/game/Event": "Event",
"../../Game/client/model/LanguageModel": "LanguageModel",
"../../Game/fromework/global/Tools": "Tools",
"../../Game/fromework/helper/EventHelper": "EventHelper"
} ],
MoneyAction: [ function(e, t, o) {
"use strict";
cc._RF.push(t, "b4118OzmDlHyY4OxyBLw/Gp", "MoneyAction");
var n, a = this && this.__extends || (n = function(e, t) {
return (n = Object.setPrototypeOf || {
__proto__: []
} instanceof Array && function(e, t) {
e.__proto__ = t;
} || function(e, t) {
for (var o in t) Object.prototype.hasOwnProperty.call(t, o) && (e[o] = t[o]);
})(e, t);
}, function(e, t) {
n(e, t);
function o() {
this.constructor = e;
}
e.prototype = null === t ? Object.create(t) : (o.prototype = t.prototype, new o());
}), i = this && this.__decorate || function(e, t, o, n) {
var a, i = arguments.length, r = i < 3 ? t : null === n ? n = Object.getOwnPropertyDescriptor(t, o) : n;
if ("object" == typeof Reflect && "function" == typeof Reflect.decorate) r = Reflect.decorate(e, t, o, n); else for (var l = e.length - 1; l >= 0; l--) (a = e[l]) && (r = (i < 3 ? a(r) : i > 3 ? a(t, o, r) : a(t, o)) || r);
return i > 3 && r && Object.defineProperty(t, o, r), r;
};
Object.defineProperty(o, "__esModule", {
value: !0
});
var r = cc._decorator, l = r.ccclass, s = r.property, c = function(e) {
a(t, e);
function t() {
var t = null !== e && e.apply(this, arguments) || this;
t.MoneyNode = null;
t.coinPool = null;
t.offset = cc.Vec2.ZERO;
t._callFunc = null;
return t;
}
t.prototype.onLoad = function() {
this.coinPool = new cc.NodePool();
this.initCoinPool();
};
t.prototype.initCoinPool = function(e) {
void 0 === e && (e = 20);
for (var t = 0; t < e; t++) {
var o = cc.instantiate(this.MoneyNode);
this.coinPool.put(o);
}
};
t.prototype.playAnimation = function(e, t, o, n, a) {
null != n && (this.offset = n);
this._callFunc = a;
this.playCoinFlyAnim(e, t, o);
};
t.prototype.playCoinFlyAnim = function(e, t, o, n) {
var a = this;
void 0 === n && (n = 80);
var i = this.coinPool.size(), r = i > e ? 0 : e - i;
this.initCoinPool(r);
var l = this.getCirclePoints(n, t, e).map(function(e) {
var n = a.coinPool.get();
n.active = !0;
n.setPosition(t);
a.node.addChild(n);
return {
node: n,
stPos: t,
mdPos: e,
edPos: o,
dis: e.sub(o).mag()
};
}), s = (l = l.sort(function(e, t) {
return e.dis - t.dis > 0 ? 1 : e.dis - t.dis < 0 ? -1 : 0;
})).length;
l.forEach(function(e, t) {
e.node.runAction(cc.sequence(cc.moveTo(.1, e.mdPos), cc.delayTime(.01 * (t + 5)), cc.spawn(cc.moveTo(.5, e.edPos), cc.scaleTo(.5, .3)), cc.callFunc(function() {
a.coinPool.put(e.node);
t == s - 1 && a._callFunc && a._callFunc();
})));
});
};
t.prototype.getCirclePoints = function(e, t, o, n) {
void 0 === n && (n = 60);
for (var a = [], i = Math.PI / 180 * Math.round(360 / o), r = 0; r < o; r++) {
var l = t.x + e * Math.sin(i * r), s = t.y + e * Math.cos(i * r);
l += this.offset.x;
s += this.offset.y;
a.unshift(cc.v3(l + Math.random() * n, s + Math.random() * n, 0));
}
return a;
};
i([ s(cc.Node) ], t.prototype, "MoneyNode", void 0);
return i([ l ], t);
}(cc.Component);
o.default = c;
cc._RF.pop();
}, {} ],
MonthCardItem: [ function(e, t, o) {
"use strict";
cc._RF.push(t, "69235T0LJBL2boEkbTLHAXl", "MonthCardItem");
var n, a = this && this.__extends || (n = function(e, t) {
return (n = Object.setPrototypeOf || {
__proto__: []
} instanceof Array && function(e, t) {
e.__proto__ = t;
} || function(e, t) {
for (var o in t) Object.prototype.hasOwnProperty.call(t, o) && (e[o] = t[o]);
})(e, t);
}, function(e, t) {
n(e, t);
function o() {
this.constructor = e;
}
e.prototype = null === t ? Object.create(t) : (o.prototype = t.prototype, new o());
}), i = this && this.__decorate || function(e, t, o, n) {
var a, i = arguments.length, r = i < 3 ? t : null === n ? n = Object.getOwnPropertyDescriptor(t, o) : n;
if ("object" == typeof Reflect && "function" == typeof Reflect.decorate) r = Reflect.decorate(e, t, o, n); else for (var l = e.length - 1; l >= 0; l--) (a = e[l]) && (r = (i < 3 ? a(r) : i > 3 ? a(t, o, r) : a(t, o)) || r);
return i > 3 && r && Object.defineProperty(t, o, r), r;
};
Object.defineProperty(o, "__esModule", {
value: !0
});
var r = e("../../../component/RedDot"), l = e("../../../model/MonthCardModel"), s = e("../../Wallet/WalletHelper"), c = e("../../../../Game/client/global/enum/game/Const"), u = e("../../../../Game/fromework/global/ResLoader"), d = e("../../../../Game/client/global/enum/game/Game"), p = e("../../../../Game/fromework/global/Tools"), h = e("../../../../Game/client/model/LanguageModel"), f = e("../../../../Game/fromework/helper/ConfigHelper"), _ = e("../../../component/pop/tipsHand"), m = e("../../../../Game/fromework/mvvm/modelView/ViewModel"), y = e("../../../global/PopHelper"), g = cc._decorator, v = g.ccclass, C = g.property, b = function(e) {
a(t, e);
function t() {
var t = null !== e && e.apply(this, arguments) || this;
t.Background = null;
t.Title = null;
t.NewIcon = null;
t.Frames_Background = [];
t.Node_Color = [];
t.RenewButton = null;
t.NotToBuy = null;
t.NotToBuyCash = null;
t.NotToBuyBonus = null;
t.NotToBuyEveryDayCash = null;
t.NotToBuyCost = null;
t.Reward = null;
t.RewardCash = null;
t.RewardTime = null;
t.RewardButton = null;
t.RewardButtonLabel = null;
t.RewardFinish = null;
t.BuyButtonAnimation = null;
t.Animations = [];
t.SelectEffect = null;
t.RedDot = null;
t._data = null;
return t;
}
t.prototype.onLoad = function() {
var e = this, t = this.NotToBuyCost.node.getComponent(cc.LabelOutline);
t && (t.color = this.NotToBuyCost.node.color);
var o = this.RewardButtonLabel.node.getComponent(cc.LabelOutline);
o && (o.color = this.RewardButtonLabel.node.color);
u.default.Instance.loadBundleRes(c.BundleUIPath.MonthCardLight, cc.Prefab, function(t, o) {
if (!t && e.node.isValid) {
var n = [ {
scale: .5,
pos: cc.v2(-78.5, 23)
}, {
scale: .5,
pos: cc.v2(-27, -.5)
}, {
scale: .5,
pos: cc.v2(-5.57, 21.46)
} ], a = [ {
scale: .5,
pos: cc.v2(-65.5, 18.7)
}, {
scale: .5,
pos: cc.v2(-27, -4.1)
}, {
scale: 0,
pos: cc.v2(-27, -4.1)
} ];
e.Animations.forEach(function(t, i) {
for (var r = [], l = 1 == i ? a.length : n.length, s = function(e) {
var l = cc.instantiate(o), s = 1 == i ? a[e] : n[e];
l.parent = t;
l.setScale(s.scale);
l.setPosition(s.pos);
var c = l.getChildByName("light").getComponent(cc.Animation);
c.stop();
r.push(cc.callFunc(function() {
l && l.isValid && c.play();
}));
r.push(cc.delayTime(.5));
}, c = 0; c < l; c++) s(c);
r.push(cc.delayTime(1));
r.push(cc.callFunc(function() {
e.BuyButtonAnimation.play();
}));
r.push(cc.delayTime(2.5));
t.runAction(cc.repeatForever(cc.sequence(r)));
});
}
});
};
t.prototype.showHand = function(e) {
if (e) {
this.NotToBuyCost.node.parent.parent.getChildByName("tipsHand").active = !0;
this.NotToBuyCost.node.parent.parent.getChildByName("tipsHand").getComponent(_.default).show(this._data.price);
}
};
t.prototype.refresh = function(e, t, o) {
void 0 === o && (o = !1);
this.NotToBuyCost.node.parent.parent.getChildByName("tipsHand").active = !1;
this._data = e;
this._data && this.RedDot.setBindKeys([ d.GameEnum.RedDotKey.MonthCard + this._data.id ]);
var n = h.default.getString("MoneySymbol");
this.SelectEffect.active = o && 1 != this._data.card_status;
this.Frames_Background[t] && (this.Background.spriteFrame = this.Frames_Background[t]);
this.Title.destroyAllChildren();
this.NewIcon.active = 1 == this._data.tag;
this.Node_Color[1].getComponent(cc.Label).string = p.Tools.TStr.replaceString(h.default.getString("MONTHCARD_TITLE_DAY"), {
day: this._data.day
});
1 == this._data.card_status && this._data.remaining_days <= this._data.renew_num ? this.RenewButton.active = !0 : this.RenewButton.active = !1;
this.NotToBuy.active = 2 == this._data.card_status;
this.Reward.active = 1 == this._data.card_status;
this.NotToBuyCash.string = this._data.deposit + "";
this.NotToBuyBonus.string = this._data.bonus + "";
this.NotToBuyEveryDayCash.string = this._data.day_deposit + "";
this.NotToBuyCost.string = n + this._data.price;
this.NotToBuyCost.node.parent.parent.getChildByName("tipsHand").active = !1;
this.RewardCash.string = this._data.day_deposit + "";
var a = f.ConfigHelper.Instance.getValue("fontcolor", "MONTHCARD_SURPLUS_DAY", "color");
this.RewardTime.string = p.Tools.TStr.replaceString(h.default.getString("MONTHCARD_SURPLUS_TIME"), {
color: a,
day: this._data.remaining_days
});
this.RewardButton.active = 1 == this._data.today_collection;
this.RewardFinish.active = 2 == this._data.today_collection;
};
t.prototype.onRenewClicked = function() {
s.default.Instance.openRechargeView(function() {}, this._data.price, 0, this._data.id);
};
t.prototype.onBuyClicked = function() {
s.default.Instance.openRechargeView(function() {}, this._data.price, 0, this._data.id);
};
t.prototype.onRewardClicked = function() {
1 == this._data.card_status && 1 == this._data.today_collection && (this._data.day_need_flow && this._data.day_need_flow <= m.VM.getValue("wallet.totalFlow") ? l.MonthCardProxy.Instance.sendMonthCardReward(1, this._data.id) : y.PopHelper.Instance.showTips("Total wins and losses ₹" + this._data.day_need_flow + "\n are required to receive cash"));
};
i([ C(cc.Sprite) ], t.prototype, "Background", void 0);
i([ C(cc.Node) ], t.prototype, "Title", void 0);
i([ C(cc.Node) ], t.prototype, "NewIcon", void 0);
i([ C([ cc.SpriteFrame ]) ], t.prototype, "Frames_Background", void 0);
i([ C([ cc.Node ]) ], t.prototype, "Node_Color", void 0);
i([ C(cc.Node) ], t.prototype, "RenewButton", void 0);
i([ C(cc.Node) ], t.prototype, "NotToBuy", void 0);
i([ C(cc.Label) ], t.prototype, "NotToBuyCash", void 0);
i([ C(cc.Label) ], t.prototype, "NotToBuyBonus", void 0);
i([ C(cc.Label) ], t.prototype, "NotToBuyEveryDayCash", void 0);
i([ C(cc.Label) ], t.prototype, "NotToBuyCost", void 0);
i([ C(cc.Node) ], t.prototype, "Reward", void 0);
i([ C(cc.Label) ], t.prototype, "RewardCash", void 0);
i([ C(cc.RichText) ], t.prototype, "RewardTime", void 0);
i([ C(cc.Node) ], t.prototype, "RewardButton", void 0);
i([ C(cc.Label) ], t.prototype, "RewardButtonLabel", void 0);
i([ C(cc.Node) ], t.prototype, "RewardFinish", void 0);
i([ C(cc.Animation) ], t.prototype, "BuyButtonAnimation", void 0);
i([ C([ cc.Node ]) ], t.prototype, "Animations", void 0);
i([ C(cc.Node) ], t.prototype, "SelectEffect", void 0);
i([ C(r.default) ], t.prototype, "RedDot", void 0);
return i([ v ], t);
}(cc.Component);
o.default = b;
cc._RF.pop();
}, {
"../../../../Game/client/global/enum/game/Const": "Const",
"../../../../Game/client/global/enum/game/Game": "Game",
"../../../../Game/client/model/LanguageModel": "LanguageModel",
"../../../../Game/fromework/global/ResLoader": "ResLoader",
"../../../../Game/fromework/global/Tools": "Tools",
"../../../../Game/fromework/helper/ConfigHelper": "ConfigHelper",
"../../../../Game/fromework/mvvm/modelView/ViewModel": "ViewModel",
"../../../component/RedDot": "RedDot",
"../../../component/pop/tipsHand": "tipsHand",
"../../../global/PopHelper": "PopHelper",
"../../../model/MonthCardModel": "MonthCardModel",
"../../Wallet/WalletHelper": "WalletHelper"
} ],
MonthCardLobbyView: [ function(e, t, o) {
"use strict";
cc._RF.push(t, "2a1865eIqFJbpqAvnSLEH5c", "MonthCardLobbyView");
var n, a = this && this.__extends || (n = function(e, t) {
return (n = Object.setPrototypeOf || {
__proto__: []
} instanceof Array && function(e, t) {
e.__proto__ = t;
} || function(e, t) {
for (var o in t) Object.prototype.hasOwnProperty.call(t, o) && (e[o] = t[o]);
})(e, t);
}, function(e, t) {
n(e, t);
function o() {
this.constructor = e;
}
e.prototype = null === t ? Object.create(t) : (o.prototype = t.prototype, new o());
}), i = this && this.__decorate || function(e, t, o, n) {
var a, i = arguments.length, r = i < 3 ? t : null === n ? n = Object.getOwnPropertyDescriptor(t, o) : n;
if ("object" == typeof Reflect && "function" == typeof Reflect.decorate) r = Reflect.decorate(e, t, o, n); else for (var l = e.length - 1; l >= 0; l--) (a = e[l]) && (r = (i < 3 ? a(r) : i > 3 ? a(t, o, r) : a(t, o)) || r);
return i > 3 && r && Object.defineProperty(t, o, r), r;
};
Object.defineProperty(o, "__esModule", {
value: !0
});
var r = e("../../../../Game/fromework/helper/EventHelper"), l = e("../../../../Game/fromework/helper/UIHelper"), s = e("../../../../Game/client/global/enum/game/Event"), c = e("../../../model/MonthCardModel"), u = e("../../../model/WalletModel"), d = e("../../Wallet/WalletHelper"), p = e("../../../component/pop/tipsHand"), h = cc._decorator, f = h.ccclass, _ = h.property, m = function(e) {
a(t, e);
function t() {
var t = null !== e && e.apply(this, arguments) || this;
t.BannerItemUpSprite = [];
t._price = 0;
t._idBuy = 0;
t._isBuy = !1;
t.indexNum = 0;
t.numData = [ {
add: 499,
get: 750
}, {
add: 1999,
get: 2920
}, {
add: 9999,
get: 14400
} ];
return t;
}
t.prototype.onEnable = function() {
r.default.Instance.Global.bind(s.MonthCardEent.MONTHCARD_CLOSE_VIEW, this.onCloseClicked, this);
};
t.prototype.onDisable = function() {
r.default.Instance.Global.unbind(s.MonthCardEent.MONTHCARD_CLOSE_VIEW, this.onCloseClicked, this);
};
t.prototype.onLoad = function() {
r.default.Instance.Global.bind(s.WalletEvent.RECHARGE_BROWSER_END, this._onShowApp, this);
};
t.prototype.onDestroy = function() {
r.default.Instance.Global.unbind(s.WalletEvent.RECHARGE_BROWSER_END, this._onShowApp, this);
};
t.prototype.initView = function(e) {
this.indexNum = e;
this.onGetList();
this.node.getChildByName("MainPanel").getChildByName("baoxiang1").getComponent(cc.Sprite).spriteFrame = this.BannerItemUpSprite[e - 1];
this.node.getChildByName("MainPanel").getChildByName("BuyButton").getChildByName("numLabel").getComponent(cc.Label).string = "₹" + this.numData[e - 1].add + " Only";
this.node.getChildByName("MainPanel").getChildByName("tipsLabel").getComponent(cc.Label).string = "₹" + this.numData[e - 1].add;
this.node.getChildByName("MainPanel").getChildByName("getLabel").getComponent(cc.Label).string = "₹" + this.numData[e - 1].get;
};
t.prototype._onShowApp = function() {
this && this.node && this.node.isValid && this.scheduleOnce(function() {
u.WalletProxy.Instance.sendGetUserWallet();
u.WalletProxy.Instance.sendGetRechargeUserInfo();
c.MonthCardProxy.Instance.sendGetMonthCardList();
});
};
t.prototype.onGetList = function() {
var e = c.MonthCardProxy.Instance.monthCardAll;
e.yester_status;
var t = e.all_month_card[this.indexNum - 1];
this._price = t.price;
this.node.getChildByName("MainPanel").getChildByName("BuyButton").getChildByName("tipsHand").active = !0;
this.node.getChildByName("MainPanel").getChildByName("BuyButton").getChildByName("tipsHand").getComponent(p.default).show(t.price);
this._idBuy = t.id;
2 == t.card_status || 1 == t.card_status && t.remaining_days <= t.renew_num ? this._isBuy = !1 : this._isBuy = !0;
};
t.prototype.onClickBuy = function() {
this._isBuy || d.default.Instance.openRechargeView(function() {}, this._price, 0, this._idBuy, 0, 0, 1);
l.default.Instance.removeMaskLayer(this.node, !0);
};
t.prototype.onCloseClicked = function() {
l.default.Instance.removeMaskLayer(this.node, !0);
};
i([ _(cc.SpriteFrame) ], t.prototype, "BannerItemUpSprite", void 0);
return i([ f ], t);
}(cc.Component);
o.default = m;
cc._RF.pop();
}, {
"../../../../Game/client/global/enum/game/Event": "Event",
"../../../../Game/fromework/helper/EventHelper": "EventHelper",
"../../../../Game/fromework/helper/UIHelper": "UIHelper",
"../../../component/pop/tipsHand": "tipsHand",
"../../../model/MonthCardModel": "MonthCardModel",
"../../../model/WalletModel": "WalletModel",
"../../Wallet/WalletHelper": "WalletHelper"
} ],
MonthCardModel: [ function(e, t, o) {
"use strict";
cc._RF.push(t, "6b295P/cb9JGooc8Bl+M3A1", "MonthCardModel");
Object.defineProperty(o, "__esModule", {
value: !0
});
o.MonthCardProxy = void 0;
var n = e("../../fromework/helper/NetHelper"), a = e("../global/PopHelper"), i = e("./WalletModel"), r = e("../global/Global"), l = e("../../Game/client/model/CommonModel"), s = e("../../Game/fromework/helper/EventHelper"), c = e("../../Game/client/global/enum/game/Event"), u = e("../../Game/client/global/enum/game/Game"), d = e("../../Game/client/model/LanguageModel"), p = e("../../Game/fromework/mvvm/modelView/ViewModel"), h = e("../../Game/Script/global/GlobalValue"), f = e("../../Game/fromework/net/NetHttp"), _ = e("../Festival/Common/FestivalEvent"), m = function() {
function e() {
this._monthCardAll = null;
this._rewardType = -1;
this.goldSliverData = null;
this.sendGetNewMonthCardListCb = null;
this._monthCardAll = new l.Common.MonthCardAll();
}
Object.defineProperty(e, "Instance", {
get: function() {
e._instance || (e._instance = new e());
return e._instance;
},
enumerable: !1,
configurable: !0
});
e.prototype.Init = function() {
s.default.Instance.Global.bind(n.NetState.NET_HTTP_ERROR, this.onHttpError, this);
};
Object.defineProperty(e.prototype, "monthCardAll", {
get: function() {
return this._monthCardAll;
},
enumerable: !1,
configurable: !0
});
e.prototype.onHttpError = function() {
this._rewardType = -1;
};
e.prototype.checkOneKeyReward = function() {
var e = !1;
this._monthCardAll.all_month_card.forEach(function(t) {
1 == t.card_status && t.remaining_days > 0 && 1 == t.today_collection && (e = !0);
});
return e;
};
e.prototype.getMonthCardByIndex = function(e) {
return this.monthCardAll.all_month_card[e];
};
e.prototype._onGetMonthCardList = function(e) {
var t = JSON.parse(e.response);
if (t.code = 1) {
this._monthCardAll.refresh(t.data);
var o = 0;
this._monthCardAll.all_month_card.forEach(function(e) {
if (1 == e.card_status && e.remaining_days > 0 && 1 == e.today_collection) {
o++;
s.default.Instance.Global.emit(c.RedDotEvent.REFRESH_RED_DOT_DATA, {
key: u.GameEnum.RedDotKey.MonthCard + e.id,
value: 1
});
} else s.default.Instance.Global.emit(c.RedDotEvent.REFRESH_RED_DOT_DATA, {
key: u.GameEnum.RedDotKey.MonthCard + e.id,
value: 0
});
});
s.default.Instance.Global.emit(c.RedDotEvent.REFRESH_RED_DOT_DATA, {
key: u.GameEnum.RedDotKey.MonthCard,
value: o
});
s.default.Instance.Global.emit(c.MonthCardEent.MONTHCARD_GET_LIST);
}
};
e.prototype._onMonthCardReward = function(e) {
var t = JSON.parse(e.response);
if (t.code = 1) {
0 == this._rewardType && d.default.getString("MONTHCARD_REWARD_YESTERDAY");
1 == this._rewardType && d.default.getString("MONTHCARD_REWARD_TODAY");
2 == this._rewardType && d.default.getString("MONTHCARD_REWARD_TODAY");
this._rewardType = -1;
a.PopHelper.Instance.showReward(r.Global.Instance.changeReward(t.data), function() {});
this.sendGetMonthCardList();
i.WalletProxy.Instance.sendGetUserWallet();
}
};
e.prototype.sendGetMonthCardList = function(e) {
var t = {
uid: p.VM.getValue("user.uid"),
token: p.VM.getValue("user.token"),
type: e
};
f.default.Instance.post(h.default.getInstance().WalletUrl + "monthlycardlist", t, this._onGetMonthCardList.bind(this), !0);
};
e.prototype.sendMonthCardReward = function(e, t) {
if (-1 == this._rewardType) {
this._rewardType = e;
var o = {
uid: p.VM.getValue("user.uid"),
type: e,
monthly_card_id: t,
token: p.VM.getValue("user.token")
};
f.default.Instance.post(h.default.getInstance().WalletUrl + "monthlycardrewards", o, this._onMonthCardReward.bind(this), !0);
}
};
e.prototype._onGetGoldSliverData = function(e) {
var t = JSON.parse(e.response);
if (t.code = 1) {
this.goldSliverData = t.data;
s.default.Instance.Global.emit("onGetGoldSliverData");
if (this.sendGetNewMonthCardListCb) {
this.sendGetNewMonthCardListCb();
this.sendGetNewMonthCardListCb = null;
}
}
};
e.prototype.sendGetNewMonthCardList = function(e) {
void 0 === e && (e = null);
var t = {
uid: p.VM.getValue("user.uid"),
token: p.VM.getValue("user.token")
};
this.sendGetNewMonthCardListCb = e;
f.default.Instance.post(h.default.getInstance().WalletUrl + "newmonthlycardlist", t, this._onGetGoldSliverData.bind(this), !0);
};
e.prototype.sendNewMonthCardReward = function(e, t) {
var o = {
uid: p.VM.getValue("user.uid"),
type: e,
monthly_card_id: t,
token: p.VM.getValue("user.token")
};
f.default.Instance.post(h.default.getInstance().WalletUrl + "monthlycardrewards", o, function(e) {
var t = JSON.parse(e.response);
(t.code = 1) && a.PopHelper.Instance.showReward(r.Global.Instance.changeReward(t.data), function() {
s.default.Instance.Global.emit(_.FestivalEvent.HALL_MONTH_CARD_UI_RECHARGE);
});
}, !0);
};
e._instance = null;
return e;
}();
o.MonthCardProxy = m;
cc._RF.pop();
}, {
"../../Game/Script/global/GlobalValue": "GlobalValue",
"../../Game/client/global/enum/game/Event": "Event",
"../../Game/client/global/enum/game/Game": "Game",
"../../Game/client/model/CommonModel": "CommonModel",
"../../Game/client/model/LanguageModel": "LanguageModel",
"../../Game/fromework/helper/EventHelper": "EventHelper",
"../../Game/fromework/mvvm/modelView/ViewModel": "ViewModel",
"../../Game/fromework/net/NetHttp": "NetHttp",
"../../fromework/helper/NetHelper": "NetHelper",
"../Festival/Common/FestivalEvent": "FestivalEvent",
"../global/Global": "Global",
"../global/PopHelper": "PopHelper",
"./WalletModel": "WalletModel"
} ],
MonthCardUpdate: [ function(e, t, o) {
"use strict";
cc._RF.push(t, "fc429k5y4tJZLrkrw9TDc4f", "MonthCardUpdate");
var n, a = this && this.__extends || (n = function(e, t) {
return (n = Object.setPrototypeOf || {
__proto__: []
} instanceof Array && function(e, t) {
e.__proto__ = t;
} || function(e, t) {
for (var o in t) Object.prototype.hasOwnProperty.call(t, o) && (e[o] = t[o]);
})(e, t);
}, function(e, t) {
n(e, t);
function o() {
this.constructor = e;
}
e.prototype = null === t ? Object.create(t) : (o.prototype = t.prototype, new o());
}), i = this && this.__decorate || function(e, t, o, n) {
var a, i = arguments.length, r = i < 3 ? t : null === n ? n = Object.getOwnPropertyDescriptor(t, o) : n;
if ("object" == typeof Reflect && "function" == typeof Reflect.decorate) r = Reflect.decorate(e, t, o, n); else for (var l = e.length - 1; l >= 0; l--) (a = e[l]) && (r = (i < 3 ? a(r) : i > 3 ? a(t, o, r) : a(t, o)) || r);
return i > 3 && r && Object.defineProperty(t, o, r), r;
};
Object.defineProperty(o, "__esModule", {
value: !0
});
var r = e("../../../../Game/fromework/helper/EventHelper"), l = e("../../../../Game/client/global/enum/game/Event"), s = e("../../../model/MonthCardModel"), c = e("../../active/ActiveManager"), u = cc._decorator, d = u.ccclass, p = u.property, h = function(e) {
a(t, e);
function t() {
var t = null !== e && e.apply(this, arguments) || this;
t.AlertPanel = null;
t.Money = null;
return t;
}
t.prototype.onEnable = function() {
r.default.Instance.Global.bind(l.MonthCardEent.MONTHCARD_GET_LIST, this.checkClose, this);
};
t.prototype.onDisable = function() {
r.default.Instance.Global.unbind(l.MonthCardEent.MONTHCARD_GET_LIST, this.checkClose, this);
};
t.prototype.checkClose = function() {
var e = s.MonthCardProxy.Instance.monthCardAll.close_not_get_deposit, t = s.MonthCardProxy.Instance.monthCardAll.close_not_get_bonus;
e <= 0 && t <= 0 && this.close();
};
t.prototype.show = function() {
var e = s.MonthCardProxy.Instance.monthCardAll.close_not_get_deposit, t = s.MonthCardProxy.Instance.monthCardAll.close_not_get_bonus;
this.Money.string = (e + t).toString();
this.openAction();
};
t.prototype.close = function() {
this.unscheduleAllCallbacks();
this.closeAction(function() {
c.default.Instance.openLoginActiveAlert();
});
};
t.prototype.openAction = function() {
this.AlertPanel.setPosition(cc.v2(0, this.node.height / 2 + this.AlertPanel.height / 2));
this.AlertPanel.runAction(cc.moveTo(.1, cc.v2(0, 0)));
};
t.prototype.closeAction = function(e) {
var t = this, o = cc.moveTo(.1, cc.v2(0, -(this.node.height / 2 + this.AlertPanel.height / 2))), n = cc.callFunc(function() {
e && e.apply(t);
t.node.removeFromParent(!0);
t.node.destroy();
}), a = cc.sequence(o, n);
this.AlertPanel.runAction(a);
};
t.prototype.onReceiveClicked = function() {
s.MonthCardProxy.Instance.sendMonthCardReward(4);
};
i([ p(cc.Node) ], t.prototype, "AlertPanel", void 0);
i([ p(cc.Label) ], t.prototype, "Money", void 0);
return i([ d ], t);
}(cc.Component);
o.default = h;
cc._RF.pop();
}, {
"../../../../Game/client/global/enum/game/Event": "Event",
"../../../../Game/fromework/helper/EventHelper": "EventHelper",
"../../../model/MonthCardModel": "MonthCardModel",
"../../active/ActiveManager": "ActiveManager"
} ],
MonthCard: [ function(e, t, o) {
"use strict";
cc._RF.push(t, "c5f03RpbvFJQajiCdtH0hBW", "MonthCard");
var n, a = this && this.__extends || (n = function(e, t) {
return (n = Object.setPrototypeOf || {
__proto__: []
} instanceof Array && function(e, t) {
e.__proto__ = t;
} || function(e, t) {
for (var o in t) Object.prototype.hasOwnProperty.call(t, o) && (e[o] = t[o]);
})(e, t);
}, function(e, t) {
n(e, t);
function o() {
this.constructor = e;
}
e.prototype = null === t ? Object.create(t) : (o.prototype = t.prototype, new o());
}), i = this && this.__decorate || function(e, t, o, n) {
var a, i = arguments.length, r = i < 3 ? t : null === n ? n = Object.getOwnPropertyDescriptor(t, o) : n;
if ("object" == typeof Reflect && "function" == typeof Reflect.decorate) r = Reflect.decorate(e, t, o, n); else for (var l = e.length - 1; l >= 0; l--) (a = e[l]) && (r = (i < 3 ? a(r) : i > 3 ? a(t, o, r) : a(t, o)) || r);
return i > 3 && r && Object.defineProperty(t, o, r), r;
};
Object.defineProperty(o, "__esModule", {
value: !0
});
var r = e("../../../../Game/fromework/helper/EventHelper"), l = e("../../../../Game/fromework/helper/UIHelper"), s = e("../../../component/pop/Alert"), c = e("../../../../Game/client/global/enum/game/Event"), u = e("../../../global/PopHelper"), d = e("../../../../Game/client/model/LanguageModel"), p = e("../../../model/MonthCardModel"), h = e("../../../model/WalletModel"), f = e("./MonthCardItem"), _ = e("../../../../Game/client/global/enum/game/Const"), m = e("../../../../Game/fromework/mvvm/modelView/ViewModel"), y = e("../../../global/Global"), g = cc._decorator, v = g.ccclass, C = g.property, b = function(e) {
a(t, e);
function t() {
var t = null !== e && e.apply(this, arguments) || this;
t.MainPanel = null;
t.MnthCardItem = null;
t.ItemParent = null;
t.RewardButton = null;
t._selectIndex = -1;
t._setIsFromLobbyView = !1;
return t;
}
t.prototype.onEnable = function() {
r.default.Instance.Global.bind(c.MonthCardEent.MONTHCARD_GET_LIST, this.onGetList, this);
r.default.Instance.Global.bind(c.MonthCardEent.MONTHCARD_CLOSE_VIEW, this.onCloseClicked, this);
};
t.prototype.onDisable = function() {
r.default.Instance.Global.unbind(c.MonthCardEent.MONTHCARD_GET_LIST, this.onGetList, this);
r.default.Instance.Global.unbind(c.MonthCardEent.MONTHCARD_CLOSE_VIEW, this.onCloseClicked, this);
};
t.prototype.onLoad = function() {
r.default.Instance.Global.bind(c.WalletEvent.RECHARGE_BROWSER_END, this._onShowApp, this);
p.MonthCardProxy.Instance.sendGetMonthCardList();
};
t.prototype.onDestroy = function() {
r.default.Instance.Global.unbind(c.WalletEvent.RECHARGE_BROWSER_END, this._onShowApp, this);
};
t.prototype._onShowApp = function() {
this && this.node && this.node.isValid && this.scheduleOnce(function() {
h.WalletProxy.Instance.sendGetUserWallet();
h.WalletProxy.Instance.sendGetRechargeUserInfo();
p.MonthCardProxy.Instance.sendGetMonthCardList();
});
};
t.prototype.setIsFromLobbyView = function(e) {
this._setIsFromLobbyView = e;
};
t.prototype.refreshSelect = function(e) {
this._selectIndex = e;
this.onGetList();
};
t.prototype.onGetList = function() {
p.MonthCardProxy.Instance.monthCardAll.yester_status;
this.initItem();
};
t.prototype.initItem = function() {
this.ItemParent.destroyAllChildren();
for (var e = p.MonthCardProxy.Instance.monthCardAll, t = [], o = 0; o < e.all_month_card.length; o++) {
var n = e.all_month_card[o], a = cc.instantiate(this.MnthCardItem);
a.parent = this.ItemParent;
a.setPosition(cc.Vec2.ZERO);
var i = a.getComponent(f.default);
if (e.all_month_card[o].price <= m.VM.getValue("wallet.withdraw") && e.all_month_card[o].price <= m.VM.getValue("wallet.remainingWithAmt") && m.VM.getValue("wallet.totalRecharge") > 0 && e.all_month_card[o].price >= y.Global.Instance.tipHandNum) {
var r = {
nodeTips: i,
buyNum: e.all_month_card[o].price
};
t.push(r);
}
i.refresh(n, o, this._selectIndex == o);
}
t.length > 0 && t[t.length - 1].nodeTips.showHand(!0);
};
t.prototype.refreshItem = function() {
var e = this, t = p.MonthCardProxy.Instance.monthCardAll;
this.ItemParent.children.forEach(function(o, n) {
var a = t.all_month_card[n];
o.getComponent(f.default).refresh(a, n, e._selectIndex == n);
});
};
t.prototype.onTipsClicked = function() {
var e = {
title: d.default.getString("PROMPT_NOTICE"),
content: d.default.getString("MONTHCARD_TIPS"),
rightTitle: d.default.getString("GENGXIN_QUEDING")
};
l.default.Instance.addBundleMaskLayer(_.BundleUIPath.Alert, function(t) {
var o = t.getComponent(s.default);
o.Content.horizontalAlign = cc.Label.HorizontalAlign.LEFT;
o.show(e);
}, u.PopZindex.Alert);
};
t.prototype.onReceivedAllClicked = function() {
p.MonthCardProxy.Instance.checkOneKeyReward();
};
t.prototype.onCloseClicked = function() {
l.default.Instance.removeMaskLayer(this.node, !0);
};
i([ C(cc.Node) ], t.prototype, "MainPanel", void 0);
i([ C(cc.Prefab) ], t.prototype, "MnthCardItem", void 0);
i([ C(cc.Node) ], t.prototype, "ItemParent", void 0);
i([ C(cc.Node) ], t.prototype, "RewardButton", void 0);
return i([ v ], t);
}(cc.Component);
o.default = b;
cc._RF.pop();
}, {
"../../../../Game/client/global/enum/game/Const": "Const",
"../../../../Game/client/global/enum/game/Event": "Event",
"../../../../Game/client/model/LanguageModel": "LanguageModel",
"../../../../Game/fromework/helper/EventHelper": "EventHelper",
"../../../../Game/fromework/helper/UIHelper": "UIHelper",
"../../../../Game/fromework/mvvm/modelView/ViewModel": "ViewModel",
"../../../component/pop/Alert": "Alert",
"../../../global/Global": "Global",
"../../../global/PopHelper": "PopHelper",
"../../../model/MonthCardModel": "MonthCardModel",
"../../../model/WalletModel": "WalletModel",
"./MonthCardItem": "MonthCardItem"
} ],
NetHelper: [ function(e, t, o) {
"use strict";
cc._RF.push(t, "b60d1jD9JxBj645NjyBeknU", "NetHelper");
Object.defineProperty(o, "__esModule", {
value: !0
});
o.NetType = o.NetState = void 0;
var n = e("../../../BundleGame/client/model/GameModel"), a = e("../../../BundleGame/client/logic/game/HearBeat"), i = e("../../../BundleGame/client/model/LobbyModel"), r = e("../../../BundleGame/client/model/MailModel"), l = e("../../../BundleGame/client/model/WalletModel"), s = e("../../../BundleGame/client/model/RedDotModel"), c = e("../../../BundleGame/client/model/PhoneModel"), u = e("../../Game/fromework/net/NetUtils"), d = e("../../Game/fromework/net/NetHttp"), p = e("../../Game/fromework/helper/EventHelper"), h = e("../../Game/client/model/LanguageModel"), f = e("../../Game/client/model/UpdateModel"), _ = e("../../Game/client/global/enum/game/Const"), m = e("../../Game/client/global/enum/net/C2S"), y = e("../../client/global/PopHelper"), g = e("../../platform/Platform"), v = e("../net/NetWebSocket");
o.NetState = {
NET_WEBSOCKET_CONNECT_BEGIN: "NET_WEBSOCKET_CONNECT_BEGIN",
NET_WEBSOCKET_CONNECT_OPEN: "NET_WEBSOCKET_CONNECT_OPEN",
NET_WEBSOCKET_CONNECT_ERROR: "NET_WEBSOCKET_CONNECT_ERROR",
NET_WEBSOCKET_CONNECT_CLOSE: "NET_WEBSOCKET_CONNECT_CLOSE",
NET_WEBSOCKET_CONNECT_DROP: "NET_WEBSOCKET_CONNECT_DROP",
NET_HTTP_TIMEOUT: "NET_HTTP_TIMEOUT",
NET_HTTP_ERROR: "NET_HTTP_ERROR"
};
(function(e) {
e[e.HTTP = 0] = "HTTP";
e[e.WEBSOCKET = 2] = "WEBSOCKET";
})(o.NetType || (o.NetType = {}));
var C = function() {
function e() {
this._http = null;
this._websocket = null;
this._httpUrl = "";
this._dropWSFlag = !1;
this._httpUrl = "";
this._http = d.default.Instance;
this._websocket = v.default.Instance;
this._http.bindCallback(this._httpError.bind(this), this._httpTimeout.bind(this), this._received.bind(this));
this._websocket.bindCallback(this._websocketOpen.bind(this), this._websocketError.bind(this), this._websocketClose.bind(this), this._websocketDrop.bind(this), this._received.bind(this));
g.default.warn(" NetHelper constructor");
}
e.prototype._httpSend = function(e, t, o) {
void 0 === o && (o = !1);
o ? this._http.get(e, t) : this._http.post(e, t);
};
e.prototype._webSocketSend = function(e, t, o) {
void 0 === t && (t = !0);
void 0 === o && (o = !1);
o ? this._websocket.pushMsg(e, t) : this._websocket.sendMsg(e, t);
};
e.prototype._websocketOpen = function() {
y.PopHelper.Instance.hideWaiting();
a.default.Instance.begin();
p.default.Instance.Global.emit(o.NetState.NET_WEBSOCKET_CONNECT_OPEN);
};
e.prototype._websocketClose = function() {
var e = this;
p.default.Instance.Global.emit(o.NetState.NET_WEBSOCKET_CONNECT_CLOSE);
a.default.Instance.end();
this._dropWSFlag ? this._dropWSFlag = !1 : setTimeout(function() {
e.connect();
}, u.ReconnectionDelay);
};
e.prototype._websocketError = function() {
p.default.Instance.Global.emit(o.NetState.NET_WEBSOCKET_CONNECT_ERROR);
};
e.prototype._showAlert = function() {
var e = parseInt(cc.sys.localStorage.getItem("NET_TIME_OUT_COUNT"));
isNaN(e) && (e = 0);
e++;
cc.sys.localStorage.setItem("NET_TIME_OUT_COUNT", String(e));
y.PopHelper.Instance.hideWaiting();
var t = {
title: h.default.getString("PROMPT_NOTICE"),
content: "Please check your network",
rightTitle: h.default.getString("PROMPT_RETRY"),
rightCallFunc: function() {
p.default.Instance.stop();
n.default.Instance.clear();
i.default.Instance.clear();
r.default.Instance.clear();
s.default.Instance.clear();
l.WalletProxy.Instance.clear();
y.PopHelper.Instance.clear();
f.default.Instance.clear();
c.PhoneProxy.Instance.clear();
g.default.setOrientation(_.Orientation.Landscape);
cc.game.restart();
},
cancelCallFunc: function() {
p.default.Instance.stop();
n.default.Instance.clear();
i.default.Instance.clear();
r.default.Instance.clear();
s.default.Instance.clear();
l.WalletProxy.Instance.clear();
y.PopHelper.Instance.clear();
f.default.Instance.clear();
c.PhoneProxy.Instance.clear();
g.default.setOrientation(_.Orientation.Landscape);
cc.game.restart();
}
};
y.PopHelper.Instance.showAlert(t);
};
e.prototype._websocketDrop = function() {
p.default.Instance.Global.emit(o.NetState.NET_WEBSOCKET_CONNECT_DROP);
a.default.Instance.end();
this._showAlert();
};
e.prototype._httpError = function() {
p.default.Instance.Global.emit(o.NetState.NET_HTTP_ERROR);
};
e.prototype._httpTimeout = function() {
p.default.Instance.Global.emit(o.NetState.NET_HTTP_TIMEOUT);
};
e.prototype._received = function(e, t, o) {
y.PopHelper.Instance.hideWaiting();
var n = u.uncodeMsg(e), a = n.m && n.f ? "S2C_" + n.m + "_" + n.f : null, i = n.d || null;
g.default.log(" NetHelper _received url  ", t, JSON.stringify(n), JSON.stringify(o));
g.default.log(" NetHelper _received  ", a);
a && p.default.Instance.Net.emit(a, i);
};
Object.defineProperty(e, "Instance", {
get: function() {
e._Instance || (e._Instance = new e());
return e._Instance;
},
enumerable: !1,
configurable: !0
});
Object.defineProperty(e.prototype, "WebSocketUrl", {
set: function(e) {
this._websocket.webSocketUrl = e;
},
enumerable: !1,
configurable: !0
});
Object.defineProperty(e.prototype, "HttpUrl", {
set: function(e) {
this._httpUrl = e || "";
},
enumerable: !1,
configurable: !0
});
e.prototype.getConnectState = function() {
return this._websocket.readyState;
};
e.prototype.connect = function() {
if (null != this._websocket.webSocketUrl && null != this._websocket.webSocketUrl && "" != this._websocket.webSocketUrl) {
y.PopHelper.Instance.showWaiting(0, "Connecting...");
p.default.Instance.Global.emit(o.NetState.NET_WEBSOCKET_CONNECT_BEGIN);
this._websocket.connect();
}
};
e.prototype.closeWS = function() {
this._websocket.close();
};
e.prototype.dropWS = function() {
this._dropWSFlag = !0;
this._websocket.drop();
};
e.prototype.send = function(e, t, o) {
var n = e, a = t || !0, i = o || !1;
if (n.m != m.C2S.HB[0]) {
y.PopHelper.Instance.showWaiting(2, "Connecting...");
g.default.log(" NetHelper send   message:", JSON.stringify(n));
}
this._webSocketSend(n, a, i);
};
e.prototype.sendHttp = function(e, t) {
this._httpSend(this._httpUrl, e, t || !1);
};
e.prototype.sendLoadHttp = function(e, t) {
this._httpSend(g.default.getHotUpdateUrl(), e, t || !1);
};
e.prototype.sendLoginPhoneTokenHttp = function(e, t) {
this._httpSend(g.default.getHotUpdateUrl(), e, t || !1);
};
e.prototype.makeMsg = function(e, t) {
return {
m: e[0],
f: e[1],
d: t
};
};
e._Instance = null;
return e;
}();
o.default = C;
cc._RF.pop();
}, {
"../../../BundleGame/client/logic/game/HearBeat": "HearBeat",
"../../../BundleGame/client/model/GameModel": "GameModel",
"../../../BundleGame/client/model/LobbyModel": "LobbyModel",
"../../../BundleGame/client/model/MailModel": "MailModel",
"../../../BundleGame/client/model/PhoneModel": "PhoneModel",
"../../../BundleGame/client/model/RedDotModel": "RedDotModel",
"../../../BundleGame/client/model/WalletModel": "WalletModel",
"../../Game/client/global/enum/game/Const": "Const",
"../../Game/client/global/enum/net/C2S": "C2S",
"../../Game/client/model/LanguageModel": "LanguageModel",
"../../Game/client/model/UpdateModel": "UpdateModel",
"../../Game/fromework/helper/EventHelper": "EventHelper",
"../../Game/fromework/net/NetHttp": "NetHttp",
"../../Game/fromework/net/NetUtils": "NetUtils",
"../../client/global/PopHelper": "PopHelper",
"../../platform/Platform": "Platform",
"../net/NetWebSocket": "NetWebSocket"
} ],
NetHttp: [ function(e, t, o) {
"use strict";
cc._RF.push(t, "f82a5jTTk5EM5OzvC4OLmG1", "NetHttp");
Object.defineProperty(o, "__esModule", {
value: !0
});
var n = e("../../../platform/Platform"), a = e("./NetUtils"), i = function() {
function e() {
this._timeout = 3e4;
this._reconnectCount = 0;
this._onError = null;
this._onTimeout = null;
this._onResault = null;
}
Object.defineProperty(e, "Instance", {
get: function() {
e._Instance || (e._Instance = new e());
return e._Instance;
},
enumerable: !1,
configurable: !0
});
e.prototype._onReceive = function(e, t, o) {
this._reconnectCount = 0;
if (null == t || null == t.status) this._onError && this._onError(); else if (t.status >= 200 && t.status < 300 || 304 == t.status) if (t.response && "" !== t.response && " " !== t.response) {
var a = JSON.parse(t.response);
if (a) {
n.default.log("- http response:", e, t.response);
this._onResault && this._onResault(a, e, o);
} else n.default.warn(e + " request is error!!!" + a);
} else n.default.warn(e + " request is error!!!"); else n.default.warn(e + "request is error!!!");
};
e.prototype._setRequestHead = function(e) {
e.setRequestHeader("Access-Control-Allow-Origin", "*");
e.setRequestHeader("Access-Control-Allow-Methods", "GET, POST");
e.setRequestHeader("Access-Control-Allow-Headers", "x-requested-with,content-type");
e.setRequestHeader("Content-Type", "application/json");
};
e.prototype.bindCallback = function(e, t, o) {
this._onError = e || null;
this._onTimeout = t || null;
this._onResault = o || null;
};
e.prototype.get = function(e, t, o, i) {
var r = this;
n.default.log("http get request:" + e, JSON.stringify(t));
var l = cc.loader.getXMLHttpRequest();
l.timeout = this._timeout;
var s = e;
if (t) {
var c = i ? t : a.encodeMsg(t), u = "", d = 0;
for (var p in c) {
u += 0 == d ? "?" + p + "=" + c[p] : "&" + p + "=" + c[p];
d++;
}
s += encodeURI(u);
}
l.open("GET", s, !0);
this._setRequestHead(l);
l.onload = function() {
if (o) {
r._reconnectCount = 0;
if (null == l || null == l.status) r._onError && r._onError(); else if (l.status >= 200 && l.status < 300 || 304 == l.status) if (l.response && "" !== l.response && " " !== l.response) {
n.default.log("--http response:", e, l.response);
o(l);
} else n.default.warn(e + " request is error!!!");
} else r._onReceive(e, l, t);
};
l.onerror = function() {
r.retury(!0, e, t, o, i);
r._onError && r._onError();
};
l.ontimeout = function() {
r._onTimeout && r._onTimeout();
};
try {
l.send();
} catch (e) {
this._onError && this._onError();
}
};
e.prototype.post = function(e, t, o, i) {
var r = this;
n.default.log("http post request:" + e, JSON.stringify(t));
var l = cc.loader.getXMLHttpRequest();
l.timeout = this._timeout;
l.open("POST", e, !0);
this._setRequestHead(l);
l.onload = function() {
if (o) {
r._reconnectCount = 0;
if (null == l || null == l.status) r._onError && r._onError(); else if (l.status >= 200 && l.status < 300 || 304 == l.status) if (l.response && "" !== l.response && " " !== l.response) {
n.default.log("---http response:", e, l.response);
o(l);
} else n.default.warn(e + " request is error!!!");
} else r._onReceive(e, l, t);
};
l.onerror = function() {
r.retury(!1, e, t, o, i);
r._onError && r._onError();
};
l.ontimeout = function() {
r._onTimeout && r._onTimeout();
};
try {
if (t) {
var s = i ? t : a.encodeMsg(t), c = JSON.stringify(s);
l.send(c);
} else l.send();
} catch (e) {
this._onError && this._onError();
}
};
e.prototype.retury = function(e, t, o, n, i) {
this._reconnectCount++;
if (this._reconnectCount <= a.ReconnectionCount) e ? this.get(t, o, n, i) : this.post(t, o, n, i); else {
this._onTimeout && this._onTimeout();
this._reconnectCount = 0;
}
};
e._Instance = null;
return e;
}();
o.default = i;
cc._RF.pop();
}, {
"../../../platform/Platform": "Platform",
"./NetUtils": "NetUtils"
} ],
NetUtils: [ function(e, t, o) {
"use strict";
cc._RF.push(t, "9e1d8ogSAFLOZbRmNMFIvfk", "NetUtils");
Object.defineProperty(o, "__esModule", {
value: !0
});
o.uncodeMsg = o.encodeMsg = o.ReconnectionDelay = o.ReconnectionCount = void 0;
var n = e("../../../platform/Platform"), a = e("../global/Tools");
o.ReconnectionCount = 12;
o.ReconnectionDelay = 5e3;
o.encodeMsg = function(e) {
var t = {}, o = a.Tools.TObj.deepCopy(e);
if (n.default.getisEncryption()) {
var i = a.Tools.Base64.encrypt(JSON.stringify(o), n.default.getencryptionKey(), n.default.getencryptionMD5());
i = i.replace(/[\r\n]/g, "");
t[n.default.getencryptionKey()] = i;
n.default.log("encodeMsg", t);
return t;
}
return o;
};
o.uncodeMsg = function(e) {
var t = e;
if (null != e[n.default.getencryptionKey()]) {
var o = a.Tools.Base64.decrypt(e[n.default.getencryptionKey()], n.default.getencryptionKey(), n.default.getencryptionMD5());
t = JSON.parse(o);
n.default.log("uncodeMsg", t);
}
return t;
};
cc._RF.pop();
}, {
"../../../platform/Platform": "Platform",
"../global/Tools": "Tools"
} ],
NetWebSocket: [ function(e, t, o) {
"use strict";
cc._RF.push(t, "5320egV6eVEb4fW4MU4imik", "NetWebSocket");
var n = this && this.__awaiter || function(e, t, o, n) {
return new (o || (o = Promise))(function(a, i) {
function r(e) {
try {
s(n.next(e));
} catch (e) {
i(e);
}
}
function l(e) {
try {
s(n.throw(e));
} catch (e) {
i(e);
}
}
function s(e) {
e.done ? a(e.value) : (t = e.value, t instanceof o ? t : new o(function(e) {
e(t);
})).then(r, l);
var t;
}
s((n = n.apply(e, t || [])).next());
});
}, a = this && this.__generator || function(e, t) {
var o, n, a, i, r = {
label: 0,
sent: function() {
if (1 & a[0]) throw a[1];
return a[1];
},
trys: [],
ops: []
};
return i = {
next: l(0),
throw: l(1),
return: l(2)
}, "function" == typeof Symbol && (i[Symbol.iterator] = function() {
return this;
}), i;
function l(e) {
return function(t) {
return s([ e, t ]);
};
}
function s(i) {
if (o) throw new TypeError("Generator is already executing.");
for (;r; ) try {
if (o = 1, n && (a = 2 & i[0] ? n.return : i[0] ? n.throw || ((a = n.return) && a.call(n), 
0) : n.next) && !(a = a.call(n, i[1])).done) return a;
(n = 0, a) && (i = [ 2 & i[0], a.value ]);
switch (i[0]) {
case 0:
case 1:
a = i;
break;

case 4:
r.label++;
return {
value: i[1],
done: !1
};

case 5:
r.label++;
n = i[1];
i = [ 0 ];
continue;

case 7:
i = r.ops.pop();
r.trys.pop();
continue;

default:
if (!(a = r.trys, a = a.length > 0 && a[a.length - 1]) && (6 === i[0] || 2 === i[0])) {
r = 0;
continue;
}
if (3 === i[0] && (!a || i[1] > a[0] && i[1] < a[3])) {
r.label = i[1];
break;
}
if (6 === i[0] && r.label < a[1]) {
r.label = a[1];
a = i;
break;
}
if (a && r.label < a[2]) {
r.label = a[2];
r.ops.push(i);
break;
}
a[2] && r.ops.pop();
r.trys.pop();
continue;
}
i = t.call(e, r);
} catch (e) {
i = [ 6, e ];
n = 0;
} finally {
o = a = 0;
}
if (5 & i[0]) throw i[1];
return {
value: i[0] ? i[1] : void 0,
done: !0
};
}
};
Object.defineProperty(o, "__esModule", {
value: !0
});
var i = e("../../Game/BundleManager"), r = e("../../Game/client/global/enum/net/C2S"), l = e("../../Game/fromework/net/NetUtils"), s = e("../../platform/Platform"), c = function() {
function e() {
this._myWebSocket = null;
this._sendQueue = [];
this._intervalId = 0;
this._reconnectCount = 0;
this._onOpen = null;
this._onClose = null;
this._onError = null;
this._onDrop = null;
this._onMessage = null;
this.webSocketUrl = "";
}
Object.defineProperty(e.prototype, "readyState", {
get: function() {
return this._myWebSocket ? this._myWebSocket.readyState : WebSocket.CLOSED;
},
enumerable: !1,
configurable: !0
});
e.prototype._realSend = function(e) {
var t = JSON.stringify(l.encodeMsg(e));
s.default.log("WS was sended:", t);
this._myWebSocket.send(t);
};
e.prototype._realSendAll = function() {
if (this._myWebSocket && this._myWebSocket.readyState == WebSocket.OPEN) {
for (var e = 0, t = this._sendQueue.length; e < t; e++) this._realSend(this._sendQueue[e]);
this._sendQueue.length = 0;
}
};
e.prototype._interval = function() {
var e = this;
WebSocket.OPEN == this._myWebSocket.readyState && (this._intervalId = setInterval(function() {
e._realSendAll();
}, .06));
};
e.prototype._unInterval = function() {
clearInterval(this._intervalId);
this._intervalId = 0;
};
e.prototype._open = function(e) {
s.default.log("webSocket open,", e);
this._reconnectCount = 0;
this._interval();
this._onOpen && this._onOpen();
};
e.prototype._close = function(e) {
s.default.log("webSocket close,", e);
this._unInterval();
this._onClose && this._onClose();
};
e.prototype._error = function(e) {
s.default.error("webSocket error", e);
this._unInterval();
this._onError && this._onError();
};
e.prototype._drop = function() {
s.default.log("webSocket drop");
this._reconnectCount = 0;
this._unInterval();
this._sendQueue.length = 0;
this._onDrop && this._onDrop();
};
e.prototype._received = function(e) {
s.default.log("webSocket onmessage text msg: " + e.data);
var t = JSON.parse(e.data) || {};
this._onMessage && this._onMessage(t);
};
Object.defineProperty(e, "Instance", {
get: function() {
if (e._Instance) return e._Instance;
e._Instance = new e();
return e._Instance;
},
enumerable: !1,
configurable: !0
});
e.prototype.bindCallback = function(e, t, o, n, a) {
this._onOpen = e;
this._onError = t;
this._onClose = o;
this._onDrop = n;
this._onMessage = a;
};
e.prototype.connect = function() {
return n(this, void 0, void 0, function() {
var e = this;
return a(this, function(t) {
switch (t.label) {
case 0:
if (null == this.webSocketUrl || null == this.webSocketUrl || "" == this.webSocketUrl) return [ 2 ];
if (this._myWebSocket) {
if (WebSocket.CONNECTING === this._myWebSocket.readyState || WebSocket.OPEN === this._myWebSocket.readyState) return [ 2 ];
this._unInterval();
delete this._myWebSocket;
this._myWebSocket = null;
}
if (this._reconnectCount > l.ReconnectionCount) {
this._drop();
return [ 2 ];
}
this._reconnectCount++;
s.default.log("connect ... ", this.webSocketUrl);
return cc.sys.isNative && cc.sys.os == cc.sys.OS_ANDROID ? [ 4, i.default.getInstance().getGameBundle() ] : [ 3, 2 ];

case 1:
t.sent();
this._myWebSocket = new WebSocket(this.webSocketUrl, []);
this._myWebSocket.onopen = function(t) {
e._open(t);
};
this._myWebSocket.onmessage = function(t) {
e._received(t);
};
this._myWebSocket.onerror = function(t) {
e._error(t);
};
this._myWebSocket.onclose = function(t) {
e._close(t);
};
return [ 3, 3 ];

case 2:
this._myWebSocket = new WebSocket(this.webSocketUrl);
this._myWebSocket.onopen = function(t) {
e._open(t);
};
this._myWebSocket.onmessage = function(t) {
e._received(t);
};
this._myWebSocket.onerror = function(t) {
e._error(t);
};
this._myWebSocket.onclose = function(t) {
e._close(t);
};
t.label = 3;

case 3:
return [ 2 ];
}
});
});
};
e.prototype.close = function() {
this._myWebSocket && (this._myWebSocket.readyState != WebSocket.CONNECTING && this._myWebSocket.readyState != WebSocket.OPEN || this._myWebSocket.close());
};
e.prototype.drop = function() {
if (this._myWebSocket) {
this._myWebSocket.readyState != WebSocket.CONNECTING && this._myWebSocket.readyState != WebSocket.OPEN || this._myWebSocket.close();
this._reconnectCount = 0;
this._unInterval();
this._sendQueue.length = 0;
delete this._myWebSocket;
this._myWebSocket = null;
}
};
e.prototype.sendMsg = function(e, t) {
void 0 === t && (t = !0);
this._myWebSocket && this._myWebSocket.readyState == WebSocket.OPEN ? e && this._realSend(e) : e.m != r.C2S.HB[0] && e && this.pushMsg(e, t);
};
e.prototype.pushMsg = function(e, t) {
void 0 === t && (t = !0);
if (e) {
if (t) for (var o = 0; o < this._sendQueue.length; o++) if (this._sendQueue[o].msgid == e.m + "_" + e.f) {
this._sendQueue[o] = e;
return;
}
this._sendQueue.push(e);
}
};
e._Instance = null;
return e;
}();
o.default = c;
cc._RF.pop();
}, {
"../../Game/BundleManager": "BundleManager",
"../../Game/client/global/enum/net/C2S": "C2S",
"../../Game/fromework/net/NetUtils": "NetUtils",
"../../platform/Platform": "Platform"
} ],
NetworkDelay: [ function(e, t, o) {
"use strict";
cc._RF.push(t, "ef850nHaH5M/ZSYJfqtHIkR", "NetworkDelay");
var n, a = this && this.__extends || (n = function(e, t) {
return (n = Object.setPrototypeOf || {
__proto__: []
} instanceof Array && function(e, t) {
e.__proto__ = t;
} || function(e, t) {
for (var o in t) Object.prototype.hasOwnProperty.call(t, o) && (e[o] = t[o]);
})(e, t);
}, function(e, t) {
n(e, t);
function o() {
this.constructor = e;
}
e.prototype = null === t ? Object.create(t) : (o.prototype = t.prototype, new o());
}), i = this && this.__decorate || function(e, t, o, n) {
var a, i = arguments.length, r = i < 3 ? t : null === n ? n = Object.getOwnPropertyDescriptor(t, o) : n;
if ("object" == typeof Reflect && "function" == typeof Reflect.decorate) r = Reflect.decorate(e, t, o, n); else for (var l = e.length - 1; l >= 0; l--) (a = e[l]) && (r = (i < 3 ? a(r) : i > 3 ? a(t, o, r) : a(t, o)) || r);
return i > 3 && r && Object.defineProperty(t, o, r), r;
};
Object.defineProperty(o, "__esModule", {
value: !0
});
var r = e("../../Game/client/global/enum/game/Event"), l = e("../../Game/fromework/helper/EventHelper"), s = cc.v3(-365, 350, 0), c = cc._decorator, u = c.ccclass, d = c.property, p = function(e) {
a(t, e);
function t() {
var t = null !== e && e.apply(this, arguments) || this;
t.DelayText = null;
t.WeakNetworkTips = null;
t._isComposite = !1;
t._weakNetwork = !1;
return t;
}
t.prototype.init = function(e) {
void 0 === e && (e = !1);
this._isComposite = e;
this.DelayText.node.active = !this._isComposite;
this.WeakNetworkTips.active = !1;
this.node.position = s;
};
t.prototype._refreshDelay = function(e) {
var t = this, o = e.getUserData();
this.WeakNetworkTips.active = !1;
this.DelayText.string = o + "ms";
if (o > 800) {
this.DelayText.node.active = !0;
this.DelayText.node.color = cc.color(255, 50, 50);
if (!this._weakNetwork) {
this._weakNetwork = !0;
cc.tween(this.WeakNetworkTips).call(function() {
t.WeakNetworkTips.active = !0;
}).delay(3).call(function() {
t.WeakNetworkTips.active = !1;
}).start();
}
} else if (o <= 800 && o >= 400) {
this._weakNetwork = !1;
this.DelayText.node.active = !0;
this.DelayText.node.color = cc.color(224, 193, 19);
} else {
this._weakNetwork = !1;
if (this._isComposite) this.DelayText.node.active = !1; else {
this.DelayText.node.active = !0;
this.DelayText.node.color = cc.color(56, 201, 46);
}
}
};
t.prototype.onLoad = function() {};
t.prototype.start = function() {};
t.prototype.onEnable = function() {
l.default.Instance.Global.bind(r.GameEvent.HEAR_BEAT_DELAY, this._refreshDelay, this);
};
t.prototype.onDisable = function() {
l.default.Instance.Global.unbind(r.GameEvent.HEAR_BEAT_DELAY, this._refreshDelay, this);
};
i([ d(cc.Label) ], t.prototype, "DelayText", void 0);
i([ d(cc.Node) ], t.prototype, "WeakNetworkTips", void 0);
return i([ u ], t);
}(cc.Component);
o.default = p;
cc._RF.pop();
}, {
"../../Game/client/global/enum/game/Event": "Event",
"../../Game/fromework/helper/EventHelper": "EventHelper"
} ],
NodeColor: [ function(e, t, o) {
"use strict";
cc._RF.push(t, "14f7fGuXBtJyYhaOzuXF5Lm", "NodeColor");
var n, a = this && this.__extends || (n = function(e, t) {
return (n = Object.setPrototypeOf || {
__proto__: []
} instanceof Array && function(e, t) {
e.__proto__ = t;
} || function(e, t) {
for (var o in t) Object.prototype.hasOwnProperty.call(t, o) && (e[o] = t[o]);
})(e, t);
}, function(e, t) {
n(e, t);
function o() {
this.constructor = e;
}
e.prototype = null === t ? Object.create(t) : (o.prototype = t.prototype, new o());
}), i = this && this.__decorate || function(e, t, o, n) {
var a, i = arguments.length, r = i < 3 ? t : null === n ? n = Object.getOwnPropertyDescriptor(t, o) : n;
if ("object" == typeof Reflect && "function" == typeof Reflect.decorate) r = Reflect.decorate(e, t, o, n); else for (var l = e.length - 1; l >= 0; l--) (a = e[l]) && (r = (i < 3 ? a(r) : i > 3 ? a(t, o, r) : a(t, o)) || r);
return i > 3 && r && Object.defineProperty(t, o, r), r;
};
Object.defineProperty(o, "__esModule", {
value: !0
});
var r = e("../../Game/client/global/enum/game/UIUtils"), l = e("../../Game/fromework/helper/ConfigHelper"), s = cc._decorator, c = s.ccclass, u = s.property, d = s.menu, p = function(e) {
a(t, e);
function t() {
var t = null !== e && e.apply(this, arguments) || this;
t.ColorPath = "";
return t;
}
t.prototype.start = function() {
if (this && this.node && this.node.isValid && "" != this.ColorPath) {
var e = l.ConfigHelper.Instance.getValue("fontcolor", this.ColorPath, "color");
e && r.UIUtils.setNodeColor(this.node, e);
}
};
i([ u(cc.String) ], t.prototype, "ColorPath", void 0);
return i([ c, d("component/颜色组件") ], t);
}(cc.Component);
o.default = p;
cc._RF.pop();
}, {
"../../Game/client/global/enum/game/UIUtils": "UIUtils",
"../../Game/fromework/helper/ConfigHelper": "ConfigHelper"
} ],
Notice: [ function(e, t, o) {
"use strict";
cc._RF.push(t, "f7fdcyIs0tMY7/Yr3tGNk7g", "Notice");
var n, a = this && this.__extends || (n = function(e, t) {
return (n = Object.setPrototypeOf || {
__proto__: []
} instanceof Array && function(e, t) {
e.__proto__ = t;
} || function(e, t) {
for (var o in t) Object.prototype.hasOwnProperty.call(t, o) && (e[o] = t[o]);
})(e, t);
}, function(e, t) {
n(e, t);
function o() {
this.constructor = e;
}
e.prototype = null === t ? Object.create(t) : (o.prototype = t.prototype, new o());
}), i = this && this.__decorate || function(e, t, o, n) {
var a, i = arguments.length, r = i < 3 ? t : null === n ? n = Object.getOwnPropertyDescriptor(t, o) : n;
if ("object" == typeof Reflect && "function" == typeof Reflect.decorate) r = Reflect.decorate(e, t, o, n); else for (var l = e.length - 1; l >= 0; l--) (a = e[l]) && (r = (i < 3 ? a(r) : i > 3 ? a(t, o, r) : a(t, o)) || r);
return i > 3 && r && Object.defineProperty(t, o, r), r;
};
Object.defineProperty(o, "__esModule", {
value: !0
});
o.NoticeType = void 0;
var r, l = e("../../../../Game/fromework/helper/EventHelper"), s = e("../../../../Game/fromework/helper/UIHelper"), c = e("../../../component/ImageLoader"), u = e("../../../component/RedDot"), d = e("../../../../Game/client/global/enum/game/Event"), p = e("../../../../Game/client/global/enum/game/Game"), h = e("../../../model/RedDotModel"), f = e("../../../model/WalletModel"), _ = e("../../active/DailyRecharge/DailyRecharge"), m = e("../../Wallet/WalletHelper"), y = e("../../../model/MonthCardModel"), g = e("../../../../Game/client/global/enum/game/Const"), v = e("../MonthCard/GoldSliverCard"), C = e("../Bonus/WelComeBonus"), b = e("../../active/ActiveModel"), I = cc._decorator, E = I.ccclass, S = I.property;
(function(e) {
e[e.Welfare = 1] = "Welfare";
e[e.SignIn = 2] = "SignIn";
e[e.Festival = 3] = "Festival";
e[e.FirstCharge = 4] = "FirstCharge";
e[e.DailyCharge = 5] = "DailyCharge";
})(r = o.NoticeType || (o.NoticeType = {}));
var T = function(e) {
a(t, e);
function t() {
var t = null !== e && e.apply(this, arguments) || this;
t.MainPanel = null;
t.WelfareToggle = null;
t.SignInToggle = null;
t.FirstChargeToggle = null;
t.DailyChargeToggle = null;
t.FestivalToggle = null;
t.DailyCharge = null;
t.ImageNotice = null;
t.ImageLoading = null;
t.ImageViewImg = null;
t._type = r.Welfare;
t._activeData = null;
t.isFirstOpen = !1;
return t;
}
t.prototype.onLoad = function() {};
t.prototype.onDestroy = function() {};
t.prototype.show = function(e, t) {
t && (this.isFirstOpen = t);
this._type = null != e ? e : this.getSelectReddotToggle();
this.refreshTogglesActive();
null == this._type && (this._type = this.getActiveToggle());
this.refreshToggleChecked();
this.refreshPanel();
this.setReddotKey();
};
t.prototype.getActiveData = function(e) {
var t = f.WalletProxy.Instance.getRechargeActiveByType(e);
return t ? t[0] : null;
};
t.prototype.checkActivity = function(e) {
var t = f.WalletProxy.Instance.getRechargeActiveByType(e);
if (t.length <= 0) return !1;
var o = t[0], n = new Date().getTime() / 1e3;
return n > o.display_start_time && n < o.end_time;
};
t.prototype.changeToggleTitle = function(e, t) {
var o = this.getActiveData(t);
if (o) {
var n = cc.find("Background/Title", e).getComponent(cc.Label);
n && (n.string = o.title);
var a = cc.find("checkmark/Title", e).getComponent(cc.Label);
a && (a.string = o.title);
} else e.active = !1;
};
t.prototype.getSelectReddotToggle = function() {
if (this.WelfareToggle.node.active && (e = this.getActiveData(8)) && h.default.Instance.getState(p.GameEnum.RedDotKey.RechargeActivity + e.id) > 0) return r.Welfare;
if (this.FestivalToggle.node.active && (e = this.getActiveData(9)) && h.default.Instance.getState(p.GameEnum.RedDotKey.RechargeActivity + e.id) > 0) return r.Festival;
if (this.FirstChargeToggle.node.active && (e = this.getActiveData(1)) && h.default.Instance.getState(p.GameEnum.RedDotKey.RechargeActivity + e.id) > 0) return r.FirstCharge;
if (this.DailyChargeToggle.node.active) {
var e;
if ((e = this.getActiveData(5)) && h.default.Instance.getState(p.GameEnum.RedDotKey.RechargeActivity + e.id) > 0) return r.DailyCharge;
}
return null;
};
t.prototype.getActiveToggle = function() {
return this.WelfareToggle.node.active ? r.Welfare : this.FestivalToggle.node.active ? r.Festival : this.FirstChargeToggle.node.active ? r.FirstCharge : this.DailyChargeToggle.node.active ? r.DailyCharge : null;
};
t.prototype.setReddotKey = function() {
this.WelfareToggle.node.active && (e = this.getActiveData(8)) && this.WelfareToggle.node.getChildByName("RedDot").getComponent(u.default).setBindKeys([ p.GameEnum.RedDotKey.RechargeActivity + e.id ]);
this.FirstChargeToggle.node.active && (e = this.getActiveData(1)) && this.FirstChargeToggle.node.getChildByName("RedDot").getComponent(u.default).setBindKeys([ p.GameEnum.RedDotKey.RechargeActivity + e.id ]);
this.DailyChargeToggle.node.active && (e = this.getActiveData(5)) && this.DailyChargeToggle.node.getChildByName("RedDot").getComponent(u.default).setBindKeys([ p.GameEnum.RedDotKey.RechargeActivity + e.id ]);
if (this.FestivalToggle.node.active) {
var e;
(e = this.getActiveData(9)) && this.FestivalToggle.node.getChildByName("RedDot").getComponent(u.default).setBindKeys([ p.GameEnum.RedDotKey.RechargeActivity + e.id ]);
}
};
t.prototype.refreshTogglesActive = function() {
this.WelfareToggle.node.active = this.checkActivity(8);
this.FirstChargeToggle.node.active = this.checkActivity(1);
this.DailyChargeToggle.node.active = this.checkActivity(5);
this.FestivalToggle.node.active = this.checkActivity(9);
this.WelfareToggle.node.active && this.changeToggleTitle(this.WelfareToggle.node, 8);
this.FirstChargeToggle.node.active && this.changeToggleTitle(this.FirstChargeToggle.node, 1);
this.DailyChargeToggle.node.active && this.changeToggleTitle(this.DailyChargeToggle.node, 5);
this.FestivalToggle.node.active && this.changeToggleTitle(this.FestivalToggle.node, 9);
};
t.prototype.refreshToggleChecked = function() {
this.WelfareToggle.isChecked = this._type == r.Welfare;
this.FirstChargeToggle.isChecked = this._type == r.FirstCharge;
this.DailyChargeToggle.isChecked = this._type == r.DailyCharge;
this.FestivalToggle.isChecked = this._type == r.Festival;
};
t.prototype.refreshPanel = function() {
this.DailyCharge.node.active = !1;
this.ImageNotice.active = !1;
if (this._type == r.Welfare || this._type == r.FirstCharge || this._type == r.Festival) {
this.ImageNotice.active = !0;
this.refreshImage(this._type);
null != this._activeData && h.default.Instance.delRechargeRedDot(this._activeData);
} else if (this._type == r.DailyCharge) {
this.DailyCharge.node.active = !0;
this.DailyCharge.refreshView();
}
};
t.prototype.refreshImage = function() {
var e = this;
this._activeData = null;
this._type == r.Welfare ? this._activeData = this.getActiveData(8) : this._type == r.FirstCharge ? this._activeData = this.getActiveData(1) : this._type == r.Festival && (this._activeData = this.getActiveData(9));
if (null != this._activeData) {
var t = null != this._activeData ? this._activeData.img : "";
if ("" != t) {
this.ImageLoading.active = !0;
this.ImageViewImg.setUrl(t, function() {
e.ImageLoading && e.ImageLoading.isValid && (e.ImageLoading.active = !1);
});
}
} else this.ImageNotice.active = !1;
};
t.prototype.onToggleClicked = function(e, t) {
this._type = parseInt(t);
this.refreshPanel();
};
t.prototype.onNoticeImgClicked = function() {
this.onCloseClicked();
m.default.Instance.openRecharge({
activityId: this._activeData.id
});
};
t.prototype.onCloseClicked = function() {
s.default.Instance.removeMaskLayer(this.node, !0);
l.default.Instance.Global.emit(d.LobbyEvent.LOBBY_REFRESH_NOTICE_BUTTON);
if (this.isFirstOpen) {
var e = y.MonthCardProxy.Instance.goldSliverData;
if (!e || null == e) return;
var t = e.all_month_card[1], o = e.all_month_card[0];
1 == t.card_status || 1 == o.card_status ? b.ActiveProxy.Instance.alreadyBuy ? l.default.Instance.Global.emit("openLoginAlert") : s.default.Instance.addBundleMaskLayer(g.BundleUIPath.WelComeBonus, function(e) {
e.getComponent(C.default).show(!0);
}) : s.default.Instance.addBundleMaskLayer(g.BundleUIPath.GoldSliverCard, function(e) {
e.getComponent(v.default).show(!0);
});
}
};
i([ S(cc.Node) ], t.prototype, "MainPanel", void 0);
i([ S(cc.Toggle) ], t.prototype, "WelfareToggle", void 0);
i([ S(cc.Toggle) ], t.prototype, "SignInToggle", void 0);
i([ S(cc.Toggle) ], t.prototype, "FirstChargeToggle", void 0);
i([ S(cc.Toggle) ], t.prototype, "DailyChargeToggle", void 0);
i([ S(cc.Toggle) ], t.prototype, "FestivalToggle", void 0);
i([ S(_.default) ], t.prototype, "DailyCharge", void 0);
i([ S(cc.Node) ], t.prototype, "ImageNotice", void 0);
i([ S(cc.Node) ], t.prototype, "ImageLoading", void 0);
i([ S(c.default) ], t.prototype, "ImageViewImg", void 0);
return i([ E ], t);
}(cc.Component);
o.default = T;
cc._RF.pop();
}, {
"../../../../Game/client/global/enum/game/Const": "Const",
"../../../../Game/client/global/enum/game/Event": "Event",
"../../../../Game/client/global/enum/game/Game": "Game",
"../../../../Game/fromework/helper/EventHelper": "EventHelper",
"../../../../Game/fromework/helper/UIHelper": "UIHelper",
"../../../component/ImageLoader": "ImageLoader",
"../../../component/RedDot": "RedDot",
"../../../model/MonthCardModel": "MonthCardModel",
"../../../model/RedDotModel": "RedDotModel",
"../../../model/WalletModel": "WalletModel",
"../../Wallet/WalletHelper": "WalletHelper",
"../../active/ActiveModel": "ActiveModel",
"../../active/DailyRecharge/DailyRecharge": "DailyRecharge",
"../Bonus/WelComeBonus": "WelComeBonus",
"../MonthCard/GoldSliverCard": "GoldSliverCard"
} ],
NumericEditorBox: [ function(e, t, o) {
"use strict";
cc._RF.push(t, "6ca59WqgIhNhpMxSkMK8gCe", "NumericEditorBox");
var n, a = this && this.__extends || (n = function(e, t) {
return (n = Object.setPrototypeOf || {
__proto__: []
} instanceof Array && function(e, t) {
e.__proto__ = t;
} || function(e, t) {
for (var o in t) Object.prototype.hasOwnProperty.call(t, o) && (e[o] = t[o]);
})(e, t);
}, function(e, t) {
n(e, t);
function o() {
this.constructor = e;
}
e.prototype = null === t ? Object.create(t) : (o.prototype = t.prototype, new o());
}), i = this && this.__decorate || function(e, t, o, n) {
var a, i = arguments.length, r = i < 3 ? t : null === n ? n = Object.getOwnPropertyDescriptor(t, o) : n;
if ("object" == typeof Reflect && "function" == typeof Reflect.decorate) r = Reflect.decorate(e, t, o, n); else for (var l = e.length - 1; l >= 0; l--) (a = e[l]) && (r = (i < 3 ? a(r) : i > 3 ? a(t, o, r) : a(t, o)) || r);
return i > 3 && r && Object.defineProperty(t, o, r), r;
};
Object.defineProperty(o, "__esModule", {
value: !0
});
var r = e("../../Game/client/global/enum/game/UIUtils"), l = e("../../Game/client/model/LanguageModel"), s = e("../../Game/fromework/global/Tools"), c = e("../../Game/fromework/helper/ConfigHelper"), u = e("../../platform/Platform"), d = e("../global/PopHelper"), p = cc._decorator, h = p.ccclass, f = p.property, _ = p.menu, m = function(e) {
a(t, e);
function t() {
var t = null !== e && e.apply(this, arguments) || this;
t.PANEL = null;
t.EDITOR = null;
t.TEXT_LABEL = null;
t.PLACEHOLDER_LABEL = null;
t.Placeholder_Text = "Enter text here...";
t.Color_Placeholder_Key = "";
t.Color_Text_Key = "";
t.Color_Editor_Key = "";
t._target = null;
t._firstEnter = !1;
return t;
}
t.prototype._getPosX = function(e) {
void 0 === e && (e = !0);
var t = this._target.LeftSide ? -1 : 1, o = cc.winSize.width, n = this.EDITOR.getBoundingBox().size.width;
return e ? (o / 2 + (this._target.LeftSide ? n : n / 2)) * t : (o / 2 - (this._target.LeftSide ? 0 : n)) * t;
};
t.prototype.show = function(e) {
if (e) {
this._target = e;
this._firstEnter = !0;
this.TEXT_LABEL.string = this._target.TEXT_LABEL.string;
this.TEXT_LABEL.node.active = this.TEXT_LABEL.string && "" != this.TEXT_LABEL.string;
this.PLACEHOLDER_LABEL.node.active = !this.TEXT_LABEL.node.active;
this.EDITOR.setPosition(cc.v2(this._getPosX(), 0));
this.PANEL.active = !0;
cc.tween(this.EDITOR).to(.2, {
x: this._getPosX(!1)
}).start();
}
};
t.prototype.hide = function() {
var e = this;
this._target.TEXT_LABEL.string = this.TEXT_LABEL.string;
this._target.hideEditor();
this._firstEnter = !1;
cc.tween(this.EDITOR).to(.2, {
x: this._getPosX()
}).call(function() {
e.TEXT_LABEL.string = "";
e.TEXT_LABEL.node.active = !1;
e.PLACEHOLDER_LABEL.node.active = !0;
e.PANEL.active = !1;
}).start();
};
t.prototype.onClick = function(e, t) {
if (!("OK" != t && "Delete" != t && this.TEXT_LABEL.string.length >= this._target.maxLength)) {
this.PLACEHOLDER_LABEL.node.active && (this.PLACEHOLDER_LABEL.node.active = !1);
this.TEXT_LABEL.node.active || (this.TEXT_LABEL.node.active = !0);
switch (t) {
case "0":
case "1":
case "2":
case "3":
case "4":
case "5":
case "6":
case "7":
case "8":
case "9":
this._firstEnter && (this.TEXT_LABEL.string = "");
this.TEXT_LABEL.string += t;
break;

case "OK":
this.hide();
break;

case "Delete":
this.TEXT_LABEL.string = this.TEXT_LABEL.string.substring(0, this.TEXT_LABEL.string.length - 1);
}
this._firstEnter = !1;
this._target.TEXT_LABEL.string = this.TEXT_LABEL.string;
}
};
t.prototype.onPasteClicked = function() {
var e = u.default.getTextFromClipboard();
if (isNaN(parseInt(e)) || !s.Tools.TStr.checkType(e, "number")) d.PopHelper.Instance.showTips(l.default.getString("NUMBEREDITBOX_TIPS")); else {
this.PLACEHOLDER_LABEL.node.active && (this.PLACEHOLDER_LABEL.node.active = !1);
this.TEXT_LABEL.node.active || (this.TEXT_LABEL.node.active = !0);
this.TEXT_LABEL.string = e;
this._firstEnter = !1;
this._target.TEXT_LABEL.string = this.TEXT_LABEL.string;
}
};
t.prototype.onLoad = function() {
this.TEXT_LABEL && this.TEXT_LABEL.node && this.TEXT_LABEL.node.isValid && "" != this.Color_Text_Key && (e = c.ConfigHelper.Instance.getValue("fontcolor", this.Color_Text_Key, "color")) && r.UIUtils.setNodeColor(this.TEXT_LABEL.node, e);
this.PLACEHOLDER_LABEL && this.PLACEHOLDER_LABEL.node && this.PLACEHOLDER_LABEL.node.isValid && "" != this.Color_Placeholder_Key && (e = c.ConfigHelper.Instance.getValue("fontcolor", this.Color_Placeholder_Key, "color")) && r.UIUtils.setNodeColor(this.PLACEHOLDER_LABEL.node, e);
if (this.EDITOR && this.EDITOR.isValid && "" != this.Color_Editor_Key) {
var e;
(e = c.ConfigHelper.Instance.getValue("fontcolor", this.Color_Editor_Key, "color")) && r.UIUtils.setNodeColor(this.EDITOR, e);
}
};
t.prototype.start = function() {};
i([ f(cc.Node) ], t.prototype, "PANEL", void 0);
i([ f(cc.Node) ], t.prototype, "EDITOR", void 0);
i([ f(cc.Label) ], t.prototype, "TEXT_LABEL", void 0);
i([ f(cc.Label) ], t.prototype, "PLACEHOLDER_LABEL", void 0);
i([ f ], t.prototype, "Placeholder_Text", void 0);
i([ f ], t.prototype, "Color_Placeholder_Key", void 0);
i([ f ], t.prototype, "Color_Text_Key", void 0);
i([ f ], t.prototype, "Color_Editor_Key", void 0);
return i([ h, _("component/NumericEditorBox(数字输入框)") ], t);
}(cc.Component);
o.default = m;
cc._RF.pop();
}, {
"../../Game/client/global/enum/game/UIUtils": "UIUtils",
"../../Game/client/model/LanguageModel": "LanguageModel",
"../../Game/fromework/global/Tools": "Tools",
"../../Game/fromework/helper/ConfigHelper": "ConfigHelper",
"../../platform/Platform": "Platform",
"../global/PopHelper": "PopHelper"
} ],
NumericLabel: [ function(e, t, o) {
"use strict";
cc._RF.push(t, "8a17cyMdt1P1YlCUdKD4z2U", "NumericLabel");
var n, a = this && this.__extends || (n = function(e, t) {
return (n = Object.setPrototypeOf || {
__proto__: []
} instanceof Array && function(e, t) {
e.__proto__ = t;
} || function(e, t) {
for (var o in t) Object.prototype.hasOwnProperty.call(t, o) && (e[o] = t[o]);
})(e, t);
}, function(e, t) {
n(e, t);
function o() {
this.constructor = e;
}
e.prototype = null === t ? Object.create(t) : (o.prototype = t.prototype, new o());
}), i = this && this.__decorate || function(e, t, o, n) {
var a, i = arguments.length, r = i < 3 ? t : null === n ? n = Object.getOwnPropertyDescriptor(t, o) : n;
if ("object" == typeof Reflect && "function" == typeof Reflect.decorate) r = Reflect.decorate(e, t, o, n); else for (var l = e.length - 1; l >= 0; l--) (a = e[l]) && (r = (i < 3 ? a(r) : i > 3 ? a(t, o, r) : a(t, o)) || r);
return i > 3 && r && Object.defineProperty(t, o, r), r;
};
Object.defineProperty(o, "__esModule", {
value: !0
});
var r = e("../../Game/client/global/enum/game/Event"), l = e("../../Game/client/global/enum/game/UIUtils"), s = e("../../Game/fromework/helper/ConfigHelper"), c = e("../../Game/fromework/helper/EventHelper"), u = cc._decorator, d = u.ccclass, p = u.property, h = u.menu, f = function(e) {
a(t, e);
function t() {
var t = null !== e && e.apply(this, arguments) || this;
t.TEXT_LABEL = null;
t.PLACEHOLDER_LABEL = null;
t.LeftSide = !1;
t.Placeholder_Text = "Enter text here...";
t.Color_Placeholder_Key = "";
t.Color_Text_Key = "";
t.maxLength = 10;
t.InputEnd = null;
return t;
}
Object.defineProperty(t.prototype, "string", {
get: function() {
return this.TEXT_LABEL.string;
},
set: function(e) {
this.TEXT_LABEL.string = e;
this.refreshLabel();
},
enumerable: !1,
configurable: !0
});
t.prototype.showEditor = function() {
this.TEXT_LABEL.node.active = !0;
this.PLACEHOLDER_LABEL.node.active = !1;
c.default.Instance.Global.emit(r.GameUIEvent.SHOW_NUMBER_EDITBOX, this);
};
t.prototype.hideEditor = function() {
if (this.TEXT_LABEL.node.active) {
this.refreshLabel();
cc.Component.EventHandler.emitEvents([ this.InputEnd ]);
}
};
t.prototype.refreshLabel = function() {
if (this.TEXT_LABEL.string && "" != this.TEXT_LABEL.string) {
this.TEXT_LABEL.node.active = !0;
this.PLACEHOLDER_LABEL.node.active = !1;
} else {
this.TEXT_LABEL.node.active = !1;
this.PLACEHOLDER_LABEL.node.active = !0;
}
};
t.prototype.onLoad = function() {
this.TEXT_LABEL && this.TEXT_LABEL.node && this.TEXT_LABEL.node.isValid && "" != this.Color_Text_Key && (e = s.ConfigHelper.Instance.getValue("fontcolor", this.Color_Text_Key, "color")) && l.UIUtils.setNodeColor(this.TEXT_LABEL.node, e);
if (this.PLACEHOLDER_LABEL && this.PLACEHOLDER_LABEL.node && this.PLACEHOLDER_LABEL.node.isValid && "" != this.Color_Placeholder_Key) {
var e;
(e = s.ConfigHelper.Instance.getValue("fontcolor", this.Color_Placeholder_Key, "color")) && l.UIUtils.setNodeColor(this.PLACEHOLDER_LABEL.node, e);
}
};
t.prototype.start = function() {};
i([ p(cc.Label) ], t.prototype, "TEXT_LABEL", void 0);
i([ p(cc.Label) ], t.prototype, "PLACEHOLDER_LABEL", void 0);
i([ p ], t.prototype, "LeftSide", void 0);
i([ p ], t.prototype, "Placeholder_Text", void 0);
i([ p ], t.prototype, "Color_Placeholder_Key", void 0);
i([ p ], t.prototype, "Color_Text_Key", void 0);
i([ p ], t.prototype, "maxLength", void 0);
i([ p(cc.Component.EventHandler) ], t.prototype, "InputEnd", void 0);
return i([ d, h("component/NumericLabel(数字Label)") ], t);
}(cc.Component);
o.default = f;
cc._RF.pop();
}, {
"../../Game/client/global/enum/game/Event": "Event",
"../../Game/client/global/enum/game/UIUtils": "UIUtils",
"../../Game/fromework/helper/ConfigHelper": "ConfigHelper",
"../../Game/fromework/helper/EventHelper": "EventHelper"
} ],
OddsManager: [ function(e, t, o) {
"use strict";
cc._RF.push(t, "b10c5OY139Ih5EizhOB2m4v", "OddsManager");
var n, a = this && this.__extends || (n = function(e, t) {
return (n = Object.setPrototypeOf || {
__proto__: []
} instanceof Array && function(e, t) {
e.__proto__ = t;
} || function(e, t) {
for (var o in t) Object.prototype.hasOwnProperty.call(t, o) && (e[o] = t[o]);
})(e, t);
}, function(e, t) {
n(e, t);
function o() {
this.constructor = e;
}
e.prototype = null === t ? Object.create(t) : (o.prototype = t.prototype, new o());
}), i = this && this.__decorate || function(e, t, o, n) {
var a, i = arguments.length, r = i < 3 ? t : null === n ? n = Object.getOwnPropertyDescriptor(t, o) : n;
if ("object" == typeof Reflect && "function" == typeof Reflect.decorate) r = Reflect.decorate(e, t, o, n); else for (var l = e.length - 1; l >= 0; l--) (a = e[l]) && (r = (i < 3 ? a(r) : i > 3 ? a(t, o, r) : a(t, o)) || r);
return i > 3 && r && Object.defineProperty(t, o, r), r;
};
Object.defineProperty(o, "__esModule", {
value: !0
});
var r = e("../../../client/logic/Wallet/WalletHelper"), l = e("../../../Game/client/model/LanguageModel"), s = e("../../../client/model/LobbyModel"), c = e("../Component/CompositeOdds"), u = e("../Utils/CompositeConst"), d = e("../Utils/CompositeEvent"), p = e("../Utils/CompositeUtil"), h = e("../../../Game/fromework/global/Tools"), f = e("../../../Game/Script/global/GlobalValue"), _ = e("../../../Game/fromework/mvvm/modelView/ViewModel"), m = e("../../../Game/fromework/helper/AudioHelper"), y = e("../../../Game/client/global/enum/game/Const"), g = e("../../../Game/fromework/helper/EventHelper"), v = e("../../../client/global/PopHelper"), C = cc._decorator, b = C.ccclass, I = C.property, E = function(e) {
a(t, e);
function t() {
var t = null !== e && e.apply(this, arguments) || this;
t.GameMethod = u.PlayMethod.AndarBahar;
t.OddsPrefab = null;
t.TraditionOdds = [];
t._selectedChip = 0;
t._oddsNode = new Array();
return t;
}
t.prototype.getPosInRect = function(e) {
if (u.PlayMethod.TraditionAndarBahar != this.GameMethod) {
var t = u.OddsPosition[this.GameMethod][e], o = u.OddsComponentData[this.GameMethod][e], n = t.x - o.with / 2 + u.ODDS_CHIP_OFFSET, a = t.x + o.with / 2 - u.ODDS_CHIP_OFFSET, i = t.y - o.height / 2 + u.ODDS_CHIP_OFFSET + (u.PlayMethod.LuckyDice == this.GameMethod ? u.ODDS_LUCKYDICE_OFFSET : 0), r = t.y + o.height / 2 - (u.ODDS_TOP_OFFSET + u.ODDS_CHIP_OFFSET);
if (u.PlayMethod.DragonVSTiger == this.GameMethod) {
i = t.y - o.height / 2 + 40;
r = t.y + o.height / 2 + 8;
}
var l = Math.random(), s = Math.round(n * l + a * (1 - l)), c = Math.random(), d = Math.round(i * c + r * (1 - c));
if (u.PlayMethod.DragonVSTiger == this.GameMethod) {
var p = [ {
rect: [ {
width: 340,
hight: 110
}, {
width: 315,
hight: 110
}, {
width: 300,
hight: 110
} ],
pos: [ cc.v2(-10, -88), cc.v2(9, -23), cc.v2(29, 133) ]
}, {
rect: [ {
width: 305,
hight: 110
}, {
width: 285,
hight: 110
}, {
width: 265,
hight: 110
} ],
pos: [ cc.v2(0, 0), cc.v2(0, 0), cc.v2(0, 0) ]
}, {
rect: [ {
width: 340,
hight: 110
}, {
width: 315,
hight: 110
}, {
width: 300,
hight: 110
} ],
pos: [ cc.v2(9, -88), cc.v2(-14, -23), cc.v2(-31, 133) ]
} ];
if (d < 0 && d <= t.y - o.height / 2 + u.ODDS_CHIP_OFFSET + 40 + o.height / 3) {
n = t.x - p[e].rect[0].width / 2 + u.ODDS_CHIP_OFFSET + p[e].pos[0].x;
a = t.x + p[e].rect[0].width / 2 - u.ODDS_CHIP_OFFSET + p[e].pos[0].x;
s = Math.round(n * l + a * (1 - l));
} else if (d > 0 && d >= t.y - o.height / 2 + u.ODDS_CHIP_OFFSET + 40 + o.height / 3 * 2) {
n = t.x - p[e].rect[2].width / 2 + u.ODDS_CHIP_OFFSET + p[e].pos[2].x;
a = t.x + p[e].rect[2].width / 2 - u.ODDS_CHIP_OFFSET + p[e].pos[2].x;
s = Math.round(n * l + a * (1 - l));
} else {
n = t.x - p[e].rect[1].width / 2 + u.ODDS_CHIP_OFFSET + p[e].pos[1].x;
a = t.x + p[e].rect[1].width / 2 - u.ODDS_CHIP_OFFSET + p[e].pos[1].x;
s = Math.round(n * l + a * (1 - l));
}
}
if (u.PlayMethod.AndarBahar == this.GameMethod) {
n = (p = [ {
pos: cc.v2(-237, 47),
rect: {
width: 330,
height: 100
}
}, {
pos: cc.v2(241, 47),
rect: {
width: 330,
height: 100
}
}, {
pos: cc.v2(-353, -71),
rect: {
width: 213,
height: 49
}
}, {
pos: cc.v2(-114, -71),
rect: {
width: 215,
height: 49
}
}, {
pos: cc.v2(117, -71),
rect: {
width: 215,
height: 49
}
}, {
pos: cc.v2(352, -71),
rect: {
width: 215,
height: 49
}
}, {
pos: cc.v2(-364, -162),
rect: {
width: 215,
height: 54
}
}, {
pos: cc.v2(-122, -162),
rect: {
width: 230,
height: 54
}
}, {
pos: cc.v2(125, -162),
rect: {
width: 230,
height: 54
}
}, {
pos: cc.v2(368, -162),
rect: {
width: 215,
height: 54
}
} ])[e].pos.x - p[e].rect.width / 2 + u.ODDS_CHIP_OFFSET;
a = p[e].pos.x + p[e].rect.width / 2 - u.ODDS_CHIP_OFFSET;
i = p[e].pos.y - p[e].rect.height / 2 + u.ODDS_CHIP_OFFSET;
r = p[e].pos.y + p[e].rect.height / 2 - u.ODDS_CHIP_OFFSET;
s = Math.round(n * l + a * (1 - l));
d = Math.round(i * c + r * (1 - c));
}
if (u.PlayMethod.Roulette == this.GameMethod) {
n = (p = [ {
pos: cc.v2(-361, -48),
rect: {
width: 210,
height: 92
}
}, {
pos: cc.v2(-122, -48),
rect: {
width: 224,
height: 92
}
}, {
pos: cc.v2(122, -48),
rect: {
width: 224,
height: 92
}
}, {
pos: cc.v2(361, -48),
rect: {
width: 210,
height: 92
}
}, {
pos: cc.v2(-394, -192),
rect: {
width: 230,
height: 111
}
}, {
pos: cc.v2(-132, -192),
rect: {
width: 247,
height: 111
}
}, {
pos: cc.v2(132, -192),
rect: {
width: 247,
height: 111
}
}, {
pos: cc.v2(394, -192),
rect: {
width: 230,
height: 111
}
} ])[e].pos.x - p[e].rect.width / 2 + u.ODDS_CHIP_OFFSET;
a = p[e].pos.x + p[e].rect.width / 2 - u.ODDS_CHIP_OFFSET;
i = p[e].pos.y - p[e].rect.height / 2 + u.ODDS_CHIP_OFFSET;
r = p[e].pos.y + p[e].rect.height / 2 - u.ODDS_CHIP_OFFSET;
s = Math.round(n * l + a * (1 - l));
d = Math.round(i * c + r * (1 - c));
}
if (u.PlayMethod.TPWar == this.GameMethod) {
n = (p = [ {
pos: cc.v2(-234, 13),
rect: {
width: 448,
height: 164
}
}, {
pos: cc.v2(234, 13),
rect: {
width: 448,
height: 164
}
}, {
pos: cc.v2(426, -157),
rect: {
width: 160,
height: 78
}
}, {
pos: cc.v2(223, -157),
rect: {
width: 200,
height: 78
}
}, {
pos: cc.v2(0, -157),
rect: {
width: 200,
height: 78
}
}, {
pos: cc.v2(-222, -157),
rect: {
width: 200,
height: 78
}
}, {
pos: cc.v2(-421, -157),
rect: {
width: 160,
height: 78
}
} ])[e].pos.x - p[e].rect.width / 2 + u.ODDS_CHIP_OFFSET;
a = p[e].pos.x + p[e].rect.width / 2 - u.ODDS_CHIP_OFFSET;
i = p[e].pos.y - p[e].rect.height / 2 + u.ODDS_CHIP_OFFSET;
r = p[e].pos.y + p[e].rect.height / 2 - u.ODDS_CHIP_OFFSET;
s = Math.round(n * l + a * (1 - l));
d = Math.round(i * c + r * (1 - c));
}
if (u.PlayMethod.SevenUpDown == this.GameMethod) {
p = [ {
rect: [ {
width: 350,
hight: 77
}, {
width: 313,
hight: 77
}, {
width: 279,
hight: 77
} ],
pos: [ cc.v2(-0, -88), cc.v2(31, -18), cc.v2(58, 48) ]
}, {
rect: [ {
width: 280,
hight: 77
}, {
width: 264,
hight: 77
}, {
width: 243,
hight: 77
} ],
pos: [ cc.v2(0, 0), cc.v2(0, 0), cc.v2(0, 0) ]
}, {
rect: [ {
width: 351,
hight: 77
}, {
width: 307,
hight: 77
}, {
width: 268,
hight: 77
} ],
pos: [ cc.v2(3, -88), cc.v2(-31, -23), cc.v2(-65, 133) ]
} ];
if (d < 0 && d <= t.y - o.height / 2 + u.ODDS_CHIP_OFFSET + 40 + o.height / 3) {
n = t.x - p[e].rect[0].width / 2 + u.ODDS_CHIP_OFFSET + p[e].pos[0].x;
a = t.x + p[e].rect[0].width / 2 - u.ODDS_CHIP_OFFSET + p[e].pos[0].x;
s = Math.round(n * l + a * (1 - l));
} else if (d > 0 && d >= t.y - o.height / 2 + u.ODDS_CHIP_OFFSET + 40 + o.height / 3 * 2) {
n = t.x - p[e].rect[2].width / 2 + u.ODDS_CHIP_OFFSET + p[e].pos[2].x;
a = t.x + p[e].rect[2].width / 2 - u.ODDS_CHIP_OFFSET + p[e].pos[2].x;
s = Math.round(n * l + a * (1 - l));
} else {
n = t.x - p[e].rect[1].width / 2 + u.ODDS_CHIP_OFFSET + p[e].pos[1].x;
a = t.x + p[e].rect[1].width / 2 - u.ODDS_CHIP_OFFSET + p[e].pos[1].x;
s = Math.round(n * l + a * (1 - l));
}
}
return cc.v3(s, d, 0);
}
var f = h.Tools.TNumber.randomNumber(0, this.TraditionOdds[e].children.length - 1);
return this.TraditionOdds[e].convertToWorldSpaceAR(this.TraditionOdds[e].children[f].position).add(cc.v3((Math.random() > .5 ? 1 : -1) * Math.random() * 15, (Math.random() > .5 ? 1 : -1) * Math.random() * 15, 0)).sub(cc.v3(cc.winSize.width / 2, cc.winSize.height / 2, 0));
};
t.prototype.init = function(e) {
this.GameMethod = e;
var t = u.OddsPosition[this.GameMethod];
if (this.GameMethod == u.PlayMethod.LuckyDice || this.GameMethod == u.PlayMethod.SevenUpDown || this.GameMethod == u.PlayMethod.DragonVSTiger || this.GameMethod == u.PlayMethod.AndarBahar || this.GameMethod == u.PlayMethod.Roulette || this.GameMethod == u.PlayMethod.TPWar) for (var o = 0; o < t.length; ++o) {
(n = this.node.getChildByName("CompositeOdds" + o)).getComponent(c.default).init(this.GameMethod, o);
this._oddsNode.push(n);
} else for (o = 0; o < t.length; ++o) {
var n;
(n = cc.instantiate(this.OddsPrefab)).parent = this.node;
n.position = t[o];
n.getComponent(c.default).init(this.GameMethod, o);
this._oddsNode.push(n);
}
};
t.prototype._refreshOddsRate = function() {
var e = p.default.Game.Model.bet_options;
if (this.GameMethod == u.PlayMethod.TPWar) for (var t = 0; t < this._oddsNode.length; t++) {
var o = this._oddsNode[t].getComponent(c.default);
0 == t || 1 == t ? o.OddsValue = e[t].x : o.OddsValueLabel.string = "Set" + e[2].x + "X Pure" + e[3].x + "X Seq" + e[4].x + "X Color" + e[5].x + "X Pair(A-8)" + e[6].x + "X";
} else for (t = 0; t < this._oddsNode.length; t++) (o = this._oddsNode[t].getComponent(c.default)).OddsValue = e[t].x;
};
t.prototype._onSelectedChip = function(e) {
var t = e.getUserData();
this._selectedChip = t;
};
t.prototype._onOddsClick = function(e) {
var t = p.default.Game.Model, o = e.getUserData();
if (f.default.getInstance().isCashGame) {
var n = s.default.Instance.getGamePlay(t.roomData.rtype), a = s.default.Instance.getPlaySwitch(null == n ? void 0 : n.cls);
if (a && (!a || 3 != a.s) || t.checkRecharge()) if (2 == t.roomData.state) if (t.total_fee >= this._selectedChip) if (t.getBetAmount() + this._selectedChip <= t.bet_limit) {
var i = t.bet_fee_currency.indexOf(1e3 * this._selectedChip);
cc.sys.localStorage.setItem(_.VM.getValue("user.uid") + "CompositeChipIndex" + this.GameMethod, String(i));
p.default.Game.Proxy.sendBet(this._selectedChip, o.index);
} else {
var c = h.Tools.TStr.replaceAll(l.default.getString("COMPOSITE_BET_MAX"), "%{num}", t.bet_limit);
v.PopHelper.Instance.showTips(c);
} else r.default.Instance.openRechargeAlert(this._selectedChip, 0); else {
m.default.Instance.playBundleEffect(y.BundleSoundPath.composite_odds_stop);
v.PopHelper.Instance.showTips(l.default.getString("COMPOSITE_TIPS_WAIT"));
} else r.default.Instance.openRechargeAlert(100, 0, !1);
} else _.VM.getValue("wallet.total") < 100 ? v.PopHelper.Instance.showTips(l.default.getString("NOT_CASH_TIPS_1")) : v.PopHelper.Instance.showTips(l.default.getString("NOT_CASH_TIPS_2"));
};
t.prototype.onEnable = function() {
g.default.Instance.Global.bind(d.CompositeGameEvent.GAME_RECONNECT, this._refreshOddsRate, this);
g.default.Instance.Global.bind(d.OddsEvent.ODDS_CLICK, this._onOddsClick, this);
g.default.Instance.Global.bind(d.BetChipEvent.BET_CHIP_CLICK, this._onSelectedChip, this);
};
t.prototype.onDisable = function() {
g.default.Instance.Global.unbind(d.CompositeGameEvent.GAME_RECONNECT, this._refreshOddsRate, this);
g.default.Instance.Global.unbind(d.OddsEvent.ODDS_CLICK, this._onOddsClick, this);
g.default.Instance.Global.unbind(d.BetChipEvent.BET_CHIP_CLICK, this._onSelectedChip, this);
};
t.prototype.onDestroy = function() {
this._oddsNode.forEach(function(e) {
e.removeFromParent(!0);
});
this._oddsNode.splice(0);
};
t.prototype.__preload = function() {};
t.prototype.onLoad = function() {};
t.prototype.start = function() {};
i([ I({
type: cc.Enum(u.PlayMethod)
}) ], t.prototype, "GameMethod", void 0);
i([ I({
type: cc.Prefab,
visible: function() {
return u.PlayMethod.TraditionAndarBahar != this.GameMethod;
}
}) ], t.prototype, "OddsPrefab", void 0);
i([ I({
type: [ cc.Node ],
visible: function() {
return u.PlayMethod.TraditionAndarBahar == this.GameMethod;
}
}) ], t.prototype, "TraditionOdds", void 0);
return i([ b ], t);
}(cc.Component);
o.default = E;
cc._RF.pop();
}, {
"../../../Game/Script/global/GlobalValue": "GlobalValue",
"../../../Game/client/global/enum/game/Const": "Const",
"../../../Game/client/model/LanguageModel": "LanguageModel",
"../../../Game/fromework/global/Tools": "Tools",
"../../../Game/fromework/helper/AudioHelper": "AudioHelper",
"../../../Game/fromework/helper/EventHelper": "EventHelper",
"../../../Game/fromework/mvvm/modelView/ViewModel": "ViewModel",
"../../../client/global/PopHelper": "PopHelper",
"../../../client/logic/Wallet/WalletHelper": "WalletHelper",
"../../../client/model/LobbyModel": "LobbyModel",
"../Component/CompositeOdds": "CompositeOdds",
"../Utils/CompositeConst": "CompositeConst",
"../Utils/CompositeEvent": "CompositeEvent",
"../Utils/CompositeUtil": "CompositeUtil"
} ],
OpenDeck: [ function(e, t, o) {
"use strict";
cc._RF.push(t, "3ad22pjoxZFuJjuTPJGTcik", "OpenDeck");
var n, a = this && this.__extends || (n = function(e, t) {
return (n = Object.setPrototypeOf || {
__proto__: []
} instanceof Array && function(e, t) {
e.__proto__ = t;
} || function(e, t) {
for (var o in t) Object.prototype.hasOwnProperty.call(t, o) && (e[o] = t[o]);
})(e, t);
}, function(e, t) {
n(e, t);
function o() {
this.constructor = e;
}
e.prototype = null === t ? Object.create(t) : (o.prototype = t.prototype, new o());
}), i = this && this.__decorate || function(e, t, o, n) {
var a, i = arguments.length, r = i < 3 ? t : null === n ? n = Object.getOwnPropertyDescriptor(t, o) : n;
if ("object" == typeof Reflect && "function" == typeof Reflect.decorate) r = Reflect.decorate(e, t, o, n); else for (var l = e.length - 1; l >= 0; l--) (a = e[l]) && (r = (i < 3 ? a(r) : i > 3 ? a(t, o, r) : a(t, o)) || r);
return i > 3 && r && Object.defineProperty(t, o, r), r;
};
Object.defineProperty(o, "__esModule", {
value: !0
});
var r = e("../../../Game/client/global/enum/game/Const"), l = cc._decorator, s = l.ccclass, c = l.property, u = function(e) {
a(t, e);
function t() {
var t = null !== e && e.apply(this, arguments) || this;
t.show = null;
t.label = null;
t.lightBorder = null;
t.CountNode = null;
t.OpenCardCount = null;
return t;
}
t.prototype.reset = function() {
this.show.active = !1;
this.lightBorder.active = !1;
};
t.prototype.setSlotActive = function(e) {
this.show.active = e;
};
t.prototype.setCountNodeActive = function(e) {
this.CountNode.active = e;
};
t.prototype.updateOpenCardCount = function(e) {
this.OpenCardCount.string = e + "";
};
t.prototype.alignmentToOpen = function(e) {
var t = this.node.parent.convertToWorldSpaceAR(this.node.getPosition());
e.setPosition(e.parent.convertToNodeSpaceAR(t));
e.scale = r.DESK_CARD_SCALE;
};
t.prototype.getOpenDeckPosInTarget = function(e) {
var t = this.node.parent.convertToWorldSpaceAR(this.node.getPosition());
return e.convertToNodeSpaceAR(t);
};
t.prototype.setLightBorderActive = function(e) {
this.lightBorder.active = e;
};
t.prototype.otherUserDrawOpenAction = function(e, t, o) {
this.alignmentToOpen(e.node);
e.node.active = !0;
var n = cc.sequence(cc.spawn(cc.moveTo(.2, t).easing(cc.easeCircleActionOut()), cc.scaleTo(.2, r.OTHER_CARD_SCALE)), cc.delayTime(.2), cc.fadeOut(.1), cc.callFunc(function() {
e.node.active = !1;
o && o();
}));
e.node.runAction(n);
};
t.prototype.otherUserDiscardAction = function(e, t, o) {
e.node.setPosition(t);
e.node.scale = r.OTHER_CARD_SCALE;
e.node.active = !0;
var n = this.node.parent.convertToWorldSpaceAR(this.node.getPosition()), a = e.node.parent.convertToNodeSpaceAR(n), i = cc.sequence(cc.spawn(cc.moveTo(.3, a).easing(cc.easeCircleActionOut()), cc.scaleTo(.3, r.DESK_CARD_SCALE)), cc.callFunc(function() {
o && o();
}));
e.node.runAction(i);
};
t.prototype.selfDisCardAction = function(e, t) {
e.node.active = !0;
e.node.zIndex = r.CARD_ZINDEX;
var o = this.node.parent.convertToWorldSpaceAR(this.node.getPosition()), n = e.node.parent.convertToNodeSpaceAR(o), a = cc.sequence(cc.spawn(cc.moveTo(.3, n).easing(cc.easeCircleActionOut()), cc.scaleTo(.3, r.DESK_CARD_SCALE)), cc.callFunc(function() {
t && t();
}));
e.node.runAction(a);
};
i([ c(cc.Node) ], t.prototype, "show", void 0);
i([ c(cc.Label) ], t.prototype, "label", void 0);
i([ c(cc.Node) ], t.prototype, "lightBorder", void 0);
i([ c(cc.Node) ], t.prototype, "CountNode", void 0);
i([ c(cc.Label) ], t.prototype, "OpenCardCount", void 0);
return i([ s ], t);
}(cc.Component);
o.default = u;
cc._RF.pop();
}, {
"../../../Game/client/global/enum/game/Const": "Const"
} ],
OtherMember: [ function(e, t, o) {
"use strict";
cc._RF.push(t, "06ac1MQcnpBs6F/A55PHsIn", "OtherMember");
var n, a = this && this.__extends || (n = function(e, t) {
return (n = Object.setPrototypeOf || {
__proto__: []
} instanceof Array && function(e, t) {
e.__proto__ = t;
} || function(e, t) {
for (var o in t) Object.prototype.hasOwnProperty.call(t, o) && (e[o] = t[o]);
})(e, t);
}, function(e, t) {
n(e, t);
function o() {
this.constructor = e;
}
e.prototype = null === t ? Object.create(t) : (o.prototype = t.prototype, new o());
}), i = this && this.__decorate || function(e, t, o, n) {
var a, i = arguments.length, r = i < 3 ? t : null === n ? n = Object.getOwnPropertyDescriptor(t, o) : n;
if ("object" == typeof Reflect && "function" == typeof Reflect.decorate) r = Reflect.decorate(e, t, o, n); else for (var l = e.length - 1; l >= 0; l--) (a = e[l]) && (r = (i < 3 ? a(r) : i > 3 ? a(t, o, r) : a(t, o)) || r);
return i > 3 && r && Object.defineProperty(t, o, r), r;
};
Object.defineProperty(o, "__esModule", {
value: !0
});
var r = e("../../../Game/client/global/enum/game/Event"), l = e("../../../Game/fromework/helper/EventHelper"), s = e("../../../Game/fromework/helper/UIHelper"), c = e("../Utils/CompositeConst"), u = e("../Utils/CompositeUtil"), d = e("./CompositeRankHead"), p = cc._decorator, h = p.ccclass, f = p.property, _ = function(e) {
a(t, e);
function t() {
var t = null !== e && e.apply(this, arguments) || this;
t.Panel = null;
t.MillionaireHead = null;
t.LuckyHead = null;
t.MillionaireWin = null;
t.MillionaireWinRound = null;
t.LuckyWin = null;
t.LuckyWinRound = null;
t.PlayerParent = null;
t.PlayerItem = null;
t.TotalPlayer = null;
t.Page = null;
t._curPage = 1;
t._maxPage = 1;
t._headArray = [];
return t;
}
t.prototype.onEnable = function() {
l.default.Instance.Global.bind(r.GameEvent.S2C_AB_RANK, this.onGetRank, this);
};
t.prototype.onDisable = function() {
l.default.Instance.Global.unbind(r.GameEvent.S2C_AB_RANK, this.onGetRank, this);
};
t.prototype.onLoad = function() {
var e = u.default.Game.Model;
this._curPage = 1;
this._maxPage = Math.ceil(e.total_user / c.OTHER_MEMBER_PAGE_NUM);
isNaN(this._maxPage) && (this._maxPage = 1);
this.refrehLabel();
this.initList();
};
t.prototype.initList = function() {
this.PlayerParent.destroyAllChildren();
this._headArray.splice(0);
for (var e = 0; e < c.OTHER_MEMBER_PAGE_NUM; e++) {
var t = cc.instantiate(this.PlayerItem);
t.active = !1;
t.setPosition(cc.Vec2.ZERO);
t.parent = this.PlayerParent;
var o = t.getChildByName("RankHead").getComponent(d.default);
this._headArray.push(o);
}
u.default.Game.Proxy.sendRank(this._curPage, c.OTHER_MEMBER_PAGE_NUM);
};
t.prototype.refrehLabel = function() {
this.TotalPlayer.string = u.default.Game.Model.total_user + "";
this.Page.string = this._curPage + "/" + this._maxPage;
};
t.prototype.onGetRank = function() {
var e = u.default.Game.Model, t = e.rankData, o = Math.ceil(e.total_user / c.OTHER_MEMBER_PAGE_NUM);
if (o != this._maxPage) {
this._maxPage = o;
if (this._curPage > this._maxPage) {
this._curPage = this._maxPage;
this.refrehLabel();
}
}
this.MillionaireHead.refreshHead(t.millionaire);
this.MillionaireWin.string = t.millionaire.fee + "";
this.MillionaireWinRound.string = t.millionaire.count + "";
this.LuckyHead.refreshHead(t.lucky);
this.LuckyWin.string = t.lucky.fee + "";
this.LuckyWinRound.string = t.lucky.count + "";
for (var n = 0; n < this._headArray.length; n++) {
var a = this._headArray[n], i = t.other[n];
if (null != i) {
a.node.parent.active = !0;
a.refreshHead(i);
} else a.node.parent.active = !1;
}
};
t.prototype.onPrevClicked = function() {
if (this._curPage - 1 != 0) {
this._curPage--;
this.refrehLabel();
u.default.Game.Proxy.sendRank(this._curPage, c.OTHER_MEMBER_PAGE_NUM);
}
};
t.prototype.onNextClicked = function() {
if (this._curPage + 1 <= this._maxPage) {
this._curPage++;
this.refrehLabel();
u.default.Game.Proxy.sendRank(this._curPage, c.OTHER_MEMBER_PAGE_NUM);
}
};
t.prototype.onCloseClicked = function() {
s.default.Instance.removeMaskLayer(this.node, !0);
};
i([ f(cc.Node) ], t.prototype, "Panel", void 0);
i([ f(d.default) ], t.prototype, "MillionaireHead", void 0);
i([ f(d.default) ], t.prototype, "LuckyHead", void 0);
i([ f(cc.Label) ], t.prototype, "MillionaireWin", void 0);
i([ f(cc.Label) ], t.prototype, "MillionaireWinRound", void 0);
i([ f(cc.Label) ], t.prototype, "LuckyWin", void 0);
i([ f(cc.Label) ], t.prototype, "LuckyWinRound", void 0);
i([ f(cc.Node) ], t.prototype, "PlayerParent", void 0);
i([ f(cc.Node) ], t.prototype, "PlayerItem", void 0);
i([ f(cc.Label) ], t.prototype, "TotalPlayer", void 0);
i([ f(cc.Label) ], t.prototype, "Page", void 0);
return i([ h ], t);
}(cc.Component);
o.default = _;
cc._RF.pop();
}, {
"../../../Game/client/global/enum/game/Event": "Event",
"../../../Game/fromework/helper/EventHelper": "EventHelper",
"../../../Game/fromework/helper/UIHelper": "UIHelper",
"../Utils/CompositeConst": "CompositeConst",
"../Utils/CompositeUtil": "CompositeUtil",
"./CompositeRankHead": "CompositeRankHead"
} ],
PhoneModel: [ function(e, t, o) {
"use strict";
cc._RF.push(t, "436d9pRhApDSbBFWc7o11Gq", "PhoneModel");
Object.defineProperty(o, "__esModule", {
value: !0
});
o.PhoneProxy = void 0;
var n = e("../../Config"), a = e("../../Game/client/global/enum/game/Event"), i = e("../../Game/client/global/enum/game/Game"), r = e("../../Game/client/global/enum/net/C2S"), l = e("../../Game/client/global/enum/net/S2C"), s = e("../../Game/client/model/LanguageModel"), c = e("../../Game/fromework/helper/EventHelper"), u = e("../../Game/fromework/mvvm/modelView/ViewModel"), d = e("../../fromework/helper/NetHelper"), p = e("../global/PopHelper"), h = function() {
function e() {
this._defaultPhone = "";
this._countDown = new Map();
}
Object.defineProperty(e, "Instance", {
get: function() {
e._instance || (e._instance = new e());
return e._instance;
},
enumerable: !1,
configurable: !0
});
e.prototype.Init = function() {
c.default.Instance.Net.bind(l.S2C.USER.GET_VERIFICATION_CODE, this._onGetVerificationCode, this);
c.default.Instance.Net.bind(l.S2C.USER.CHECK_VERIFICATION_CODE, this._onCheckVerificationCode, this);
};
e.prototype.clear = function() {
this._defaultPhone = "";
this._countDown.clear();
};
Object.defineProperty(e.prototype, "defaultPhone", {
get: function() {
return this._defaultPhone;
},
set: function(e) {
this._defaultPhone = e;
},
enumerable: !1,
configurable: !0
});
e.prototype.getCountDown = function(e) {
var t = this._countDown.get(e);
if (!t || 0 == t) return 0;
var o = t - new Date().getTime();
return Math.floor(o / 1e3);
};
e.prototype._onGetVerificationCode = function(e) {
var t = e.getUserData();
p.PopHelper.Instance.showTips(s.default.getString("OTP_TIPS_SEND"));
if (t.sms_type == i.GameEnum.VerificationType.SMS_TYPE_BIND_PHONE) {
c.default.Instance.Global.emit(a.WalletEvent.KYC_MOBILE_BIND_CODE, t.result);
c.default.Instance.Global.emit(a.GameUIEvent.BINDALERT_REFRESH_VIEW, t);
}
if (t.sms_type == i.GameEnum.VerificationType.SMS_TYPE_PHONE_LOGIN) {
c.default.Instance.Global.emit(a.UserEvent.USER_LOGIN_PHONE_OTP, t);
c.default.Instance.Global.emit(a.GameUIEvent.BINDALERT_REFRESH_VIEW, t);
}
t.sms_type == i.GameEnum.VerificationType.SMS_TYPE_BANK_CARD && c.default.Instance.Global.emit(a.GameUIEvent.BINDALERT_REFRESH_VIEW, t);
t.sms_type == i.GameEnum.VerificationType.SMS_TYPE_CHANGE_PHONE && c.default.Instance.Global.emit(a.GameUIEvent.BINDALERT_REFRESH_VIEW, t);
};
e.prototype._onCheckVerificationCode = function(e) {
var t = e.getUserData();
c.default.Instance.Global.emit(a.PhoneEvent.PHONE_CHECK_CODE, t);
};
e.prototype.sendGetVerificationCode = function(e, t, o, a) {
void 0 === o && (o = 91);
void 0 === a && (a = 6e4);
var l = new Date().getTime() + a;
this._countDown.set(e, l);
var s = {
sms_type: e,
phone: t,
country_code: o,
channel: n.Config.Channel
};
if (e != i.GameEnum.VerificationType.SMS_TYPE_PHONE_LOGIN) {
s.u = u.VM.getValue("user.uid");
s.t = u.VM.getValue("user.token");
}
var c = d.default.Instance.makeMsg(r.C2S.USER_GET_VERIFICATION_CODE, s);
d.default.Instance.sendHttp(c);
};
e.prototype.sendCenterGetVerificationCode = function(e, t, o, a) {
void 0 === o && (o = 91);
void 0 === a && (a = 6e4);
var l = new Date().getTime() + a;
this._countDown.set(e, l);
var s = {
sms_type: e,
phone: t,
country_code: o,
channel: n.Config.Channel
};
if (e != i.GameEnum.VerificationType.SMS_TYPE_PHONE_LOGIN) {
s.u = u.VM.getValue("user.uid");
s.t = u.VM.getValue("user.token");
}
var c = d.default.Instance.makeMsg(r.C2S.USER_GET_VERIFICATION_CODE, s);
d.default.Instance.sendLoadHttp(c);
};
e.prototype.sendCheckVerificationCode = function(e, t, o, a) {
void 0 === a && (a = 91);
var l = {
sms_type: e,
phone: t,
code: o,
country_code: a,
channel: n.Config.Channel
};
if (e != i.GameEnum.VerificationType.SMS_TYPE_PHONE_LOGIN) {
l.u = u.VM.getValue("user.uid");
l.t = u.VM.getValue("user.token");
}
var s = d.default.Instance.makeMsg(r.C2S.USER_CHECK_VERIFICATION_CODE, l);
d.default.Instance.sendHttp(s);
};
e._instance = null;
return e;
}();
o.PhoneProxy = h;
cc._RF.pop();
}, {
"../../Config": "Config",
"../../Game/client/global/enum/game/Event": "Event",
"../../Game/client/global/enum/game/Game": "Game",
"../../Game/client/global/enum/net/C2S": "C2S",
"../../Game/client/global/enum/net/S2C": "S2C",
"../../Game/client/model/LanguageModel": "LanguageModel",
"../../Game/fromework/helper/EventHelper": "EventHelper",
"../../Game/fromework/mvvm/modelView/ViewModel": "ViewModel",
"../../fromework/helper/NetHelper": "NetHelper",
"../global/PopHelper": "PopHelper"
} ],
Platform: [ function(e, t, o) {
"use strict";
cc._RF.push(t, "f22b8nqtOJFbYFv0etfCrqV", "Platform");
Object.defineProperty(o, "__esModule", {
value: !0
});
var n = e("../../Entry/Script/PhoneSdk"), a = function() {
function e() {}
e.log = function() {
for (var t = [], o = 0; o < arguments.length; o++) t[o] = arguments[o];
e.isShowLog && console.log(JSON.stringify(t));
};
e.warn = function() {
for (var t = [], o = 0; o < arguments.length; o++) t[o] = arguments[o];
e.isShowLog && console.warn(JSON.stringify(t));
};
e.error = function() {
for (var t = [], o = 0; o < arguments.length; o++) t[o] = arguments[o];
e.isShowLog && console.error(JSON.stringify(t));
};
e.loginFb = function() {
n.default.loginFb && n.default.loginFb();
};
e.logOutFb = function() {
n.default.logOutFb && n.default.logOutFb();
};
e.getFbUserInfo = function() {
n.default.getFbUserInfo && n.default.getFbUserInfo();
};
e.shareFb = function(e) {
n.default.shareFb && n.default.shareFb(e);
};
e.startConnectGooglePlay = function() {
n.default.startConnectGooglePlay && n.default.startConnectGooglePlay();
};
e.logSignUp = function(e) {
void 0 === e && (e = "Guest");
n.default.logSignUp && n.default.logSignUp(e);
};
e.logLogin = function(e) {
void 0 === e && (e = "Guest");
n.default.logLogin && n.default.logLogin(e);
};
e.logUnlockAchievement = function(e) {
n.default.logUnlockAchievement && n.default.logUnlockAchievement(e);
};
e.logPurchase = function(e) {
n.default.logPurchase && n.default.logPurchase(e);
};
e.logRefund = function(e) {
n.default.logRefund && n.default.logRefund(e);
};
e.logEarnVirtualCurrency = function(e) {
n.default.logEarnVirtualCurrency && n.default.logEarnVirtualCurrency(e);
};
e.logSpendVirtualCurrency = function(e) {
n.default.logSpendVirtualCurrency && n.default.logSpendVirtualCurrency(e);
};
e.logEvent = function(e, t) {
void 0 === t && (t = "{param:1}");
n.default.logEvent && n.default.logEvent(e, t);
};
e.fireBaseCreateDynamicLink = function(e, t, o, a) {
n.default.fireBaseCreateDynamicLink && n.default.fireBaseCreateDynamicLink(e, t, o, a);
};
e.fireBaseGetDynamicLink = function() {
n.default.fireBaseGetDynamicLink && n.default.fireBaseGetDynamicLink();
};
e.sendLoginEvent = function() {
n.default.sendLoginEvent && n.default.sendLoginEvent();
};
e.sendCompleteRegistrationEvent = function(e) {
void 0 === e && (e = "Guest");
n.default.sendCompleteRegistrationEvent && n.default.sendCompleteRegistrationEvent(e);
};
e.sendPurchaseEvent = function(e, t) {
n.default.sendPurchaseEvent && n.default.sendPurchaseEvent(e, t);
};
e.sendFirstPurchaseEvent = function(e, t) {
n.default.sendFirstPurchaseEvent && n.default.sendFirstPurchaseEvent(e, t);
};
e.sendEvent = function(e, t) {
void 0 === t && (t = "{param:1}");
n.default.sendEvent && n.default.sendEvent(e, t);
};
e.sendAppFlyerLog = function(e) {
n.default.sendAppFlyerLog && n.default.sendAppFlyerLog(e);
};
e.vibrator = function() {
n.default.vibrator && n.default.vibrator();
};
e.takePhoto = function() {
n.default.takePhoto && n.default.takePhoto();
};
e.pickImageFromAlbum = function() {
n.default.pickImageFromAlbum && n.default.pickImageFromAlbum();
};
e.copyTextToClipboard = function(e) {
n.default.copyTextToClipboard && n.default.copyTextToClipboard(e);
};
e.setOrientation = function(e) {
n.default.setOrientation && n.default.setOrientation(e);
};
e.setKeepScreenOn = function(e) {
cc.sys.os == cc.sys.OS_ANDROID && cc.sys.isNative && jsb.reflection.callStaticMethod("org/cocos2dx/lib/Cocos2dxHelper", "setKeepScreenOn", "(Z)V", e);
};
e.shareToPhoneText = function(e, t) {
n.default.shareToPhoneText && n.default.shareToPhoneText(e, t);
};
e.shareTextToPackage = function(e, t) {
n.default.shareTextToPackage && n.default.shareTextToPackage(e, t);
};
e.signInByGoogle = function() {
n.default.signInByGoogle && n.default.signInByGoogle();
};
e.initRewardedAd = function() {
n.default.initRewardedAd && n.default.initRewardedAd();
};
e.playRewardedAd = function() {
n.default.playRewardedAd && n.default.playRewardedAd();
};
e.sendGoodPay = function(e) {
n.default.sendGoodPay && n.default.sendGoodPay(e);
};
e.sendGoodPayPurchase = function() {
n.default.sendGoodPayPurchase && n.default.sendGoodPayPurchase();
};
e.getOnlyID = function() {
return n.default.getOnlyID ? n.default.getOnlyID() : "";
};
e.getDeviceID = function() {
return n.default.getDeviceID ? n.default.getDeviceID() : "";
};
e.getPackageName = function() {
return n.default.getPackageName ? n.default.getPackageName() : "";
};
e.getVersionCode = function() {
return n.default.gameVersion;
};
e.getNetworkOperatorMCC = function() {
return n.default.getNetworkOperatorMCC ? n.default.getNetworkOperatorMCC() : "";
};
e.getTextFromClipboard = function() {
return n.default.getTextFromClipboard ? n.default.getTextFromClipboard() : "";
};
e.getAFID = function() {
return n.default.getAFID ? n.default.getAFID() : "";
};
e.getGoogleAdID = function() {
return n.default.getGoogleAdID ? n.default.getGoogleAdID() : "";
};
e.getLogInstanceID = function() {
return n.default.getLogInstanceID ? n.default.getLogInstanceID() : "";
};
e.getAdType = function() {
return n.default.getAdType ? n.default.getAdType() : "";
};
e.getHotUpdateUrl = function() {
return n.default.getHotUpdateUrl ? n.default.getHotUpdateUrl() : "";
};
e.getSingleMinMoney = function() {
return n.default.getSingleMinMoney ? n.default.getSingleMinMoney() : "";
};
e.getisEncryption = function() {
return !!n.default.getisEncryption && n.default.getisEncryption();
};
e.getencryptionKey = function() {
return n.default.getencryptionKey ? n.default.getencryptionKey() : "";
};
e.getencryptionMD5 = function() {
return n.default.getencryptionMD5 ? n.default.getencryptionMD5() : "";
};
e.getGameVersion = function() {
return n.default.gameVersion;
};
e.isOfflinePackage = function() {
return cc.sys.os == cc.sys.OS_ANDROID && ("com.web.dwnld.a1.safeapk" == e.getPackageName() || e.getPackageName().includes("com.wsx.edctp.a1") || e.getPackageName().includes("a1") && e.getPackageName().includes("vv") || e.getPackageName().includes("a1") && e.getPackageName().includes("op") || e.getPackageName().includes("a1") && e.getPackageName().includes("mi"));
};
e.isShowLog = cc.sys.isBrowser || "com.test.test2.test3" == e.getPackageName() || "com.wsx.edctp.test" == e.getPackageName();
return e;
}();
o.default = a;
cc._RF.pop();
}, {
"../../Entry/Script/PhoneSdk": void 0
} ],
PlayerHeadManager: [ function(e, t, o) {
"use strict";
cc._RF.push(t, "c7417d5IHtLF4wby4uuqQYu", "PlayerHeadManager");
var n, a = this && this.__extends || (n = function(e, t) {
return (n = Object.setPrototypeOf || {
__proto__: []
} instanceof Array && function(e, t) {
e.__proto__ = t;
} || function(e, t) {
for (var o in t) Object.prototype.hasOwnProperty.call(t, o) && (e[o] = t[o]);
})(e, t);
}, function(e, t) {
n(e, t);
function o() {
this.constructor = e;
}
e.prototype = null === t ? Object.create(t) : (o.prototype = t.prototype, new o());
}), i = this && this.__decorate || function(e, t, o, n) {
var a, i = arguments.length, r = i < 3 ? t : null === n ? n = Object.getOwnPropertyDescriptor(t, o) : n;
if ("object" == typeof Reflect && "function" == typeof Reflect.decorate) r = Reflect.decorate(e, t, o, n); else for (var l = e.length - 1; l >= 0; l--) (a = e[l]) && (r = (i < 3 ? a(r) : i > 3 ? a(t, o, r) : a(t, o)) || r);
return i > 3 && r && Object.defineProperty(t, o, r), r;
};
Object.defineProperty(o, "__esModule", {
value: !0
});
var r = e("../../../Game/client/global/enum/game/Event"), l = e("../../../Game/fromework/helper/EventHelper"), s = e("../../../Game/fromework/mvvm/modelView/ViewModel"), c = e("../Component/CompositeChipGenerator"), u = e("../Component/CompositePlayerHead"), d = e("../Component/CompositeWinMoney"), p = e("../Utils/CompositeConst"), h = e("../Utils/CompositeEvent"), f = e("../Utils/CompositeUtil"), _ = cc._decorator, m = _.ccclass, y = _.property, g = function(e) {
a(t, e);
function t() {
var t = null !== e && e.apply(this, arguments) || this;
t.PlayerHeadPrefab = null;
return t;
}
t.prototype.init = function() {
for (var e = p.HeadPositions, t = 0; t < e.length - 2; ++t) {
var o = cc.instantiate(this.PlayerHeadPrefab);
o.parent = this.node;
o.position = e[t];
o.getComponent(u.default).init(t);
o.getComponent(c.default).init(t);
o.getComponentInChildren(d.default).init(t);
}
};
t.prototype._refreshPlayersHead = function() {
for (var e = f.default.Game.Model, t = 0; t < 7; t++) {
var o = {
type: 0,
index: t,
head: null
}, n = f.default.getGeneratorUserData(t);
if (null != n) {
o.type = n.label, o.index = n.seat, o.head = {
id: n.uid,
icon_url: n.head_url,
name: n.name,
money: n.total_fee
};
l.default.Instance.Global.emit(h.UserEvent.USER_REFRESH_DATA, o);
}
}
var a = e.getUserData(s.VM.getValue("user.uid"));
if (null != a) {
(o = {
type: 0,
index: 7,
head: null
}).head = {
id: a.uid,
icon_url: a.head_url,
name: a.name,
money: a.total_fee
};
l.default.Instance.Global.emit(h.UserEvent.USER_REFRESH_DATA, o);
}
};
t.prototype.onEnable = function() {
l.default.Instance.Global.bind(r.GameEvent.S2C_ENTER_ROOM, this._refreshPlayersHead, this);
l.default.Instance.Global.bind(r.GameEvent.S2C_RESET, this._refreshPlayersHead, this);
l.default.Instance.Global.bind(r.GameEvent.S2C_AB_BET, this._refreshPlayersHead, this);
l.default.Instance.Global.bind(r.GameEvent.S2C_SEND_AVAILABLE_BALANCE, this._refreshPlayersHead, this);
l.default.Instance.Global.bind(h.CompositeGameEvent.UI_EFFECT_START_BET, this._refreshPlayersHead, this);
l.default.Instance.Global.bind(h.CompositeGameEvent.UI_EFFECT_STOP_BET, this._refreshPlayersHead, this);
};
t.prototype.onDisable = function() {
l.default.Instance.Global.unbind(r.GameEvent.S2C_ENTER_ROOM, this._refreshPlayersHead, this);
l.default.Instance.Global.unbind(r.GameEvent.S2C_RESET, this._refreshPlayersHead, this);
l.default.Instance.Global.unbind(r.GameEvent.S2C_AB_BET, this._refreshPlayersHead, this);
l.default.Instance.Global.unbind(r.GameEvent.S2C_SEND_AVAILABLE_BALANCE, this._refreshPlayersHead, this);
l.default.Instance.Global.unbind(h.CompositeGameEvent.UI_EFFECT_START_BET, this._refreshPlayersHead, this);
l.default.Instance.Global.unbind(h.CompositeGameEvent.UI_EFFECT_STOP_BET, this._refreshPlayersHead, this);
};
t.prototype.onLoad = function() {
this.init();
};
t.prototype.start = function() {};
i([ y(cc.Prefab) ], t.prototype, "PlayerHeadPrefab", void 0);
return i([ m ], t);
}(cc.Component);
o.default = g;
cc._RF.pop();
}, {
"../../../Game/client/global/enum/game/Event": "Event",
"../../../Game/fromework/helper/EventHelper": "EventHelper",
"../../../Game/fromework/mvvm/modelView/ViewModel": "ViewModel",
"../Component/CompositeChipGenerator": "CompositeChipGenerator",
"../Component/CompositePlayerHead": "CompositePlayerHead",
"../Component/CompositeWinMoney": "CompositeWinMoney",
"../Utils/CompositeConst": "CompositeConst",
"../Utils/CompositeEvent": "CompositeEvent",
"../Utils/CompositeUtil": "CompositeUtil"
} ],
PlayerHead_tp: [ function(e, t, o) {
"use strict";
cc._RF.push(t, "9002e+oGUhHgKLdWnGEVhrm", "PlayerHead_tp");
var n, a = this && this.__extends || (n = function(e, t) {
return (n = Object.setPrototypeOf || {
__proto__: []
} instanceof Array && function(e, t) {
e.__proto__ = t;
} || function(e, t) {
for (var o in t) Object.prototype.hasOwnProperty.call(t, o) && (e[o] = t[o]);
})(e, t);
}, function(e, t) {
n(e, t);
function o() {
this.constructor = e;
}
e.prototype = null === t ? Object.create(t) : (o.prototype = t.prototype, new o());
}), i = this && this.__decorate || function(e, t, o, n) {
var a, i = arguments.length, r = i < 3 ? t : null === n ? n = Object.getOwnPropertyDescriptor(t, o) : n;
if ("object" == typeof Reflect && "function" == typeof Reflect.decorate) r = Reflect.decorate(e, t, o, n); else for (var l = e.length - 1; l >= 0; l--) (a = e[l]) && (r = (i < 3 ? a(r) : i > 3 ? a(t, o, r) : a(t, o)) || r);
return i > 3 && r && Object.defineProperty(t, o, r), r;
};
Object.defineProperty(o, "__esModule", {
value: !0
});
var r = e("../../../Game/client/global/enum/game/Const"), l = e("../../../Game/client/global/enum/game/Game"), s = e("../../../Game/client/global/enum/game/UIUtils"), c = e("../../../Game/client/model/LanguageModel"), u = e("../../../Game/fromework/global/Tools"), d = e("../../../Game/fromework/helper/AudioHelper"), p = e("../../../Game/fromework/mvvm/modelView/ViewModel"), h = e("../../../platform/Platform"), f = cc._decorator, _ = f.ccclass, m = f.property, y = function(e) {
a(t, e);
function t() {
var t = null !== e && e.apply(this, arguments) || this;
t.Head = null;
t.RealHead = null;
t.Empty = null;
t.CardParent = null;
t.UserName = null;
t.CompareNode = null;
t.WinNode = null;
t.SeenNode = null;
t.HeadImage = null;
t.TimeProgress = null;
t.TimeLight = null;
t.DSeat = null;
t.Packed = null;
t.Waitting = null;
t.State = null;
t.StateLabel = null;
t.isSelfHead = !1;
t.Frame_CurHead = [];
t.spineNode = null;
t._isCountDown = !1;
t._headUrl = "";
t._isLoadImage = !1;
t._seenPosX = 0;
t._index = -1;
return t;
}
t.prototype.onLoad = function() {
this.spineNode.active = !1;
};
t.prototype.setDSeat = function(e) {
this.DSeat.active = e;
};
t.prototype.setIndex = function(e) {
this._index = e;
this.setNormalCard();
};
t.prototype.setNormalCard = function() {
if (0 != this._index) {
this.CardParent.scale = 1;
if (1 == this._index || 2 == this._index) {
this.CardParent.setPosition(cc.v2(-120, -15));
this.SeenNode.setPosition(cc.v2(-120, -5));
this.State.setPosition(cc.v2(-120, -35));
} else {
this.CardParent.setPosition(cc.v2(120, -15));
this.SeenNode.setPosition(cc.v2(120, -5));
this.State.setPosition(cc.v2(120, -35));
}
this._seenPosX = this.SeenNode.x;
}
};
t.prototype.setResultCard = function() {
if (0 != this._index) {
this.CardParent.scale = 1.5;
1 == this._index || 2 == this._index ? this.CardParent.setPosition(cc.v2(-150, -35)) : this.CardParent.setPosition(cc.v2(150, -35));
}
};
t.prototype.refreshUserHeadImg = function(e) {
if (null != e && "" != e) {
if (this._headUrl != e) {
this._headUrl = e;
s.UIUtils.updateHeadImage(e, this.HeadImage, cc.size(105, 105));
}
} else this.HeadImage.spriteFrame = this.isSelfHead ? this.Frame_CurHead[0] : this.Frame_CurHead[1];
};
t.prototype.refreshSeen = function(e) {
if (e.state == l.GameEnum.UserState.ROOM_USER_STATE_PLAY) {
e.tp_state != l.GameEnum.TP_UserState.ROOM_USER_STATE_INIT && e.tp_state != l.GameEnum.TP_UserState.ROOM_USER_STATE_BLIND || (this.SeenNode.active = !1);
if (e.tp_state == l.GameEnum.TP_UserState.ROOM_USER_STATE_SEEN) {
if (!this.SeenNode.active) {
this.SeenNode.active = !0;
this.SeenNode.opacity = 0;
this.SeenNode.x = this._seenPosX - 50;
cc.tween(this.SeenNode).to(.3, {
opacity: 255,
x: this._seenPosX
}, {
easing: "sineOutIn"
}).start();
}
this.StateLabel.string = c.default.getString("TP_HEAD_SEEN");
}
} else this.SeenNode.active = !1;
};
t.prototype.refreshPacked = function(e) {
e.state == l.GameEnum.UserState.ROOM_USER_STATE_DROP || e.state == l.GameEnum.UserState.ROOM_USER_STATE_LEAVE ? this.Packed.active = !0 : e.res == l.GameEnum.UserResult.ROOM_USER_RESULT_LOSE || e.res == l.GameEnum.UserResult.ROOM_USER_RESULT_DROP ? this.Packed.active = !0 : this.Packed.active = !1;
};
t.prototype.getSeenState = function() {
return this.SeenNode.active;
};
t.prototype.refreshState = function(e) {
this.Waitting.active = e.state == l.GameEnum.UserState.ROOM_USER_STATE_WATCH;
if (e.state == l.GameEnum.UserState.ROOM_USER_STATE_WATCH) {
this.Packed.active = !1;
this.State.active = !1;
this.Head.scale = .8;
this.SeenNode.active = !1;
this.setHeadScale(1);
} else if (e.state == l.GameEnum.UserState.ROOM_USER_STATE_PLAY) {
this.Packed.active = !1;
this.State.active = !0;
e.tp_state != l.GameEnum.TP_UserState.ROOM_USER_STATE_COMPARE && this.setHeadScale(0);
if (this.isSelfHead) {
this.State.active = !1;
return;
}
var t = "";
if (e.tp_state == l.GameEnum.TP_UserState.ROOM_USER_STATE_INIT) {
this.Packed.active = !1;
this.State.active = !1;
this.SeenNode.active = !1;
}
if (e.tp_state == l.GameEnum.TP_UserState.ROOM_USER_STATE_BLIND) {
t = "Blind";
this.SeenNode.active = !1;
}
if (e.tp_state == l.GameEnum.TP_UserState.ROOM_USER_STATE_SEEN) {
t = "Seen";
if (!this.SeenNode.active) {
this.SeenNode.active = !0;
this.SeenNode.opacity = 0;
this.SeenNode.x = this._seenPosX - 50;
cc.tween(this.SeenNode).to(.3, {
opacity: 255,
x: this._seenPosX
}, {
easing: "sineOutIn"
}).start();
}
}
if (e.tp_state == l.GameEnum.TP_UserState.ROOM_USER_STATE_CHAAL) {
t = "Chaal";
this.SeenNode.active = 0 == e.res;
}
if (e.tp_state == l.GameEnum.TP_UserState.ROOM_USER_STATE_COMPARE) {
t = "Show";
this.SeenNode.active = 0 == e.res;
}
e.is_recharging && (t = "Recharge");
e.fee > 0 && !e.is_recharging ? this.StateLabel.string = t + "(" + c.default.getString("MoneySymbol") + e.fee + ")" : this.StateLabel.string = t;
} else if (e.state == l.GameEnum.UserState.ROOM_USER_STATE_DROP) {
this.Packed.active = !0;
this.State.active = !1;
this.SeenNode.active = !1;
this.setHeadScale(1);
} else if (e.state == l.GameEnum.UserState.ROOM_USER_STATE_LEAVE) {
this.Packed.active = !0;
this.State.active = !1;
this.SeenNode.active = !1;
this.setHeadScale(1);
} else {
this.Packed.active = !1;
this.State.active = !1;
this.SeenNode.active = !1;
this.setHeadScale(0);
}
if (e.res != l.GameEnum.UserResult.ROOM_USER_RESULT_PLAY) {
if (e.res == l.GameEnum.UserResult.ROOM_USER_RESULT_WIN) {
this.Packed.active = !1;
this.State.active = !1;
this.setHeadScale(0);
}
if (e.res == l.GameEnum.UserResult.ROOM_USER_RESULT_LOSE || e.res == l.GameEnum.UserResult.ROOM_USER_RESULT_DROP) {
this.Packed.active = !0;
this.State.active = !1;
this.setHeadScale(1);
}
}
};
t.prototype.refresh = function(e) {
if (null == e) {
this.Empty.active = !0;
this.RealHead.active = !1;
this.CardParent.active = !1;
this.WinNode.active = !1;
this.SeenNode.active = !1;
this.State.active = !1;
this.UserName.string = "";
this.setHeadScale(1);
this.HeadImage.spriteFrame = this.isSelfHead ? this.Frame_CurHead[0] : this.Frame_CurHead[1];
this._headUrl = "";
this._isLoadImage = !1;
} else {
this.Empty.active = !1;
this.RealHead.active = !0;
this.CardParent.active = !0;
this.isSelfHead ? this.UserName.string = "" : this.UserName.string = u.Tools.TStr.ellipsisString(e.name, 12);
this.refreshUserHeadImg(e.head_url);
this.refreshState(e);
}
};
t.prototype.showStateAction = function(e) {
this.StateLabel.string = e;
};
t.prototype.showTimeLight = function() {
this.TimeLight.active = !0;
this.TimeLight.opacity = 0;
var e = cc.tween(this.TimeLight).to(.5, {
opacity: 255
}).to(.5, {
opacity: 0
});
cc.tween(this.TimeLight).then(e).repeatForever().start();
};
t.prototype.hideTimeLight = function() {
this.TimeLight.stopAllActions();
this.TimeLight.opacity = 0;
this.TimeLight.active = !1;
};
t.prototype.startCountDown = function(e, t) {
var o = this;
if (!this._isCountDown) {
this._isCountDown = !0;
this.TimeProgress.node.active = !0;
this.TimeProgress.fillRange = 1;
this.TimeProgress.node.color = cc.color(255, 255, 255);
var n = Math.floor(e), a = 1 / n, i = cc.tween(this.TimeProgress.node).to(n, {
color: cc.color(255, 255, 255)
}), l = cc.tween(this.TimeProgress).call(function() {
if (o.isSelfHead && (7 == n || 3 == n)) {
p.VM.getValue("lobbySet.isPlayVibration") && h.default.vibrator();
7 == n && o.showTimeLight();
}
o.isSelfHead && n <= 5 && d.default.Instance.playBundleEffect(r.BundleSoundPath.rummy_five_seconds);
n--;
}).by(1, {
fillRange: -a
});
cc.tween(this.TimeProgress).call(function() {
i.start();
}).repeat(n, l).call(function() {
o._isCountDown = !1;
o.TimeProgress.node.active = !1;
o.hideTimeLight();
t && t();
}).start();
}
};
t.prototype.stopCountDown = function() {
this.TimeProgress.node.active = !1;
this.hideTimeLight();
cc.Tween.stopAllByTarget(this.TimeProgress);
cc.Tween.stopAllByTarget(this.TimeProgress.node);
this.TimeProgress.node.color = cc.color(255, 255, 255);
this.TimeProgress.fillRange = 1;
this._isCountDown = !1;
};
t.prototype.setHeadScale = function(e) {
cc.Tween.stopAllByTarget(this.Head);
var t = .95;
0 == e && (t = .95);
1 == e && (t = .8);
2 == e && (t = 1.1);
t != this.Head.scale && cc.tween(this.Head).to(.1, {
scale: t
}).start();
};
t.prototype.playWinAnimation = function(e) {
var t = this;
this.WinNode.active = !0;
this.DSeat.active = !1;
var o = this.WinNode.getChildByName("Crown").getComponent(cc.Animation), n = function() {
if (t && t.node && t.node.isValid) {
o.off("finished", n, t);
t.WinNode.active = !1;
t.DSeat.active = !0;
}
e && e();
};
o.on("finished", n, this);
o.play();
this.spineNode.active = !0;
var a = this.spineNode.getComponent(sp.Skeleton);
a.premultipliedAlpha = !1;
a.setAnimation(0, "animation", !1);
d.default.Instance.playBundleEffect("resources/sound/teenpatti/common_win");
d.default.Instance.playBundleEffect("resources/sound/teenpatti/slot_bigwin_cheer");
};
t.prototype.setCompareEffect = function(e) {
this.CompareNode.active = e;
e ? this.setHeadScale(2) : this.setHeadScale(0);
};
i([ m(cc.Node) ], t.prototype, "Head", void 0);
i([ m(cc.Node) ], t.prototype, "RealHead", void 0);
i([ m(cc.Node) ], t.prototype, "Empty", void 0);
i([ m(cc.Node) ], t.prototype, "CardParent", void 0);
i([ m(cc.Label) ], t.prototype, "UserName", void 0);
i([ m(cc.Node) ], t.prototype, "CompareNode", void 0);
i([ m(cc.Node) ], t.prototype, "WinNode", void 0);
i([ m(cc.Node) ], t.prototype, "SeenNode", void 0);
i([ m(cc.Sprite) ], t.prototype, "HeadImage", void 0);
i([ m(cc.Sprite) ], t.prototype, "TimeProgress", void 0);
i([ m(cc.Node) ], t.prototype, "TimeLight", void 0);
i([ m(cc.Node) ], t.prototype, "DSeat", void 0);
i([ m(cc.Node) ], t.prototype, "Packed", void 0);
i([ m(cc.Node) ], t.prototype, "Waitting", void 0);
i([ m(cc.Node) ], t.prototype, "State", void 0);
i([ m(cc.Label) ], t.prototype, "StateLabel", void 0);
i([ m(cc.Boolean) ], t.prototype, "isSelfHead", void 0);
i([ m([ cc.SpriteFrame ]) ], t.prototype, "Frame_CurHead", void 0);
i([ m(cc.Node) ], t.prototype, "spineNode", void 0);
return i([ _ ], t);
}(cc.Component);
o.default = y;
cc._RF.pop();
}, {
"../../../Game/client/global/enum/game/Const": "Const",
"../../../Game/client/global/enum/game/Game": "Game",
"../../../Game/client/global/enum/game/UIUtils": "UIUtils",
"../../../Game/client/model/LanguageModel": "LanguageModel",
"../../../Game/fromework/global/Tools": "Tools",
"../../../Game/fromework/helper/AudioHelper": "AudioHelper",
"../../../Game/fromework/mvvm/modelView/ViewModel": "ViewModel",
"../../../platform/Platform": "Platform"
} ],
PopHelper: [ function(e, t, o) {
"use strict";
cc._RF.push(t, "54225ZKIClOmKmISPnWy6MJ", "PopHelper");
Object.defineProperty(o, "__esModule", {
value: !0
});
o.PopHelper = o.PopZindex = void 0;
var n = e("../../../BundleGame/client/component/pop/CountDown"), a = e("../../../BundleGame/client/component/pop/Alert"), i = e("../../../BundleGame/client/component/pop/TableMenu"), r = e("../../../BundleGame/client/component/ScoreWindow"), l = e("../../../BundleGame/client/component/pop/BestDeclare"), s = e("../../../BundleGame/client/logic/ui/CardRecorder/CardRecorder"), c = e("../../../BundleGame/client/component/Waiting"), u = e("../../../BundleGame/client/logic/ui/ScoreBoard/ScoreBoard"), d = e("../../../BundleGame/client/logic/ui/SplitPrize/SplitPrize"), p = e("../../../BundleGame/client/logic/ui/TotalResult/TotalResult"), h = e("../../../BundleGame/client/component/NumericEditorBox"), f = e("../../../BundleGame/client/logic/ui/RewardView/RewardView"), _ = e("../../Game/fromework/global/ResLoader"), m = e("../../Game/client/component/pop/Tips"), y = e("../../Game/fromework/helper/EventHelper"), g = e("../../Game/client/global/enum/game/Event"), v = e("../../Game/client/global/enum/game/Const"), C = e("../../platform/Platform");
o.PopZindex = {
RBFast: 5,
AddCash: 9,
CountDown: 10,
Tips: 20,
TableMenu: 30,
BestDeclare: 40,
Reward: 45,
Alert: 50,
NumberEditBox: 60
};
var b = function() {
function e() {
var e = this;
this._countdownMap = new Map();
this._TipsPool = null;
this._curAlert = null;
this._curTableMenu = null;
this._curScoreWindow = null;
this._curBestDeclare = null;
this._curCardRecorder = null;
this._waiting = null;
this._curScoreBoard = null;
this._curTotalResult = null;
this._curSplitPrize = null;
this._curNumberEditBox = null;
this._tcreating = !1;
this._TipsPool = new cc.NodePool();
_.default.Instance.loadBundleRes(v.BundleUIPath.Tips, cc.Prefab, function(t, o) {
C.default.log("bundle");
if (t) C.default.error(t); else try {
for (var n = 0; n < 5; n++) {
var a = cc.instantiate(o);
a.getComponent(m.default).init(e._TipsPool);
e._TipsPool.put(a);
}
} catch (e) {
C.default.error(e);
}
});
}
e.prototype.Init = function() {
this.bindEvent();
};
e.prototype.clear = function() {
this._countdownMap.forEach(function(e) {
e && e.node && e.node.isValid && e.close();
});
this._countdownMap.clear();
this._TipsPool.clear();
this.unBindEvent();
};
e.prototype.bindEvent = function() {
y.default.Instance.Global.bind(g.GameUIEvent.SHOW_NUMBER_EDITBOX, this.showNumberEditBox, this);
};
e.prototype.unBindEvent = function() {
y.default.Instance.Global.unbind(g.GameUIEvent.SHOW_NUMBER_EDITBOX, this.showNumberEditBox, this);
};
Object.defineProperty(e, "Instance", {
get: function() {
e._Instance || (e._Instance = new e());
return e._Instance;
},
enumerable: !1,
configurable: !0
});
e.prototype.showCountdown = function(e, t, a, i, r, l, s, c) {
var u = this;
void 0 === i && (i = null);
void 0 === r && (r = null);
void 0 === l && (l = null);
void 0 === s && (s = null);
void 0 === c && (c = !1);
_.default.Instance.loadBundleRes(v.BundleUIPath.CountDown, cc.Prefab, function(d, p) {
if (d) C.default.error(d); else try {
var h = cc.instantiate(p), f = l || cc.director.getScene().getChildByName(v.Layer.Canvas).getChildByName(v.Layer.TopLayer), _ = h.getComponent(n.default);
_.show(e, t, function() {
r ? i && i.call(r) : i && i();
u._countdownMap.delete(a);
}, r, c);
u._countdownMap.set(a, _);
h.zIndex = o.PopZindex.CountDown;
null != s && h.setPosition(s);
f.addChild(h);
} catch (e) {
C.default.error(e);
}
});
};
e.prototype.getSurplusCountdown = function(e) {
return this._countdownMap.has(e) ? this._countdownMap.get(e).surplusTime : 0;
};
e.prototype.closeCountdown = function(e) {
if (this._countdownMap.size > 0 && this._countdownMap.has(e)) {
this._countdownMap.get(e).close();
this._countdownMap.delete(e);
}
};
e.prototype.showTips = function(e, t, n) {
void 0 === t && (t = null);
void 0 === n && (n = null);
var a = this._TipsPool.get();
if (null != a) {
var i = t || cc.director.getScene().getChildByName(v.Layer.Canvas).getChildByName(v.Layer.TopLayer);
a.zIndex = o.PopZindex.Tips;
a.parent = i;
null != n ? a.setPosition(n) : a.setPosition(cc.Vec2.ZERO);
a.getComponent(m.default).showTips(e);
C.default.log(e);
} else C.default.log("tips pool is full!!! size is :" + this._TipsPool.size());
};
e.prototype.showAlert = function(e, t) {
var n = this;
void 0 === t && (t = null);
this.closeAlert();
var i = v.BundleUIPath.Alert;
_.default.Instance.loadBundleRes(i, cc.Prefab, function(i, r) {
if (i) C.default.error(i); else try {
var l = cc.instantiate(r), s = t || cc.director.getScene().getChildByName(v.Layer.Canvas).getChildByName(v.Layer.TopLayer);
l.zIndex = o.PopZindex.Alert;
s.addChild(l);
n._curAlert = l.getComponent(a.default);
n._curAlert.show(e);
} catch (e) {
C.default.error(e);
}
});
};
e.prototype.closeAlert = function() {
if (this._curAlert && this._curAlert.node && this._curAlert.node.isValid) {
this._curAlert.close();
this._curAlert = null;
}
};
e.prototype.showSlotItemAlert = function(e, t) {
void 0 === t && (t = null);
var n = v.BundleUIPath.SlotItemAlert;
_.default.Instance.loadBundleRes(n, cc.Prefab, function(e, n) {
if (e) C.default.error(e); else {
var a = cc.instantiate(n), i = t || cc.director.getScene().getChildByName(v.Layer.Canvas).getChildByName(v.Layer.TopLayer);
a.zIndex = o.PopZindex.Alert;
i.addChild(a);
}
});
};
e.prototype.showTableMenu = function(e, t) {
var n = this;
_.default.Instance.loadBundleRes(v.BundleUIPath.TableMenu, cc.Prefab, function(a, r) {
if (a) C.default.error(a); else try {
var l = cc.instantiate(r), s = t || cc.director.getScene().getChildByName(v.Layer.Canvas).getChildByName(v.Layer.TopLayer);
l.zIndex = o.PopZindex.TableMenu;
s.addChild(l);
n._curTableMenu = l.getComponent(i.default);
n._curTableMenu.show(e);
} catch (e) {
C.default.error(e);
}
});
};
e.prototype.hideTableMenu = function() {
if (this._curTableMenu && this._curTableMenu.node && this._curTableMenu.node.isValid) {
this._curTableMenu.close();
this._curTableMenu = null;
}
};
e.prototype.showScoreWindow = function(e, t, n) {
var a = this;
this._curScoreWindow && this._curScoreWindow.node && this._curScoreWindow.node.isValid ? this._curScoreWindow.show(e, t, !1) : _.default.Instance.loadBundleRes(v.BundleUIPath.ScoreWindow, cc.Prefab, function(i, l) {
if (i) C.default.error(i); else try {
var s = cc.instantiate(l), c = n || cc.director.getScene().getChildByName(v.Layer.Canvas).getChildByName(v.Layer.TopLayer);
s.zIndex = o.PopZindex.BestDeclare;
c.addChild(s);
a._curScoreWindow = s.getComponent(r.default);
a._curScoreWindow.show(e, t);
} catch (e) {
C.default.error(e);
}
});
};
e.prototype.hideScoreWindow = function() {
if (this._curScoreWindow && this._curScoreWindow.node && this._curScoreWindow.node.isValid) {
this._curScoreWindow.close();
this._curScoreWindow = null;
}
};
e.prototype.showBestDeclare = function(e, t, n, a, i) {
var r = this;
_.default.Instance.loadBundleRes(v.BundleUIPath.BestDeclare, cc.Prefab, function(s, c) {
if (s) C.default.error(s); else try {
var u = cc.instantiate(c), d = i || cc.director.getScene().getChildByName(v.Layer.Canvas).getChildByName(v.Layer.TopLayer);
u.zIndex = o.PopZindex.BestDeclare;
d.addChild(u);
r._curBestDeclare = u.getComponent(l.default);
r._curBestDeclare.show(e, t, n, a);
} catch (e) {
C.default.error(e);
}
});
};
e.prototype.hideBestDeclare = function() {
if (this._curBestDeclare && this._curBestDeclare.node && this._curBestDeclare.node.isValid) {
this._curBestDeclare.close();
this._curBestDeclare = null;
}
};
e.prototype.showCardRecorder = function(e, t) {
var n = this;
_.default.Instance.loadBundleRes(v.BundleUIPath.CardRecorder, cc.Prefab, function(a, i) {
if (a) C.default.error(a); else try {
var r = cc.instantiate(i), l = t || cc.director.getScene().getChildByName(v.Layer.Canvas).getChildByName(v.Layer.TopLayer);
r.zIndex = o.PopZindex.TableMenu - 1;
l.addChild(r);
n._curCardRecorder = r.getComponent(s.default);
n._curCardRecorder.show(e);
} catch (e) {
C.default.error(e);
}
});
};
e.prototype.hideCardRecorder = function() {
if (this._curCardRecorder && this._curCardRecorder.node && this._curCardRecorder.node.isValid) {
this._curCardRecorder.close();
this._curCardRecorder = null;
}
};
e.prototype.showWaiting = function(e, t, o) {
var n = this, a = arguments.length >= 2 ? t : null, i = 3 === arguments.length ? o : 1, r = !1, l = "", s = null;
a && ("boolean" == typeof a ? r = a : "string" == typeof a ? l = a : s = a);
C.default.log("PopHelper showWaiting  delayTime:", e);
if (this._waiting && this._waiting.node && this._waiting.node.isValid || this._tcreating) r ? this._waiting.showMatching() : s ? this._waiting.showCardWaiting(e, s, i) : this._waiting.show(l, e); else {
this._tcreating = !0;
_.default.Instance.loadBundleRes(v.BundleUIPath.Waiting, cc.Prefab, function(t, o) {
n._tcreating = !1;
if (t) C.default.error(t); else try {
C.default.log("PopHelper showWaiting  instantiate delayTime:", e);
var a = cc.instantiate(o);
a.zIndex = 999;
var u = cc.director.getScene().getChildByName(v.Layer.Canvas).getChildByName(v.Layer.TopLayer);
if (u) {
u.addChild(a);
n._waiting = a.getComponent(c.default);
r ? n._waiting.showMatching() : s ? n._waiting.showCardWaiting(e, s, i) : n._waiting.show(l, e);
}
} catch (e) {
C.default.error(e);
}
});
}
};
e.prototype.hideWaiting = function(e) {
void 0 === e && (e = !1);
C.default.log("PopHelper hideWaiting 0 --");
if (this._waiting && this._waiting.node && this._waiting.node.isValid) if (e) this._waiting.hideCardWaiting(); else {
C.default.log("PopHelper hideWaiting 1");
this._waiting.hide();
this._waiting.hideMatching();
this._waiting.hideCardWaiting();
}
};
e.prototype.showScoreBoard = function(e, t, n) {
var a = this;
this._curScoreBoard && this._curScoreBoard.node && this._curScoreBoard.node.isValid ? this._curScoreBoard.show(e, t) : _.default.Instance.loadBundleRes(v.BundleUIPath.ScoreBoard, cc.Prefab, function(i, r) {
if (i) C.default.error(i); else {
var l = cc.instantiate(r), s = n || cc.director.getScene().getChildByName(v.Layer.Canvas).getChildByName(v.Layer.TopLayer);
l.zIndex = o.PopZindex.BestDeclare;
s.addChild(l);
a._curScoreBoard = l.getComponent(u.default);
a._curScoreBoard.show(e, t);
}
});
};
e.prototype.hideScoreBoard = function() {
if (this._curScoreBoard && this._curScoreBoard.node && this._curScoreBoard.node.isValid) {
this._curScoreBoard.close();
this._curScoreBoard = null;
}
};
e.prototype.showTotalResult = function(e, t, n, a, i) {
var r = this;
void 0 === t && (t = !1);
this._curTotalResult && this._curTotalResult.node && this._curTotalResult.node.isValid ? this._curTotalResult.show(e, t, n) : _.default.Instance.loadBundleRes(v.BundleUIPath.TotalResult, cc.Prefab, function(l, s) {
if (l) C.default.error(l); else try {
var c = cc.instantiate(s), u = i || cc.director.getScene().getChildByName(v.Layer.Canvas).getChildByName(v.Layer.TopLayer);
c.zIndex = o.PopZindex.BestDeclare;
u.addChild(c);
r._curTotalResult = c.getComponent(p.default);
r._curTotalResult.show(e, t, n, a);
} catch (e) {
C.default.error(e);
}
});
};
e.prototype.hideTotalResult = function() {
if (this._curTotalResult && this._curTotalResult.node && this._curTotalResult.node.isValid) {
this._curTotalResult.close();
this._curTotalResult = null;
}
};
e.prototype.showSplitPrize = function(e, t, n) {
var a = this;
this._curSplitPrize && this._curSplitPrize.node && this._curSplitPrize.node.isValid ? this._curSplitPrize.show(e, t) : _.default.Instance.loadBundleRes(v.BundleUIPath.SplitPrize, cc.Prefab, function(i, r) {
if (i) C.default.error(i); else try {
var l = cc.instantiate(r), s = n || cc.director.getScene().getChildByName(v.Layer.Canvas).getChildByName(v.Layer.TopLayer);
l.zIndex = o.PopZindex.BestDeclare;
s.addChild(l);
a._curSplitPrize = l.getComponent(d.default);
a._curSplitPrize.show(e, t);
} catch (e) {
C.default.error(e);
}
});
};
e.prototype.hideSplitPrize = function() {
if (this._curSplitPrize && this._curSplitPrize.node && this._curSplitPrize.node.isValid) {
this._curSplitPrize.close();
this._curSplitPrize = null;
}
};
e.prototype.showNumberEditBox = function(e) {
var t = this, n = e.getUserData();
this._curNumberEditBox && this._curNumberEditBox.node && this._curNumberEditBox.node.isValid ? this._curNumberEditBox.show(n) : _.default.Instance.loadBundleRes(v.BundleUIPath.NumericEditorBox, cc.Prefab, function(e, a) {
if (e) C.default.error(e); else try {
var i = cc.instantiate(a), r = cc.director.getScene().getChildByName(v.Layer.Canvas).getChildByName(v.Layer.TopLayer);
i.zIndex = o.PopZindex.NumberEditBox;
r.addChild(i);
t._curNumberEditBox = i.getComponent(h.default);
t._curNumberEditBox.show(n);
} catch (e) {
C.default.error(e);
}
});
};
e.prototype.showReward = function(e, t, n, a) {
void 0 === n && (n = null);
void 0 === a && (a = !1);
!e || e.length <= 0 || _.default.Instance.loadBundleRes(v.BundleUIPath.RewardView, cc.Prefab, function(i, r) {
if (i) C.default.error(i); else {
var l = cc.instantiate(r), s = n || cc.director.getScene().getChildByName(v.Layer.Canvas).getChildByName(v.Layer.TopLayer);
l.zIndex = o.PopZindex.Reward;
s.addChild(l);
var c = l.getComponent(f.default);
c && c.show(e, t, a);
}
});
};
e.prototype.addLotoFastMarquee = function(e) {
_.default.Instance.loadBundleRes(v.BundleUIPath.LotoFastMarquee, cc.Prefab, function(t, o) {
if (t) C.default.error(t); else if (e && e.isValid) {
var n = cc.instantiate(o);
e.addChild(n);
}
});
};
e.prototype.showNativNoPlay = function(e) {
void 0 === e && (e = null);
_.default.Instance.loadBundleRes(v.BundleUIPath.RewardView, cc.Prefab, function(t, n) {
if (t) C.default.error(t); else {
var a = cc.instantiate(n), i = e || cc.director.getScene().getChildByName(v.Layer.Canvas).getChildByName(v.Layer.TopLayer);
a.zIndex = o.PopZindex.Reward;
i.addChild(a);
}
});
};
e._Instance = null;
return e;
}();
o.PopHelper = b;
cc._RF.pop();
}, {
"../../../BundleGame/client/component/NumericEditorBox": "NumericEditorBox",
"../../../BundleGame/client/component/ScoreWindow": "ScoreWindow",
"../../../BundleGame/client/component/Waiting": "Waiting",
"../../../BundleGame/client/component/pop/Alert": "Alert",
"../../../BundleGame/client/component/pop/BestDeclare": "BestDeclare",
"../../../BundleGame/client/component/pop/CountDown": "CountDown",
"../../../BundleGame/client/component/pop/TableMenu": "TableMenu",
"../../../BundleGame/client/logic/ui/CardRecorder/CardRecorder": "CardRecorder",
"../../../BundleGame/client/logic/ui/RewardView/RewardView": "RewardView",
"../../../BundleGame/client/logic/ui/ScoreBoard/ScoreBoard": "ScoreBoard",
"../../../BundleGame/client/logic/ui/SplitPrize/SplitPrize": "SplitPrize",
"../../../BundleGame/client/logic/ui/TotalResult/TotalResult": "TotalResult",
"../../Game/client/component/pop/Tips": "Tips",
"../../Game/client/global/enum/game/Const": "Const",
"../../Game/client/global/enum/game/Event": "Event",
"../../Game/fromework/global/ResLoader": "ResLoader",
"../../Game/fromework/helper/EventHelper": "EventHelper",
"../../platform/Platform": "Platform"
} ],
PureSequence: [ function(e, t, o) {
"use strict";
cc._RF.push(t, "90fa5y2i3FJqKvrieWAtKXL", "PureSequence");
Object.defineProperty(o, "__esModule", {
value: !0
});
var n = e("../../../../../Game/fromework/global/Tools"), a = e("../GameHelper"), i = e("./CheckTools"), r = function() {
function e() {}
e.getAllPS = function(e) {
var t = this, o = [];
e.forEach(function(e) {
t._getPureSequence(e).forEach(function(e) {
o.push(e);
});
});
return o;
};
e.getOnePS = function(e) {
for (var t = [], o = 0; o < e.length; o++) {
var a = e[o], i = this._getPureSequence(a);
if (i.length > 0) {
t = n.Tools.TArray.deepCopy(i[0]);
break;
}
}
return t;
};
e.getMaxOnePs = function(t) {
var o = [];
e.getAllPS(t).forEach(function(e) {
var t = i.default.getRealScore(o), a = i.default.getRealScore(e);
a > t ? o = n.Tools.TArray.deepCopy(e) : a == t && i.default.getRealPoints(e) > i.default.getRealPoints(o) && (o = n.Tools.TArray.deepCopy(e));
});
return o;
};
e.linkAddPS = function(e, t) {
e.forEach(function(e) {
for (var o = 0; o < t.length; o++) if (a.GroupHelper.getPattern(t[o][0]) == a.GroupHelper.getPattern(e[0])) {
for (var n = t[o], i = 0; i < n.length; i++) {
var r = n[i];
if (e[0] - r == 1) {
e.unshift(r);
n.splice(i, 1);
} else if (r - e[e.length - 1] == 1 && 1 != a.GroupHelper.getFigure(e[e.length - 1])) {
e.push(r);
n.splice(i, 1);
} else if (r % 16 == 1 && e[e.length - 1] % 16 == 13) {
e.push(r);
n.splice(i, 1);
}
}
break;
}
});
};
e.upwardChangePS = function(e, t) {
e.forEach(function(e) {
for (var o = 0; o < t.length; o++) if (a.GroupHelper.getPattern(t[o][0]) == a.GroupHelper.getPattern(e[0])) {
for (var n = t[o], i = 0; i < n.length; i++) {
var r = n[i];
if (r - e[e.length - 1] == 1 && 1 != a.GroupHelper.getFigure(e[e.length - 1])) {
e.push(r);
e.shift();
n.splice(i, 1);
break;
}
}
break;
}
});
};
e.downwardChangePS = function(e, t) {
e.forEach(function(e) {
for (var o = 0; o < t.length; o++) if (a.GroupHelper.getPattern(t[o][0]) == a.GroupHelper.getPattern(e[0])) {
for (var n = t[o], i = 0; i < n.length; i++) {
var r = n[i];
if (e[0] - r == 1) {
e.unshift(r);
e.pop();
n.splice(i, 1);
break;
}
}
break;
}
});
};
e._getPureSequence = function(e) {
var t = [], o = [], a = i.default.checkoutSame(e, t, o), r = this.__getPureSequence(t);
if (a) {
var l = this.__getPureSequence(o);
l.length > 0 && (r = r.concat(l));
if (r.length > 0) {
var s = n.Tools.TArray.duplicate(e, n.Tools.TArray.flatten(r)), c = this.__getPureSequence(s);
c.length > 0 && (r = r.concat(c));
}
}
return r;
};
e.__getPureSequence = function(e) {
var t = [];
if (e.length < 3) return [];
var o = i.default.hasQKA(e);
o.length > 0 && t.push(o);
for (var a = n.Tools.TArray.duplicate(e, o), r = 0, l = 1, s = 1; l < a.length; ) {
a[l] - a[r] == 1 ? s++ : s = 1;
if (s >= 3) {
t.push([ a[r - 1], a[r], a[l] ]);
s = 1;
l++;
}
r = l;
l++;
}
return t;
};
return e;
}();
o.default = r;
cc._RF.pop();
}, {
"../../../../../Game/fromework/global/Tools": "Tools",
"../GameHelper": "GameHelper",
"./CheckTools": "CheckTools"
} ],
RBDealer: [ function(e, t, o) {
"use strict";
cc._RF.push(t, "06b9fhpDXBKRZ8V+3+6i79r", "RBDealer");
var n, a = this && this.__extends || (n = function(e, t) {
return (n = Object.setPrototypeOf || {
__proto__: []
} instanceof Array && function(e, t) {
e.__proto__ = t;
} || function(e, t) {
for (var o in t) Object.prototype.hasOwnProperty.call(t, o) && (e[o] = t[o]);
})(e, t);
}, function(e, t) {
n(e, t);
function o() {
this.constructor = e;
}
e.prototype = null === t ? Object.create(t) : (o.prototype = t.prototype, new o());
}), i = this && this.__decorate || function(e, t, o, n) {
var a, i = arguments.length, r = i < 3 ? t : null === n ? n = Object.getOwnPropertyDescriptor(t, o) : n;
if ("object" == typeof Reflect && "function" == typeof Reflect.decorate) r = Reflect.decorate(e, t, o, n); else for (var l = e.length - 1; l >= 0; l--) (a = e[l]) && (r = (i < 3 ? a(r) : i > 3 ? a(t, o, r) : a(t, o)) || r);
return i > 3 && r && Object.defineProperty(t, o, r), r;
};
Object.defineProperty(o, "__esModule", {
value: !0
});
var r = e("../../../Game/client/global/enum/game/Const"), l = e("../../../Game/client/global/enum/game/Event"), s = e("../../../Game/fromework/global/ResLoader"), c = e("../../../Game/fromework/helper/AudioHelper"), u = e("../../../Game/fromework/helper/EventHelper"), d = e("../../../platform/Platform"), p = e("../../Common/Component/CompositeCard"), h = e("../../Common/Utils/CompositeEvent"), f = e("../../Common/Utils/CompositeUtil"), _ = cc._decorator, m = _.ccclass, y = _.property, g = function(e) {
a(t, e);
function t() {
var t = null !== e && e.apply(this, arguments) || this;
t.Dealer = null;
t.OpenSlot = null;
t.CardParent = null;
t.DragonBonus = null;
t._openCard = null;
return t;
}
t.prototype.onEnable = function() {
u.default.Instance.Global.bind(h.CompositeGameEvent.GAME_RECONNECT, this.onReconnect, this);
u.default.Instance.Global.bind(l.GameEvent.S2C_AB_DEAL, this.onDealerCard, this);
u.default.Instance.Global.bind(l.GameEvent.S2C_AB_SHOW, this.onShowCard, this);
u.default.Instance.Global.bind(l.GameEvent.S2C_RESET, this.onReset, this);
};
t.prototype.onDisable = function() {
u.default.Instance.Global.unbind(h.CompositeGameEvent.GAME_RECONNECT, this.onReconnect, this);
u.default.Instance.Global.unbind(l.GameEvent.S2C_AB_DEAL, this.onDealerCard, this);
u.default.Instance.Global.unbind(l.GameEvent.S2C_AB_SHOW, this.onShowCard, this);
u.default.Instance.Global.unbind(l.GameEvent.S2C_RESET, this.onReset, this);
};
t.prototype.onLoad = function() {
cc.game.on(cc.game.EVENT_SHOW, this._onReset, this);
};
t.prototype.onDestroy = function() {
cc.game.off(cc.game.EVENT_SHOW, this._onReset, this);
};
t.prototype._onReset = function() {
this.CardParent.destroyAllChildren();
this._openCard = null;
};
t.prototype.createCard = function(e, t) {
var o = this;
this.CardParent.destroyAllChildren();
this._openCard = null;
s.default.Instance.loadBundleRes(r.BundleUIPath.CompositeCard, cc.Prefab, function(n, a) {
if (n) d.default.log("ABDealer Can Not Load CompositeCard!"); else {
var i = cc.instantiate(a);
i.scale = .56;
i.active = !0;
i.parent = o.CardParent;
i.setPosition(t);
o._openCard = i.getComponent(p.default);
o._openCard.init(0, !1);
e && e();
}
});
};
t.prototype.onReconnect = function() {
var e = this, t = f.default.Game.Model;
this._onReset();
if (2 == t.roomData.state) this.createCard(function() {
e._openCard.init(0, !1);
}, this.OpenSlot.getPosition()); else if (3 == t.roomData.state) {
this.createCard(function() {
e._openCard.init(t.show_card[0], !0);
}, this.OpenSlot.getPosition());
u.default.Instance.Global.emit(h.OddsEvent.ODDS_RECYCLING);
}
};
t.prototype.onDealerCard = function() {
var e = this, t = this.Dealer.getPosition();
this.createCard(function() {
e._openCard.moveCard(.5, e.OpenSlot.getPosition(), e._openCard.node.scale, e._openCard.node.scale, function() {
u.default.Instance.Global.emit(h.CompositeUIEvent.UI_PLAY_START_BET);
}, !0);
c.default.Instance.playBundleEffect(r.BundleSoundPath.common_draw);
}, t);
};
t.prototype.onShowCard = function() {
var e = this, t = f.default.Game.Model, o = function() {
var o = t.show_card[0];
if (null != o) {
e._openCard.init(o, !1);
e._openCard.flipCard(.5, cc.v3(0, -180, 0), !1, function() {
e._openCard.showLightBorder(!0);
cc.tween(e.node).delay(.4).call(function() {
u.default.Instance.Global.emit(h.OddsEvent.ODDS_SHOW_WIN);
}).delay(2).call(function() {
u.default.Instance.Global.emit(h.OddsEvent.ODDS_RECYCLING);
}).start();
});
c.default.Instance.playBundleEffect(r.BundleSoundPath.common_discard);
} else d.default.log("RedBlack can not find show card!");
};
this._openCard && this._openCard.node && this._openCard.node.isValid ? o() : this.createCard(o.bind(this), this.OpenSlot.getPosition());
};
t.prototype.onReset = function() {
var e = this, t = f.default.Game.Model, o = function() {
var o = t.show_card[0];
if (null != o) {
e._openCard.init(o, !0);
e._openCard.showLightBorder(!1);
e._openCard.flipCard(.3, cc.v3(0, -180, 0), !0, function() {
var t = e.Dealer.getPosition();
e._openCard.moveCard(.3, cc.v2(t.x, t.y + 4), e._openCard.node.scale, e._openCard.node.scale, function() {
e._onReset();
e.Dealer.active = !1;
e.DragonBonus.node.active = !0;
e.DragonBonus.armatureName = "Armature";
e.DragonBonus.once(dragonBones.EventObject.COMPLETE, function() {
e.Dealer.active = !0;
e.DragonBonus.node.active = !1;
}, e);
e.DragonBonus.playAnimation("card", 1);
c.default.Instance.playBundleEffect(r.BundleSoundPath.common_shuffle_cards);
}, !0);
c.default.Instance.playBundleEffect(r.BundleSoundPath.common_draw);
});
c.default.Instance.playBundleEffect(r.BundleSoundPath.common_discard);
} else d.default.log("RedBlack can not find show card!");
};
this._openCard && this._openCard.node && this._openCard.node.isValid ? o() : this.createCard(o.bind(this), this.OpenSlot.getPosition());
};
i([ y(cc.Node) ], t.prototype, "Dealer", void 0);
i([ y(cc.Node) ], t.prototype, "OpenSlot", void 0);
i([ y(cc.Node) ], t.prototype, "CardParent", void 0);
i([ y(dragonBones.ArmatureDisplay) ], t.prototype, "DragonBonus", void 0);
return i([ m ], t);
}(cc.Component);
o.default = g;
cc._RF.pop();
}, {
"../../../Game/client/global/enum/game/Const": "Const",
"../../../Game/client/global/enum/game/Event": "Event",
"../../../Game/fromework/global/ResLoader": "ResLoader",
"../../../Game/fromework/helper/AudioHelper": "AudioHelper",
"../../../Game/fromework/helper/EventHelper": "EventHelper",
"../../../platform/Platform": "Platform",
"../../Common/Component/CompositeCard": "CompositeCard",
"../../Common/Utils/CompositeEvent": "CompositeEvent",
"../../Common/Utils/CompositeUtil": "CompositeUtil"
} ],
RBFastCensus: [ function(e, t, o) {
"use strict";
cc._RF.push(t, "f2930aj/qtE0q9BUTdq/LL5", "RBFastCensus");
var n, a = this && this.__extends || (n = function(e, t) {
return (n = Object.setPrototypeOf || {
__proto__: []
} instanceof Array && function(e, t) {
e.__proto__ = t;
} || function(e, t) {
for (var o in t) Object.prototype.hasOwnProperty.call(t, o) && (e[o] = t[o]);
})(e, t);
}, function(e, t) {
n(e, t);
function o() {
this.constructor = e;
}
e.prototype = null === t ? Object.create(t) : (o.prototype = t.prototype, new o());
}), i = this && this.__decorate || function(e, t, o, n) {
var a, i = arguments.length, r = i < 3 ? t : null === n ? n = Object.getOwnPropertyDescriptor(t, o) : n;
if ("object" == typeof Reflect && "function" == typeof Reflect.decorate) r = Reflect.decorate(e, t, o, n); else for (var l = e.length - 1; l >= 0; l--) (a = e[l]) && (r = (i < 3 ? a(r) : i > 3 ? a(t, o, r) : a(t, o)) || r);
return i > 3 && r && Object.defineProperty(t, o, r), r;
};
Object.defineProperty(o, "__esModule", {
value: !0
});
var r = e("../../../Game/fromework/global/Tools"), l = e("../../../Game/fromework/helper/EventHelper"), s = e("./RBFastEvent"), c = e("./RBFastModel"), u = cc._decorator, d = u.ccclass, p = u.property, h = function(e) {
a(t, e);
function t() {
var t = null !== e && e.apply(this, arguments) || this;
t.Title = null;
t.Spade = null;
t.Heart = null;
t.Club = null;
t.Diamond = null;
t.Joker = null;
t.Black = null;
t.Red = null;
return t;
}
t.prototype.onEnable = function() {
l.default.Instance.Global.bind(s.RBFastEvent.S2C_ENTER_ROOM_FAST, this.refreshCensus, this);
l.default.Instance.Global.bind(s.RBFastEvent.S2C_RESET_FAST, this.refreshCensus, this);
};
t.prototype.onDisable = function() {
l.default.Instance.Global.unbind(s.RBFastEvent.S2C_ENTER_ROOM_FAST, this.refreshCensus, this);
l.default.Instance.Global.unbind(s.RBFastEvent.S2C_RESET_FAST, this.refreshCensus, this);
};
t.prototype.onLoad = function() {
this.refreshCensus();
};
t.prototype.refreshCensus = function() {
var e = c.RBFastModel.Instance.declearHistory.getWinCount();
this.Title.string = r.Tools.TStr.replaceAll("ALL:%{num}", "%{num}", e.total);
this.Red.string = e.red + "";
this.Black.string = e.black + "";
this.Heart.string = e.heart + "";
this.Club.string = e.club + "";
this.Diamond.string = e.diamond + "";
this.Spade.string = e.spade + "";
this.Joker.string = e.joker + "";
};
i([ p(cc.Label) ], t.prototype, "Title", void 0);
i([ p(cc.Label) ], t.prototype, "Spade", void 0);
i([ p(cc.Label) ], t.prototype, "Heart", void 0);
i([ p(cc.Label) ], t.prototype, "Club", void 0);
i([ p(cc.Label) ], t.prototype, "Diamond", void 0);
i([ p(cc.Label) ], t.prototype, "Joker", void 0);
i([ p(cc.Label) ], t.prototype, "Black", void 0);
i([ p(cc.Label) ], t.prototype, "Red", void 0);
return i([ d ], t);
}(cc.Component);
o.default = h;
cc._RF.pop();
}, {
"../../../Game/fromework/global/Tools": "Tools",
"../../../Game/fromework/helper/EventHelper": "EventHelper",
"./RBFastEvent": "RBFastEvent",
"./RBFastModel": "RBFastModel"
} ],
RBFastDealer: [ function(e, t, o) {
"use strict";
cc._RF.push(t, "1fe1dWP/lpCEJ8qGayv7Zkz", "RBFastDealer");
var n, a = this && this.__extends || (n = function(e, t) {
return (n = Object.setPrototypeOf || {
__proto__: []
} instanceof Array && function(e, t) {
e.__proto__ = t;
} || function(e, t) {
for (var o in t) Object.prototype.hasOwnProperty.call(t, o) && (e[o] = t[o]);
})(e, t);
}, function(e, t) {
n(e, t);
function o() {
this.constructor = e;
}
e.prototype = null === t ? Object.create(t) : (o.prototype = t.prototype, new o());
}), i = this && this.__decorate || function(e, t, o, n) {
var a, i = arguments.length, r = i < 3 ? t : null === n ? n = Object.getOwnPropertyDescriptor(t, o) : n;
if ("object" == typeof Reflect && "function" == typeof Reflect.decorate) r = Reflect.decorate(e, t, o, n); else for (var l = e.length - 1; l >= 0; l--) (a = e[l]) && (r = (i < 3 ? a(r) : i > 3 ? a(t, o, r) : a(t, o)) || r);
return i > 3 && r && Object.defineProperty(t, o, r), r;
};
Object.defineProperty(o, "__esModule", {
value: !0
});
var r = e("../../../Game/client/global/enum/game/Const"), l = e("../../../Game/fromework/global/ResLoader"), s = e("../../../Game/fromework/helper/EventHelper"), c = e("../../../platform/Platform"), u = e("../../Common/Component/CompositeCard"), d = e("./RBFastEvent"), p = e("./RBFastModel"), h = cc._decorator, f = h.ccclass, _ = h.property, m = function(e) {
a(t, e);
function t() {
var t = null !== e && e.apply(this, arguments) || this;
t.CardParent = null;
t.CountDown = null;
t.Time = null;
t.TimeBoder = null;
t._card = null;
return t;
}
t.prototype.onEnable = function() {
s.default.Instance.Global.bind(d.RBFastGameEvent.GAME_RECONNECT, this.onReconnect, this);
s.default.Instance.Global.bind(d.RBFastUIEvent.UI_EFFECT_START_BET, this.onStartBet, this);
s.default.Instance.Global.bind(d.RBFastUIEvent.UI_EFFECT_STOP_BET, this.onStopBet, this);
s.default.Instance.Global.bind(d.RBFastEvent.S2C_DEAL_FAST, this.onDeal, this);
s.default.Instance.Global.bind(d.RBFastEvent.S2C_SHOW_FAST, this.onShow, this);
s.default.Instance.Global.bind(d.RBFastEvent.S2C_RESET_FAST, this.onReset, this);
};
t.prototype.onDisable = function() {
s.default.Instance.Global.unbind(d.RBFastGameEvent.GAME_RECONNECT, this.onReconnect, this);
s.default.Instance.Global.unbind(d.RBFastUIEvent.UI_EFFECT_START_BET, this.onStartBet, this);
s.default.Instance.Global.unbind(d.RBFastUIEvent.UI_EFFECT_STOP_BET, this.onStopBet, this);
s.default.Instance.Global.unbind(d.RBFastEvent.S2C_DEAL_FAST, this.onDeal, this);
s.default.Instance.Global.unbind(d.RBFastEvent.S2C_SHOW_FAST, this.onShow, this);
s.default.Instance.Global.unbind(d.RBFastEvent.S2C_RESET_FAST, this.onReset, this);
};
t.prototype.onLoad = function() {
this.createCard(null);
this.CountDown.active = !1;
};
t.prototype.destroyCard = function() {
this.CardParent.destroyAllChildren();
this._card = null;
};
t.prototype.createCard = function(e) {
var t = this;
this.destroyCard();
l.default.Instance.loadBundleRes(r.BundleUIPath.CompositeCard, cc.Prefab, function(o, n) {
if (o) c.default.log("RBFastDealer Can Not Load CompositeCard!"); else {
var a = cc.instantiate(n);
a.scale = 1;
a.active = !0;
a.parent = t.CardParent;
a.setPosition(cc.Vec2.ZERO);
t._card = a.getComponent(u.default);
t._card.init(0, !1);
e && e();
}
});
};
t.prototype.onReconnect = function() {
var e = this, t = p.RBFastModel.Instance;
this.createCard(function() {
if (2 == t.roomData.state) {
e._card.init(0, !1);
e.onStartBet();
} else 3 == t.roomData.state && e._card.init(t.show_card[0], !0);
});
};
t.prototype.onStartBet = function() {
var e = this, t = p.RBFastModel.Instance, o = this.TimeBoder.getComponent(cc.Sprite);
cc.director.getActionManager().removeAllActionsFromTarget(o, !0);
var n = t.getCountDown();
this.CountDown.active = !0;
this.Time.string = n + "";
o.fillRange = n * (1 / 30);
var a = cc.tween().call(function() {
--n < 0 && (n = 0);
e.Time && e.Time.isValid && (e.Time.string = n + 1 + "");
}.bind(this)).by(1, {
fillRange: -1 / 30
}), i = cc.tween().repeat(n, a).call(function() {
e.Time.string = "0";
}.bind(this));
cc.tween(o).then(i).start();
};
t.prototype.onStopBet = function() {};
t.prototype.onDeal = function() {
var e = this;
this.createCard(function() {
e._card.init(0, !1);
});
};
t.prototype.onShow = function() {
var e = this, t = p.RBFastModel.Instance;
this.createCard(function() {
e.CountDown.active = !1;
e._card.init(t.show_card[0], !1);
e._card.flipCard(.5, cc.v3(0, -180, 0), !1, function() {});
});
};
t.prototype.onReset = function() {};
i([ _(cc.Node) ], t.prototype, "CardParent", void 0);
i([ _(cc.Node) ], t.prototype, "CountDown", void 0);
i([ _(cc.Label) ], t.prototype, "Time", void 0);
i([ _(cc.Node) ], t.prototype, "TimeBoder", void 0);
return i([ f ], t);
}(cc.Component);
o.default = m;
cc._RF.pop();
}, {
"../../../Game/client/global/enum/game/Const": "Const",
"../../../Game/fromework/global/ResLoader": "ResLoader",
"../../../Game/fromework/helper/EventHelper": "EventHelper",
"../../../platform/Platform": "Platform",
"../../Common/Component/CompositeCard": "CompositeCard",
"./RBFastEvent": "RBFastEvent",
"./RBFastModel": "RBFastModel"
} ],
RBFastEvent: [ function(e, t, o) {
"use strict";
cc._RF.push(t, "2a604yxyPhCVbNMa64Y5q3o", "RBFastEvent");
Object.defineProperty(o, "__esModule", {
value: !0
});
o.RBFastOddsEvent = o.RBFastGameEvent = o.RBFastUIEvent = o.RBFastEvent = void 0;
o.RBFastEvent = {
S2C_ENTER_ROOM_FAST: "S2C_ENTER_ROOM_FAST",
S2C_SWITCH_ROOM_FAST: "S2C_SWITCH_ROOM_FAST",
S2C_RESET_FAST: "S2C_RESET_FAST",
S2C_LEAVE_FAST: "S2C_LEAVE_FAST",
S2C_LEAVE_SINGLE_FAST: "S2C_LEAVE_SINGLE_FAST",
S2C_DISMISS_ROOM_FAST: "S2C_DISMISS_ROOM_FAST",
S2C_INTERACT_FAST: "S2C_INTERACT_FAST",
S2C_DEAL_FAST: "S2C_DEAL_FAST",
S2C_BET_FAST: "S2C_BET_FAST",
S2C_BET_BATCH_FAST: "S2C_BET_BATCH_FAST",
S2C_SHOW_FAST: "S2C_SHOW_FAST",
S2C_RANK_FAST: "S2C_RANK_FAST",
S2C_AUTO_PLAY_FAST: "S2C_AUTO_PLAY_FAST",
S2C_REPEAT_BET_FAST: "S2C_REPEAT_BET_FAST",
S2C_USER_RECORD_FAST: "S2C_USER_RECORD_FAST",
S2C_WINNER_RECORD_FAST: "S2C_WINNER_RECORD_FAST",
TABLE_REFRESH_TABLE_FAST: "TABLE_REFRESH_TABLE_FAST",
TABLE_REPEAT_BET_ERROR: "TABLE_REPEAT_BET_ERROR"
};
o.RBFastUIEvent = {
UI_EFFECT_START_BET: "UI_EFFECT_START_BET_FAST",
UI_EFFECT_STOP_BET: "UI_EFFECT_STOP_BET_FAST",
UI_INIT_ODDS_AMOUNT: "UI_INIT_ODDS_AMOUNT"
};
o.RBFastGameEvent = {
GAME_RECONNECT: "GAME_RECONNECT_FAST"
};
o.RBFastOddsEvent = {
ODDS_BET_CHANGED_ALL: "ODDS_BET_CHANGED_ALL_FAST",
ODDS_BET_CHANGED_SELF: "ODDS_BET_CHANGED_SELF_FAST",
ODDS_BET_BUTTON_CLICK: "ODDS_BET_BUTTON_CLICK_FAST"
};
cc._RF.pop();
}, {} ],
RBFastHelp: [ function(e, t, o) {
"use strict";
cc._RF.push(t, "88b94SbDLRNBI5lTX6fSzbk", "RBFastHelp");
var n, a = this && this.__extends || (n = function(e, t) {
return (n = Object.setPrototypeOf || {
__proto__: []
} instanceof Array && function(e, t) {
e.__proto__ = t;
} || function(e, t) {
for (var o in t) Object.prototype.hasOwnProperty.call(t, o) && (e[o] = t[o]);
})(e, t);
}, function(e, t) {
n(e, t);
function o() {
this.constructor = e;
}
e.prototype = null === t ? Object.create(t) : (o.prototype = t.prototype, new o());
}), i = this && this.__decorate || function(e, t, o, n) {
var a, i = arguments.length, r = i < 3 ? t : null === n ? n = Object.getOwnPropertyDescriptor(t, o) : n;
if ("object" == typeof Reflect && "function" == typeof Reflect.decorate) r = Reflect.decorate(e, t, o, n); else for (var l = e.length - 1; l >= 0; l--) (a = e[l]) && (r = (i < 3 ? a(r) : i > 3 ? a(t, o, r) : a(t, o)) || r);
return i > 3 && r && Object.defineProperty(t, o, r), r;
};
Object.defineProperty(o, "__esModule", {
value: !0
});
var r = e("../../../Game/client/model/LanguageModel"), l = e("../../../Game/fromework/global/Tools"), s = e("./RBFastModel"), c = cc._decorator, u = c.ccclass, d = c.property, p = function(e) {
a(t, e);
function t() {
var t = null !== e && e.apply(this, arguments) || this;
t.RateHelpLabel = null;
return t;
}
t.prototype.onLoad = function() {
var e = s.RBFastModel.Instance;
this.RateHelpLabel.string = l.Tools.TStr.replaceString(r.default.getString("RBFAST_HRLP_RATE"), {
rate1: e.bet_options[0].x,
rate2: e.bet_options[4].x,
rate3: e.bet_options[5].x
});
};
i([ d(cc.Label) ], t.prototype, "RateHelpLabel", void 0);
return i([ u ], t);
}(cc.Component);
o.default = p;
cc._RF.pop();
}, {
"../../../Game/client/model/LanguageModel": "LanguageModel",
"../../../Game/fromework/global/Tools": "Tools",
"./RBFastModel": "RBFastModel"
} ],
RBFastManager: [ function(e, t, o) {
"use strict";
cc._RF.push(t, "5654fnTh1pBD4Irb7rCGCFQ", "RBFastManager");
var n, a = this && this.__extends || (n = function(e, t) {
return (n = Object.setPrototypeOf || {
__proto__: []
} instanceof Array && function(e, t) {
e.__proto__ = t;
} || function(e, t) {
for (var o in t) Object.prototype.hasOwnProperty.call(t, o) && (e[o] = t[o]);
})(e, t);
}, function(e, t) {
n(e, t);
function o() {
this.constructor = e;
}
e.prototype = null === t ? Object.create(t) : (o.prototype = t.prototype, new o());
}), i = this && this.__decorate || function(e, t, o, n) {
var a, i = arguments.length, r = i < 3 ? t : null === n ? n = Object.getOwnPropertyDescriptor(t, o) : n;
if ("object" == typeof Reflect && "function" == typeof Reflect.decorate) r = Reflect.decorate(e, t, o, n); else for (var l = e.length - 1; l >= 0; l--) (a = e[l]) && (r = (i < 3 ? a(r) : i > 3 ? a(t, o, r) : a(t, o)) || r);
return i > 3 && r && Object.defineProperty(t, o, r), r;
};
Object.defineProperty(o, "__esModule", {
value: !0
});
var r = e("../../../Game/client/global/enum/game/Event"), l = e("../../../Game/client/global/enum/game/Game"), s = e("../../../client/global/PopHelper"), c = e("../../../fromework/component/ButtonBlock"), u = e("../../../Game/fromework/helper/EventHelper"), d = e("../../../Game/fromework/helper/UIHelper"), p = e("../../../Game/Script/global/GlobalValue"), h = e("./RBFastEvent"), f = e("./RBFastModel"), _ = e("../../../client/model/LobbyModel"), m = e("../../../Game/client/global/enum/game/Const"), y = e("../../../platform/Platform"), g = cc._decorator, v = g.ccclass, C = g.property, b = function(e) {
a(t, e);
function t() {
var t = null !== e && e.apply(this, arguments) || this;
t.Bones = null;
t._anamationName = "";
return t;
}
t.prototype.onEnable = function() {
u.default.Instance.Global.bind(r.GameUIEvent.REFRESH_CASH, this.onRefreshCash, this);
u.default.Instance.Global.bind(r.LobbyEvent.LOBBY_JOIN, this.onJoin, this);
u.default.Instance.Global.bind(h.RBFastEvent.S2C_ENTER_ROOM_FAST, this.refreshEffect, this);
u.default.Instance.Global.bind(h.RBFastEvent.S2C_BET_FAST, this.refreshEffect, this);
u.default.Instance.Global.bind(h.RBFastEvent.S2C_RESET_FAST, this.refreshEffect, this);
u.default.Instance.Global.bind(h.RBFastEvent.S2C_DISMISS_ROOM_FAST, this.refreshEffect, this);
u.default.Instance.Global.bind(h.RBFastEvent.S2C_AUTO_PLAY_FAST, this.refreshEffect, this);
};
t.prototype.onDisable = function() {
u.default.Instance.Global.unbind(r.GameUIEvent.REFRESH_CASH, this.onRefreshCash, this);
u.default.Instance.Global.unbind(r.LobbyEvent.LOBBY_JOIN, this.onJoin, this);
u.default.Instance.Global.unbind(h.RBFastEvent.S2C_ENTER_ROOM_FAST, this.refreshEffect, this);
u.default.Instance.Global.unbind(h.RBFastEvent.S2C_BET_FAST, this.refreshEffect, this);
u.default.Instance.Global.unbind(h.RBFastEvent.S2C_RESET_FAST, this.refreshEffect, this);
u.default.Instance.Global.unbind(h.RBFastEvent.S2C_DISMISS_ROOM_FAST, this.refreshEffect, this);
u.default.Instance.Global.unbind(h.RBFastEvent.S2C_AUTO_PLAY_FAST, this.refreshEffect, this);
};
t.prototype.onLoad = function() {
this.onRefreshCash();
};
t.prototype.onRefreshCash = function() {
var e = this.node.getChildByName("Button"), t = p.default.getInstance().isCashGame, o = _.default.Instance.getPlaySwitch(l.GameEnum.PlayType.GAME_RB_FAST), n = null != o && (2 == o.s || 3 == o.s);
if (t && n) {
this.Bones && (this.Bones.node.active = !0);
this.refreshEffect();
e.getComponent(cc.Button).interactable = !0;
e && e.isValid && (e.addComponent(c.default).BlockTime = 1);
} else {
this.Bones && (this.Bones.node.active = !1);
e.getComponent(cc.Button).interactable = !1;
}
};
t.prototype.refreshEffect = function() {
if (this.Bones) {
var e = f.RBFastModel.Instance, t = null != e.userData && e.userData.auto ? "red_black_window_auto" : "red_black_window";
if (this._anamationName != t) {
this._anamationName = t;
this.Bones.armatureName = "Armature";
this.Bones.playAnimation(this._anamationName, 0);
}
}
};
t.prototype.onJoin = function(e) {
e.getUserData().play.cls == l.GameEnum.PlayType.GAME_RB_FAST && d.default.Instance.addBundleMaskLayer(m.BundleUIPath.RBFast, null, s.PopZindex.RBFast);
};
t.prototype.onRBFastClicked = function() {
var e = _.default.Instance.getGamePlayByCls(l.GameEnum.PlayType.GAME_RB_FAST);
if (e && e[0]) {
f.default.Instance.isOpenWindow = !0;
_.default.Instance.sendJoinRoom(e[0].rtype);
} else y.default.log("Can not find play:" + l.GameEnum.PlayType.GAME_RB_FAST);
};
i([ C(dragonBones.ArmatureDisplay) ], t.prototype, "Bones", void 0);
return i([ v ], t);
}(cc.Component);
o.default = b;
cc._RF.pop();
}, {
"../../../Game/Script/global/GlobalValue": "GlobalValue",
"../../../Game/client/global/enum/game/Const": "Const",
"../../../Game/client/global/enum/game/Event": "Event",
"../../../Game/client/global/enum/game/Game": "Game",
"../../../Game/fromework/helper/EventHelper": "EventHelper",
"../../../Game/fromework/helper/UIHelper": "UIHelper",
"../../../client/global/PopHelper": "PopHelper",
"../../../client/model/LobbyModel": "LobbyModel",
"../../../fromework/component/ButtonBlock": "ButtonBlock",
"../../../platform/Platform": "Platform",
"./RBFastEvent": "RBFastEvent",
"./RBFastModel": "RBFastModel"
} ],
RBFastModel: [ function(e, t, o) {
"use strict";
cc._RF.push(t, "8c41dKOrw9JHKUzmaDIRlho", "RBFastModel");
Object.defineProperty(o, "__esModule", {
value: !0
});
o.RBFastModel = void 0;
var n = e("../../../Game/client/global/enum/game/Event"), a = e("../../../Game/client/global/enum/game/Game"), i = e("../../../Game/client/global/enum/net/C2S"), r = e("../../../Game/client/global/enum/net/S2C"), l = e("../../../client/logic/game/HearBeat"), s = e("../../../client/model/ErrorModel"), c = e("../../../client/model/WalletModel"), u = e("../../../Game/fromework/global/Tools"), d = e("../../../Game/fromework/helper/EventHelper"), p = e("../../../fromework/helper/NetHelper"), h = e("../../../Game/fromework/mvvm/modelView/ViewModel"), f = e("../../Common/Utils/CompositeConst"), _ = e("./RBFastEvent"), m = e("./RBFastStruct"), y = e("../../../platform/Platform"), g = function() {
function e() {
this.sTime = 0;
this.total_fee = 0;
this.roomData = new m.RBFastStruct.RoomData();
this.userData = null;
this.declearData = new m.RBFastStruct.DeclearData();
this.playerBetRecord = [];
this.roomBetRecord = [];
this.deal_card = [];
this.show_card = [];
this.win_options = [];
this.bet_limit = 0;
this.declearHistory = new m.RBFastStruct.DeclearHistory();
this.bet_fee_currency = [];
this.bet_options = [];
this.user_record = [];
this.big_winner_record = [];
}
Object.defineProperty(e, "Instance", {
get: function() {
e._instance || (e._instance = new e());
return e._instance;
},
enumerable: !1,
configurable: !0
});
e.prototype.clear = function() {
null != e._instance && (e._instance = null);
};
e.prototype.getCountDown = function() {
y.default.log("get count down:", this.roomData.dl, this.sTime);
return Math.ceil(this.roomData.dl - this.sTime);
};
e.prototype.getBetAmount = function() {
var e = 0;
this.playerBetRecord.forEach(function(t) {
e += t.amount;
});
return e;
};
e.prototype.refreshUserData = function(e) {
this.userData = new m.RBFastStruct.UserData(e);
this.refreshPlayerRecord(e.bet_record);
this.total_fee = u.Tools.TNumber.num2single(e.total_fee);
};
e.prototype.refreshRoomRecord = function(e) {
this.roomBetRecord.splice(0);
this.roomBetRecord = m.RBFastStruct.getBetRecordArray(e);
for (var t = 0; t < this.roomBetRecord.length; t++) d.default.Instance.Global.emit(_.RBFastOddsEvent.ODDS_BET_CHANGED_ALL, {
index: t,
self: null,
all: this.roomBetRecord[t].amount
});
};
e.prototype.refreshPlayerRecord = function(e) {
this.playerBetRecord.splice(0);
this.playerBetRecord = m.RBFastStruct.getBetRecordArray(e);
for (var t = 0; t < this.playerBetRecord.length; t++) d.default.Instance.Global.emit(_.RBFastOddsEvent.ODDS_BET_CHANGED_SELF, {
index: t,
self: this.playerBetRecord[t].amount,
all: null
});
};
e.prototype.getWinFee = function(e) {
var t = this.declearData.bet_record[e];
return t ? t.amount : 0;
};
e.prototype.checkRecharge = function() {
return h.VM.getValue("wallet.totalRecharge") >= f.COMPOSITE_MIN_RECHARGE;
};
e._instance = null;
return e;
}();
o.RBFastModel = g;
var v = function() {
function e() {
this._recordCount = 10;
this.userPage = 0;
this._userTotal = 10;
this.winnerPage = 0;
this._winnerTotal = 10;
this.isOpenWindow = !1;
}
Object.defineProperty(e, "Instance", {
get: function() {
e._instance || (e._instance = new e());
return e._instance;
},
enumerable: !1,
configurable: !0
});
Object.defineProperty(e.prototype, "cls", {
get: function() {
return a.GameEnum.PlayType.GAME_RB_FAST;
},
enumerable: !1,
configurable: !0
});
e.prototype.Init = function() {
d.default.Instance.Net.bind(r.S2C.GAME.ROOM_ENTER_ROOM, this._onEnterRoom, this);
d.default.Instance.Net.bind(r.S2C.GAME.ROOM_SWITCH_ROOM, this._onSwitchRoom, this);
d.default.Instance.Net.bind(r.S2C.GAME.ROOM_DEAL, this._onDeal, this);
d.default.Instance.Net.bind(r.S2C.GAME.ROOM_START_BET, this._onStartBet, this);
d.default.Instance.Net.bind(r.S2C.GAME.ROOM_BET, this._onBet, this);
d.default.Instance.Net.bind(r.S2C.GAME.ROOM_BET_BATCH, this._onBetBatch, this);
d.default.Instance.Net.bind(r.S2C.GAME.ROOM_STOP_BET, this._onStopBet, this);
d.default.Instance.Net.bind(r.S2C.GAME.ROOM_SHOW, this._onShow, this);
d.default.Instance.Net.bind(r.S2C.GAME.ROOM_RESET_ROOM, this._onResetRoom, this);
d.default.Instance.Net.bind(r.S2C.GAME.ROOM_AUTOPLAY, this._onAutoPlay, this);
d.default.Instance.Net.bind(r.S2C.GAME.ROOM_REPEAT_BET, this._onRepeatBet, this);
d.default.Instance.Net.bind(r.S2C.GAME.ROOM_USER_RECORD, this._onUserRecord, this);
d.default.Instance.Net.bind(r.S2C.GAME.ROOM_BIGWINNER_RECORD, this._onBigWinnerRecord, this);
d.default.Instance.Net.bind(r.S2C.GAME.ROOM_INTERACT, this._onInteract, this);
d.default.Instance.Net.bind(r.S2C.GAME.ROOM_LEAVE, this._onLeave, this);
d.default.Instance.Net.bind(r.S2C.GAME.ROOM_LEAVE_SINGLE, this._onLeaveSingle, this);
d.default.Instance.Net.bind(r.S2C.GAME.ROOM_DISMISS, this._onDismiss, this);
d.default.Instance.Net.bind(r.S2C.GAME.ROOM_SEND_AVAILABLE_BALANCE, this._onBalanceRefresh, this);
d.default.Instance.Global.bind(p.NetState.NET_WEBSOCKET_CONNECT_OPEN, this._onWsContented, this);
};
e.prototype.destory = function() {
d.default.Instance.Net.unbind(r.S2C.GAME.ROOM_ENTER_ROOM, this._onEnterRoom, this);
d.default.Instance.Net.unbind(r.S2C.GAME.ROOM_SWITCH_ROOM, this._onSwitchRoom, this);
d.default.Instance.Net.unbind(r.S2C.GAME.ROOM_DEAL, this._onDeal, this);
d.default.Instance.Net.unbind(r.S2C.GAME.ROOM_START_BET, this._onStartBet, this);
d.default.Instance.Net.unbind(r.S2C.GAME.ROOM_BET, this._onBet, this);
d.default.Instance.Net.unbind(r.S2C.GAME.ROOM_BET_BATCH, this._onBetBatch, this);
d.default.Instance.Net.unbind(r.S2C.GAME.ROOM_STOP_BET, this._onStopBet, this);
d.default.Instance.Net.unbind(r.S2C.GAME.ROOM_SHOW, this._onShow, this);
d.default.Instance.Net.unbind(r.S2C.GAME.ROOM_RESET_ROOM, this._onResetRoom, this);
d.default.Instance.Net.unbind(r.S2C.GAME.ROOM_AUTOPLAY, this._onAutoPlay, this);
d.default.Instance.Net.unbind(r.S2C.GAME.ROOM_REPEAT_BET, this._onRepeatBet, this);
d.default.Instance.Net.unbind(r.S2C.GAME.ROOM_USER_RECORD, this._onUserRecord, this);
d.default.Instance.Net.unbind(r.S2C.GAME.ROOM_BIGWINNER_RECORD, this._onBigWinnerRecord, this);
d.default.Instance.Net.unbind(r.S2C.GAME.ROOM_INTERACT, this._onInteract, this);
d.default.Instance.Net.unbind(r.S2C.GAME.ROOM_LEAVE, this._onLeave, this);
d.default.Instance.Net.unbind(r.S2C.GAME.ROOM_LEAVE_SINGLE, this._onLeaveSingle, this);
d.default.Instance.Net.unbind(r.S2C.GAME.ROOM_DISMISS, this._onDismiss, this);
d.default.Instance.Net.unbind(r.S2C.GAME.ROOM_SEND_AVAILABLE_BALANCE, this._onBalanceRefresh, this);
d.default.Instance.Global.unbind(p.NetState.NET_WEBSOCKET_CONNECT_OPEN, this._onWsContented, this);
this.clear();
};
e.prototype.clear = function() {
this._recordCount = 10;
this.userPage = 0;
this._userTotal = 10;
this.winnerPage = 0;
this._winnerTotal = 10;
this.isOpenWindow = !1;
};
e.prototype._onWsContented = function() {
l.default.Instance.begin();
var e = h.VM.getValue("lobby.roomIDFast");
0 != e && this.sendEnterRoom(e);
};
Object.defineProperty(e.prototype, "roomID", {
get: function() {
return h.VM.getValue("lobby.roomIDFast");
},
enumerable: !1,
configurable: !0
});
Object.defineProperty(e.prototype, "uid", {
get: function() {
return h.VM.getValue("user.uid");
},
enumerable: !1,
configurable: !0
});
Object.defineProperty(e.prototype, "token", {
get: function() {
return h.VM.getValue("user.token");
},
enumerable: !1,
configurable: !0
});
e.prototype.checkRoomID = function(e) {
return e == this.cls;
};
e.prototype.checkRoomType = function(e) {
var t = e.split("_"), o = -1;
null != t && null != t[0] && (o = parseInt(t[0]));
return o == a.GameEnum.PlayType.GAME_RB_FAST;
};
e.prototype._onEnterRoom = function(e) {
var t = e.getUserData();
if (this.checkRoomID(t.cls)) {
var o = g.Instance;
o.sTime = t.stime;
o.bet_fee_currency = t.bet_fee_currency;
o.bet_options = t.bet_options;
o.refreshUserData(t.user_data);
o.declearHistory.refresh(t.declear_history);
d.default.Instance.Global.emit(_.RBFastUIEvent.UI_INIT_ODDS_AMOUNT);
o.roomData.refresh(t.room_data);
o.refreshRoomRecord(t.bet_data);
o.bet_limit = u.Tools.TNumber.num2single(t.bet_limit);
null != t.declear_data && o.declearData.refresh(t.declear_data);
o.deal_card = t.room_data.deal_card;
o.show_card = t.room_data.show_card;
o.win_options = t.win_options;
d.default.Instance.Global.emit(_.RBFastGameEvent.GAME_RECONNECT, t.uid);
d.default.Instance.Global.emit(_.RBFastEvent.S2C_ENTER_ROOM_FAST, t.uid);
}
};
e.prototype._onSwitchRoom = function(e) {
var t = e.getUserData();
if (this.checkRoomType(t.room_type)) {
h.VM.getValue("lobby.roomIDFast") != t.r && h.VM.setValue("lobby.roomIDFast", parseInt(t.r));
d.default.Instance.Global.emit(_.RBFastEvent.S2C_SWITCH_ROOM_FAST, t.r);
}
};
e.prototype._onDeal = function(e) {
var t = e.getUserData();
if (this.checkRoomID(t.cls)) {
var o = g.Instance;
o.sTime = t.stime;
o.roomData.refresh(t.room_data);
o.refreshUserData(t.user_data);
o.deal_card = t.room_data.deal_card;
o.show_card = t.room_data.show_card;
o.declearData = null;
o.declearData = new m.RBFastStruct.DeclearData();
d.default.Instance.Global.emit(_.RBFastEvent.S2C_DEAL_FAST, {
wildCard: o.deal_card[0]
});
}
};
e.prototype._onStartBet = function(e) {
var t = e.getUserData();
if (this.checkRoomID(t.cls)) {
var o = g.Instance;
o.sTime = t.stime;
o.roomData.refresh(t.room_data);
o.deal_card = t.room_data.deal_card;
o.show_card = t.room_data.show_card;
d.default.Instance.Global.emit(_.RBFastUIEvent.UI_EFFECT_START_BET);
}
};
e.prototype._onBet = function(e) {
var t = e.getUserData();
if (this.checkRoomID(t.cls) && null != t.bet_user && t.bet_user.uid == this.uid) {
var o = g.Instance;
o.sTime = t.stime;
if (null != t.bet_err && 1 == t.bet_err) {
var n = u.Tools.TNumber.num2single(t.bet_total);
d.default.Instance.Global.emit(_.RBFastEvent.TABLE_REPEAT_BET_ERROR, {
bet_total: n
});
} else {
o.refreshRoomRecord(t.bet_data);
o.refreshPlayerRecord(t.bet_user.bet_record);
o.total_fee = u.Tools.TNumber.num2single(t.bet_user.total_fee);
o.userData.total_fee = u.Tools.TNumber.num2single(t.bet_user.total_fee);
o.userData.auto = t.bet_user.auto;
o.userData.repeat = t.bet_user.repeat;
var a = m.RBFastStruct.getBetRecordArray(t.bet_user.bet_batch_data);
d.default.Instance.Global.emit(_.RBFastEvent.S2C_BET_FAST, {
bet_batch_data: a,
uid: t.bet_user.uid
});
}
}
};
e.prototype._onBetBatch = function(e) {
var t = e.getUserData();
if (this.checkRoomID(t.cls)) {
var o = g.Instance;
o.sTime = t.stime;
o.refreshRoomRecord(t.bet_data);
var n = m.RBFastStruct.getBetRecordArray(t.bet_batch_data);
d.default.Instance.Global.emit(_.RBFastEvent.S2C_BET_BATCH_FAST, n);
}
};
e.prototype._onStopBet = function(e) {
var t = e.getUserData();
if (this.checkRoomID(t.cls)) {
var o = g.Instance;
o.sTime = t.stime;
o.roomData.refresh(t.room_data);
o.deal_card = t.room_data.deal_card;
o.show_card = t.room_data.show_card;
d.default.Instance.Global.emit(_.RBFastUIEvent.UI_EFFECT_STOP_BET);
}
};
e.prototype._onShow = function(e) {
var t = e.getUserData();
if (this.checkRoomID(t.cls)) {
var o = g.Instance, n = new m.RBFastStruct.HistoryData({
d: [ t.room_data.show_card[0] ]
});
o.declearHistory.addHistory(n);
o.sTime = t.stime;
o.roomData.refresh(t.room_data);
o.deal_card = t.room_data.deal_card;
o.show_card = t.room_data.show_card;
o.win_options = t.win_options;
o.refreshRoomRecord(t.bet_data);
o.declearData.refresh(t.declear_data);
d.default.Instance.Global.emit(_.RBFastEvent.S2C_SHOW_FAST);
}
};
e.prototype._onResetRoom = function(e) {
var t = e.getUserData();
if (this.checkRoomID(t.cls)) {
var o = g.Instance;
o.sTime = t.stime;
o.roomData.refresh(t.room_data);
o.refreshUserData(t.user_data);
o.deal_card = t.room_data.deal_card;
o.show_card = t.room_data.show_card;
null != t.kick_data && null != t.kick_data[this.uid] && (o.userData.auto = !1);
d.default.Instance.Global.emit(_.RBFastEvent.S2C_RESET_FAST);
}
};
e.prototype._onAutoPlay = function(e) {
var t = e.getUserData();
if (this.checkRoomID(t.cls)) {
var o = g.Instance;
o.sTime = t.stime;
o.refreshUserData(t.user_data);
d.default.Instance.Global.emit(_.RBFastEvent.S2C_AUTO_PLAY_FAST);
}
};
e.prototype._onRepeatBet = function(e) {
var t = e.getUserData();
if (this.checkRoomID(t.cls)) {
var o = g.Instance;
o.sTime = t.stime;
if (null != t.bet_err && 1 == t.bet_err) {
var n = u.Tools.TNumber.num2single(t.bet_total);
d.default.Instance.Global.emit(_.RBFastEvent.TABLE_REPEAT_BET_ERROR, {
bet_total: n
});
} else {
o.refreshUserData(t.user_data);
o.refreshRoomRecord(t.bet_data);
d.default.Instance.Global.emit(_.RBFastEvent.S2C_REPEAT_BET_FAST);
}
}
};
e.prototype._onUserRecord = function(e) {
var t = e.getUserData();
if (this.checkRoomID(t.cls)) {
var o = g.Instance;
o.sTime = t.stime;
this._userTotal = t.total;
t.page_data.forEach(function(e) {
var t = new m.RBFastStruct.UserRecord(e);
o.user_record.push(t);
});
d.default.Instance.Global.emit(_.RBFastEvent.S2C_USER_RECORD_FAST);
}
};
e.prototype._onBigWinnerRecord = function(e) {
var t = e.getUserData();
if (this.checkRoomID(t.cls)) {
var o = g.Instance;
o.sTime = t.stime;
this._winnerTotal = t.total;
t.page_data.forEach(function(e) {
var t = new m.RBFastStruct.BigWinnerRecord(e);
o.big_winner_record.push(t);
});
d.default.Instance.Global.emit(_.RBFastEvent.S2C_WINNER_RECORD_FAST);
}
};
e.prototype._onInteract = function(e) {
var t = e.getUserData();
this.checkRoomID(t.cls) && d.default.Instance.Global.emit(_.RBFastEvent.S2C_INTERACT_FAST, t);
};
e.prototype._onLeave = function(e) {
var t = e.getUserData();
if (this.checkRoomID(t.cls)) {
g.Instance.sTime = t.stime;
d.default.Instance.Global.emit(_.RBFastEvent.S2C_LEAVE_FAST);
}
};
e.prototype._onLeaveSingle = function(e) {
var t = e.getUserData();
if (this.checkRoomID(t.cls) || 0 == h.VM.getValue("lobby.roomIDFast")) {
g.Instance.sTime = t.stime;
d.default.Instance.Global.emit(_.RBFastEvent.S2C_LEAVE_SINGLE_FAST, t);
}
};
e.prototype._onDismiss = function(e) {
var t = e.getUserData();
if (this.checkRoomID(t.cls)) {
var o = g.Instance;
o.userData && (o.userData.auto = !1);
d.default.Instance.Global.emit(_.RBFastEvent.S2C_DISMISS_ROOM_FAST, t);
}
};
e.prototype._onBalanceRefresh = function(e) {
var t = e.getUserData();
if (!this.checkRoomID(t.rid)) {
var o = g.Instance, a = u.Tools.TNumber.num2single(t.total_fee);
o.total_fee = a;
o.userData && (o.userData.total_fee = a);
c.WalletProxy.Instance.refreshWallet(t);
d.default.Instance.Global.emit(n.GameEvent.S2C_SEND_AVAILABLE_BALANCE);
}
};
e.prototype.sendEnterRoom = function(e) {
var t = p.default.Instance.makeMsg(i.C2S.ROOM_ENTER_ROOM, {
u: this.uid,
t: this.token,
r: e,
is_open: this.isOpenWindow
});
p.default.Instance.send(t);
};
e.prototype.sendBet = function(e, t) {
var o = u.Tools.TNumber.num2thousand(e);
s.default.Instance.CompositeBetNum = e;
var n = p.default.Instance.makeMsg(i.C2S.ROOM_BET, {
u: this.uid,
t: this.token,
r: this.roomID,
fee: o,
option: t
});
p.default.Instance.send(n);
};
e.prototype.sendAutoPlay = function() {
var e = p.default.Instance.makeMsg(i.C2S.ROOM_AUTOPLAY, {
u: this.uid,
t: this.token,
r: this.roomID
});
p.default.Instance.send(e);
};
e.prototype.sendRepeatBet = function() {
var e = p.default.Instance.makeMsg(i.C2S.ROOM_REPEAT_BET, {
u: this.uid,
t: this.token,
r: this.roomID
});
p.default.Instance.send(e);
};
e.prototype.sendUserRecord = function() {
if (0 == this._userTotal || Math.ceil(this._userTotal / this._recordCount) >= this.userPage + 1) {
this.userPage++;
var e = p.default.Instance.makeMsg(i.C2S.ROOM_USER_RECORD, {
u: this.uid,
t: this.token,
r: this.roomID,
page: this.userPage,
count: this._recordCount
});
p.default.Instance.send(e);
}
};
e.prototype.sendWinnerRecord = function() {
if (Math.ceil(this._winnerTotal / this._recordCount) >= this.winnerPage + 1) {
this.winnerPage++;
var e = p.default.Instance.makeMsg(i.C2S.ROOM_BIGWINNER_RECORD, {
u: this.uid,
t: this.token,
r: this.roomID,
page: this.winnerPage,
count: this._recordCount
});
p.default.Instance.send(e);
}
};
e.prototype.sendInteract = function(e, t, o) {
var n;
n = o ? {
u: this.uid,
t: this.token,
r: this.roomID,
to_u: e,
opt_type: t,
opt_val: o
} : {
u: this.uid,
t: this.token,
r: this.roomID,
to_u: e,
opt_type: t
};
var a = p.default.Instance.makeMsg(i.C2S.ROOM_INTERACT, n);
p.default.Instance.send(a);
};
e.prototype.sendRank = function(e, t) {
var o = p.default.Instance.makeMsg(i.C2S.ROOM_RANK, {
u: this.uid,
t: this.token,
r: this.roomID,
page: e,
count: t
});
p.default.Instance.send(o);
};
e.prototype.sendLeave = function() {
var e = p.default.Instance.makeMsg(i.C2S.ROOM_LEAVE, {
u: this.uid,
t: this.token,
r: this.roomID
});
p.default.Instance.send(e);
};
e._instance = null;
return e;
}();
o.default = v;
cc._RF.pop();
}, {
"../../../Game/client/global/enum/game/Event": "Event",
"../../../Game/client/global/enum/game/Game": "Game",
"../../../Game/client/global/enum/net/C2S": "C2S",
"../../../Game/client/global/enum/net/S2C": "S2C",
"../../../Game/fromework/global/Tools": "Tools",
"../../../Game/fromework/helper/EventHelper": "EventHelper",
"../../../Game/fromework/mvvm/modelView/ViewModel": "ViewModel",
"../../../client/logic/game/HearBeat": "HearBeat",
"../../../client/model/ErrorModel": "ErrorModel",
"../../../client/model/WalletModel": "WalletModel",
"../../../fromework/helper/NetHelper": "NetHelper",
"../../../platform/Platform": "Platform",
"../../Common/Utils/CompositeConst": "CompositeConst",
"./RBFastEvent": "RBFastEvent",
"./RBFastStruct": "RBFastStruct"
} ],
RBFastOdds: [ function(e, t, o) {
"use strict";
cc._RF.push(t, "340a639kIRI269mGwexBVrE", "RBFastOdds");
var n, a = this && this.__extends || (n = function(e, t) {
return (n = Object.setPrototypeOf || {
__proto__: []
} instanceof Array && function(e, t) {
e.__proto__ = t;
} || function(e, t) {
for (var o in t) Object.prototype.hasOwnProperty.call(t, o) && (e[o] = t[o]);
})(e, t);
}, function(e, t) {
n(e, t);
function o() {
this.constructor = e;
}
e.prototype = null === t ? Object.create(t) : (o.prototype = t.prototype, new o());
}), i = this && this.__decorate || function(e, t, o, n) {
var a, i = arguments.length, r = i < 3 ? t : null === n ? n = Object.getOwnPropertyDescriptor(t, o) : n;
if ("object" == typeof Reflect && "function" == typeof Reflect.decorate) r = Reflect.decorate(e, t, o, n); else for (var l = e.length - 1; l >= 0; l--) (a = e[l]) && (r = (i < 3 ? a(r) : i > 3 ? a(t, o, r) : a(t, o)) || r);
return i > 3 && r && Object.defineProperty(t, o, r), r;
};
Object.defineProperty(o, "__esModule", {
value: !0
});
var r = e("../../../Game/client/global/enum/game/UIUtils"), l = e("../../../Game/client/model/LanguageModel"), s = e("../../../Game/fromework/helper/EventHelper"), c = e("./RBFastEvent"), u = e("./RBFastModel"), d = cc._decorator, p = d.ccclass, h = d.property, f = function(e) {
a(t, e);
function t() {
var t = null !== e && e.apply(this, arguments) || this;
t.Index = 0;
t.AllAmount = null;
t.Amount = null;
t.BetButton = null;
t.Rate = null;
t.LightNodes = [];
return t;
}
t.prototype.onEnable = function() {
s.default.Instance.Global.bind(c.RBFastGameEvent.GAME_RECONNECT, this.onReconnect, this);
s.default.Instance.Global.bind(c.RBFastEvent.S2C_DEAL_FAST, this.onDeal, this);
s.default.Instance.Global.bind(c.RBFastEvent.S2C_BET_BATCH_FAST, this.onBetAll, this);
s.default.Instance.Global.bind(c.RBFastOddsEvent.ODDS_BET_CHANGED_SELF, this.onBetSelf, this);
s.default.Instance.Global.bind(c.RBFastEvent.S2C_SHOW_FAST, this.onShow, this);
s.default.Instance.Global.bind(c.RBFastEvent.S2C_RESET_FAST, this.onReset, this);
};
t.prototype.onDisable = function() {
s.default.Instance.Global.unbind(c.RBFastGameEvent.GAME_RECONNECT, this.onReconnect, this);
s.default.Instance.Global.unbind(c.RBFastEvent.S2C_DEAL_FAST, this.onDeal, this);
s.default.Instance.Global.unbind(c.RBFastEvent.S2C_BET_BATCH_FAST, this.onBetAll, this);
s.default.Instance.Global.unbind(c.RBFastOddsEvent.ODDS_BET_CHANGED_SELF, this.onBetSelf, this);
s.default.Instance.Global.unbind(c.RBFastEvent.S2C_SHOW_FAST, this.onShow, this);
s.default.Instance.Global.unbind(c.RBFastEvent.S2C_RESET_FAST, this.onReset, this);
};
t.prototype.setAllAmount = function(e) {
this.AllAmount.string = l.default.getString("MoneySymbol") + e;
};
t.prototype.setAmount = function(e) {
this.Amount.string = l.default.getString("MoneySymbol") + e;
};
t.prototype.setLight = function(e, t) {
void 0 === t && (t = 255);
this.LightNodes.forEach(function(o) {
o.active = e;
o.opacity = t;
});
};
t.prototype.playTwinkle = function() {
this.LightNodes.forEach(function(e) {
var t = cc.tween(e).to(.5, {
opacity: 255
}).to(.5, {
opacity: 0
});
cc.tween(e).then(t).repeat(2).to(.5, {
opacity: 255
}).start();
});
};
t.prototype.setButton = function(e) {
r.UIUtils.setGray(this.BetButton, e, !0);
this.BetButton.getComponent(cc.Button).interactable = !e;
};
t.prototype.onReconnect = function() {
var e = u.RBFastModel.Instance;
this.Rate.string = "x" + e.bet_options[this.Index].x;
if (2 == e.roomData.state) {
var t = e.roomBetRecord[this.Index] ? e.roomBetRecord[this.Index].amount : 0, o = e.playerBetRecord[this.Index] ? e.playerBetRecord[this.Index].amount : 0;
this.setAllAmount(t);
this.setAmount(o);
this.setLight(!1);
this.setButton(!1);
} else if (3 == e.roomData.state) {
var n = e.win_options.indexOf(this.Index) >= 0;
this.setLight(n);
this.setButton(!n);
} else this.onReset();
};
t.prototype.onDeal = function() {
this.setAllAmount(0);
this.setAmount(0);
this.setLight(!1);
this.setButton(!1);
};
t.prototype.onBetAll = function() {
var e = u.RBFastModel.Instance, t = e.roomBetRecord[this.Index] ? e.roomBetRecord[this.Index].amount : 0;
this.setAllAmount(t);
};
t.prototype.onBetSelf = function(e) {
var t = e.getUserData();
t.index == this.Index && this.setAmount(t.self);
};
t.prototype.onShow = function() {
var e = u.RBFastModel.Instance.win_options.indexOf(this.Index) >= 0;
this.setLight(e, 0);
this.setButton(!e);
this.playTwinkle();
};
t.prototype.onReset = function() {};
t.prototype.onBetClicked = function() {
s.default.Instance.Global.emit(c.RBFastOddsEvent.ODDS_BET_BUTTON_CLICK, {
index: this.Index
});
};
i([ h(cc.Integer) ], t.prototype, "Index", void 0);
i([ h(cc.Label) ], t.prototype, "AllAmount", void 0);
i([ h(cc.Label) ], t.prototype, "Amount", void 0);
i([ h(cc.Node) ], t.prototype, "BetButton", void 0);
i([ h(cc.Label) ], t.prototype, "Rate", void 0);
i([ h([ cc.Node ]) ], t.prototype, "LightNodes", void 0);
return i([ p ], t);
}(cc.Component);
o.default = f;
cc._RF.pop();
}, {
"../../../Game/client/global/enum/game/UIUtils": "UIUtils",
"../../../Game/client/model/LanguageModel": "LanguageModel",
"../../../Game/fromework/helper/EventHelper": "EventHelper",
"./RBFastEvent": "RBFastEvent",
"./RBFastModel": "RBFastModel"
} ],
RBFastRecordAlert: [ function(e, t, o) {
"use strict";
cc._RF.push(t, "8f13eWbE01HWrzjTzz4Szw8", "RBFastRecordAlert");
var n, a = this && this.__extends || (n = function(e, t) {
return (n = Object.setPrototypeOf || {
__proto__: []
} instanceof Array && function(e, t) {
e.__proto__ = t;
} || function(e, t) {
for (var o in t) Object.prototype.hasOwnProperty.call(t, o) && (e[o] = t[o]);
})(e, t);
}, function(e, t) {
n(e, t);
function o() {
this.constructor = e;
}
e.prototype = null === t ? Object.create(t) : (o.prototype = t.prototype, new o());
}), i = this && this.__decorate || function(e, t, o, n) {
var a, i = arguments.length, r = i < 3 ? t : null === n ? n = Object.getOwnPropertyDescriptor(t, o) : n;
if ("object" == typeof Reflect && "function" == typeof Reflect.decorate) r = Reflect.decorate(e, t, o, n); else for (var l = e.length - 1; l >= 0; l--) (a = e[l]) && (r = (i < 3 ? a(r) : i > 3 ? a(t, o, r) : a(t, o)) || r);
return i > 3 && r && Object.defineProperty(t, o, r), r;
};
Object.defineProperty(o, "__esModule", {
value: !0
});
var r = e("../../../fromework/component/listView/ListView"), l = e("../../../Game/fromework/helper/EventHelper"), s = e("../../../Game/fromework/helper/UIHelper"), c = e("./RBFastEvent"), u = e("./RBFastModel"), d = cc._decorator, p = d.ccclass, h = d.property, f = function(e) {
a(t, e);
function t() {
var t = null !== e && e.apply(this, arguments) || this;
t.UserRecord = null;
t.WinnerRecord = null;
t.UserList = null;
t.WinnerList = null;
t.UserListNone = null;
t.MyListRates = [];
return t;
}
t.prototype.onEnable = function() {
l.default.Instance.Global.bind(c.RBFastEvent.S2C_USER_RECORD_FAST, this.refreshUser, this);
l.default.Instance.Global.bind(c.RBFastEvent.S2C_WINNER_RECORD_FAST, this.refreshWinner, this);
this.UserList.node.on("scroll-to-bottom", this.loadMoreUserPage, this);
this.WinnerList.node.on("scroll-to-bottom", this.loadMoreWinnerPage, this);
};
t.prototype.onDisable = function() {
l.default.Instance.Global.unbind(c.RBFastEvent.S2C_USER_RECORD_FAST, this.refreshUser, this);
l.default.Instance.Global.unbind(c.RBFastEvent.S2C_WINNER_RECORD_FAST, this.refreshWinner, this);
this.UserList.node.off("scroll-to-bottom", this.loadMoreUserPage, this);
this.WinnerList.node.off("scroll-to-bottom", this.loadMoreWinnerPage, this);
};
t.prototype.onLoad = function() {
var e = u.RBFastModel.Instance;
u.default.Instance.userPage = 0;
e.user_record.splice(0);
this.loadMoreUserPage();
for (var t = 0; t < this.MyListRates.length; t++) {
var o = this.MyListRates[t];
o && o.isValid && (o.string = "x" + e.bet_options[t].x);
}
};
t.prototype.loadMoreUserPage = function() {
u.default.Instance.sendUserRecord();
};
t.prototype.loadMoreWinnerPage = function() {
u.default.Instance.sendWinnerRecord();
};
t.prototype.refreshUser = function() {
var e = u.RBFastModel.Instance.user_record.concat();
this.UserList.datas = e;
this.UserListNone.active = 0 == e.length;
};
t.prototype.refreshWinner = function() {
var e = u.RBFastModel.Instance;
this.WinnerList.datas = e.big_winner_record.concat();
};
t.prototype.onUserRecordClicked = function() {
var e = u.RBFastModel.Instance;
this.UserRecord.active = !0;
this.WinnerRecord.active = !1;
u.default.Instance.winnerPage = 0;
e.big_winner_record.splice(0);
u.default.Instance.sendUserRecord();
};
t.prototype.onWinnerRecordClicked = function() {
var e = u.RBFastModel.Instance;
this.UserRecord.active = !1;
this.WinnerRecord.active = !0;
u.default.Instance.userPage = 0;
e.user_record.splice(0);
u.default.Instance.sendWinnerRecord();
};
t.prototype.onCloseClicked = function() {
s.default.Instance.removeMaskLayer(this.node, !0);
};
i([ h(cc.Node) ], t.prototype, "UserRecord", void 0);
i([ h(cc.Node) ], t.prototype, "WinnerRecord", void 0);
i([ h(r.default) ], t.prototype, "UserList", void 0);
i([ h(r.default) ], t.prototype, "WinnerList", void 0);
i([ h(cc.Node) ], t.prototype, "UserListNone", void 0);
i([ h([ cc.Label ]) ], t.prototype, "MyListRates", void 0);
return i([ p ], t);
}(cc.Component);
o.default = f;
cc._RF.pop();
}, {
"../../../Game/fromework/helper/EventHelper": "EventHelper",
"../../../Game/fromework/helper/UIHelper": "UIHelper",
"../../../fromework/component/listView/ListView": "ListView",
"./RBFastEvent": "RBFastEvent",
"./RBFastModel": "RBFastModel"
} ],
RBFastRecord: [ function(e, t, o) {
"use strict";
cc._RF.push(t, "226ee5u9IhFgZjiXOizp8Kb", "RBFastRecord");
var n, a = this && this.__extends || (n = function(e, t) {
return (n = Object.setPrototypeOf || {
__proto__: []
} instanceof Array && function(e, t) {
e.__proto__ = t;
} || function(e, t) {
for (var o in t) Object.prototype.hasOwnProperty.call(t, o) && (e[o] = t[o]);
})(e, t);
}, function(e, t) {
n(e, t);
function o() {
this.constructor = e;
}
e.prototype = null === t ? Object.create(t) : (o.prototype = t.prototype, new o());
}), i = this && this.__decorate || function(e, t, o, n) {
var a, i = arguments.length, r = i < 3 ? t : null === n ? n = Object.getOwnPropertyDescriptor(t, o) : n;
if ("object" == typeof Reflect && "function" == typeof Reflect.decorate) r = Reflect.decorate(e, t, o, n); else for (var l = e.length - 1; l >= 0; l--) (a = e[l]) && (r = (i < 3 ? a(r) : i > 3 ? a(t, o, r) : a(t, o)) || r);
return i > 3 && r && Object.defineProperty(t, o, r), r;
};
Object.defineProperty(o, "__esModule", {
value: !0
});
var r = e("../../../Game/client/global/enum/game/Game"), l = e("../../../Game/fromework/helper/EventHelper"), s = e("../../../Game/fromework/helper/UIHelper"), c = e("./RBFastEvent"), u = e("./RBFastModel"), d = cc._decorator, p = d.ccclass, h = d.property, f = function(e) {
a(t, e);
function t() {
var t = null !== e && e.apply(this, arguments) || this;
t.RecordParent = null;
t.RecordItem = null;
t.Color_Red = null;
t.Color_Black = null;
t.Light = null;
t.Frame_Patterns = [];
return t;
}
t.prototype.onEnable = function() {
l.default.Instance.Global.bind(c.RBFastEvent.S2C_ENTER_ROOM_FAST, this._onEnterRoom, this);
l.default.Instance.Global.bind(c.RBFastEvent.S2C_DEAL_FAST, this._onDeal, this);
};
t.prototype.onDisable = function() {
l.default.Instance.Global.unbind(c.RBFastEvent.S2C_ENTER_ROOM_FAST, this._onEnterRoom, this);
l.default.Instance.Global.unbind(c.RBFastEvent.S2C_DEAL_FAST, this._onDeal, this);
};
t.prototype._onEnterRoom = function() {
this.refreshRecord(!1);
};
t.prototype._onDeal = function() {
this.refreshRecord(!0);
};
t.prototype.refreshRecord = function(e) {
var t = this;
void 0 === e && (e = !1);
var o = u.RBFastModel.Instance;
this.RecordParent.destroyAllChildren();
for (var n = o.declearHistory.getSimpleHistory(32), a = 0; a < n.length; a++) {
var i = n[a], l = i.getPartten(), s = i.isJoker(), c = l == r.GameEnum.Pattern.Heart || l == r.GameEnum.Pattern.Diamond, d = cc.instantiate(this.RecordItem);
d.active = !0;
d.setPosition(cc.Vec2.ZERO);
d.parent = this.RecordParent;
var p = d.getChildByName("Icon"), h = d.getChildByName("Points"), f = d.getChildByName("Joker");
if (!s) {
p.color = c ? this.Color_Red : this.Color_Black;
p.getComponent(cc.Sprite).spriteFrame = this.Frame_Patterns[i.getPartten()];
h.color = c ? this.Color_Red : this.Color_Black;
h.getComponent(cc.Label).string = i.getFigureString() + "";
}
p.active = !s;
h.active = !s;
f.active = s;
}
if (e) {
this.RecordParent.getComponent(cc.Layout).updateLayout();
var _ = this.RecordParent.children[this.RecordParent.children.length - 1], m = _.parent.convertToWorldSpaceAR(_.position), y = this.Light.node.parent.convertToNodeSpaceAR(m);
this.Light.node.position = y;
this.Light.node.active = !0;
this.Light.armatureName = "Armature";
this.Light.once(dragonBones.EventObject.COMPLETE, function() {
t.Light.node.active = !1;
}, this);
this.Light.playAnimation("animation_new_details", 1);
}
};
t.prototype.onCloseClicked = function() {
s.default.Instance.removeMaskLayer(this.node, !0);
};
i([ h(cc.Node) ], t.prototype, "RecordParent", void 0);
i([ h(cc.Node) ], t.prototype, "RecordItem", void 0);
i([ h(cc.Color) ], t.prototype, "Color_Red", void 0);
i([ h(cc.Color) ], t.prototype, "Color_Black", void 0);
i([ h(dragonBones.ArmatureDisplay) ], t.prototype, "Light", void 0);
i([ h([ cc.SpriteFrame ]) ], t.prototype, "Frame_Patterns", void 0);
return i([ p ], t);
}(cc.Component);
o.default = f;
cc._RF.pop();
}, {
"../../../Game/client/global/enum/game/Game": "Game",
"../../../Game/fromework/helper/EventHelper": "EventHelper",
"../../../Game/fromework/helper/UIHelper": "UIHelper",
"./RBFastEvent": "RBFastEvent",
"./RBFastModel": "RBFastModel"
} ],
RBFastStruct: [ function(e, t, o) {
"use strict";
cc._RF.push(t, "2e61dQgVohD2ocMKMPk4esE", "RBFastStruct");
Object.defineProperty(o, "__esModule", {
value: !0
});
o.RBFastStruct = void 0;
var n = e("../../../Game/client/global/enum/game/Game"), a = e("../../../Game/fromework/global/Tools"), i = e("./RBFastModel");
(function(e) {
function t(e) {
for (var t = i.RBFastModel.Instance.bet_options.length, o = [], n = null != e ? e : [], a = 0; a < t; a++) null == o[a] ? o[a] = new l(n[a]) : o[a].refresh(n[a]);
return o;
}
e.getBetRecordArray = t;
var o = function() {
function e(e) {
this.rid = 0;
this.rtype = "";
this.state = 0;
this.dl = 0;
this.round = 0;
e && this.refresh(e);
}
e.prototype.refresh = function(e) {
this.rid = e.rid;
this.rtype = e.rtype;
this.state = e.state;
this.dl = e.dl;
this.round = e.round;
};
return e;
}();
e.RoomData = o;
var r = function() {
function e(e) {
this.uid = 0;
this.state = 0;
this.auto = !1;
this.repeat = !1;
this.res = 0;
this.total_fee = 0;
e && this.refresh(e);
}
e.prototype.refresh = function(e) {
this.uid = e.uid;
this.state = e.state;
this.auto = e.auto;
this.repeat = e.repeat;
this.res = e.res;
this.total_fee = a.Tools.TNumber.num2single(e.total_fee);
};
return e;
}();
e.UserData = r;
var l = function() {
function e(e) {
this.detail = new Map();
this.amount = 0;
e && this.refresh(e);
}
e.prototype.refresh = function(e) {
for (var t = i.RBFastModel.Instance, o = null != e.detail ? e.detail : [], n = 0; n < t.bet_fee_currency.length; n++) this.detail.set(t.bet_fee_currency[n], null != o[t.bet_fee_currency[n]] ? o[t.bet_fee_currency[n]] : 0);
this.amount = null != e.amount ? a.Tools.TNumber.num2single(e.amount) : 0;
};
return e;
}();
e.BetRecord = l;
var s = function() {
function e(e) {
this.bet_record = [];
this.win_fee = 0;
this.total_fee = 0;
e && this.refresh(e);
}
e.prototype.refresh = function(e) {
this.win_fee = a.Tools.TNumber.num2single(e.win_fee);
this.total_fee = a.Tools.TNumber.num2single(e.total_fee);
this.bet_record.splice(0);
this.bet_record = t(e.bet_record);
};
return e;
}();
e.DeclearData = s;
var c = function() {
function e(e) {
this.idx16 = 0;
e && this.refresh(e);
}
e.prototype.refresh = function(e) {
this.idx16 = e.d[0];
};
e.prototype.getPartten = function() {
return 65 == this.idx16 || 66 == this.idx16 ? n.GameEnum.Pattern.BigJoker : Math.floor(this.idx16 / 16);
};
e.prototype.getFigure = function() {
return this.idx16 % 16;
};
e.prototype.getFigureString = function() {
var e = this.idx16 % 16;
return 1 == e ? "A" : 11 == e ? "J" : 12 == e ? "Q" : 13 == e ? "K" : e + "";
};
e.prototype.isJoker = function() {
return 65 == this.idx16 || 66 == this.idx16;
};
e.prototype.getType = function() {
var e = this.getFigure();
return e >= 1 && e <= 6 ? "A-6" : e >= 7 && e <= 10 ? "7-10" : "JQK";
};
return e;
}();
e.HistoryData = c;
var u = function() {
function e(e) {
this.historyArray = [];
e && this.refresh(e);
}
e.prototype.refresh = function(e) {
var t = this;
this.historyArray.splice(0);
e.forEach(function(e) {
var o = new c(e);
t.historyArray.push(o);
});
};
e.prototype.getWinCount = function() {
var e = 0, t = 0, o = 0, a = 0, i = 0, r = 0, l = 0, s = 0, c = 0, u = 0, d = 0;
this.historyArray.forEach(function(p) {
var h = p.getPartten(), f = p.getFigure();
if (p.isJoker()) s++; else {
if (h == n.GameEnum.Pattern.Diamond) {
t++;
r++;
} else if (h == n.GameEnum.Pattern.Club) {
o++;
i++;
} else if (h == n.GameEnum.Pattern.Heart) {
t++;
a++;
} else if (h == n.GameEnum.Pattern.Spade) {
o++;
l++;
}
f >= 1 && f <= 6 ? c++ : f >= 1 && f <= 6 ? u++ : f >= 11 && f <= 13 && d++;
}
e++;
});
return {
total: e,
red: t,
black: o,
heart: a,
club: i,
diamond: r,
spade: l,
joker: s,
num_a_6: c,
num_7_10: u,
num_jqk: d
};
};
e.prototype.addHistory = function(e) {
100 == this.historyArray.length && this.historyArray.shift();
this.historyArray.push(e);
};
e.prototype.getSimpleHistory = function(e) {
for (var t = [], o = this.historyArray.length - 1; o >= 0; o--) {
var n = this.historyArray[o];
t.unshift(n);
if (t.length == e) break;
}
return t;
};
e.prototype.getComplexHistory = function(e) {
for (var t = [], o = -1, n = this.historyArray.length - 1; n >= 0; n--) {
var a = this.historyArray[n];
if (o != a.getPartten()) {
if (t.length == e) break;
o = a.getPartten();
t.unshift([]);
}
t[0].length != e && t[0].unshift(a);
}
return t;
};
return e;
}();
e.DeclearHistory = u;
var d = function() {
function e(e) {
this.show_card = [];
this.win_options = [];
this.time = 0;
this.bet_data = [];
this.win_fee = 0;
e && this.refresh(e);
}
e.prototype.refresh = function(e) {
this.show_card = e.d;
this.win_options = e.o;
this.time = e.t;
this.bet_data = e.b;
this.win_fee = a.Tools.TNumber.num2single(e.w);
};
e.prototype.getBetAmount = function(e) {
if (null == this.bet_data[e]) return 0;
var t = this.bet_data[e], o = Object.keys(t), n = 0;
o.forEach(function(e) {
n += a.Tools.TNumber.num2single(parseInt(e)) * t[e];
});
return n;
};
return e;
}();
e.UserRecord = d;
var p = function() {
function e(e) {
this.name = "";
this.url = "";
this.time = 0;
this.win_fee = 0;
e && this.refresh(e);
}
e.prototype.refresh = function(e) {
this.name = e.n;
this.url = e.h;
this.time = e.t;
this.win_fee = a.Tools.TNumber.num2single(e.w);
};
return e;
}();
e.BigWinnerRecord = p;
})(o.RBFastStruct || (o.RBFastStruct = {}));
cc._RF.pop();
}, {
"../../../Game/client/global/enum/game/Game": "Game",
"../../../Game/fromework/global/Tools": "Tools",
"./RBFastModel": "RBFastModel"
} ],
RBFastTips: [ function(e, t, o) {
"use strict";
cc._RF.push(t, "841f4DgJvZFcb8IcxWLhGOL", "RBFastTips");
var n, a = this && this.__extends || (n = function(e, t) {
return (n = Object.setPrototypeOf || {
__proto__: []
} instanceof Array && function(e, t) {
e.__proto__ = t;
} || function(e, t) {
for (var o in t) Object.prototype.hasOwnProperty.call(t, o) && (e[o] = t[o]);
})(e, t);
}, function(e, t) {
n(e, t);
function o() {
this.constructor = e;
}
e.prototype = null === t ? Object.create(t) : (o.prototype = t.prototype, new o());
}), i = this && this.__decorate || function(e, t, o, n) {
var a, i = arguments.length, r = i < 3 ? t : null === n ? n = Object.getOwnPropertyDescriptor(t, o) : n;
if ("object" == typeof Reflect && "function" == typeof Reflect.decorate) r = Reflect.decorate(e, t, o, n); else for (var l = e.length - 1; l >= 0; l--) (a = e[l]) && (r = (i < 3 ? a(r) : i > 3 ? a(t, o, r) : a(t, o)) || r);
return i > 3 && r && Object.defineProperty(t, o, r), r;
};
Object.defineProperty(o, "__esModule", {
value: !0
});
var r = e("../../../Game/fromework/helper/EventHelper"), l = e("./RBFastEvent"), s = e("./RBFastModel"), c = cc._decorator, u = c.ccclass, d = c.property, p = function(e) {
a(t, e);
function t() {
var t = null !== e && e.apply(this, arguments) || this;
t.Index = 0;
t.Template = null;
t.TipParent = null;
t.MoveRange = 30;
t._amount = 0;
return t;
}
t.prototype.onEnable = function() {
r.default.Instance.Global.bind(l.RBFastGameEvent.GAME_RECONNECT, this.onReconnect, this);
r.default.Instance.Global.bind(l.RBFastEvent.S2C_BET_BATCH_FAST, this.onBet, this);
r.default.Instance.Global.bind(l.RBFastEvent.S2C_SHOW_FAST, this.onShow, this);
r.default.Instance.Global.bind(l.RBFastEvent.S2C_RESET_FAST, this.onReset, this);
r.default.Instance.Global.bind(l.RBFastUIEvent.UI_INIT_ODDS_AMOUNT, this.initAmount, this);
};
t.prototype.onDisable = function() {
r.default.Instance.Global.unbind(l.RBFastGameEvent.GAME_RECONNECT, this.onReconnect, this);
r.default.Instance.Global.unbind(l.RBFastEvent.S2C_BET_BATCH_FAST, this.onBet, this);
r.default.Instance.Global.unbind(l.RBFastEvent.S2C_SHOW_FAST, this.onShow, this);
r.default.Instance.Global.unbind(l.RBFastEvent.S2C_RESET_FAST, this.onReset, this);
r.default.Instance.Global.unbind(l.RBFastUIEvent.UI_INIT_ODDS_AMOUNT, this.initAmount, this);
};
t.prototype.initAmount = function() {
var e = s.RBFastModel.Instance;
this._amount = e.roomBetRecord[this.Index] ? e.roomBetRecord[this.Index].amount : 0;
};
t.prototype.runTipsAction = function(e) {
if (!(e <= 0)) {
var t = cc.instantiate(this.Template);
t.active = !0;
t.position = cc.Vec3.ZERO;
t.parent = this.TipParent;
t.getChildByName("Tips").getComponent(cc.Label).string = "+" + e;
cc.tween(t).by(1.5, {
y: this.MoveRange,
opacity: -255
}).call(function() {
if (t && t.isValid) {
t.removeFromParent(!0);
t.destroy();
}
}).start();
}
};
t.prototype.onReconnect = function() {
var e = s.RBFastModel.Instance;
2 != e.roomData.state && 3 != e.roomData.state || (this._amount = e.roomBetRecord[this.Index] ? e.roomBetRecord[this.Index].amount : 0);
};
t.prototype.onBet = function() {
var e = s.RBFastModel.Instance, t = e.roomBetRecord[this.Index] ? e.roomBetRecord[this.Index].amount : 0;
this.runTipsAction(t - this._amount);
this._amount = t;
};
t.prototype.onShow = function() {
var e = s.RBFastModel.Instance.getWinFee(this.Index);
0 != e && this.runTipsAction(e);
};
t.prototype.onReset = function() {
this.TipParent.children.forEach(function(e) {
e.stopAllActions();
});
this.TipParent.destroyAllChildren();
this._amount = 0;
};
i([ d(cc.Integer) ], t.prototype, "Index", void 0);
i([ d(cc.Node) ], t.prototype, "Template", void 0);
i([ d(cc.Node) ], t.prototype, "TipParent", void 0);
i([ d(cc.Float) ], t.prototype, "MoveRange", void 0);
return i([ u ], t);
}(cc.Component);
o.default = p;
cc._RF.pop();
}, {
"../../../Game/fromework/helper/EventHelper": "EventHelper",
"./RBFastEvent": "RBFastEvent",
"./RBFastModel": "RBFastModel"
} ],
RBFastUserRecordItem: [ function(e, t, o) {
"use strict";
cc._RF.push(t, "bd768tgC29P3aOXXbnpV2mU", "RBFastUserRecordItem");
var n, a = this && this.__extends || (n = function(e, t) {
return (n = Object.setPrototypeOf || {
__proto__: []
} instanceof Array && function(e, t) {
e.__proto__ = t;
} || function(e, t) {
for (var o in t) Object.prototype.hasOwnProperty.call(t, o) && (e[o] = t[o]);
})(e, t);
}, function(e, t) {
n(e, t);
function o() {
this.constructor = e;
}
e.prototype = null === t ? Object.create(t) : (o.prototype = t.prototype, new o());
}), i = this && this.__decorate || function(e, t, o, n) {
var a, i = arguments.length, r = i < 3 ? t : null === n ? n = Object.getOwnPropertyDescriptor(t, o) : n;
if ("object" == typeof Reflect && "function" == typeof Reflect.decorate) r = Reflect.decorate(e, t, o, n); else for (var l = e.length - 1; l >= 0; l--) (a = e[l]) && (r = (i < 3 ? a(r) : i > 3 ? a(t, o, r) : a(t, o)) || r);
return i > 3 && r && Object.defineProperty(t, o, r), r;
};
Object.defineProperty(o, "__esModule", {
value: !0
});
var r = e("../../../Game/client/global/enum/game/Game"), l = e("../../../Game/client/logic/game/GameHelper"), s = e("../../../Game/fromework/global/Tools"), c = cc._decorator, u = c.ccclass, d = c.property, p = function(e) {
a(t, e);
function t() {
var t = null !== e && e.apply(this, arguments) || this;
t.Labels_Bet = [];
t.Sprites_Bet = [];
t.Time = null;
t.Result = null;
t.Total = null;
t.Frames_Result = [];
t.Frame_Patterns = [];
t.Color_Red = null;
t.Color_Black = null;
t._data = null;
t._index = -1;
return t;
}
t.prototype.onItemInitCallFunc = function(e, t) {
this._data = e;
this._index = t;
for (var o = 0; o < 7; o++) {
var n = this.Labels_Bet[o], a = this.Sprites_Bet[o], i = this._data.win_options.indexOf(o) >= 0, c = this._data.getBetAmount(o);
n.string = c + "";
a.node.active = c > 0;
a.spriteFrame = this.Frames_Result[i ? 0 : 1];
}
this.Time.string = s.Tools.TDate.format(1e3 * this._data.time, "MM/dd/yyyy hh:mm:ss");
var u = l.GroupHelper.getPattern(this._data.show_card[0]);
this.Result.spriteFrame = this.Frame_Patterns[u];
u == r.GameEnum.Pattern.LittleJoker || u == r.GameEnum.Pattern.BigJoker ? this.Result.node.color = cc.Color.WHITE : u == r.GameEnum.Pattern.Spade || u == r.GameEnum.Pattern.Club ? this.Result.node.color = this.Color_Black : this.Result.node.color = this.Color_Red;
this.Total.string = this._data.win_fee + "";
};
t.prototype.onItemEnterCallFunc = function() {
this.node.opacity = 255;
};
t.prototype.onItemExitCallFunc = function() {
this.node.opacity = 0;
};
i([ d([ cc.Label ]) ], t.prototype, "Labels_Bet", void 0);
i([ d([ cc.Sprite ]) ], t.prototype, "Sprites_Bet", void 0);
i([ d(cc.Label) ], t.prototype, "Time", void 0);
i([ d(cc.Sprite) ], t.prototype, "Result", void 0);
i([ d(cc.Label) ], t.prototype, "Total", void 0);
i([ d([ cc.SpriteFrame ]) ], t.prototype, "Frames_Result", void 0);
i([ d([ cc.SpriteFrame ]) ], t.prototype, "Frame_Patterns", void 0);
i([ d(cc.Color) ], t.prototype, "Color_Red", void 0);
i([ d(cc.Color) ], t.prototype, "Color_Black", void 0);
return i([ u ], t);
}(cc.Component);
o.default = p;
cc._RF.pop();
}, {
"../../../Game/client/global/enum/game/Game": "Game",
"../../../Game/client/logic/game/GameHelper": "GameHelper",
"../../../Game/fromework/global/Tools": "Tools"
} ],
RBFastWinnerRecordItem: [ function(e, t, o) {
"use strict";
cc._RF.push(t, "157c63aow1PfI9ReHCzkutY", "RBFastWinnerRecordItem");
var n, a = this && this.__extends || (n = function(e, t) {
return (n = Object.setPrototypeOf || {
__proto__: []
} instanceof Array && function(e, t) {
e.__proto__ = t;
} || function(e, t) {
for (var o in t) Object.prototype.hasOwnProperty.call(t, o) && (e[o] = t[o]);
})(e, t);
}, function(e, t) {
n(e, t);
function o() {
this.constructor = e;
}
e.prototype = null === t ? Object.create(t) : (o.prototype = t.prototype, new o());
}), i = this && this.__decorate || function(e, t, o, n) {
var a, i = arguments.length, r = i < 3 ? t : null === n ? n = Object.getOwnPropertyDescriptor(t, o) : n;
if ("object" == typeof Reflect && "function" == typeof Reflect.decorate) r = Reflect.decorate(e, t, o, n); else for (var l = e.length - 1; l >= 0; l--) (a = e[l]) && (r = (i < 3 ? a(r) : i > 3 ? a(t, o, r) : a(t, o)) || r);
return i > 3 && r && Object.defineProperty(t, o, r), r;
};
Object.defineProperty(o, "__esModule", {
value: !0
});
var r = e("../../../Game/client/model/LanguageModel"), l = e("../../../Game/fromework/global/Tools"), s = e("../../../Game/client/global/enum/game/UIUtils"), c = cc._decorator, u = c.ccclass, d = c.property, p = function(e) {
a(t, e);
function t() {
var t = null !== e && e.apply(this, arguments) || this;
t.UserHead = null;
t.Name = null;
t.Time = null;
t.Win = null;
t._data = null;
t._index = -1;
return t;
}
t.prototype.onItemInitCallFunc = function(e, t) {
this._data = e;
this._index = t;
this._data.url && "" != this._data.url && s.UIUtils.updateHeadImage(this._data.url, this.UserHead, cc.size(102, 102));
this.Name.string = l.Tools.TStr.ellipsisString(this._data.name, 20);
this.Time.string = l.Tools.TDate.format(1e3 * this._data.time, "MM/dd/yyyy hh:mm:ss");
this.Win.string = r.default.getString("MoneySymbol") + this._data.win_fee + "";
};
t.prototype.onItemEnterCallFunc = function() {
this.node.opacity = 255;
};
t.prototype.onItemExitCallFunc = function() {
this.node.opacity = 0;
};
i([ d(cc.Sprite) ], t.prototype, "UserHead", void 0);
i([ d(cc.Label) ], t.prototype, "Name", void 0);
i([ d(cc.Label) ], t.prototype, "Time", void 0);
i([ d(cc.Label) ], t.prototype, "Win", void 0);
return i([ u ], t);
}(cc.Component);
o.default = p;
cc._RF.pop();
}, {
"../../../Game/client/global/enum/game/UIUtils": "UIUtils",
"../../../Game/client/model/LanguageModel": "LanguageModel",
"../../../Game/fromework/global/Tools": "Tools"
} ],
RBFast: [ function(e, t, o) {
"use strict";
cc._RF.push(t, "8d4b298nZVLL6BHnF7OCiut", "RBFast");
var n, a = this && this.__extends || (n = function(e, t) {
return (n = Object.setPrototypeOf || {
__proto__: []
} instanceof Array && function(e, t) {
e.__proto__ = t;
} || function(e, t) {
for (var o in t) Object.prototype.hasOwnProperty.call(t, o) && (e[o] = t[o]);
})(e, t);
}, function(e, t) {
n(e, t);
function o() {
this.constructor = e;
}
e.prototype = null === t ? Object.create(t) : (o.prototype = t.prototype, new o());
}), i = this && this.__decorate || function(e, t, o, n) {
var a, i = arguments.length, r = i < 3 ? t : null === n ? n = Object.getOwnPropertyDescriptor(t, o) : n;
if ("object" == typeof Reflect && "function" == typeof Reflect.decorate) r = Reflect.decorate(e, t, o, n); else for (var l = e.length - 1; l >= 0; l--) (a = e[l]) && (r = (i < 3 ? a(r) : i > 3 ? a(t, o, r) : a(t, o)) || r);
return i > 3 && r && Object.defineProperty(t, o, r), r;
};
Object.defineProperty(o, "__esModule", {
value: !0
});
var r = e("../../../client/logic/Wallet/WalletHelper"), l = e("../../../Game/client/model/LanguageModel"), s = e("../../../client/model/LobbyModel"), c = e("./RBFastEvent"), u = e("./RBFastModel"), d = e("../../../Game/fromework/helper/EventHelper"), p = e("../../../Game/client/global/enum/game/Event"), h = e("../../../Game/fromework/mvvm/modelView/ViewModel"), f = e("../../../Game/fromework/global/Tools"), _ = e("../../../Game/client/global/enum/game/UIUtils"), m = e("../../../Game/fromework/helper/UIHelper"), y = e("../../../Game/client/global/enum/game/Const"), g = e("../../../Game/fromework/helper/AudioHelper"), v = e("../../../client/global/PopHelper"), C = cc._decorator, b = C.ccclass, I = C.property, E = function(e) {
a(t, e);
function t() {
var t = null !== e && e.apply(this, arguments) || this;
t.ChipSubButton = null;
t.ChipAddButton = null;
t.ChipMaxButton = null;
t.AutoToggle = null;
t.RepeatButton = null;
t.Money = null;
t.BetAmount = null;
t._chipIndex = 0;
t._isLeave = !1;
return t;
}
t.prototype.onEnable = function() {
d.default.Instance.Global.bind(c.RBFastGameEvent.GAME_RECONNECT, this.onReconnect, this);
d.default.Instance.Global.bind(c.RBFastEvent.S2C_SWITCH_ROOM_FAST, this.onSwitchRoom, this);
d.default.Instance.Global.bind(c.RBFastEvent.S2C_DEAL_FAST, this.refreshAutoAndRepeat, this);
d.default.Instance.Global.bind(c.RBFastEvent.S2C_RESET_FAST, this.refreshAutoAndRepeat, this);
d.default.Instance.Global.bind(c.RBFastEvent.S2C_AUTO_PLAY_FAST, this.refreshAutoAndRepeat, this);
d.default.Instance.Global.bind(c.RBFastEvent.S2C_BET_FAST, this.refreshAutoAndRepeat, this);
d.default.Instance.Global.bind(p.GameEvent.S2C_SEND_AVAILABLE_BALANCE, this.refreshMoney, this);
d.default.Instance.Global.bind(c.RBFastEvent.S2C_BET_FAST, this.refreshMoney, this);
d.default.Instance.Global.bind(c.RBFastEvent.S2C_SHOW_FAST, this.refreshMoney, this);
d.default.Instance.Global.bind(c.RBFastEvent.S2C_RESET_FAST, this.refreshMoney, this);
d.default.Instance.Global.bind(c.RBFastEvent.S2C_LEAVE_SINGLE_FAST, this.onLeave, this);
d.default.Instance.Global.bind(c.RBFastOddsEvent.ODDS_BET_BUTTON_CLICK, this.onBetClicked, this);
d.default.Instance.Global.bind(c.RBFastEvent.TABLE_REFRESH_TABLE_FAST, this._joinRoom, this);
d.default.Instance.Global.bind(c.RBFastEvent.TABLE_REPEAT_BET_ERROR, this._onRepeatBetError, this);
};
t.prototype.onDisable = function() {
d.default.Instance.Global.unbind(c.RBFastGameEvent.GAME_RECONNECT, this.onReconnect, this);
d.default.Instance.Global.unbind(c.RBFastEvent.S2C_SWITCH_ROOM_FAST, this.onSwitchRoom, this);
d.default.Instance.Global.unbind(c.RBFastEvent.S2C_DEAL_FAST, this.refreshAutoAndRepeat, this);
d.default.Instance.Global.unbind(c.RBFastEvent.S2C_RESET_FAST, this.refreshAutoAndRepeat, this);
d.default.Instance.Global.unbind(c.RBFastEvent.S2C_AUTO_PLAY_FAST, this.refreshAutoAndRepeat, this);
d.default.Instance.Global.unbind(c.RBFastEvent.S2C_BET_FAST, this.refreshAutoAndRepeat, this);
d.default.Instance.Global.unbind(p.GameEvent.S2C_SEND_AVAILABLE_BALANCE, this.refreshMoney, this);
d.default.Instance.Global.unbind(c.RBFastEvent.S2C_BET_FAST, this.refreshMoney, this);
d.default.Instance.Global.unbind(c.RBFastEvent.S2C_SHOW_FAST, this.refreshMoney, this);
d.default.Instance.Global.unbind(c.RBFastEvent.S2C_RESET_FAST, this.refreshMoney, this);
d.default.Instance.Global.unbind(c.RBFastEvent.S2C_LEAVE_SINGLE_FAST, this.onLeave, this);
d.default.Instance.Global.unbind(c.RBFastOddsEvent.ODDS_BET_BUTTON_CLICK, this.onBetClicked, this);
d.default.Instance.Global.unbind(c.RBFastEvent.TABLE_REFRESH_TABLE_FAST, this._joinRoom, this);
d.default.Instance.Global.unbind(c.RBFastEvent.TABLE_REPEAT_BET_ERROR, this._onRepeatBetError, this);
};
t.prototype.onLoad = function() {
cc.game.on(cc.game.EVENT_SHOW, this._joinRoom, this);
this._chipIndex = parseInt(cc.sys.localStorage.getItem(h.VM.getValue("user.uid") + "RBFastChipIndex"));
(null == this._chipIndex || isNaN(this._chipIndex)) && (this._chipIndex = 0);
this._isLeave = !1;
this._joinRoom();
};
t.prototype.onDestroy = function() {
cc.game.off(cc.game.EVENT_SHOW, this._joinRoom, this);
this._isLeave || u.default.Instance.sendLeave();
u.default.Instance.isOpenWindow = !1;
};
t.prototype._joinRoom = function() {
var e = h.VM.getValue("lobby.roomIDFast");
u.default.Instance.isOpenWindow = !0;
u.default.Instance.sendEnterRoom(e);
};
t.prototype._onRepeatBetError = function(e) {
var t = e.getUserData().bet_total;
r.default.Instance.openRechargeAlert(t, 0);
};
t.prototype.refreshChipButtons = function() {
var e = u.RBFastModel.Instance;
this.ChipSubButton.interactable = 0 != this._chipIndex;
this.ChipAddButton.interactable = this._chipIndex != e.bet_fee_currency.length - 1;
this.ChipMaxButton.interactable = this._chipIndex != e.bet_fee_currency.length - 1;
var t = e.bet_fee_currency[this._chipIndex];
this.BetAmount.string = f.Tools.TNumber.num2single(t) + "";
};
t.prototype.refreshAutoAndRepeat = function() {
var e = u.RBFastModel.Instance;
this.AutoToggle.isChecked = e.userData.auto;
this.RepeatButton.interactable = e.userData.repeat;
_.UIUtils.setGray(this.RepeatButton.node, !e.userData.repeat, !0);
};
t.prototype.refreshMoney = function() {
var e = u.RBFastModel.Instance;
this.Money.string = f.Tools.TNumber.numFixed(e.total_fee, 1) + "";
};
t.prototype.onReconnect = function() {
this.refreshChipButtons();
this.refreshAutoAndRepeat();
this.refreshMoney();
};
t.prototype.onSwitchRoom = function(e) {
var t = e.getUserData();
u.default.Instance.sendEnterRoom(t);
};
t.prototype.onLeave = function() {
u.default.Instance.isOpenWindow = !1;
h.VM.setValue("lobby.roomIDFast", 0);
if (this && this.node && this.node.isValid) {
m.default.Instance.removeMaskLayer(this.node, !0);
"Lobby" == cc.director.getScene().name && d.default.Instance.Global.emit(p.TipsEvent.TIPS_SYSTEM_WITHDRAW_ALERT);
}
};
t.prototype.onBetClicked = function(e) {
var t = u.RBFastModel.Instance, o = e.getUserData().index, n = f.Tools.TNumber.num2single(t.bet_fee_currency[this._chipIndex]), a = s.default.Instance.getGamePlay(t.roomData.rtype), i = s.default.Instance.getPlaySwitch(a.cls);
if (i && (!i || 3 != i.s) || t.checkRecharge()) if (2 == t.roomData.state) if (t.total_fee >= n) if (t.getBetAmount() + n <= t.bet_limit) {
cc.sys.localStorage.setItem(h.VM.getValue("user.uid") + "RBFastChipIndex", String(this._chipIndex));
u.default.Instance.sendBet(n, o);
} else {
var c = f.Tools.TStr.replaceAll(l.default.getString("COMPOSITE_BET_MAX"), "%{num}", t.bet_limit);
v.PopHelper.Instance.showTips(c);
} else r.default.Instance.openRechargeAlert(n, 0); else {
g.default.Instance.playBundleEffect(y.BundleSoundPath.composite_odds_stop);
v.PopHelper.Instance.showTips(l.default.getString("COMPOSITE_TIPS_WAIT"));
} else r.default.Instance.openRechargeAlert(100, 0, !1);
};
t.prototype.onSubClicked = function() {
u.RBFastModel.Instance;
if (0 != this._chipIndex) {
this._chipIndex--;
this.refreshChipButtons();
}
};
t.prototype.onAddClicked = function() {
var e = u.RBFastModel.Instance;
if (this._chipIndex != e.bet_fee_currency.length - 1) {
this._chipIndex++;
this.refreshChipButtons();
}
};
t.prototype.onMaxClicked = function() {
var e = u.RBFastModel.Instance;
this._chipIndex = e.bet_fee_currency.length - 1;
this.refreshChipButtons();
};
t.prototype.onAutoClicked = function() {
u.default.Instance.sendAutoPlay();
};
t.prototype.onRepeatClicked = function() {
var e = u.RBFastModel.Instance, t = (f.Tools.TNumber.num2single(e.bet_fee_currency[this._chipIndex]), 
s.default.Instance.getGamePlay(e.roomData.rtype)), o = s.default.Instance.getPlaySwitch(t.cls);
if (o && (!o || 3 != o.s) || e.checkRecharge()) {
if (e.userData.repeat) if (2 == e.roomData.state) u.default.Instance.sendRepeatBet(); else {
g.default.Instance.playBundleEffect(y.BundleSoundPath.composite_odds_stop);
v.PopHelper.Instance.showTips(l.default.getString("COMPOSITE_TIPS_WAIT"));
}
} else r.default.Instance.openRechargeAlert(100, 0, !1);
};
t.prototype.onHelpClicked = function() {
m.default.Instance.addBundleMaskLayer(y.BundleUIPath.RBFastHelp, null, v.PopZindex.RBFast + 1);
};
t.prototype.onRecordClicked = function() {
m.default.Instance.addBundleMaskLayer(y.BundleUIPath.RBFastRecordAlert, null, v.PopZindex.RBFast + 1);
};
t.prototype.onCloseClicked = function() {
this._isLeave = !0;
u.default.Instance.sendLeave();
};
i([ I(cc.Button) ], t.prototype, "ChipSubButton", void 0);
i([ I(cc.Button) ], t.prototype, "ChipAddButton", void 0);
i([ I(cc.Button) ], t.prototype, "ChipMaxButton", void 0);
i([ I(cc.Toggle) ], t.prototype, "AutoToggle", void 0);
i([ I(cc.Button) ], t.prototype, "RepeatButton", void 0);
i([ I(cc.Label) ], t.prototype, "Money", void 0);
i([ I(cc.Label) ], t.prototype, "BetAmount", void 0);
return i([ b ], t);
}(cc.Component);
o.default = E;
cc._RF.pop();
}, {
"../../../Game/client/global/enum/game/Const": "Const",
"../../../Game/client/global/enum/game/Event": "Event",
"../../../Game/client/global/enum/game/UIUtils": "UIUtils",
"../../../Game/client/model/LanguageModel": "LanguageModel",
"../../../Game/fromework/global/Tools": "Tools",
"../../../Game/fromework/helper/AudioHelper": "AudioHelper",
"../../../Game/fromework/helper/EventHelper": "EventHelper",
"../../../Game/fromework/helper/UIHelper": "UIHelper",
"../../../Game/fromework/mvvm/modelView/ViewModel": "ViewModel",
"../../../client/global/PopHelper": "PopHelper",
"../../../client/logic/Wallet/WalletHelper": "WalletHelper",
"../../../client/model/LobbyModel": "LobbyModel",
"./RBFastEvent": "RBFastEvent",
"./RBFastModel": "RBFastModel"
} ],
RBHelp: [ function(e, t, o) {
"use strict";
cc._RF.push(t, "fd6e2mLiehFk7SqcbIbjYOo", "RBHelp");
var n, a = this && this.__extends || (n = function(e, t) {
return (n = Object.setPrototypeOf || {
__proto__: []
} instanceof Array && function(e, t) {
e.__proto__ = t;
} || function(e, t) {
for (var o in t) Object.prototype.hasOwnProperty.call(t, o) && (e[o] = t[o]);
})(e, t);
}, function(e, t) {
n(e, t);
function o() {
this.constructor = e;
}
e.prototype = null === t ? Object.create(t) : (o.prototype = t.prototype, new o());
}), i = this && this.__decorate || function(e, t, o, n) {
var a, i = arguments.length, r = i < 3 ? t : null === n ? n = Object.getOwnPropertyDescriptor(t, o) : n;
if ("object" == typeof Reflect && "function" == typeof Reflect.decorate) r = Reflect.decorate(e, t, o, n); else for (var l = e.length - 1; l >= 0; l--) (a = e[l]) && (r = (i < 3 ? a(r) : i > 3 ? a(t, o, r) : a(t, o)) || r);
return i > 3 && r && Object.defineProperty(t, o, r), r;
};
Object.defineProperty(o, "__esModule", {
value: !0
});
var r = e("../../Common/Utils/CompositeUtil"), l = cc._decorator, s = l.ccclass, c = l.property, u = function(e) {
a(t, e);
function t() {
var t = null !== e && e.apply(this, arguments) || this;
t.RateAry = [];
t.WinAry = [];
return t;
}
t.prototype.onLoad = function() {
r.default.Game.Model;
};
i([ c([ cc.Label ]) ], t.prototype, "RateAry", void 0);
i([ c([ cc.RichText ]) ], t.prototype, "WinAry", void 0);
return i([ s ], t);
}(cc.Component);
o.default = u;
cc._RF.pop();
}, {
"../../Common/Utils/CompositeUtil": "CompositeUtil"
} ],
RBModel: [ function(e, t, o) {
"use strict";
cc._RF.push(t, "ee202iQDUpLyZPNR4DRbLan", "RBModel");
var n, a = this && this.__extends || (n = function(e, t) {
return (n = Object.setPrototypeOf || {
__proto__: []
} instanceof Array && function(e, t) {
e.__proto__ = t;
} || function(e, t) {
for (var o in t) Object.prototype.hasOwnProperty.call(t, o) && (e[o] = t[o]);
})(e, t);
}, function(e, t) {
n(e, t);
function o() {
this.constructor = e;
}
e.prototype = null === t ? Object.create(t) : (o.prototype = t.prototype, new o());
});
Object.defineProperty(o, "__esModule", {
value: !0
});
o.RBModel = void 0;
var i = e("../../../Game/client/global/enum/game/Event"), r = e("../../../Game/client/global/enum/game/Game"), l = e("../../../Game/client/global/enum/net/C2S"), s = e("../../../Game/client/global/enum/net/S2C"), c = e("../../../Game/fromework/global/Tools"), u = e("../../../Game/fromework/helper/EventHelper"), d = e("../../../Game/fromework/mvvm/modelView/ViewModel"), p = e("../../../client/logic/game/HearBeat"), h = e("../../../client/model/ErrorModel"), f = e("../../../fromework/helper/NetHelper"), _ = e("../../Common/Utils/CompositeProxy"), m = e("./RBStruct"), y = function(e) {
a(t, e);
function t() {
var t = null !== e && e.apply(this, arguments) || this;
t.declearHistory = new m.RBStruct.DeclearHistory();
t.bet_fee_currency = [];
t.bet_options = [];
return t;
}
Object.defineProperty(t, "Instance", {
get: function() {
t._instance || (t._instance = new t());
return t._instance;
},
enumerable: !1,
configurable: !0
});
t.prototype.clear = function() {
null != t._instance && (t._instance = null);
};
t.prototype.getCompensationCash = function() {
for (var e = new Map(), t = 0; t < this.win_options.length; t++) {
var o = this.roomBetRecord[this.win_options[t]];
if (0 != o.amount) {
var n = this.bet_options[this.win_options[t]];
e.set(this.win_options[t], o.amount * (n.x - 1));
}
}
return e;
};
t.prototype.getWinFee = function(e) {
var t = new Map();
if (this.declearData.user_data.has(String(e))) for (var o = this.declearData.user_data.get(String(e)), n = 0; n < o.bet_record.length; n++) {
var a = o.bet_record[n];
if (0 != a.amount) {
var i = t.has(n) ? t.get(n) : 0, r = this.bet_options[n];
t.set(n, i + a.amount * r.x);
}
}
return t;
};
t._instance = null;
return t;
}(_.CompositeModel);
o.RBModel = y;
var g = function(e) {
a(t, e);
function t() {
return null !== e && e.apply(this, arguments) || this;
}
Object.defineProperty(t, "Instance", {
get: function() {
t._instance || (t._instance = new t());
return t._instance;
},
enumerable: !1,
configurable: !0
});
t.prototype.Init = function() {
u.default.Instance.Net.bind(s.S2C.GAME.ROOM_ENTER_ROOM, this._onEnterRoom, this);
u.default.Instance.Net.bind(s.S2C.GAME.ROOM_SWITCH_ROOM, this._onSwitchRoom, this);
u.default.Instance.Net.bind(s.S2C.GAME.ROOM_DEAL, this._onDeal, this);
u.default.Instance.Net.bind(s.S2C.GAME.ROOM_START_BET, this._onStartBet, this);
u.default.Instance.Net.bind(s.S2C.GAME.ROOM_BET, this._onBet, this);
u.default.Instance.Net.bind(s.S2C.GAME.ROOM_BET_BATCH, this._onBetBatch, this);
u.default.Instance.Net.bind(s.S2C.GAME.ROOM_STOP_BET, this._onStopBet, this);
u.default.Instance.Net.bind(s.S2C.GAME.ROOM_SHOW, this._onShow, this);
u.default.Instance.Net.bind(s.S2C.GAME.ROOM_RESET_ROOM, this._onResetRoom, this);
u.default.Instance.Net.bind(s.S2C.GAME.ROOM_INTERACT, this._onInteract, this);
u.default.Instance.Net.bind(s.S2C.GAME.ROOM_RANK, this._onRank, this);
u.default.Instance.Net.bind(s.S2C.GAME.ROOM_LEAVE, this._onLeave, this);
u.default.Instance.Net.bind(s.S2C.GAME.ROOM_LEAVE_SINGLE, this._onLeaveSingle, this);
u.default.Instance.Net.bind(s.S2C.GAME.ROOM_DISMISS, this._onDismiss, this);
u.default.Instance.Net.bind(s.S2C.GAME.ROOM_SEND_AVAILABLE_BALANCE, this._onBalanceRefresh, this);
u.default.Instance.Global.bind(f.NetState.NET_WEBSOCKET_CONNECT_OPEN, this._onWsContented, this);
};
t.prototype.destory = function() {
u.default.Instance.Net.unbind(s.S2C.GAME.ROOM_ENTER_ROOM, this._onEnterRoom, this);
u.default.Instance.Net.unbind(s.S2C.GAME.ROOM_SWITCH_ROOM, this._onSwitchRoom, this);
u.default.Instance.Net.unbind(s.S2C.GAME.ROOM_DEAL, this._onDeal, this);
u.default.Instance.Net.unbind(s.S2C.GAME.ROOM_START_BET, this._onStartBet, this);
u.default.Instance.Net.unbind(s.S2C.GAME.ROOM_BET, this._onBet, this);
u.default.Instance.Net.unbind(s.S2C.GAME.ROOM_BET_BATCH, this._onBetBatch, this);
u.default.Instance.Net.unbind(s.S2C.GAME.ROOM_STOP_BET, this._onStopBet, this);
u.default.Instance.Net.unbind(s.S2C.GAME.ROOM_SHOW, this._onShow, this);
u.default.Instance.Net.unbind(s.S2C.GAME.ROOM_RESET_ROOM, this._onResetRoom, this);
u.default.Instance.Net.unbind(s.S2C.GAME.ROOM_INTERACT, this._onInteract, this);
u.default.Instance.Net.unbind(s.S2C.GAME.ROOM_RANK, this._onRank, this);
u.default.Instance.Net.unbind(s.S2C.GAME.ROOM_LEAVE, this._onLeave, this);
u.default.Instance.Net.unbind(s.S2C.GAME.ROOM_LEAVE_SINGLE, this._onLeaveSingle, this);
u.default.Instance.Net.unbind(s.S2C.GAME.ROOM_DISMISS, this._onDismiss, this);
u.default.Instance.Net.unbind(s.S2C.GAME.ROOM_SEND_AVAILABLE_BALANCE, this._onBalanceRefresh, this);
u.default.Instance.Global.unbind(f.NetState.NET_WEBSOCKET_CONNECT_OPEN, this._onWsContented, this);
};
t.prototype.clear = function() {};
t.prototype._onWsContented = function() {
p.default.Instance.begin();
var e = d.VM.getValue("lobby.roomID");
0 != e && this.sendEnterRoom(e);
};
Object.defineProperty(t.prototype, "roomID", {
get: function() {
return d.VM.getValue("lobby.roomID");
},
enumerable: !1,
configurable: !0
});
t.prototype.checkRoomID = function(e) {
return d.VM.getValue("lobby.roomID") == e;
};
t.prototype.checkRoomType = function(e) {
var t = e.split("_"), o = -1;
null != t && null != t[0] && (o = parseInt(t[0]));
return o == r.GameEnum.PlayType.GAME_REDBLACK;
};
t.prototype._onEnterRoom = function(t) {
var o = t.getUserData();
if (this.checkRoomID(o.rid)) {
var n = y.Instance;
if (null != o.user_data && o.uid == this.uid) {
n.bet_fee_currency = o.bet_fee_currency;
n.bet_options = o.bet_options;
n.declearHistory.refresh(o.declear_history);
}
e.prototype._onEnterRoom.call(this, o, n);
}
};
t.prototype._onSwitchRoom = function(e) {
var t = e.getUserData();
if (this.checkRoomType(t.room_type)) {
d.VM.getValue("lobby.roomID") != t.r && d.VM.setValue("lobby.roomID", parseInt(t.r));
u.default.Instance.Global.emit(i.GameEvent.S2C_SWITCH_ROOM, t.r);
}
};
t.prototype._onDeal = function(t) {
var o = t.getUserData();
if (this.checkRoomID(o.rid)) {
var n = y.Instance;
e.prototype._onDeal.call(this, o, n);
}
};
t.prototype._onStartBet = function(t) {
var o = t.getUserData();
if (this.checkRoomID(o.rid)) {
var n = y.Instance;
e.prototype._onStartBet.call(this, o, n);
}
};
t.prototype._onBet = function(t) {
var o = t.getUserData();
if (this.checkRoomID(o.rid)) {
var n = y.Instance;
e.prototype._onBet.call(this, o, n);
}
};
t.prototype._onBetBatch = function(t) {
var o = t.getUserData();
if (this.checkRoomID(o.rid)) {
var n = y.Instance;
e.prototype._onBetBatch.call(this, o, n);
}
};
t.prototype._onStopBet = function(t) {
var o = t.getUserData();
if (this.checkRoomID(o.rid)) {
var n = y.Instance;
e.prototype._onStopBet.call(this, o, n);
}
};
t.prototype._onShow = function(t) {
var o = t.getUserData();
if (this.checkRoomID(o.rid)) {
var n = y.Instance, a = new m.RBStruct.HistoryData({
d: [ o.room_data.show_card[0] ]
});
n.declearHistory.addHistory(a);
e.prototype._onShow.call(this, o, n);
}
};
t.prototype._onResetRoom = function(t) {
var o = t.getUserData();
if (this.checkRoomID(o.rid)) {
var n = y.Instance;
e.prototype._onResetRoom.call(this, o, n);
}
};
t.prototype._onInteract = function(t) {
var o = t.getUserData();
if (this.checkRoomID(o.rid)) {
var n = y.Instance;
e.prototype._onInteract.call(this, o, n);
}
};
t.prototype._onRank = function(t) {
var o = t.getUserData();
if (this.checkRoomID(o.rid)) {
var n = y.Instance;
e.prototype._onRank.call(this, o, n);
}
};
t.prototype._onLeave = function(t) {
var o = t.getUserData();
if (this.checkRoomID(o.rid)) {
var n = y.Instance;
e.prototype._onLeave.call(this, o, n);
}
};
t.prototype._onLeaveSingle = function(t) {
var o = t.getUserData();
if (this.checkRoomID(o.rid) || 0 == d.VM.getValue("lobby.roomID")) {
var n = y.Instance;
e.prototype._onLeaveSingle.call(this, o, n);
}
};
t.prototype._onDismiss = function(t) {
var o = t.getUserData();
if (this.checkRoomID(o.rid)) {
var n = y.Instance;
e.prototype._onDismiss.call(this, o, n);
}
};
t.prototype._onBalanceRefresh = function(t) {
var o = t.getUserData();
if (!this.checkRoomID(o.rid)) {
var n = y.Instance;
e.prototype._onBalanceRefresh.call(this, o, n);
}
};
t.prototype.sendEnterRoom = function(e, t) {
void 0 === t && (t = !0);
var o = f.default.Instance.makeMsg(l.C2S.ROOM_ENTER_ROOM, {
u: this.uid,
t: this.token,
r: e,
is_open: t
});
f.default.Instance.send(o);
};
t.prototype.sendBet = function(e, t) {
var o = c.Tools.TNumber.num2thousand(e);
h.default.Instance.CompositeBetNum = e;
var n = f.default.Instance.makeMsg(l.C2S.ROOM_BET, {
u: this.uid,
t: this.token,
r: this.roomID,
fee: o,
option: t
});
f.default.Instance.send(n);
};
t.prototype.sendInteract = function(e, t, o) {
var n;
n = o ? {
u: this.uid,
t: this.token,
r: this.roomID,
to_u: e,
opt_type: t,
opt_val: o
} : {
u: this.uid,
t: this.token,
r: this.roomID,
to_u: e,
opt_type: t
};
var a = f.default.Instance.makeMsg(l.C2S.ROOM_INTERACT, n);
f.default.Instance.send(a);
};
t.prototype.sendRank = function(e, t) {
var o = f.default.Instance.makeMsg(l.C2S.ROOM_RANK, {
u: this.uid,
t: this.token,
r: this.roomID,
page: e,
count: t
});
f.default.Instance.send(o);
};
t.prototype.sendLeave = function() {
var e = f.default.Instance.makeMsg(l.C2S.ROOM_LEAVE, {
u: this.uid,
t: this.token,
r: this.roomID
});
f.default.Instance.send(e);
};
t._instance = null;
return t;
}(_.CompositeProxy);
o.default = g;
cc._RF.pop();
}, {
"../../../Game/client/global/enum/game/Event": "Event",
"../../../Game/client/global/enum/game/Game": "Game",
"../../../Game/client/global/enum/net/C2S": "C2S",
"../../../Game/client/global/enum/net/S2C": "S2C",
"../../../Game/fromework/global/Tools": "Tools",
"../../../Game/fromework/helper/EventHelper": "EventHelper",
"../../../Game/fromework/mvvm/modelView/ViewModel": "ViewModel",
"../../../client/logic/game/HearBeat": "HearBeat",
"../../../client/model/ErrorModel": "ErrorModel",
"../../../fromework/helper/NetHelper": "NetHelper",
"../../Common/Utils/CompositeProxy": "CompositeProxy",
"./RBStruct": "RBStruct"
} ],
RBRecordSmall: [ function(e, t, o) {
"use strict";
cc._RF.push(t, "43695d/C0tFWpTwOrrwDQ8a", "RBRecordSmall");
var n, a = this && this.__extends || (n = function(e, t) {
return (n = Object.setPrototypeOf || {
__proto__: []
} instanceof Array && function(e, t) {
e.__proto__ = t;
} || function(e, t) {
for (var o in t) Object.prototype.hasOwnProperty.call(t, o) && (e[o] = t[o]);
})(e, t);
}, function(e, t) {
n(e, t);
function o() {
this.constructor = e;
}
e.prototype = null === t ? Object.create(t) : (o.prototype = t.prototype, new o());
}), i = this && this.__decorate || function(e, t, o, n) {
var a, i = arguments.length, r = i < 3 ? t : null === n ? n = Object.getOwnPropertyDescriptor(t, o) : n;
if ("object" == typeof Reflect && "function" == typeof Reflect.decorate) r = Reflect.decorate(e, t, o, n); else for (var l = e.length - 1; l >= 0; l--) (a = e[l]) && (r = (i < 3 ? a(r) : i > 3 ? a(t, o, r) : a(t, o)) || r);
return i > 3 && r && Object.defineProperty(t, o, r), r;
};
Object.defineProperty(o, "__esModule", {
value: !0
});
var r = e("../../../Game/client/global/enum/game/Event"), l = e("../../../Game/client/global/enum/game/Game"), s = e("../../../Game/fromework/global/Tools"), c = e("../../../Game/fromework/helper/EventHelper"), u = e("../../Common/Utils/CompositeUtil"), d = cc._decorator, p = d.ccclass, h = d.property, f = function(e) {
a(t, e);
function t() {
var t = null !== e && e.apply(this, arguments) || this;
t.Title = null;
t.Red = null;
t.Black = null;
t.Heart = null;
t.Club = null;
t.Diamond = null;
t.Spade = null;
t.Joker = null;
t.NUM_A_6 = null;
t.NUM_7_10 = null;
t.NUM_JQK = null;
t.TopRecordParent = null;
t.TopRecordItem = null;
t.Color_Red = null;
t.Color_Black = null;
t.Color_Back_Normal = null;
t.Color_Back_Joker = null;
t.Frame_Patterns = [];
t.MaxCount = 18;
return t;
}
t.prototype.onEnable = function() {
c.default.Instance.Global.bind(r.GameEvent.S2C_ENTER_ROOM, this.refreshTopRecord, this);
c.default.Instance.Global.bind(r.GameEvent.S2C_RESET, this.refreshTopRecord, this);
};
t.prototype.onDisable = function() {
c.default.Instance.Global.unbind(r.GameEvent.S2C_ENTER_ROOM, this.refreshTopRecord, this);
c.default.Instance.Global.unbind(r.GameEvent.S2C_RESET, this.refreshTopRecord, this);
};
t.prototype.onLoad = function() {
this.refreshTopRecord();
};
t.prototype.refreshTop = function() {
var e = u.default.Game.Model.declearHistory.getWinCount();
this.Title.string = s.Tools.TStr.replaceAll("Nearly %{num} rounds:", "%{num}", e.total);
this.Red.string = e.red + "";
this.Black.string = e.black + "";
this.Heart.string = e.heart + "";
this.Club.string = e.club + "";
this.Diamond.string = e.diamond + "";
this.Spade.string = e.spade + "";
this.Joker.string = e.joker + "";
this.NUM_A_6.string = e.num_a_6 + "";
this.NUM_7_10.string = e.num_7_10 + "";
this.NUM_JQK.string = e.num_jqk + "";
};
t.prototype.refreshTopRecord = function() {
var e = u.default.Game.Model;
this.refreshTop();
this.TopRecordParent.destroyAllChildren();
for (var t = e.declearHistory.getSimpleHistory(this.MaxCount), o = 0; o < t.length; o++) {
var n = t[o], a = n.getPartten(), i = n.isJoker(), r = a == l.GameEnum.Pattern.Heart || a == l.GameEnum.Pattern.Diamond, s = cc.instantiate(this.TopRecordItem);
s.active = !0;
s.setPosition(cc.Vec2.ZERO);
s.parent = this.TopRecordParent;
s.getChildByName("Background").color = i ? this.Color_Back_Joker : this.Color_Back_Normal;
var c = s.getChildByName("Icon").getComponent(cc.Sprite);
c.spriteFrame = this.Frame_Patterns[n.getPartten()];
var d = s.getChildByName("Points");
d.color = r ? this.Color_Red : this.Color_Black;
d.getComponent(cc.Label).string = n.getFigureString() + "";
var p = s.getChildByName("Joker");
c.node.active = !i;
d.active = !i;
p.active = i;
}
};
i([ h(cc.Label) ], t.prototype, "Title", void 0);
i([ h(cc.Label) ], t.prototype, "Red", void 0);
i([ h(cc.Label) ], t.prototype, "Black", void 0);
i([ h(cc.Label) ], t.prototype, "Heart", void 0);
i([ h(cc.Label) ], t.prototype, "Club", void 0);
i([ h(cc.Label) ], t.prototype, "Diamond", void 0);
i([ h(cc.Label) ], t.prototype, "Spade", void 0);
i([ h(cc.Label) ], t.prototype, "Joker", void 0);
i([ h(cc.Label) ], t.prototype, "NUM_A_6", void 0);
i([ h(cc.Label) ], t.prototype, "NUM_7_10", void 0);
i([ h(cc.Label) ], t.prototype, "NUM_JQK", void 0);
i([ h(cc.Node) ], t.prototype, "TopRecordParent", void 0);
i([ h(cc.Node) ], t.prototype, "TopRecordItem", void 0);
i([ h(cc.Color) ], t.prototype, "Color_Red", void 0);
i([ h(cc.Color) ], t.prototype, "Color_Black", void 0);
i([ h(cc.Color) ], t.prototype, "Color_Back_Normal", void 0);
i([ h(cc.Color) ], t.prototype, "Color_Back_Joker", void 0);
i([ h([ cc.SpriteFrame ]) ], t.prototype, "Frame_Patterns", void 0);
i([ h ], t.prototype, "MaxCount", void 0);
return i([ p ], t);
}(cc.Component);
o.default = f;
cc._RF.pop();
}, {
"../../../Game/client/global/enum/game/Event": "Event",
"../../../Game/client/global/enum/game/Game": "Game",
"../../../Game/fromework/global/Tools": "Tools",
"../../../Game/fromework/helper/EventHelper": "EventHelper",
"../../Common/Utils/CompositeUtil": "CompositeUtil"
} ],
RBRecord: [ function(e, t, o) {
"use strict";
cc._RF.push(t, "e066aFpEPlAl6DHt+eNphJn", "RBRecord");
var n, a = this && this.__extends || (n = function(e, t) {
return (n = Object.setPrototypeOf || {
__proto__: []
} instanceof Array && function(e, t) {
e.__proto__ = t;
} || function(e, t) {
for (var o in t) Object.prototype.hasOwnProperty.call(t, o) && (e[o] = t[o]);
})(e, t);
}, function(e, t) {
n(e, t);
function o() {
this.constructor = e;
}
e.prototype = null === t ? Object.create(t) : (o.prototype = t.prototype, new o());
}), i = this && this.__decorate || function(e, t, o, n) {
var a, i = arguments.length, r = i < 3 ? t : null === n ? n = Object.getOwnPropertyDescriptor(t, o) : n;
if ("object" == typeof Reflect && "function" == typeof Reflect.decorate) r = Reflect.decorate(e, t, o, n); else for (var l = e.length - 1; l >= 0; l--) (a = e[l]) && (r = (i < 3 ? a(r) : i > 3 ? a(t, o, r) : a(t, o)) || r);
return i > 3 && r && Object.defineProperty(t, o, r), r;
};
Object.defineProperty(o, "__esModule", {
value: !0
});
var r = e("../../../Game/client/global/enum/game/Game"), l = e("../../../Game/fromework/helper/UIHelper"), s = e("../../Common/Utils/CompositeUtil"), c = cc._decorator, u = c.ccclass, d = c.property, p = function(e) {
a(t, e);
function t() {
var t = null !== e && e.apply(this, arguments) || this;
t.BottomContent = null;
t.BottomRecordParent = null;
t.BottomRecordItem = null;
t.Color_Red = null;
t.Color_Black = null;
t.Color_Back_Normal = null;
t.Color_Back_Joker = null;
t.Frame_Patterns = [];
return t;
}
t.prototype.onLoad = function() {
this.refreshBottomRecord();
};
t.prototype.refreshBottomRecord = function() {
var e = s.default.Game.Model;
this.BottomRecordParent.destroyAllChildren();
for (var t = e.declearHistory.getComplexHistory(18), o = 0, n = 0; n < t.length; n++) {
var a = t[n], i = 27 + 54 * n;
a.length > o && (o = a.length);
for (var l = 0; l < a.length; l++) {
var c = a[l], u = c.getPartten(), d = c.isJoker(), p = u == r.GameEnum.Pattern.Heart || u == r.GameEnum.Pattern.Diamond, h = -(27 + 54 * l), f = cc.instantiate(this.BottomRecordItem);
f.active = !0;
f.setPosition(cc.v2(i, h));
f.parent = this.BottomRecordParent;
f.getChildByName("Background").color = d ? this.Color_Back_Joker : this.Color_Back_Normal;
var _ = f.getChildByName("Icon").getComponent(cc.Sprite);
_.spriteFrame = this.Frame_Patterns[c.getPartten()];
var m = f.getChildByName("Points");
m.color = p ? this.Color_Red : this.Color_Black;
m.getComponent(cc.Label).string = c.getFigureString() + "";
var y = f.getChildByName("Second");
y.color = p ? this.Color_Red : this.Color_Black;
y.getComponent(cc.Label).string = c.getType();
var g = f.getChildByName("Joker");
_.node.active = !d;
m.active = !d;
y.active = !d;
g.active = d;
}
}
this.BottomContent.height = 54 * o;
};
t.prototype.onCloseClicked = function() {
l.default.Instance.removeMaskLayer(this.node, !0);
};
i([ d(cc.Node) ], t.prototype, "BottomContent", void 0);
i([ d(cc.Node) ], t.prototype, "BottomRecordParent", void 0);
i([ d(cc.Node) ], t.prototype, "BottomRecordItem", void 0);
i([ d(cc.Color) ], t.prototype, "Color_Red", void 0);
i([ d(cc.Color) ], t.prototype, "Color_Black", void 0);
i([ d(cc.Color) ], t.prototype, "Color_Back_Normal", void 0);
i([ d(cc.Color) ], t.prototype, "Color_Back_Joker", void 0);
i([ d([ cc.SpriteFrame ]) ], t.prototype, "Frame_Patterns", void 0);
return i([ u ], t);
}(cc.Component);
o.default = p;
cc._RF.pop();
}, {
"../../../Game/client/global/enum/game/Game": "Game",
"../../../Game/fromework/helper/UIHelper": "UIHelper",
"../../Common/Utils/CompositeUtil": "CompositeUtil"
} ],
RBStruct: [ function(e, t, o) {
"use strict";
cc._RF.push(t, "17b98LS4s5NqKe4MBhk9LF3", "RBStruct");
Object.defineProperty(o, "__esModule", {
value: !0
});
o.RBStruct = void 0;
var n = e("../../../Game/client/global/enum/game/Game");
(function(e) {
var t = function() {
function e(e) {
this.idx16 = 0;
e && this.refresh(e);
}
e.prototype.refresh = function(e) {
this.idx16 = e.d[0];
};
e.prototype.getPartten = function() {
return 65 == this.idx16 || 66 == this.idx16 ? n.GameEnum.Pattern.BigJoker : Math.floor(this.idx16 / 16);
};
e.prototype.getFigure = function() {
return this.idx16 % 16;
};
e.prototype.getFigureString = function() {
var e = this.idx16 % 16;
return 1 == e ? "A" : 11 == e ? "J" : 12 == e ? "Q" : 13 == e ? "K" : e + "";
};
e.prototype.isJoker = function() {
return 65 == this.idx16 || 66 == this.idx16;
};
e.prototype.getType = function() {
var e = this.getFigure();
return e >= 1 && e <= 6 ? "A-6" : e >= 7 && e <= 10 ? "7-10" : "JQK";
};
return e;
}();
e.HistoryData = t;
var o = function() {
function e(e) {
this.historyArray = [];
e && this.refresh(e);
}
e.prototype.refresh = function(e) {
var o = this;
this.historyArray.splice(0);
e.forEach(function(e) {
var n = new t(e);
o.historyArray.push(n);
});
};
e.prototype.getWinCount = function() {
var e = 0, t = 0, o = 0, a = 0, i = 0, r = 0, l = 0, s = 0, c = 0, u = 0, d = 0;
this.historyArray.forEach(function(p) {
var h = p.getPartten(), f = p.getFigure();
if (p.isJoker()) s++; else {
if (h == n.GameEnum.Pattern.Diamond) {
t++;
r++;
} else if (h == n.GameEnum.Pattern.Club) {
o++;
i++;
} else if (h == n.GameEnum.Pattern.Heart) {
t++;
a++;
} else if (h == n.GameEnum.Pattern.Spade) {
o++;
l++;
}
f >= 1 && f <= 6 ? c++ : f >= 1 && f <= 6 ? u++ : f >= 11 && f <= 13 && d++;
}
e++;
});
return {
total: e,
red: t,
black: o,
heart: a,
club: i,
diamond: r,
spade: l,
joker: s,
num_a_6: c,
num_7_10: u,
num_jqk: d
};
};
e.prototype.addHistory = function(e) {
100 == this.historyArray.length && this.historyArray.shift();
this.historyArray.push(e);
};
e.prototype.getSimpleHistory = function(e) {
for (var t = [], o = this.historyArray.length - 1; o >= 0; o--) {
var n = this.historyArray[o];
t.unshift(n);
if (t.length == e) break;
}
return t;
};
e.prototype.getComplexHistory = function(e) {
for (var t = [], o = -1, n = this.historyArray.length - 1; n >= 0; n--) {
var a = this.historyArray[n];
if (o != a.getPartten()) {
if (t.length == e) break;
o = a.getPartten();
t.unshift([]);
}
t[0].length != e && t[0].unshift(a);
}
return t;
};
return e;
}();
e.DeclearHistory = o;
})(o.RBStruct || (o.RBStruct = {}));
cc._RF.pop();
}, {
"../../../Game/client/global/enum/game/Game": "Game"
} ],
RS1LotteryHelp: [ function(e, t, o) {
"use strict";
cc._RF.push(t, "de2a6ZXAnlL17x/5Oj2TZ6A", "RS1LotteryHelp");
var n, a = this && this.__extends || (n = function(e, t) {
return (n = Object.setPrototypeOf || {
__proto__: []
} instanceof Array && function(e, t) {
e.__proto__ = t;
} || function(e, t) {
for (var o in t) Object.prototype.hasOwnProperty.call(t, o) && (e[o] = t[o]);
})(e, t);
}, function(e, t) {
n(e, t);
function o() {
this.constructor = e;
}
e.prototype = null === t ? Object.create(t) : (o.prototype = t.prototype, new o());
}), i = this && this.__decorate || function(e, t, o, n) {
var a, i = arguments.length, r = i < 3 ? t : null === n ? n = Object.getOwnPropertyDescriptor(t, o) : n;
if ("object" == typeof Reflect && "function" == typeof Reflect.decorate) r = Reflect.decorate(e, t, o, n); else for (var l = e.length - 1; l >= 0; l--) (a = e[l]) && (r = (i < 3 ? a(r) : i > 3 ? a(t, o, r) : a(t, o)) || r);
return i > 3 && r && Object.defineProperty(t, o, r), r;
};
Object.defineProperty(o, "__esModule", {
value: !0
});
var r = cc._decorator, l = r.ccclass, s = (r.property, r.menu, function(e) {
a(t, e);
function t() {
return null !== e && e.apply(this, arguments) || this;
}
t.prototype.onEnable = function() {};
t.prototype.onDisable = function() {};
t.prototype.onLoad = function() {};
t.prototype.onDestroy = function() {};
t.prototype.start = function() {};
t.prototype.onClickClose = function() {};
return i([ l ], t);
}(cc.Component));
o.default = s;
cc._RF.pop();
}, {} ],
RS1LotteryRecord: [ function(e, t, o) {
"use strict";
cc._RF.push(t, "d765f9JbkdHHoH6xqlIip4O", "RS1LotteryRecord");
var n, a = this && this.__extends || (n = function(e, t) {
return (n = Object.setPrototypeOf || {
__proto__: []
} instanceof Array && function(e, t) {
e.__proto__ = t;
} || function(e, t) {
for (var o in t) Object.prototype.hasOwnProperty.call(t, o) && (e[o] = t[o]);
})(e, t);
}, function(e, t) {
n(e, t);
function o() {
this.constructor = e;
}
e.prototype = null === t ? Object.create(t) : (o.prototype = t.prototype, new o());
}), i = this && this.__decorate || function(e, t, o, n) {
var a, i = arguments.length, r = i < 3 ? t : null === n ? n = Object.getOwnPropertyDescriptor(t, o) : n;
if ("object" == typeof Reflect && "function" == typeof Reflect.decorate) r = Reflect.decorate(e, t, o, n); else for (var l = e.length - 1; l >= 0; l--) (a = e[l]) && (r = (i < 3 ? a(r) : i > 3 ? a(t, o, r) : a(t, o)) || r);
return i > 3 && r && Object.defineProperty(t, o, r), r;
};
Object.defineProperty(o, "__esModule", {
value: !0
});
var r = cc._decorator, l = r.ccclass, s = (r.property, r.menu, function(e) {
a(t, e);
function t() {
return null !== e && e.apply(this, arguments) || this;
}
t.prototype.onEnable = function() {};
t.prototype.onDisable = function() {};
t.prototype.onLoad = function() {};
t.prototype.onDestroy = function() {};
t.prototype.start = function() {};
t.prototype.onClickClose = function() {
this.node.destroy();
};
return i([ l ], t);
}(cc.Component));
o.default = s;
cc._RF.pop();
}, {} ],
RS1LotteryScene: [ function(e, t, o) {
"use strict";
cc._RF.push(t, "f85718/eeZN+oijQ9+2ns9l", "RS1LotteryScene");
var n, a = this && this.__extends || (n = function(e, t) {
return (n = Object.setPrototypeOf || {
__proto__: []
} instanceof Array && function(e, t) {
e.__proto__ = t;
} || function(e, t) {
for (var o in t) Object.prototype.hasOwnProperty.call(t, o) && (e[o] = t[o]);
})(e, t);
}, function(e, t) {
n(e, t);
function o() {
this.constructor = e;
}
e.prototype = null === t ? Object.create(t) : (o.prototype = t.prototype, new o());
}), i = this && this.__decorate || function(e, t, o, n) {
var a, i = arguments.length, r = i < 3 ? t : null === n ? n = Object.getOwnPropertyDescriptor(t, o) : n;
if ("object" == typeof Reflect && "function" == typeof Reflect.decorate) r = Reflect.decorate(e, t, o, n); else for (var l = e.length - 1; l >= 0; l--) (a = e[l]) && (r = (i < 3 ? a(r) : i > 3 ? a(t, o, r) : a(t, o)) || r);
return i > 3 && r && Object.defineProperty(t, o, r), r;
};
Object.defineProperty(o, "__esModule", {
value: !0
});
var r = e("../../../Game/client/model/LanguageModel"), l = e("../../../Game/fromework/helper/UIHelper"), s = cc._decorator, c = s.ccclass, u = s.property, d = s.menu, p = function(e) {
a(t, e);
function t() {
var t = null !== e && e.apply(this, arguments) || this;
t.Background = null;
t.UILayer = null;
t.TopLayer = null;
t.Time = null;
return t;
}
t.prototype.onEnable = function() {
r.default.Instance.Init();
};
t.prototype.onDisable = function() {};
t.prototype.onLoad = function() {};
t.prototype.onDestroy = function() {};
t.prototype.start = function() {
l.default.Instance.setLayers(this.Background, this.UILayer, this.TopLayer);
l.default.Instance.addBundleLayer("resources/prefab/ui/RS1Lottery/LotteryView", function() {});
};
i([ u(cc.Node) ], t.prototype, "Background", void 0);
i([ u(cc.Node) ], t.prototype, "UILayer", void 0);
i([ u(cc.Node) ], t.prototype, "TopLayer", void 0);
i([ u(cc.Label) ], t.prototype, "Time", void 0);
return i([ c, d("Scene/RS1LotteryScene") ], t);
}(cc.Component);
o.default = p;
cc._RF.pop();
}, {
"../../../Game/client/model/LanguageModel": "LanguageModel",
"../../../Game/fromework/helper/UIHelper": "UIHelper"
} ],
RS1LotteryView: [ function(e, t, o) {
"use strict";
cc._RF.push(t, "8d348CzU5FEVqsRAVlicb86", "RS1LotteryView");
var n, a = this && this.__extends || (n = function(e, t) {
return (n = Object.setPrototypeOf || {
__proto__: []
} instanceof Array && function(e, t) {
e.__proto__ = t;
} || function(e, t) {
for (var o in t) Object.prototype.hasOwnProperty.call(t, o) && (e[o] = t[o]);
})(e, t);
}, function(e, t) {
n(e, t);
function o() {
this.constructor = e;
}
e.prototype = null === t ? Object.create(t) : (o.prototype = t.prototype, new o());
}), i = this && this.__decorate || function(e, t, o, n) {
var a, i = arguments.length, r = i < 3 ? t : null === n ? n = Object.getOwnPropertyDescriptor(t, o) : n;
if ("object" == typeof Reflect && "function" == typeof Reflect.decorate) r = Reflect.decorate(e, t, o, n); else for (var l = e.length - 1; l >= 0; l--) (a = e[l]) && (r = (i < 3 ? a(r) : i > 3 ? a(t, o, r) : a(t, o)) || r);
return i > 3 && r && Object.defineProperty(t, o, r), r;
};
Object.defineProperty(o, "__esModule", {
value: !0
});
var r = e("../../Game/fromework/helper/UIHelper"), l = cc._decorator, s = l.ccclass, c = l.property, u = (l.menu, 
function(e) {
a(t, e);
function t() {
var t = null !== e && e.apply(this, arguments) || this;
t.BtnTab0 = null;
t.BtnTab1 = null;
t.ScrollView = null;
t.ScrollItem = null;
return t;
}
t.prototype.onEnable = function() {};
t.prototype.onDisable = function() {};
t.prototype.onLoad = function() {};
t.prototype.onDestroy = function() {};
t.prototype.start = function() {};
t.prototype.onClickTab0 = function() {
var e = this.BtnTab0.getChildByName("spr_light");
e.active = !e.active;
var t = this.BtnTab0.getChildByName("spr_font");
t.active = !t.active;
this.BtnTab1.getChildByName("spr_light").active = !e.active;
this.BtnTab1.getChildByName("spr_font").active = !t.active;
};
t.prototype.onClickTab1 = function() {
var e = this.BtnTab1.getChildByName("spr_light");
e.active = !e.active;
var t = this.BtnTab1.getChildByName("spr_font");
t.active = !t.active;
this.BtnTab0.getChildByName("spr_light").active = !e.active;
this.BtnTab0.getChildByName("spr_font").active = !t.active;
};
t.prototype.onClickHelp = function() {};
t.prototype.onClickRecord = function() {
r.default.Instance.addBundleMaskLayer("resources/prefab/ui/RS1Lottery/LotteryRecordDialog", function() {});
};
i([ c(cc.Node) ], t.prototype, "BtnTab0", void 0);
i([ c(cc.Node) ], t.prototype, "BtnTab1", void 0);
i([ c(cc.Node) ], t.prototype, "ScrollView", void 0);
i([ c(cc.Node) ], t.prototype, "ScrollItem", void 0);
return i([ s ], t);
}(cc.Component));
o.default = u;
cc._RF.pop();
}, {
"../../Game/fromework/helper/UIHelper": "UIHelper"
} ],
RecentDetailOther: [ function(e, t, o) {
"use strict";
cc._RF.push(t, "a4868EQZnpCba5FyMeWuIr/", "RecentDetailOther");
var n, a = this && this.__extends || (n = function(e, t) {
return (n = Object.setPrototypeOf || {
__proto__: []
} instanceof Array && function(e, t) {
e.__proto__ = t;
} || function(e, t) {
for (var o in t) Object.prototype.hasOwnProperty.call(t, o) && (e[o] = t[o]);
})(e, t);
}, function(e, t) {
n(e, t);
function o() {
this.constructor = e;
}
e.prototype = null === t ? Object.create(t) : (o.prototype = t.prototype, new o());
}), i = this && this.__decorate || function(e, t, o, n) {
var a, i = arguments.length, r = i < 3 ? t : null === n ? n = Object.getOwnPropertyDescriptor(t, o) : n;
if ("object" == typeof Reflect && "function" == typeof Reflect.decorate) r = Reflect.decorate(e, t, o, n); else for (var l = e.length - 1; l >= 0; l--) (a = e[l]) && (r = (i < 3 ? a(r) : i > 3 ? a(t, o, r) : a(t, o)) || r);
return i > 3 && r && Object.defineProperty(t, o, r), r;
};
Object.defineProperty(o, "__esModule", {
value: !0
});
var r = e("../../../../Game/client/global/enum/game/Game"), l = e("../../../../Game/client/model/LanguageModel"), s = e("../../../../Game/fromework/global/Tools"), c = e("../../Wallet/WalletHelper"), u = cc._decorator, d = u.ccclass, p = u.property, h = function(e) {
a(t, e);
function t() {
var t = null !== e && e.apply(this, arguments) || this;
t.ID = null;
t.Data = null;
t.Type = null;
t.OtherTitle = null;
t.OtherDetail = null;
t._data = null;
return t;
}
t.prototype.init = function(e) {
this._data = e;
this.refreshView();
};
t.prototype.onBackClicked = function() {
this.node.removeFromParent(!0);
this.node.destroy();
};
t.prototype.onContactClicked = function() {
var e = s.Tools.TDate.format(this._data.time, "MM/dd/yyyy hh:mm:ss");
c.default.Instance.openSerciveView(!1, "Reason:" + this._data.fail_message + "Amount:" + this._data.amount + "Date:" + e);
};
t.prototype.refreshView = function() {
this.ID.string = this._data.wallet_sn;
this.Data.string = s.Tools.TDate.format(this._data.time, "MM/dd/yyyy hh:mm:ss");
this.Type.string = this._data.subject;
1 == this._data.currency ? this.OtherTitle.string = l.default.getString("BA_DEP") : 3 == this._data.currency ? this.OtherTitle.string = l.default.getString("BA_WIT") : 4 == this._data.currency ? this.OtherTitle.string = l.default.getString("TDA_BONUS") : this.OtherTitle.string = l.default.getString("TDA_AMOUNT");
switch (this._data.type) {
case 1:
this.OtherDetail.string = "<color=#26FF45>+" + (this._data.currency == r.GameEnum.MoneyType.BONUS ? "Bonus " : l.default.getString("COMMON_RUPEE")) + this._data.amount + "</color>";
break;

case 2:
this.OtherDetail.string = "<color=#FB3B3B>-" + (this._data.currency == r.GameEnum.MoneyType.BONUS ? "Bonus " : l.default.getString("COMMON_RUPEE")) + this._data.amount + "</color>";
break;

case 3:
this.OtherDetail.string = s.Tools.TStr.replaceAll(l.default.getString("RECENT_AMOUNT_SUCCESS"), "%{amount}", this._data.amount);
break;

case 4:
1 == this._data.status ? this.OtherDetail.string = s.Tools.TStr.replaceAll(l.default.getString("RECENT_AMOUNT_SUCCESS"), "%{amount}", this._data.amount) : 99 == this._data.status ? this.OtherDetail.string = s.Tools.TStr.replaceAll(l.default.getString("RECENT_AMOUNT_PENDING"), "%{amount}", this._data.amount) : this.OtherDetail.string = s.Tools.TStr.replaceAll(l.default.getString("RECENT_AMOUNT_FAILED"), "%{amount}", this._data.amount);
break;

case 5:
case 6:
case 7:
case 8:
case 9:
case 10:
case 11:
case 17:
this.OtherDetail.string = "<color=#2CC83A>+" + l.default.getString("COMMON_RUPEE") + this._data.amount + "</color>";
break;

case 15:
this.OtherDetail.string = "+" + l.default.getString("COMMON_RUPEE") + this._data.amount;
break;

case 16:
this.OtherDetail.string = "-" + l.default.getString("COMMON_RUPEE") + this._data.amount;
break;

case 22:
case 23:
case 31:
case 32:
case 33:
this.OtherDetail.string = "<color=#2CC83A>+" + l.default.getString("COMMON_RUPEE") + this._data.amount + "</color>";
break;

case 34:
this.OtherDetail.string = "<color=#E21414>-" + l.default.getString("COMMON_RUPEE") + this._data.amount + "</color>";
}
};
i([ p(cc.Label) ], t.prototype, "ID", void 0);
i([ p(cc.Label) ], t.prototype, "Data", void 0);
i([ p(cc.Label) ], t.prototype, "Type", void 0);
i([ p(cc.Label) ], t.prototype, "OtherTitle", void 0);
i([ p(cc.RichText) ], t.prototype, "OtherDetail", void 0);
return i([ d ], t);
}(cc.Component);
o.default = h;
cc._RF.pop();
}, {
"../../../../Game/client/global/enum/game/Game": "Game",
"../../../../Game/client/model/LanguageModel": "LanguageModel",
"../../../../Game/fromework/global/Tools": "Tools",
"../../Wallet/WalletHelper": "WalletHelper"
} ],
RecentItem: [ function(e, t, o) {
"use strict";
cc._RF.push(t, "fd8c9XzFjpM06Wzt95lcNUT", "RecentItem");
var n, a = this && this.__extends || (n = function(e, t) {
return (n = Object.setPrototypeOf || {
__proto__: []
} instanceof Array && function(e, t) {
e.__proto__ = t;
} || function(e, t) {
for (var o in t) Object.prototype.hasOwnProperty.call(t, o) && (e[o] = t[o]);
})(e, t);
}, function(e, t) {
n(e, t);
function o() {
this.constructor = e;
}
e.prototype = null === t ? Object.create(t) : (o.prototype = t.prototype, new o());
}), i = this && this.__decorate || function(e, t, o, n) {
var a, i = arguments.length, r = i < 3 ? t : null === n ? n = Object.getOwnPropertyDescriptor(t, o) : n;
if ("object" == typeof Reflect && "function" == typeof Reflect.decorate) r = Reflect.decorate(e, t, o, n); else for (var l = e.length - 1; l >= 0; l--) (a = e[l]) && (r = (i < 3 ? a(r) : i > 3 ? a(t, o, r) : a(t, o)) || r);
return i > 3 && r && Object.defineProperty(t, o, r), r;
};
Object.defineProperty(o, "__esModule", {
value: !0
});
var r = e("../../../../Game/fromework/global/Tools"), l = e("../../../../Game/fromework/helper/ConfigHelper"), s = e("../../../../Game/fromework/helper/UIHelper"), c = e("../../../../Game/Script/global/GlobalValue"), u = e("../../../../Game/client/global/enum/game/Const"), d = e("../../../../Game/client/global/enum/game/UIUtils"), p = e("../../../../Game/client/model/LanguageModel"), h = e("./RecentDetailOther"), f = e("./RecentPayView"), _ = e("../../../../Game/client/global/enum/game/Game"), m = cc._decorator, y = m.ccclass, g = m.property, v = function(e) {
a(t, e);
function t() {
var t = null !== e && e.apply(this, arguments) || this;
t.CellButton = null;
t.Backbround = null;
t.LabelDate = null;
t.LabelType = null;
t.LabelAmount = null;
t.LabelID = null;
t.IconRecharge = null;
t.IconWithdraw = null;
t.BGNormalColorKey = "";
t.BGDarkColorKey = "";
t.AMountFaildColorKey = "";
t.AMountWinColorKey = "";
t.AMountLoseColorKey = "";
t._data = null;
return t;
}
t.prototype.refreshView = function() {
this.IconRecharge.active = 0 == this._data.type;
this.IconWithdraw.active = 4 == this._data.type;
var e = "";
switch (this._data.type) {
case 0:
case 4:
if (1 == this._data.status) {
e = l.ConfigHelper.Instance.getValue("fontcolor", this.AMountWinColorKey, "color");
this.LabelAmount.string = this._data.currency == _.GameEnum.MoneyType.BONUS ? "Bonus " : p.default.getString("COMMON_RUPEE") + this._data.amount;
} else if (99 == this._data.status) {
e = l.ConfigHelper.Instance.getValue("fontcolor", this.AMountFaildColorKey, "color");
this.LabelAmount.string = this._data.currency == _.GameEnum.MoneyType.BONUS ? "Bonus " : p.default.getString("COMMON_RUPEE") + this._data.amount;
} else {
e = l.ConfigHelper.Instance.getValue("fontcolor", this.AMountLoseColorKey, "color");
this.LabelAmount.string = this._data.currency == _.GameEnum.MoneyType.BONUS ? "Bonus " : p.default.getString("COMMON_RUPEE") + this._data.amount;
}
break;

default:
e = this._data.amount >= 0 ? l.ConfigHelper.Instance.getValue("fontcolor", this.AMountWinColorKey, "color") : l.ConfigHelper.Instance.getValue("fontcolor", this.AMountLoseColorKey, "color");
this.LabelAmount.string = (this._data.amount >= 0 ? "+" : "-") + (this._data.currency == _.GameEnum.MoneyType.BONUS ? "Bonus " : p.default.getString("COMMON_RUPEE")) + Math.abs(this._data.amount);
}
"" != e && d.UIUtils.setNodeColor(this.LabelAmount.node, e);
this.LabelDate.string = r.Tools.TDate.format(this._data.time, "MM/dd/yyyy \nhh:mm:ss");
this.LabelType.string = this._data.subject;
this.LabelID.string = this._data.wallet_sn;
};
t.prototype.onItemInitCallFunc = function(e) {
this._data = e;
this.refreshView();
};
t.prototype.onItemEnterCallFunc = function() {
this.node.opacity = 255;
this.CellButton.interactable = !0;
};
t.prototype.onItemExitCallFunc = function() {
this.node.opacity = 0;
this.CellButton.interactable = !1;
};
t.prototype.onCellClicked = function() {
var e = this;
c.default.getInstance().isCashGame && (0 == this._data.type || 4 == this._data.type ? s.default.Instance.addBundleMaskLayer(u.BundleUIPath.RecentPayView, function(t) {
t.getComponent(f.default).showView(e._data.type, e._data.wallet_sn);
}) : s.default.Instance.addBundleLayer(u.BundleUIPath.RecentDetailOther, function(t) {
t.getComponent(h.default).init(e._data);
}));
};
i([ g(cc.Button) ], t.prototype, "CellButton", void 0);
i([ g(cc.Node) ], t.prototype, "Backbround", void 0);
i([ g(cc.Label) ], t.prototype, "LabelDate", void 0);
i([ g(cc.Label) ], t.prototype, "LabelType", void 0);
i([ g(cc.Label) ], t.prototype, "LabelAmount", void 0);
i([ g(cc.Label) ], t.prototype, "LabelID", void 0);
i([ g(cc.Node) ], t.prototype, "IconRecharge", void 0);
i([ g(cc.Node) ], t.prototype, "IconWithdraw", void 0);
i([ g ], t.prototype, "BGNormalColorKey", void 0);
i([ g ], t.prototype, "BGDarkColorKey", void 0);
i([ g ], t.prototype, "AMountFaildColorKey", void 0);
i([ g ], t.prototype, "AMountWinColorKey", void 0);
i([ g ], t.prototype, "AMountLoseColorKey", void 0);
return i([ y ], t);
}(cc.Component);
o.default = v;
cc._RF.pop();
}, {
"../../../../Game/Script/global/GlobalValue": "GlobalValue",
"../../../../Game/client/global/enum/game/Const": "Const",
"../../../../Game/client/global/enum/game/Game": "Game",
"../../../../Game/client/global/enum/game/UIUtils": "UIUtils",
"../../../../Game/client/model/LanguageModel": "LanguageModel",
"../../../../Game/fromework/global/Tools": "Tools",
"../../../../Game/fromework/helper/ConfigHelper": "ConfigHelper",
"../../../../Game/fromework/helper/UIHelper": "UIHelper",
"./RecentDetailOther": "RecentDetailOther",
"./RecentPayView": "RecentPayView"
} ],
RecentModel: [ function(e, t, o) {
"use strict";
cc._RF.push(t, "f3add0aBwtCZYDuQ8E1YuYU", "RecentModel");
Object.defineProperty(o, "__esModule", {
value: !0
});
o.RecentProxy = o.LobbyChatType = o.RecentType = void 0;
var n, a = e("../../Game/client/global/enum/game/Event"), i = e("../../Game/client/global/enum/net/C2S"), r = e("../../Game/client/global/enum/net/S2C"), l = e("../../Game/client/model/CommonModel"), s = e("../../Game/fromework/helper/EventHelper"), c = e("../../Game/fromework/mvvm/modelView/ViewModel"), u = e("../../fromework/helper/NetHelper");
(function(e) {
e[e.MainView = 0] = "MainView";
e[e.Recharge = 3] = "Recharge";
e[e.Withdraw = 4] = "Withdraw";
})(o.RecentType || (o.RecentType = {}));
(function(e) {
e[e.None = 0] = "None";
e[e.ChargeFail = 1] = "ChargeFail";
e[e.ChargeSuccess = 2] = "ChargeSuccess";
e[e.WithdrawFail = 3] = "WithdrawFail";
e[e.WithdrawSuccess = 4] = "WithdrawSuccess";
})(n = o.LobbyChatType || (o.LobbyChatType = {}));
var d = function() {
function e() {
this.lobbyChargeFail = [];
this.lobbyChargeSuccess = [];
this.lobbyWithdrawFail = [];
this.lobbyWithdrawSuccess = [];
this._logMap = new Map();
this._pageMap = new Map();
this._totalMap = new Map();
this._type = 0;
}
Object.defineProperty(e, "Instance", {
get: function() {
e._instance || (e._instance = new e());
return e._instance;
},
enumerable: !1,
configurable: !0
});
e.prototype.Init = function() {
s.default.Instance.Net.bind(r.S2C.WALLET.WALLET_LOG, this.onGetWalletLog, this);
};
e.prototype.clear = function() {
s.default.Instance.Net.unbind(r.S2C.WALLET.WALLET_LOG, this.onGetWalletLog, this);
this.lobbyChargeFail.length = 0;
this.lobbyChargeSuccess.length = 0;
this.lobbyWithdrawFail.length = 0;
this.lobbyWithdrawSuccess.length = 0;
this._logMap.clear();
this._pageMap.clear();
this._totalMap.clear();
this._type = 0;
};
e.prototype.getRecentByID = function(e) {
var t = [];
this._logMap.forEach(function(o) {
for (var n = 0; n < o.length; n++) e == o[n].wallet_sn && t.push(o[n]);
});
return t;
};
e.prototype.getDataArrayByType = function(e) {
return this._logMap.has(e) ? this._logMap.get(e).concat() : [];
};
e.prototype.getPageByType = function(e) {
return this._pageMap.has(e) ? this._pageMap.get(e) : 1;
};
e.prototype.getTotalByType = function(e) {
return this._totalMap.has(e) ? this._totalMap.get(e) : 0;
};
e.prototype.checkDataLoad = function(e) {
var t = this.getDataArrayByType(e), o = this.getTotalByType(e);
return t.length < o;
};
e.prototype.addLobbyLog = function(e) {
var t = this;
e.forEach(function(e) {
3 == e.type ? 0 == e.status ? t.lobbyChargeFail.push(e) : 1 == e.status && t.lobbyChargeSuccess.push(e) : 4 == e.type && (0 == e.status ? t.lobbyWithdrawFail.push(e) : 1 == e.status && t.lobbyWithdrawSuccess.push(e));
});
s.default.Instance.Global.emit(a.LobbyEvent.LOBBY_REFRESH_CHAT);
};
e.prototype.getLobbyLogType = function() {
return this.lobbyChargeFail.length > 0 ? n.ChargeFail : this.lobbyWithdrawFail.length > 0 ? n.WithdrawFail : this.lobbyWithdrawSuccess.length > 0 ? n.WithdrawSuccess : this.lobbyChargeSuccess.length > 0 ? n.ChargeSuccess : n.None;
};
e.prototype.getLobbyLogCash = function(e) {
var t = [];
e == n.ChargeFail ? t = this.lobbyChargeFail : e == n.WithdrawFail ? t = this.lobbyWithdrawFail : e == n.WithdrawSuccess ? t = this.lobbyWithdrawSuccess : e == n.ChargeSuccess && (t = this.lobbyChargeSuccess);
var o = 0;
t.forEach(function(e) {
o += e.amount;
});
return o;
};
e.prototype.clearLobbyLog = function(e) {
e == n.ChargeFail ? this.lobbyChargeFail.length = 0 : e == n.WithdrawFail ? this.lobbyWithdrawFail.length = 0 : e == n.WithdrawSuccess ? this.lobbyWithdrawSuccess.length = 0 : e == n.ChargeSuccess && (this.lobbyChargeSuccess.length = 0);
};
e.prototype.getTopLobbyLog = function(e) {
return e == n.ChargeFail ? this.lobbyChargeFail[0] || null : e == n.WithdrawFail ? this.lobbyWithdrawFail[0] || null : e == n.WithdrawSuccess ? this.lobbyWithdrawSuccess[0] || null : e == n.ChargeSuccess ? this.lobbyChargeSuccess[0] || null : void 0;
};
e.prototype.deleteLobbyLog = function(e) {
var t = this;
this.lobbyChargeFail.forEach(function(o, n) {
o.wallet_sn == e && t.lobbyChargeFail.splice(n, 1);
});
this.lobbyWithdrawFail.forEach(function(o, n) {
o.wallet_sn == e && t.lobbyWithdrawFail.splice(n, 1);
});
this.lobbyWithdrawSuccess.forEach(function(o, n) {
o.wallet_sn == e && t.lobbyWithdrawSuccess.splice(n, 1);
});
this.lobbyChargeSuccess.forEach(function(o, n) {
o.wallet_sn == e && t.lobbyChargeSuccess.splice(n, 1);
});
};
e.prototype.checkLobbyLog = function(e) {
for (var t = this.lobbyChargeFail.concat(this.lobbyChargeSuccess, this.lobbyWithdrawFail, this.lobbyWithdrawSuccess), o = 0; o < t.length; o++) if (t[o].wallet_sn == e) return !0;
return !1;
};
e.prototype.onGetWalletLog = function(e) {
var t = e.getUserData();
this._totalMap.set(this._type, t.total);
var o = null;
if (this._logMap.has(this._type)) o = this._logMap.get(this._type); else {
o = [];
this._logMap.set(this._type, o);
}
t.data.forEach(function(e) {
var t = new l.Common.WalletRecentLog(e);
o.push(t);
});
s.default.Instance.Global.emit(a.WalletEvent.RECENT_LOG_REFRESH);
};
e.prototype.sendGetWalletLog = function(e, t, o, n, a) {
var r = e > t ? t : e, l = t < e ? e : t;
l = new Date(l).setHours(23, 59, 59);
r = Math.floor(r / 1e3);
l = Math.floor(l / 1e3);
this._pageMap.set(a, n);
1 == n && this._logMap.set(a, []);
this._type = a;
var s = u.default.Instance.makeMsg(i.C2S.WALLET_LOG, {
u: c.VM.getValue("user.uid"),
t: c.VM.getValue("user.token"),
tt: o,
s: r,
e: l,
i: n
});
u.default.Instance.send(s);
};
e._instance = null;
return e;
}();
o.RecentProxy = d;
cc._RF.pop();
}, {
"../../Game/client/global/enum/game/Event": "Event",
"../../Game/client/global/enum/net/C2S": "C2S",
"../../Game/client/global/enum/net/S2C": "S2C",
"../../Game/client/model/CommonModel": "CommonModel",
"../../Game/fromework/helper/EventHelper": "EventHelper",
"../../Game/fromework/mvvm/modelView/ViewModel": "ViewModel",
"../../fromework/helper/NetHelper": "NetHelper"
} ],
RecentPayItem: [ function(e, t, o) {
"use strict";
cc._RF.push(t, "9cec5ZnyXlGCYO4sKeTQC63", "RecentPayItem");
var n, a = this && this.__extends || (n = function(e, t) {
return (n = Object.setPrototypeOf || {
__proto__: []
} instanceof Array && function(e, t) {
e.__proto__ = t;
} || function(e, t) {
for (var o in t) Object.prototype.hasOwnProperty.call(t, o) && (e[o] = t[o]);
})(e, t);
}, function(e, t) {
n(e, t);
function o() {
this.constructor = e;
}
e.prototype = null === t ? Object.create(t) : (o.prototype = t.prototype, new o());
}), i = this && this.__decorate || function(e, t, o, n) {
var a, i = arguments.length, r = i < 3 ? t : null === n ? n = Object.getOwnPropertyDescriptor(t, o) : n;
if ("object" == typeof Reflect && "function" == typeof Reflect.decorate) r = Reflect.decorate(e, t, o, n); else for (var l = e.length - 1; l >= 0; l--) (a = e[l]) && (r = (i < 3 ? a(r) : i > 3 ? a(t, o, r) : a(t, o)) || r);
return i > 3 && r && Object.defineProperty(t, o, r), r;
};
Object.defineProperty(o, "__esModule", {
value: !0
});
var r = e("../../../../Game/fromework/global/Tools"), l = e("../../../../Game/fromework/helper/EventHelper"), s = e("../../../../Game/fromework/mvvm/modelView/ViewModel"), c = e("../../../../Game/client/global/enum/game/Event"), u = e("../../../global/PopHelper"), d = e("../../../../Game/client/model/LanguageModel"), p = e("../../../model/RecentModel"), h = e("../../../model/WalletModel"), f = e("../../Wallet/WalletHelper"), _ = e("../../../../platform/Platform"), m = e("../../../../Game/client/global/enum/game/Game"), y = cc._decorator, g = y.ccclass, v = y.property, C = function(e) {
a(t, e);
function t() {
var t = null !== e && e.apply(this, arguments) || this;
t.AmountNode = null;
t.DateNode = null;
t.OperationTypeNode = null;
t.IDNode = null;
t.ProgressNode = null;
t.ReasonNode = null;
t.Light = null;
t.ItemType = null;
t.Amount = null;
t.Date = null;
t.OperationType = null;
t.ID = null;
t.Progress = [];
t.CancelButton = null;
t.ServiceButton = null;
t.WorkOrderButton = null;
t.Reason = null;
t.Back_Frames = [];
t.Order_Frame = null;
t.Wallet_Frames = [];
t.Wait_Frames = [];
t.Bank_Frames = [];
t._data = null;
t._index = -1;
t._selectIndex = -1;
t._colorSuccess = cc.Color.BLACK.fromHEX("#24FF00");
t._colorFailed = cc.Color.BLACK.fromHEX("#FF3D40");
t._colorWaiting = cc.Color.BLACK.fromHEX("#FBA90C");
return t;
}
t.prototype.onLoad = function() {
l.default.Instance.Global.bind(c.WalletEvent.WITHDRAW_CANCEL, this.refresh, this);
};
t.prototype.onDestroy = function() {
l.default.Instance.Global.unbind(c.WalletEvent.WITHDRAW_CANCEL, this.refresh, this);
};
t.prototype.refreshItem = function(e, t, o) {
void 0 === o && (o = -1);
this._data = e;
this._index = t;
this._selectIndex = o;
this.refresh();
};
t.prototype.refresh = function() {
var e = this._index == this._selectIndex;
this.AmountNode.active = !0;
this.DateNode.active = !0;
this.OperationTypeNode.active = e;
this.IDNode.active = e;
this.ProgressNode.active = e;
this.ReasonNode.active = e && null != this._data.fail_message && "" != this._data.fail_message;
this.node.getComponent(cc.Sprite).spriteFrame = this.Back_Frames[e ? 2 : this._index % 2];
this.ItemType.string = this._data.subject;
this.Amount.string = this._data.currency == m.GameEnum.MoneyType.BONUS ? "Bonus " : d.default.getString("MoneySymbol") + Math.abs(this._data.amount) + "(" + this.getStateString() + ")";
this.Amount.node.color = this.getStateColor();
this.Date.string = r.Tools.TDate.format(this._data.time, "MM/dd/yyyy hh:mm:ss");
if (e) {
this.OperationType.string = this._data.subject;
this.ID.string = this._data.wallet_sn;
try {
for (var t = function(e) {
var t = o.Progress[e], n = t.getComponent(cc.Sprite), a = t.getChildByName("Title").getComponent(cc.Label), i = o.getProgressColor(e);
n.spriteFrame = o.getProgressIcon(e);
a.string = o.getProgressString(e);
t.children.forEach(function(e) {
e && e.isValid && (e.color = i);
});
}, o = this, n = 0; n < this.Progress.length; n++) t(n);
} catch (e) {
_.default.error("Refresh Progress", e);
}
var a = new Date().getTime() > this._data.time + 3e5;
this.CancelButton.active = 4 == this._data.type && 10 == this._data.status_new && a;
null != this._data.fail_message && "" != this._data.fail_message && (this.Reason.string = this._data.fail_message);
var i = new Date().getTime() > this._data.time + 6e5, l = s.VM.getValue("user.source_config");
this.WorkOrderButton.active = 0 == this._data.type && 1 == (null == l ? void 0 : l.recharge_work_order) && i;
this.ServiceButton.active = 0 != this._data.type || !this.WorkOrderButton.active && i;
}
if (p.RecentProxy.Instance.checkLobbyLog(this._data.wallet_sn)) {
this.playNewLight();
p.RecentProxy.Instance.deleteLobbyLog(this._data.wallet_sn);
}
};
t.prototype.playNewLight = function() {
var e = this;
this.Light.active = !0;
this.Light.opacity = 0;
cc.tween(this.Light).to(.2, {
opacity: 255
}).delay(.1).to(.2, {
opacity: 0
}).call(function() {
e.Light.active = !1;
}).start();
};
t.prototype.getStateString = function() {
return 0 == this._data.type ? 0 == this._data.status ? d.default.getString("COMMON_FAILED") : 1 == this._data.status ? d.default.getString("COMMON_SUCCESS") : 99 == this._data.status ? r.Tools.TStr.replaceAll(d.default.getString("RECENT_PROGRESS_R_1"), "%{symbol}", " ") : "" : 4 == this._data.type ? 10 == this._data.status_new || 50 == this._data.status_new ? r.Tools.TStr.replaceAll(d.default.getString("RECENT_PROGRESS_W_1"), "%{symbol}", " ") : 40 == this._data.status_new ? d.default.getString("COMMON_SUCCESS") : 20 == this._data.status_new || 30 == this._data.status_new || 60 == this._data.status_new ? r.Tools.TStr.replaceAll(d.default.getString("RECENT_PROGRESS_W_2"), "%{symbol}", " ") : "" : void 0;
};
t.prototype.getStateColor = function() {
return 0 == this._data.type ? 0 == this._data.status ? this._colorFailed : 1 == this._data.status ? this._colorSuccess : 99 == this._data.status ? this._colorWaiting : cc.Color.WHITE : 4 == this._data.type ? 10 == this._data.status_new || 20 == this._data.status_new || 60 == this._data.status_new ? this._colorWaiting : 40 == this._data.status_new ? this._colorSuccess : 30 == this._data.status_new || 50 == this._data.status_new ? this._colorFailed : cc.Color.WHITE : void 0;
};
t.prototype.getProgressString = function(e) {
return 0 == this._data.type ? 0 == e ? r.Tools.TStr.replaceAll(d.default.getString("RECENT_PROGRESS_R_0"), "%{symbol}", "\n") : 1 == e ? r.Tools.TStr.replaceAll(d.default.getString("RECENT_PROGRESS_R_1"), "%{symbol}", "\n") : 2 == e ? r.Tools.TStr.replaceAll(d.default.getString("RECENT_PROGRESS_R_2"), "%{symbol}", "\n") : "" : 4 == this._data.type ? 0 == e ? r.Tools.TStr.replaceAll(d.default.getString("RECENT_PROGRESS_W_0"), "%{symbol}", "\n") : 1 == e ? 10 == this._data.status_new || 50 == this._data.status_new ? r.Tools.TStr.replaceAll(d.default.getString("RECENT_PROGRESS_W_1"), "%{symbol}", "\n") : d.default.getString("RECENT_PROGRESS_W_1_SUCCESS") : 2 == e ? r.Tools.TStr.replaceAll(d.default.getString("RECENT_PROGRESS_W_2"), "%{symbol}", "\n") : "" : void 0;
};
t.prototype.getProgressColor = function(e) {
if (0 == this._data.type) return 0 == e ? this._colorSuccess : 1 == e ? this.getStateColor() : 2 == e ? this.getStateColor() : cc.Color.WHITE;
if (4 == this._data.type) {
if (0 == e) return this._colorSuccess;
if (1 == e) return 10 == this._data.status_new ? this._colorSuccess : 50 == this._data.status_new ? this._colorFailed : this._colorSuccess;
if (2 != e) return cc.Color.WHITE;
if (10 == this._data.status_new || 20 == this._data.status_new || 60 == this._data.status_new) return this._colorWaiting;
if (30 == this._data.status_new || 50 == this._data.status_new) return this._colorFailed;
if (40 == this._data.status_new) return this._colorSuccess;
}
};
t.prototype.getProgressIcon = function(e) {
if (0 == this._data.type) {
if (0 == e) return this.Order_Frame;
if (1 == e) return 0 == this._data.status ? this.Bank_Frames[2] : 1 == this._data.status ? this.Bank_Frames[1] : (this._data.status, 
this.Bank_Frames[0]);
if (2 == e) return 0 == this._data.status ? this.Wallet_Frames[2] : 1 == this._data.status ? this.Wallet_Frames[1] : (this._data.status, 
this.Wallet_Frames[0]);
} else if (4 == this._data.type) {
if (0 == e) return this.Order_Frame;
if (1 == e) return 10 == this._data.status_new ? this.Wait_Frames[0] : 50 == this._data.status_new ? this.Wait_Frames[2] : this.Wait_Frames[1];
if (2 == e) return 10 == this._data.status_new || 20 == this._data.status_new || 60 == this._data.status_new ? this.Bank_Frames[0] : 30 == this._data.status_new || 50 == this._data.status_new ? this.Bank_Frames[2] : 40 == this._data.status_new ? this.Bank_Frames[1] : this.Bank_Frames[0];
}
};
t.prototype.onServiceClicked = function() {
var e = r.Tools.TDate.format(this._data.time, "MM/dd/yyyy hh:mm:ss"), t = encodeURIComponent("Type: " + this._data.subject + " Amount: " + (d.default.getString("MoneySymbol") + this._data.amount) + " ID: " + this._data.wallet_sn + " Date: " + e + " Reason: " + this._data.fail_message);
_.default.log(t);
f.default.Instance.openSerciveView(!1, t);
};
t.prototype.onWorkOrderClicked = function() {
f.default.Instance.openWorkOrder(this._data.wallet_sn);
};
t.prototype.onCancelWithdrawClicked = function() {
var e = this, t = {
content: d.default.getString("RECENT_CANCEL_CONTENT"),
title: d.default.getString("RECENT_CANCEL_TITLE"),
leftTitle: d.default.getString("TABLE_BTN_NO"),
rightTitle: d.default.getString("TABLE_BTN_YES"),
leftCallFunc: function() {},
rightCallFunc: function() {
4 == e._data.type && 10 == e._data.status_new && h.WalletProxy.Instance.sendWithdrawCancel(e._data.wallet_sn);
}
};
u.PopHelper.Instance.showAlert(t);
};
i([ v(cc.Node) ], t.prototype, "AmountNode", void 0);
i([ v(cc.Node) ], t.prototype, "DateNode", void 0);
i([ v(cc.Node) ], t.prototype, "OperationTypeNode", void 0);
i([ v(cc.Node) ], t.prototype, "IDNode", void 0);
i([ v(cc.Node) ], t.prototype, "ProgressNode", void 0);
i([ v(cc.Node) ], t.prototype, "ReasonNode", void 0);
i([ v(cc.Node) ], t.prototype, "Light", void 0);
i([ v(cc.Label) ], t.prototype, "ItemType", void 0);
i([ v(cc.Label) ], t.prototype, "Amount", void 0);
i([ v(cc.Label) ], t.prototype, "Date", void 0);
i([ v(cc.Label) ], t.prototype, "OperationType", void 0);
i([ v(cc.Label) ], t.prototype, "ID", void 0);
i([ v([ cc.Node ]) ], t.prototype, "Progress", void 0);
i([ v(cc.Node) ], t.prototype, "CancelButton", void 0);
i([ v(cc.Node) ], t.prototype, "ServiceButton", void 0);
i([ v(cc.Node) ], t.prototype, "WorkOrderButton", void 0);
i([ v(cc.Label) ], t.prototype, "Reason", void 0);
i([ v([ cc.SpriteFrame ]) ], t.prototype, "Back_Frames", void 0);
i([ v(cc.SpriteFrame) ], t.prototype, "Order_Frame", void 0);
i([ v([ cc.SpriteFrame ]) ], t.prototype, "Wallet_Frames", void 0);
i([ v([ cc.SpriteFrame ]) ], t.prototype, "Wait_Frames", void 0);
i([ v([ cc.SpriteFrame ]) ], t.prototype, "Bank_Frames", void 0);
return i([ g ], t);
}(cc.Component);
o.default = C;
cc._RF.pop();
}, {
"../../../../Game/client/global/enum/game/Event": "Event",
"../../../../Game/client/global/enum/game/Game": "Game",
"../../../../Game/client/model/LanguageModel": "LanguageModel",
"../../../../Game/fromework/global/Tools": "Tools",
"../../../../Game/fromework/helper/EventHelper": "EventHelper",
"../../../../Game/fromework/mvvm/modelView/ViewModel": "ViewModel",
"../../../../platform/Platform": "Platform",
"../../../global/PopHelper": "PopHelper",
"../../../model/RecentModel": "RecentModel",
"../../../model/WalletModel": "WalletModel",
"../../Wallet/WalletHelper": "WalletHelper"
} ],
RecentPayView: [ function(e, t, o) {
"use strict";
cc._RF.push(t, "9c47e/ZZ1tHCYg7NnuQ1oV+", "RecentPayView");
var n, a = this && this.__extends || (n = function(e, t) {
return (n = Object.setPrototypeOf || {
__proto__: []
} instanceof Array && function(e, t) {
e.__proto__ = t;
} || function(e, t) {
for (var o in t) Object.prototype.hasOwnProperty.call(t, o) && (e[o] = t[o]);
})(e, t);
}, function(e, t) {
n(e, t);
function o() {
this.constructor = e;
}
e.prototype = null === t ? Object.create(t) : (o.prototype = t.prototype, new o());
}), i = this && this.__decorate || function(e, t, o, n) {
var a, i = arguments.length, r = i < 3 ? t : null === n ? n = Object.getOwnPropertyDescriptor(t, o) : n;
if ("object" == typeof Reflect && "function" == typeof Reflect.decorate) r = Reflect.decorate(e, t, o, n); else for (var l = e.length - 1; l >= 0; l--) (a = e[l]) && (r = (i < 3 ? a(r) : i > 3 ? a(t, o, r) : a(t, o)) || r);
return i > 3 && r && Object.defineProperty(t, o, r), r;
};
Object.defineProperty(o, "__esModule", {
value: !0
});
var r = e("../../../../fromework/component/TableView/TableList"), l = e("../../../../Game/fromework/global/Tools"), s = e("../../../../Game/fromework/helper/EventHelper"), c = e("../../../../Game/fromework/helper/UIHelper"), u = e("../../../../Game/client/global/enum/game/Event"), d = e("../../../global/PopHelper"), p = e("../../../../Game/client/model/LanguageModel"), h = e("../../../model/RecentModel"), f = e("../Calender/Calender"), _ = e("./RecentPayItem"), m = e("../../../../Game/client/global/enum/game/Const"), y = cc._decorator, g = y.ccclass, v = y.property, C = function(e) {
a(t, e);
function t() {
var t = null !== e && e.apply(this, arguments) || this;
t.MainPanel = null;
t.ToggleRecharge = null;
t.ToggleWithdraw = null;
t.DateFrom = null;
t.DateTo = null;
t.List = null;
t._curFilterType = 3;
t._curID = "";
t._filterFrom = 0;
t._filterTo = 0;
t._selectIndex = -1;
t._isPlayAnimation = !1;
return t;
}
t.prototype.onLoad = function() {
s.default.Instance.Global.bind(u.WalletEvent.RECENT_LOG_REFRESH, this.onLogRefresh, this);
s.default.Instance.Global.bind(u.WalletEvent.WITHDRAW_CANCEL, this.onCancelWithdraw, this);
this.List.node.on("scroll-to-bottom", this.loadMorePage, this);
};
t.prototype.onDestroy = function() {
s.default.Instance.Global.unbind(u.WalletEvent.RECENT_LOG_REFRESH, this.onLogRefresh, this);
s.default.Instance.Global.unbind(u.WalletEvent.WITHDRAW_CANCEL, this.onCancelWithdraw, this);
};
t.prototype.showView = function(e, t, o, n) {
this._curFilterType = e;
t && (this._curID = t);
this._curFilterType == h.RecentType.Recharge ? this.ToggleRecharge.isChecked = !0 : this._curFilterType == h.RecentType.Withdraw && (this.ToggleWithdraw.isChecked = !0);
if (null != o && null != n) {
this._filterFrom = o;
this._filterTo = n;
} else {
this._filterFrom = new Date().getTime() - 6048e5;
this._filterTo = new Date().getTime();
}
h.RecentProxy.Instance.sendGetWalletLog(this._filterFrom, this._filterTo, this._curFilterType, 1, this._curFilterType);
this.refreshFiter();
this.playInAnimation();
};
t.prototype.onLogRefresh = function() {
var e = this, t = h.RecentProxy.Instance.getDataArrayByType(this._curFilterType);
if ("" != this._curID) for (var o = 0; o < t.length; o++) if (t[o].wallet_sn == this._curID) {
this._selectIndex = o;
break;
}
this.List.numItems = t.length;
this.scheduleOnce(function() {
if (e && e.node && e.node.isValid) {
"" != e._curID && e.List.scrollTo(e._selectIndex);
e._curID = "";
}
});
};
t.prototype.onCancelWithdraw = function(e) {
var t, o = e.getUserData();
t = 1 == o.code ? p.default.getString("RECENT_CANCEL_1") : 1028 == o.code ? p.default.getString("RECENT_CANCEL_1028") : p.default.getString("RECENT_CANCEL_0");
d.PopHelper.Instance.showTips(t);
s.default.Instance.Global.emit(u.LobbyEvent.LOBBY_REFRESH_CHAT);
};
t.prototype.loadMorePage = function() {
if (h.RecentProxy.Instance.checkDataLoad(this._curFilterType)) {
var e = h.RecentProxy.Instance.getPageByType(this._curFilterType) + 1;
h.RecentProxy.Instance.sendGetWalletLog(this._filterFrom, this._filterTo, this._curFilterType, e, this._curFilterType);
}
};
t.prototype.refreshFiter = function() {
this.DateFrom.string = l.Tools.TDate.format(this._filterFrom, "dd-MM-yyyy");
this.DateTo.string = l.Tools.TDate.format(this._filterTo, "dd-MM-yyyy");
};
t.prototype.playInAnimation = function(e) {
var t = this;
if (!this._isPlayAnimation) {
this._isPlayAnimation = !0;
var o = this.MainPanel.getComponent(cc.Animation);
o.on(cc.Animation.EventType.FINISHED, function() {
t._isPlayAnimation = !1;
e && e();
}, this);
o.play("RecentPayViewIn");
}
};
t.prototype.playOutAnimation = function(e) {
var t = this;
if (!this._isPlayAnimation) {
this._isPlayAnimation = !0;
var o = this.MainPanel.getComponent(cc.Animation);
o.on(cc.Animation.EventType.FINISHED, function() {
t._isPlayAnimation = !1;
e && e();
}, this);
o.play("RecentPayViewOut");
}
};
t.prototype.onTableViewRender = function(e, t) {
var o = h.RecentProxy.Instance.getDataArrayByType(this._curFilterType);
e.getComponent(_.default).refreshItem(o[t], t, this._selectIndex);
};
t.prototype.onTableItemClicked = function(e, t) {
this._selectIndex = t;
this.List.updateAll();
};
t.prototype.onTypeOptionsSelected = function(e, t) {
var o = parseInt(t);
if (this._curFilterType != o) {
this._curFilterType = o;
this.refreshFiter();
h.RecentProxy.Instance.sendGetWalletLog(this._filterFrom, this._filterTo, this._curFilterType, 1, this._curFilterType);
}
};
t.prototype.onSelectDateClicked = function(e, t) {
var o = this, n = parseInt(t);
c.default.Instance.addBundleMaskLayer(m.BundleUIPath.Calender, function(e) {
e.scale = .8;
var t = new Date(), a = e.getComponent(f.default);
a.setDate(t.getFullYear(), t.getMonth(), t.getDate());
a.setPickDateCallback(function(e, t, a) {
var i = new Date(e, t, a);
if (0 == n) {
o._filterFrom = i.getTime();
if (o._filterTo < o._filterFrom) o._filterTo = o._filterFrom + 6048e5; else if (o._filterTo - o._filterFrom > 2592e6) {
o._filterFrom = o._filterTo - 2592e6;
d.PopHelper.Instance.showTips(p.default.getString("WALLET_TRANSACTION_MAXDAY"));
}
}
if (1 == n) {
o._filterTo = i.getTime();
if (o._filterTo < o._filterFrom) o._filterFrom = o._filterTo - 6048e5; else if (o._filterTo - o._filterFrom > 2592e6) {
o._filterTo = o._filterFrom + 2592e6;
d.PopHelper.Instance.showTips(p.default.getString("WALLET_TRANSACTION_MAXDAY"));
}
}
o.refreshFiter();
});
});
};
t.prototype.onSearchClicked = function() {
h.RecentProxy.Instance.sendGetWalletLog(this._filterFrom, this._filterTo, this._curFilterType, 1, this._curFilterType);
this.refreshFiter();
};
t.prototype.onCloseClicked = function() {
var e = this;
this.playOutAnimation(function() {
c.default.Instance.removeMaskLayer(e.node);
h.RecentProxy.Instance.clearLobbyLog(h.LobbyChatType.ChargeFail);
h.RecentProxy.Instance.clearLobbyLog(h.LobbyChatType.ChargeSuccess);
h.RecentProxy.Instance.clearLobbyLog(h.LobbyChatType.WithdrawFail);
h.RecentProxy.Instance.clearLobbyLog(h.LobbyChatType.WithdrawSuccess);
});
};
i([ v(cc.Node) ], t.prototype, "MainPanel", void 0);
i([ v(cc.Toggle) ], t.prototype, "ToggleRecharge", void 0);
i([ v(cc.Toggle) ], t.prototype, "ToggleWithdraw", void 0);
i([ v(cc.Label) ], t.prototype, "DateFrom", void 0);
i([ v(cc.Label) ], t.prototype, "DateTo", void 0);
i([ v(r.default) ], t.prototype, "List", void 0);
return i([ g ], t);
}(cc.Component);
o.default = C;
cc._RF.pop();
}, {
"../../../../Game/client/global/enum/game/Const": "Const",
"../../../../Game/client/global/enum/game/Event": "Event",
"../../../../Game/client/model/LanguageModel": "LanguageModel",
"../../../../Game/fromework/global/Tools": "Tools",
"../../../../Game/fromework/helper/EventHelper": "EventHelper",
"../../../../Game/fromework/helper/UIHelper": "UIHelper",
"../../../../fromework/component/TableView/TableList": "TableList",
"../../../global/PopHelper": "PopHelper",
"../../../model/RecentModel": "RecentModel",
"../Calender/Calender": "Calender",
"./RecentPayItem": "RecentPayItem"
} ],
RecentView: [ function(e, t, o) {
"use strict";
cc._RF.push(t, "9b619sROSZDw5vektrkgm51", "RecentView");
var n, a = this && this.__extends || (n = function(e, t) {
return (n = Object.setPrototypeOf || {
__proto__: []
} instanceof Array && function(e, t) {
e.__proto__ = t;
} || function(e, t) {
for (var o in t) Object.prototype.hasOwnProperty.call(t, o) && (e[o] = t[o]);
})(e, t);
}, function(e, t) {
n(e, t);
function o() {
this.constructor = e;
}
e.prototype = null === t ? Object.create(t) : (o.prototype = t.prototype, new o());
}), i = this && this.__decorate || function(e, t, o, n) {
var a, i = arguments.length, r = i < 3 ? t : null === n ? n = Object.getOwnPropertyDescriptor(t, o) : n;
if ("object" == typeof Reflect && "function" == typeof Reflect.decorate) r = Reflect.decorate(e, t, o, n); else for (var l = e.length - 1; l >= 0; l--) (a = e[l]) && (r = (i < 3 ? a(r) : i > 3 ? a(t, o, r) : a(t, o)) || r);
return i > 3 && r && Object.defineProperty(t, o, r), r;
};
Object.defineProperty(o, "__esModule", {
value: !0
});
var r = e("../../../../fromework/component/listView/ListView"), l = e("../../../../Game/fromework/global/Tools"), s = e("../../../../Game/fromework/helper/EventHelper"), c = e("../../../../Game/fromework/helper/UIHelper"), u = e("../../../../Game/Script/global/GlobalValue"), d = e("../../../../Game/client/global/enum/game/Const"), p = e("../../../../Game/client/global/enum/game/Event"), h = e("../../../../Game/client/global/enum/game/UIUtils"), f = e("../../../global/PopHelper"), _ = e("../../../../Game/client/model/LanguageModel"), m = e("../../../model/RecentModel"), y = e("../Calender/Calender"), g = e("../../../../Game/fromework/helper/ConfigHelper"), v = cc._decorator, C = v.ccclass, b = v.property, I = function(e) {
a(t, e);
function t() {
var t = null !== e && e.apply(this, arguments) || this;
t.Node_Filter = null;
t.RecentList = null;
t.Node_TypeFilter = null;
t.Node_TypeFilter_Drop = null;
t.Label_Type = null;
t.Label_DateFrom = null;
t.Label_DateTo = null;
t.Enpty = null;
t.TypeFilterNormalColorKey = "";
t.TypeFilterSelectColorKey = "";
t._curFilterType = -1;
t._curFilterName = "All";
t._filterFrom = 0;
t._filterTo = 0;
return t;
}
t.prototype.onEnable = function() {
s.default.Instance.Global.bind(p.WalletEvent.RECENT_LOG_REFRESH, this.onLogRefresh, this);
this.RecentList.node.on("scroll-to-bottom", this.loadMorePage, this);
};
t.prototype.onDisable = function() {
s.default.Instance.Global.unbind(p.WalletEvent.RECENT_LOG_REFRESH, this.onLogRefresh, this);
this.RecentList.node.off("scroll-to-bottom", this.loadMorePage, this);
};
t.prototype.InitView = function() {
this._filterFrom = new Date().getTime() - 6048e5;
this._filterTo = new Date().getTime();
this.Node_Filter.active = u.default.getInstance().isCashGame;
this.RecentList.node.height = u.default.getInstance().isCashGame ? 417 : 493;
m.RecentProxy.Instance.sendGetWalletLog(this._filterFrom, this._filterTo, this._curFilterType, 1, m.RecentType.MainView);
this.refreshFiter();
};
t.prototype.onBackClicked = function() {
c.default.Instance.removeLayer(this.node);
};
t.prototype.onSearchClicked = function() {
m.RecentProxy.Instance.sendGetWalletLog(this._filterFrom, this._filterTo, this._curFilterType, 1, m.RecentType.MainView);
this.refreshFiter();
};
t.prototype.onSelectTypeClicked = function() {
this.showTypeFilter();
};
t.prototype.onTypeOptionsSelected = function(e, t) {
var o = parseInt(t);
if (this._curFilterType != o) {
this._curFilterType = o;
this._curFilterName = e.target.name;
this.refreshFiter();
this.hideTypeFilter();
m.RecentProxy.Instance.sendGetWalletLog(this._filterFrom, this._filterTo, this._curFilterType, 1, m.RecentType.MainView);
}
};
t.prototype.onSelectDateClicked = function(e, t) {
var o = this, n = parseInt(t);
c.default.Instance.addBundleMaskLayer(d.BundleUIPath.Calender, function(e) {
e.scale = .8;
var t = new Date(), a = e.getComponent(y.default);
a.setDate(t.getFullYear(), t.getMonth(), t.getDate());
a.setPickDateCallback(function(e, t, a) {
var i = new Date(e, t, a);
if (0 == n) {
o._filterFrom = i.getTime();
if (o._filterTo < o._filterFrom) o._filterTo = o._filterFrom + 6048e5; else if (o._filterTo - o._filterFrom > 2592e6) {
o._filterFrom = o._filterTo - 2592e6;
f.PopHelper.Instance.showTips(_.default.getString("WALLET_TRANSACTION_MAXDAY"));
}
}
if (1 == n) {
o._filterTo = i.getTime();
if (o._filterTo < o._filterFrom) o._filterFrom = o._filterTo - 6048e5; else if (o._filterTo - o._filterFrom > 2592e6) {
o._filterTo = o._filterFrom + 2592e6;
f.PopHelper.Instance.showTips(_.default.getString("WALLET_TRANSACTION_MAXDAY"));
}
}
o.refreshFiter();
});
});
};
t.prototype.onLogRefresh = function() {
var e = m.RecentProxy.Instance.getDataArrayByType(m.RecentType.MainView);
this.Enpty.active = 0 == e.length;
this.RecentList.datas = e;
};
t.prototype.loadMorePage = function() {
if (m.RecentProxy.Instance.checkDataLoad(m.RecentType.MainView)) {
var e = m.RecentProxy.Instance.getPageByType(m.RecentType.MainView) + 1;
m.RecentProxy.Instance.sendGetWalletLog(this._filterFrom, this._filterTo, this._curFilterType, e, m.RecentType.MainView);
}
};
t.prototype.refreshFiter = function() {
this.Label_Type.string = this.Node_TypeFilter.getChildByName(this._curFilterName).getComponent(cc.Label).string;
this.Label_DateFrom.string = l.Tools.TDate.format(this._filterFrom, "dd-MM-yyyy");
this.Label_DateTo.string = l.Tools.TDate.format(this._filterTo, "dd-MM-yyyy");
};
t.prototype.showTypeFilter = function() {
var e = this;
this.Node_TypeFilter.children.forEach(function(t) {
if (t.name == e._curFilterName) (o = g.ConfigHelper.Instance.getValue("fontcolor", e.TypeFilterSelectColorKey, "color")) && h.UIUtils.setNodeColor(t, o); else {
var o;
(o = "#BC7A7A") && h.UIUtils.setNodeColor(t, o);
}
});
this.Node_TypeFilter_Drop.active = !0;
};
t.prototype.hideTypeFilter = function() {
this.Node_TypeFilter_Drop.active = !1;
};
i([ b(cc.Node) ], t.prototype, "Node_Filter", void 0);
i([ b(r.default) ], t.prototype, "RecentList", void 0);
i([ b(cc.Node) ], t.prototype, "Node_TypeFilter", void 0);
i([ b(cc.Node) ], t.prototype, "Node_TypeFilter_Drop", void 0);
i([ b(cc.Label) ], t.prototype, "Label_Type", void 0);
i([ b(cc.Label) ], t.prototype, "Label_DateFrom", void 0);
i([ b(cc.Label) ], t.prototype, "Label_DateTo", void 0);
i([ b(cc.Node) ], t.prototype, "Enpty", void 0);
i([ b ], t.prototype, "TypeFilterNormalColorKey", void 0);
i([ b ], t.prototype, "TypeFilterSelectColorKey", void 0);
return i([ C ], t);
}(cc.Component);
o.default = I;
cc._RF.pop();
}, {
"../../../../Game/Script/global/GlobalValue": "GlobalValue",
"../../../../Game/client/global/enum/game/Const": "Const",
"../../../../Game/client/global/enum/game/Event": "Event",
"../../../../Game/client/global/enum/game/UIUtils": "UIUtils",
"../../../../Game/client/model/LanguageModel": "LanguageModel",
"../../../../Game/fromework/global/Tools": "Tools",
"../../../../Game/fromework/helper/ConfigHelper": "ConfigHelper",
"../../../../Game/fromework/helper/EventHelper": "EventHelper",
"../../../../Game/fromework/helper/UIHelper": "UIHelper",
"../../../../fromework/component/listView/ListView": "ListView",
"../../../global/PopHelper": "PopHelper",
"../../../model/RecentModel": "RecentModel",
"../Calender/Calender": "Calender"
} ],
RechagerActivity: [ function(e, t, o) {
"use strict";
cc._RF.push(t, "31c51ei0lRF0aWCUCGeRrvd", "RechagerActivity");
var n, a = this && this.__extends || (n = function(e, t) {
return (n = Object.setPrototypeOf || {
__proto__: []
} instanceof Array && function(e, t) {
e.__proto__ = t;
} || function(e, t) {
for (var o in t) Object.prototype.hasOwnProperty.call(t, o) && (e[o] = t[o]);
})(e, t);
}, function(e, t) {
n(e, t);
function o() {
this.constructor = e;
}
e.prototype = null === t ? Object.create(t) : (o.prototype = t.prototype, new o());
}), i = this && this.__decorate || function(e, t, o, n) {
var a, i = arguments.length, r = i < 3 ? t : null === n ? n = Object.getOwnPropertyDescriptor(t, o) : n;
if ("object" == typeof Reflect && "function" == typeof Reflect.decorate) r = Reflect.decorate(e, t, o, n); else for (var l = e.length - 1; l >= 0; l--) (a = e[l]) && (r = (i < 3 ? a(r) : i > 3 ? a(t, o, r) : a(t, o)) || r);
return i > 3 && r && Object.defineProperty(t, o, r), r;
};
Object.defineProperty(o, "__esModule", {
value: !0
});
o.RechargeActiyityType = void 0;
var r = e("../../../../Game/fromework/global/Tools"), l = e("../../../../Game/fromework/helper/EventHelper"), s = e("../../../../Game/fromework/helper/UIHelper"), c = e("../ActiveEvent"), u = e("../ActiveModel"), d = cc._decorator, p = d.ccclass, h = d.property;
(function(e) {
e[e.SuperUnpurchased = 1] = "SuperUnpurchased";
e[e.Lucky = 2] = "Lucky";
})(o.RechargeActiyityType || (o.RechargeActiyityType = {}));
var f = function(e) {
a(t, e);
function t() {
var t = null !== e && e.apply(this, arguments) || this;
t.BG = null;
t.BGSuper = null;
t.BGLucky = null;
t.CroupierSuper = null;
t.CroupierLucky = null;
t.Super = null;
t.Lucky = null;
t.LuckyDepositValue = null;
t.LuckyBounsValue = null;
t.SuperDepositValue = [];
t.SuperBounsValue1 = [];
t.SuperMask = [];
t.TitleSuper = null;
t.TitleLucky = null;
t.Time = null;
t.SuperUnpurchasedButton = null;
t.SuperUnreceivedButton = null;
t.SuperReceivedButton = null;
t.LuckyButton = null;
t.SuperPriceOld = null;
t.SuperPrice = null;
t.ReceiveCountdown = null;
t.LuckyPriceOld = null;
t.LuckyPrice = null;
t._openType = 0;
t.reqNum = 0;
return t;
}
t.prototype.netRefresh = function(e) {
if (e) {
var t = e.getUserData();
this._refresh(t);
}
};
t.prototype.refresh = function(e) {
this._refresh(e);
};
t.prototype.onSuperPurchaseClick = function() {
u.ActiveProxy.Instance.sendPayRechargeSuperActive();
this.onCloseClick();
};
t.prototype.onSuperReceiveClick = function() {
u.ActiveProxy.Instance.sendReceiveRechargeSuperActive();
};
t.prototype.onLuckyPurchaseClick = function() {
u.ActiveProxy.Instance.sendPayRechargeLuckyActive();
this.onCloseClick();
};
t.prototype.onCloseClick = function() {
s.default.Instance.removeMaskLayer(this.node);
};
t.prototype._refresh = function(e) {
this.SuperUnpurchasedButton.node.active = !1;
this.SuperUnreceivedButton.node.active = !1;
this.SuperReceivedButton.node.active = !1;
this.LuckyButton.node.active = !1;
this.Time.node.active = !1;
if (e.activeInfo) if (3 != e.activeInfo.active_status) {
this.Super.active = !1;
this.Lucky.active = !1;
this.TitleSuper.active = !1;
this.TitleLucky.active = !1;
this.CroupierSuper.active = !1;
this.CroupierLucky.active = !1;
this._openType = e.activeInfo.active_type;
if (4 == e.activeInfo.active_type) {
this.Super.active = !0;
this.TitleSuper.active = !0;
this.BG.spriteFrame = this.BGSuper;
if (1 == e.activeInfo.active_status) {
this.SuperUnpurchasedButton.node.active = !0;
this.Time.node.active = !0;
var t = Math.floor(e.activeInfo.end_time - new Date().getTime() / 1e3);
this._setCountdownTime(t);
this._beginEndTimeCountdown(e.activeInfo.end_time);
this.SuperPrice.string = "₹" + e.activeInfo.pay_qf / 1e3;
this.SuperPriceOld.string = "₹" + e.activeInfo.price_qf / 1e3;
this.SuperPrice._forceUpdateRenderData(!0);
this.SuperPriceOld._forceUpdateRenderData(!0);
if (r = this.SuperPrice.node.getParent().getComponent(cc.Layout)) {
r.updateLayout();
var o = r.node.width;
this.SuperUnpurchasedButton.node.width = o + 20;
}
for (var n = 0; n < e.activeInfo.reward.length; ++n) {
var a = e.activeInfo.reward[n];
this.SuperDepositValue[n].string = "₹" + a.deposit / 1e3;
this.SuperBounsValue1[n].string = "₹" + a.bonus / 1e3;
}
} else if (2 == e.activeInfo.active_status) {
var i = !1;
for (n = 0; n < e.activeInfo.reward.length; ++n) {
a = e.activeInfo.reward[n];
this.SuperDepositValue[n].string = "₹" + a.deposit / 1e3;
this.SuperBounsValue1[n].string = "₹" + a.bonus / 1e3;
if (2 != a.receive_stat) {
if (1 == a.receive_stat) {
this.SuperMask[n].active = !1;
if (i) continue;
i = !0;
if (a.receive_time <= new Date().getTime() / 1e3 && -1 != a.receive_time) this.SuperUnreceivedButton.node.active = !0; else {
this.SuperReceivedButton.node.active = !0;
t = Math.floor(a.receive_time - new Date().getTime() / 1e3);
this._setReceiveTime(t);
this._beginReceiveCountdown(a.receive_time);
}
}
} else this.SuperMask[n].active = !0;
}
}
} else if (5 == e.activeInfo.active_type) {
this.Lucky.active = !0;
this.TitleLucky.active = !0;
this.BG.spriteFrame = this.BGLucky;
this.LuckyButton.node.active = !0;
this.Time.node.active = !0;
var r;
t = Math.floor(e.activeInfo.end_time - new Date().getTime() / 1e3);
this._setCountdownTime(t);
this._beginEndTimeCountdown(e.activeInfo.end_time);
this.LuckyPrice.string = "₹" + e.activeInfo.pay_qf / 1e3;
this.LuckyPriceOld.string = "₹" + e.activeInfo.price_qf / 1e3;
this.LuckyPrice._forceUpdateRenderData(!0);
this.LuckyPriceOld._forceUpdateRenderData(!0);
if (r = this.LuckyPrice.node.getParent().getComponent(cc.Layout)) {
r.updateLayout();
o = r.node.width;
this.LuckyButton.node.width = o + 20;
}
this.LuckyDepositValue.string = "₹" + e.activeInfo.reward[0].deposit / 1e3;
this.LuckyBounsValue.string = "₹" + e.activeInfo.reward[0].bonus / 1e3;
}
} else this.SuperMask[this.SuperMask.length - 1].active = !0; else if (this.reqNum < 1) {
u.ActiveProxy.Instance.sendGetRechargeLuckyActiveInfo(null);
this.reqNum = this.reqNum + 1;
} else this.onCloseClick();
};
t.prototype._getTimeString = function(e) {
var t = r.Tools.TDate.second2Hour(e), o = t.hour, n = t.minu, a = t.sec;
return o + n + a <= 0 ? null : r.Tools.TDate.fix2(o) + ":" + r.Tools.TDate.fix2(n) + ":" + r.Tools.TDate.fix2(a);
};
t.prototype._setCountdownTime = function(e) {
var t = this._getTimeString(e);
if (null == t) {
this.unscheduleAllCallbacks();
this.onCloseClick();
} else this.Time.string = t;
};
t.prototype._setReceiveTime = function(e) {
var t = this._getTimeString(e);
if (null == t) {
this.unscheduleAllCallbacks();
u.ActiveProxy.Instance.sendGetRechargeSuperActiveInfo();
} else this.ReceiveCountdown.string = t;
};
t.prototype._beginEndTimeCountdown = function(e) {
var t = this;
this.unscheduleAllCallbacks();
this.schedule(function() {
var o = Math.floor(e - new Date().getTime() / 1e3);
t._setCountdownTime(o);
}, 1);
};
t.prototype._beginReceiveCountdown = function(e) {
var t = this;
this.unscheduleAllCallbacks();
this.schedule(function() {
var o = Math.floor(e - new Date().getTime() / 1e3);
t._setReceiveTime(o);
}, 1);
};
t.prototype.onEnable = function() {
l.default.Instance.Global.bind(c.RechargeSuperEvent.RECHARGE_GET_SUPER_DATA, this.netRefresh, this);
l.default.Instance.Global.bind(c.RechargeSuperEvent.RECHARGE_GET_SUPER_RECEIVE, this.netRefresh, this);
l.default.Instance.Global.bind(c.RechargeLuckyEvent.RECHARGE_GET_LUCKY_DATA, this.netRefresh, this);
};
t.prototype.onDisable = function() {
l.default.Instance.Global.unbind(c.RechargeSuperEvent.RECHARGE_GET_SUPER_DATA, this.netRefresh, this);
l.default.Instance.Global.unbind(c.RechargeSuperEvent.RECHARGE_GET_SUPER_RECEIVE, this.netRefresh, this);
l.default.Instance.Global.unbind(c.RechargeLuckyEvent.RECHARGE_GET_LUCKY_DATA, this.netRefresh, this);
};
t.prototype.onLoad = function() {};
t.prototype.start = function() {};
i([ h(cc.Sprite) ], t.prototype, "BG", void 0);
i([ h(cc.SpriteFrame) ], t.prototype, "BGSuper", void 0);
i([ h(cc.SpriteFrame) ], t.prototype, "BGLucky", void 0);
i([ h(cc.Node) ], t.prototype, "CroupierSuper", void 0);
i([ h(cc.Node) ], t.prototype, "CroupierLucky", void 0);
i([ h(cc.Node) ], t.prototype, "Super", void 0);
i([ h(cc.Node) ], t.prototype, "Lucky", void 0);
i([ h(cc.Label) ], t.prototype, "LuckyDepositValue", void 0);
i([ h(cc.Label) ], t.prototype, "LuckyBounsValue", void 0);
i([ h([ cc.Label ]) ], t.prototype, "SuperDepositValue", void 0);
i([ h([ cc.Label ]) ], t.prototype, "SuperBounsValue1", void 0);
i([ h([ cc.Node ]) ], t.prototype, "SuperMask", void 0);
i([ h(cc.Node) ], t.prototype, "TitleSuper", void 0);
i([ h(cc.Node) ], t.prototype, "TitleLucky", void 0);
i([ h(cc.Label) ], t.prototype, "Time", void 0);
i([ h(cc.Button) ], t.prototype, "SuperUnpurchasedButton", void 0);
i([ h(cc.Button) ], t.prototype, "SuperUnreceivedButton", void 0);
i([ h(cc.Button) ], t.prototype, "SuperReceivedButton", void 0);
i([ h(cc.Button) ], t.prototype, "LuckyButton", void 0);
i([ h(cc.Label) ], t.prototype, "SuperPriceOld", void 0);
i([ h(cc.Label) ], t.prototype, "SuperPrice", void 0);
i([ h(cc.Label) ], t.prototype, "ReceiveCountdown", void 0);
i([ h(cc.Label) ], t.prototype, "LuckyPriceOld", void 0);
i([ h(cc.Label) ], t.prototype, "LuckyPrice", void 0);
return i([ p ], t);
}(cc.Component);
o.default = f;
cc._RF.pop();
}, {
"../../../../Game/fromework/global/Tools": "Tools",
"../../../../Game/fromework/helper/EventHelper": "EventHelper",
"../../../../Game/fromework/helper/UIHelper": "UIHelper",
"../ActiveEvent": "ActiveEvent",
"../ActiveModel": "ActiveModel"
} ],
RechargeAlert: [ function(e, t, o) {
"use strict";
cc._RF.push(t, "009d5evC1lJXbv6MgzAxb4o", "RechargeAlert");
var n, a = this && this.__extends || (n = function(e, t) {
return (n = Object.setPrototypeOf || {
__proto__: []
} instanceof Array && function(e, t) {
e.__proto__ = t;
} || function(e, t) {
for (var o in t) Object.prototype.hasOwnProperty.call(t, o) && (e[o] = t[o]);
})(e, t);
}, function(e, t) {
n(e, t);
function o() {
this.constructor = e;
}
e.prototype = null === t ? Object.create(t) : (o.prototype = t.prototype, new o());
}), i = this && this.__decorate || function(e, t, o, n) {
var a, i = arguments.length, r = i < 3 ? t : null === n ? n = Object.getOwnPropertyDescriptor(t, o) : n;
if ("object" == typeof Reflect && "function" == typeof Reflect.decorate) r = Reflect.decorate(e, t, o, n); else for (var l = e.length - 1; l >= 0; l--) (a = e[l]) && (r = (i < 3 ? a(r) : i > 3 ? a(t, o, r) : a(t, o)) || r);
return i > 3 && r && Object.defineProperty(t, o, r), r;
};
Object.defineProperty(o, "__esModule", {
value: !0
});
var r = e("../../../../Game/fromework/global/Tools"), l = e("../../../../Game/fromework/helper/EventHelper"), s = e("../../../../Game/fromework/mvvm/modelView/ViewModel"), c = e("../../../../Game/Script/global/GlobalValue"), u = e("../../../../Game/client/global/enum/game/Const"), d = e("../../../../Game/client/global/enum/game/Event"), p = e("../../../model/MonthCardModel"), h = e("../../../model/WalletModel"), f = e("../../active/ActiveManager"), _ = e("../../Wallet/WalletHelper"), m = e("../../../../Game/client/model/LanguageModel"), y = cc._decorator, g = y.ccclass, v = y.property, C = function(e) {
a(t, e);
function t() {
var t = null !== e && e.apply(this, arguments) || this;
t.AlertPanel = null;
t.Tips_2 = null;
t.Cash = null;
t.Bonus = null;
t.PayLabel = null;
t.payToggle = null;
t._amount = 0;
t._activityData = null;
t.isRecharge = !0;
return t;
}
t.prototype.onLoad = function() {
l.default.Instance.Global.bind(d.WalletEvent.RECHARGE_BROWSER_END, this._onShowApp, this);
};
t.prototype.onDestroy = function() {
l.default.Instance.Global.unbind(d.WalletEvent.RECHARGE_BROWSER_END, this._onShowApp, this);
};
t.prototype._onShowApp = function() {
this && this.node && this.node.isValid && this.scheduleOnce(function() {
h.WalletProxy.Instance.sendGetUserWallet();
h.WalletProxy.Instance.sendGetRechargeUserInfo();
p.MonthCardProxy.Instance.sendGetMonthCardList();
});
};
t.prototype.show = function(e, t, o, n, a) {
var i = this;
void 0 === t && (t = 0);
void 0 === o && (o = !0);
void 0 === a && (a = !1);
this.AlertPanel.setPosition(cc.v2(0, this.node.height / 2 + this.AlertPanel.height / 2));
this.payToggle.node.active = !1;
var l = h.WalletProxy.Instance.rechargeGear.concat();
l.sort(function(e, t) {
return e - t;
});
var d = s.VM.getValue("wallet.total");
this.isRecharge = o;
if (o) {
var p = e - (d - t);
this._amount = l.filter(function(e) {
return e > p;
})[0];
!this._amount && (this._amount = l[0]);
this.Tips_2.string = r.Tools.TStr.replaceAll(m.default.getString("RECHARGE_ALERT_TIP_1"), "%{count}", this._amount);
if (100 == this._amount) {
this.payToggle.node.active = !0;
this.payToggle.isChecked = !0;
this._amount = 200;
this.Tips_2.string = r.Tools.TStr.replaceAll(m.default.getString("RECHARGE_ALERT_TIP_1"), "%{count}", this._amount);
}
} else if (a) {
this._amount = 5e3;
this.Tips_2.string = "Just Recharge ₹" + this._amount + "\ncan be dealer.";
} else {
this._amount = 200;
this.Tips_2.string = r.Tools.TStr.replaceAll(m.default.getString("RECHARGE_ALERT_TIP_2"), "%{count}", this._amount);
this.payToggle.node.active = !0;
this.payToggle.isChecked = !0;
}
this.PayLabel.string = u.MoneySymbol + this._amount;
if (c.default.getInstance().isCashGame) {
this._activityData = h.WalletProxy.Instance.activityList[0];
null != this._activityData && h.WalletProxy.Instance.sendGetRechargeGoods(this._activityData.id, []);
h.WalletProxy.Instance.sendGiftCalculator(this._activityData ? this._activityData.id : 0, this._amount, function(e) {
if (i && i.node && i.node.isValid) {
if (1 == e.code) {
i.Cash.string = e.data.deposit_amount;
i.Bonus.string = e.data.bonus;
i.Bonus.node.parent.active = e.data.bonus > 0;
} else {
i.Cash.string = i._amount + "";
i.Bonus.node.parent.active = !1;
}
i.openAction();
}
});
} else {
this.Cash.string = this._amount + "";
this.Bonus.node.parent.active = !1;
this.openAction();
}
n && n(this);
};
t.prototype.onToggleEventClick = function(e) {
if (e.isChecked) {
this._amount = 200;
this.isRecharge ? this.Tips_2.string = r.Tools.TStr.replaceAll(m.default.getString("RECHARGE_ALERT_TIP_1"), "%{count}", this._amount) : this.Tips_2.string = r.Tools.TStr.replaceAll(m.default.getString("RECHARGE_ALERT_TIP_2"), "%{count}", this._amount);
} else {
this._amount = 100;
this.isRecharge ? this.Tips_2.string = r.Tools.TStr.replaceAll(m.default.getString("RECHARGE_ALERT_TIP_1"), "%{count}", this._amount) : this.Tips_2.string = r.Tools.TStr.replaceAll(m.default.getString("RECHARGE_ALERT_TIP_2"), "%{count}", this._amount);
}
};
t.prototype.close = function() {
this.closeAction(function() {});
};
t.prototype.openAction = function() {
this.AlertPanel.stopAllActions();
this.AlertPanel.setPosition(cc.v2(0, this.node.height / 2 + this.AlertPanel.height / 2));
this.AlertPanel.runAction(cc.moveTo(.1, cc.v2(0, 0)));
};
t.prototype.closeAction = function(e) {
var t = this;
this.AlertPanel.stopAllActions();
this.AlertPanel.setPosition(cc.v2(0, 0));
this.AlertPanel.runAction(cc.sequence(cc.moveTo(.1, cc.v2(0, -(this.node.height / 2 + this.AlertPanel.height / 2))), cc.callFunc(function() {
e && e();
t.node.removeFromParent(!0);
t.node.destroy();
})));
};
t.prototype.onAddCashClicked = function() {
var e = this;
_.default.Instance.openRechargeView(function() {
_.default.Instance.openRecharge({
activityId: e._activityData ? e._activityData.id : 0,
cash: e._amount
});
}, this._amount, this._activityData ? this._activityData.id : 0);
};
t.prototype.onOtherAmountClicked = function() {
this.close();
f.default.Instance.openOtherAmountView();
};
t.prototype.onBackClicked = function() {
this.close();
};
i([ v(cc.Node) ], t.prototype, "AlertPanel", void 0);
i([ v(cc.Label) ], t.prototype, "Tips_2", void 0);
i([ v(cc.Label) ], t.prototype, "Cash", void 0);
i([ v(cc.Label) ], t.prototype, "Bonus", void 0);
i([ v(cc.Label) ], t.prototype, "PayLabel", void 0);
i([ v(cc.Toggle) ], t.prototype, "payToggle", void 0);
return i([ g ], t);
}(cc.Component);
o.default = C;
cc._RF.pop();
}, {
"../../../../Game/Script/global/GlobalValue": "GlobalValue",
"../../../../Game/client/global/enum/game/Const": "Const",
"../../../../Game/client/global/enum/game/Event": "Event",
"../../../../Game/client/model/LanguageModel": "LanguageModel",
"../../../../Game/fromework/global/Tools": "Tools",
"../../../../Game/fromework/helper/EventHelper": "EventHelper",
"../../../../Game/fromework/mvvm/modelView/ViewModel": "ViewModel",
"../../../model/MonthCardModel": "MonthCardModel",
"../../../model/WalletModel": "WalletModel",
"../../Wallet/WalletHelper": "WalletHelper",
"../../active/ActiveManager": "ActiveManager"
} ],
RechargeView: [ function(e, t, o) {
"use strict";
cc._RF.push(t, "7d13ctmUJFGEJ4XgyIpNi6N", "RechargeView");
var n, a = this && this.__extends || (n = function(e, t) {
return (n = Object.setPrototypeOf || {
__proto__: []
} instanceof Array && function(e, t) {
e.__proto__ = t;
} || function(e, t) {
for (var o in t) Object.prototype.hasOwnProperty.call(t, o) && (e[o] = t[o]);
})(e, t);
}, function(e, t) {
n(e, t);
function o() {
this.constructor = e;
}
e.prototype = null === t ? Object.create(t) : (o.prototype = t.prototype, new o());
}), i = this && this.__decorate || function(e, t, o, n) {
var a, i = arguments.length, r = i < 3 ? t : null === n ? n = Object.getOwnPropertyDescriptor(t, o) : n;
if ("object" == typeof Reflect && "function" == typeof Reflect.decorate) r = Reflect.decorate(e, t, o, n); else for (var l = e.length - 1; l >= 0; l--) (a = e[l]) && (r = (i < 3 ? a(r) : i > 3 ? a(t, o, r) : a(t, o)) || r);
return i > 3 && r && Object.defineProperty(t, o, r), r;
};
Object.defineProperty(o, "__esModule", {
value: !0
});
var r = e("../../../Game/client/global/enum/game/Const"), l = e("../../../Game/fromework/helper/EventHelper"), s = e("../../../Game/fromework/helper/UIHelper"), c = e("../../../platform/Platform"), u = e("../../../Game/client/global/enum/game/Event"), d = e("../../model/MonthCardModel"), p = e("../../model/UserModel"), h = e("../../model/WalletModel"), f = cc._decorator, _ = f.ccclass, m = f.property, y = function(e) {
a(t, e);
function t() {
var t = null !== e && e.apply(this, arguments) || this;
t.RechargeView = null;
t.ProgressNode = null;
t.isClose = !1;
t.isOpenURL = !1;
return t;
}
t.prototype.start = function() {
var e = this;
this.isClose = !1;
if (cc.sys.isNative) {
this.RechargeView.setJavascriptInterfaceScheme("rechargecallback");
this.RechargeView.setOnJSCallback(function(t, o) {
c.default.log("rechargecallback:" + o);
var n = e.getParam(o.replace("rechargecallback://", ""));
e.onNativeHtmlCallFunc(t, n);
});
}
if (cc.sys.isBrowser) {
window.addEventListener("message", function(e) {
window.onWebCallFunc(e);
});
window.onWebCallFunc = this.onWebCallFunc.bind(this);
}
};
t.prototype.getParam = function(e) {
for (var t = e.split("&"), o = {}, n = 0; n < t.length; n++) {
var a = t[n].split("=");
o[a[0]] = a[1];
}
return o;
};
t.prototype.onNativeHtmlCallFunc = function(e, t) {
c.default.log("rechargecallback onNativeHtmlCallFunc" + t);
"close" == t.func && this.onCloseClicked();
"rechargeCallFunc" == t.func && h.WalletProxy.Instance.sendAppWeb();
if ("openURL" == t.func) {
cc.sys.openURL(t.url);
this.isOpenURL = !0;
}
};
t.prototype.onLoad = function() {
cc.game.on(cc.game.EVENT_SHOW, this._onShowApp, this);
};
t.prototype.onDestroy = function() {
cc.sys.isBrowser && window.removeEventListener("message", function(e) {
window.onWebCallFunc(e);
});
cc.game.off(cc.game.EVENT_SHOW, this._onShowApp, this);
};
t.prototype._onShowApp = function() {
this && this.node && this.node.isValid && this.isOpenURL && !this.isClose && this.onCloseClicked();
};
t.prototype.onWebCallFunc = function() {
this.onCloseClicked();
};
t.prototype.InitView = function(e) {
this.RechargeView.url = e;
};
t.prototype.rechargeViewEvent = function(e, t) {
t === cc.WebView.EventType.LOADED ? this.ProgressNode.active = !1 : t === cc.WebView.EventType.LOADING ? this.ProgressNode.active = !0 : t === cc.WebView.EventType.ERROR && (this.ProgressNode.active = !1);
};
t.prototype.onCloseClicked = function() {
if (this && this.node && this.node.isValid && !this.isClose) {
this.isClose = !0;
h.WalletProxy.Instance.startRechargeAmtTime(30);
h.WalletProxy.Instance.sendGetUserWallet();
h.WalletProxy.Instance.sendGetRechargeUserInfo();
h.WalletProxy.Instance.sendGetActivityList();
p.default.Instance.sendGetVIPInfo();
d.MonthCardProxy.Instance.sendGetMonthCardList();
l.default.Instance.Global.emit(u.WalletEvent.RECHARGE_CLOSE_WEBVIEW);
s.default.Instance.removeMaskLayer(this.node);
c.default.setOrientation(r.Orientation.Landscape);
}
};
i([ m(cc.WebView) ], t.prototype, "RechargeView", void 0);
i([ m(cc.Node) ], t.prototype, "ProgressNode", void 0);
return i([ _ ], t);
}(cc.Component);
o.default = y;
cc._RF.pop();
}, {
"../../../Game/client/global/enum/game/Const": "Const",
"../../../Game/client/global/enum/game/Event": "Event",
"../../../Game/fromework/helper/EventHelper": "EventHelper",
"../../../Game/fromework/helper/UIHelper": "UIHelper",
"../../../platform/Platform": "Platform",
"../../model/MonthCardModel": "MonthCardModel",
"../../model/UserModel": "UserModel",
"../../model/WalletModel": "WalletModel"
} ],
RedDotModel: [ function(e, t, o) {
"use strict";
cc._RF.push(t, "b7b92dOmtVCXqkxj/GDhtfs", "RedDotModel");
Object.defineProperty(o, "__esModule", {
value: !0
});
o.RedDotProxy = void 0;
var n = e("../logic/ui/Task/TaskModel"), a = e("../Festival/Common/FestivalEvent"), i = e("./RecentModel"), r = e("../../Game/fromework/helper/EventHelper"), l = e("../../Game/client/global/enum/net/S2C"), s = e("../../Game/client/global/enum/game/Event"), c = e("../../Game/client/global/enum/game/Game"), u = e("../../Game/fromework/net/NetHttp"), d = e("../../Game/Script/global/GlobalValue"), p = e("../../Game/fromework/mvvm/modelView/ViewModel"), h = e("../../Game/fromework/global/Tools"), f = e("./WalletModel"), _ = e("./MonthCardModel"), m = function() {
function e() {}
Object.defineProperty(e, "Instance", {
get: function() {
e._instance || (e._instance = new e());
return e._instance;
},
enumerable: !1,
configurable: !0
});
e.prototype.Init = function() {
r.default.Instance.Net.bind(l.S2C.SERVER.RED_DOT, this.refreshRedDot, this);
};
e.prototype.clear = function() {
r.default.Instance.Net.unbind(l.S2C.SERVER.RED_DOT, this.refreshRedDot, this);
};
e.prototype.refreshRedDot = function(e) {
var t = e.getUserData();
if (1 == t.type) {
r.default.Instance.Global.emit(s.RedDotEvent.REFRESH_RED_DOT_DATA, {
key: c.GameEnum.RedDotKey.Task,
value: t.sub_type
});
n.TaskProxy.Instance.taskLobbyData = t.data;
} else if (2 == t.type) r.default.Instance.Global.emit(s.RedDotEvent.REFRESH_RED_DOT_DATA, {
key: c.GameEnum.RedDotKey.Mail,
value: t.sub_type
}); else if (3 == t.type) r.default.Instance.Global.emit(s.RedDotEvent.REFRESH_RED_DOT_DATA, {
key: c.GameEnum.RedDotKey.Festival + t.data.aid,
value: t.sub_type
}); else if (4 == t.type) r.default.Instance.Global.emit(a.FestivalEvent.FESTIVAL_UI_RECHARGE); else if (5 == t.type) ; else if (6 == t.type) i.RecentProxy.Instance.addLobbyLog(t.data); else if (7 == t.type) {
r.default.Instance.Global.emit(a.FestivalEvent.HALL_MONTH_CARD_UI_RECHARGE);
_.MonthCardProxy.Instance.sendGetNewMonthCardList();
} else 8 == t.type && f.WalletProxy.Instance.sendGetUserWallet();
};
e.prototype.onGetRedDotStatus = function(e) {
var t = JSON.parse(e.response);
1 == t.code && Object.keys(t.data).forEach(function(e) {
null != t.data[e] && r.default.Instance.Global.emit(s.RedDotEvent.REFRESH_RED_DOT_DATA, {
key: e,
value: t.data[e]
});
});
};
e.prototype.onReadRedDotStatus = function(e) {
var t = JSON.parse(e.response);
1 == t.code && Object.keys(t.data).forEach(function(e) {
null != t.data[e] && r.default.Instance.Global.emit(s.RedDotEvent.REFRESH_RED_DOT_DATA, {
key: e,
value: t.data[e]
});
});
};
e.prototype.sendGetRedDotStatus = function() {
u.default.Instance.post(d.default.getInstance().WalletUrl + "checkRedDot", {
uid: p.VM.getValue("user.uid"),
token: p.VM.getValue("user.token")
}, this.onGetRedDotStatus.bind(this), !0);
};
e.prototype.sendReadRedDot = function(e) {
u.default.Instance.post(d.default.getInstance().WalletUrl + "readRedDot", {
uid: p.VM.getValue("user.uid"),
token: p.VM.getValue("user.token"),
field: e
}, this.onReadRedDotStatus.bind(this), !0);
};
e._instance = null;
return e;
}();
o.RedDotProxy = m;
var y = function() {
function e() {
this._map = new Map();
this._noticeRedDot = new Map();
this._rechargeRedDot = new Map();
this._loginState = {};
}
Object.defineProperty(e, "Instance", {
get: function() {
e._instance || (e._instance = new e());
return e._instance;
},
enumerable: !1,
configurable: !0
});
e.prototype.Init = function() {
r.default.Instance.Global.bind(s.RedDotEvent.REFRESH_RED_DOT_DATA, this.refreshRedDot, this);
};
e.prototype.clear = function() {
this._map.clear();
this._noticeRedDot.clear();
this._loginState = {};
};
e.prototype.refreshRedDot = function(e) {
var t = e.getUserData();
this._map.set(t.key, t.value);
r.default.Instance.Global.emit(s.RedDotEvent.REFRESH_RED_DOT);
};
e.prototype.getState = function(e) {
return this._map.has(e) ? this._map.get(e) : 0;
};
Object.defineProperty(e.prototype, "noticeRedDot", {
get: function() {
return this._noticeRedDot;
},
enumerable: !1,
configurable: !0
});
e.prototype.refreshNotice = function(e) {
var t = this;
0 == this._noticeRedDot.size && e.forEach(function(e) {
var o = c.GameEnum.RedDotKey.Notice + e.key, n = e.red_dot ? 1 : 0;
t._noticeRedDot.set(o, n);
t._map.set(o, n);
});
var o = 0;
this._noticeRedDot.forEach(function(e) {
1 == e && o++;
});
this._map.set(c.GameEnum.RedDotKey.Notice, o);
r.default.Instance.Global.emit(s.RedDotEvent.REFRESH_RED_DOT);
};
e.prototype.delNoticeRedDot = function(e) {
var t = c.GameEnum.RedDotKey.Notice + e;
if (this._noticeRedDot.has(t)) {
this._noticeRedDot.set(t, 0);
this._map.set(t, 0);
}
var o = 0;
this._noticeRedDot.forEach(function(e) {
1 == e && o++;
});
this._map.set(c.GameEnum.RedDotKey.Notice, o);
r.default.Instance.Global.emit(s.RedDotEvent.REFRESH_RED_DOT);
};
Object.defineProperty(e.prototype, "rechargeRedDot", {
get: function() {
return this._rechargeRedDot;
},
enumerable: !1,
configurable: !0
});
e.prototype.refreshRecharge = function(t) {
var o = this;
0 == this._rechargeRedDot.size && t.forEach(function(t) {
var n = c.GameEnum.RedDotKey.RechargeActivity + t.id, a = e.Instance.checkRedDotTime(n, t.red_dot_type) ? 1 : 0;
o._rechargeRedDot.set(n, a);
o._map.set(n, a);
});
var n = 0;
this._rechargeRedDot.forEach(function(e) {
1 == e && n++;
});
this._map.set(c.GameEnum.RedDotKey.RechargeActivity, n);
r.default.Instance.Global.emit(s.RedDotEvent.REFRESH_RED_DOT);
};
e.prototype.delRechargeRedDot = function(e) {
var t = c.GameEnum.RedDotKey.RechargeActivity + e.id;
if (this._rechargeRedDot.has(t)) {
this._rechargeRedDot.set(t, 0);
this._map.set(t, 0);
this.setRedDotTime(t, e.red_dot_type);
}
var o = 0;
this._rechargeRedDot.forEach(function(e) {
1 == e && o++;
});
this._map.set(c.GameEnum.RedDotKey.RechargeActivity, o);
r.default.Instance.Global.emit(s.RedDotEvent.REFRESH_RED_DOT);
};
e.prototype.checkRedDotTime = function(e, t) {
void 0 === t && (t = 0);
if (1 == t) return 1 != this._loginState[e];
if (2 == t) {
var o = parseInt(cc.sys.localStorage.getItem(e));
return !!isNaN(o) || !h.Tools.TDate.isTheSameLocalDay(new Date().getTime(), o);
}
return !1;
};
e.prototype.setRedDotTime = function(e, t) {
void 0 === t && (t = 0);
1 == t && (this._loginState[e] = !0);
if (2 == t) {
var o = new Date().getTime();
cc.sys.localStorage.setItem(e, String(o));
}
};
e._instance = null;
return e;
}();
o.default = y;
cc._RF.pop();
}, {
"../../Game/Script/global/GlobalValue": "GlobalValue",
"../../Game/client/global/enum/game/Event": "Event",
"../../Game/client/global/enum/game/Game": "Game",
"../../Game/client/global/enum/net/S2C": "S2C",
"../../Game/fromework/global/Tools": "Tools",
"../../Game/fromework/helper/EventHelper": "EventHelper",
"../../Game/fromework/mvvm/modelView/ViewModel": "ViewModel",
"../../Game/fromework/net/NetHttp": "NetHttp",
"../Festival/Common/FestivalEvent": "FestivalEvent",
"../logic/ui/Task/TaskModel": "TaskModel",
"./MonthCardModel": "MonthCardModel",
"./RecentModel": "RecentModel",
"./WalletModel": "WalletModel"
} ],
RedDot: [ function(e, t, o) {
"use strict";
cc._RF.push(t, "5780apakedBBbrXFEFleiF6", "RedDot");
var n, a = this && this.__extends || (n = function(e, t) {
return (n = Object.setPrototypeOf || {
__proto__: []
} instanceof Array && function(e, t) {
e.__proto__ = t;
} || function(e, t) {
for (var o in t) Object.prototype.hasOwnProperty.call(t, o) && (e[o] = t[o]);
})(e, t);
}, function(e, t) {
n(e, t);
function o() {
this.constructor = e;
}
e.prototype = null === t ? Object.create(t) : (o.prototype = t.prototype, new o());
}), i = this && this.__decorate || function(e, t, o, n) {
var a, i = arguments.length, r = i < 3 ? t : null === n ? n = Object.getOwnPropertyDescriptor(t, o) : n;
if ("object" == typeof Reflect && "function" == typeof Reflect.decorate) r = Reflect.decorate(e, t, o, n); else for (var l = e.length - 1; l >= 0; l--) (a = e[l]) && (r = (i < 3 ? a(r) : i > 3 ? a(t, o, r) : a(t, o)) || r);
return i > 3 && r && Object.defineProperty(t, o, r), r;
};
Object.defineProperty(o, "__esModule", {
value: !0
});
var r = e("../../Game/client/global/enum/game/Event"), l = e("../../Game/fromework/helper/EventHelper"), s = e("../model/RedDotModel"), c = cc._decorator, u = c.ccclass, d = c.property, p = function(e) {
a(t, e);
function t() {
var t = null !== e && e.apply(this, arguments) || this;
t.Binds = [];
t.CountLabel = null;
t.isBindEvent = !1;
return t;
}
t.prototype.__preload = function() {
if (!this.isBindEvent) {
this.isBindEvent = !0;
l.default.Instance.Global.bind(r.RedDotEvent.REFRESH_RED_DOT, this.refresh, this);
this.refresh();
}
};
t.prototype.onDestroy = function() {
l.default.Instance.Global.unbind(r.RedDotEvent.REFRESH_RED_DOT, this.refresh, this);
};
t.prototype.refresh = function() {
for (var e = 0, t = 0; t < this.Binds.length; t++) {
null == (e = s.default.Instance.getState(this.Binds[t])) && (e = 0);
if (e > 0) break;
}
if (e > 0) {
e > 99 && (e = 99);
this.node.active = !0;
this.CountLabel && (this.CountLabel.string = String(e));
} else this.node.active = !1;
};
t.prototype.setBindKeys = function(e) {
if (!this.isBindEvent) {
this.isBindEvent = !0;
l.default.Instance.Global.bind(r.RedDotEvent.REFRESH_RED_DOT, this.refresh, this);
}
this.Binds = e;
this.refresh();
};
i([ d([ cc.String ]) ], t.prototype, "Binds", void 0);
i([ d(cc.Label) ], t.prototype, "CountLabel", void 0);
return i([ u ], t);
}(cc.Component);
o.default = p;
cc._RF.pop();
}, {
"../../Game/client/global/enum/game/Event": "Event",
"../../Game/fromework/helper/EventHelper": "EventHelper",
"../model/RedDotModel": "RedDotModel"
} ],
ReferEarn: [ function(e, t, o) {
"use strict";
cc._RF.push(t, "31037cC/5tDE4gH2mnxTBdn", "ReferEarn");
var n, a = this && this.__extends || (n = function(e, t) {
return (n = Object.setPrototypeOf || {
__proto__: []
} instanceof Array && function(e, t) {
e.__proto__ = t;
} || function(e, t) {
for (var o in t) Object.prototype.hasOwnProperty.call(t, o) && (e[o] = t[o]);
})(e, t);
}, function(e, t) {
n(e, t);
function o() {
this.constructor = e;
}
e.prototype = null === t ? Object.create(t) : (o.prototype = t.prototype, new o());
}), i = this && this.__decorate || function(e, t, o, n) {
var a, i = arguments.length, r = i < 3 ? t : null === n ? n = Object.getOwnPropertyDescriptor(t, o) : n;
if ("object" == typeof Reflect && "function" == typeof Reflect.decorate) r = Reflect.decorate(e, t, o, n); else for (var l = e.length - 1; l >= 0; l--) (a = e[l]) && (r = (i < 3 ? a(r) : i > 3 ? a(t, o, r) : a(t, o)) || r);
return i > 3 && r && Object.defineProperty(t, o, r), r;
};
Object.defineProperty(o, "__esModule", {
value: !0
});
var r = e("../../../../Game/Script/global/GlobalValue"), l = e("../../../../Game/client/global/enum/game/UIUtils"), s = e("../../../../Game/fromework/helper/UIHelper"), c = e("../../../../Game/fromework/mvvm/modelView/ViewModel"), u = e("../../../../fromework/component/TableView/TableList"), d = e("../../../../platform/Platform"), p = e("../../../global/PopHelper"), h = e("../../../model/InviteModel"), f = e("../../../model/ReferModel"), _ = e("../../Wallet/WalletHelper"), m = e("../../active/ActiveModel"), y = cc._decorator, g = y.ccclass, v = y.property, C = function(e) {
a(t, e);
function t() {
var t = null !== e && e.apply(this, arguments) || this;
t.planeDash = null;
t.planeRules = null;
t.planeReferrals = null;
t.planeDaily = null;
t.AgentNode = null;
t._data = null;
t.pageIndex = 1;
t.pageSize = 5;
t.pageMax = 1;
t.referralsList = null;
t.rewardList = null;
return t;
}
t.prototype.start = function() {
this.getData();
};
t.prototype.toggleClick = function(e, t) {
if (1 == t) {
this.planeDash.active = !0;
this.planeRules.active = !1;
this.planeReferrals.active = !1;
this.planeDaily.active = !1;
} else if (2 == t) {
this.planeDash.active = !1;
this.planeRules.active = !0;
this.planeReferrals.active = !1;
this.planeDaily.active = !1;
} else if (3 == t) {
this.planeDash.active = !1;
this.planeRules.active = !1;
this.planeReferrals.active = !0;
this.planeDaily.active = !1;
null == this.referralsList && this.getReferralsList();
} else if (4 == t) {
this.planeDash.active = !1;
this.planeRules.active = !1;
this.planeReferrals.active = !1;
this.planeDaily.active = !0;
null == this.rewardList && this.getReferralsRewardList();
}
};
t.prototype.agentClick = function() {
this.AgentNode.active = !0;
};
t.prototype.agentCloseClick = function() {
this.AgentNode.active = !1;
};
t.prototype.showDashView = function(e) {
this.planeDash.getChildByName("userInfo").getChildByName("id").getComponent(cc.Label).string = "ID:" + c.VM.getValue("user.uid");
this.planeDash.getChildByName("userInfo").getChildByName("name").getComponent(cc.Label).string = c.VM.getValue("user.name");
var t = this.planeDash.getChildByName("userInfo").getChildByName("Mask").getChildByName("HeadImage").getComponent(cc.Sprite);
this._refreshHeadImg(t, null);
this.planeDash.getChildByName("userInfo").getChildByName("money").getComponent(cc.Label).string = e.remain_reward;
this.planeDash.getChildByName("userInfo").getChildByName("referrals").getChildByName("Num").getComponent(cc.Label).string = e.total_referrals;
this.planeDash.getChildByName("userInfo").getChildByName("reward").getChildByName("Num").getComponent(cc.Label).string = e.total_reward;
this.planeDash.getChildByName("rewardTaday").getChildByName("Num").getComponent(cc.Label).string = e.today_reward;
this.planeDash.getChildByName("referralsTaday").getChildByName("Num").getComponent(cc.Label).string = e.today_referrals;
this.planeDash.getChildByName("url").getChildByName("urlLabel").getComponent(cc.Label).string = "url: " + r.default.getInstance().InviteTargetLink;
};
t.prototype._refreshHeadImg = function(e, t) {
var o = c.VM.getValue("user.headUrl");
null != t && (o = t);
o && "" != o && l.UIUtils.updateHeadImage(o, e, cc.size(110, 110));
};
t.prototype.showRulesView = function() {};
t.prototype.showReferralsView = function(e) {
this.planeReferrals.getChildByName("noNode").active = !1;
e && e.list_data && e.list_data.length > 0 ? this.planeReferrals.getChildByName("referralsTableList").getComponent(u.default).numItems = e.list_data.length : this.planeReferrals.getChildByName("noNode").active = !0;
this.planeReferrals.getChildByName("shuzidi").getChildByName("numLabel").getComponent(cc.Label).string = this.pageIndex + "/" + this.pageMax;
};
t.prototype.onReferralsListRender = function(e, t) {
if (e.isValid) {
e.active = !0;
var o = this.referralsList.list_data[t];
e.getChildByName("ID").getComponent(cc.Label).string = o.uid;
e.getChildByName("Recharge").getComponent(cc.Label).string = o.recharge;
e.getChildByName("bet").getComponent(cc.Label).string = o.bet;
e.getChildByName("total").getComponent(cc.Label).string = o.reward;
}
};
t.prototype.showDailyView = function(e) {
this.planeDaily.getChildByName("noNode").active = !1;
e && e.length > 0 ? this.planeDaily.getChildByName("dailyTableList").getComponent(u.default).numItems = e.length : this.planeDaily.getChildByName("noNode").active = !0;
};
t.prototype.onDailyListRender = function(e, t) {
if (e.isValid) {
e.active = !0;
var o = this.rewardList[t];
e.getChildByName("Date").getComponent(cc.Label).string = o.date;
e.getChildByName("Recharge").getComponent(cc.Label).string = o.recharge_reward;
e.getChildByName("bet").getComponent(cc.Label).string = o.bet_reward;
e.getChildByName("total").getComponent(cc.Label).string = o.total_reward;
}
};
t.prototype.clockClose = function() {
s.default.Instance.removeLayer(this.node, !0);
};
t.prototype.getData = function() {
var e = this;
m.ActiveProxy.Instance.getReferEarnData(function(t) {
if (t && e.node.isValid) {
e._data = t;
e.showDashView(t);
}
});
};
t.prototype.onShareClicked = function() {
var e = h.InviteModel.Instance.createLink;
null != e && "" != e || (e = f.ReferProxy.Instance.getReferUrl());
if ("" != e) {
f.ReferProxy.Instance.sendCreatePull();
f.ReferProxy.Instance.sendPrepareToShare();
cc.sys.os == cc.sys.OS_ANDROID && cc.sys.isNative && jsb.reflection.callStaticMethod("org.cocos2dx.lib/Cocos2dxHelper", "copyTextToClipboard", "(Ljava/lang/String;)V", e);
d.default.logEvent("share");
d.default.sendEvent("share");
p.PopHelper.Instance.showTips("Copied, please open whatsapp or facebook to paste and share");
}
};
t.prototype.withDrawClick = function() {
_.default.Instance.openWithdraw();
};
t.prototype.addPage = function() {
if (this.pageIndex < this.pageMax) {
this.pageIndex = this.pageIndex + 1;
this.getReferralsList();
} else p.PopHelper.Instance.showTips("It's the last page!");
};
t.prototype.disPage = function() {
if (this.pageIndex > 1) {
this.pageIndex = this.pageIndex - 1;
this.getReferralsList();
} else p.PopHelper.Instance.showTips("It's already the first page!");
};
t.prototype.referPage = function() {
this.getReferralsList();
};
t.prototype.getReferralsList = function() {
var e = this;
m.ActiveProxy.Instance.getReferEarnListData(this.pageIndex, this.pageSize, function(t) {
if (t && e.node.isValid) {
e.referralsList = t;
e.pageMax = Math.ceil(t.total_count / e.pageSize);
e.showReferralsView(t);
}
});
};
t.prototype.getReferralsRewardList = function() {
var e = this;
m.ActiveProxy.Instance.getReferralsRewardData(function(t) {
if (t && e.node.isValid) {
e.rewardList = t;
e.showDailyView(t);
}
});
};
i([ v(cc.Node) ], t.prototype, "planeDash", void 0);
i([ v(cc.Node) ], t.prototype, "planeRules", void 0);
i([ v(cc.Node) ], t.prototype, "planeReferrals", void 0);
i([ v(cc.Node) ], t.prototype, "planeDaily", void 0);
i([ v(cc.Node) ], t.prototype, "AgentNode", void 0);
return i([ g ], t);
}(cc.Component);
o.default = C;
cc._RF.pop();
}, {
"../../../../Game/Script/global/GlobalValue": "GlobalValue",
"../../../../Game/client/global/enum/game/UIUtils": "UIUtils",
"../../../../Game/fromework/helper/UIHelper": "UIHelper",
"../../../../Game/fromework/mvvm/modelView/ViewModel": "ViewModel",
"../../../../fromework/component/TableView/TableList": "TableList",
"../../../../platform/Platform": "Platform",
"../../../global/PopHelper": "PopHelper",
"../../../model/InviteModel": "InviteModel",
"../../../model/ReferModel": "ReferModel",
"../../Wallet/WalletHelper": "WalletHelper",
"../../active/ActiveModel": "ActiveModel"
} ],
ReferHelp: [ function(e, t, o) {
"use strict";
cc._RF.push(t, "a0c0bR7gB5DQb6BIH7NOqvQ", "ReferHelp");
var n, a = this && this.__extends || (n = function(e, t) {
return (n = Object.setPrototypeOf || {
__proto__: []
} instanceof Array && function(e, t) {
e.__proto__ = t;
} || function(e, t) {
for (var o in t) Object.prototype.hasOwnProperty.call(t, o) && (e[o] = t[o]);
})(e, t);
}, function(e, t) {
n(e, t);
function o() {
this.constructor = e;
}
e.prototype = null === t ? Object.create(t) : (o.prototype = t.prototype, new o());
}), i = this && this.__decorate || function(e, t, o, n) {
var a, i = arguments.length, r = i < 3 ? t : null === n ? n = Object.getOwnPropertyDescriptor(t, o) : n;
if ("object" == typeof Reflect && "function" == typeof Reflect.decorate) r = Reflect.decorate(e, t, o, n); else for (var l = e.length - 1; l >= 0; l--) (a = e[l]) && (r = (i < 3 ? a(r) : i > 3 ? a(t, o, r) : a(t, o)) || r);
return i > 3 && r && Object.defineProperty(t, o, r), r;
};
Object.defineProperty(o, "__esModule", {
value: !0
});
var r = e("../../../../Game/fromework/global/Tools"), l = e("../../../../Game/fromework/helper/UIHelper"), s = e("../../../../Game/client/model/LanguageModel"), c = e("../../../model/ReferModel"), u = cc._decorator, d = u.ccclass, p = u.property, h = function(e) {
a(t, e);
function t() {
var t = null !== e && e.apply(this, arguments) || this;
t.HelpLabel_1 = null;
t.HelpLabel_2 = null;
t.HelpLabel_3 = null;
t.HelpLabel_4 = null;
t.HelpLabel_5 = null;
return t;
}
t.prototype.onLoad = function() {
this.HelpLabel_1.string = s.default.getString("REFER_HELP_STR_1");
if (c.ReferProxy.Instance.levelSwitch) {
this.HelpLabel_5.node.active = !0;
this.HelpLabel_5.string = s.default.getString("REFER_HELP_STR_5");
this.HelpLabel_2.string = s.default.getString("REFER_HELP_STR_2_1");
} else {
this.HelpLabel_5.node.active = !1;
this.HelpLabel_2.string = r.Tools.TStr.replaceString(s.default.getString("REFER_HELP_STR_2"), {
num: 100 * c.ReferProxy.Instance.inviteBoxData.rate
});
}
this.HelpLabel_3.string = s.default.getString("REFER_HELP_STR_3");
this.HelpLabel_4.string = s.default.getString("REFER_HELP_STR_4");
};
t.prototype.onCloseClicked = function() {
l.default.Instance.removeMaskLayer(this.node, !0);
};
i([ p(cc.Label) ], t.prototype, "HelpLabel_1", void 0);
i([ p(cc.Label) ], t.prototype, "HelpLabel_2", void 0);
i([ p(cc.Label) ], t.prototype, "HelpLabel_3", void 0);
i([ p(cc.Label) ], t.prototype, "HelpLabel_4", void 0);
i([ p(cc.Label) ], t.prototype, "HelpLabel_5", void 0);
return i([ d ], t);
}(cc.Component);
o.default = h;
cc._RF.pop();
}, {
"../../../../Game/client/model/LanguageModel": "LanguageModel",
"../../../../Game/fromework/global/Tools": "Tools",
"../../../../Game/fromework/helper/UIHelper": "UIHelper",
"../../../model/ReferModel": "ReferModel"
} ],
ReferInviteBox: [ function(e, t, o) {
"use strict";
cc._RF.push(t, "8d8e358UTNLapdseluGycvm", "ReferInviteBox");
var n, a = this && this.__extends || (n = function(e, t) {
return (n = Object.setPrototypeOf || {
__proto__: []
} instanceof Array && function(e, t) {
e.__proto__ = t;
} || function(e, t) {
for (var o in t) Object.prototype.hasOwnProperty.call(t, o) && (e[o] = t[o]);
})(e, t);
}, function(e, t) {
n(e, t);
function o() {
this.constructor = e;
}
e.prototype = null === t ? Object.create(t) : (o.prototype = t.prototype, new o());
}), i = this && this.__decorate || function(e, t, o, n) {
var a, i = arguments.length, r = i < 3 ? t : null === n ? n = Object.getOwnPropertyDescriptor(t, o) : n;
if ("object" == typeof Reflect && "function" == typeof Reflect.decorate) r = Reflect.decorate(e, t, o, n); else for (var l = e.length - 1; l >= 0; l--) (a = e[l]) && (r = (i < 3 ? a(r) : i > 3 ? a(t, o, r) : a(t, o)) || r);
return i > 3 && r && Object.defineProperty(t, o, r), r;
};
Object.defineProperty(o, "__esModule", {
value: !0
});
var r = e("../../../../Game/client/model/LanguageModel"), l = e("../../../../Game/fromework/global/Tools"), s = e("../../../global/PopHelper"), c = e("../../../model/ReferModel"), u = cc._decorator, d = u.ccclass, p = u.property, h = function(e) {
a(t, e);
function t() {
var t = null !== e && e.apply(this, arguments) || this;
t.Progress = null;
t.InviteNum = null;
t.Conditions = [];
t.BoxParent = null;
t.BoxPrefabs = [];
t.boxSprite = [];
t._dataList = [];
return t;
}
t.prototype.refreshView = function() {
this._dataList = c.ReferProxy.Instance.getInviteBoxData();
this.refreshCindition();
this.refreshBox();
this.refreshProgress();
};
t.prototype.refreshCindition = function() {
for (var e = 0; e < this.Conditions.length; e++) null != this._dataList[e] && (this.Conditions[e].string = this._dataList[e].condition.toString());
};
t.prototype.refreshBox = function() {
this.BoxParent.destroyAllChildren();
for (var e = 0; e < this._dataList.length; e++) {
var t = this._dataList[e], o = cc.instantiate(this.BoxPrefabs[t.box_type || 0]);
o.setPosition(cc.v3(175 * (e + 1), 0, 0));
o.parent = this.BoxParent;
o.getChildByName("baoxiang").getComponent(cc.Sprite).spriteFrame = this.boxSprite[e];
var n = o.getChildByName("Reward"), a = n.getChildByName("RewardLabel").getComponent(cc.Label);
n.active = 2 != t.state;
a.string = l.Tools.TStr.replaceString("%{money}%{cash1} - %{money}%{cash2}", {
money: r.default.getString("MoneySymbol"),
cash1: t.amt[0],
cash2: t.amt[1]
});
var i = new cc.Component.EventHandler();
i.target = this.node;
i.component = "ReferInviteBox";
i.handler = "onRewardClicked";
i.customEventData = String(e);
o.getChildByName("Button").getComponent(cc.Button).clickEvents.push(i);
}
};
t.prototype.refreshProgress = function() {
for (var e = c.ReferProxy.Instance.inviteBoxData.invite_count, t = 0, o = this._dataList[this._dataList.length - 1].condition, n = 0, a = 0; a < this._dataList.length; a++) {
if (!(e >= this._dataList[a].condition)) {
o = this._dataList[a].condition;
break;
}
n++;
t = this._dataList[a].condition;
}
var i = (e - t) / (o - t) * .2 + .2 * n;
i > 1 && (i = 1);
i < 0 && (i = 0);
this.Progress.progress = i;
this.InviteNum.string = e.toString();
};
t.prototype.onRewardClicked = function(e, t) {
var o = parseInt(t), n = this._dataList[o];
1 == n.state && c.ReferProxy.Instance.inviteBoxData.invite_count >= n.condition ? c.ReferProxy.Instance.sendGetReward(22, n.id) : 0 == n.state && s.PopHelper.Instance.showTips(l.Tools.TStr.replaceAll(r.default.getString("REFER_BOX_END"), "%{count}", n.condition));
};
i([ p(cc.ProgressBar) ], t.prototype, "Progress", void 0);
i([ p(cc.Label) ], t.prototype, "InviteNum", void 0);
i([ p([ cc.Label ]) ], t.prototype, "Conditions", void 0);
i([ p(cc.Node) ], t.prototype, "BoxParent", void 0);
i([ p([ cc.Prefab ]) ], t.prototype, "BoxPrefabs", void 0);
i([ p([ cc.SpriteFrame ]) ], t.prototype, "boxSprite", void 0);
return i([ d ], t);
}(cc.Component);
o.default = h;
cc._RF.pop();
}, {
"../../../../Game/client/model/LanguageModel": "LanguageModel",
"../../../../Game/fromework/global/Tools": "Tools",
"../../../global/PopHelper": "PopHelper",
"../../../model/ReferModel": "ReferModel"
} ],
ReferItem: [ function(e, t, o) {
"use strict";
cc._RF.push(t, "23b73g1mJ9Awaoih4aAGWXV", "ReferItem");
var n, a = this && this.__extends || (n = function(e, t) {
return (n = Object.setPrototypeOf || {
__proto__: []
} instanceof Array && function(e, t) {
e.__proto__ = t;
} || function(e, t) {
for (var o in t) Object.prototype.hasOwnProperty.call(t, o) && (e[o] = t[o]);
})(e, t);
}, function(e, t) {
n(e, t);
function o() {
this.constructor = e;
}
e.prototype = null === t ? Object.create(t) : (o.prototype = t.prototype, new o());
}), i = this && this.__decorate || function(e, t, o, n) {
var a, i = arguments.length, r = i < 3 ? t : null === n ? n = Object.getOwnPropertyDescriptor(t, o) : n;
if ("object" == typeof Reflect && "function" == typeof Reflect.decorate) r = Reflect.decorate(e, t, o, n); else for (var l = e.length - 1; l >= 0; l--) (a = e[l]) && (r = (i < 3 ? a(r) : i > 3 ? a(t, o, r) : a(t, o)) || r);
return i > 3 && r && Object.defineProperty(t, o, r), r;
};
Object.defineProperty(o, "__esModule", {
value: !0
});
var r = e("../../../../Game/client/model/LanguageModel"), l = e("../../../../Game/fromework/global/Tools"), s = cc._decorator, c = s.ccclass, u = s.property, d = function(e) {
a(t, e);
function t() {
var t = null !== e && e.apply(this, arguments) || this;
t.BackColor = [];
t.ItemColor = [];
t.Background = null;
t.InvitedID = null;
t.Name = null;
t.LastRebate = null;
t.TotalRevenue = null;
t.RiskLabel = null;
t._data = null;
return t;
}
t.prototype.refresh = function(e, t) {
this._data = e;
this.node.active = !0;
this.Background.color = this.BackColor[t % 2];
this.InvitedID.string = this._data.id.toString();
this.Name.string = this._data.name;
if (0 == this._data.state) {
this.LastRebate.node.active = !0;
this.TotalRevenue.node.active = !0;
this.RiskLabel.node.active = !1;
this.LastRebate.node.color = this.ItemColor[this._data.bind_phone ? 1 : 2];
this.TotalRevenue.node.color = this.ItemColor[this._data.match_count >= this._data.match_max ? 1 : 2];
this.LastRebate.string = l.Tools.TStr.replaceString(r.default.getString("REFER_BIND_PHONE"), {
num1: this._data.bind_phone ? 1 : 0
});
this.TotalRevenue.string = l.Tools.TStr.replaceString(r.default.getString("REFER_PLAY_GAME"), {
num1: Math.min(this._data.match_count, this._data.match_max),
num2: this._data.match_max
});
this.RiskLabel.node.active = !1;
} else if (1 == this._data.state) {
this.LastRebate.node.active = !1;
this.TotalRevenue.node.active = !1;
this.RiskLabel.node.active = !0;
this.RiskLabel.string = r.default.getString("REFER_RISK_TIP");
} else if (2 == this._data.state) {
this.LastRebate.node.active = !0;
this.TotalRevenue.node.active = !0;
this.RiskLabel.node.active = !1;
this.LastRebate.node.color = this.ItemColor[0];
this.TotalRevenue.node.color = this.ItemColor[0];
0 != this._data.last_rebate ? this.LastRebate.string = l.Tools.TDate.format(1e3 * this._data.last_rebate, "dd/MM/yyyy") : this.LastRebate.string = "-";
this.TotalRevenue.string = r.default.getString("MoneySymbol") + this._data.total_revenue;
}
};
i([ u([ cc.Color ]) ], t.prototype, "BackColor", void 0);
i([ u([ cc.Color ]) ], t.prototype, "ItemColor", void 0);
i([ u(cc.Node) ], t.prototype, "Background", void 0);
i([ u(cc.Label) ], t.prototype, "InvitedID", void 0);
i([ u(cc.Label) ], t.prototype, "Name", void 0);
i([ u(cc.Label) ], t.prototype, "LastRebate", void 0);
i([ u(cc.Label) ], t.prototype, "TotalRevenue", void 0);
i([ u(cc.Label) ], t.prototype, "RiskLabel", void 0);
return i([ c ], t);
}(cc.Component);
o.default = d;
cc._RF.pop();
}, {
"../../../../Game/client/model/LanguageModel": "LanguageModel",
"../../../../Game/fromework/global/Tools": "Tools"
} ],
ReferLevelAlert: [ function(e, t, o) {
"use strict";
cc._RF.push(t, "01344SwIFxNzJovJ51/a1F+", "ReferLevelAlert");
var n, a = this && this.__extends || (n = function(e, t) {
return (n = Object.setPrototypeOf || {
__proto__: []
} instanceof Array && function(e, t) {
e.__proto__ = t;
} || function(e, t) {
for (var o in t) Object.prototype.hasOwnProperty.call(t, o) && (e[o] = t[o]);
})(e, t);
}, function(e, t) {
n(e, t);
function o() {
this.constructor = e;
}
e.prototype = null === t ? Object.create(t) : (o.prototype = t.prototype, new o());
}), i = this && this.__decorate || function(e, t, o, n) {
var a, i = arguments.length, r = i < 3 ? t : null === n ? n = Object.getOwnPropertyDescriptor(t, o) : n;
if ("object" == typeof Reflect && "function" == typeof Reflect.decorate) r = Reflect.decorate(e, t, o, n); else for (var l = e.length - 1; l >= 0; l--) (a = e[l]) && (r = (i < 3 ? a(r) : i > 3 ? a(t, o, r) : a(t, o)) || r);
return i > 3 && r && Object.defineProperty(t, o, r), r;
};
Object.defineProperty(o, "__esModule", {
value: !0
});
var r = e("../../../../fromework/component/TableView/TableList"), l = e("../../../../Game/fromework/helper/UIHelper"), s = e("../../../model/ReferModel"), c = cc._decorator, u = c.ccclass, d = c.property, p = function(e) {
a(t, e);
function t() {
var t = null !== e && e.apply(this, arguments) || this;
t.AlertPanel = null;
t.Level = null;
t.Progress = null;
t.ProgressLabel = null;
t.List = null;
t.panelPos = null;
return t;
}
t.prototype.onLoad = function() {
this.panelPos = this.AlertPanel.position;
};
t.prototype.showView = function() {
this.openAction();
var e = s.ReferProxy.Instance.levelData.level, t = s.ReferProxy.Instance.levelData.amount, o = s.ReferProxy.Instance.getNextLevelData(e), n = t / o.recharge;
n < 0 && (n = 0);
n > 1 && (n = 1);
this.Level.string = "Lv." + e;
this.Progress.progress = n;
this.ProgressLabel.string = t + "/" + o.recharge;
this.List.numItems = s.ReferProxy.Instance.levelData.level_list.length;
};
t.prototype.openAction = function() {
this.AlertPanel.setPosition(cc.v2(0, this.node.height / 2 + this.AlertPanel.height / 2));
cc.tween(this.AlertPanel).to(.1, {
position: this.panelPos
}).start();
};
t.prototype.closeAction = function(e) {
var t = this;
cc.tween(this.AlertPanel).to(.1, {
y: -(this.node.height / 2 + this.AlertPanel.height / 2)
}).call(function() {
e && e.apply(t);
}).start();
};
t.prototype.onListRender = function(e, t) {
var o = s.ReferProxy.Instance.levelData.level_list[t], n = o.level == s.ReferProxy.Instance.levelData.level, a = e.getChildByName("Level").getComponent(cc.Label), i = e.getChildByName("Recharge").getComponent(cc.Label), r = e.getChildByName("Rebate").getComponent(cc.Label);
a.string = o.level.toString();
i.string = o.recharge.toString();
r.string = o.rebate.toString() + "%";
a.node.color = n ? cc.Color.WHITE.fromHEX("#E8BF4B") : cc.Color.WHITE;
i.node.color = n ? cc.Color.WHITE.fromHEX("#E8BF4B") : cc.Color.WHITE;
r.node.color = n ? cc.Color.WHITE.fromHEX("#E8BF4B") : cc.Color.WHITE;
};
t.prototype.onCloseClicked = function() {
var e = this;
this.closeAction(function() {
l.default.Instance.removeMaskLayer(e.node, !0);
});
};
i([ d(cc.Node) ], t.prototype, "AlertPanel", void 0);
i([ d(cc.Label) ], t.prototype, "Level", void 0);
i([ d(cc.ProgressBar) ], t.prototype, "Progress", void 0);
i([ d(cc.Label) ], t.prototype, "ProgressLabel", void 0);
i([ d(r.default) ], t.prototype, "List", void 0);
return i([ u ], t);
}(cc.Component);
o.default = p;
cc._RF.pop();
}, {
"../../../../Game/fromework/helper/UIHelper": "UIHelper",
"../../../../fromework/component/TableView/TableList": "TableList",
"../../../model/ReferModel": "ReferModel"
} ],
ReferModel: [ function(e, t, o) {
"use strict";
cc._RF.push(t, "640131OegtA+LsPAcQgxHUP", "ReferModel");
Object.defineProperty(o, "__esModule", {
value: !0
});
o.ReferProxy = void 0;
var n = e("../../Game/Script/global/GlobalValue"), a = e("../../Game/client/global/enum/game/Event"), i = e("../../Game/client/global/enum/game/Game"), r = e("../../Game/client/global/enum/net/C2S"), l = e("../../Game/client/global/enum/net/S2C"), s = e("../../Game/client/model/CommonModel"), c = e("../../Game/fromework/global/Tools"), u = e("../../Game/fromework/helper/EventHelper"), d = e("../../Game/fromework/mvvm/modelView/ViewModel"), p = e("../../Game/fromework/net/NetHttp"), h = e("../../platform/Platform"), f = e("../../fromework/helper/NetHelper"), _ = e("./InviteModel"), m = e("./WalletModel"), y = function() {
function e() {
this._listCount = 10;
this.page = 0;
this._listTotal = 10;
this._shareContent = "";
this._inviteBoxData = new s.Common.ReferInviteData();
this._inviteListData = [];
this._levelSwitch = !1;
this._levelData = new s.Common.ReferLevelData();
}
Object.defineProperty(e, "Instance", {
get: function() {
e._instance || (e._instance = new e());
return e._instance;
},
enumerable: !1,
configurable: !0
});
Object.defineProperty(e.prototype, "shareContent", {
get: function() {
return this._shareContent;
},
enumerable: !1,
configurable: !0
});
Object.defineProperty(e.prototype, "inviteBoxData", {
get: function() {
return this._inviteBoxData;
},
enumerable: !1,
configurable: !0
});
Object.defineProperty(e.prototype, "inviteListData", {
get: function() {
return this._inviteListData;
},
set: function(e) {
this._inviteListData = e;
},
enumerable: !1,
configurable: !0
});
Object.defineProperty(e.prototype, "levelSwitch", {
get: function() {
return this._levelSwitch;
},
enumerable: !1,
configurable: !0
});
Object.defineProperty(e.prototype, "levelData", {
get: function() {
return this._levelData;
},
enumerable: !1,
configurable: !0
});
e.prototype.getReferUrl = function(e) {
if (null == e) {
(e = {}).invite_id = d.VM.getValue("user.uid");
e.zone = n.default.getInstance().zone;
}
return n.default.getInstance().InviteTargetLink + c.Tools.TUrl.setQueryString(e);
};
e.prototype.getInviteBoxData = function() {
for (var e = this._inviteBoxData.invite_box, t = 0, o = 0, n = 0; n < e.length; n++) {
if (0 == e[n].state || 1 == e[n].state) {
t = n;
break;
}
o++;
}
var a = 5 * Math.floor(t / 5);
o == e.length && (a = e.length - 5);
var i = [];
for (n = a; n < a + 5; n++) null != e[n] && i.push(e[n]);
return i;
};
e.prototype.refreshRedDot = function() {
for (var e = 0, t = 0; t < this.inviteBoxData.invite_box.length; t++) 1 == this.inviteBoxData.invite_box[t].state && e++;
this.inviteBoxData.reward_count > 0 && e++;
u.default.Instance.Global.emit(a.RedDotEvent.REFRESH_RED_DOT_DATA, {
key: i.GameEnum.RedDotKey.Refer,
value: e
});
};
e.prototype.getNextLevelData = function(e) {
for (var t = 0; t < this.levelData.level_list.length; t++) if (this.levelData.level_list[t].level == e + 1) return this.levelData.level_list[t];
return this.levelData.level_list[this.levelData.level_list.length - 1];
};
e.prototype.Init = function() {
u.default.Instance.Net.bind(l.S2C.USER.GET_SHARE_URL, this._onGetShareUrl, this);
};
e.prototype.clear = function() {
this._listCount = 10;
this.page = 0;
this._listTotal = 10;
this._shareContent = "";
this._inviteBoxData = new s.Common.ReferInviteData();
u.default.Instance.Net.unbind(l.S2C.USER.GET_SHARE_URL, this._onGetShareUrl, this);
};
e.prototype._onGetShareUrl = function(e) {
var t = e.getUserData();
this._shareContent = t.share_content;
n.default.getInstance().InviteTargetLink = t.share_url;
n.default.getInstance().zone = t.zone;
_.InviteModel.Instance.refreshDynamicLink(function() {});
u.default.Instance.Global.emit(a.UserEvent.USER_GET_SHARE_URL);
};
e.prototype._onGetInviteList = function(e) {
var t = this, o = JSON.parse(e.response);
this._listTotal = Math.max(o.data.total, 10);
o.data.list.forEach(function(e) {
var o = new s.Common.ReferListData(e);
t._inviteListData.push(o);
});
u.default.Instance.Global.emit(a.ReferEvent.REFER_UI_REFRESH_LIST);
};
e.prototype._onGetReward = function(e) {
var t = JSON.parse(e.response);
this.sendGetInviteBox();
m.WalletProxy.Instance.sendGetUserWallet();
null != t.data && null != t.data.reward && Object.keys(t.data.reward).forEach(function(e) {
t.data.reward[e] = c.Tools.TNumber.num2single(t.data.reward[e]);
});
u.default.Instance.Global.emit(a.ReferEvent.REFER_UI_GET_REWARD, t.data);
};
e.prototype._onGetUserLevel = function(e) {
var t = JSON.parse(e.response);
if (null != t.data && 1 == t.code) {
null == this._levelData && (this._levelData = new s.Common.ReferLevelData());
this._levelData.refresh(t.data);
}
u.default.Instance.Global.emit(a.ReferEvent.REFER_UI_GET_LEVEL);
};
e.prototype.sendGetShareUrl = function() {
var e = f.default.Instance.makeMsg(r.C2S.USER_GET_SHARE_URL, {
u: d.VM.getValue("user.uid"),
t: d.VM.getValue("user.token")
});
f.default.Instance.sendHttp(e);
};
e.prototype.sendCreatePull = function() {
p.default.Instance.get(n.default.getInstance().WalletUrl + "create_pull_new", {
uid: d.VM.getValue("user.uid"),
token: d.VM.getValue("user.token")
}, function() {}, !0);
};
e.prototype.sendBindInvite = function(e) {
p.default.Instance.post(n.default.getInstance().WalletUrl + "bind_invite", {
uid: d.VM.getValue("user.uid"),
token: d.VM.getValue("user.token"),
target_uid: e
}, function() {
h.default.copyTextToClipboard("a");
}, !0);
};
e.prototype.sendGetInviteBox = function() {
var e = this;
p.default.Instance.post(n.default.getInstance().WalletUrl + "invite_get_box", {
uid: d.VM.getValue("user.uid"),
token: d.VM.getValue("user.token")
}, function(t) {
var o = JSON.parse(t.response);
e._inviteBoxData.refresh(o.data);
e._levelSwitch = null != o.level_switch && o.level_switch;
e.refreshRedDot();
u.default.Instance.Global.emit(a.ReferEvent.REFER_UI_REFRESH_BOX);
}, !0);
};
e.prototype.sendGetInviteList = function() {
if (0 == this._listTotal || Math.ceil(this._listTotal / this._listCount) >= this.page + 1) {
this.page++;
p.default.Instance.post(n.default.getInstance().WalletUrl + "invite_get_list", {
uid: d.VM.getValue("user.uid"),
token: d.VM.getValue("user.token"),
page: this.page,
count: this._listCount
}, this._onGetInviteList.bind(this), !0);
}
};
e.prototype.sendGetReward = function(e, t) {
void 0 === t && (t = 0);
p.default.Instance.post(n.default.getInstance().WalletUrl + "invite_get_gift", {
uid: d.VM.getValue("user.uid"),
token: d.VM.getValue("user.token"),
type: e,
box_id: t
}, this._onGetReward.bind(this), !0);
};
e.prototype.sendGetUserLevel = function() {
p.default.Instance.post(n.default.getInstance().WalletUrl + "get_user_pull_level", {
uid: d.VM.getValue("user.uid"),
token: d.VM.getValue("user.token")
}, this._onGetUserLevel.bind(this), !0);
};
e.prototype.sendPrepareToShare = function() {
var e = f.default.Instance.makeMsg(r.C2S.USER_PREPARE_TO_SHARE, {
u: d.VM.getValue("user.uid"),
t: d.VM.getValue("user.token")
});
f.default.Instance.sendHttp(e);
};
e._instance = null;
return e;
}();
o.ReferProxy = y;
cc._RF.pop();
}, {
"../../Game/Script/global/GlobalValue": "GlobalValue",
"../../Game/client/global/enum/game/Event": "Event",
"../../Game/client/global/enum/game/Game": "Game",
"../../Game/client/global/enum/net/C2S": "C2S",
"../../Game/client/global/enum/net/S2C": "S2C",
"../../Game/client/model/CommonModel": "CommonModel",
"../../Game/fromework/global/Tools": "Tools",
"../../Game/fromework/helper/EventHelper": "EventHelper",
"../../Game/fromework/mvvm/modelView/ViewModel": "ViewModel",
"../../Game/fromework/net/NetHttp": "NetHttp",
"../../fromework/helper/NetHelper": "NetHelper",
"../../platform/Platform": "Platform",
"./InviteModel": "InviteModel",
"./WalletModel": "WalletModel"
} ],
ReferShare: [ function(e, t, o) {
"use strict";
cc._RF.push(t, "8b664QcL+BLj542NWjwNCv6", "ReferShare");
var n, a = this && this.__extends || (n = function(e, t) {
return (n = Object.setPrototypeOf || {
__proto__: []
} instanceof Array && function(e, t) {
e.__proto__ = t;
} || function(e, t) {
for (var o in t) Object.prototype.hasOwnProperty.call(t, o) && (e[o] = t[o]);
})(e, t);
}, function(e, t) {
n(e, t);
function o() {
this.constructor = e;
}
e.prototype = null === t ? Object.create(t) : (o.prototype = t.prototype, new o());
}), i = this && this.__decorate || function(e, t, o, n) {
var a, i = arguments.length, r = i < 3 ? t : null === n ? n = Object.getOwnPropertyDescriptor(t, o) : n;
if ("object" == typeof Reflect && "function" == typeof Reflect.decorate) r = Reflect.decorate(e, t, o, n); else for (var l = e.length - 1; l >= 0; l--) (a = e[l]) && (r = (i < 3 ? a(r) : i > 3 ? a(t, o, r) : a(t, o)) || r);
return i > 3 && r && Object.defineProperty(t, o, r), r;
};
Object.defineProperty(o, "__esModule", {
value: !0
});
var r = e("../../../../Game/fromework/helper/UIHelper"), l = e("../../../../platform/Platform"), s = e("../../../global/PopHelper"), c = e("../../../model/InviteModel"), u = e("../../../model/ReferModel"), d = cc._decorator, p = d.ccclass, h = (d.property, 
function(e) {
a(t, e);
function t() {
return null !== e && e.apply(this, arguments) || this;
}
t.prototype.onPhoneClicked = function() {
var e = c.InviteModel.Instance.createLink;
null != e && "" != e || (e = u.ReferProxy.Instance.getReferUrl());
if ("" != e) {
u.ReferProxy.Instance.sendCreatePull();
cc.sys.os == cc.sys.OS_ANDROID && cc.sys.isNative && jsb.reflection.callStaticMethod("org.cocos2dx.lib/Cocos2dxHelper", "copyTextToClipboard", "(Ljava/lang/String;)V", e);
l.default.logEvent("share");
l.default.sendEvent("share");
s.PopHelper.Instance.showTips("Copied, please open whatsapp or facebook to paste and share");
}
};
t.prototype.onCloseClicked = function() {
r.default.Instance.removeMaskLayer(this.node, !0);
};
return i([ p ], t);
}(cc.Component));
o.default = h;
cc._RF.pop();
}, {
"../../../../Game/fromework/helper/UIHelper": "UIHelper",
"../../../../platform/Platform": "Platform",
"../../../global/PopHelper": "PopHelper",
"../../../model/InviteModel": "InviteModel",
"../../../model/ReferModel": "ReferModel"
} ],
ReferView: [ function(e, t, o) {
"use strict";
cc._RF.push(t, "f589a9yeopIpqDEi7mxwrlL", "ReferView");
var n, a = this && this.__extends || (n = function(e, t) {
return (n = Object.setPrototypeOf || {
__proto__: []
} instanceof Array && function(e, t) {
e.__proto__ = t;
} || function(e, t) {
for (var o in t) Object.prototype.hasOwnProperty.call(t, o) && (e[o] = t[o]);
})(e, t);
}, function(e, t) {
n(e, t);
function o() {
this.constructor = e;
}
e.prototype = null === t ? Object.create(t) : (o.prototype = t.prototype, new o());
}), i = this && this.__decorate || function(e, t, o, n) {
var a, i = arguments.length, r = i < 3 ? t : null === n ? n = Object.getOwnPropertyDescriptor(t, o) : n;
if ("object" == typeof Reflect && "function" == typeof Reflect.decorate) r = Reflect.decorate(e, t, o, n); else for (var l = e.length - 1; l >= 0; l--) (a = e[l]) && (r = (i < 3 ? a(r) : i > 3 ? a(t, o, r) : a(t, o)) || r);
return i > 3 && r && Object.defineProperty(t, o, r), r;
};
Object.defineProperty(o, "__esModule", {
value: !0
});
var r = e("../../../../fromework/component/TableView/TableList"), l = e("../../../../Game/fromework/helper/EventHelper"), s = e("../../../../Game/fromework/helper/UIHelper"), c = e("../../../../Game/fromework/mvvm/modelView/ViewModel"), u = e("../../../../platform/Platform"), d = e("../../../component/MoneyAction"), p = e("../../../../Game/client/global/enum/game/Const"), h = e("../../../../Game/client/global/enum/game/Event"), f = e("../../../global/Global"), _ = e("../../../global/PopHelper"), m = e("../../../model/InviteModel"), y = e("../../../../Game/client/model/LanguageModel"), g = e("../../../model/ReferModel"), v = e("./ReferInviteBox"), C = e("./ReferItem"), b = e("./ReferLevelAlert"), I = e("../../../../Game/client/global/enum/game/UIUtils"), E = cc._decorator, S = E.ccclass, T = E.property, R = function(e) {
a(t, e);
function t() {
var t = null !== e && e.apply(this, arguments) || this;
t.InviteBox = null;
t.LevelButton = null;
t.Level = null;
t.ReferList = null;
t.ListTips = null;
t.Tips2 = null;
t.Tips3 = null;
t.TotalGainLabel = null;
t.RewardButton = null;
t.RewardCountLabel = null;
t.ShareButtons = null;
t.MoneyAction = null;
t.MoneyNode = null;
return t;
}
t.prototype.onLoad = function() {
l.default.Instance.Global.bind(h.ReferEvent.REFER_UI_REFRESH_BOX, this._refreshBox, this);
l.default.Instance.Global.bind(h.ReferEvent.REFER_UI_REFRESH_LIST, this._refreshList, this);
l.default.Instance.Global.bind(h.ReferEvent.REFER_UI_GET_REWARD, this._onGetReward, this);
l.default.Instance.Global.bind(h.ReferEvent.REFER_UI_GET_LEVEL, this._onGetLevelData, this);
this.ReferList.node.on("scroll-to-bottom", this.loadMoreList, this);
};
t.prototype.onDestroy = function() {
l.default.Instance.Global.unbind(h.ReferEvent.REFER_UI_REFRESH_BOX, this._refreshBox, this);
l.default.Instance.Global.unbind(h.ReferEvent.REFER_UI_REFRESH_LIST, this._refreshList, this);
l.default.Instance.Global.unbind(h.ReferEvent.REFER_UI_GET_REWARD, this._onGetReward, this);
l.default.Instance.Global.unbind(h.ReferEvent.REFER_UI_GET_LEVEL, this._onGetLevelData, this);
};
t.prototype.show = function() {
g.ReferProxy.Instance.inviteListData.length = 0;
g.ReferProxy.Instance.page = 0;
g.ReferProxy.Instance.sendGetInviteBox();
g.ReferProxy.Instance.sendGetInviteList();
this._refreshMoney();
};
t.prototype.loadMoreList = function() {
g.ReferProxy.Instance.sendGetInviteList();
};
t.prototype._refreshBox = function() {
g.ReferProxy.Instance.levelSwitch && g.ReferProxy.Instance.sendGetUserLevel();
if (this.ListTips.active) {
this.Tips2.active = !g.ReferProxy.Instance.levelSwitch;
this.Tips3.active = g.ReferProxy.Instance.levelSwitch;
}
var e = g.ReferProxy.Instance.inviteBoxData;
this.TotalGainLabel.string = y.default.getString("MoneySymbol") + e.total_gain;
this.RewardButton.active = e.reward_count > 0;
this.RewardButton.active && (this.RewardCountLabel.string = y.default.getString("MoneySymbol") + e.reward_count);
this.InviteBox.refreshView();
};
t.prototype.onListRender = function(e, t) {
var o = g.ReferProxy.Instance.inviteListData;
e.getComponent(C.default).refresh(o[t], t);
};
t.prototype._refreshList = function() {
var e = g.ReferProxy.Instance.inviteListData;
this.ListTips.active = e.length <= 0;
this.ReferList.numItems = e.length;
};
t.prototype._refreshMoney = function() {
cc.find("UseBonus/Bonus", this.MoneyNode).getComponent(cc.Label).string = y.default.getString("MoneySymbol") + c.VM.getValue("wallet.bonus");
cc.find("UserCash/Cash", this.MoneyNode).getComponent(cc.Label).string = y.default.getString("MoneySymbol") + c.VM.getValue("wallet.total");
};
t.prototype._playMoneyScroll = function() {
var e = cc.find("UseBonus/Bonus", this.MoneyNode).getComponent(cc.Label), t = parseFloat(e.string.substr(1)), o = c.VM.getValue("wallet.bonus");
if (o != t) {
var n = I.UIUtils.getNumberScrollAry(t, o, 17), a = 0;
e.node.stopAllActions();
cc.tween(e.node).repeat(n.length, cc.tween(e.node).call(function() {
if (e && e.node && e.node.isValid) {
e.string = y.default.getString("MoneySymbol") + n[a];
a++;
}
}).delay(.05)).start();
}
var i = cc.find("UserCash/Cash", this.MoneyNode).getComponent(cc.Label), r = parseFloat(i.string.substr(1)), l = c.VM.getValue("wallet.total");
if (l != r) {
var s = I.UIUtils.getNumberScrollAry(r, l, 17), u = 0;
i.node.stopAllActions();
cc.tween(i.node).repeat(s.length, cc.tween(i.node).call(function() {
if (i && i.node && i.node.isValid) {
i.string = y.default.getString("MoneySymbol") + s[u];
u++;
}
}).delay(.05)).start();
}
};
t.prototype._onGetReward = function(e) {
var t = this, o = e.getUserData();
22 == o.type && _.PopHelper.Instance.showReward(f.Global.Instance.changeReward(o.reward), null);
if (23 == o.type) {
this.MoneyNode.active = !0;
var n = this.MoneyNode.parent.convertToWorldSpaceAR(this.MoneyNode.getPosition()), a = this.MoneyAction.node.convertToNodeSpaceAR(n);
this.MoneyAction.playAnimation(20, cc.Vec2.ZERO, a, null, function() {
t._playMoneyScroll();
t.scheduleOnce(function() {
t.MoneyNode.active = !1;
}, 1);
});
}
};
t.prototype._onGetLevelData = function() {
this.LevelButton.active = g.ReferProxy.Instance.levelSwitch;
this.Level.string = "Lv." + g.ReferProxy.Instance.levelData.level;
};
t.prototype.onHelpClicked = function() {
s.default.Instance.addBundleMaskLayer(p.BundleUIPath.ReferHelp);
};
t.prototype.onLevelClicked = function() {
s.default.Instance.addBundleMaskLayer(p.BundleUIPath.ReferLevelAlert, function(e) {
e.getComponent(b.default).showView();
});
};
t.prototype.onRewardButtonClicked = function() {
g.ReferProxy.Instance.inviteBoxData.reward_count > 0 && g.ReferProxy.Instance.sendGetReward(23);
};
t.prototype.onInviteButtonClicked = function() {
this.ShareButtons.active = !0;
};
t.prototype.onHideInviteView = function() {
this.ShareButtons.active = !1;
};
t.prototype.onFacebookClicked = function() {
this.onHideInviteView();
var e = m.InviteModel.Instance.createLink;
null != e && "" != e || (e = g.ReferProxy.Instance.getReferUrl());
if ("" != e) {
g.ReferProxy.Instance.sendCreatePull();
u.default.shareFb(JSON.stringify({
shareType: 0,
shareUrl: e,
imgPath: ""
}));
u.default.logEvent("share");
u.default.sendEvent("share");
}
};
t.prototype.onPhoneClicked = function() {
this.onHideInviteView();
var e = m.InviteModel.Instance.createLink;
null != e && "" != e || (e = g.ReferProxy.Instance.getReferUrl());
if ("" != e) {
g.ReferProxy.Instance.sendCreatePull();
u.default.shareToPhoneText(e, y.default.getString("SHARE_TITLE"));
u.default.logEvent("share");
u.default.sendEvent("share");
}
};
t.prototype.onWhatsappClicked = function() {
this.onHideInviteView();
var e = m.InviteModel.Instance.createLink;
null != e && "" != e || (e = g.ReferProxy.Instance.getReferUrl());
if ("" != e) {
g.ReferProxy.Instance.sendCreatePull();
u.default.shareTextToPackage(e, "com.whatsapp");
u.default.logEvent("share");
u.default.sendEvent("share");
}
};
t.prototype.onCloseClicked = function() {
s.default.Instance.removeLayer(this.node, !0);
};
i([ T(v.default) ], t.prototype, "InviteBox", void 0);
i([ T(cc.Node) ], t.prototype, "LevelButton", void 0);
i([ T(cc.Label) ], t.prototype, "Level", void 0);
i([ T(r.default) ], t.prototype, "ReferList", void 0);
i([ T(cc.Node) ], t.prototype, "ListTips", void 0);
i([ T(cc.Node) ], t.prototype, "Tips2", void 0);
i([ T(cc.Node) ], t.prototype, "Tips3", void 0);
i([ T(cc.Label) ], t.prototype, "TotalGainLabel", void 0);
i([ T(cc.Node) ], t.prototype, "RewardButton", void 0);
i([ T(cc.Label) ], t.prototype, "RewardCountLabel", void 0);
i([ T(cc.Node) ], t.prototype, "ShareButtons", void 0);
i([ T(d.default) ], t.prototype, "MoneyAction", void 0);
i([ T(cc.Node) ], t.prototype, "MoneyNode", void 0);
return i([ S ], t);
}(cc.Component);
o.default = R;
cc._RF.pop();
}, {
"../../../../Game/client/global/enum/game/Const": "Const",
"../../../../Game/client/global/enum/game/Event": "Event",
"../../../../Game/client/global/enum/game/UIUtils": "UIUtils",
"../../../../Game/client/model/LanguageModel": "LanguageModel",
"../../../../Game/fromework/helper/EventHelper": "EventHelper",
"../../../../Game/fromework/helper/UIHelper": "UIHelper",
"../../../../Game/fromework/mvvm/modelView/ViewModel": "ViewModel",
"../../../../fromework/component/TableView/TableList": "TableList",
"../../../../platform/Platform": "Platform",
"../../../component/MoneyAction": "MoneyAction",
"../../../global/Global": "Global",
"../../../global/PopHelper": "PopHelper",
"../../../model/InviteModel": "InviteModel",
"../../../model/ReferModel": "ReferModel",
"./ReferInviteBox": "ReferInviteBox",
"./ReferItem": "ReferItem",
"./ReferLevelAlert": "ReferLevelAlert"
} ],
ResLoader: [ function(e, t, o) {
"use strict";
cc._RF.push(t, "30e0c996q9OtoeiEgY315vr", "ResLoader");
var n = this && this.__awaiter || function(e, t, o, n) {
return new (o || (o = Promise))(function(a, i) {
function r(e) {
try {
s(n.next(e));
} catch (e) {
i(e);
}
}
function l(e) {
try {
s(n.throw(e));
} catch (e) {
i(e);
}
}
function s(e) {
e.done ? a(e.value) : (t = e.value, t instanceof o ? t : new o(function(e) {
e(t);
})).then(r, l);
var t;
}
s((n = n.apply(e, t || [])).next());
});
}, a = this && this.__generator || function(e, t) {
var o, n, a, i, r = {
label: 0,
sent: function() {
if (1 & a[0]) throw a[1];
return a[1];
},
trys: [],
ops: []
};
return i = {
next: l(0),
throw: l(1),
return: l(2)
}, "function" == typeof Symbol && (i[Symbol.iterator] = function() {
return this;
}), i;
function l(e) {
return function(t) {
return s([ e, t ]);
};
}
function s(i) {
if (o) throw new TypeError("Generator is already executing.");
for (;r; ) try {
if (o = 1, n && (a = 2 & i[0] ? n.return : i[0] ? n.throw || ((a = n.return) && a.call(n), 
0) : n.next) && !(a = a.call(n, i[1])).done) return a;
(n = 0, a) && (i = [ 2 & i[0], a.value ]);
switch (i[0]) {
case 0:
case 1:
a = i;
break;

case 4:
r.label++;
return {
value: i[1],
done: !1
};

case 5:
r.label++;
n = i[1];
i = [ 0 ];
continue;

case 7:
i = r.ops.pop();
r.trys.pop();
continue;

default:
if (!(a = r.trys, a = a.length > 0 && a[a.length - 1]) && (6 === i[0] || 2 === i[0])) {
r = 0;
continue;
}
if (3 === i[0] && (!a || i[1] > a[0] && i[1] < a[3])) {
r.label = i[1];
break;
}
if (6 === i[0] && r.label < a[1]) {
r.label = a[1];
a = i;
break;
}
if (a && r.label < a[2]) {
r.label = a[2];
r.ops.push(i);
break;
}
a[2] && r.ops.pop();
r.trys.pop();
continue;
}
i = t.call(e, r);
} catch (e) {
i = [ 6, e ];
n = 0;
} finally {
o = a = 0;
}
if (5 & i[0]) throw i[1];
return {
value: i[0] ? i[1] : void 0,
done: !0
};
}
};
Object.defineProperty(o, "__esModule", {
value: !0
});
var i = e("../../../Game/BundleManager"), r = e("../../../platform/Platform"), l = "[ResLoader]:", s = cc.js.isChildClassOf;
s || (s = cc.isChildClassOf);
var c = function() {
function e() {}
Object.defineProperty(e, "Instance", {
get: function() {
this._resLoader || (this._resLoader = new e());
return this._resLoader;
},
enumerable: !1,
configurable: !0
});
e.destroy = function() {
this._resLoader && (this._resLoader = null);
};
e.prototype._makeLoadResArgs = function() {
if (arguments.length < 1 || "string" != typeof arguments[0]) {
r.default.error(l + "_makeLoadResArgs error " + arguments);
return null;
}
for (var e = {
url: arguments[0]
}, t = 1; t < arguments.length; ++t) 1 == t && s(arguments[t], cc.Asset) ? e.type = arguments[t] : "function" == typeof arguments[t] && (arguments.length > t + 1 && "function" == typeof arguments[t + 1] ? e.onProgess = arguments[t] : e.onCompleted = arguments[t]);
return e;
};
e.prototype._makeReleaseResArgs = function() {
if (arguments.length < 1 || "string" != typeof arguments[0]) {
r.default.error(l + "_makeReleaseResArgs error " + arguments);
return null;
}
for (var e = {
url: arguments[0]
}, t = 1; t < arguments.length; ++t) 1 == t && s(arguments[t], cc.Asset) && (e.type = arguments[t]);
return e;
};
e.prototype.loadRes = function() {
var e = this._makeLoadResArgs.apply(this, arguments), t = function(t, o) {
t || o.addRef();
e.onCompleted && e.onCompleted(t, o);
}, o = cc.resources.get(e.url, e.type);
o ? t(null, o) : cc.resources.load(e.url, e.type, e.onProgess, t);
};
e.prototype.releaseRes = function() {
var e = this._makeReleaseResArgs.apply(this, arguments), t = cc.resources.get(e.url, e.type);
t && t.decRef();
};
e.prototype.getRes = function(e, t) {
return cc.resources.get(e, t);
};
e.prototype.bundleRes = function(e, t, o, n) {
e && e.load(t, o, function(e, t) {
n(e, t);
});
};
e.prototype.loadBundleRes = function(e, t, o) {
return n(this, void 0, void 0, function() {
var n, l;
return a(this, function(a) {
switch (a.label) {
case 0:
a.trys.push([ 0, 2, , 3 ]);
return [ 4, i.default.getInstance().getGameBundle() ];

case 1:
n = a.sent();
this.bundleRes(n, e, t, o);
return [ 3, 3 ];

case 2:
l = a.sent();
r.default.error("loadBundleRes error", l);
return [ 3, 3 ];

case 3:
return [ 2 ];
}
});
});
};
e._resLoader = null;
return e;
}();
o.default = c;
cc._RF.pop();
}, {
"../../../Game/BundleManager": "BundleManager",
"../../../platform/Platform": "Platform"
} ],
RewardView: [ function(e, t, o) {
"use strict";
cc._RF.push(t, "ff85e2KzG1ARJB/lWFg1B/X", "RewardView");
var n, a = this && this.__extends || (n = function(e, t) {
return (n = Object.setPrototypeOf || {
__proto__: []
} instanceof Array && function(e, t) {
e.__proto__ = t;
} || function(e, t) {
for (var o in t) Object.prototype.hasOwnProperty.call(t, o) && (e[o] = t[o]);
})(e, t);
}, function(e, t) {
n(e, t);
function o() {
this.constructor = e;
}
e.prototype = null === t ? Object.create(t) : (o.prototype = t.prototype, new o());
}), i = this && this.__decorate || function(e, t, o, n) {
var a, i = arguments.length, r = i < 3 ? t : null === n ? n = Object.getOwnPropertyDescriptor(t, o) : n;
if ("object" == typeof Reflect && "function" == typeof Reflect.decorate) r = Reflect.decorate(e, t, o, n); else for (var l = e.length - 1; l >= 0; l--) (a = e[l]) && (r = (i < 3 ? a(r) : i > 3 ? a(t, o, r) : a(t, o)) || r);
return i > 3 && r && Object.defineProperty(t, o, r), r;
};
Object.defineProperty(o, "__esModule", {
value: !0
});
var r = e("../../../Festival/UI/FestivalItem"), l = e("../../../../Game/client/global/enum/game/Game"), s = e("../../../../Game/client/model/LanguageModel"), c = e("../../../model/WalletModel"), u = e("../../../../Game/fromework/helper/EventHelper"), d = cc._decorator, p = d.ccclass, h = d.property, f = function(e) {
a(t, e);
function t() {
var t = null !== e && e.apply(this, arguments) || this;
t.Panel = null;
t.Item = null;
t.ItemParent = null;
t.coinSprFra = null;
t._callFunc = null;
t.isLoginReward = !1;
return t;
}
t.prototype.show = function(e, t, o) {
void 0 === o && (o = !1);
this._callFunc = t;
this.isLoginReward = o;
var n = e.length;
this.ItemParent.width = n > 5 ? 610 : 90 * n + 40 * (n - 1);
this.ItemParent.destroyAllChildren();
for (var a = 0; a < n; a++) {
var i = e[a], c = cc.instantiate(this.Item);
c.parent = this.ItemParent;
var d = c.getComponent(r.default);
2 == i.rtype && i.type < 1e3 ? d.refreshItemIcon(i.type) : d.setItemID(0, i.type);
d.CornerCount.node.active = !1;
d.Count.node.active = !0;
d.AddButton.active = !1;
d.SelectToggle.node.active = !1;
if (1 == i.rtype) {
var p = "";
i.type == l.GameEnum.MoneyType.CASH ? p = s.default.getString("MoneySymbol") + i.num : i.type == l.GameEnum.MoneyType.WITHDRAW ? p = s.default.getString("MoneySymbol") + i.num : i.type == l.GameEnum.MoneyType.BONUS && (p = s.default.getString("MoneySymbol") + i.num);
d.Count.string = p;
} else 2 == i.rtype && d.setCount(i.num);
}
var h = this.node.getChildByName("lingqu").getComponent(sp.Skeleton);
h.clearTrack(0);
h.setAnimation(0, "chuchang", !1);
h.setCompleteListener(function() {
h.clearTrack(0);
h.setAnimation(0, "idle", !1);
});
this.isLoginReward || u.default.Instance.Global.emit("creatorCoinActToMyHead");
};
t.prototype.close = function() {
c.WalletProxy.Instance.sendGetUserWallet();
this.node.removeFromParent(!0);
this.node.destroy();
this._callFunc && this._callFunc();
this._callFunc = null;
};
t.prototype.onCloseClicked = function() {
this.close();
};
i([ h(cc.Node) ], t.prototype, "Panel", void 0);
i([ h(cc.Prefab) ], t.prototype, "Item", void 0);
i([ h(cc.Node) ], t.prototype, "ItemParent", void 0);
i([ h(cc.SpriteFrame) ], t.prototype, "coinSprFra", void 0);
return i([ p ], t);
}(cc.Component);
o.default = f;
cc._RF.pop();
}, {
"../../../../Game/client/global/enum/game/Game": "Game",
"../../../../Game/client/model/LanguageModel": "LanguageModel",
"../../../../Game/fromework/helper/EventHelper": "EventHelper",
"../../../Festival/UI/FestivalItem": "FestivalItem",
"../../../model/WalletModel": "WalletModel"
} ],
RouletteDashboard: [ function(e, t, o) {
"use strict";
cc._RF.push(t, "cf2fcqh6OpCu6k8FSUtC2ZW", "RouletteDashboard");
var n, a = this && this.__extends || (n = function(e, t) {
return (n = Object.setPrototypeOf || {
__proto__: []
} instanceof Array && function(e, t) {
e.__proto__ = t;
} || function(e, t) {
for (var o in t) Object.prototype.hasOwnProperty.call(t, o) && (e[o] = t[o]);
})(e, t);
}, function(e, t) {
n(e, t);
function o() {
this.constructor = e;
}
e.prototype = null === t ? Object.create(t) : (o.prototype = t.prototype, new o());
}), i = this && this.__decorate || function(e, t, o, n) {
var a, i = arguments.length, r = i < 3 ? t : null === n ? n = Object.getOwnPropertyDescriptor(t, o) : n;
if ("object" == typeof Reflect && "function" == typeof Reflect.decorate) r = Reflect.decorate(e, t, o, n); else for (var l = e.length - 1; l >= 0; l--) (a = e[l]) && (r = (i < 3 ? a(r) : i > 3 ? a(t, o, r) : a(t, o)) || r);
return i > 3 && r && Object.defineProperty(t, o, r), r;
};
Object.defineProperty(o, "__esModule", {
value: !0
});
var r = e("../../../Game/fromework/global/Tools"), l = cc._decorator, s = l.ccclass, c = l.property, u = function(e) {
a(t, e);
function t() {
var t = null !== e && e.apply(this, arguments) || this;
t.Speed = null;
t.Arrow = null;
t._startSpeed = 0;
t._endSpeed = 0;
t._speed = 0;
t._isChangeEnd = !1;
return t;
}
t.prototype.setTime = function(e, t) {
this._startSpeed = e;
this._endSpeed = t;
};
t.prototype.reset = function() {
this.Speed.string = "0";
this.Arrow.angle = 0;
this._speed = 0;
this._isChangeEnd = !1;
cc.Tween.stopAllByTarget(this.Arrow);
};
t.prototype.play = function(e, t, o) {
var n = this, a = Math.abs(e - t), i = 0;
cc.Tween.stopAllByTarget(this.Speed.node);
cc.tween(this.Speed.node).repeat(a, cc.tween(this.Speed.node).call(function() {
if (n.Speed && n.Speed.node && n.Speed.node.isValid) {
t > e ? i++ : i--;
n.Speed.string = Math.max(Math.floor(e + i), 0).toString();
}
}).delay(o / a)).start();
cc.Tween.stopAllByTarget(this.Arrow);
cc.tween(this.Arrow).to(o, {
angle: -287 / 330 * 270 * (t / 330)
}).start();
};
t.prototype.playSpeedUp = function(e, t) {
this._isChangeEnd = !1;
var o = this._speed / this._startSpeed;
this._speed = this._speed + e;
var n = this._speed / this._startSpeed;
o = Math.max(Math.min(o, 1), 0);
n = Math.max(Math.min(n, 1), 0);
var a = 287 * Math.pow(o, .75), i = 287 * Math.pow(n, .75);
this.play(a, i, t);
};
t.prototype.playSpeedUniform = function(e) {
var t = this, o = function(e) {
var o = r.Tools.TNumber.randomMinMax(282, 292);
if (o != Number(t.Speed.string)) {
var n = o / 292;
t.Speed.string = Math.ceil(o).toString();
cc.Tween.stopAllByTarget(t.Arrow);
cc.tween(t.Arrow).to(e, {
angle: -287 / 330 * 270 * n
}).start();
}
}, n = e / 10;
cc.tween(this.node).repeat(10, cc.tween(this.node).call(function() {
o(n);
}).delay(n)).start();
};
t.prototype.plsySpeedDown = function(e, t) {
if (!this._isChangeEnd) {
this._isChangeEnd = !0;
this._speed = 0;
}
cc.Tween.stopAllByTarget(this.node);
var o = this._speed / this._endSpeed;
this._speed = this._speed + e;
var n = this._speed / this._endSpeed;
o = Math.max(Math.min(o, 1), 0);
n = Math.max(Math.min(n, 1), 0);
var a = 287 - 287 * Math.pow(o, 4), i = 287 - 287 * Math.pow(n, 4);
this.play(a, i, t);
};
i([ c(cc.Label) ], t.prototype, "Speed", void 0);
i([ c(cc.Node) ], t.prototype, "Arrow", void 0);
return i([ s ], t);
}(cc.Component);
o.default = u;
cc._RF.pop();
}, {
"../../../Game/fromework/global/Tools": "Tools"
} ],
RouletteDealer: [ function(e, t, o) {
"use strict";
cc._RF.push(t, "c9b899NyDlJSomB83qLG1Vv", "RouletteDealer");
var n, a = this && this.__extends || (n = function(e, t) {
return (n = Object.setPrototypeOf || {
__proto__: []
} instanceof Array && function(e, t) {
e.__proto__ = t;
} || function(e, t) {
for (var o in t) Object.prototype.hasOwnProperty.call(t, o) && (e[o] = t[o]);
})(e, t);
}, function(e, t) {
n(e, t);
function o() {
this.constructor = e;
}
e.prototype = null === t ? Object.create(t) : (o.prototype = t.prototype, new o());
}), i = this && this.__decorate || function(e, t, o, n) {
var a, i = arguments.length, r = i < 3 ? t : null === n ? n = Object.getOwnPropertyDescriptor(t, o) : n;
if ("object" == typeof Reflect && "function" == typeof Reflect.decorate) r = Reflect.decorate(e, t, o, n); else for (var l = e.length - 1; l >= 0; l--) (a = e[l]) && (r = (i < 3 ? a(r) : i > 3 ? a(t, o, r) : a(t, o)) || r);
return i > 3 && r && Object.defineProperty(t, o, r), r;
};
Object.defineProperty(o, "__esModule", {
value: !0
});
var r = e("../../../Game/client/global/enum/game/Event"), l = e("../../../Game/fromework/global/Tools"), s = e("../../../Game/fromework/helper/EventHelper"), c = e("../../Common/Utils/CompositeEvent"), u = e("../../Common/Utils/CompositeUtil"), d = e("./RouletteDashboard"), p = e("./RouletteItem"), h = cc._decorator, f = h.ccclass, _ = h.property, m = [ cc.v3(-430, 85, 0), cc.v3(-355, 130, 0), cc.v3(-266, 135, 0), cc.v3(-178, 135, 0), cc.v3(-89, 135, 0), cc.v3(0, 135, 0), cc.v3(89, 135, 0), cc.v3(178, 135, 0), cc.v3(266, 135, 0), cc.v3(355, 130, 0), cc.v3(430, 85, 0), cc.v3(460, 0, 0), cc.v3(430, -85, 0), cc.v3(355, -130, 0), cc.v3(266, -135, 0), cc.v3(178, -135, 0), cc.v3(89, -135, 0), cc.v3(0, -135, 0), cc.v3(-89, -135, 0), cc.v3(-178, -135, 0), cc.v3(-266, -135, 0), cc.v3(-355, -130, 0), cc.v3(-430, -85, 0), cc.v3(-460, 0, 0) ], y = [ .5, .4, .32, .256, .204, .163, .131, .117, .106, .095, .085, .077, .069, .062, .056, .05, .045, .041, .037, .033, .029, .026, .024, .021, .019, .017 ], g = [ .021, .029, .041, .057, .08, .112, .169, .254, .381, .571, .6, .6 ], v = [ "animation_car_roulette_ferrari", "animation_car_roulette_lamborghini", "animation_car_roulette_maserati", "animation_car_roulette_porsche", "animation_car_roulette_bmw", "animation_car_roulette_mercedes", "animation_car_roulette_mahindra", "animation_car_roulette_tata" ], C = function(e) {
a(t, e);
function t() {
var t = null !== e && e.apply(this, arguments) || this;
t.RouletteItem = null;
t.RunWay = null;
t.RecordNode = null;
t.EffectArrow = null;
t.EffectCar = null;
t.Dashboard = null;
t._items = [];
return t;
}
t.prototype.onEnable = function() {
s.default.Instance.Global.bind(c.CompositeGameEvent.GAME_RECONNECT, this.onReconnect, this);
s.default.Instance.Global.bind(r.GameEvent.S2C_AB_DEAL, this.onDealerCard, this);
s.default.Instance.Global.bind(r.GameEvent.S2C_AB_SHOW, this.onShowCard, this);
s.default.Instance.Global.bind(r.GameEvent.S2C_RESET, this.onReset, this);
};
t.prototype.onDisable = function() {
s.default.Instance.Global.unbind(c.CompositeGameEvent.GAME_RECONNECT, this.onReconnect, this);
s.default.Instance.Global.unbind(r.GameEvent.S2C_AB_DEAL, this.onDealerCard, this);
s.default.Instance.Global.unbind(r.GameEvent.S2C_AB_SHOW, this.onShowCard, this);
s.default.Instance.Global.unbind(r.GameEvent.S2C_RESET, this.onReset, this);
};
t.prototype.onLoad = function() {
cc.game.on(cc.game.EVENT_SHOW, this.onReset, this);
};
t.prototype.onDestroy = function() {
this.unscheduleAllCallbacks();
cc.game.off(cc.game.EVENT_SHOW, this.onReset, this);
};
t.prototype.playStartDealer = function() {
var e = this;
cc.tween(this.RecordNode).to(.1, {
opacity: 0
}).call(function() {
e.RecordNode.active = !1;
}).start();
this.EffectCar.node.active = !1;
this.EffectArrow.node.active = !0;
this.EffectArrow.setAnimation(0, "animation_arrow", !0);
this.Dashboard.node.active = !0;
};
t.prototype.playWin = function(e) {
this.EffectCar.node.active = !0;
this.EffectCar.setAnimation(0, v[e], !1);
this.EffectArrow.node.active = !0;
this.EffectArrow.setAnimation(0, "animation_arrow", !0);
this.Dashboard.node.active = !1;
};
t.prototype.playEndDealer = function() {
this.RecordNode.active = !0;
this.RecordNode.opacity = 0;
cc.tween(this.RecordNode).to(.1, {
opacity: 255
}).start();
this.EffectCar.node.active = !1;
this.EffectArrow.node.active = !1;
this.Dashboard.node.active = !1;
};
t.prototype.refreshItem = function() {
var e = u.default.Game.Model, t = e.getPreWinIndex();
this.RunWay.destroyAllChildren();
this._items.length = 0;
for (var o = 0; o < e.roulette_order.length; o++) {
var n = cc.instantiate(this.RouletteItem);
n.position = m[o];
n.parent = this.RunWay;
var a = n.getComponent(p.default);
a.initItem(e.roulette_order[o]);
a.setLight(t == o);
this._items.push(a);
}
};
t.prototype.onReconnect = function() {
var e = u.default.Game.Model;
this.refreshItem();
if (3 == e.roomData.state) {
s.default.Instance.Global.emit(c.OddsEvent.ODDS_RECYCLING);
s.default.Instance.Global.emit(c.CompositeUIEvent.UI_HIDE_GOLD_DICE_EFF);
}
};
t.prototype.onDealerCard = function() {
s.default.Instance.Global.emit(c.CompositeUIEvent.UI_PLAY_START_BET);
};
t.prototype.onShowCard = function() {
var e = this, t = u.default.Game.Model, o = t.getPreWinIndex() || 0, n = t.show_card_index, a = (o > n ? 24 - o + n : n - o) + 96, i = 0, r = !1, d = (l.Tools.TArray.sumArr(y), 
l.Tools.TNumber.randomMinMax(10, 12)), p = (l.Tools.TArray.sumArr(g.slice(0, d)), 
0);
y.forEach(function(e) {
p += 1 / e;
});
var h = 0;
g.slice(0, d).forEach(function(e) {
h += 1 / e;
});
this.Dashboard.setTime(p, h);
var f = function(o) {
if (i != a) {
var n = 0;
if (i < y.length) n = y[i]; else if (i >= a - d) {
n = g[i - (a - d)];
e.Dashboard.plsySpeedDown(1 / n, n);
} else {
n = .015;
if (!r) {
r = !0;
e.Dashboard.playSpeedUniform(1.44);
}
}
var l = e._items[o];
l.setLight(!0);
i++;
24 == ++o && (o = 0);
cc.tween(l).delay(n).call(function() {
i < y.length && e.Dashboard.playSpeedUp(1 / n, n);
l.setLight(!1);
f(o);
}).start();
} else cc.tween(e.node).call(function() {
e._items[o].setLight(!0);
e._items[o].playWin();
}).delay(.5).call(function() {
cc.tween(e.node).call(function() {
e.playWin(t.win_options[0]);
s.default.Instance.Global.emit(c.OddsEvent.ODDS_SHOW_WIN);
}).delay(2.5).call(function() {
s.default.Instance.Global.emit(c.OddsEvent.ODDS_RECYCLING);
}).start();
}).start();
};
f(o);
this.playStartDealer();
};
t.prototype.onReset = function() {
this.playEndDealer();
this.Dashboard.reset();
};
i([ _(cc.Prefab) ], t.prototype, "RouletteItem", void 0);
i([ _(cc.Node) ], t.prototype, "RunWay", void 0);
i([ _(cc.Node) ], t.prototype, "RecordNode", void 0);
i([ _(sp.Skeleton) ], t.prototype, "EffectArrow", void 0);
i([ _(sp.Skeleton) ], t.prototype, "EffectCar", void 0);
i([ _(d.default) ], t.prototype, "Dashboard", void 0);
return i([ f ], t);
}(cc.Component);
o.default = C;
cc._RF.pop();
}, {
"../../../Game/client/global/enum/game/Event": "Event",
"../../../Game/fromework/global/Tools": "Tools",
"../../../Game/fromework/helper/EventHelper": "EventHelper",
"../../Common/Utils/CompositeEvent": "CompositeEvent",
"../../Common/Utils/CompositeUtil": "CompositeUtil",
"./RouletteDashboard": "RouletteDashboard",
"./RouletteItem": "RouletteItem"
} ],
RouletteHelp: [ function(e, t, o) {
"use strict";
cc._RF.push(t, "a226b21OZRG1oK7XNgnXL6+", "RouletteHelp");
var n, a = this && this.__extends || (n = function(e, t) {
return (n = Object.setPrototypeOf || {
__proto__: []
} instanceof Array && function(e, t) {
e.__proto__ = t;
} || function(e, t) {
for (var o in t) Object.prototype.hasOwnProperty.call(t, o) && (e[o] = t[o]);
})(e, t);
}, function(e, t) {
n(e, t);
function o() {
this.constructor = e;
}
e.prototype = null === t ? Object.create(t) : (o.prototype = t.prototype, new o());
}), i = this && this.__decorate || function(e, t, o, n) {
var a, i = arguments.length, r = i < 3 ? t : null === n ? n = Object.getOwnPropertyDescriptor(t, o) : n;
if ("object" == typeof Reflect && "function" == typeof Reflect.decorate) r = Reflect.decorate(e, t, o, n); else for (var l = e.length - 1; l >= 0; l--) (a = e[l]) && (r = (i < 3 ? a(r) : i > 3 ? a(t, o, r) : a(t, o)) || r);
return i > 3 && r && Object.defineProperty(t, o, r), r;
};
Object.defineProperty(o, "__esModule", {
value: !0
});
var r = e("../../Common/Utils/CompositeUtil"), l = cc._decorator, s = l.ccclass, c = l.property, u = function(e) {
a(t, e);
function t() {
var t = null !== e && e.apply(this, arguments) || this;
t.RateAry = [];
return t;
}
t.prototype.onLoad = function() {
for (var e = r.default.Game.Model, t = 0; t < this.RateAry.length; t++) this.RateAry[t].string = e.bet_options[t].x + " x";
};
i([ c([ cc.Label ]) ], t.prototype, "RateAry", void 0);
return i([ s ], t);
}(cc.Component);
o.default = u;
cc._RF.pop();
}, {
"../../Common/Utils/CompositeUtil": "CompositeUtil"
} ],
RouletteItem: [ function(e, t, o) {
"use strict";
cc._RF.push(t, "0516dHeBmFE6LXJVPZly6TF", "RouletteItem");
var n, a = this && this.__extends || (n = function(e, t) {
return (n = Object.setPrototypeOf || {
__proto__: []
} instanceof Array && function(e, t) {
e.__proto__ = t;
} || function(e, t) {
for (var o in t) Object.prototype.hasOwnProperty.call(t, o) && (e[o] = t[o]);
})(e, t);
}, function(e, t) {
n(e, t);
function o() {
this.constructor = e;
}
e.prototype = null === t ? Object.create(t) : (o.prototype = t.prototype, new o());
}), i = this && this.__decorate || function(e, t, o, n) {
var a, i = arguments.length, r = i < 3 ? t : null === n ? n = Object.getOwnPropertyDescriptor(t, o) : n;
if ("object" == typeof Reflect && "function" == typeof Reflect.decorate) r = Reflect.decorate(e, t, o, n); else for (var l = e.length - 1; l >= 0; l--) (a = e[l]) && (r = (i < 3 ? a(r) : i > 3 ? a(t, o, r) : a(t, o)) || r);
return i > 3 && r && Object.defineProperty(t, o, r), r;
};
Object.defineProperty(o, "__esModule", {
value: !0
});
var r = cc._decorator, l = r.ccclass, s = r.property, c = function(e) {
a(t, e);
function t() {
var t = null !== e && e.apply(this, arguments) || this;
t.Icon = null;
t.Light = null;
t.Effect = null;
t.Icon_Frames = [];
t.Light_Frames = [];
return t;
}
t.prototype.initItem = function(e) {
this.Icon.spriteFrame = this.Icon_Frames[e];
this.Light.spriteFrame = this.Light_Frames[e < 4 ? 0 : 1];
this.Light.node.active = !1;
};
t.prototype.setLight = function(e) {
this.Light.node.active = e;
};
t.prototype.playWin = function() {
var e = this;
this.Effect.node.active = !0;
this.Effect.setCompleteListener(function() {
e.Effect.setCompleteListener(function() {});
e.Effect.node.active = !1;
});
this.Effect.setAnimation(0, "animation_light", !1);
};
i([ s(cc.Sprite) ], t.prototype, "Icon", void 0);
i([ s(cc.Sprite) ], t.prototype, "Light", void 0);
i([ s(sp.Skeleton) ], t.prototype, "Effect", void 0);
i([ s([ cc.SpriteFrame ]) ], t.prototype, "Icon_Frames", void 0);
i([ s([ cc.SpriteFrame ]) ], t.prototype, "Light_Frames", void 0);
return i([ l ], t);
}(cc.Component);
o.default = c;
cc._RF.pop();
}, {} ],
RouletteModel: [ function(e, t, o) {
"use strict";
cc._RF.push(t, "02be7hFK+1PMJWjhCU72YQe", "RouletteModel");
var n, a = this && this.__extends || (n = function(e, t) {
return (n = Object.setPrototypeOf || {
__proto__: []
} instanceof Array && function(e, t) {
e.__proto__ = t;
} || function(e, t) {
for (var o in t) Object.prototype.hasOwnProperty.call(t, o) && (e[o] = t[o]);
})(e, t);
}, function(e, t) {
n(e, t);
function o() {
this.constructor = e;
}
e.prototype = null === t ? Object.create(t) : (o.prototype = t.prototype, new o());
});
Object.defineProperty(o, "__esModule", {
value: !0
});
o.RouletteModel = void 0;
var i = e("../../../Game/client/global/enum/game/Event"), r = e("../../../Game/client/global/enum/game/Game"), l = e("../../../Game/client/global/enum/net/C2S"), s = e("../../../Game/client/global/enum/net/S2C"), c = e("../../../client/logic/game/HearBeat"), u = e("../../../client/model/ErrorModel"), d = e("../../../Game/fromework/global/Tools"), p = e("../../../Game/fromework/helper/EventHelper"), h = e("../../../fromework/helper/NetHelper"), f = e("../../../Game/fromework/mvvm/modelView/ViewModel"), _ = e("../../Common/Utils/CompositeProxy"), m = e("./RouletteStruct"), y = function(e) {
a(t, e);
function t() {
var t = null !== e && e.apply(this, arguments) || this;
t.declearHistory = new m.RouletteStruct.DeclearHistory();
t.bet_fee_currency = [];
t.bet_options = [];
t.show_card_index = 0;
t.roulette_order = [];
return t;
}
Object.defineProperty(t, "Instance", {
get: function() {
t._instance || (t._instance = new t());
return t._instance;
},
enumerable: !1,
configurable: !0
});
t.prototype.clear = function() {
null != t._instance && (t._instance = null);
};
t.prototype.refreshRouletteOrder = function() {
var e = this;
this.roulette_order.length = 0;
for (var t = function(t) {
o.bet_options[t].p.forEach(function(o) {
e.roulette_order[o] = t;
});
}, o = this, n = 0; n < this.bet_options.length; n++) t(n);
};
t.prototype.getPreWinIndex = function() {
return this.declearHistory.historyArray[this.declearHistory.historyArray.length - 1].count;
};
t.prototype.getOddsRate = function(e) {
return this.bet_options[e].x;
};
t.prototype.getCompensationCash = function() {
for (var e = new Map(), t = 0; t < this.win_options.length; t++) {
var o = this.roomBetRecord[this.win_options[t]];
if (0 != o.amount) {
var n = this.bet_options[this.win_options[t]];
e.set(this.win_options[t], o.amount * (n.x - 1));
}
}
return e;
};
t.prototype.getWinFee = function(e) {
var t = new Map();
if (this.declearData.user_data.has(String(e))) for (var o = this.declearData.user_data.get(String(e)), n = 0; n < o.bet_record.length; n++) {
var a = o.bet_record[n];
if (0 != a.amount) {
var i = t.has(n) ? t.get(n) : 0, r = this.bet_options[n];
t.set(n, i + a.amount * r.x);
}
}
return t;
};
t._instance = null;
return t;
}(_.CompositeModel);
o.RouletteModel = y;
var g = function(e) {
a(t, e);
function t() {
return null !== e && e.apply(this, arguments) || this;
}
Object.defineProperty(t, "Instance", {
get: function() {
t._instance || (t._instance = new t());
return t._instance;
},
enumerable: !1,
configurable: !0
});
t.prototype.Init = function() {
p.default.Instance.Net.bind(s.S2C.GAME.ROOM_ENTER_ROOM, this._onEnterRoom, this);
p.default.Instance.Net.bind(s.S2C.GAME.ROOM_SWITCH_ROOM, this._onSwitchRoom, this);
p.default.Instance.Net.bind(s.S2C.GAME.ROOM_DEAL, this._onDeal, this);
p.default.Instance.Net.bind(s.S2C.GAME.ROOM_START_BET, this._onStartBet, this);
p.default.Instance.Net.bind(s.S2C.GAME.ROOM_BET, this._onBet, this);
p.default.Instance.Net.bind(s.S2C.GAME.ROOM_BET_BATCH, this._onBetBatch, this);
p.default.Instance.Net.bind(s.S2C.GAME.ROOM_STOP_BET, this._onStopBet, this);
p.default.Instance.Net.bind(s.S2C.GAME.ROOM_SHOW, this._onShow, this);
p.default.Instance.Net.bind(s.S2C.GAME.ROOM_RESET_ROOM, this._onResetRoom, this);
p.default.Instance.Net.bind(s.S2C.GAME.ROOM_INTERACT, this._onInteract, this);
p.default.Instance.Net.bind(s.S2C.GAME.ROOM_RANK, this._onRank, this);
p.default.Instance.Net.bind(s.S2C.GAME.ROOM_LEAVE, this._onLeave, this);
p.default.Instance.Net.bind(s.S2C.GAME.ROOM_LEAVE_SINGLE, this._onLeaveSingle, this);
p.default.Instance.Net.bind(s.S2C.GAME.ROOM_DISMISS, this._onDismiss, this);
p.default.Instance.Net.bind(s.S2C.GAME.ROOM_SEND_AVAILABLE_BALANCE, this._onBalanceRefresh, this);
p.default.Instance.Global.bind(h.NetState.NET_WEBSOCKET_CONNECT_OPEN, this._onWsContented, this);
};
t.prototype.destory = function() {
p.default.Instance.Net.unbind(s.S2C.GAME.ROOM_ENTER_ROOM, this._onEnterRoom, this);
p.default.Instance.Net.unbind(s.S2C.GAME.ROOM_SWITCH_ROOM, this._onSwitchRoom, this);
p.default.Instance.Net.unbind(s.S2C.GAME.ROOM_DEAL, this._onDeal, this);
p.default.Instance.Net.unbind(s.S2C.GAME.ROOM_START_BET, this._onStartBet, this);
p.default.Instance.Net.unbind(s.S2C.GAME.ROOM_BET, this._onBet, this);
p.default.Instance.Net.unbind(s.S2C.GAME.ROOM_BET_BATCH, this._onBetBatch, this);
p.default.Instance.Net.unbind(s.S2C.GAME.ROOM_STOP_BET, this._onStopBet, this);
p.default.Instance.Net.unbind(s.S2C.GAME.ROOM_SHOW, this._onShow, this);
p.default.Instance.Net.unbind(s.S2C.GAME.ROOM_RESET_ROOM, this._onResetRoom, this);
p.default.Instance.Net.unbind(s.S2C.GAME.ROOM_INTERACT, this._onInteract, this);
p.default.Instance.Net.unbind(s.S2C.GAME.ROOM_RANK, this._onRank, this);
p.default.Instance.Net.unbind(s.S2C.GAME.ROOM_LEAVE, this._onLeave, this);
p.default.Instance.Net.unbind(s.S2C.GAME.ROOM_LEAVE_SINGLE, this._onLeaveSingle, this);
p.default.Instance.Net.unbind(s.S2C.GAME.ROOM_DISMISS, this._onDismiss, this);
p.default.Instance.Net.unbind(s.S2C.GAME.ROOM_SEND_AVAILABLE_BALANCE, this._onBalanceRefresh, this);
p.default.Instance.Global.unbind(h.NetState.NET_WEBSOCKET_CONNECT_OPEN, this._onWsContented, this);
};
t.prototype.clear = function() {};
t.prototype._onWsContented = function() {
c.default.Instance.begin();
var e = f.VM.getValue("lobby.roomID");
0 != e && this.sendEnterRoom(e);
};
Object.defineProperty(t.prototype, "roomID", {
get: function() {
return f.VM.getValue("lobby.roomID");
},
enumerable: !1,
configurable: !0
});
t.prototype.checkRoomID = function(e) {
return f.VM.getValue("lobby.roomID") == e;
};
t.prototype.checkRoomType = function(e) {
var t = e.split("_"), o = -1;
null != t && null != t[0] && (o = parseInt(t[0]));
return o == r.GameEnum.PlayType.GAME_ROULETTE;
};
t.prototype._onEnterRoom = function(t) {
var o = t.getUserData();
if (this.checkRoomID(o.rid)) {
var n = y.Instance;
if (null != o.user_data && o.uid == this.uid) {
n.bet_fee_currency = o.bet_fee_currency;
n.bet_options = o.bet_options;
n.refreshRouletteOrder();
n.declearHistory.refresh(o.declear_history);
n.show_card_index = o.show_card_index;
}
e.prototype._onEnterRoom.call(this, o, n);
}
};
t.prototype._onSwitchRoom = function(e) {
var t = e.getUserData();
if (this.checkRoomType(t.room_type)) {
f.VM.getValue("lobby.roomID") != t.r && f.VM.setValue("lobby.roomID", parseInt(t.r));
p.default.Instance.Global.emit(i.GameEvent.S2C_SWITCH_ROOM, t.r);
}
};
t.prototype._onDeal = function(t) {
var o = t.getUserData();
if (this.checkRoomID(o.rid)) {
var n = y.Instance;
e.prototype._onDeal.call(this, o, n);
}
};
t.prototype._onStartBet = function(t) {
var o = t.getUserData();
if (this.checkRoomID(o.rid)) {
var n = y.Instance;
e.prototype._onStartBet.call(this, o, n);
}
};
t.prototype._onBet = function(t) {
var o = t.getUserData();
if (this.checkRoomID(o.rid)) {
var n = y.Instance;
e.prototype._onBet.call(this, o, n);
}
};
t.prototype._onBetBatch = function(t) {
var o = t.getUserData();
if (this.checkRoomID(o.rid)) {
var n = y.Instance;
e.prototype._onBetBatch.call(this, o, n);
}
};
t.prototype._onStopBet = function(t) {
var o = t.getUserData();
if (this.checkRoomID(o.rid)) {
var n = y.Instance;
e.prototype._onStopBet.call(this, o, n);
}
};
t.prototype._onShow = function(t) {
var o = t.getUserData();
if (this.checkRoomID(o.rid)) {
var n = y.Instance;
n.show_card_index = o.show_card_index;
e.prototype._onShow.call(this, o, n);
var a = new m.RouletteStruct.HistoryData({
d: [ o.show_card_index ],
w: o.win_options
});
n.declearHistory.addHistory(a);
}
};
t.prototype._onResetRoom = function(t) {
var o = t.getUserData();
if (this.checkRoomID(o.rid)) {
var n = y.Instance;
e.prototype._onResetRoom.call(this, o, n);
}
};
t.prototype._onInteract = function(t) {
var o = t.getUserData();
if (this.checkRoomID(o.rid)) {
var n = y.Instance;
e.prototype._onInteract.call(this, o, n);
}
};
t.prototype._onRank = function(t) {
var o = t.getUserData();
if (this.checkRoomID(o.rid)) {
var n = y.Instance;
e.prototype._onRank.call(this, o, n);
}
};
t.prototype._onLeave = function(t) {
var o = t.getUserData();
if (this.checkRoomID(o.rid)) {
var n = y.Instance;
e.prototype._onLeave.call(this, o, n);
}
};
t.prototype._onLeaveSingle = function(t) {
var o = t.getUserData();
if (this.checkRoomID(o.rid) || 0 == f.VM.getValue("lobby.roomID")) {
var n = y.Instance;
e.prototype._onLeaveSingle.call(this, o, n);
}
};
t.prototype._onDismiss = function(t) {
var o = t.getUserData();
if (this.checkRoomID(o.rid)) {
var n = y.Instance;
e.prototype._onDismiss.call(this, o, n);
}
};
t.prototype._onBalanceRefresh = function(t) {
var o = t.getUserData();
if (!this.checkRoomID(o.rid)) {
var n = y.Instance;
e.prototype._onBalanceRefresh.call(this, o, n);
}
};
t.prototype.sendEnterRoom = function(e, t) {
void 0 === t && (t = !0);
var o = h.default.Instance.makeMsg(l.C2S.ROOM_ENTER_ROOM, {
u: this.uid,
t: this.token,
r: e,
is_open: t
});
h.default.Instance.send(o);
};
t.prototype.sendBet = function(e, t) {
var o = d.Tools.TNumber.num2thousand(e);
u.default.Instance.CompositeBetNum = e;
var n = h.default.Instance.makeMsg(l.C2S.ROOM_BET, {
u: this.uid,
t: this.token,
r: this.roomID,
fee: o,
option: t
});
h.default.Instance.send(n);
};
t.prototype.sendInteract = function(e, t, o) {
var n;
n = o ? {
u: this.uid,
t: this.token,
r: this.roomID,
to_u: e,
opt_type: t,
opt_val: o
} : {
u: this.uid,
t: this.token,
r: this.roomID,
to_u: e,
opt_type: t
};
var a = h.default.Instance.makeMsg(l.C2S.ROOM_INTERACT, n);
h.default.Instance.send(a);
};
t.prototype.sendRank = function(e, t) {
var o = h.default.Instance.makeMsg(l.C2S.ROOM_RANK, {
u: this.uid,
t: this.token,
r: this.roomID,
page: e,
count: t
});
h.default.Instance.send(o);
};
t.prototype.sendLeave = function() {
var e = h.default.Instance.makeMsg(l.C2S.ROOM_LEAVE, {
u: this.uid,
t: this.token,
r: this.roomID
});
h.default.Instance.send(e);
};
t._instance = null;
return t;
}(_.CompositeProxy);
o.default = g;
cc._RF.pop();
}, {
"../../../Game/client/global/enum/game/Event": "Event",
"../../../Game/client/global/enum/game/Game": "Game",
"../../../Game/client/global/enum/net/C2S": "C2S",
"../../../Game/client/global/enum/net/S2C": "S2C",
"../../../Game/fromework/global/Tools": "Tools",
"../../../Game/fromework/helper/EventHelper": "EventHelper",
"../../../Game/fromework/mvvm/modelView/ViewModel": "ViewModel",
"../../../client/logic/game/HearBeat": "HearBeat",
"../../../client/model/ErrorModel": "ErrorModel",
"../../../fromework/helper/NetHelper": "NetHelper",
"../../Common/Utils/CompositeProxy": "CompositeProxy",
"./RouletteStruct": "RouletteStruct"
} ],
RouletteOdds: [ function(e, t, o) {
"use strict";
cc._RF.push(t, "ba77bREAC1CnYt5ktcSGvvk", "RouletteOdds");
var n, a = this && this.__extends || (n = function(e, t) {
return (n = Object.setPrototypeOf || {
__proto__: []
} instanceof Array && function(e, t) {
e.__proto__ = t;
} || function(e, t) {
for (var o in t) Object.prototype.hasOwnProperty.call(t, o) && (e[o] = t[o]);
})(e, t);
}, function(e, t) {
n(e, t);
function o() {
this.constructor = e;
}
e.prototype = null === t ? Object.create(t) : (o.prototype = t.prototype, new o());
}), i = this && this.__decorate || function(e, t, o, n) {
var a, i = arguments.length, r = i < 3 ? t : null === n ? n = Object.getOwnPropertyDescriptor(t, o) : n;
if ("object" == typeof Reflect && "function" == typeof Reflect.decorate) r = Reflect.decorate(e, t, o, n); else for (var l = e.length - 1; l >= 0; l--) (a = e[l]) && (r = (i < 3 ? a(r) : i > 3 ? a(t, o, r) : a(t, o)) || r);
return i > 3 && r && Object.defineProperty(t, o, r), r;
};
Object.defineProperty(o, "__esModule", {
value: !0
});
var r = e("../../../Game/fromework/global/ResLoader"), l = e("../../../platform/Platform"), s = e("../../Common/Utils/CompositeConst"), c = cc._decorator, u = c.ccclass, d = (c.property, 
function(e) {
a(t, e);
function t() {
return null !== e && e.apply(this, arguments) || this;
}
t.prototype.onLoad = function() {
var e = this;
this.node.destroyAllChildren();
for (var t = function(t) {
r.default.Instance.loadBundleRes(s.ODDS_TEXTURE_PATH + s.ODDS_TITLE_PATH + s.ODDS_TITLE_ROULETTE + t, cc.SpriteFrame, function(o, n) {
if (o) l.default.error(o); else {
var a = s.OddsPosition[s.PlayMethod.Roulette][t], i = new cc.Node();
i.position = cc.v3(a.x - 100, a.y + 40, a.z);
i.parent = e.node;
i.addComponent(cc.Sprite).spriteFrame = n;
}
});
}, o = 0; o < 8; o++) t(o);
};
return i([ u ], t);
}(cc.Component));
o.default = d;
cc._RF.pop();
}, {
"../../../Game/fromework/global/ResLoader": "ResLoader",
"../../../platform/Platform": "Platform",
"../../Common/Utils/CompositeConst": "CompositeConst"
} ],
RouletteRecordSmall: [ function(e, t, o) {
"use strict";
cc._RF.push(t, "5df1eP5uDxNS62Dz+7Lx77E", "RouletteRecordSmall");
var n, a = this && this.__extends || (n = function(e, t) {
return (n = Object.setPrototypeOf || {
__proto__: []
} instanceof Array && function(e, t) {
e.__proto__ = t;
} || function(e, t) {
for (var o in t) Object.prototype.hasOwnProperty.call(t, o) && (e[o] = t[o]);
})(e, t);
}, function(e, t) {
n(e, t);
function o() {
this.constructor = e;
}
e.prototype = null === t ? Object.create(t) : (o.prototype = t.prototype, new o());
}), i = this && this.__decorate || function(e, t, o, n) {
var a, i = arguments.length, r = i < 3 ? t : null === n ? n = Object.getOwnPropertyDescriptor(t, o) : n;
if ("object" == typeof Reflect && "function" == typeof Reflect.decorate) r = Reflect.decorate(e, t, o, n); else for (var l = e.length - 1; l >= 0; l--) (a = e[l]) && (r = (i < 3 ? a(r) : i > 3 ? a(t, o, r) : a(t, o)) || r);
return i > 3 && r && Object.defineProperty(t, o, r), r;
};
Object.defineProperty(o, "__esModule", {
value: !0
});
var r = e("../../../Game/client/global/enum/game/Event"), l = e("../../../Game/fromework/helper/EventHelper"), s = e("../../Common/Utils/CompositeUtil"), c = cc._decorator, u = c.ccclass, d = c.property, p = function(e) {
a(t, e);
function t() {
var t = null !== e && e.apply(this, arguments) || this;
t.TopRecordParent = null;
t.TopRecordItem = null;
t.Item_Frames = [];
t.Light = null;
t.MaxCount = 18;
return t;
}
t.prototype.onLoad = function() {
l.default.Instance.Global.bind(r.GameEvent.S2C_ENTER_ROOM, this._onEnterRoom, this);
l.default.Instance.Global.bind(r.GameEvent.S2C_RESET, this._onResetRoom, this);
this.refreshTopRecord(!1);
};
t.prototype.onDestroy = function() {
l.default.Instance.Global.unbind(r.GameEvent.S2C_ENTER_ROOM, this._onEnterRoom, this);
l.default.Instance.Global.unbind(r.GameEvent.S2C_RESET, this._onResetRoom, this);
};
t.prototype._onEnterRoom = function() {
this.refreshTopRecord(!1);
};
t.prototype._onResetRoom = function() {
this.refreshTopRecord(!0);
};
t.prototype.refreshTopRecord = function(e) {
var t = this;
void 0 === e && (e = !1);
var o = s.default.Game.Model;
this.TopRecordParent.destroyAllChildren();
for (var n = o.declearHistory.getSimpleHistory(this.MaxCount), a = 0; a < n.length; a++) {
var i = n[a], r = cc.instantiate(this.TopRecordItem);
r.active = !0;
r.setPosition(cc.Vec2.ZERO);
r.parent = this.TopRecordParent;
r.getChildByName("Icon").getComponent(cc.Sprite).spriteFrame = this.Item_Frames[i.win[0]];
}
if (e && null != this.Light) {
this.TopRecordParent.getComponent(cc.Layout).updateLayout();
var l = this.TopRecordParent.children[this.TopRecordParent.children.length - 1], c = l.parent.convertToWorldSpaceAR(l.position), u = this.Light.node.parent.convertToNodeSpaceAR(c);
this.Light.node.position = u;
this.Light.node.active = !0;
this.Light.armatureName = "Armature";
this.Light.once(dragonBones.EventObject.COMPLETE, function() {
t.Light.node.active = !1;
}, this);
this.Light.playAnimation("animation_new_details", 1);
}
};
i([ d(cc.Node) ], t.prototype, "TopRecordParent", void 0);
i([ d(cc.Node) ], t.prototype, "TopRecordItem", void 0);
i([ d([ cc.SpriteFrame ]) ], t.prototype, "Item_Frames", void 0);
i([ d(dragonBones.ArmatureDisplay) ], t.prototype, "Light", void 0);
i([ d ], t.prototype, "MaxCount", void 0);
return i([ u ], t);
}(cc.Component);
o.default = p;
cc._RF.pop();
}, {
"../../../Game/client/global/enum/game/Event": "Event",
"../../../Game/fromework/helper/EventHelper": "EventHelper",
"../../Common/Utils/CompositeUtil": "CompositeUtil"
} ],
RouletteRecord: [ function(e, t, o) {
"use strict";
cc._RF.push(t, "0ef48q8LbxOvIPNsa9Uxn1z", "RouletteRecord");
var n, a = this && this.__extends || (n = function(e, t) {
return (n = Object.setPrototypeOf || {
__proto__: []
} instanceof Array && function(e, t) {
e.__proto__ = t;
} || function(e, t) {
for (var o in t) Object.prototype.hasOwnProperty.call(t, o) && (e[o] = t[o]);
})(e, t);
}, function(e, t) {
n(e, t);
function o() {
this.constructor = e;
}
e.prototype = null === t ? Object.create(t) : (o.prototype = t.prototype, new o());
}), i = this && this.__decorate || function(e, t, o, n) {
var a, i = arguments.length, r = i < 3 ? t : null === n ? n = Object.getOwnPropertyDescriptor(t, o) : n;
if ("object" == typeof Reflect && "function" == typeof Reflect.decorate) r = Reflect.decorate(e, t, o, n); else for (var l = e.length - 1; l >= 0; l--) (a = e[l]) && (r = (i < 3 ? a(r) : i > 3 ? a(t, o, r) : a(t, o)) || r);
return i > 3 && r && Object.defineProperty(t, o, r), r;
};
Object.defineProperty(o, "__esModule", {
value: !0
});
var r = e("../../../Game/fromework/helper/UIHelper"), l = e("../../Common/Utils/CompositeUtil"), s = cc._decorator, c = s.ccclass, u = s.property, d = function(e) {
a(t, e);
function t() {
var t = null !== e && e.apply(this, arguments) || this;
t.Layouts = [];
t.Item = null;
return t;
}
t.prototype.onLoad = function() {
this.refreshBottomRecord();
};
t.prototype.refreshBottomRecord = function() {
for (var e = l.default.Game.Model, t = 0; t < 8; t++) {
var o = this.Layouts[t];
o.destroyAllChildren();
for (var n = e.declearHistory.getHistoryByType(t, 13), a = 0; a < n.length; a++) {
var i = cc.instantiate(this.Item);
i.position = cc.Vec3.ZERO;
i.active = !0;
i.parent = o;
i.getChildByName("Lose").active = !n[a];
i.getChildByName("Win").active = n[a];
}
}
};
t.prototype.onCloseClicked = function() {
r.default.Instance.removeMaskLayer(this.node, !0);
};
i([ u([ cc.Node ]) ], t.prototype, "Layouts", void 0);
i([ u(cc.Node) ], t.prototype, "Item", void 0);
return i([ c ], t);
}(cc.Component);
o.default = d;
cc._RF.pop();
}, {
"../../../Game/fromework/helper/UIHelper": "UIHelper",
"../../Common/Utils/CompositeUtil": "CompositeUtil"
} ],
RouletteStruct: [ function(e, t, o) {
"use strict";
cc._RF.push(t, "8c06aa/Cq9MuLZstIXkXS+e", "RouletteStruct");
Object.defineProperty(o, "__esModule", {
value: !0
});
o.RouletteStruct = void 0;
(function(e) {
var t = function() {
function e(e) {
this.count = 0;
this.win = [];
e && this.refresh(e);
}
e.prototype.refresh = function(e) {
this.count = e.d[0];
this.win = e.w;
};
return e;
}();
e.HistoryData = t;
var o = function() {
function e(e) {
this.historyArray = [];
e && this.refresh(e);
}
e.prototype.refresh = function(e) {
var o = this;
this.historyArray.splice(0);
e.forEach(function(e) {
var n = new t(e);
o.historyArray.push(n);
});
};
e.prototype.addHistory = function(e) {
100 == this.historyArray.length && this.historyArray.shift();
this.historyArray.push(e);
};
e.prototype.getSimpleHistory = function(e) {
for (var t = [], o = this.historyArray.length - 1; o >= 0; o--) {
var n = this.historyArray[o];
t.unshift(n);
if (t.length == e) break;
}
return t;
};
e.prototype.getHistoryByType = function(e, t) {
void 0 === t && (t = 13);
for (var o = [], n = this.historyArray.length - 1; n >= 0; n--) {
o.unshift(e == this.historyArray[n].win[0]);
if (o.length == t) break;
}
return o;
};
return e;
}();
e.DeclearHistory = o;
})(o.RouletteStruct || (o.RouletteStruct = {}));
cc._RF.pop();
}, {} ],
S2C: [ function(e, t, o) {
"use strict";
cc._RF.push(t, "56ef7vskmBD/pQFkqVUbYps", "S2C");
Object.defineProperty(o, "__esModule", {
value: !0
});
o.S2C = void 0;
o.S2C = {
SERVER: {
GAME_SERVICE: "S2C_Server_game_service",
CONFIG: "S2C_Server_channel_service",
HOT_UPDATE: "S2C_Server_hot_update",
DOT: "S2C_Server_dot",
RED_DOT: "S2C_Server_red_dot"
},
USER: {
REGISTER: "S2C_User_reg",
LOGIN_CODE: "S2C_User_login_code",
LOGIN_PHONE: "S2C_User_phone_login",
LOGIN_PHONE_TOKEN: "S2C_User_phone_token_login",
LOGIN_GUEST: "S2C_User_guest_login",
LOGIN_OTHER: "S2C_User_open_platform_login",
BIND_INVITE: "S2C_User_bind_invite",
GET_SHARE_URL: "S2C_User_get_share_url",
GET_VERIFICATION_CODE: "S2C_User_get_verification_code",
CHECK_VERIFICATION_CODE: "S2C_User_check_verification_code",
UPDATE_REWARD: "S2C_User_update_reward",
BIND_OPENPLATFORM: "S2C_User_bind_open_platform",
GET_VIP_INFO: "S2C_User_get_vip_info",
USER_MODIFY_DEFAULT_HEAD: "S2C_User_modify_default_head"
},
HB: {
HB: "S2C_Hb_hb"
},
LOBBY: {
LOBBY_JOIN: "S2C_Lobby_join",
LOBBY_GET_ROOMS: "S2C_Lobby_get_rooms",
LOBBY_GET_GAMES: "S2C_Lobby_get_game_list",
LOBBY_HOME: "S2C_Lobby_home",
LOBBY_GET_SYSTEM_NOTICE: "S2C_Lobby_get_system_notice"
},
GAME: {
ROOM_SYSTEM_NOTICE: "S2C_Room_system_notice",
ROOM_ENTER_ROOM: "S2C_Room_enter_room",
ROOM_SWITCH_ROOM: "S2C_Room_switch_room",
ROOM_ORDER_SHOW: "S2C_Room_order_show",
ROOM_ORDER_CONFIRM: "S2C_Room_order_confirm",
ROOM_CARD_SHOW: "S2C_Room_card_show",
ROOM_CARD_CONFIRM: "S2C_Room_card_confirm",
ROOM_START_ROOM: "S2C_Room_start_room",
ROOM_DRAW: "S2C_Room_draw",
ROOM_DISCARD: "S2C_Room_discard",
ROOM_FINISH: "S2C_Room_finish",
ROOM_DECLEAR: "S2C_Room_declear",
ROOM_SYNC_CARD: "S2C_Room_sync_card",
ROOM_DECLEAR_FAIL: "S2C_Room_declear_fail",
ROOM_RESET_ROOM: "S2C_Room_reset_room",
ROOM_LEAVE: "S2C_Room_leave",
ROOM_LEAVE_SINGLE: "S2C_Room_leave_single",
ROOM_DROP: "S2C_Room_drop",
ROOM_DISMISS: "S2C_Room_dismiss_room",
ROOM_KICK: "S2C_Room_kick",
ROOM_AUTOSORT_SWITCH: "S2C_Room_autosort_switch",
ROOM_AUTOSORT: "S2C_Room_autosort",
ROOM_AUTOPLAY: "S2C_Room_autoplay",
ROOM_SCORE_WINDOW: "S2C_Room_score_window",
ROOM_INITIATE_SPLIT: "S2C_Room_initiate_split",
ROOM_SPLIT: "S2C_Room_split",
ROOM_SPLIT_RESULT: "S2C_Room_split_result",
ROOM_REJOIN: "S2C_Room_rejoin",
ROOM_READY: "S2C_Room_ready",
ROOM_INTERACT: "S2C_Room_interact",
ROOM_SEND_AVAILABLE_BALANCE: "S2C_Room_send_available_balance",
ROOM_SEE_CARD: "S2C_Room_see_card",
ROOM_WAGER: "S2C_Room_wager",
ROOM_INITIATE_COMPARE: "S2C_Room_initiate_compare",
ROOM_CONFIRM_COMPARE: "S2C_Room_confirm_compare",
ROOM_GET_RECHARGE_AMOUNT: "S2C_Room_get_recharge_amount",
ROOM_INITIATE_RECHARGE: "S2C_Room_initiate_recharge",
ROOM_FINISH_RECHARGE: "S2C_Room_finish_recharge",
ROOM_DEAL: "S2C_Room_deal",
ROOM_START_BET: "S2C_Room_start_bet",
ROOM_STOP_BET: "S2C_Room_stop_bet",
ROOM_BET: "S2C_Room_bet",
ROOM_BET_BATCH: "S2C_Room_bet_batch",
ROOM_SHOW: "S2C_Room_show",
ROOM_RANK: "S2C_Room_rank",
ROOM_REPEAT_BET: "S2C_Room_repeat_bet",
ROOM_USER_RECORD: "S2C_Room_user_record",
ROOM_BIGWINNER_RECORD: "S2C_Room_bigwinner_record",
ROOM_GET_JACKPOT_HISTORY: "S2C_Room_get_jackpot_history",
ROOM_ESCAPE: "S2C_Room_escape",
ROOM_ESCAPE_BATCH: "S2C_Room_escape_batch",
ROOM_BOOM: "S2C_Room_boom",
ROOM_SYSTEM_TIPS: "S2C_Room_system_tips",
ROOM_FUNC_LEVEL: "S2C_Room_func_level",
ROOM_SPIN: "S2C_Room_spin",
ROOM_CLEAN: "S2C_Room_clean",
ROOM_EXCHANGE: "S2C_Room_exchange",
ROOM_DEALER_LIST: "S2C_Room_dealer_list",
ROOM_APPLY_DEALER: "S2C_apply_dealer",
ROOM_CANCEL_DEALER: "S2C_cancel_dealer"
},
WALLET: {
WALLET_CHECK_PHONE: "S2C_User_check_exist",
WALLET_BIND_CODE: "S2C_User_bind_code",
WALLET_BIND_PHONE: "S2C_User_bind_phone",
WALLET_BIND_EMAIL: "S2C_User_bind_email",
WALLET_LOG: "S2C_Wallet_get_user_wallet_log",
WALLET_GET_USER_WALLET: "S2C_Wallet_get_user_wallet"
},
ITEM: {
ITEM_GET_USER_ITEM: "S2C_Item_get_user_item",
ITEM_ADD_USER_ITEM: "S2C_Item_add_user_item",
ITEM_REDUCE_USER_ITEM: "S2C_Item_reduce_user_item"
},
MAIL: {
EMAIL_LIST: "S2C_Email_list",
EMAIL_CHANGE_STATUS: "S2C_Email_change_status"
},
ERROR: {
ERROR_CODE: "S2C_System_err"
},
SYSTEM: {
SYSTEM_MSG: "S2C_System_msg",
SYSTEM_GAMEHALLMARQUEE: "S2C_System_GameHallMarquee"
},
RECHARGE: {
RECHARGE_READY: "S2C_recharge_ready_recharge_ready"
},
TASK: {
TASK_MAIN: "S2C_Task_main",
TASK_GET_REWARD: "S2C_Task_get_reward"
},
ACT: {
ACT_ALL: "S2C_Act_all",
ACT_MAIN: "S2C_Act_main",
ACT_EXCHANGE: "S2C_Act_exchange",
ACT_GET_REWARD: "S2C_Act_get_reward",
ACT_LOTO: "S2C_Act_loto"
}
};
cc._RF.pop();
}, {} ],
SUDDealer: [ function(e, t, o) {
"use strict";
cc._RF.push(t, "67a3a0zijpLUr9CM7DrK4ac", "SUDDealer");
var n, a = this && this.__extends || (n = function(e, t) {
return (n = Object.setPrototypeOf || {
__proto__: []
} instanceof Array && function(e, t) {
e.__proto__ = t;
} || function(e, t) {
for (var o in t) Object.prototype.hasOwnProperty.call(t, o) && (e[o] = t[o]);
})(e, t);
}, function(e, t) {
n(e, t);
function o() {
this.constructor = e;
}
e.prototype = null === t ? Object.create(t) : (o.prototype = t.prototype, new o());
}), i = this && this.__decorate || function(e, t, o, n) {
var a, i = arguments.length, r = i < 3 ? t : null === n ? n = Object.getOwnPropertyDescriptor(t, o) : n;
if ("object" == typeof Reflect && "function" == typeof Reflect.decorate) r = Reflect.decorate(e, t, o, n); else for (var l = e.length - 1; l >= 0; l--) (a = e[l]) && (r = (i < 3 ? a(r) : i > 3 ? a(t, o, r) : a(t, o)) || r);
return i > 3 && r && Object.defineProperty(t, o, r), r;
}, r = this && this.__awaiter || function(e, t, o, n) {
return new (o || (o = Promise))(function(a, i) {
function r(e) {
try {
s(n.next(e));
} catch (e) {
i(e);
}
}
function l(e) {
try {
s(n.throw(e));
} catch (e) {
i(e);
}
}
function s(e) {
e.done ? a(e.value) : (t = e.value, t instanceof o ? t : new o(function(e) {
e(t);
})).then(r, l);
var t;
}
s((n = n.apply(e, t || [])).next());
});
}, l = this && this.__generator || function(e, t) {
var o, n, a, i, r = {
label: 0,
sent: function() {
if (1 & a[0]) throw a[1];
return a[1];
},
trys: [],
ops: []
};
return i = {
next: l(0),
throw: l(1),
return: l(2)
}, "function" == typeof Symbol && (i[Symbol.iterator] = function() {
return this;
}), i;
function l(e) {
return function(t) {
return s([ e, t ]);
};
}
function s(i) {
if (o) throw new TypeError("Generator is already executing.");
for (;r; ) try {
if (o = 1, n && (a = 2 & i[0] ? n.return : i[0] ? n.throw || ((a = n.return) && a.call(n), 
0) : n.next) && !(a = a.call(n, i[1])).done) return a;
(n = 0, a) && (i = [ 2 & i[0], a.value ]);
switch (i[0]) {
case 0:
case 1:
a = i;
break;

case 4:
r.label++;
return {
value: i[1],
done: !1
};

case 5:
r.label++;
n = i[1];
i = [ 0 ];
continue;

case 7:
i = r.ops.pop();
r.trys.pop();
continue;

default:
if (!(a = r.trys, a = a.length > 0 && a[a.length - 1]) && (6 === i[0] || 2 === i[0])) {
r = 0;
continue;
}
if (3 === i[0] && (!a || i[1] > a[0] && i[1] < a[3])) {
r.label = i[1];
break;
}
if (6 === i[0] && r.label < a[1]) {
r.label = a[1];
a = i;
break;
}
if (a && r.label < a[2]) {
r.label = a[2];
r.ops.push(i);
break;
}
a[2] && r.ops.pop();
r.trys.pop();
continue;
}
i = t.call(e, r);
} catch (e) {
i = [ 6, e ];
n = 0;
} finally {
o = a = 0;
}
if (5 & i[0]) throw i[1];
return {
value: i[0] ? i[1] : void 0,
done: !0
};
}
};
Object.defineProperty(o, "__esModule", {
value: !0
});
var s = e("../../../Game/BundleManager"), c = e("../../../Game/client/global/enum/game/Const"), u = e("../../../Game/client/global/enum/game/Event"), d = e("../../../Game/fromework/global/ResLoader"), p = e("../../../Game/fromework/global/Tools"), h = e("../../../Game/fromework/helper/AudioHelper"), f = e("../../../Game/fromework/helper/EventHelper"), _ = e("../../../platform/Platform"), m = e("../../Common/Utils/CompositeEvent"), y = e("../../Common/Utils/CompositeUtil"), g = cc._decorator, v = g.ccclass, C = g.property, b = [ "tz1", "tz2" ], I = function(e) {
a(t, e);
function t() {
var t = null !== e && e.apply(this, arguments) || this;
t.DragonBonus = null;
t.GoldDice = null;
t.DiceNode = null;
t._randomNum = 1;
return t;
}
t.prototype.onEnable = function() {
f.default.Instance.Global.bind(m.CompositeGameEvent.GAME_RECONNECT, this.onReconnect, this);
f.default.Instance.Global.bind(u.GameEvent.S2C_AB_DEAL, this.onDealerCard, this);
f.default.Instance.Global.bind(u.GameEvent.S2C_AB_SHOW, this.onShowCard, this);
f.default.Instance.Global.bind(u.GameEvent.S2C_RESET, this.onReset, this);
};
t.prototype.onDisable = function() {
f.default.Instance.Global.unbind(m.CompositeGameEvent.GAME_RECONNECT, this.onReconnect, this);
f.default.Instance.Global.unbind(u.GameEvent.S2C_AB_DEAL, this.onDealerCard, this);
f.default.Instance.Global.unbind(u.GameEvent.S2C_AB_SHOW, this.onShowCard, this);
f.default.Instance.Global.unbind(u.GameEvent.S2C_RESET, this.onReset, this);
};
t.prototype.onLoad = function() {
return r(this, void 0, void 0, function() {
var e;
return l(this, function(t) {
switch (t.label) {
case 0:
this.node.zIndex = -1;
cc.game.on(cc.game.EVENT_SHOW, this._onReset, this);
t.label = 1;

case 1:
t.trys.push([ 1, 3, , 4 ]);
return [ 4, s.default.getInstance().getGameBundle() ];

case 2:
t.sent().loadDir("resources/Texture/Composite/SUDDice/");
return [ 3, 4 ];

case 3:
e = t.sent();
_.default.error("SUDDealer onLoad error", e);
return [ 3, 4 ];

case 4:
return [ 2 ];
}
});
});
};
t.prototype.onDestroy = function() {
this.unscheduleAllCallbacks();
cc.game.off(cc.game.EVENT_SHOW, this._onReset, this);
};
t.prototype._onReset = function() {
this.DragonBonus && this.DragonBonus.node && this.DragonBonus.node.isValid && this.DragonBonus.node.stopAllActions();
this.DragonBonus.node.scale = .25;
this.DragonBonus.node.y = 223;
};
t.prototype.getSlotPaths = function(e, t, o) {
void 0 === o && (o = !1);
for (var n = [], a = 0; a < e.length; a++) {
var i = o ? "resources/Texture/Composite/SUDDice/dice_gold_" : "resources/Texture/Composite/SUDDice/dice_";
i = i + e[a] + "_" + t;
n.push(i);
}
return n;
};
t.prototype.addDiceSlot = function(e) {
var t = this;
d.default.Instance.loadBundleRes(e, cc.SpriteFrame, function(e, o) {
for (var n = 0; n < b.length; n++) {
var a = b[n], i = t.DragonBonus.attachUtil.generateAttachedNodes(a)[0];
if (i) {
var r = cc.instantiate(t.DiceNode);
r.active = !0;
r.setPosition(0, 0);
r.getComponent(cc.Sprite).spriteFrame = o[n];
i.addChild(r);
}
}
});
};
t.prototype.destroyOldSlot = function() {
for (var e = 0; e < b.length; e++) this.DragonBonus.attachUtil.destroyAttachedNodes(b[e]);
};
t.prototype.onReconnect = function() {
var e = y.default.Game.Model;
this.destroyOldSlot();
this._randomNum = p.Tools.TNumber.randomNumber(1, 4);
var t = 0 != e.show_card.length ? e.show_card : e.declearHistory.getNearDice(), o = this.getSlotPaths(t, this._randomNum, !1);
this.addDiceSlot(o);
if (3 == e.roomData.state) {
f.default.Instance.Global.emit(m.OddsEvent.ODDS_RECYCLING);
f.default.Instance.Global.emit(m.CompositeUIEvent.UI_HIDE_GOLD_DICE_EFF);
}
};
t.prototype.onDealerCard = function() {
f.default.Instance.Global.emit(m.CompositeUIEvent.UI_PLAY_START_BET);
};
t.prototype.onShowCard = function() {
var e = this, t = y.default.Game.Model, o = t.goldRate > 1, n = function() {
e.DragonBonus.armatureName = "Armature";
e.DragonBonus.addEventListener(dragonBones.EventObject.FRAME_EVENT, function() {
e.DragonBonus.removeEventListener(dragonBones.EventObject.FRAME_EVENT);
h.default.Instance.playBundleEffect(c.BundleSoundPath.sud_dice_drop);
e._randomNum = p.Tools.TNumber.randomNumber(1, 4);
var n = e.getSlotPaths(t.show_card, e._randomNum, o);
e.addDiceSlot(n);
}, e);
e.destroyOldSlot();
var n = p.Tools.TNumber.randomNumber(0, 4), a = o ? "animation_gold_dice_" + n : "animation_dice_" + n;
e.DragonBonus.playAnimation(a, 1);
h.default.Instance.playBundleEffect(c.BundleSoundPath.composite_dice_shake);
}, a = function() {
cc.tween(e.DragonBonus.node).to(.4, {
x: 0,
y: 750
}).call(function() {
e.DragonBonus.node.scale = 1;
}).to(.4, {
x: 0,
y: 0
}).delay(.1).call(function() {
n();
}).delay(3).to(.4, {
scale: .25,
x: 230,
y: 223
}).call(function() {
e.node.zIndex = -1;
cc.tween(e.node).call(function() {
o && f.default.Instance.Global.emit(m.CompositeUIEvent.UI_PLAY_GOLD_DICE_EFF, t.goldRate);
f.default.Instance.Global.emit(m.OddsEvent.ODDS_SHOW_WIN);
}).delay(2.5).call(function() {
o && f.default.Instance.Global.emit(m.CompositeUIEvent.UI_HIDE_GOLD_DICE_EFF);
f.default.Instance.Global.emit(m.OddsEvent.ODDS_RECYCLING);
}).start();
}).start();
};
this.node.zIndex = 99;
if (o) {
this.scheduleOnce(function() {
var o = t.declearHistory.getNearDice(1), n = e.getSlotPaths(o, e._randomNum, !0);
e.destroyOldSlot();
e.addDiceSlot(n);
}, .2);
this.GoldDice.node.active = !0;
this.GoldDice.armatureName = "Armature";
this.GoldDice.once(dragonBones.EventObject.COMPLETE, function() {
e.GoldDice.node.active = !1;
a();
}, this);
this.GoldDice.playAnimation("gold_dice_bonus", 1);
} else a();
};
t.prototype.onReset = function() {
var e = y.default.Game.Model;
if (e.goldRate > 1) {
this.destroyOldSlot();
var t = this.getSlotPaths(e.show_card, this._randomNum, !1);
this.addDiceSlot(t);
}
this._onReset();
};
i([ C(dragonBones.ArmatureDisplay) ], t.prototype, "DragonBonus", void 0);
i([ C(dragonBones.ArmatureDisplay) ], t.prototype, "GoldDice", void 0);
i([ C(cc.Node) ], t.prototype, "DiceNode", void 0);
return i([ v ], t);
}(cc.Component);
o.default = I;
cc._RF.pop();
}, {
"../../../Game/BundleManager": "BundleManager",
"../../../Game/client/global/enum/game/Const": "Const",
"../../../Game/client/global/enum/game/Event": "Event",
"../../../Game/fromework/global/ResLoader": "ResLoader",
"../../../Game/fromework/global/Tools": "Tools",
"../../../Game/fromework/helper/AudioHelper": "AudioHelper",
"../../../Game/fromework/helper/EventHelper": "EventHelper",
"../../../platform/Platform": "Platform",
"../../Common/Utils/CompositeEvent": "CompositeEvent",
"../../Common/Utils/CompositeUtil": "CompositeUtil"
} ],
SUDHelp: [ function(e, t, o) {
"use strict";
cc._RF.push(t, "0ca3c6tHG9Bh6tnukiwvYtl", "SUDHelp");
var n, a = this && this.__extends || (n = function(e, t) {
return (n = Object.setPrototypeOf || {
__proto__: []
} instanceof Array && function(e, t) {
e.__proto__ = t;
} || function(e, t) {
for (var o in t) Object.prototype.hasOwnProperty.call(t, o) && (e[o] = t[o]);
})(e, t);
}, function(e, t) {
n(e, t);
function o() {
this.constructor = e;
}
e.prototype = null === t ? Object.create(t) : (o.prototype = t.prototype, new o());
}), i = this && this.__decorate || function(e, t, o, n) {
var a, i = arguments.length, r = i < 3 ? t : null === n ? n = Object.getOwnPropertyDescriptor(t, o) : n;
if ("object" == typeof Reflect && "function" == typeof Reflect.decorate) r = Reflect.decorate(e, t, o, n); else for (var l = e.length - 1; l >= 0; l--) (a = e[l]) && (r = (i < 3 ? a(r) : i > 3 ? a(t, o, r) : a(t, o)) || r);
return i > 3 && r && Object.defineProperty(t, o, r), r;
};
Object.defineProperty(o, "__esModule", {
value: !0
});
var r = e("../../../Game/client/model/LanguageModel"), l = e("../../Common/Utils/CompositeUtil"), s = cc._decorator, c = s.ccclass, u = s.property, d = function(e) {
a(t, e);
function t() {
var t = null !== e && e.apply(this, arguments) || this;
t.BetAry = [];
t.RateAry = [];
t.WinAry = [];
return t;
}
t.prototype.onLoad = function() {
for (var e = l.default.Game.Model, t = 0; t < this.RateAry.length; t++) {
this.BetAry[t].string = "Bet <color=#FDB225>" + r.default.getString("MoneySymbol") + "1000</c>";
this.RateAry[t].string = e.bet_options[t].x + " x";
this.WinAry[t].string = "Win <color=#FDB225>" + r.default.getString("MoneySymbol") + (1e3 + 1e3 * e.bet_options[t].x) + "</c>";
}
};
i([ u([ cc.RichText ]) ], t.prototype, "BetAry", void 0);
i([ u([ cc.Label ]) ], t.prototype, "RateAry", void 0);
i([ u([ cc.RichText ]) ], t.prototype, "WinAry", void 0);
return i([ c ], t);
}(cc.Component);
o.default = d;
cc._RF.pop();
}, {
"../../../Game/client/model/LanguageModel": "LanguageModel",
"../../Common/Utils/CompositeUtil": "CompositeUtil"
} ],
SUDModel: [ function(e, t, o) {
"use strict";
cc._RF.push(t, "eecb6uFEeZPzYTaImhqLNr+", "SUDModel");
var n, a = this && this.__extends || (n = function(e, t) {
return (n = Object.setPrototypeOf || {
__proto__: []
} instanceof Array && function(e, t) {
e.__proto__ = t;
} || function(e, t) {
for (var o in t) Object.prototype.hasOwnProperty.call(t, o) && (e[o] = t[o]);
})(e, t);
}, function(e, t) {
n(e, t);
function o() {
this.constructor = e;
}
e.prototype = null === t ? Object.create(t) : (o.prototype = t.prototype, new o());
});
Object.defineProperty(o, "__esModule", {
value: !0
});
o.SUDModel = void 0;
var i = e("../../../Game/client/global/enum/game/Event"), r = e("../../../Game/client/global/enum/game/Game"), l = e("../../../Game/client/global/enum/net/C2S"), s = e("../../../Game/client/global/enum/net/S2C"), c = e("../../../client/logic/game/HearBeat"), u = e("../../../client/model/ErrorModel"), d = e("../../../Game/fromework/global/Tools"), p = e("../../../Game/fromework/helper/EventHelper"), h = e("../../../fromework/helper/NetHelper"), f = e("../../../Game/fromework/mvvm/modelView/ViewModel"), _ = e("../../Common/Utils/CompositeProxy"), m = e("./SUDStruct"), y = function(e) {
a(t, e);
function t() {
var t = null !== e && e.apply(this, arguments) || this;
t.declearHistory = new m.SUDStruct.DeclearHistory();
t.bet_fee_currency = [];
t.bet_options = [];
t.goldRate = 1;
return t;
}
Object.defineProperty(t, "Instance", {
get: function() {
t._instance || (t._instance = new t());
return t._instance;
},
enumerable: !1,
configurable: !0
});
t.prototype.clear = function() {
null != t._instance && (t._instance = null);
};
t.prototype.getOddsRate = function(e) {
return 1 == this.goldRate ? this.bet_options[e].x : this.goldRate;
};
t.prototype.getCompensationCash = function() {
for (var e = new Map(), t = 0; t < this.win_options.length; t++) {
var o = this.roomBetRecord[this.win_options[t]];
if (0 != o.amount) {
var n = this.bet_options[this.win_options[t]], a = 1 == this.goldRate ? n.x : this.goldRate;
e.set(this.win_options[t], o.amount * (a - 1));
}
}
return e;
};
t.prototype.getWinFee = function(e) {
var t = new Map();
if (this.declearData.user_data.has(String(e))) for (var o = this.declearData.user_data.get(String(e)), n = 0; n < o.bet_record.length; n++) {
var a = o.bet_record[n];
if (0 != a.amount) {
var i = t.has(n) ? t.get(n) : 0, r = this.bet_options[n], l = 1 == this.goldRate ? r.x : this.goldRate;
t.set(n, i + a.amount * l);
}
}
return t;
};
t._instance = null;
return t;
}(_.CompositeModel);
o.SUDModel = y;
var g = function(e) {
a(t, e);
function t() {
return null !== e && e.apply(this, arguments) || this;
}
Object.defineProperty(t, "Instance", {
get: function() {
t._instance || (t._instance = new t());
return t._instance;
},
enumerable: !1,
configurable: !0
});
t.prototype.Init = function() {
p.default.Instance.Net.bind(s.S2C.GAME.ROOM_ENTER_ROOM, this._onEnterRoom, this);
p.default.Instance.Net.bind(s.S2C.GAME.ROOM_SWITCH_ROOM, this._onSwitchRoom, this);
p.default.Instance.Net.bind(s.S2C.GAME.ROOM_DEAL, this._onDeal, this);
p.default.Instance.Net.bind(s.S2C.GAME.ROOM_START_BET, this._onStartBet, this);
p.default.Instance.Net.bind(s.S2C.GAME.ROOM_BET, this._onBet, this);
p.default.Instance.Net.bind(s.S2C.GAME.ROOM_BET_BATCH, this._onBetBatch, this);
p.default.Instance.Net.bind(s.S2C.GAME.ROOM_STOP_BET, this._onStopBet, this);
p.default.Instance.Net.bind(s.S2C.GAME.ROOM_SHOW, this._onShow, this);
p.default.Instance.Net.bind(s.S2C.GAME.ROOM_RESET_ROOM, this._onResetRoom, this);
p.default.Instance.Net.bind(s.S2C.GAME.ROOM_INTERACT, this._onInteract, this);
p.default.Instance.Net.bind(s.S2C.GAME.ROOM_RANK, this._onRank, this);
p.default.Instance.Net.bind(s.S2C.GAME.ROOM_LEAVE, this._onLeave, this);
p.default.Instance.Net.bind(s.S2C.GAME.ROOM_LEAVE_SINGLE, this._onLeaveSingle, this);
p.default.Instance.Net.bind(s.S2C.GAME.ROOM_DISMISS, this._onDismiss, this);
p.default.Instance.Net.bind(s.S2C.GAME.ROOM_SEND_AVAILABLE_BALANCE, this._onBalanceRefresh, this);
p.default.Instance.Global.bind(h.NetState.NET_WEBSOCKET_CONNECT_OPEN, this._onWsContented, this);
};
t.prototype.destory = function() {
p.default.Instance.Net.unbind(s.S2C.GAME.ROOM_ENTER_ROOM, this._onEnterRoom, this);
p.default.Instance.Net.unbind(s.S2C.GAME.ROOM_SWITCH_ROOM, this._onSwitchRoom, this);
p.default.Instance.Net.unbind(s.S2C.GAME.ROOM_DEAL, this._onDeal, this);
p.default.Instance.Net.unbind(s.S2C.GAME.ROOM_START_BET, this._onStartBet, this);
p.default.Instance.Net.unbind(s.S2C.GAME.ROOM_BET, this._onBet, this);
p.default.Instance.Net.unbind(s.S2C.GAME.ROOM_BET_BATCH, this._onBetBatch, this);
p.default.Instance.Net.unbind(s.S2C.GAME.ROOM_STOP_BET, this._onStopBet, this);
p.default.Instance.Net.unbind(s.S2C.GAME.ROOM_SHOW, this._onShow, this);
p.default.Instance.Net.unbind(s.S2C.GAME.ROOM_RESET_ROOM, this._onResetRoom, this);
p.default.Instance.Net.unbind(s.S2C.GAME.ROOM_INTERACT, this._onInteract, this);
p.default.Instance.Net.unbind(s.S2C.GAME.ROOM_RANK, this._onRank, this);
p.default.Instance.Net.unbind(s.S2C.GAME.ROOM_LEAVE, this._onLeave, this);
p.default.Instance.Net.unbind(s.S2C.GAME.ROOM_LEAVE_SINGLE, this._onLeaveSingle, this);
p.default.Instance.Net.unbind(s.S2C.GAME.ROOM_DISMISS, this._onDismiss, this);
p.default.Instance.Net.unbind(s.S2C.GAME.ROOM_SEND_AVAILABLE_BALANCE, this._onBalanceRefresh, this);
p.default.Instance.Global.unbind(h.NetState.NET_WEBSOCKET_CONNECT_OPEN, this._onWsContented, this);
};
t.prototype.clear = function() {};
t.prototype._onWsContented = function() {
c.default.Instance.begin();
var e = f.VM.getValue("lobby.roomID");
0 != e && this.sendEnterRoom(e);
};
Object.defineProperty(t.prototype, "roomID", {
get: function() {
return f.VM.getValue("lobby.roomID");
},
enumerable: !1,
configurable: !0
});
t.prototype.checkRoomID = function(e) {
return f.VM.getValue("lobby.roomID") == e;
};
t.prototype.checkRoomType = function(e) {
var t = e.split("_"), o = -1;
null != t && null != t[0] && (o = parseInt(t[0]));
return o == r.GameEnum.PlayType.GAME_7UP7DOWN;
};
t.prototype._onEnterRoom = function(t) {
var o = t.getUserData();
if (this.checkRoomID(o.rid)) {
var n = y.Instance;
if (null != o.user_data && o.uid == this.uid) {
n.bet_fee_currency = o.bet_fee_currency;
n.bet_options = o.bet_options;
n.goldRate = o.gold;
n.declearHistory.refresh(o.declear_history);
}
e.prototype._onEnterRoom.call(this, o, n);
}
};
t.prototype._onSwitchRoom = function(e) {
var t = e.getUserData();
if (this.checkRoomType(t.room_type)) {
f.VM.getValue("lobby.roomID") != t.r && f.VM.setValue("lobby.roomID", parseInt(t.r));
p.default.Instance.Global.emit(i.GameEvent.S2C_SWITCH_ROOM, t.r);
}
};
t.prototype._onDeal = function(t) {
var o = t.getUserData();
if (this.checkRoomID(o.rid)) {
var n = y.Instance;
e.prototype._onDeal.call(this, o, n);
}
};
t.prototype._onStartBet = function(t) {
var o = t.getUserData();
if (this.checkRoomID(o.rid)) {
var n = y.Instance;
e.prototype._onStartBet.call(this, o, n);
}
};
t.prototype._onBet = function(t) {
var o = t.getUserData();
if (this.checkRoomID(o.rid)) {
var n = y.Instance;
e.prototype._onBet.call(this, o, n);
}
};
t.prototype._onBetBatch = function(t) {
var o = t.getUserData();
if (this.checkRoomID(o.rid)) {
var n = y.Instance;
e.prototype._onBetBatch.call(this, o, n);
}
};
t.prototype._onStopBet = function(t) {
var o = t.getUserData();
if (this.checkRoomID(o.rid)) {
var n = y.Instance;
e.prototype._onStopBet.call(this, o, n);
}
};
t.prototype._onShow = function(t) {
var o = t.getUserData();
if (this.checkRoomID(o.rid)) {
var n = y.Instance, a = new m.SUDStruct.HistoryData({
d: o.room_data.show_card,
w: o.win_options,
g: o.gold
});
n.declearHistory.addHistory(a);
n.goldRate = o.gold;
e.prototype._onShow.call(this, o, n);
}
};
t.prototype._onResetRoom = function(t) {
var o = t.getUserData();
if (this.checkRoomID(o.rid)) {
var n = y.Instance;
e.prototype._onResetRoom.call(this, o, n);
}
};
t.prototype._onInteract = function(t) {
var o = t.getUserData();
if (this.checkRoomID(o.rid)) {
var n = y.Instance;
e.prototype._onInteract.call(this, o, n);
}
};
t.prototype._onRank = function(t) {
var o = t.getUserData();
if (this.checkRoomID(o.rid)) {
var n = y.Instance;
e.prototype._onRank.call(this, o, n);
}
};
t.prototype._onLeave = function(t) {
var o = t.getUserData();
if (this.checkRoomID(o.rid)) {
var n = y.Instance;
e.prototype._onLeave.call(this, o, n);
}
};
t.prototype._onLeaveSingle = function(t) {
var o = t.getUserData();
if (this.checkRoomID(o.rid) || 0 == f.VM.getValue("lobby.roomID")) {
var n = y.Instance;
e.prototype._onLeaveSingle.call(this, o, n);
}
};
t.prototype._onDismiss = function(t) {
var o = t.getUserData();
if (this.checkRoomID(o.rid)) {
var n = y.Instance;
e.prototype._onDismiss.call(this, o, n);
}
};
t.prototype._onBalanceRefresh = function(t) {
var o = t.getUserData();
if (!this.checkRoomID(o.rid)) {
var n = y.Instance;
e.prototype._onBalanceRefresh.call(this, o, n);
}
};
t.prototype.sendEnterRoom = function(e, t) {
void 0 === t && (t = !0);
var o = h.default.Instance.makeMsg(l.C2S.ROOM_ENTER_ROOM, {
u: this.uid,
t: this.token,
r: e,
is_open: t
});
h.default.Instance.send(o);
};
t.prototype.sendBet = function(e, t) {
var o = d.Tools.TNumber.num2thousand(e);
u.default.Instance.CompositeBetNum = e;
var n = h.default.Instance.makeMsg(l.C2S.ROOM_BET, {
u: this.uid,
t: this.token,
r: this.roomID,
fee: o,
option: t
});
h.default.Instance.send(n);
};
t.prototype.sendInteract = function(e, t, o) {
var n;
n = o ? {
u: this.uid,
t: this.token,
r: this.roomID,
to_u: e,
opt_type: t,
opt_val: o
} : {
u: this.uid,
t: this.token,
r: this.roomID,
to_u: e,
opt_type: t
};
var a = h.default.Instance.makeMsg(l.C2S.ROOM_INTERACT, n);
h.default.Instance.send(a);
};
t.prototype.sendRank = function(e, t) {
var o = h.default.Instance.makeMsg(l.C2S.ROOM_RANK, {
u: this.uid,
t: this.token,
r: this.roomID,
page: e,
count: t
});
h.default.Instance.send(o);
};
t.prototype.sendLeave = function() {
var e = h.default.Instance.makeMsg(l.C2S.ROOM_LEAVE, {
u: this.uid,
t: this.token,
r: this.roomID
});
h.default.Instance.send(e);
};
t._instance = null;
return t;
}(_.CompositeProxy);
o.default = g;
cc._RF.pop();
}, {
"../../../Game/client/global/enum/game/Event": "Event",
"../../../Game/client/global/enum/game/Game": "Game",
"../../../Game/client/global/enum/net/C2S": "C2S",
"../../../Game/client/global/enum/net/S2C": "S2C",
"../../../Game/fromework/global/Tools": "Tools",
"../../../Game/fromework/helper/EventHelper": "EventHelper",
"../../../Game/fromework/mvvm/modelView/ViewModel": "ViewModel",
"../../../client/logic/game/HearBeat": "HearBeat",
"../../../client/model/ErrorModel": "ErrorModel",
"../../../fromework/helper/NetHelper": "NetHelper",
"../../Common/Utils/CompositeProxy": "CompositeProxy",
"./SUDStruct": "SUDStruct"
} ],
SUDRecordSmall: [ function(e, t, o) {
"use strict";
cc._RF.push(t, "50d50YeCQJDsYZWQHvnmRKp", "SUDRecordSmall");
var n, a = this && this.__extends || (n = function(e, t) {
return (n = Object.setPrototypeOf || {
__proto__: []
} instanceof Array && function(e, t) {
e.__proto__ = t;
} || function(e, t) {
for (var o in t) Object.prototype.hasOwnProperty.call(t, o) && (e[o] = t[o]);
})(e, t);
}, function(e, t) {
n(e, t);
function o() {
this.constructor = e;
}
e.prototype = null === t ? Object.create(t) : (o.prototype = t.prototype, new o());
}), i = this && this.__decorate || function(e, t, o, n) {
var a, i = arguments.length, r = i < 3 ? t : null === n ? n = Object.getOwnPropertyDescriptor(t, o) : n;
if ("object" == typeof Reflect && "function" == typeof Reflect.decorate) r = Reflect.decorate(e, t, o, n); else for (var l = e.length - 1; l >= 0; l--) (a = e[l]) && (r = (i < 3 ? a(r) : i > 3 ? a(t, o, r) : a(t, o)) || r);
return i > 3 && r && Object.defineProperty(t, o, r), r;
};
Object.defineProperty(o, "__esModule", {
value: !0
});
var r = e("../../../Game/client/global/enum/game/Event"), l = e("../../../Game/fromework/helper/EventHelper"), s = e("../../Common/Utils/CompositeUtil"), c = cc._decorator, u = c.ccclass, d = c.property, p = function(e) {
a(t, e);
function t() {
var t = null !== e && e.apply(this, arguments) || this;
t.TopRecordParent = null;
t.TopRecordItem = null;
t.Color_2_6 = null;
t.Color_7 = null;
t.Color_8_12 = null;
t.SpriteFrame_2_6 = null;
t.SpriteFrame_7 = null;
t.SpriteFrame_8_12 = null;
t.Color_Font_Normal = null;
t.Color_Font_Red = null;
t.Light = null;
t.MaxCount = 18;
return t;
}
t.prototype.onEnable = function() {
l.default.Instance.Global.bind(r.GameEvent.S2C_ENTER_ROOM, this._onEnterRoom, this);
l.default.Instance.Global.bind(r.GameEvent.S2C_RESET, this._onResetRoom, this);
};
t.prototype.onDisable = function() {
l.default.Instance.Global.unbind(r.GameEvent.S2C_ENTER_ROOM, this._onEnterRoom, this);
l.default.Instance.Global.unbind(r.GameEvent.S2C_RESET, this._onResetRoom, this);
};
t.prototype.onLoad = function() {
this.refreshTopRecord(!1);
};
t.prototype._onEnterRoom = function() {
this.refreshTopRecord(!1);
};
t.prototype._onResetRoom = function() {
this.refreshTopRecord(!0);
};
t.prototype.refreshTopRecord = function(e) {
var t = this;
void 0 === e && (e = !1);
var o = s.default.Game.Model;
this.TopRecordParent.destroyAllChildren();
for (var n = o.declearHistory.getSimpleHistory(this.MaxCount), a = 0; a < n.length; a++) {
var i = n[a], r = cc.instantiate(this.TopRecordItem);
r.active = !0;
r.setPosition(cc.Vec2.ZERO);
r.parent = this.TopRecordParent;
var l = i.getType();
r.getChildByName("Background").getComponent(cc.Sprite).spriteFrame = 0 == l ? this.SpriteFrame_2_6 : 1 == l ? this.SpriteFrame_7 : this.SpriteFrame_8_12;
r.getChildByName("GoldBorder").active = i.goldRate > 1;
var c = r.getChildByName("Points");
c.color = i.isRed() ? this.Color_Font_Red : this.Color_Font_Normal;
c.getComponent(cc.Label).string = i.getNumber() + "";
}
if (e && null != this.Light) {
this.TopRecordParent.getComponent(cc.Layout).updateLayout();
var u = this.TopRecordParent.children[this.TopRecordParent.children.length - 1], d = u.parent.convertToWorldSpaceAR(u.position), p = this.Light.node.parent.convertToNodeSpaceAR(d);
this.Light.node.position = p;
this.Light.node.active = !0;
this.Light.armatureName = "Armature";
this.Light.once(dragonBones.EventObject.COMPLETE, function() {
t.Light.node.active = !1;
}, this);
this.Light.playAnimation("animation_new_details", 1);
}
};
i([ d(cc.Node) ], t.prototype, "TopRecordParent", void 0);
i([ d(cc.Node) ], t.prototype, "TopRecordItem", void 0);
i([ d(cc.Color) ], t.prototype, "Color_2_6", void 0);
i([ d(cc.Color) ], t.prototype, "Color_7", void 0);
i([ d(cc.Color) ], t.prototype, "Color_8_12", void 0);
i([ d(cc.SpriteFrame) ], t.prototype, "SpriteFrame_2_6", void 0);
i([ d(cc.SpriteFrame) ], t.prototype, "SpriteFrame_7", void 0);
i([ d(cc.SpriteFrame) ], t.prototype, "SpriteFrame_8_12", void 0);
i([ d(cc.Color) ], t.prototype, "Color_Font_Normal", void 0);
i([ d(cc.Color) ], t.prototype, "Color_Font_Red", void 0);
i([ d(dragonBones.ArmatureDisplay) ], t.prototype, "Light", void 0);
i([ d ], t.prototype, "MaxCount", void 0);
return i([ u ], t);
}(cc.Component);
o.default = p;
cc._RF.pop();
}, {
"../../../Game/client/global/enum/game/Event": "Event",
"../../../Game/fromework/helper/EventHelper": "EventHelper",
"../../Common/Utils/CompositeUtil": "CompositeUtil"
} ],
SUDRecord: [ function(e, t, o) {
"use strict";
cc._RF.push(t, "d3b8cYR8jxAt6ozgF1kLdpd", "SUDRecord");
var n, a = this && this.__extends || (n = function(e, t) {
return (n = Object.setPrototypeOf || {
__proto__: []
} instanceof Array && function(e, t) {
e.__proto__ = t;
} || function(e, t) {
for (var o in t) Object.prototype.hasOwnProperty.call(t, o) && (e[o] = t[o]);
})(e, t);
}, function(e, t) {
n(e, t);
function o() {
this.constructor = e;
}
e.prototype = null === t ? Object.create(t) : (o.prototype = t.prototype, new o());
}), i = this && this.__decorate || function(e, t, o, n) {
var a, i = arguments.length, r = i < 3 ? t : null === n ? n = Object.getOwnPropertyDescriptor(t, o) : n;
if ("object" == typeof Reflect && "function" == typeof Reflect.decorate) r = Reflect.decorate(e, t, o, n); else for (var l = e.length - 1; l >= 0; l--) (a = e[l]) && (r = (i < 3 ? a(r) : i > 3 ? a(t, o, r) : a(t, o)) || r);
return i > 3 && r && Object.defineProperty(t, o, r), r;
};
Object.defineProperty(o, "__esModule", {
value: !0
});
var r = e("../../../Game/fromework/global/Tools"), l = e("../../../Game/fromework/helper/UIHelper"), s = e("../../Common/Utils/CompositeUtil"), c = cc._decorator, u = c.ccclass, d = c.property, p = function(e) {
a(t, e);
function t() {
var t = null !== e && e.apply(this, arguments) || this;
t.Title = null;
t.Num_2_6 = null;
t.Num_7 = null;
t.Num_8_12 = null;
t.DoubleRed = null;
t.MinMax = null;
t.BottomContent = null;
t.BottomRecordParent = null;
t.BottomRecordItem = null;
t.Color_2_6 = null;
t.Color_7 = null;
t.Color_8_12 = null;
t.SpriteFrame_2_6 = null;
t.SpriteFrame_7 = null;
t.SpriteFrame_8_12 = null;
t.Color_Font_Normal = null;
t.Color_Font_Red = null;
return t;
}
t.prototype.onLoad = function() {
var e = s.default.Game.Model.declearHistory.getWinCount();
this.Title.string = r.Tools.TStr.replaceAll("Nearly %{num} rounds:", "%{num}", e.total);
this.Num_2_6.string = e.num_2_6 + "";
this.Num_7.string = e.num_7 + "";
this.Num_8_12.string = e.num_8_12 + "";
this.DoubleRed.string = e.doubleRed + "";
this.MinMax.string = e.minMax + "";
this.refreshBottomRecord();
};
t.prototype.refreshBottomRecord = function() {
var e = s.default.Game.Model;
this.BottomRecordParent.destroyAllChildren();
for (var t = e.declearHistory.getComplexHistory(18), o = 0, n = 0; n < t.length; n++) {
var a = t[n], i = 27 + 54 * n;
a.length > o && (o = a.length);
for (var r = 0; r < a.length; r++) {
var l = a[r], c = -(27 + 54 * r), u = cc.instantiate(this.BottomRecordItem);
u.active = !0;
u.setPosition(cc.v2(i, c));
u.parent = this.BottomRecordParent;
var d = l.getType();
u.getChildByName("Background").getComponent(cc.Sprite).spriteFrame = 0 == d ? this.SpriteFrame_2_6 : 1 == d ? this.SpriteFrame_7 : this.SpriteFrame_8_12;
u.getChildByName("GoldBorder").active = l.goldRate > 1;
var p = u.getChildByName("Points");
p.color = l.isRed() ? this.Color_Font_Red : this.Color_Font_Normal;
p.getComponent(cc.Label).string = l.getNumber() + "";
}
}
this.BottomContent.height = 54 * o;
};
t.prototype.onCloseClicked = function() {
l.default.Instance.removeMaskLayer(this.node, !0);
};
i([ d(cc.Label) ], t.prototype, "Title", void 0);
i([ d(cc.Label) ], t.prototype, "Num_2_6", void 0);
i([ d(cc.Label) ], t.prototype, "Num_7", void 0);
i([ d(cc.Label) ], t.prototype, "Num_8_12", void 0);
i([ d(cc.Label) ], t.prototype, "DoubleRed", void 0);
i([ d(cc.Label) ], t.prototype, "MinMax", void 0);
i([ d(cc.Node) ], t.prototype, "BottomContent", void 0);
i([ d(cc.Node) ], t.prototype, "BottomRecordParent", void 0);
i([ d(cc.Node) ], t.prototype, "BottomRecordItem", void 0);
i([ d(cc.Color) ], t.prototype, "Color_2_6", void 0);
i([ d(cc.Color) ], t.prototype, "Color_7", void 0);
i([ d(cc.Color) ], t.prototype, "Color_8_12", void 0);
i([ d(cc.SpriteFrame) ], t.prototype, "SpriteFrame_2_6", void 0);
i([ d(cc.SpriteFrame) ], t.prototype, "SpriteFrame_7", void 0);
i([ d(cc.SpriteFrame) ], t.prototype, "SpriteFrame_8_12", void 0);
i([ d(cc.Color) ], t.prototype, "Color_Font_Normal", void 0);
i([ d(cc.Color) ], t.prototype, "Color_Font_Red", void 0);
return i([ u ], t);
}(cc.Component);
o.default = p;
cc._RF.pop();
}, {
"../../../Game/fromework/global/Tools": "Tools",
"../../../Game/fromework/helper/UIHelper": "UIHelper",
"../../Common/Utils/CompositeUtil": "CompositeUtil"
} ],
SUDStruct: [ function(e, t, o) {
"use strict";
cc._RF.push(t, "ecfde4fte1D+53XgjfEzDzo", "SUDStruct");
Object.defineProperty(o, "__esModule", {
value: !0
});
o.SUDStruct = void 0;
(function(e) {
var t = function() {
function e(e) {
this.dice = [];
this.win = [];
this.goldRate = 1;
e && this.refresh(e);
}
e.prototype.refresh = function(e) {
this.dice = e.d;
this.win = e.w;
this.goldRate = e.g;
};
e.prototype.getNumber = function() {
return this.dice[0] + this.dice[1] + 2;
};
e.prototype.getType = function() {
var e = this.getNumber();
return e >= 2 && e <= 6 ? 0 : 7 == e ? 1 : e >= 8 && e <= 12 ? 2 : void 0;
};
e.prototype.getTypeString = function() {
var e = this.getNumber();
return e >= 2 && e <= 6 ? "2-6" : 7 == e ? "7" : e >= 8 && e <= 12 ? "8-12" : void 0;
};
e.prototype.isRed = function() {
var e = this, t = !1;
[ [ 0, 0 ], [ 0, 3 ], [ 3, 0 ], [ 3, 3 ] ].forEach(function(o) {
e.dice.toString() == o.toString() && (t = !0);
});
return t;
};
e.prototype.isMinMax = function() {
var e = this.getNumber();
return 2 == e || 12 == e;
};
return e;
}();
e.HistoryData = t;
var o = function() {
function e(e) {
this.historyArray = [];
e && this.refresh(e);
}
e.prototype.refresh = function(e) {
var o = this;
this.historyArray.splice(0);
e.forEach(function(e) {
var n = new t(e);
o.historyArray.push(n);
});
};
e.prototype.getWinCount = function() {
var e = 0, t = 0, o = 0, n = 0, a = 0, i = 0;
this.historyArray.forEach(function(r) {
var l = r.getType();
e++;
0 == l ? t++ : 1 == l ? o++ : 2 == l && n++;
r.isRed() && a++;
r.isMinMax() && i++;
});
return {
total: e,
num_2_6: t,
num_7: o,
num_8_12: n,
doubleRed: a,
minMax: i
};
};
e.prototype.addHistory = function(e) {
100 == this.historyArray.length && this.historyArray.shift();
this.historyArray.push(e);
};
e.prototype.getSimpleHistory = function(e) {
for (var t = [], o = this.historyArray.length - 1; o >= 0; o--) {
var n = this.historyArray[o];
t.unshift(n);
if (t.length == e) break;
}
return t;
};
e.prototype.getComplexHistory = function(e) {
for (var t = [], o = -1, n = this.historyArray.length - 1; n >= 0; n--) {
var a = this.historyArray[n];
if (o != a.getType()) {
if (t.length == e) break;
o = a.getType();
t.unshift([]);
}
t[0].length != e && t[0].unshift(a);
}
return t;
};
e.prototype.getNearDice = function(e) {
void 0 === e && (e = 0);
var t = this.historyArray[this.historyArray.length - 1 - e];
return t ? t.dice : [ 0, 0 ];
};
return e;
}();
e.DeclearHistory = o;
})(o.SUDStruct || (o.SUDStruct = {}));
cc._RF.pop();
}, {} ],
ScoreBoardItem: [ function(e, t, o) {
"use strict";
cc._RF.push(t, "a5288PCdURNGLRJMF7jUSEA", "ScoreBoardItem");
var n, a = this && this.__extends || (n = function(e, t) {
return (n = Object.setPrototypeOf || {
__proto__: []
} instanceof Array && function(e, t) {
e.__proto__ = t;
} || function(e, t) {
for (var o in t) Object.prototype.hasOwnProperty.call(t, o) && (e[o] = t[o]);
})(e, t);
}, function(e, t) {
n(e, t);
function o() {
this.constructor = e;
}
e.prototype = null === t ? Object.create(t) : (o.prototype = t.prototype, new o());
}), i = this && this.__decorate || function(e, t, o, n) {
var a, i = arguments.length, r = i < 3 ? t : null === n ? n = Object.getOwnPropertyDescriptor(t, o) : n;
if ("object" == typeof Reflect && "function" == typeof Reflect.decorate) r = Reflect.decorate(e, t, o, n); else for (var l = e.length - 1; l >= 0; l--) (a = e[l]) && (r = (i < 3 ? a(r) : i > 3 ? a(t, o, r) : a(t, o)) || r);
return i > 3 && r && Object.defineProperty(t, o, r), r;
};
Object.defineProperty(o, "__esModule", {
value: !0
});
var r = e("../../../../Game/fromework/mvvm/modelView/ViewModel"), l = e("../../../../Game/client/model/LanguageModel"), s = cc._decorator, c = s.ccclass, u = s.property, d = function(e) {
a(t, e);
function t() {
var t = null !== e && e.apply(this, arguments) || this;
t.Title = null;
t.Scores = [];
t._data = [];
return t;
}
t.prototype.onItemInitCallFunc = function(e, t) {
this._data = e;
var o = r.VM.getValue("user.name");
this.Title.string = String(t + 1);
this.Title.node.color = cc.color(255, 255, 255);
for (var n = 0; n < this.Scores.length; n++) {
var a = this._data[n];
if (null != a) {
this.Scores[n].node.active = !0;
this.Scores[n].string = a.score >= 0 ? a.score + "" : l.default.getString("GAME_USER_STATE_OUT");
this.Scores[n].node.color = a.name == o ? cc.color(253, 180, 0) : cc.color(220, 220, 220);
} else this.Scores[n].node.active = !1;
}
};
t.prototype.onItemEnterCallFunc = function() {
this.node.opacity = 255;
};
t.prototype.onItemExitCallFunc = function() {
this.node.opacity = 0;
};
i([ u(cc.Label) ], t.prototype, "Title", void 0);
i([ u([ cc.Label ]) ], t.prototype, "Scores", void 0);
return i([ c ], t);
}(cc.Component);
o.default = d;
cc._RF.pop();
}, {
"../../../../Game/client/model/LanguageModel": "LanguageModel",
"../../../../Game/fromework/mvvm/modelView/ViewModel": "ViewModel"
} ],
ScoreBoard: [ function(e, t, o) {
"use strict";
cc._RF.push(t, "67129A2QMZDeIRVaSmu9YPy", "ScoreBoard");
var n, a = this && this.__extends || (n = function(e, t) {
return (n = Object.setPrototypeOf || {
__proto__: []
} instanceof Array && function(e, t) {
e.__proto__ = t;
} || function(e, t) {
for (var o in t) Object.prototype.hasOwnProperty.call(t, o) && (e[o] = t[o]);
})(e, t);
}, function(e, t) {
n(e, t);
function o() {
this.constructor = e;
}
e.prototype = null === t ? Object.create(t) : (o.prototype = t.prototype, new o());
}), i = this && this.__decorate || function(e, t, o, n) {
var a, i = arguments.length, r = i < 3 ? t : null === n ? n = Object.getOwnPropertyDescriptor(t, o) : n;
if ("object" == typeof Reflect && "function" == typeof Reflect.decorate) r = Reflect.decorate(e, t, o, n); else for (var l = e.length - 1; l >= 0; l--) (a = e[l]) && (r = (i < 3 ? a(r) : i > 3 ? a(t, o, r) : a(t, o)) || r);
return i > 3 && r && Object.defineProperty(t, o, r), r;
};
Object.defineProperty(o, "__esModule", {
value: !0
});
var r = e("../../../../fromework/component/listView/ListView"), l = e("../../../../Game/fromework/global/Tools"), s = e("../../../../Game/fromework/mvvm/modelView/ViewModel"), c = e("../../../../Game/client/model/LanguageModel"), u = e("../../../model/LobbyModel"), d = cc._decorator, p = d.ccclass, h = d.property, f = function(e) {
a(t, e);
function t() {
var t = null !== e && e.apply(this, arguments) || this;
t.Title = null;
t.PlayName = null;
t.UserNames = [];
t.TotalScores = [];
t.ScoreList = null;
t._model = null;
t._callFunc = null;
return t;
}
t.prototype._refreshView = function() {
var e = u.default.Instance.getGamePlay(this._model.roomData.rtype);
this.Title.string = c.default.getString("GAME_SCORE_BOARD_TITLE") + "|" + c.default.getString("COMMON_GAME_ID") + this._model.roomId + "|" + e.name + "#:" + this._model.roomData.round;
this.PlayName.string = e.name;
var t = this._model.scoreBoardData, o = [], n = [];
t.body && t.body.forEach(function(e) {
var a = [];
e.forEach(function(e, n) {
var i = t.head[n];
o[n] || (o[n] = 0);
o[n] += parseFloat(e);
a.push({
name: i,
score: parseFloat(e)
});
});
n.push(a);
});
for (var a = 0; a < this.UserNames.length; a++) {
var i = t.head[a], r = i == s.VM.getValue("user.name");
if (null != i) {
this.UserNames[a].node.active = !0;
this.UserNames[a].string = l.Tools.TStr.ellipsisString(i, 12);
this.UserNames[a].node.color = r ? cc.color(253, 180, 0) : cc.color(220, 220, 220);
} else this.UserNames[a].node.active = !1;
var d = o[a];
if (null != d) {
this.TotalScores[a].node.active = !0;
this.TotalScores[a].string = d + "";
this.TotalScores[a].node.color = r ? cc.color(253, 180, 0) : cc.color(220, 220, 220);
} else this.TotalScores[a].node.active = !1;
}
this.ScoreList.datas = n;
};
t.prototype.show = function(e, t) {
this._model = e;
this._callFunc = t;
this._refreshView();
};
t.prototype.close = function() {
if (this._callFunc) {
this._callFunc();
this._callFunc = null;
}
this._model = null;
this.node.removeFromParent(!0);
this.node.destroy();
};
t.prototype.onCloseBtnClicked = function() {
this.close();
};
i([ h(cc.Label) ], t.prototype, "Title", void 0);
i([ h(cc.Label) ], t.prototype, "PlayName", void 0);
i([ h([ cc.Label ]) ], t.prototype, "UserNames", void 0);
i([ h([ cc.Label ]) ], t.prototype, "TotalScores", void 0);
i([ h(r.default) ], t.prototype, "ScoreList", void 0);
return i([ p ], t);
}(cc.Component);
o.default = f;
cc._RF.pop();
}, {
"../../../../Game/client/model/LanguageModel": "LanguageModel",
"../../../../Game/fromework/global/Tools": "Tools",
"../../../../Game/fromework/mvvm/modelView/ViewModel": "ViewModel",
"../../../../fromework/component/listView/ListView": "ListView",
"../../../model/LobbyModel": "LobbyModel"
} ],
ScoreItem: [ function(e, t, o) {
"use strict";
cc._RF.push(t, "773e86WfxVAfojis788iHuY", "ScoreItem");
var n, a = this && this.__extends || (n = function(e, t) {
return (n = Object.setPrototypeOf || {
__proto__: []
} instanceof Array && function(e, t) {
e.__proto__ = t;
} || function(e, t) {
for (var o in t) Object.prototype.hasOwnProperty.call(t, o) && (e[o] = t[o]);
})(e, t);
}, function(e, t) {
n(e, t);
function o() {
this.constructor = e;
}
e.prototype = null === t ? Object.create(t) : (o.prototype = t.prototype, new o());
}), i = this && this.__decorate || function(e, t, o, n) {
var a, i = arguments.length, r = i < 3 ? t : null === n ? n = Object.getOwnPropertyDescriptor(t, o) : n;
if ("object" == typeof Reflect && "function" == typeof Reflect.decorate) r = Reflect.decorate(e, t, o, n); else for (var l = e.length - 1; l >= 0; l--) (a = e[l]) && (r = (i < 3 ? a(r) : i > 3 ? a(t, o, r) : a(t, o)) || r);
return i > 3 && r && Object.defineProperty(t, o, r), r;
};
Object.defineProperty(o, "__esModule", {
value: !0
});
var r = e("../../Game/client/global/enum/game/Const"), l = e("../../Game/client/global/enum/game/Event"), s = e("../../Game/client/global/enum/game/Game"), c = e("../../Game/client/logic/game/GameHelper"), u = e("../../Game/client/model/LanguageModel"), d = e("../../Game/fromework/global/Tools"), p = e("../../Game/fromework/helper/EventHelper"), h = e("../global/PopHelper"), f = e("./Card"), _ = e("./Group"), m = .44 * r.GROUP_DEFAULT_WIDTH, y = .44 * r.CARD_WIDTH, g = .44 * r.CARD_SHOW_WIDTH, v = cc._decorator, C = v.ccclass, b = v.property, I = function(e) {
a(t, e);
function t() {
var t = null !== e && e.apply(this, arguments) || this;
t.Prefab_Group = null;
t.Prefab_Card = null;
t.Background = null;
t.UserName = null;
t.Winner = null;
t.WinnerLab = null;
t.CardParent = null;
t.Waiting = null;
t.TipsBtn = null;
t.HalfBtn = null;
t.GameScore = null;
t.ReadyIcon = null;
t.TotalScore = null;
t.CashNode = null;
t.Cash = null;
t.GoldNode = null;
t.Gold = null;
t.BonusNode = null;
t.Bonus = null;
t.WinColor = null;
t.LoseColor = null;
t.BackFrames = [];
t.ButtonFrames = [];
t._waitingTimeId = 0;
t._data = null;
t._isPrefect = !1;
return t;
}
t.prototype.addDropCards = function() {
this.CardParent.destroyAllChildren();
for (var e = y / 2, t = 0; t < this._data.maxCardCount; t++) {
var o = cc.instantiate(this.Prefab_Card);
o.setPosition(cc.v2(e + t * g, 0));
o.scale = .44;
o.parent = this.CardParent;
o.getComponent(f.default).open = !1;
}
};
t.prototype.addDeclearCards = function() {
var e = this;
this.CardParent.destroyAllChildren();
var t = this._data.declearCards, o = c.GroupHelper.getPokerHands(t, this._data.wildCard, this._data.maxScore, this._data.maxCardCount), n = 0;
t.forEach(function(t) {
var a = c.GroupHelper.getGroupType(t, e._data.wildCard), i = c.GroupHelper.getScore(t, o.hasPureSequence, o.sequCount, e._data.wildCard, e._data.maxCardCount), r = (t.length - 1) * g + m, l = n + r / 2;
n += r;
var s = cc.instantiate(e.Prefab_Group);
s.width = r;
s.height = .44 * s.height;
s.setPosition(cc.v2(l, -43));
s.zIndex = 99;
s.parent = e.CardParent;
var u = s.getComponent(_.default);
u.initNoDetail(a, i, o.hasPureSequence, !1);
var d = u.node.x - u.node.width / 2 + (m - y) / 2 + y / 2;
t.forEach(function(t, o) {
var n = cc.instantiate(e.Prefab_Card);
n.setPosition(cc.v2(d + o * g, 0));
n.scale = .44;
n.parent = e.CardParent;
var a = n.getComponent(f.default);
a.init(t, !0, e._data.wildCard);
a.WildCard.node.active = c.GroupHelper.checkWild(a.idx16, e._data.wildCard) && !c.GroupHelper.isJoker(a.idx16);
});
});
};
t.prototype.setLabelColor = function(e) {
this.UserName.node.color = e ? this.WinColor : this.LoseColor;
this.WinnerLab.node.color = e ? this.WinColor : this.LoseColor;
this.Waiting.node.color = e ? this.WinColor : this.LoseColor;
this.GameScore.node.color = e ? this.WinColor : this.LoseColor;
this.TotalScore.node.color = e ? this.WinColor : this.LoseColor;
this.Cash.node.color = e ? this.WinColor : this.LoseColor;
this.Gold.node.color = e ? this.WinColor : this.LoseColor;
this.Bonus.node.color = e ? this.WinColor : this.LoseColor;
this.Background.spriteFrame = e ? this.BackFrames[0] : this.BackFrames[1];
};
t.prototype.refreshReady = function(e) {
var t = e.getUserData();
t.uid == this._data.uid && (this.ReadyIcon.active = 4 == t.confirm_state);
};
t.prototype.onItemInitCallFunc = function(e) {
var t = this;
this._data = e;
p.default.Instance.Global.bind(l.GameEvent.SCORE_WINDOW_REFRESH_READY, this.refreshReady, this);
var o = e.declearCards.length > 0 ? c.GroupHelper.getTotalScore(e.declearCards, this._data.wildCard, this._data.maxScore, this._data.maxCardCount) : 0;
this._isPrefect = parseInt(e.gameScore) <= o;
this.UserName.string = e.userName;
this.Winner.active = e.isWinner;
this.WinnerLab.node.active = !e.isWinner;
this.GameScore.string = String(e.gameScore);
this.ReadyIcon.active = 4 == e.confirm_state;
if (e.play.cls == s.GameEnum.PlayType.RUMMY_POOL || e.play.cls == s.GameEnum.PlayType.RUMMY_DEALS) {
this.TotalScore.node.active = !0;
this.CashNode.active = !1;
this.GoldNode.active = !1;
this.BonusNode.active = !1;
} else {
this.TotalScore.node.active = e.play.currency != s.GameEnum.MoneyType.CASH && e.play.currency != s.GameEnum.MoneyType.GOLD;
this.CashNode.active = e.play.currency == s.GameEnum.MoneyType.CASH;
this.GoldNode.active = e.play.currency == s.GameEnum.MoneyType.GOLD;
this.BonusNode.active = 0 != e.bonus;
}
this.TotalScore.string = String(e.totalScore);
this.Cash.string = String(e.totalScore);
this.Gold.string = String(e.totalScore);
this.Bonus.string = "-" + d.Tools.TNumber.numFixed(e.bonus, 2);
this.TipsBtn.active = !1;
this.HalfBtn.active = !e.draw && 2 == this._data.res;
if (0 == e.res) {
this.Waiting.node.active = !0;
this.CardParent.active = !1;
this.Waiting.string = u.default.getString("TABLE_WAIT") + "..." + e.countDown;
this._waitingTimeId = c.Countdown.creat(e.countDown, null, function(e) {
t.Waiting.string = u.default.getString("TABLE_WAIT") + "..." + e;
});
} else {
c.Countdown.deleta(this._waitingTimeId);
this.Waiting.node.active = !1;
this.CardParent.active = !0;
}
this.WinnerLab.string = 2 == e.res ? u.default.getString("END_LOST") : 3 == e.res ? u.default.getString("END_DROPPED") : 4 == e.res ? u.default.getString("GAME_USER_STATE_OUT") : "";
if (0 == this._data.declearCards.length) this.addDropCards(); else {
1 == e.res && e.declearCards.length > 0 && this.addDeclearCards();
2 == e.res && e.declearCards.length > 0 && this.addDeclearCards();
3 == e.res && this.addDropCards();
}
this.setLabelColor(e.isSelf);
};
t.prototype.onItemEnterCallFunc = function() {
this.node.opacity = 255;
};
t.prototype.onItemExitCallFunc = function() {
this.node.opacity = 0;
};
t.prototype.onTipsBtnClicked = function() {
this._isPrefect ? this._data.onDeclareTipsBtnClicked && this._data.onDeclareTipsBtnClicked(this.TipsBtn) : h.PopHelper.Instance.showBestDeclare(this._data.declearCards, this._data.wildCard, this._data.maxScore, this._data.maxCardCount);
};
t.prototype.onHalfBtnClicked = function() {
h.PopHelper.Instance.showTips(u.default.getString("TIPS_HALFCOUNT"), this.node.parent.parent.parent);
};
t.prototype.onDestroy = function() {
c.Countdown.deleta(this._waitingTimeId, !1);
p.default.Instance.Global.unbind(l.GameEvent.SCORE_WINDOW_REFRESH_READY, this.refreshReady, this);
};
i([ b(cc.Prefab) ], t.prototype, "Prefab_Group", void 0);
i([ b(cc.Prefab) ], t.prototype, "Prefab_Card", void 0);
i([ b(cc.Sprite) ], t.prototype, "Background", void 0);
i([ b(cc.Label) ], t.prototype, "UserName", void 0);
i([ b(cc.Node) ], t.prototype, "Winner", void 0);
i([ b(cc.Label) ], t.prototype, "WinnerLab", void 0);
i([ b(cc.Node) ], t.prototype, "CardParent", void 0);
i([ b(cc.Label) ], t.prototype, "Waiting", void 0);
i([ b(cc.Node) ], t.prototype, "TipsBtn", void 0);
i([ b(cc.Node) ], t.prototype, "HalfBtn", void 0);
i([ b(cc.Label) ], t.prototype, "GameScore", void 0);
i([ b(cc.Node) ], t.prototype, "ReadyIcon", void 0);
i([ b(cc.Label) ], t.prototype, "TotalScore", void 0);
i([ b(cc.Node) ], t.prototype, "CashNode", void 0);
i([ b(cc.Label) ], t.prototype, "Cash", void 0);
i([ b(cc.Node) ], t.prototype, "GoldNode", void 0);
i([ b(cc.Label) ], t.prototype, "Gold", void 0);
i([ b(cc.Node) ], t.prototype, "BonusNode", void 0);
i([ b(cc.Label) ], t.prototype, "Bonus", void 0);
i([ b(cc.Color) ], t.prototype, "WinColor", void 0);
i([ b(cc.Color) ], t.prototype, "LoseColor", void 0);
i([ b([ cc.SpriteFrame ]) ], t.prototype, "BackFrames", void 0);
i([ b([ cc.SpriteFrame ]) ], t.prototype, "ButtonFrames", void 0);
return i([ C ], t);
}(cc.Component);
o.default = I;
cc._RF.pop();
}, {
"../../Game/client/global/enum/game/Const": "Const",
"../../Game/client/global/enum/game/Event": "Event",
"../../Game/client/global/enum/game/Game": "Game",
"../../Game/client/logic/game/GameHelper": "GameHelper",
"../../Game/client/model/LanguageModel": "LanguageModel",
"../../Game/fromework/global/Tools": "Tools",
"../../Game/fromework/helper/EventHelper": "EventHelper",
"../global/PopHelper": "PopHelper",
"./Card": "Card",
"./Group": "Group"
} ],
ScoreWindow: [ function(e, t, o) {
"use strict";
cc._RF.push(t, "eb0fc92hPtLD5zTYqJK0Bma", "ScoreWindow");
var n, a = this && this.__extends || (n = function(e, t) {
return (n = Object.setPrototypeOf || {
__proto__: []
} instanceof Array && function(e, t) {
e.__proto__ = t;
} || function(e, t) {
for (var o in t) Object.prototype.hasOwnProperty.call(t, o) && (e[o] = t[o]);
})(e, t);
}, function(e, t) {
n(e, t);
function o() {
this.constructor = e;
}
e.prototype = null === t ? Object.create(t) : (o.prototype = t.prototype, new o());
}), i = this && this.__decorate || function(e, t, o, n) {
var a, i = arguments.length, r = i < 3 ? t : null === n ? n = Object.getOwnPropertyDescriptor(t, o) : n;
if ("object" == typeof Reflect && "function" == typeof Reflect.decorate) r = Reflect.decorate(e, t, o, n); else for (var l = e.length - 1; l >= 0; l--) (a = e[l]) && (r = (i < 3 ? a(r) : i > 3 ? a(t, o, r) : a(t, o)) || r);
return i > 3 && r && Object.defineProperty(t, o, r), r;
};
Object.defineProperty(o, "__esModule", {
value: !0
});
var r = e("../../fromework/component/listView/ListView"), l = e("../global/PopHelper"), s = e("../model/GameModel"), c = e("../logic/ui/ChairAlert/ChairAlert"), u = e("../logic/active/ActiveManager"), d = e("../../Game/fromework/helper/EventHelper"), p = e("../../Game/client/global/enum/game/Event"), h = e("../../Game/fromework/mvvm/modelView/ViewModel"), f = e("../../Game/client/model/CommonModel"), _ = e("../../Game/client/global/enum/game/Game"), m = e("../../Game/Script/global/GlobalValue"), y = e("../../Game/client/global/enum/game/Const"), g = e("../../Game/fromework/global/Tools"), v = e("../../Game/client/model/LanguageModel"), C = e("../../Game/client/logic/game/GameHelper"), b = e("../model/LobbyModel"), I = e("../../Game/fromework/helper/UIHelper"), E = cc._decorator, S = E.ccclass, T = E.property, R = function(e) {
a(t, e);
function t() {
var t = null !== e && e.apply(this, arguments) || this;
t.Panel = null;
t.Title = null;
t.ListView = null;
t.CountDown = null;
t.SwitchLabel = null;
t.PrefectTips = null;
t.LevelButton = null;
t.SplitButton = null;
t.SwitchButton = null;
t.ReadyButton = null;
t._uiType = 0;
t._tipsTimeId = -1;
t._countDownTimeId = -1;
t._switchTimeId = -1;
t._model = null;
t._isShowAction = !0;
t._isKickByMoney = !1;
t._isKickByOther = !1;
return t;
}
t.prototype.onEnable = function() {
d.default.Instance.Global.bind(p.GameEvent.SCORE_WINDOW_REFRESH_TIME, this.refreshTime, this);
};
t.prototype.onDisable = function() {
d.default.Instance.Global.unbind(p.GameEvent.SCORE_WINDOW_REFRESH_TIME, this.refreshTime, this);
this._model && d.default.Instance.Global.unbind(p.GameEvent.S2C_READY, this.refreshReady, this);
};
t.prototype.openAction = function() {
var e = this;
if (this._isShowAction) {
this.Panel.setPosition(cc.v2(0, this.node.height / 2 + this.Panel.height / 2));
this.Panel.runAction(cc.sequence(cc.moveTo(.1, cc.v2(0, 0)), cc.callFunc(function() {
e.ListView.refreshVisualBox();
})));
}
};
t.prototype.closeAction = function(e) {
this._isShowAction ? this.Panel.runAction(cc.sequence(cc.moveTo(.1, cc.v2(0, -(this.node.height / 2 + this.Panel.height / 2))), cc.callFunc(function() {
e && e();
}))) : e && e();
};
t.prototype.refreshReady = function() {
if (2 == this._uiType) {
var e = this._model.allUserData.getUserData(h.VM.getValue("user.uid"));
this.ReadyButton.active = this._model.roomData.ready_switch && 2 == this._model.optData.state && e && 4 != e.confirm_state;
this._model.allUserData.userMap.forEach(function(e) {
d.default.Instance.Global.emit(p.GameEvent.SCORE_WINDOW_REFRESH_READY, e);
});
}
};
t.prototype.showRejoinAlert = function(e) {
var t = this, o = e.currency == _.GameEnum.MoneyType.CASH ? m.default.getInstance().isCashGame ? y.MoneySymbol : y.FailMoneySymbol : "", n = g.Tools.TStr.replaceAll(v.default.getString("GAME_TIPS_REJOIN"), "%{num}", o + e.base), a = {
title: v.default.getString("PROMPT_NOTICE"),
content: n,
leftTitle: v.default.getString("TABLE_BTN_NO"),
rightTitle: v.default.getString("TABLE_BTN_YES"),
rightCallFunc: function() {
var e = t._model.allUserData.getUserData(h.VM.getValue("user.uid"));
e && e.rejoin && s.default.Instance.sendRejoin();
}
};
l.PopHelper.Instance.showAlert(a, this.node);
};
t.prototype.onDeclareTipsBtnClicked = function(e) {
var t = this, o = e.parent.convertToWorldSpaceAR(e.getPosition()), n = this.PrefectTips.parent.convertToNodeSpaceAR(o);
this.PrefectTips.y = n.y - 60;
if (-1 != this._tipsTimeId) {
clearTimeout(this._tipsTimeId);
this._tipsTimeId = -1;
}
this.PrefectTips.active = !0;
this._tipsTimeId = setTimeout(function() {
t.PrefectTips.active = !1;
}, 2e3);
};
t.prototype.refreshTime = function(e) {
var t = e.getUserData();
this.setCountDown(t.time);
this.refreshReady();
};
t.prototype.setCountDown = function(e) {
var t = this;
if (-1 != this._countDownTimeId) {
C.Countdown.deleta(this._countDownTimeId, !1);
this._countDownTimeId = -1;
}
this._countDownTimeId = C.Countdown.creat(e, function(e) {
if (e) {
t._countDownTimeId = -1;
t.close();
}
}, function(e) {
var o;
o = t._isKickByMoney || t._isKickByOther ? v.default.getString("QIANBUGOU_JIESUAN") : t._model && t._model.optData && 1 == t._model.optData.state ? v.default.getString("TIPS_WAITING") : v.default.getString("END_WAIT1");
t.CountDown.string = g.Tools.TStr.replaceAll(o, "%{num}", e);
t && t._model && t._model.is_recharge && 4 == e && l.PopHelper.Instance.closeAlert();
}, this);
};
t.prototype.setSwitchCountDown = function(e) {
var t = this;
if (-1 != this._switchTimeId) {
C.Countdown.deleta(this._switchTimeId, !1);
this._switchTimeId = -1;
}
this._switchTimeId = C.Countdown.creat(e, function(e) {
if (e) {
t._switchTimeId = -1;
t.close(!1, !0);
}
}, function(e) {
t.SwitchLabel.string = v.default.getString("ZH_SWITCH") + "(" + e + ")";
}, this);
};
t.prototype.refreshList = function(e) {
var t = this, o = b.default.Instance.getGamePlay(this._model.roomData.rtype), n = [];
e.forEach(function(e) {
if (e && !(o.cls == _.GameEnum.PlayType.RUMMY_POOL && 0 != e.out_round && e.out_round < t._model.roomData.round - 1) && (o.cls != _.GameEnum.PlayType.RUMMY_POINTS && o.cls != _.GameEnum.PlayType.RUMMY_TENCARD || 0 != e.state)) {
var a = new f.Common.ScoreItemData(), i = o.cls == _.GameEnum.PlayType.RUMMY_POINTS || o.cls == _.GameEnum.PlayType.RUMMY_TENCARD ? 1 == e.res ? "+" : "-" : "", r = "-" == i && e.bonus ? e.bonus : 0;
a.wildCard = t._model.roomData.xcard;
a.isSelf = e.uid == h.VM.getValue("user.uid");
a.isWinner = 1 == e.res;
a.userName = e.name;
a.uid = e.uid;
a.res = e.res;
a.gameScore = e.score + "";
a.totalScore = i + g.Tools.TNumber.numFixed(e.tscore - r, 2);
a.bonus = r;
a.countDown = t._model.getCountDown();
a.declearCards = t._model.declearData.getDeclearCards(e.uid);
a.maxCardCount = t._model.roomData.mcard;
a.onDeclareTipsBtnClicked = t.onDeclareTipsBtnClicked.bind(t);
a.draw = e.draw;
a.maxScore = o ? o.rate : y.TOTAL_GAME_SCORE;
a.play = o;
n.push(a);
}
});
this.ListView.datas = n;
};
t.prototype.show = function(e, t, o) {
void 0 === o && (o = !0);
this._model = t || s.RoomModelManager.Instance.getModel();
this._isShowAction = o;
this._uiType = e;
this.Title.string = g.Tools.TStr.replaceAll(v.default.getString("END_GI"), "%{num}", this._model.roomData.rid);
m.default.getInstance().isCashGame;
this.openAction();
var n = new Map(), a = h.VM.getValue("user.uid"), i = this._model.allUserData.getUserData(a), r = !1;
this._isKickByMoney = this._model.allUserData.kickList && 2 == this._model.allUserData.kickList[h.VM.getValue("user.uid")];
this._isKickByOther = this._model.allUserData.kickList && null != this._model.allUserData.kickList[h.VM.getValue("user.uid")];
var f = this._model.allUserData.kickList && 6 == this._model.allUserData.kickList[h.VM.getValue("user.uid")];
2 == e && d.default.Instance.Global.bind(p.GameEvent.S2C_READY, this.refreshReady, this);
this.ReadyButton.active = !1;
var E = b.default.Instance.getGamePlay(this._model.roomData.rtype);
if (E) {
var S = 2 == e && this._model.roomData.ready_switch && 2 == this._model.optData.state && i && 4 != i.confirm_state && 5 != i.state;
if (E.cls == _.GameEnum.PlayType.RUMMY_POINTS || E.cls == _.GameEnum.PlayType.RUMMY_TENCARD) {
this.LevelButton.active = !0;
this.SwitchButton.active = !0;
r = !0;
this.SplitButton.active = !1;
this.ReadyButton.active = S;
} else if (E.cls == _.GameEnum.PlayType.RUMMY_POOL) {
this.LevelButton.active = !1;
this.SwitchButton.active = !1;
r = !1;
this.SplitButton.active = i && 0 == i.split && this._model.roomData.split && 4 != i.res;
this.ReadyButton.active = !(4 == i.res && 4 == i.state) && S;
} else if (E.cls == _.GameEnum.PlayType.RUMMY_DEALS) {
this.LevelButton.active = !1;
this.SwitchButton.active = !1;
r = !1;
this.SplitButton.active = !1;
this.ReadyButton.active = 2 != this._model.dealsResult && S;
}
}
if (5 != e && -1 != this._switchTimeId) {
C.Countdown.deleta(this._switchTimeId, !1);
this._switchTimeId = -1;
this.SwitchLabel.string = v.default.getString("ZH_SWITCH");
}
if (4 != e) {
var T = b.default.Instance.getGamePlay(this._model.roomData.rtype);
if (T) if (T.cls == _.GameEnum.PlayType.RUMMY_POINTS || T.cls == _.GameEnum.PlayType.RUMMY_TENCARD) {
var R = g.Tools.TObj.deepCopy(this._model);
s.ScoreRecord.Instance.setRecord(T.cls, R);
} else {
R = g.Tools.TObj.deepCopy(this._model);
s.ScoreRecord.Instance.setRecord(T.cls, R);
}
}
if (1 == e) {
this.CountDown.string = v.default.getString("END_WAIT");
n = this._model.allUserData.userMap;
this.SwitchButton.active = !this._isKickByMoney && !this._isKickByOther && r;
}
if (2 == e) {
this.setCountDown(this._isKickByMoney || this._isKickByOther ? 10 : this._model.getCountDown());
(this._isKickByMoney || this._isKickByOther) && d.default.Instance.Global.unbind(p.GameEvent.SCORE_WINDOW_REFRESH_TIME, this.refreshTime, this);
n = this._model.allUserData.userMap;
this.SwitchButton.active = !this._isKickByMoney && !this._isKickByOther && r;
}
if (3 == e) {
this.CountDown.string = "";
n.set(a, i);
}
if (4 == e) {
this.LevelButton.active = !1;
this.SwitchButton.active = !1;
n = this._model.allUserData.userMap;
}
if (5 == e && (E.cls == _.GameEnum.PlayType.RUMMY_POINTS || E.cls == _.GameEnum.PlayType.RUMMY_TENCARD)) {
this.CountDown.string = "";
this.SwitchLabel.string = v.default.getString("ZH_SWITCH") + "(5)";
this.setSwitchCountDown(5);
n.set(a, i);
}
this.refreshList(n);
if (2 == e) {
E.cls == _.GameEnum.PlayType.RUMMY_POOL ? i && 4 == i.res && i.rejoin && i.out_round == this._model.roomData.round - 1 && this.showRejoinAlert(E) : this._isKickByMoney && (b.default.Instance.kickRoomType = this._model.roomData.rtype);
this._model.allUserData.filterLeaveUser(this._isKickByMoney ? a : 0);
}
if (f) {
clearTimeout(this._tipsTimeId);
if (-1 != this._countDownTimeId) {
C.Countdown.deleta(this._countDownTimeId, !1);
this._countDownTimeId = -1;
}
if (-1 != this._switchTimeId) {
C.Countdown.deleta(this._switchTimeId, !1);
this._switchTimeId = -1;
}
I.default.Instance.addBundleMaskLayer(y.BundleUIPath.ChairAlert, function(e) {
u.default.Instance.isOpenWithdraw = !0;
e.getComponent(c.default).showView(function() {
d.default.Instance.Global.emit(p.GameEvent.TABLE_LEAVE_ROOM, {
isWithdraw: f
});
});
}, l.PopZindex.Alert);
}
};
t.prototype.close = function(e, t) {
var o = this;
void 0 === e && (e = !1);
void 0 === t && (t = !1);
this.closeAction(function() {
clearTimeout(o._tipsTimeId);
o.PrefectTips.active = !1;
if (-1 != o._countDownTimeId) {
C.Countdown.deleta(o._countDownTimeId, !1);
o._countDownTimeId = -1;
}
if (-1 != o._switchTimeId) {
C.Countdown.deleta(o._switchTimeId, !1);
o._switchTimeId = -1;
}
d.default.Instance.Global.emit(p.GameEvent.SCORE_WINDOW_CLOSE, {
type: o._uiType,
isLeave: e,
isSwitch: t,
isKick: o._isKickByMoney || o._isKickByOther
});
d.default.Instance.Global.unbind(p.GameEvent.S2C_READY, o.refreshReady, o);
o._model = null;
l.PopHelper.Instance.hideBestDeclare();
o.node.removeFromParent(!0);
o.node.destroy();
});
};
t.prototype.onCloseBtnClicked = function() {
this.close();
};
t.prototype.onLeaveBtnClicked = function() {
this.close(!0);
};
t.prototype.onSwitchBtnClicked = function() {
this.close(!1, !0);
};
t.prototype.onSplitBtnClicked = function() {
var e = h.VM.getValue("user.uid"), t = this._model.allUserData.getUserData(e);
t && 0 == t.split && s.default.Instance.sendInitiateSplit();
this.close();
};
t.prototype.onReadyBtnClicked = function() {
this._model.roomData.ready_switch && 2 == this._model.optData.state && s.default.Instance.sendReady();
};
t.prototype.onDestroy = function() {
clearTimeout(this._tipsTimeId);
if (-1 != this._countDownTimeId) {
C.Countdown.deleta(this._countDownTimeId, !1);
this._countDownTimeId = -1;
}
if (-1 != this._switchTimeId) {
C.Countdown.deleta(this._switchTimeId, !1);
this._switchTimeId = -1;
}
};
i([ T(cc.Node) ], t.prototype, "Panel", void 0);
i([ T(cc.Label) ], t.prototype, "Title", void 0);
i([ T(r.default) ], t.prototype, "ListView", void 0);
i([ T(cc.Label) ], t.prototype, "CountDown", void 0);
i([ T(cc.Label) ], t.prototype, "SwitchLabel", void 0);
i([ T(cc.Node) ], t.prototype, "PrefectTips", void 0);
i([ T(cc.Node) ], t.prototype, "LevelButton", void 0);
i([ T(cc.Node) ], t.prototype, "SplitButton", void 0);
i([ T(cc.Node) ], t.prototype, "SwitchButton", void 0);
i([ T(cc.Node) ], t.prototype, "ReadyButton", void 0);
return i([ S ], t);
}(cc.Component);
o.default = R;
cc._RF.pop();
}, {
"../../Game/Script/global/GlobalValue": "GlobalValue",
"../../Game/client/global/enum/game/Const": "Const",
"../../Game/client/global/enum/game/Event": "Event",
"../../Game/client/global/enum/game/Game": "Game",
"../../Game/client/logic/game/GameHelper": "GameHelper",
"../../Game/client/model/CommonModel": "CommonModel",
"../../Game/client/model/LanguageModel": "LanguageModel",
"../../Game/fromework/global/Tools": "Tools",
"../../Game/fromework/helper/EventHelper": "EventHelper",
"../../Game/fromework/helper/UIHelper": "UIHelper",
"../../Game/fromework/mvvm/modelView/ViewModel": "ViewModel",
"../../fromework/component/listView/ListView": "ListView",
"../global/PopHelper": "PopHelper",
"../logic/active/ActiveManager": "ActiveManager",
"../logic/ui/ChairAlert/ChairAlert": "ChairAlert",
"../model/GameModel": "GameModel",
"../model/LobbyModel": "LobbyModel"
} ],
SequenceBulb: [ function(e, t, o) {
"use strict";
cc._RF.push(t, "33052ztu2BBvIzNooPbPEaK", "SequenceBulb");
var n, a = this && this.__extends || (n = function(e, t) {
return (n = Object.setPrototypeOf || {
__proto__: []
} instanceof Array && function(e, t) {
e.__proto__ = t;
} || function(e, t) {
for (var o in t) Object.prototype.hasOwnProperty.call(t, o) && (e[o] = t[o]);
})(e, t);
}, function(e, t) {
n(e, t);
function o() {
this.constructor = e;
}
e.prototype = null === t ? Object.create(t) : (o.prototype = t.prototype, new o());
}), i = this && this.__decorate || function(e, t, o, n) {
var a, i = arguments.length, r = i < 3 ? t : null === n ? n = Object.getOwnPropertyDescriptor(t, o) : n;
if ("object" == typeof Reflect && "function" == typeof Reflect.decorate) r = Reflect.decorate(e, t, o, n); else for (var l = e.length - 1; l >= 0; l--) (a = e[l]) && (r = (i < 3 ? a(r) : i > 3 ? a(t, o, r) : a(t, o)) || r);
return i > 3 && r && Object.defineProperty(t, o, r), r;
};
Object.defineProperty(o, "__esModule", {
value: !0
});
var r = cc._decorator, l = r.ccclass, s = r.property, c = function(e) {
a(t, e);
function t() {
var t = null !== e && e.apply(this, arguments) || this;
t.Checked = new Array();
t.Sequence = null;
t._showTimeId = -1;
return t;
}
t.prototype.onDestroy = function() {
if (-1 != this._showTimeId) {
clearTimeout(this._showTimeId);
this._showTimeId = -1;
}
};
t.prototype.refreshBulb = function(e, t, o, n) {
this.Sequence.active = 10 != n;
var a = !1;
if (0 == this.Checked[0].active && e) {
a = !0;
this.runActiveAction(this.Checked[0]);
} else this.Checked[0].active = e;
if (0 == this.Checked[1].active && e && t >= 2) {
a = !0;
this.runActiveAction(this.Checked[1]);
} else this.Checked[1].active = e && t >= 2;
if (0 == this.Checked[2].active && 0 == o) {
a = !0;
this.runActiveAction(this.Checked[2]);
} else this.Checked[2].active = 0 == o;
a && this.showBulb();
};
t.prototype.showBulb = function() {
var e = this;
if (-1 == this._showTimeId) {
this.node.active = !0;
this._showTimeId = setTimeout(function() {
if (e.node && e.node.isValid) {
e._showTimeId = -1;
e.node.active = !1;
}
}, 3e3);
} else {
this._showTimeId = -1;
clearTimeout(this._showTimeId);
this.node.active = !1;
}
};
t.prototype.runActiveAction = function(e) {
var t = cc.sequence(cc.scaleTo(.1, .5), cc.scaleTo(.1, 1.3), cc.scaleTo(.1, .8), cc.scaleTo(.1, 1));
e.active = !0;
e.stopAllActions();
e.runAction(t);
};
i([ s([ cc.Node ]) ], t.prototype, "Checked", void 0);
i([ s(cc.Node) ], t.prototype, "Sequence", void 0);
return i([ l ], t);
}(cc.Component);
o.default = c;
cc._RF.pop();
}, {} ],
Sequence: [ function(e, t, o) {
"use strict";
cc._RF.push(t, "5eed1RqkdJN+KgGRQr8ybHb", "Sequence");
Object.defineProperty(o, "__esModule", {
value: !0
});
var n = e("../../../../../Game/fromework/global/Tools"), a = e("../GameHelper"), i = e("./CheckTools"), r = function() {
function e() {}
e.getAllSequ = function(e) {
var t = this, o = [];
e.forEach(function(e) {
t._getSequence(e).forEach(function(e) {
o.push(e);
});
});
return o;
};
e.getOneSequ = function(e) {
for (var t = [], o = 0; o < e.length; o++) {
var a = e[o], i = this._getSequence(a);
if (i.length > 0) {
t = n.Tools.TArray.deepCopy(i[0]);
break;
}
}
return t;
};
e.getMaxOneSequ = function(t) {
var o = [];
e.getAllSequ(t).forEach(function(e) {
var t = i.default.getRealScore(o), a = i.default.getRealScore(e);
a > t ? o = n.Tools.TArray.deepCopy(e) : a == t && i.default.getRealPoints(e) > i.default.getRealPoints(o) && (o = n.Tools.TArray.deepCopy(e));
});
return o;
};
e.upwardChangeSequ = function(e, t, o) {
e.forEach(function(e) {
for (var n = 0, i = 0; i < e.length; i++) a.GroupHelper.checkWild(e[i], o) || (n = a.GroupHelper.getPattern(e[i]));
for (i = 0; i < t.length; i++) if (a.GroupHelper.getPattern(t[i][0]) == n) {
for (var r = t[i], l = 0; l < r.length; l++) {
var s = r[l];
if (e[2] - e[0] == 2) {
if (s - e[2] == 1 && e[2] % 16 != 1) {
e.push(s);
e.pop();
r.splice(l, 1);
break;
}
} else if (s - e[1] == 2 || e[1] % 16 == 12 && s % 16 == 1) {
e.push(s);
e.pop();
r.splice(l, 1);
break;
}
}
break;
}
});
};
e.downwardChangeSequ = function(e, t, o) {
e.forEach(function(e) {
for (var n = 0, i = 0; i < e.length; i++) a.GroupHelper.checkWild(e[i], o) || (n = a.GroupHelper.getPattern(e[i]));
for (i = 0; i < t.length; i++) if (a.GroupHelper.getPattern(t[i][0]) == n) {
for (var r = t[i], l = 0; l < r.length; l++) {
var s = r[l];
if (e[2] - e[0] == 2) {
if (s - e[0] == -1) {
e.unshift(s);
e.pop();
r.splice(l, 1);
break;
}
} else if (e[2] % 16 == 1) {
if (s % 16 == 11) {
e.unshift(s);
e.pop();
r.splice(l, 1);
break;
}
} else if (s - e[0] == -2) {
var c = e.pop();
e.unshift(c);
e.unshift(s);
e.pop();
r.splice(l, 1);
break;
}
}
break;
}
});
};
e.upAddSequence = function(e, t, o) {
e.forEach(function(e) {
for (var n = 0, i = 0; i < e.length; i++) a.GroupHelper.checkWild(e[i], o) || (n = a.GroupHelper.getPattern(e[i]));
for (i = 0; i < t.length; i++) if (a.GroupHelper.getPattern(t[i][0]) == n) {
for (var r = t[i], l = 0; l < r.length; l++) {
var s = r[l];
if (3 == e.length) {
if (e[2] - e[0] == 2) {
if (s - e[2] == 1 && e[2] % 16 != 1) {
e.push(s);
r.splice(l, 1);
}
} else if (s - e[1] == 2 || e[1] % 16 == 12 && s % 16 == 1) {
e.push(s);
r.splice(l, 1);
}
} else if (s - e[e.length - 1] == 1) {
e.push(s);
r.splice(l, 1);
}
}
break;
}
});
};
e.downAddSequence = function(e, t, o) {
e.forEach(function(e) {
for (var n = 0, i = 0; i < e.length; i++) a.GroupHelper.checkWild(e[i], o) || (n = a.GroupHelper.getPattern(e[i]));
for (i = 0; i < t.length; i++) if (a.GroupHelper.getPattern(t[i][0]) == n) {
for (var r = t[i], l = 0; l < r.length; l++) {
var s = r[l];
if (3 == e.length) {
if (e[2] - e[0] == 2) {
if (s - e[0] == -1) {
e.unshift(s);
r.splice(l, 1);
}
} else if (e[2] % 16 == 1) {
if (s % 16 == 11) {
e.unshift(s);
r.splice(l, 1);
}
} else if (s - e[0] == -2) {
var c = e.pop();
e.unshift(c);
e.unshift(s);
r.splice(l, 1);
}
} else if (s - e[0] == -1) {
e.unshift(s);
r.splice(l, 1);
}
}
break;
}
});
};
e._getSequence = function(e) {
var t = [], o = [], a = i.default.checkoutSame(e, t, o), r = this.__getSequence(t);
if (a) {
var l = this.__getSequence(o);
l.length > 0 && (r = r.concat(l));
if (r.length > 0) {
var s = n.Tools.TArray.duplicate(e, n.Tools.TArray.flatten(r)), c = this.__getSequence(s);
c.length > 0 && (r = r.concat(c));
}
}
return r;
};
e.__getSequence = function(e) {
var t = [];
if (e.length < 2) return [];
var o = i.default.hasMaxSequence(e);
o.length > 0 && t.push(o);
for (var a = n.Tools.TArray.duplicate(e, o), r = 0, l = 1; l < a.length; ) {
if (a[l] - a[r] == 1) {
t.push([ a[r], a[l] ]);
l++;
} else if (a[l] - a[r] == 2) {
t.push([ a[r], a[l] ]);
l++;
}
r = l;
l++;
}
return t;
};
return e;
}();
o.default = r;
cc._RF.pop();
}, {
"../../../../../Game/fromework/global/Tools": "Tools",
"../GameHelper": "GameHelper",
"./CheckTools": "CheckTools"
} ],
ServiceView: [ function(e, t, o) {
"use strict";
cc._RF.push(t, "310ae8S9mZNhp8RoR8vIAFP", "ServiceView");
var n, a = this && this.__extends || (n = function(e, t) {
return (n = Object.setPrototypeOf || {
__proto__: []
} instanceof Array && function(e, t) {
e.__proto__ = t;
} || function(e, t) {
for (var o in t) Object.prototype.hasOwnProperty.call(t, o) && (e[o] = t[o]);
})(e, t);
}, function(e, t) {
n(e, t);
function o() {
this.constructor = e;
}
e.prototype = null === t ? Object.create(t) : (o.prototype = t.prototype, new o());
}), i = this && this.__decorate || function(e, t, o, n) {
var a, i = arguments.length, r = i < 3 ? t : null === n ? n = Object.getOwnPropertyDescriptor(t, o) : n;
if ("object" == typeof Reflect && "function" == typeof Reflect.decorate) r = Reflect.decorate(e, t, o, n); else for (var l = e.length - 1; l >= 0; l--) (a = e[l]) && (r = (i < 3 ? a(r) : i > 3 ? a(t, o, r) : a(t, o)) || r);
return i > 3 && r && Object.defineProperty(t, o, r), r;
};
Object.defineProperty(o, "__esModule", {
value: !0
});
var r = e("../../../../Game/fromework/global/Tools"), l = e("../../../../Game/fromework/helper/EventHelper"), s = e("../../../../Game/fromework/helper/UIHelper"), c = e("../../../../platform/Platform"), u = e("../../../../Game/client/global/enum/game/Event"), d = cc._decorator, p = d.ccclass, h = d.property, f = function(e) {
a(t, e);
function t() {
var t = null !== e && e.apply(this, arguments) || this;
t.RechargeView = null;
t.ProgressNode = null;
t.CloseButton = null;
t.isClose = !1;
return t;
}
t.prototype.onLoad = function() {
l.default.Instance.Global.bind(u.PlatformEvent.PLATFORM_PICK_ALBUM_COMPLETED, this.getImageSuccess, this);
};
t.prototype.onDestroy = function() {
l.default.Instance.Global.unbind(u.PlatformEvent.PLATFORM_PICK_ALBUM_COMPLETED, this.getImageSuccess, this);
};
t.prototype.getImageSuccess = function(e) {
var t = e.getUserData();
c.default.log("[UserSetting] select user head image:" + t);
if ("" != t && cc.sys.isNative) {
var o = r.Tools.Base64.uint8arrayToBase64(jsb.fileUtils.getDataFromFile(t));
c.default.log("service getImage Success:" + t);
this.RechargeView.evaluateJS("imgFile('" + o + "')");
} else if (cc.sys.isBrowser) {
o = "data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAADUlEQVQImWNgYGBgAAAABQABh6FO1AAAAABJRU5ErkJggg==";
this.RechargeView._impl._iframe.contentWindow.postMessage(o, "*");
}
};
t.prototype.start = function() {
var e = this;
this.isClose = !1;
if (cc.sys.isNative) {
this.RechargeView.setJavascriptInterfaceScheme("servicecallback");
this.RechargeView.setOnJSCallback(function(t, o) {
c.default.log("servicecallback:" + o);
var n = e.getParam(o.replace("servicecallback://", ""));
e.onNativeHtmlCallFunc(t, n);
});
}
};
t.prototype.getParam = function(e) {
for (var t = e.split("&"), o = {}, n = 0; n < t.length; n++) {
var a = t[n].split("=");
o[a[0]] = a[1];
}
return o;
};
t.prototype.onNativeHtmlCallFunc = function(e, t) {
c.default.log("service onNativeHtmlCallFunc" + t);
"close" == t.func && this.onCloseClicked();
"getImage" == t.func && c.default.pickImageFromAlbum();
};
t.prototype.InitView = function(e) {
this.RechargeView.url = e;
};
t.prototype.serviceViewEvent = function(e, t) {
t === cc.WebView.EventType.LOADED ? this.ProgressNode.active = !1 : t === cc.WebView.EventType.LOADING ? this.ProgressNode.active = !0 : t === cc.WebView.EventType.ERROR && (this.ProgressNode.active = !1);
};
t.prototype.onCloseClicked = function() {
if (this && this.node && this.node.isValid && !this.isClose) {
this.isClose = !0;
s.default.Instance.removeMaskLayer(this.node, !0);
}
};
i([ h(cc.WebView) ], t.prototype, "RechargeView", void 0);
i([ h(cc.Node) ], t.prototype, "ProgressNode", void 0);
i([ h(cc.Node) ], t.prototype, "CloseButton", void 0);
return i([ p ], t);
}(cc.Component);
o.default = f;
cc._RF.pop();
}, {
"../../../../Game/client/global/enum/game/Event": "Event",
"../../../../Game/fromework/global/Tools": "Tools",
"../../../../Game/fromework/helper/EventHelper": "EventHelper",
"../../../../Game/fromework/helper/UIHelper": "UIHelper",
"../../../../platform/Platform": "Platform"
} ],
Set: [ function(e, t, o) {
"use strict";
cc._RF.push(t, "664e8SGLgxNjIneJvlDf1lM", "Set");
Object.defineProperty(o, "__esModule", {
value: !0
});
var n = e("../../../../../Game/fromework/global/Tools"), a = e("../GameHelper"), i = e("./CheckTools"), r = function() {
function e() {}
e.linkAddSet = function(e, t) {
e.forEach(function(e) {
for (var o = 0; o < t.length; o++) {
for (var n = !1, i = 0; i < e.length; i++) if (a.GroupHelper.getPattern(t[o][0]) == a.GroupHelper.getPattern(e[i])) {
n = !0;
break;
}
if (!n) for (var r = 0; r < t[o].length; r++) if (t[o][r] % 16 == e[0] % 16) {
e.push(t[o][r]);
t[o].splice(r, 1);
break;
}
}
});
};
e.getMaxOneSet = function(t) {
var o = [];
e.getSet(t).forEach(function(e) {
var t = i.default.getRealScore(o);
i.default.getRealScore(e) > t && (o = n.Tools.TArray.deepCopy(e));
});
return o;
};
e.getMaxOneRealSet = function(t) {
var o = [];
e.getRellSet(t).forEach(function(e) {
var t = i.default.getRealScore(o);
i.default.getRealScore(e) > t && (o = n.Tools.TArray.deepCopy(e));
});
return o;
};
e.getSet = function(t) {
var o = [], a = [], r = i.default.checkoutSame(t, o, a), l = e._getSet(o);
if (r) {
var s = e._getSet(a);
s.length > 0 && (l = l.concat(s));
if (l.length > 0) {
var c = n.Tools.TArray.duplicate(t, n.Tools.TArray.flatten(l)), u = e._getSet(c);
u.length > 0 && (l = l.concat(u));
}
}
return l;
};
e.getRellSet = function(t) {
var o = [], a = [], r = i.default.checkoutSame(t, o, a), l = e._getRellSet(o);
if (r) {
var s = e._getRellSet(a);
s.length > 0 && (l = l.concat(s));
if (l.length > 0) {
var c = n.Tools.TArray.duplicate(t, n.Tools.TArray.flatten(l)), u = e._getRellSet(c);
u.length > 0 && (l = l.concat(u));
}
}
return l;
};
e._getSet = function(e) {
var t = [];
if (e.length < 2) return [];
e.sort(function(e, t) {
return a.GroupHelper.getFigure(e) - a.GroupHelper.getFigure(t);
});
for (var o = 0, n = 1; n < e.length; ) {
if (a.GroupHelper.getFigure(e[n]) == a.GroupHelper.getFigure(e[o]) && a.GroupHelper.getPattern(e[n]) != a.GroupHelper.getPattern(e[o])) {
t.push([ e[o], e[n] ]);
n++;
}
o = n;
n++;
}
return t;
};
e._getRellSet = function(e) {
var t = [];
if (e.length < 2) return [];
e.sort(function(e, t) {
return a.GroupHelper.getFigure(e) - a.GroupHelper.getFigure(t);
});
for (var o = 0, n = 1, i = 1; n < e.length; ) {
a.GroupHelper.getFigure(e[n]) == a.GroupHelper.getFigure(e[o]) && a.GroupHelper.getPattern(e[n]) != a.GroupHelper.getPattern(e[o]) ? i++ : i = 1;
if (i >= 3) {
t.push([ e[o - 1], e[o], e[n] ]);
i = 1;
n++;
}
o = n;
n++;
}
return t;
};
return e;
}();
o.default = r;
cc._RF.pop();
}, {
"../../../../../Game/fromework/global/Tools": "Tools",
"../GameHelper": "GameHelper",
"./CheckTools": "CheckTools"
} ],
ShellNetHttp: [ function(e, t, o) {
"use strict";
cc._RF.push(t, "344e8PPimVPpq9S7i9ySeFg", "ShellNetHttp");
Object.defineProperty(o, "__esModule", {
value: !0
});
var n = e("../client/global/PopHelper"), a = e("../Game/fromework/helper/EventHelper"), i = e("../Game/fromework/net/NetUtils"), r = e("../platform/Platform"), l = function() {
function e() {
this._timeout = 1e4;
this._reconnectCount = 0;
}
Object.defineProperty(e, "Instance", {
get: function() {
e._Instance || (e._Instance = new e());
return e._Instance;
},
enumerable: !1,
configurable: !0
});
e.prototype._showAlert = function() {
var e = parseInt(cc.sys.localStorage.getItem("NET_TIME_OUT_COUNT"));
isNaN(e) && (e = 0);
e++;
cc.sys.localStorage.setItem("NET_TIME_OUT_COUNT", String(e));
};
e.prototype._onError = function() {};
e.prototype._onTimeout = function() {};
e.prototype._onResault = function(e, t) {
var o = i.uncodeMsg(e), n = o.m && o.f ? "S2C_" + o.m + "_" + o.f : null, l = o.d || null;
r.default.log("ShellNetHttp _onResault: ", n);
r.default.log("ShellNetHttp _onResault data: ", l);
l.c && t && t(l.c);
n && a.default.Instance.Net.emit(n, l);
};
e.prototype._onReceive = function(e, t, o) {
this._reconnectCount = 0;
if (null == t || null == t.status) this._onError && this._onError(); else if (t.status >= 200 && t.status < 300 || 304 == t.status) if (t.response && "" !== t.response && " " !== t.response) {
var n = JSON.parse(t.response);
if (n) {
r.default.log("ShellNetHttp response:", e, t.response);
this._onResault && this._onResault(n, o);
} else r.default.warn(e + " request is error!!!" + n);
} else r.default.warn(e + " request is error!!!"); else r.default.warn(e + "request is error!!!");
};
e.prototype._setRequestHead = function(e) {
e.setRequestHeader("Access-Control-Allow-Origin", "*");
e.setRequestHeader("Access-Control-Allow-Methods", "GET, POST");
e.setRequestHeader("Access-Control-Allow-Headers", "x-requested-with,content-type");
e.setRequestHeader("Content-Type", "application/json");
};
e.prototype.bindCallback = function(e, t, o) {
this._onError = e || null;
this._onTimeout = t || null;
this._onResault = o || null;
};
e.prototype.get = function(e, t, o, n) {
var a = this, l = cc.loader.getXMLHttpRequest();
l.timeout = this._timeout;
var s = e;
if (t) {
var c = n ? t : i.encodeMsg(t), u = "", d = 0;
for (var p in c) {
u += 0 == d ? "?" + p + "=" + c[p] : "&" + p + "=" + c[p];
d++;
}
s += encodeURI(u);
}
r.default.log("ShellNetHttp get request:" + e, JSON.stringify(t));
l.open("GET", s, !0);
this._setRequestHead(l);
l.onload = function() {
a._onReceive(e, l, o);
};
l.onerror = function() {
a.retury(!0, e, t, o, n);
a._onError && a._onError();
o && o(-1);
};
l.ontimeout = function() {
a._onTimeout && a._onTimeout();
};
try {
l.send();
} catch (e) {
this._onError && this._onError();
}
};
e.prototype.post = function(e, t, o, a, l) {
var s = this, c = cc.loader.getXMLHttpRequest();
c.timeout = this._timeout;
r.default.log("ShellNetHttp post request:" + e, JSON.stringify(t));
c.open("POST", e, !0);
this._setRequestHead(c);
c.onload = function() {
r.default.log("ShellNetHttp response _onReceive:", e, c.response);
s._onReceive(e, c, o);
};
c.onerror = function(n) {
r.default.log("httppost error: " + JSON.stringify(n));
s.retury(!1, e, t, o, a);
s._onError && s._onError();
o && o(-1);
};
c.ontimeout = function() {
r.default.log("httppost ontimeout: ");
s._onTimeout && s._onTimeout();
if (l) {
n.PopHelper.Instance.showTips("request time out,trying again!");
s.retury(!1, e, t, o, a, l);
}
};
try {
if (t) {
var u = a ? t : i.encodeMsg(t), d = JSON.stringify(u);
r.default.log("ShellNetHttp post send:" + d);
c.send(d);
} else c.send();
} catch (e) {
this._onError && this._onError();
}
};
e.prototype.retury = function(e, t, o, n, a, r) {
this._reconnectCount++;
if (this._reconnectCount <= i.ReconnectionCount) e ? this.get(t, o, n, a) : this.post(t, o, n, a, r); else {
this._onTimeout && this._onTimeout();
this._reconnectCount = 0;
}
};
e.prototype.makeMsg = function(e, t) {
return {
m: e[0],
f: e[1],
d: t
};
};
e._Instance = null;
return e;
}();
o.default = l;
cc._RF.pop();
}, {
"../Game/fromework/helper/EventHelper": "EventHelper",
"../Game/fromework/net/NetUtils": "NetUtils",
"../client/global/PopHelper": "PopHelper",
"../platform/Platform": "Platform"
} ],
ShellProxy: [ function(e, t, o) {
"use strict";
cc._RF.push(t, "68a28Oqu4RApbroGbwuIkAD", "ShellProxy");
Object.defineProperty(o, "__esModule", {
value: !0
});
var n = e("../Config"), a = e("../Game/client/global/enum/game/Event"), i = e("../Game/client/global/enum/net/C2S"), r = e("../Game/client/global/enum/net/S2C"), l = e("../Game/client/model/LanguageModel"), s = e("../Game/fromework/global/Tools"), c = e("../Game/fromework/helper/EventHelper"), u = e("../client/global/PopHelper"), d = e("../platform/Platform"), p = e("./ShellNetHttp"), h = function() {
function e() {
this.m_ad_type = "";
this._serverConfig = null;
}
Object.defineProperty(e, "Instance", {
get: function() {
e._instance || (e._instance = new e());
return e._instance;
},
enumerable: !1,
configurable: !0
});
e.prototype.Init = function() {
c.default.Instance.Net.bind(r.S2C.SERVER.CONFIG, this._onServerConfig, this);
c.default.Instance.Net.bind(r.S2C.SERVER.GAME_SERVICE, this._onGetGameService, this);
};
e.prototype.clear = function() {
this._serverConfig = null;
};
Object.defineProperty(e.prototype, "serverConfig", {
get: function() {
return this._serverConfig;
},
enumerable: !1,
configurable: !0
});
e.prototype._onServerConfig = function() {};
e.prototype._onGetGameService = function(e) {
var t = e.getUserData();
c.default.Instance.Global.emit(a.ServerEvent.SERVER_GAME_SERVICE, t);
};
e.prototype.sendGetServerConfig = function(e) {
var t = this;
this.m_ad_type = e;
var o = d.default.getPackageName(), a = n.Config.Channel, r = d.default.getVersionCode(), l = "", c = "", u = cc.sys.localStorage.getItem("CommonUserUid"), h = s.Tools.GenerateID(s.Tools.TNumber.randomNumber(2, 50)), f = "0", _ = d.default.getTextFromClipboard();
null != _ && "" != _ && (f = s.Tools.TStr.getQueryString("invite_id", _));
if (cc.sys.isNative) {
l = d.default.getOnlyID();
c = d.default.getDeviceID();
} else {
l = "web_imei";
c = "web_device";
}
null == u && (u = "");
var m = d.default.getAFID(), y = this.makeMsg(i.C2S.SERVER_CONFIG, {
package: o,
channel: a,
version: r,
imei: l,
device_info: c,
uid: u,
ad_type: e,
invite_uid: f,
afid: m,
useless: h
});
p.default.Instance.post(d.default.getHotUpdateUrl(), y, function(e) {
t.netFaileAwarm(e);
}, !1, !0);
};
e.prototype.sendGetServerConfigAgain = function() {
this.sendGetServerConfig(this.m_ad_type);
};
e.prototype.sendGetGameService = function(e) {
var t = this;
this.m_ad_type = e;
var o, a = d.default.getPackageName(), r = n.Config.Channel, l = d.default.getVersionCode(), c = cc.sys.localStorage.getItem("CommonUserUid");
null == c && (c = "");
var u = s.Tools.GenerateID(s.Tools.TNumber.randomNumber(2, 50)), h = "0", f = d.default.getTextFromClipboard();
null != f && "" != f && (h = s.Tools.TStr.getQueryString("invite_id", f));
o = cc.sys.isNative ? d.default.getOnlyID() : "web_imei";
var _ = d.default.getNetworkOperatorMCC(), m = d.default.getAFID(), y = this.makeMsg(i.C2S.SERVER_GAME_SERVICE, {
p: a,
c: r,
v: l,
i: o,
u: c,
ad: e,
invite_u: h,
mcc: _,
afid: m,
none: u
});
p.default.Instance.post(d.default.getHotUpdateUrl(), y, function(e) {
t.netFaileAwarm(e);
}, !1, !0);
};
e.prototype.netFaileAwarm = function(e) {
var t = {
title: l.default.getString("PROMPT_NOTICE"),
content: l.default.getString("PROMPT_ERROR") + e,
rightTitle: l.default.getString("PROMPT_RETRY"),
rightCallFunc: this.restartGame,
target: this
};
u.PopHelper.Instance.showAlert(t);
};
e.prototype.sendGetGameServiceAgain = function() {
this.sendGetGameService(this.m_ad_type);
};
e.prototype.restartGame = function() {
cc.audioEngine.stopAll();
cc.game.restart();
};
e.prototype.makeMsg = function(e, t) {
return {
m: e[0],
f: e[1],
d: t
};
};
e._instance = null;
return e;
}();
o.default = h;
cc._RF.pop();
}, {
"../Config": "Config",
"../Game/client/global/enum/game/Event": "Event",
"../Game/client/global/enum/net/C2S": "C2S",
"../Game/client/global/enum/net/S2C": "S2C",
"../Game/client/model/LanguageModel": "LanguageModel",
"../Game/fromework/global/Tools": "Tools",
"../Game/fromework/helper/EventHelper": "EventHelper",
"../client/global/PopHelper": "PopHelper",
"../platform/Platform": "Platform",
"./ShellNetHttp": "ShellNetHttp"
} ],
ShopModel: [ function(e, t, o) {
"use strict";
cc._RF.push(t, "55865T26BBBfL8skzYp7ZN/", "ShopModel");
Object.defineProperty(o, "__esModule", {
value: !0
});
o.ShopProxy = void 0;
var n = e("../../Game/Script/global/GlobalValue"), a = e("../../Game/client/global/enum/game/Event"), i = e("../../Game/client/model/LanguageModel"), r = e("../../Game/fromework/helper/EventHelper"), l = e("../../Game/fromework/mvvm/modelView/ViewModel"), s = e("../../Game/fromework/net/NetHttp"), c = e("../global/PopHelper"), u = e("./WalletModel"), d = function() {
function e() {}
Object.defineProperty(e, "Instance", {
get: function() {
e._instance || (e._instance = new e());
return e._instance;
},
enumerable: !1,
configurable: !0
});
e.prototype.Init = function() {};
e.prototype.onProductList = function(e) {
var t = JSON.parse(e.response);
r.default.Instance.Global.emit(a.ShopEvent.SHOP_PRODUCT_LIST, t);
};
e.prototype.onReceipt = function(e) {
var t = JSON.parse(e.response);
if (t.code = 1) {
var o = {
title: i.default.getString("PROMPT_NOTICE"),
content: "Success!",
rightTitle: i.default.getString("TABLE_BTN_YES"),
rightCallFunc: function() {
u.WalletProxy.Instance.sendGetUserWallet();
},
cancelCallFunc: function() {
u.WalletProxy.Instance.sendGetUserWallet();
}
};
1 == t.data.status && (o.content = "Success");
2 == t.data.status && (o.content = "Failed");
3 == t.data.status && (o.content = "Panding");
c.PopHelper.Instance.showAlert(o);
}
};
e.prototype.sendProductList = function() {
s.default.Instance.get(n.default.getInstance().WalletUrl + "iosPayAmountType", {
player_index: l.VM.getValue("user.uid"),
token: l.VM.getValue("user.token")
}, this.onProductList.bind(this));
};
e.prototype.sendReceipt = function(e, t) {
var o = 0;
cc.sys.os == cc.sys.OS_ANDROID && (o = 1);
cc.sys.os == cc.sys.OS_IOS && (o = 2);
cc.sys.isNative || (o = 3);
var a = {
player_index: l.VM.getValue("user.uid"),
token: l.VM.getValue("user.token"),
gift_id: "",
amount: "",
user_name: "",
mobile_type: o,
tel_phone: "",
email: "",
upi: "",
receipt: e,
product_id: t
};
s.default.Instance.post(n.default.getInstance().WalletUrl + "pay", a, this.onReceipt.bind(this));
};
e._instance = null;
return e;
}();
o.ShopProxy = d;
cc._RF.pop();
}, {
"../../Game/Script/global/GlobalValue": "GlobalValue",
"../../Game/client/global/enum/game/Event": "Event",
"../../Game/client/model/LanguageModel": "LanguageModel",
"../../Game/fromework/helper/EventHelper": "EventHelper",
"../../Game/fromework/mvvm/modelView/ViewModel": "ViewModel",
"../../Game/fromework/net/NetHttp": "NetHttp",
"../global/PopHelper": "PopHelper",
"./WalletModel": "WalletModel"
} ],
ShopViewItem: [ function(e, t, o) {
"use strict";
cc._RF.push(t, "698d8Dr8O1O/6H93d8qsJnU", "ShopViewItem");
var n, a = this && this.__extends || (n = function(e, t) {
return (n = Object.setPrototypeOf || {
__proto__: []
} instanceof Array && function(e, t) {
e.__proto__ = t;
} || function(e, t) {
for (var o in t) Object.prototype.hasOwnProperty.call(t, o) && (e[o] = t[o]);
})(e, t);
}, function(e, t) {
n(e, t);
function o() {
this.constructor = e;
}
e.prototype = null === t ? Object.create(t) : (o.prototype = t.prototype, new o());
}), i = this && this.__decorate || function(e, t, o, n) {
var a, i = arguments.length, r = i < 3 ? t : null === n ? n = Object.getOwnPropertyDescriptor(t, o) : n;
if ("object" == typeof Reflect && "function" == typeof Reflect.decorate) r = Reflect.decorate(e, t, o, n); else for (var l = e.length - 1; l >= 0; l--) (a = e[l]) && (r = (i < 3 ? a(r) : i > 3 ? a(t, o, r) : a(t, o)) || r);
return i > 3 && r && Object.defineProperty(t, o, r), r;
};
Object.defineProperty(o, "__esModule", {
value: !0
});
var r = e("../../../../Game/client/global/enum/game/Const"), l = e("../../../../Game/fromework/global/ResLoader"), s = e("../../../../platform/Platform"), c = cc._decorator, u = c.ccclass, d = c.property, p = function(e) {
a(t, e);
function t() {
var t = null !== e && e.apply(this, arguments) || this;
t.Icon = null;
t.GameCurrency = null;
t.RechargeButton = null;
t.Money = null;
t._data = null;
return t;
}
t.prototype.onItemInitCallFunc = function(e, t) {
var o = this;
this._data = e;
this.GameCurrency.string = e.GameCurrency;
this.Money.string = r.MoneySymbol + e.amount;
var n = [ "resources/Texture/Shop/shop_icon_1", "resources/Texture/Shop/shop_icon_2", "resources/Texture/Shop/shop_icon_3", "resources/Texture/Shop/shop_icon_4", "resources/Texture/Shop/shop_icon_5", "resources/Texture/Shop/shop_icon_6" ][t < 6 ? t : 6];
l.default.Instance.loadBundleRes(n, cc.SpriteFrame, function(e, t) {
e ? s.default.log("Lobby load image error, path:" + n) : o.Icon && o.Icon.node && o.Icon.node.isValid && (o.Icon.spriteFrame = t);
});
};
t.prototype.onItemEnterCallFunc = function() {
this.node.opacity = 255;
this.RechargeButton.interactable = !0;
};
t.prototype.onItemExitCallFunc = function() {
this.node.opacity = 0;
this.RechargeButton.interactable = !1;
};
t.prototype.onRechargeClicked = function() {};
i([ d(cc.Sprite) ], t.prototype, "Icon", void 0);
i([ d(cc.Label) ], t.prototype, "GameCurrency", void 0);
i([ d(cc.Button) ], t.prototype, "RechargeButton", void 0);
i([ d(cc.Label) ], t.prototype, "Money", void 0);
return i([ u ], t);
}(cc.Component);
o.default = p;
cc._RF.pop();
}, {
"../../../../Game/client/global/enum/game/Const": "Const",
"../../../../Game/fromework/global/ResLoader": "ResLoader",
"../../../../platform/Platform": "Platform"
} ],
ShopView: [ function(e, t, o) {
"use strict";
cc._RF.push(t, "30ff8ZYySdIF4W4s+OayFZz", "ShopView");
var n, a = this && this.__extends || (n = function(e, t) {
return (n = Object.setPrototypeOf || {
__proto__: []
} instanceof Array && function(e, t) {
e.__proto__ = t;
} || function(e, t) {
for (var o in t) Object.prototype.hasOwnProperty.call(t, o) && (e[o] = t[o]);
})(e, t);
}, function(e, t) {
n(e, t);
function o() {
this.constructor = e;
}
e.prototype = null === t ? Object.create(t) : (o.prototype = t.prototype, new o());
}), i = this && this.__decorate || function(e, t, o, n) {
var a, i = arguments.length, r = i < 3 ? t : null === n ? n = Object.getOwnPropertyDescriptor(t, o) : n;
if ("object" == typeof Reflect && "function" == typeof Reflect.decorate) r = Reflect.decorate(e, t, o, n); else for (var l = e.length - 1; l >= 0; l--) (a = e[l]) && (r = (i < 3 ? a(r) : i > 3 ? a(t, o, r) : a(t, o)) || r);
return i > 3 && r && Object.defineProperty(t, o, r), r;
};
Object.defineProperty(o, "__esModule", {
value: !0
});
var r = e("../../../../fromework/component/listView/ListView"), l = e("../../../../Game/fromework/helper/EventHelper"), s = e("../../../../Game/fromework/helper/UIHelper"), c = e("../../../../Game/client/global/enum/game/Event"), u = e("../../../global/PopHelper"), d = e("../../../../Game/client/model/LanguageModel"), p = e("../../../model/ShopModel"), h = cc._decorator, f = h.ccclass, _ = h.property, m = function(e) {
a(t, e);
function t() {
var t = null !== e && e.apply(this, arguments) || this;
t.ListView = null;
return t;
}
t.prototype.onEnable = function() {
l.default.Instance.Global.bind(c.ShopEvent.SHOP_PRODUCT_LIST, this._onProductList, this);
l.default.Instance.Global.bind(c.IOSEvent.IOS_IAP_SUCCESS, this._onPaymentSuccess, this);
l.default.Instance.Global.bind(c.IOSEvent.IOS_IAP_FAILED, this._onPaymentFailed, this);
l.default.Instance.Global.bind(c.PlatformEvent.PLATFORM_GOOGLE_BILLING, this._onGooglePayFinish, this);
};
t.prototype.onDisable = function() {
l.default.Instance.Global.unbind(c.ShopEvent.SHOP_PRODUCT_LIST, this._onProductList, this);
l.default.Instance.Global.unbind(c.IOSEvent.IOS_IAP_SUCCESS, this._onPaymentSuccess, this);
l.default.Instance.Global.unbind(c.IOSEvent.IOS_IAP_FAILED, this._onPaymentFailed, this);
l.default.Instance.Global.unbind(c.PlatformEvent.PLATFORM_GOOGLE_BILLING, this._onGooglePayFinish, this);
};
t.prototype._onProductList = function(e) {
var t = e.getUserData();
this.ListView.datas = t.concat();
};
t.prototype._onGooglePayFinish = function(e) {
var t = e.getUserData();
t ? "NOTHING" != t ? "FAILED" != t ? "CANCELED" != t && ("DISCONNECTED" != t ? p.ShopProxy.Instance.sendReceipt(t, "") : u.PopHelper.Instance.showTips(d.default.getString("SHOP_TIPS_TIME_OUT"))) : u.PopHelper.Instance.showTips(d.default.getString("SHOP_TIPS_FAILED")) : u.PopHelper.Instance.showTips(d.default.getString("SHOP_TIPS_NO_ITEM")) : u.PopHelper.Instance.showTips(d.default.getString("SHOP_TIPS_FAILED"));
};
t.prototype._onPaymentSuccess = function(e) {
var t = e.getUserData();
p.ShopProxy.Instance.sendReceipt(t.recipt, t.productID);
};
t.prototype._onPaymentFailed = function() {
u.PopHelper.Instance.showTips(d.default.getString("SHOP_TIPS_FAILED"));
};
t.prototype.InitView = function() {
p.ShopProxy.Instance.sendProductList();
};
t.prototype.onCloseBtnClicked = function() {
s.default.Instance.removeMaskLayer(this.node);
};
i([ _(r.default) ], t.prototype, "ListView", void 0);
return i([ f ], t);
}(cc.Component);
o.default = m;
cc._RF.pop();
}, {
"../../../../Game/client/global/enum/game/Event": "Event",
"../../../../Game/client/model/LanguageModel": "LanguageModel",
"../../../../Game/fromework/helper/EventHelper": "EventHelper",
"../../../../Game/fromework/helper/UIHelper": "UIHelper",
"../../../../fromework/component/listView/ListView": "ListView",
"../../../global/PopHelper": "PopHelper",
"../../../model/ShopModel": "ShopModel"
} ],
SignLayer: [ function(e, t, o) {
"use strict";
cc._RF.push(t, "c6e18dMm19BPqLiTVqrtZOh", "SignLayer");
var n, a = this && this.__extends || (n = function(e, t) {
return (n = Object.setPrototypeOf || {
__proto__: []
} instanceof Array && function(e, t) {
e.__proto__ = t;
} || function(e, t) {
for (var o in t) Object.prototype.hasOwnProperty.call(t, o) && (e[o] = t[o]);
})(e, t);
}, function(e, t) {
n(e, t);
function o() {
this.constructor = e;
}
e.prototype = null === t ? Object.create(t) : (o.prototype = t.prototype, new o());
}), i = this && this.__decorate || function(e, t, o, n) {
var a, i = arguments.length, r = i < 3 ? t : null === n ? n = Object.getOwnPropertyDescriptor(t, o) : n;
if ("object" == typeof Reflect && "function" == typeof Reflect.decorate) r = Reflect.decorate(e, t, o, n); else for (var l = e.length - 1; l >= 0; l--) (a = e[l]) && (r = (i < 3 ? a(r) : i > 3 ? a(t, o, r) : a(t, o)) || r);
return i > 3 && r && Object.defineProperty(t, o, r), r;
};
Object.defineProperty(o, "__esModule", {
value: !0
});
o.NoticeType = void 0;
var r, l = e("../../../../Game/fromework/helper/EventHelper"), s = e("../../../../Game/fromework/helper/UIHelper"), c = e("../../../../Game/Script/global/GlobalValue"), u = e("../../../../Game/client/global/enum/game/Event"), d = e("../../../../Game/client/global/enum/game/Game"), p = e("../../../model/SingModel"), h = e("../../../model/WalletModel"), f = e("../../active/ActiveManager"), _ = e("../../Wallet/WalletHelper"), m = e("../../../global/Global"), y = e("../../../model/MonthCardModel"), g = e("../../../../Game/client/global/enum/game/Const"), v = e("../MonthCard/GoldSliverCard"), C = e("../Bonus/WelComeBonus"), b = e("../../../../Game/fromework/mvvm/modelView/ViewModel"), I = e("../../active/ActiveModel"), E = e("../../../model/LobbyModel"), S = e("../../../../platform/Platform"), T = e("../../../../Game/client/model/LanguageModel"), R = e("../../../global/PopHelper"), O = cc._decorator, A = O.ccclass, P = O.property;
(function(e) {
e[e.Welfare = 1] = "Welfare";
e[e.SignIn = 2] = "SignIn";
e[e.Festival = 3] = "Festival";
e[e.FirstCharge = 4] = "FirstCharge";
e[e.DailyCharge = 5] = "DailyCharge";
})(r = o.NoticeType || (o.NoticeType = {}));
var M = function(e) {
a(t, e);
function t() {
var t = null !== e && e.apply(this, arguments) || this;
t.MainPanel = null;
t.btnAddCash = null;
t.btnGotoPlay = null;
t.tipNode = null;
t._type = r.Welfare;
t._activeData = null;
t.isFirstOpen = !1;
return t;
}
t.prototype.onEnable = function() {
l.default.Instance.Global.bind(u.SignEvent.SIGN_GET_USER_SIGNED, this.onGetSignCall, this);
};
t.prototype.onDisable = function() {
l.default.Instance.Global.unbind(u.SignEvent.SIGN_GET_USER_SIGNED, this.onGetSignCall, this);
};
t.prototype.onGetSignCall = function() {
p.default.Instance.signDatas;
this.show(!1);
};
t.prototype.onLoad = function() {
var e = p.default.Instance.signDatas, t = null == e ? void 0 : e.sign_day;
if (t) {
var o = e[t - 1];
this.getCurrentSignDay() && 1 == this.getCurrentSignDay() && 0 == o.status && m.Global.Instance.isCurLoginRegist ? this.node.getChildByName("MainPanel").getChildByName("CloseButton").active = !1 : this.node.getChildByName("MainPanel").getChildByName("CloseButton").active = !0;
p.default.Instance.sendGetUserSigned();
this.initSignUI();
}
};
t.prototype.onDestroy = function() {};
t.prototype.initSignUI = function() {
this.btnAddCash.active = !1;
this.btnGotoPlay.active = !1;
for (var e = this.MainPanel.getChildByName("PanelView").getChildByName("SingInPanel").getChildByName("SmallParent"), t = 0; t < 6; t++) {
var o = e.getChildByName("SignInItem" + t);
o.getChildByName("Reward");
o.getChildByName("Finish").active = !0;
o.getChildByName("antimationNode") && (o.getChildByName("antimationNode").active = !0);
o.getChildByName("iconlock") && (o.getChildByName("iconlock").active = !0);
}
var n = this.MainPanel.getChildByName("PanelView").getChildByName("SingInPanel").getChildByName("SignInItem6");
n.getChildByName("Reward");
n.getChildByName("Finish").active = !0;
n.getChildByName("iconlock").active = !0;
this.tipNode.getComponent(cc.Label).string = "";
};
t.prototype.getCurrentSignDay = function() {
var e = p.default.Instance.signDatas;
return null == e ? void 0 : e.sign_day;
};
t.prototype.show = function(e) {
var t = p.default.Instance.signDatas, o = null == t ? void 0 : t.sign_day;
if (o) {
e && (this.isFirstOpen = !1);
for (var n = this.MainPanel.getChildByName("PanelView").getChildByName("SingInPanel").getChildByName("SmallParent"), a = 0; a < 6; a++) {
var i = t[a], r = n.getChildByName("SignInItem" + a);
r.getChildByName("Reward").getComponent(cc.Label).string = T.default.getString("MoneySymbol") + i.cash;
if (-1 == i.status) {
r.getChildByName("Finish").active = !1;
r.getChildByName("antimationNode") && (r.getChildByName("antimationNode").active = !1);
r.getChildByName("iconlock") && (r.getChildByName("iconlock").active = !1);
} else if (0 == i.status) {
r.getChildByName("Finish").active = !1;
r.getChildByName("antimationNode") && (r.getChildByName("antimationNode").active = !0);
r.getChildByName("iconlock") && (r.getChildByName("iconlock").active = !0);
} else if (1 == i.status) {
r.getChildByName("Finish").active = !0;
r.getChildByName("Finish").getChildByName("FinishIcon").active = !0;
r.getChildByName("Finish").getChildByName("missIcon").active = !1;
r.getChildByName("antimationNode") && (r.getChildByName("antimationNode").active = !1);
r.getChildByName("iconlock") && (r.getChildByName("iconlock").active = !1);
} else if (2 == i.status) {
r.getChildByName("Finish").active = !0;
r.getChildByName("Finish").getChildByName("FinishIcon").active = !1;
r.getChildByName("Finish").getChildByName("missIcon").active = !0;
r.getChildByName("antimationNode") && (r.getChildByName("antimationNode").active = !1);
r.getChildByName("iconlock") && (r.getChildByName("iconlock").active = !1);
}
if (o == a + 1) {
i.pay_today;
var l = i.flow, s = i.condit_flow;
if (0 != i.status) {
this.node.getChildByName("MainPanel").getChildByName("CloseButton").active = !(1 == o && l <= 0);
this.btnGotoPlay.active = !0;
}
if (o >= 2 && o <= 6) {
if (0 == i.status) if (l < s) {
r.getChildByName("antimationNode") && (r.getChildByName("antimationNode").active = !1);
this.btnGotoPlay.active = !0;
this.btnGotoPlay.getChildByName("hand").active = !0;
} else {
r.getChildByName("antimationNode") && (r.getChildByName("antimationNode").active = !0);
this.btnGotoPlay.active = !0;
this.btnGotoPlay.getChildByName("hand").active = !1;
} else if (1 == i.status) {
this.btnGotoPlay.active = !0;
this.btnGotoPlay.getChildByName("hand").active = !1;
}
this.tipNode.getComponent(cc.Label).string = "Total wins and losses ₹" + s + "\n are required to receive cash";
}
7 == o && (this.tipNode.getComponent(cc.Label).string = "Requires" + s + " games to win or lose \n And you have to pay once to receive cash");
}
}
var c = t[6], u = c.pay_today, d = c.flow, h = c.condit_flow, f = this.MainPanel.getChildByName("PanelView").getChildByName("SingInPanel").getChildByName("SignInItem6");
f.getChildByName("Reward").getComponent(cc.Label).string = T.default.getString("MoneySymbol") + c.cash;
f.getChildByName("iconlock") && (f.getChildByName("iconlock").active = !0);
if (-1 == c.status) {
f.getChildByName("Finish").active = !1;
f.getChildByName("antimationNode") && (f.getChildByName("antimationNode").active = !1);
} else if (0 == c.status) {
f.getChildByName("Finish").active = !1;
f.getChildByName("antimationNode") && (f.getChildByName("antimationNode").active = !0);
} else if (1 == c.status) {
f.getChildByName("Finish").active = !0;
f.getChildByName("Finish").getChildByName("FinishIcon").active = !0;
f.getChildByName("Finish").getChildByName("missIcon").active = !1;
f.getChildByName("antimationNode") && (f.getChildByName("antimationNode").active = !1);
} else if (2 == c.status) {
f.getChildByName("Finish").active = !0;
f.getChildByName("Finish").getChildByName("FinishIcon").active = !1;
f.getChildByName("Finish").getChildByName("missIcon").active = !0;
f.getChildByName("antimationNode") && (f.getChildByName("antimationNode").active = !1);
}
if (7 == o) {
f.getChildByName("iconlock") && (f.getChildByName("iconlock").active = !1);
if (u) {
if (d < h) {
this.btnAddCash.active = !1;
this.btnGotoPlay.active = !0;
this.btnGotoPlay.getChildByName("hand").active = !0;
}
} else {
this.btnAddCash.active = !0;
this.btnGotoPlay.active = !1;
}
if (1 == c.status) {
this.btnAddCash.active = !1;
this.btnGotoPlay.active = !1;
this.btnGotoPlay.getChildByName("hand").active = !1;
}
}
}
};
t.prototype.onGetReward = function(e, t) {
var o = this, n = parseInt(t), a = n + 1, i = p.default.Instance.signDatas, r = i[n], l = r.status, s = r.cash, c = null == i ? void 0 : i.sign_day, u = r.pay_today, d = r.flow, f = r.condit_flow;
if (c) {
if (c == a && 0 == l) {
if (7 == c && !u) {
R.PopHelper.Instance.showTips("you have to pay once to receive cash");
this.tipNode.getComponent(cc.Label).string = "you have to pay once to receive cash";
return;
}
if (c >= 2 && c <= 7 && d < f) {
R.PopHelper.Instance.showTips("Total wins and losses ₹" + f + "\n are required to receive cash");
this.tipNode.getComponent(cc.Label).string = "Total wins and losses ₹" + f + "\n are required to receive cash";
return;
}
p.default.Instance.sendUserSigned(function(e) {
if (e) {
o.btnGotoPlay.active = !0;
o.btnAddCash.active = !1;
p.default.Instance.sendGetUserSigned();
h.WalletProxy.Instance.sendGetUserWallet();
1 == c && (o.node.getChildByName("MainPanel").getChildByName("CloseButton").active = !1);
if (7 == c) {
o.btnAddCash.active = !1;
o.btnGotoPlay.active = !1;
o.btnGotoPlay.getChildByName("hand").active = !1;
}
R.PopHelper.Instance.showReward(m.Global.Instance.changeReward({
1: s
}), function() {});
}
});
}
S.default.log("=====data== " + JSON.stringify(n));
}
};
t.prototype.onGoToPlay = function() {
s.default.Instance.removeMaskLayer(this.node, !0);
var e = b.VM.getValue("wallet.totalRecharge") > 0, t = b.VM.getValue("wallet.total"), o = E.default.Instance.getPlayByBenchmark(E.default.Instance.getGamePlayByCls(d.GameEnum.PlayType.TP_3PATTI), t);
if (e) if (o) E.default.Instance.sendJoinRoom(o.rtype); else {
l.default.Instance.Global.emit("openPlayList", d.GameEnum.PlayType.TP_3PATTI);
S.default.log("Can not find room");
} else if (o.base < 1) if (o) E.default.Instance.sendJoinRoom(o.rtype); else {
l.default.Instance.Global.emit("openPlayList", d.GameEnum.PlayType.TP_3PATTI);
S.default.log("Can not find room");
} else {
var n = Math.min(b.VM.getValue("wallet.total"), 10), a = E.default.Instance.getPlayByBenchmark(E.default.Instance.getGamePlayByCls(d.GameEnum.PlayType.TP_3PATTI), n);
if (a && t >= a.max_entry) l.default.Instance.Global.emit("openPlayList", d.GameEnum.PlayType.TP_3PATTI); else if (a) E.default.Instance.sendJoinRoom(a.rtype); else {
S.default.log("Can not find room");
l.default.Instance.Global.emit("openPlayList", d.GameEnum.PlayType.TP_3PATTI);
}
}
};
t.prototype.onAddCash = function() {
s.default.Instance.removeMaskLayer(this.node, !0);
_.default.Instance.openRecharge();
};
t.prototype.onCloseClicked = function() {
s.default.Instance.removeMaskLayer(this.node, !0);
l.default.Instance.Global.emit(u.LobbyEvent.LOBBY_REFRESH_NOTICE_BUTTON);
if (!c.default.getInstance().isPopClose) {
var e = y.MonthCardProxy.Instance.goldSliverData;
if (!e || null == e) return;
var t = e.all_month_card[1], o = e.all_month_card[0];
1 == t.card_status || 1 == o.card_status ? I.ActiveProxy.Instance.alreadyBuy ? l.default.Instance.Global.emit("openLoginAlert") : s.default.Instance.addBundleMaskLayer(g.BundleUIPath.WelComeBonus, function(e) {
e.getComponent(C.default).show(!0);
}) : s.default.Instance.addBundleMaskLayer(g.BundleUIPath.GoldSliverCard, function(e) {
e.getComponent(v.default).show(!0);
});
c.default.getInstance().isPopClose = !0;
f.default.Instance._loginBonusBool = !0;
}
};
t.prototype.playClick = function() {
s.default.Instance.removeMaskLayer(this.node, !0);
f.default.Instance._loginSignBool = !0;
var e = E.default.Instance.getPlayByBenchmark(E.default.Instance.getGamePlayByCls(d.GameEnum.PlayType.TP_3PATTI), b.VM.getValue("wallet.total"));
e ? E.default.Instance.sendJoinRoom(e.rtype) : S.default.log("Can not find room");
};
i([ P(cc.Node) ], t.prototype, "MainPanel", void 0);
i([ P(cc.Node) ], t.prototype, "btnAddCash", void 0);
i([ P(cc.Node) ], t.prototype, "btnGotoPlay", void 0);
i([ P(cc.Label) ], t.prototype, "tipNode", void 0);
return i([ A ], t);
}(cc.Component);
o.default = M;
cc._RF.pop();
}, {
"../../../../Game/Script/global/GlobalValue": "GlobalValue",
"../../../../Game/client/global/enum/game/Const": "Const",
"../../../../Game/client/global/enum/game/Event": "Event",
"../../../../Game/client/global/enum/game/Game": "Game",
"../../../../Game/client/model/LanguageModel": "LanguageModel",
"../../../../Game/fromework/helper/EventHelper": "EventHelper",
"../../../../Game/fromework/helper/UIHelper": "UIHelper",
"../../../../Game/fromework/mvvm/modelView/ViewModel": "ViewModel",
"../../../../platform/Platform": "Platform",
"../../../global/Global": "Global",
"../../../global/PopHelper": "PopHelper",
"../../../model/LobbyModel": "LobbyModel",
"../../../model/MonthCardModel": "MonthCardModel",
"../../../model/SingModel": "SingModel",
"../../../model/WalletModel": "WalletModel",
"../../Wallet/WalletHelper": "WalletHelper",
"../../active/ActiveManager": "ActiveManager",
"../../active/ActiveModel": "ActiveModel",
"../Bonus/WelComeBonus": "WelComeBonus",
"../MonthCard/GoldSliverCard": "GoldSliverCard"
} ],
SigninItem: [ function(e, t, o) {
"use strict";
cc._RF.push(t, "cb443mIF2NEq49c5nHVzQGe", "SigninItem");
var n, a = this && this.__extends || (n = function(e, t) {
return (n = Object.setPrototypeOf || {
__proto__: []
} instanceof Array && function(e, t) {
e.__proto__ = t;
} || function(e, t) {
for (var o in t) Object.prototype.hasOwnProperty.call(t, o) && (e[o] = t[o]);
})(e, t);
}, function(e, t) {
n(e, t);
function o() {
this.constructor = e;
}
e.prototype = null === t ? Object.create(t) : (o.prototype = t.prototype, new o());
}), i = this && this.__decorate || function(e, t, o, n) {
var a, i = arguments.length, r = i < 3 ? t : null === n ? n = Object.getOwnPropertyDescriptor(t, o) : n;
if ("object" == typeof Reflect && "function" == typeof Reflect.decorate) r = Reflect.decorate(e, t, o, n); else for (var l = e.length - 1; l >= 0; l--) (a = e[l]) && (r = (i < 3 ? a(r) : i > 3 ? a(t, o, r) : a(t, o)) || r);
return i > 3 && r && Object.defineProperty(t, o, r), r;
};
Object.defineProperty(o, "__esModule", {
value: !0
});
var r = e("../../../../Game/client/global/enum/game/Game"), l = e("../../../../Game/client/model/LanguageModel"), s = e("../../../model/SingModel"), c = e("../../../model/WalletModel"), u = cc._decorator, d = u.ccclass, p = u.property, h = function(e) {
a(t, e);
function t() {
var t = null !== e && e.apply(this, arguments) || this;
t.Title = null;
t.Light = null;
t.Small = null;
t.Big = null;
t.Item = null;
t.Reward = null;
t.Finish = null;
t._data = null;
t._theIndex = -1;
return t;
}
t.prototype.refresh = function(e, t) {
this._data = e;
this._theIndex = t;
this.Title.string = l.default.getString("SIGNIN_DAY") + (this._theIndex + 1);
this.Light.active = 1 == e.is_signed;
if (1 == e.reward_type) {
this.Small.active = 1 == e.jar_type;
this.Big.active = 2 == e.jar_type;
this.Item.active = !1;
this.Reward.string = l.default.getString("COMMON_RUPEE") + this._data.amount + (this._data.currency == r.GameEnum.MoneyType.BONUS ? l.default.getString("DE_BONUS") : "");
} else {
this.Small.active = !1;
this.Big.active = !1;
this.Item.active = !0;
this.Reward.string = this._data.amount.toString();
}
this.Finish.active = 2 == e.is_signed;
};
t.prototype.signin = function(e, t) {
this.refresh(e, t);
s.default.Instance.sendGetUserSigned();
c.WalletProxy.Instance.sendGetUserWallet();
};
i([ p(cc.Label) ], t.prototype, "Title", void 0);
i([ p(cc.Node) ], t.prototype, "Light", void 0);
i([ p(cc.Node) ], t.prototype, "Small", void 0);
i([ p(cc.Node) ], t.prototype, "Big", void 0);
i([ p(cc.Node) ], t.prototype, "Item", void 0);
i([ p(cc.Label) ], t.prototype, "Reward", void 0);
i([ p(cc.Node) ], t.prototype, "Finish", void 0);
return i([ d ], t);
}(cc.Component);
o.default = h;
cc._RF.pop();
}, {
"../../../../Game/client/global/enum/game/Game": "Game",
"../../../../Game/client/model/LanguageModel": "LanguageModel",
"../../../model/SingModel": "SingModel",
"../../../model/WalletModel": "WalletModel"
} ],
Signin: [ function(e, t, o) {
"use strict";
cc._RF.push(t, "37306xf52pFvITJS/Cn5m/3", "Signin");
var n, a = this && this.__extends || (n = function(e, t) {
return (n = Object.setPrototypeOf || {
__proto__: []
} instanceof Array && function(e, t) {
e.__proto__ = t;
} || function(e, t) {
for (var o in t) Object.prototype.hasOwnProperty.call(t, o) && (e[o] = t[o]);
})(e, t);
}, function(e, t) {
n(e, t);
function o() {
this.constructor = e;
}
e.prototype = null === t ? Object.create(t) : (o.prototype = t.prototype, new o());
}), i = this && this.__decorate || function(e, t, o, n) {
var a, i = arguments.length, r = i < 3 ? t : null === n ? n = Object.getOwnPropertyDescriptor(t, o) : n;
if ("object" == typeof Reflect && "function" == typeof Reflect.decorate) r = Reflect.decorate(e, t, o, n); else for (var l = e.length - 1; l >= 0; l--) (a = e[l]) && (r = (i < 3 ? a(r) : i > 3 ? a(t, o, r) : a(t, o)) || r);
return i > 3 && r && Object.defineProperty(t, o, r), r;
};
Object.defineProperty(o, "__esModule", {
value: !0
});
var r = e("../../../../Game/fromework/helper/EventHelper"), l = e("../../../../Game/client/global/enum/game/Event"), s = e("../../../global/PopHelper"), c = e("../../../model/SingModel"), u = e("./SigninItem"), d = e("../../../../Game/client/global/enum/game/Game"), p = e("../../../global/Global"), h = cc._decorator, f = h.ccclass, _ = h.property, m = function(e) {
a(t, e);
function t() {
var t = null !== e && e.apply(this, arguments) || this;
t.Items = [];
t.SigninBtn = null;
return t;
}
t.prototype.onEnable = function() {
r.default.Instance.Global.bind(l.SignEvent.SIGN_GET_USER_SIGNED, this.onPacketCallFunc, this);
};
t.prototype.onDisable = function() {
r.default.Instance.Global.unbind(l.SignEvent.SIGN_GET_USER_SIGNED, this.onPacketCallFunc, this);
};
t.prototype.onLoad = function() {
if (-1 != c.default.Instance.getSigninDay() && p.Global.Instance.isCurLoginRegist) {
this.node.getChildByName("playBtn").getChildByName("hand").active = !0;
this.node.getChildByName("playBtn").getChildByName("hand").stopAllActions();
this.node.getChildByName("playBtn").getChildByName("hand").runAction(cc.sequence(cc.scaleTo(.5, 1.2), cc.scaleTo(.5, 1), cc.delayTime(.2)).repeatForever());
}
};
t.prototype.onDestroy = function() {};
t.prototype.onPacketCallFunc = function() {
var e = c.default.Instance.signDatas;
this.SigninBtn.active = -1 != c.default.Instance.getSigninDay();
if (-1 != c.default.Instance.getSigninDay() && p.Global.Instance.isCurLoginRegist) {
this.node.getChildByName("hand").active = !0;
this.node.getChildByName("hand").stopAllActions();
this.node.getChildByName("hand").runAction(cc.sequence(cc.scaleTo(.5, 1.2), cc.scaleTo(.5, 1), cc.delayTime(.2)).repeatForever());
} else this.node.getChildByName("hand").active = !1;
for (var t = 0; t < e.length; t++) {
var o = e[t];
if (o) {
var n = this.Items[t];
n && n.refresh(o, t);
}
}
this.node.getChildByName("playBtn").active = -1 == c.default.Instance.getSigninDay();
};
t.prototype.refreshView = function() {
c.default.Instance.sendGetUserSigned();
};
t.prototype.onSigninClicked = function() {
var e = c.default.Instance.getSigninDay();
if (-1 != e) {
var t = c.default.Instance.signDatas[e], o = this.Items[e], n = t.is_signed;
2 == n && s.PopHelper.Instance.showTips("It has been collected!");
0 == n && s.PopHelper.Instance.showTips("It's not time to get it!");
1 == n && c.default.Instance.sendUserSigned(function(n) {
n && o.signin(t, e);
});
}
};
t.prototype.playClick = function() {
r.default.Instance.Global.emit("openPlayList", d.GameEnum.PlayType.TP_3PATTI);
};
i([ _([ u.default ]) ], t.prototype, "Items", void 0);
i([ _(cc.Node) ], t.prototype, "SigninBtn", void 0);
return i([ f ], t);
}(cc.Component);
o.default = m;
cc._RF.pop();
}, {
"../../../../Game/client/global/enum/game/Event": "Event",
"../../../../Game/client/global/enum/game/Game": "Game",
"../../../../Game/fromework/helper/EventHelper": "EventHelper",
"../../../global/Global": "Global",
"../../../global/PopHelper": "PopHelper",
"../../../model/SingModel": "SingModel",
"./SigninItem": "SigninItem"
} ],
SingModel: [ function(e, t, o) {
"use strict";
cc._RF.push(t, "d287cDqV4pFdYhDAW4YI5fb", "SingModel");
Object.defineProperty(o, "__esModule", {
value: !0
});
var n = e("../../Game/Script/global/GlobalValue"), a = e("../../Game/client/global/enum/game/Event"), i = e("../../Game/client/global/enum/game/Game"), r = e("../../Game/fromework/helper/EventHelper"), l = e("../../Game/fromework/mvvm/modelView/ViewModel"), s = e("../../Game/fromework/net/NetHttp"), c = e("../../platform/Platform"), u = e("./WalletModel"), d = function() {
function e() {
this._current_time = 0;
}
Object.defineProperty(e, "Instance", {
get: function() {
e._instance || (e._instance = new e());
return e._instance;
},
enumerable: !1,
configurable: !0
});
e.prototype.Init = function() {};
Object.defineProperty(e.prototype, "current_time", {
get: function() {
return this._current_time;
},
enumerable: !1,
configurable: !0
});
Object.defineProperty(e.prototype, "signDatas", {
get: function() {
return this._signDatas;
},
enumerable: !1,
configurable: !0
});
e.prototype.getSigninDay = function() {
for (var e = -1, t = 0; t < this._signDatas.length; t++) if (1 == this._signDatas[t].is_signed) {
e = t;
break;
}
return e;
};
e.prototype._onGetUserSigned = function(e) {
var t, o = JSON.parse(e.response);
if (1 == o.code) {
var n = null === (t = o.data) || void 0 === t ? void 0 : t.sign_day;
this._signDatas = o.data;
r.default.Instance.Global.emit(a.RedDotEvent.REFRESH_RED_DOT_DATA, {
key: i.GameEnum.RedDotKey.SignIn,
value: n
});
}
r.default.Instance.Global.emit(a.SignEvent.SIGN_GET_USER_SIGNED, o.code);
};
e.prototype._onUserSigned = function(e) {
var t = JSON.parse(e.response);
if (1 == t.code) {
var o = this.getSigninDay() + 1;
c.default.logEvent("Signin_day_" + o);
c.default.sendEvent("Signin_day_" + o);
this.sendGetUserSigned();
u.WalletProxy.Instance.sendGetUserWallet();
}
r.default.Instance.Global.emit(a.SignEvent.SIGN_USER_SIGNED, t.code);
};
e.prototype.sendGetUserSigned = function() {
s.default.Instance.post(n.default.getInstance().WalletUrl + "getUserSigned", {
uid: l.VM.getValue("user.uid"),
token: l.VM.getValue("user.token")
}, this._onGetUserSigned.bind(this), !0);
};
e.prototype.sendUserSigned = function(e) {
s.default.Instance.post(n.default.getInstance().WalletUrl + "userSigned", {
uid: l.VM.getValue("user.uid"),
token: l.VM.getValue("user.token")
}, function(t) {
var o = JSON.parse(t.response);
e && e(1 == o.code);
}, !0);
};
e._instance = null;
return e;
}();
o.default = d;
cc._RF.pop();
}, {
"../../Game/Script/global/GlobalValue": "GlobalValue",
"../../Game/client/global/enum/game/Event": "Event",
"../../Game/client/global/enum/game/Game": "Game",
"../../Game/fromework/helper/EventHelper": "EventHelper",
"../../Game/fromework/mvvm/modelView/ViewModel": "ViewModel",
"../../Game/fromework/net/NetHttp": "NetHttp",
"../../platform/Platform": "Platform",
"./WalletModel": "WalletModel"
} ],
SingleUserModel: [ function(e, t, o) {
"use strict";
cc._RF.push(t, "5b4c4F1CIpCk5ry10AfKHC3", "SingleUserModel");
Object.defineProperty(o, "__esModule", {
value: !0
});
o.singleUserData = o.SingleUserData = o.OtherNames = void 0;
var n = e("../Game/fromework/global/Tools"), a = e("../Game/fromework/mvvm/modelView/ViewModel"), i = e("../platform/Platform");
o.OtherNames = [ "Tasha", "Thora", "Blueberry", "Regal", "Harmony", "Helen", "Jemima", "Roxanne", "Sheila", "Nell", "Wilona", "Emeline", "Tracy", "Primrose", "Kacey", "Lighthearted", "Dominique", "Maiden", "Leah", "Mora", "Luciana", "Ellen", "Thelma", "Melanie", "Ophelia", "Oriel", "Praised", "Great", "Maureen", "Myra" ];
var r = function() {
function e() {
this.name = "Tom";
this.otherName = "Kit";
this.otherName2 = "Kit";
this.otherName3 = "Kit";
this.otherName4 = "Kit";
this.otherName5 = "Kit";
this.playTogetherName1 = "player";
this.playTogetherName2 = "player";
this.playTogetherName3 = "player";
this.playTogetherName4 = "player";
this.playTogetherName5 = "player";
this.playTogetherName6 = "player";
this.playTogetherMoney1 = "0";
this.playTogetherMoney2 = "0";
this.playTogetherMoney3 = "0";
this.playTogetherMoney4 = "0";
this.playTogetherMoney5 = "0";
this.playTogetherMoney6 = "0";
this.money = 50;
var e = n.Tools.TArray.getRandomElementsFromArray(o.OtherNames, 5);
this.name = "Tom";
this.otherName = e[0];
this.otherName2 = e[1];
this.otherName3 = e[2];
this.otherName4 = e[3];
this.otherName5 = e[4];
this.playTogetherName1 = "player";
this.playTogetherName2 = "player";
this.playTogetherName3 = "player";
this.playTogetherName4 = "player";
this.playTogetherName5 = "player";
this.playTogetherName6 = "player";
this.playTogetherMoney1 = "0";
this.playTogetherMoney2 = "0";
this.playTogetherMoney3 = "0";
this.playTogetherMoney4 = "0";
this.playTogetherMoney5 = "0";
this.playTogetherMoney6 = "0";
this.money = i.default.getSingleMinMoney();
}
e.prototype.refresh = function(e) {
i.default.log(e);
a.VM.setValue("SingleUser.name", e.name);
a.VM.setValue("SingleUser.otherName", e.otherName);
a.VM.setValue("SingleUser.otherName2", e.otherName2);
a.VM.setValue("SingleUser.otherName3", e.otherName3);
a.VM.setValue("SingleUser.otherName4", e.otherName4);
a.VM.setValue("SingleUser.otherName5", e.otherName5);
a.VM.setValue("SingleUser.money", parseInt(e.money));
};
return e;
}();
o.SingleUserData = r;
o.singleUserData = new r();
a.VM.add(o.singleUserData, "SingleUser");
var l = function() {
function e() {
this._id = "";
this.showLogin = !0;
this._id = "";
this.showLogin = !0;
}
Object.defineProperty(e, "Instance", {
get: function() {
e._instance || (e._instance = new e());
return e._instance;
},
enumerable: !1,
configurable: !0
});
e.prototype.init = function(e, t) {
this._id = e;
var n = cc.sys.localStorage.getItem(e), a = null != n ? JSON.parse(n) : null;
if (null === a) {
a = new r();
t && (a.name = t);
cc.sys.localStorage.setItem(e, JSON.stringify(a));
this.setName(t);
} else o.singleUserData.refresh(a);
};
e.prototype.setOtherName = function() {
var e = o.OtherNames.length, t = n.Tools.TNumber.randomMinMax(0, e - 1), i = o.OtherNames[t];
a.VM.setValue("SingleUser.otherName", i);
a.VM.setValue("SingleUser.otherName2", o.OtherNames[(e - 1) % (t + 1)]);
a.VM.setValue("SingleUser.otherName3", o.OtherNames[(e - 1) % (t + 2)]);
a.VM.setValue("SingleUser.otherName4", o.OtherNames[(e - 1) % (t + 3)]);
a.VM.setValue("SingleUser.otherName5", o.OtherNames[(e - 1) % (t + 4)]);
};
e.prototype.getGuestID = function() {
var e = cc.sys.localStorage.getItem("GuestID");
if (null == e || null == e || "" == e) {
e = "Guest_" + n.Tools.GenerateID(6);
cc.sys.localStorage.setItem("GuestID", e);
}
return e;
};
e.prototype.saveValue = function() {
var e = a.VM.get("SingleUser").$data;
cc.sys.localStorage.setItem(this._id, JSON.stringify(e));
};
e.prototype.addMoney = function(e) {
var t = Number(a.VM.getValue("SingleUser.money")) + e;
a.VM.setValue("SingleUser.money", t.toString());
this.saveValue();
this.gameWinNum(e);
};
e.prototype.subMoney = function(e) {
var t = Number(a.VM.getValue("SingleUser.money")) - e;
a.VM.setValue("SingleUser.money", t.toString());
this.saveValue();
this.gameWinNum(e);
};
e.prototype.gameWinNum = function(e) {
if ("First" != cc.director.getScene().name) {
var t = cc.sys.localStorage.getItem("gameWinNum");
null != t && null != t && "" != t ? cc.sys.localStorage.setItem("gameWinNum", String(Number(t) + e)) : cc.sys.localStorage.setItem("gameWinNum", String(e));
}
};
e.prototype.setName = function(e) {
a.VM.setValue("SingleUser.name", e);
this.saveValue();
};
e._instance = null;
return e;
}();
o.default = l;
cc._RF.pop();
}, {
"../Game/fromework/global/Tools": "Tools",
"../Game/fromework/mvvm/modelView/ViewModel": "ViewModel",
"../platform/Platform": "Platform"
} ],
SlotConst: [ function(e, t, o) {
"use strict";
cc._RF.push(t, "c0501RRQMNHHLVsCsHkZDmY", "SlotConst");
Object.defineProperty(o, "__esModule", {
value: !0
});
o.SlotUIEvent = o.SlotNetEvent = o.LinePosition = o.LineNumberPos = o.TrackCount = o.SlotCount = o.SlotHeight = o.SlotWidth = void 0;
o.SlotWidth = 209;
o.SlotHeight = 176;
o.SlotCount = 3;
o.TrackCount = 5;
o.LineNumberPos = [ cc.v3(-555, -8, 0), cc.v3(-555, 168, 0), cc.v3(-555, -184, 0), cc.v3(-555, 168, 0), cc.v3(-555, -184, 0), cc.v3(-555, -8, 0), cc.v3(-555, -8, 0), cc.v3(-555, 168, 0), cc.v3(-555, -184, 0), cc.v3(-555, -8, 0), cc.v3(-555, -8, 0), cc.v3(-555, -184, 0), cc.v3(-555, 168, 0), cc.v3(555, 168, 0), cc.v3(555, -184, 0), cc.v3(555, -8, 0), cc.v3(555, -8, 0), cc.v3(555, -184, 0), cc.v3(555, 168, 0), cc.v3(555, 168, 0), cc.v3(555, -184, 0), cc.v3(555, 168, 0), cc.v3(555, -184, 0), cc.v3(555, -8, 0), cc.v3(555, -8, 0) ];
o.LinePosition = {
1: [ {
x: 0,
y: 1
}, {
x: 1,
y: 1
}, {
x: 2,
y: 1
}, {
x: 3,
y: 1
}, {
x: 4,
y: 1
} ],
2: [ {
x: 0,
y: 2
}, {
x: 1,
y: 2
}, {
x: 2,
y: 2
}, {
x: 3,
y: 2
}, {
x: 4,
y: 2
} ],
3: [ {
x: 0,
y: 0
}, {
x: 1,
y: 0
}, {
x: 2,
y: 0
}, {
x: 3,
y: 0
}, {
x: 4,
y: 0
} ],
4: [ {
x: 0,
y: 2
}, {
x: 1,
y: 1
}, {
x: 2,
y: 0
}, {
x: 3,
y: 1
}, {
x: 4,
y: 2
} ],
5: [ {
x: 0,
y: 0
}, {
x: 1,
y: 1
}, {
x: 2,
y: 2
}, {
x: 3,
y: 1
}, {
x: 4,
y: 0
} ],
6: [ {
x: 0,
y: 1
}, {
x: 1,
y: 2
}, {
x: 2,
y: 2
}, {
x: 3,
y: 2
}, {
x: 4,
y: 1
} ],
7: [ {
x: 0,
y: 1
}, {
x: 1,
y: 0
}, {
x: 2,
y: 0
}, {
x: 3,
y: 0
}, {
x: 4,
y: 1
} ],
8: [ {
x: 0,
y: 2
}, {
x: 1,
y: 2
}, {
x: 2,
y: 1
}, {
x: 3,
y: 0
}, {
x: 4,
y: 0
} ],
9: [ {
x: 0,
y: 0
}, {
x: 1,
y: 0
}, {
x: 2,
y: 1
}, {
x: 3,
y: 2
}, {
x: 4,
y: 2
} ],
10: [ {
x: 0,
y: 1
}, {
x: 1,
y: 0
}, {
x: 2,
y: 1
}, {
x: 3,
y: 2
}, {
x: 4,
y: 1
} ],
11: [ {
x: 0,
y: 1
}, {
x: 1,
y: 2
}, {
x: 2,
y: 1
}, {
x: 3,
y: 0
}, {
x: 4,
y: 1
} ],
12: [ {
x: 0,
y: 0
}, {
x: 1,
y: 1
}, {
x: 2,
y: 1
}, {
x: 3,
y: 1
}, {
x: 4,
y: 0
} ],
13: [ {
x: 0,
y: 2
}, {
x: 1,
y: 1
}, {
x: 2,
y: 1
}, {
x: 3,
y: 1
}, {
x: 4,
y: 2
} ],
14: [ {
x: 0,
y: 2
}, {
x: 1,
y: 1
}, {
x: 2,
y: 2
}, {
x: 3,
y: 1
}, {
x: 4,
y: 2
} ],
15: [ {
x: 0,
y: 0
}, {
x: 1,
y: 1
}, {
x: 2,
y: 0
}, {
x: 3,
y: 1
}, {
x: 4,
y: 0
} ],
16: [ {
x: 0,
y: 1
}, {
x: 1,
y: 1
}, {
x: 2,
y: 2
}, {
x: 3,
y: 1
}, {
x: 4,
y: 1
} ],
17: [ {
x: 0,
y: 1
}, {
x: 1,
y: 1
}, {
x: 2,
y: 0
}, {
x: 3,
y: 1
}, {
x: 4,
y: 1
} ],
18: [ {
x: 0,
y: 0
}, {
x: 1,
y: 0
}, {
x: 2,
y: 2
}, {
x: 3,
y: 0
}, {
x: 4,
y: 0
} ],
19: [ {
x: 0,
y: 2
}, {
x: 1,
y: 2
}, {
x: 2,
y: 0
}, {
x: 3,
y: 2
}, {
x: 4,
y: 2
} ],
20: [ {
x: 0,
y: 2
}, {
x: 1,
y: 0
}, {
x: 2,
y: 0
}, {
x: 3,
y: 0
}, {
x: 4,
y: 2
} ],
21: [ {
x: 0,
y: 0
}, {
x: 1,
y: 2
}, {
x: 2,
y: 2
}, {
x: 3,
y: 2
}, {
x: 4,
y: 0
} ],
22: [ {
x: 0,
y: 2
}, {
x: 1,
y: 0
}, {
x: 2,
y: 2
}, {
x: 3,
y: 0
}, {
x: 4,
y: 2
} ],
23: [ {
x: 0,
y: 0
}, {
x: 1,
y: 2
}, {
x: 2,
y: 0
}, {
x: 3,
y: 2
}, {
x: 4,
y: 0
} ],
24: [ {
x: 0,
y: 1
}, {
x: 1,
y: 2
}, {
x: 2,
y: 0
}, {
x: 3,
y: 2
}, {
x: 4,
y: 1
} ],
25: [ {
x: 0,
y: 1
}, {
x: 1,
y: 0
}, {
x: 2,
y: 2
}, {
x: 3,
y: 0
}, {
x: 4,
y: 1
} ]
};
o.SlotNetEvent = {
S2C_ENTER_ROOM: "S2C_ENTER_ROOM",
S2C_SPIN: "S2C_SPIN",
S2C_CLEAN: "S2C_CLEAN",
S2C_EXCHANGE: "S2C_EXCHANGE",
S2C_LEAVE: "S2C_LEAVE",
S2C_LEAVE_SINGLE: "S2C_LEAVE_SINGLE",
S2C_DISMISS_ROOM: "S2C_DISMISS_ROOM"
};
o.SlotUIEvent = {
SLOT_UI_SPIN_PLAY: "SLOT_UI_SPIN_PLAY",
SLOT_UI_HIDE_AUTO: "SLOT_UI_HIDE_AUTO",
SLOT_UI_STOP_AUTO: "SLOT_UI_STOP_AUTO",
SLOT_UI_TAB_ADD: "SLOT_UI_TAB_ADD",
SLOT_UI_TAB_CLEAN: "SLOT_UI_TAB_CLEAN",
SLOT_UI_TAB_CHANGE: "SLOT_UI_TAB_CHANGE",
SLOT_UI_PROGRESS_REFRESH: "SLOT_UI_PROGRESS_REFRESH",
SLOT_UI_PROGRESS_MULTIPLE_EFFECT: "SLOT_UI_PROGRESS_MULTIPLE_EFFECT",
SLOT_UI_PROGRESS_CLEAN: "SLOT_UI_PROGRESS_CLEAN",
SLOT_UI_PROGRESS_MULTIPLE_STRING: "SLOT_UI_PROGRESS_MULTIPLE_STRING",
SLOT_UI_SPIN_REFRESH_BUTTON: "SLOT_UI_SPIN_REFRESH_BUTTON",
SLOT_UI_SPIN_REFRESH_LABEL: "SLOT_UI_SPIN_REFRESH_LABEL"
};
cc._RF.pop();
}, {} ],
SlotHelp: [ function(e, t, o) {
"use strict";
cc._RF.push(t, "bc855FWBM5Db6xADW8eI9Vm", "SlotHelp");
var n, a = this && this.__extends || (n = function(e, t) {
return (n = Object.setPrototypeOf || {
__proto__: []
} instanceof Array && function(e, t) {
e.__proto__ = t;
} || function(e, t) {
for (var o in t) Object.prototype.hasOwnProperty.call(t, o) && (e[o] = t[o]);
})(e, t);
}, function(e, t) {
n(e, t);
function o() {
this.constructor = e;
}
e.prototype = null === t ? Object.create(t) : (o.prototype = t.prototype, new o());
}), i = this && this.__decorate || function(e, t, o, n) {
var a, i = arguments.length, r = i < 3 ? t : null === n ? n = Object.getOwnPropertyDescriptor(t, o) : n;
if ("object" == typeof Reflect && "function" == typeof Reflect.decorate) r = Reflect.decorate(e, t, o, n); else for (var l = e.length - 1; l >= 0; l--) (a = e[l]) && (r = (i < 3 ? a(r) : i > 3 ? a(t, o, r) : a(t, o)) || r);
return i > 3 && r && Object.defineProperty(t, o, r), r;
};
Object.defineProperty(o, "__esModule", {
value: !0
});
var r = e("../../Game/fromework/global/ResLoader"), l = e("../../Game/fromework/helper/UIHelper"), s = e("../Common/SlotModel"), c = e("../Common/SlotProxy"), u = cc._decorator, d = u.ccclass, p = u.property, h = function(e) {
a(t, e);
function t() {
var t = null !== e && e.apply(this, arguments) || this;
t.PageView = null;
t.NormalItems = [];
t.WildItems = [];
t.ScatterItems = [];
t.PageCount = 0;
t._pageIndex = 0;
return t;
}
t.prototype.showView = function() {
0 != this.WildItems.length && this.refreshWild();
0 != this.ScatterItems.length && this.refreshScatter();
0 != this.NormalItems.length && this.refreshNormal();
};
t.prototype.refreshWild = function() {
for (var e = s.default.Instance.getSlotConfigByType(1), t = function(t) {
var n = o.WildItems[t], a = e[t];
if (!n || !a) return "continue";
var i = cc.find("Icon", n).getComponent(cc.Sprite), l = "Slot_" + c.default.Instance.cls + "/Image/Icon/slot_icon_" + c.default.Instance.cls + "_" + a.id;
r.default.Instance.loadBundleRes("" + l, cc.SpriteFrame, function(e, t) {
e ? console.log("Slot " + a.id + " help load icon image " + l + " failed") : null != i && i.isValid && (i.spriteFrame = t);
});
}, o = this, n = 0; n < this.WildItems.length; n++) t(n);
};
t.prototype.refreshScatter = function() {
for (var e = s.default.Instance.getSlotConfigByType(2), t = function(t) {
var n = o.ScatterItems[t], a = e[t];
if (!n || !a) return "continue";
var i = cc.find("Icon", n).getComponent(cc.Sprite), l = "Slot_" + c.default.Instance.cls + "/Image/Icon/slot_icon_" + c.default.Instance.cls + "_" + a.id;
r.default.Instance.loadBundleRes("" + l, cc.SpriteFrame, function(e, t) {
e ? console.log("Slot " + a.id + " help load icon image " + l + " failed") : null != i && i.isValid && (i.spriteFrame = t);
});
for (var s = 0; s < 3; s++) {
cc.find("OddsNormal/OddsItem" + s + "/Count", n).getComponent(cc.Label).string = "X" + a.odds[s].n.toString();
cc.find("OddsNormal/OddsItem" + s + "/Odds", n).getComponent(cc.Label).string = a.odds[s].o.toString();
}
}, o = this, n = 0; n < this.ScatterItems.length; n++) t(n);
};
t.prototype.refreshNormal = function() {
for (var e = s.default.Instance.getSlotConfigByType(0), t = function(t) {
var n = o.NormalItems[t], a = e[t];
if (!n || !a) return "continue";
var i = cc.find("Icon", n).getComponent(cc.Sprite), l = "Slot_" + c.default.Instance.cls + "/Image/Icon/slot_icon_" + c.default.Instance.cls + "_" + a.id;
r.default.Instance.loadBundleRes("" + l, cc.SpriteFrame, function(e, t) {
e ? console.log("Slot " + a.id + " help load icon image " + l + " failed") : null != i && i.isValid && (i.spriteFrame = t);
});
for (var s = cc.find("OddsNormal", n), u = 0; u < s.children.length; u++) {
s.children[u].getChildByName("Count").getComponent(cc.Label).string = "X" + a.odds[u].n.toString();
s.children[u].getChildByName("Odds").getComponent(cc.Label).string = a.odds[u].o.toString();
}
}, o = this, n = 0; n < this.NormalItems.length; n++) t(n);
};
t.prototype.onLeftClicked = function() {
this._pageIndex = this.PageView.getCurrentPageIndex();
if (this._pageIndex > 0) {
this._pageIndex--;
this.PageView.scrollToPage(this._pageIndex, .2);
}
};
t.prototype.onRightClicked = function() {
this._pageIndex = this.PageView.getCurrentPageIndex();
if (this._pageIndex < this.PageCount) {
this._pageIndex++;
this.PageView.scrollToPage(this._pageIndex, .2);
}
};
t.prototype.onCloseClicked = function() {
l.default.Instance.removeMaskLayer(this.node, !0);
};
i([ p(cc.PageView) ], t.prototype, "PageView", void 0);
i([ p([ cc.Node ]) ], t.prototype, "NormalItems", void 0);
i([ p([ cc.Node ]) ], t.prototype, "WildItems", void 0);
i([ p([ cc.Node ]) ], t.prototype, "ScatterItems", void 0);
i([ p(cc.Integer) ], t.prototype, "PageCount", void 0);
return i([ d ], t);
}(cc.Component);
o.default = h;
cc._RF.pop();
}, {
"../../Game/fromework/global/ResLoader": "ResLoader",
"../../Game/fromework/helper/UIHelper": "UIHelper",
"../Common/SlotModel": "SlotModel",
"../Common/SlotProxy": "SlotProxy"
} ],
SlotInfo: [ function(e, t, o) {
"use strict";
cc._RF.push(t, "42ed3Ze0WFOwZIdZeqveQZh", "SlotInfo");
var n, a = this && this.__extends || (n = function(e, t) {
return (n = Object.setPrototypeOf || {
__proto__: []
} instanceof Array && function(e, t) {
e.__proto__ = t;
} || function(e, t) {
for (var o in t) Object.prototype.hasOwnProperty.call(t, o) && (e[o] = t[o]);
})(e, t);
}, function(e, t) {
n(e, t);
function o() {
this.constructor = e;
}
e.prototype = null === t ? Object.create(t) : (o.prototype = t.prototype, new o());
}), i = this && this.__decorate || function(e, t, o, n) {
var a, i = arguments.length, r = i < 3 ? t : null === n ? n = Object.getOwnPropertyDescriptor(t, o) : n;
if ("object" == typeof Reflect && "function" == typeof Reflect.decorate) r = Reflect.decorate(e, t, o, n); else for (var l = e.length - 1; l >= 0; l--) (a = e[l]) && (r = (i < 3 ? a(r) : i > 3 ? a(t, o, r) : a(t, o)) || r);
return i > 3 && r && Object.defineProperty(t, o, r), r;
};
Object.defineProperty(o, "__esModule", {
value: !0
});
var r = e("../../Game/fromework/global/ResLoader"), l = e("../../Game/fromework/helper/UIHelper"), s = e("../Common/SlotModel"), c = e("../Common/SlotProxy"), u = cc._decorator, d = u.ccclass, p = u.property, h = function(e) {
a(t, e);
function t() {
var t = null !== e && e.apply(this, arguments) || this;
t.Effect = null;
t.OddsNormal = null;
t.ScatterTips = null;
t.OddsWild = null;
t.OddsCount = [];
t.OddsArray = [];
t._cid = 0;
return t;
}
t.prototype.showView = function(e) {
var t, o, n = this;
this._cid = e;
var a = "Slot_" + c.default.Instance.cls + "/Skeleton/slot_item_" + c.default.Instance.cls + "_" + this._cid;
r.default.Instance.loadBundleRes(a, sp.SkeletonData, function(e, t) {
if (e) console.log("Slot " + n._cid + " load icon image " + a + " failed"); else if (n.Effect && n.Effect.node && n.Effect.node.isValid && t && t.isValid) {
n.Effect.skeletonData = t;
var o = "animation";
if (201 == c.default.Instance.cls) {
o = "dong";
n.Effect.premultipliedAlpha = !1;
}
n.Effect.setAnimation(0, o, !0);
}
});
var i = s.default.Instance.getSlotConfigByID(this._cid);
if (null != i) {
this.OddsNormal.active = 0 == i.type || 2 == i.type;
this.OddsWild.active = 1 == i.type;
null != this.ScatterTips && (this.ScatterTips.active = 2 == i.type);
for (var l = 0; l < this.OddsCount.length; l++) {
this.OddsCount[l].string = "X" + (null === (t = i.odds[l]) || void 0 === t ? void 0 : t.n);
this.OddsArray[l].string = null === (o = i.odds[l]) || void 0 === o ? void 0 : o.o.toString();
}
}
};
t.prototype.onCloseClicked = function() {
l.default.Instance.removeMaskLayer(this.node, !0);
};
i([ p(sp.Skeleton) ], t.prototype, "Effect", void 0);
i([ p(cc.Node) ], t.prototype, "OddsNormal", void 0);
i([ p(cc.Node) ], t.prototype, "ScatterTips", void 0);
i([ p(cc.Node) ], t.prototype, "OddsWild", void 0);
i([ p([ cc.Label ]) ], t.prototype, "OddsCount", void 0);
i([ p([ cc.Label ]) ], t.prototype, "OddsArray", void 0);
return i([ d ], t);
}(cc.Component);
o.default = h;
cc._RF.pop();
}, {
"../../Game/fromework/global/ResLoader": "ResLoader",
"../../Game/fromework/helper/UIHelper": "UIHelper",
"../Common/SlotModel": "SlotModel",
"../Common/SlotProxy": "SlotProxy"
} ],
SlotItemAlert: [ function(e, t, o) {
"use strict";
cc._RF.push(t, "72bb1KZPNtGYImP5+8w2+86", "SlotItemAlert");
var n, a = this && this.__extends || (n = function(e, t) {
return (n = Object.setPrototypeOf || {
__proto__: []
} instanceof Array && function(e, t) {
e.__proto__ = t;
} || function(e, t) {
for (var o in t) Object.prototype.hasOwnProperty.call(t, o) && (e[o] = t[o]);
})(e, t);
}, function(e, t) {
n(e, t);
function o() {
this.constructor = e;
}
e.prototype = null === t ? Object.create(t) : (o.prototype = t.prototype, new o());
}), i = this && this.__decorate || function(e, t, o, n) {
var a, i = arguments.length, r = i < 3 ? t : null === n ? n = Object.getOwnPropertyDescriptor(t, o) : n;
if ("object" == typeof Reflect && "function" == typeof Reflect.decorate) r = Reflect.decorate(e, t, o, n); else for (var l = e.length - 1; l >= 0; l--) (a = e[l]) && (r = (i < 3 ? a(r) : i > 3 ? a(t, o, r) : a(t, o)) || r);
return i > 3 && r && Object.defineProperty(t, o, r), r;
};
Object.defineProperty(o, "__esModule", {
value: !0
});
var r = e("../../Game/client/global/enum/game/Event"), l = e("../../Game/fromework/helper/ConfigHelper"), s = e("../../Game/fromework/helper/EventHelper"), c = e("../../client/model/LobbyModel"), u = cc._decorator, d = u.ccclass, p = u.property, h = function(e) {
a(t, e);
function t() {
var t = null !== e && e.apply(this, arguments) || this;
t.MainPanel = null;
t.PanelImage = null;
t.ButtonImage = null;
t._play = null;
return t;
}
t.prototype.onLoad = function() {};
t.prototype.onDestroy = function() {};
t.prototype.show = function(e) {
var t = l.ConfigHelper.Instance.getLine("item", e.toString());
if (t) {
this._play = c.default.Instance.getGamePlayByCls(parseInt(t.cls))[0];
this._play || this.close();
} else this.close();
};
t.prototype.close = function() {
this.node.removeFromParent(!0);
this.node.destroy();
};
t.prototype.onPlayClicked = function() {
s.default.Instance.Global.emit(r.GameUIEvent.LOBBY_CASH_JOIN, this._play.rtype);
};
i([ p(cc.Node) ], t.prototype, "MainPanel", void 0);
i([ p(cc.Sprite) ], t.prototype, "PanelImage", void 0);
i([ p(cc.Sprite) ], t.prototype, "ButtonImage", void 0);
return i([ d ], t);
}(cc.Component);
o.default = h;
cc._RF.pop();
}, {
"../../Game/client/global/enum/game/Event": "Event",
"../../Game/fromework/helper/ConfigHelper": "ConfigHelper",
"../../Game/fromework/helper/EventHelper": "EventHelper",
"../../client/model/LobbyModel": "LobbyModel"
} ],
SlotModel: [ function(e, t, o) {
"use strict";
cc._RF.push(t, "2c2d9X/f8tBp7XBSshfd8Et", "SlotModel");
Object.defineProperty(o, "__esModule", {
value: !0
});
var n = e("../../Game/fromework/global/Tools"), a = e("../../Game/fromework/helper/ConfigHelper"), i = e("../../Game/fromework/mvvm/modelView/ViewModel"), r = e("../../Composite/Common/Utils/CompositeConst"), l = e("../../client/model/ItemModel"), s = e("./SlotStruct"), c = function() {
function e() {
this.isPlaySpin = !1;
this.betIndex = 0;
this.isFast = !1;
this.isAuto = !1;
this.autoCount = 0;
this.roomData = new s.SlotStruct.RoomData();
this.userData = new s.SlotStruct.UserData();
this.slotConfig = [];
this.normalSlotConfig = [];
}
Object.defineProperty(e, "Instance", {
get: function() {
if (!e._instance) {
e._instance = new e();
e._instance.init();
}
return e._instance;
},
enumerable: !1,
configurable: !0
});
e.clear = function() {
null != e._instance && (e._instance = null);
};
e.prototype.init = function() {
this.isFast = JSON.parse(cc.sys.localStorage.getItem("SlotFastSwitch" + i.VM.getValue("user.uid")));
null == this.isFast && (this.isFast = !1);
};
Object.defineProperty(e.prototype, "bet_fee", {
get: function() {
return this.roomData.bet_fee_currency[this.betIndex];
},
enumerable: !1,
configurable: !0
});
e.prototype.getSlotConfigByID = function(e) {
for (var t = 0; t < this.slotConfig.length; t++) {
var o = this.slotConfig[t];
if (o && o.id == e) return o;
}
return null;
};
e.prototype.getSlotConfigByType = function(e) {
for (var t = [], o = 0; o < this.slotConfig.length; o++) {
var n = this.slotConfig[o];
n && n.type == e && t.push(n);
}
return t;
};
e.prototype.getResultPosByType = function(e) {
for (var t = [], o = 0; o < this.roomData.show_card.cards.length; o++) for (var n = this.roomData.show_card.cards[o], a = 0; a < n.length; a++) n[a] == e && t.push({
x: o,
y: a
});
return t;
};
e.prototype.getRandomSlotID = function() {
var e = n.Tools.TNumber.randomNumber(0, this.normalSlotConfig.length - 1);
return this.normalSlotConfig[e].id;
};
e.prototype.checkRecharge = function() {
var e = i.VM.getValue("wallet.totalRecharge");
return this.getNowGearItemCount() > 0 || e >= r.COMPOSITE_MIN_RECHARGE;
};
e.prototype.getNowGearItemCount = function() {
if (null == this.roomData.item || 0 == this.roomData.item.length) return 0;
var e = a.ConfigHelper.Instance.getLine("item", this.roomData.item[0].toString());
return e && e.param == this.roomData.bet_fee_currency[this.betIndex] ? l.ItemProxy.Instance.getItemCount(parseInt(e.id)) : 0;
};
e.prototype.checkDeductAutoCount = function() {
return !(null != this.userData.free && this.userData.free > 0 || this.getNowGearItemCount() > 0);
};
e.prototype.changeTabData = function() {
var e;
if (null != this.userData.wild_step_info && null != this.userData.wild_step_info.highlight && this.userData.wild_step_info.highlight.length > 0) for (var t = (null === (e = this.getSlotConfigByType(1)[1]) || void 0 === e ? void 0 : e.id) || 12, o = 0; o < this.userData.wild_step_info.highlight.length; o++) {
var n = this.userData.wild_step_info.highlight[o];
this.roomData.show_card.cards[n.x][n.y] = t;
}
};
e.prototype.getIDByPos = function(e) {
return this.roomData.show_card.cards[e.x][e.y] || 0;
};
e._instance = null;
return e;
}();
o.default = c;
cc._RF.pop();
}, {
"../../Composite/Common/Utils/CompositeConst": "CompositeConst",
"../../Game/fromework/global/Tools": "Tools",
"../../Game/fromework/helper/ConfigHelper": "ConfigHelper",
"../../Game/fromework/mvvm/modelView/ViewModel": "ViewModel",
"../../client/model/ItemModel": "ItemModel",
"./SlotStruct": "SlotStruct"
} ],
SlotProgress: [ function(e, t, o) {
"use strict";
cc._RF.push(t, "562f7x7SrVIF5SIntK2I5CR", "SlotProgress");
var n, a = this && this.__extends || (n = function(e, t) {
return (n = Object.setPrototypeOf || {
__proto__: []
} instanceof Array && function(e, t) {
e.__proto__ = t;
} || function(e, t) {
for (var o in t) Object.prototype.hasOwnProperty.call(t, o) && (e[o] = t[o]);
})(e, t);
}, function(e, t) {
n(e, t);
function o() {
this.constructor = e;
}
e.prototype = null === t ? Object.create(t) : (o.prototype = t.prototype, new o());
}), i = this && this.__decorate || function(e, t, o, n) {
var a, i = arguments.length, r = i < 3 ? t : null === n ? n = Object.getOwnPropertyDescriptor(t, o) : n;
if ("object" == typeof Reflect && "function" == typeof Reflect.decorate) r = Reflect.decorate(e, t, o, n); else for (var l = e.length - 1; l >= 0; l--) (a = e[l]) && (r = (i < 3 ? a(r) : i > 3 ? a(t, o, r) : a(t, o)) || r);
return i > 3 && r && Object.defineProperty(t, o, r), r;
};
Object.defineProperty(o, "__esModule", {
value: !0
});
var r = e("../../Game/fromework/helper/EventHelper"), l = e("../Common/SlotConst"), s = e("../Common/SlotModel"), c = e("../Common/SlotProxy"), u = cc._decorator, d = u.ccclass, p = u.property, h = function(e) {
a(t, e);
function t() {
var t = null !== e && e.apply(this, arguments) || this;
t.ProgressBG = null;
t.ProgressPoint = null;
t.ProgressFrames = [];
t.Particle = null;
t.Rate = null;
return t;
}
t.prototype.onLoad = function() {
r.default.Instance.Global.bind(l.SlotNetEvent.S2C_ENTER_ROOM, this._onEnterRoom, this);
r.default.Instance.Global.bind(l.SlotNetEvent.S2C_CLEAN, this._onProgressClean, this);
r.default.Instance.Global.bind(l.SlotUIEvent.SLOT_UI_PROGRESS_REFRESH, this._onProgressRefresh, this);
r.default.Instance.Global.bind(l.SlotUIEvent.SLOT_UI_PROGRESS_MULTIPLE_EFFECT, this._onMultipleEffect, this);
r.default.Instance.Global.bind(l.SlotUIEvent.SLOT_UI_PROGRESS_MULTIPLE_STRING, this._onMultipleString, this);
r.default.Instance.Global.bind(l.SlotUIEvent.SLOT_UI_PROGRESS_CLEAN, this._onProgressClean, this);
};
t.prototype.onDestroy = function() {
r.default.Instance.Global.unbind(l.SlotNetEvent.S2C_ENTER_ROOM, this._onEnterRoom, this);
r.default.Instance.Global.unbind(l.SlotNetEvent.S2C_CLEAN, this._onProgressClean, this);
r.default.Instance.Global.unbind(l.SlotUIEvent.SLOT_UI_PROGRESS_REFRESH, this._onProgressRefresh, this);
r.default.Instance.Global.unbind(l.SlotUIEvent.SLOT_UI_PROGRESS_MULTIPLE_EFFECT, this._onMultipleEffect, this);
r.default.Instance.Global.unbind(l.SlotUIEvent.SLOT_UI_PROGRESS_MULTIPLE_STRING, this._onMultipleString, this);
r.default.Instance.Global.unbind(l.SlotUIEvent.SLOT_UI_PROGRESS_CLEAN, this._onProgressClean, this);
};
t.prototype._onEnterRoom = function() {
var e = s.default.Instance, t = e.userData.wild_step_info.now_top_step_num;
0 != t && t == e.userData.wild_step_info.all_top_step_num && c.default.Instance.sendClean(e.bet_fee);
this.ProgressBG.destroyAllChildren();
for (var o = 1; o <= e.userData.wild_step_info.all_top_step_num; o++) {
var n = cc.instantiate(this.ProgressPoint);
n.active = !0;
n.parent = this.ProgressBG;
n.getComponent(cc.Sprite).spriteFrame = this.ProgressFrames[o <= t ? 1 : 0];
n.getChildByName("Effect").active = o <= t;
}
this._refreshProgressEffect();
this.Rate.string = e.userData.wild_step_info.now_top_multiple.toString();
};
t.prototype._onProgressRefresh = function() {
for (var e = s.default.Instance, t = e.userData.wild_step_info.now_top_step_num, o = 1; o <= e.userData.wild_step_info.all_top_step_num; o++) {
var n = this.ProgressBG.children[o - 1];
n.getComponent(cc.Sprite).spriteFrame = this.ProgressFrames[o <= t ? 1 : 0];
var a = n.getChildByName("Effect").getComponent(sp.Skeleton);
a.node.active = o <= t;
a.setAnimation(0, "animation", !0);
}
this._refreshProgressEffect();
};
t.prototype._refreshProgressEffect = function() {};
t.prototype._onMultipleEffect = function(e) {
var t = this, o = (s.default.Instance, e.getUserData()), n = this.Rate.node.parent.convertToWorldSpaceAR(this.Rate.node.position), a = o.parent.convertToNodeSpaceAR(n);
cc.tween(o).to(1, {
position: a
}).call(function() {
if (t && t.node && t.node.isValid) {
t._onMultipleString();
o.removeFromParent(!0);
o.destroy();
}
}).start();
};
t.prototype._onMultipleString = function() {
var e = s.default.Instance;
this.Rate.string = e.userData.wild_step_info.now_top_multiple.toString();
};
t.prototype._onProgressClean = function() {
for (var e = s.default.Instance, t = 1; t <= e.userData.wild_step_info.all_top_step_num; t++) {
var o = this.ProgressBG.children[t - 1];
o.getComponent(cc.Sprite).spriteFrame = this.ProgressFrames[0];
o.getChildByName("Effect").active = !1;
}
this.Particle.active = !1;
};
i([ p(cc.Node) ], t.prototype, "ProgressBG", void 0);
i([ p(cc.Node) ], t.prototype, "ProgressPoint", void 0);
i([ p([ cc.SpriteFrame ]) ], t.prototype, "ProgressFrames", void 0);
i([ p(cc.Node) ], t.prototype, "Particle", void 0);
i([ p(cc.Label) ], t.prototype, "Rate", void 0);
return i([ d ], t);
}(cc.Component);
o.default = h;
cc._RF.pop();
}, {
"../../Game/fromework/helper/EventHelper": "EventHelper",
"../Common/SlotConst": "SlotConst",
"../Common/SlotModel": "SlotModel",
"../Common/SlotProxy": "SlotProxy"
} ],
SlotProxy: [ function(e, t, o) {
"use strict";
cc._RF.push(t, "cbd63e6O6JPs41NNnS5c1Jb", "SlotProxy");
Object.defineProperty(o, "__esModule", {
value: !0
});
var n = e("../../Game/client/global/enum/net/C2S"), a = e("../../Game/client/global/enum/net/S2C"), i = e("../../Game/fromework/global/Tools"), r = e("../../Game/fromework/helper/EventHelper"), l = e("../../Game/fromework/mvvm/modelView/ViewModel"), s = e("../../fromework/helper/NetHelper"), c = e("./SlotConst"), u = e("./SlotModel"), d = e("./SlotStruct"), p = function() {
function e() {
this._cls = 200;
}
Object.defineProperty(e, "Instance", {
get: function() {
e._instance || (e._instance = new e());
return e._instance;
},
enumerable: !1,
configurable: !0
});
e.prototype.Init = function() {
r.default.Instance.Net.bind(a.S2C.GAME.ROOM_ENTER_ROOM, this._onEnterRoom, this);
r.default.Instance.Net.bind(a.S2C.GAME.ROOM_SPIN, this._onSpin, this);
r.default.Instance.Net.bind(a.S2C.GAME.ROOM_CLEAN, this._onClean, this);
r.default.Instance.Net.bind(a.S2C.GAME.ROOM_EXCHANGE, this._onExchange, this);
r.default.Instance.Net.bind(a.S2C.GAME.ROOM_LEAVE, this._onLeave, this);
r.default.Instance.Net.bind(a.S2C.GAME.ROOM_LEAVE_SINGLE, this._onLeaveSingle, this);
r.default.Instance.Net.bind(a.S2C.GAME.ROOM_DISMISS, this._onDismiss, this);
};
e.prototype.clear = function() {
this.cls = 200;
r.default.Instance.Net.unbind(a.S2C.GAME.ROOM_ENTER_ROOM, this._onEnterRoom, this);
r.default.Instance.Net.unbind(a.S2C.GAME.ROOM_SPIN, this._onSpin, this);
r.default.Instance.Net.unbind(a.S2C.GAME.ROOM_CLEAN, this._onClean, this);
r.default.Instance.Net.unbind(a.S2C.GAME.ROOM_EXCHANGE, this._onExchange, this);
r.default.Instance.Net.unbind(a.S2C.GAME.ROOM_LEAVE, this._onLeave, this);
r.default.Instance.Net.unbind(a.S2C.GAME.ROOM_LEAVE_SINGLE, this._onLeaveSingle, this);
r.default.Instance.Net.unbind(a.S2C.GAME.ROOM_DISMISS, this._onDismiss, this);
};
Object.defineProperty(e.prototype, "uid", {
get: function() {
return l.VM.getValue("user.uid");
},
enumerable: !1,
configurable: !0
});
Object.defineProperty(e.prototype, "token", {
get: function() {
return l.VM.getValue("user.token");
},
enumerable: !1,
configurable: !0
});
Object.defineProperty(e.prototype, "roomID", {
get: function() {
return l.VM.getValue("lobby.roomID");
},
enumerable: !1,
configurable: !0
});
e.prototype.checkRoomID = function(e) {
return l.VM.getValue("lobby.roomID") == e;
};
Object.defineProperty(e.prototype, "cls", {
get: function() {
return this._cls;
},
set: function(e) {
this._cls = e;
},
enumerable: !1,
configurable: !0
});
e.prototype._onEnterRoom = function(e) {
var t = e.getUserData();
if (this.checkRoomID(t.rid)) {
var o = u.default.Instance;
o.roomData.refresh(t.room_data);
o.userData.refresh(t.user_data[l.VM.getValue("user.uid")]);
o.slotConfig.length = 0;
o.normalSlotConfig.length;
for (var n = 0; n < t.slot_config.length; n++) {
var a = new d.SlotStruct.SlotConfig(t.slot_config[n]);
o.slotConfig.push(a);
0 == a.type && o.normalSlotConfig.push(a);
}
r.default.Instance.Global.emit(c.SlotNetEvent.S2C_ENTER_ROOM);
}
};
e.prototype._onSpin = function(e) {
var t = e.getUserData();
if (this.checkRoomID(t.rid)) {
var o = u.default.Instance;
o.roomData.refresh(t.room_data);
o.userData.refresh(t.user_data[l.VM.getValue("user.uid")]);
r.default.Instance.Global.emit(c.SlotNetEvent.S2C_SPIN);
}
};
e.prototype._onClean = function(e) {
var t = e.getUserData();
if (this.checkRoomID(t.rid)) {
u.default.Instance.userData.refresh(t.user_data[l.VM.getValue("user.uid")]);
r.default.Instance.Global.emit(c.SlotNetEvent.S2C_CLEAN);
}
};
e.prototype._onExchange = function(e) {
var t = e.getUserData();
if (this.checkRoomID(t.rid)) {
u.default.Instance.userData.refresh(t.user_data[l.VM.getValue("user.uid")]);
r.default.Instance.Global.emit(c.SlotNetEvent.S2C_EXCHANGE, {
total_exchange: i.Tools.TNumber.num2single(t.total_exchange)
});
}
};
e.prototype._onLeave = function(e) {
var t = e.getUserData();
this.checkRoomID(t.rid) && r.default.Instance.Global.emit(c.SlotNetEvent.S2C_LEAVE);
};
e.prototype._onLeaveSingle = function(e) {
var t = e.getUserData();
(this.checkRoomID(t.rid) || 0 == l.VM.getValue("lobby.roomID")) && r.default.Instance.Global.emit(c.SlotNetEvent.S2C_LEAVE_SINGLE);
};
e.prototype._onDismiss = function(e) {
var t = e.getUserData();
this.checkRoomID(t.rid) && r.default.Instance.Global.emit(c.SlotNetEvent.S2C_DISMISS_ROOM);
};
e.prototype.sendEnterRoom = function(e, t) {
void 0 === t && (t = !0);
var o = s.default.Instance.makeMsg(n.C2S.ROOM_ENTER_ROOM, {
u: this.uid,
t: this.token,
r: e,
is_open: t
});
s.default.Instance.send(o);
};
e.prototype.sendSpin = function(e) {
var t = s.default.Instance.makeMsg(n.C2S.ROOM_SPIN, {
u: this.uid,
t: this.token,
r: this.roomID,
fee: e
});
s.default.Instance.send(t);
};
e.prototype.sendClean = function(e) {
var t = s.default.Instance.makeMsg(n.C2S.ROOM_CLEAN, {
u: this.uid,
t: this.token,
r: this.roomID,
fee: e
});
s.default.Instance.send(t);
};
e.prototype.sendExchange = function() {
var e = s.default.Instance.makeMsg(n.C2S.ROOM_EXCHANGE, {
u: this.uid,
t: this.token,
r: this.roomID
});
s.default.Instance.send(e);
};
e.prototype.sendLeave = function() {
var e = s.default.Instance.makeMsg(n.C2S.ROOM_LEAVE, {
u: this.uid,
t: this.token,
r: this.roomID
});
s.default.Instance.send(e);
};
e._instance = null;
return e;
}();
o.default = p;
cc._RF.pop();
}, {
"../../Game/client/global/enum/net/C2S": "C2S",
"../../Game/client/global/enum/net/S2C": "S2C",
"../../Game/fromework/global/Tools": "Tools",
"../../Game/fromework/helper/EventHelper": "EventHelper",
"../../Game/fromework/mvvm/modelView/ViewModel": "ViewModel",
"../../fromework/helper/NetHelper": "NetHelper",
"./SlotConst": "SlotConst",
"./SlotModel": "SlotModel",
"./SlotStruct": "SlotStruct"
} ],
SlotResult: [ function(e, t, o) {
"use strict";
cc._RF.push(t, "937a8zKW+BGko0VW0WgvnWu", "SlotResult");
var n, a = this && this.__extends || (n = function(e, t) {
return (n = Object.setPrototypeOf || {
__proto__: []
} instanceof Array && function(e, t) {
e.__proto__ = t;
} || function(e, t) {
for (var o in t) Object.prototype.hasOwnProperty.call(t, o) && (e[o] = t[o]);
})(e, t);
}, function(e, t) {
n(e, t);
function o() {
this.constructor = e;
}
e.prototype = null === t ? Object.create(t) : (o.prototype = t.prototype, new o());
}), i = this && this.__decorate || function(e, t, o, n) {
var a, i = arguments.length, r = i < 3 ? t : null === n ? n = Object.getOwnPropertyDescriptor(t, o) : n;
if ("object" == typeof Reflect && "function" == typeof Reflect.decorate) r = Reflect.decorate(e, t, o, n); else for (var l = e.length - 1; l >= 0; l--) (a = e[l]) && (r = (i < 3 ? a(r) : i > 3 ? a(t, o, r) : a(t, o)) || r);
return i > 3 && r && Object.defineProperty(t, o, r), r;
};
Object.defineProperty(o, "__esModule", {
value: !0
});
var r = e("../../Game/client/global/enum/game/Const"), l = e("../../Game/client/model/LanguageModel"), s = e("../../Game/fromework/global/Tools"), c = e("../../Game/fromework/helper/AudioHelper"), u = e("../Common/SlotConst"), d = e("../Common/SlotModel"), p = e("./Slot"), h = cc._decorator, f = h.ccclass, _ = h.property, m = function(e) {
a(t, e);
function t() {
var t = null !== e && e.apply(this, arguments) || this;
t.WinMoney = null;
t.Mask = null;
t.LineNumber = null;
t.LineNumberParent = null;
t.Line = null;
t.LineParent = null;
t.Slot = null;
t.SlotParent = null;
t.SlotSize = null;
t._dataAry = [];
t._callFunc = null;
return t;
}
t.prototype.init = function() {};
t.prototype.playResultTotal = function(e, t) {
var o = this;
if (0 != e.length) {
this._dataAry = e;
this._callFunc = t;
this.clear();
this.Mask.active = !0;
this.playTotal(function() {
o._callFunc && o._callFunc();
o._callFunc = null;
});
} else t && t();
};
t.prototype.playResultLoop = function(e, t) {
if (0 != e.length) {
this._dataAry = e;
this._callFunc = t;
this.clear();
this.Mask.active = !0;
this.playLoop(0);
} else t && t();
};
t.prototype.clear = function() {
this.WinMoney.string = "";
this.Mask.active = !1;
this.unscheduleAllCallbacks();
this.clearLineNumber();
this.clearLineAnimation();
this.clearHighlightSlot();
};
t.prototype.getLinePosByMark = function(e) {
for (var t = u.LinePosition[e], o = [], n = 0; n < t.length; n++) {
var a = cc.v3(t[n].x * this.SlotSize.width + this.SlotSize.width / 2, t[n].y * this.SlotSize.height + this.SlotSize.height / 2, 0);
o.push(a);
}
var i = cc.v3(o[o.length - 1].x + this.SlotSize.width, o[o.length - 1].y, 0);
o.push(i);
return o;
};
t.prototype.refreshWinMoney = function(e) {
var t = this;
this.WinMoney.string = l.default.getString("MoneySymbol") + e;
this.WinMoney.node.scale = 0;
this.WinMoney.node.opacity = 255;
this.WinMoney.node.stopAllActions();
cc.tween(this.WinMoney.node).to(.1, {
scale: 1
}).delay(.7).to(.2, {
opacity: 0
}).call(function() {
t.WinMoney.node.scale = 0;
t.WinMoney.node.opacity = 255;
}).start();
};
t.prototype.playLineAnimation = function(e) {
this.clearLineAnimation();
for (var t = 0; t < e.length; t++) for (var o = e[t], n = this.getLinePosByMark(o.line), a = cc.v3(n[0].x - this.SlotSize.width / 2 - 10, n[0].y, 0), i = function(e) {
var t = cc.instantiate(r.Line);
t.parent = r.LineParent;
t.position = a;
for (var o = cc.tween(t).delay(.13 * e), i = .8 / n.length, l = 0; l < n.length; l++) o.to(i, {
position: n[l]
});
o.delay(1.2 - .13 * e).call(function() {
t && t.isValid && t.destroy();
}).start();
}, r = this, l = 0; l < 5; l++) i(l);
};
t.prototype.clearLineAnimation = function() {
this.LineParent.destroyAllChildren();
};
t.prototype.createLineNumber = function(e) {
this.clearLineNumber();
for (var t = 0; t < e.length; t++) {
var o = e[t], n = cc.instantiate(this.LineNumber);
n.parent = this.LineNumberParent;
n.active = !0;
n.position = u.LineNumberPos[o.line - 1];
n.getChildByName("Number").getComponent(cc.Label).string = o.line.toString();
}
};
t.prototype.clearLineNumber = function() {
this.LineNumberParent.destroyAllChildren();
};
t.prototype.createHighlightSlot = function(e) {
var t = d.default.Instance;
this.clearHighlightSlot();
for (var o = 0; o < e.length; o++) {
var n = e[o], a = cc.instantiate(this.Slot);
a.parent = this.SlotParent;
a.active = !0;
a.setPosition(cc.v2(n.x * this.SlotSize.width + this.SlotSize.width / 2, n.y * this.SlotSize.height + this.SlotSize.height / 2));
var i = a.getComponent(p.default);
i.refreshByID(t.roomData.show_card.cards[n.x][n.y]);
i.playEffect();
}
};
t.prototype.clearHighlightSlot = function() {
this.SlotParent.destroyAllChildren();
};
t.prototype.playTotal = function(e) {
var t = this, o = [], n = 0;
this.createLineNumber(this._dataAry);
this.playLineAnimation(this._dataAry);
for (var a = 0; a < this._dataAry.length; a++) {
var i = this._dataAry[a];
o = o.concat(i.highlight);
n = s.Tools.TFloat.add(n, i.win_amount);
c.default.Instance.playBundleEffect(r.BundleSoundPath.slot_line);
a == this._dataAry.length - 1 && this.scheduleOnce(function() {
t && t.node && t.node.isValid && e && e();
}, 2);
}
if (o.length > 0) {
this.refreshWinMoney(n);
this.createHighlightSlot(o);
}
};
t.prototype.playSingle = function(e, t) {
var o = this, n = this._dataAry[e];
c.default.Instance.playBundleEffect(r.BundleSoundPath.slot_line);
this.createLineNumber([ n ]);
this.playLineAnimation([ n ]);
this.scheduleOnce(function() {
o && o.node && o.node.isValid && t && t();
}, 2);
this.refreshWinMoney(n.win_amount);
this.createHighlightSlot(n.highlight);
};
t.prototype.playLoop = function(e) {
var t = this;
0 == e ? this.playTotal(function() {
t.playSingle(e, function() {
++e >= t._dataAry.length && (e = 0);
t.playLoop(e);
});
t._callFunc && t._callFunc();
t._callFunc = null;
}) : this.playSingle(e, function() {
++e >= t._dataAry.length && (e = 0);
t.playLoop(e);
});
};
i([ _(cc.Label) ], t.prototype, "WinMoney", void 0);
i([ _(cc.Node) ], t.prototype, "Mask", void 0);
i([ _(cc.Prefab) ], t.prototype, "LineNumber", void 0);
i([ _(cc.Node) ], t.prototype, "LineNumberParent", void 0);
i([ _(cc.Prefab) ], t.prototype, "Line", void 0);
i([ _(cc.Node) ], t.prototype, "LineParent", void 0);
i([ _(cc.Prefab) ], t.prototype, "Slot", void 0);
i([ _(cc.Node) ], t.prototype, "SlotParent", void 0);
i([ _(cc.Size) ], t.prototype, "SlotSize", void 0);
return i([ f ], t);
}(cc.Component);
o.default = m;
cc._RF.pop();
}, {
"../../Game/client/global/enum/game/Const": "Const",
"../../Game/client/model/LanguageModel": "LanguageModel",
"../../Game/fromework/global/Tools": "Tools",
"../../Game/fromework/helper/AudioHelper": "AudioHelper",
"../Common/SlotConst": "SlotConst",
"../Common/SlotModel": "SlotModel",
"./Slot": "Slot"
} ],
SlotScene: [ function(e, t, o) {
"use strict";
cc._RF.push(t, "0f2bfQlx85Jvav7ytqKWHfe", "SlotScene");
var n, a = this && this.__extends || (n = function(e, t) {
return (n = Object.setPrototypeOf || {
__proto__: []
} instanceof Array && function(e, t) {
e.__proto__ = t;
} || function(e, t) {
for (var o in t) Object.prototype.hasOwnProperty.call(t, o) && (e[o] = t[o]);
})(e, t);
}, function(e, t) {
n(e, t);
function o() {
this.constructor = e;
}
e.prototype = null === t ? Object.create(t) : (o.prototype = t.prototype, new o());
}), i = this && this.__decorate || function(e, t, o, n) {
var a, i = arguments.length, r = i < 3 ? t : null === n ? n = Object.getOwnPropertyDescriptor(t, o) : n;
if ("object" == typeof Reflect && "function" == typeof Reflect.decorate) r = Reflect.decorate(e, t, o, n); else for (var l = e.length - 1; l >= 0; l--) (a = e[l]) && (r = (i < 3 ? a(r) : i > 3 ? a(t, o, r) : a(t, o)) || r);
return i > 3 && r && Object.defineProperty(t, o, r), r;
};
Object.defineProperty(o, "__esModule", {
value: !0
});
var r = e("../../Game/client/global/enum/game/Const"), l = e("../../Game/client/logic/game/GameHelper"), s = e("../../Game/fromework/global/ResLoader"), c = e("../../Game/fromework/helper/AudioHelper"), u = e("../../Game/fromework/helper/EventHelper"), d = e("../../Game/fromework/helper/UIHelper"), p = e("../../Game/fromework/mvvm/modelView/ViewModel"), h = e("../Common/SlotConst"), f = e("../Common/SlotModel"), _ = e("../Common/SlotProxy"), m = cc._decorator, y = m.ccclass, g = m.property, v = function(e) {
a(t, e);
function t() {
var t = null !== e && e.apply(this, arguments) || this;
t.Background = null;
t.UILayer = null;
t.TopLayer = null;
t._roomID = 0;
return t;
}
t.prototype.onLoad = function() {
this._init();
_.default.Instance.Init();
u.default.Instance.Global.bind(h.SlotNetEvent.S2C_DISMISS_ROOM, this._leaveRoom, this);
u.default.Instance.Global.bind(h.SlotNetEvent.S2C_LEAVE_SINGLE, this._leaveRoom, this);
};
t.prototype.onDestroy = function() {
_.default.Instance.clear();
f.default.clear();
this._roomID = 0;
u.default.Instance.Global.unbind(h.SlotNetEvent.S2C_DISMISS_ROOM, this._leaveRoom, this);
u.default.Instance.Global.unbind(h.SlotNetEvent.S2C_LEAVE_SINGLE, this._leaveRoom, this);
};
t.prototype.start = function() {
var e = this, t = _.default.Instance.cls, o = "Slot_" + t + "/Prefab/Slot_" + t;
s.default.Instance.loadBundleRes(o, cc.Prefab, function(t, o) {
if (null == t) {
var n = cc.instantiate(o);
e.UILayer.addChild(n);
e._joinRoom();
} else console.log("Slot load ui prefab error:" + t);
});
};
t.prototype._init = function() {
c.default.Instance.stopBGM();
c.default.Instance.playBGMBundle(r.BundleSoundPath.bgm_slot_200);
d.default.Instance.setLayers(this.Background, this.UILayer, this.TopLayer);
};
t.prototype._joinRoom = function() {
this._roomID = p.VM.getValue("lobby.roomID");
_.default.Instance.sendEnterRoom(this._roomID);
};
t.prototype._leaveRoom = function() {
l.Countdown.clear();
cc.director.preloadScene(r.Scene.Lobby, null, function(e) {
p.VM.setValue("lobby.roomID", 0);
e || cc.director.loadScene(r.Scene.Lobby, function() {});
});
};
i([ g(cc.Node) ], t.prototype, "Background", void 0);
i([ g(cc.Node) ], t.prototype, "UILayer", void 0);
i([ g(cc.Node) ], t.prototype, "TopLayer", void 0);
return i([ y ], t);
}(cc.Component);
o.default = v;
cc._RF.pop();
}, {
"../../Game/client/global/enum/game/Const": "Const",
"../../Game/client/logic/game/GameHelper": "GameHelper",
"../../Game/fromework/global/ResLoader": "ResLoader",
"../../Game/fromework/helper/AudioHelper": "AudioHelper",
"../../Game/fromework/helper/EventHelper": "EventHelper",
"../../Game/fromework/helper/UIHelper": "UIHelper",
"../../Game/fromework/mvvm/modelView/ViewModel": "ViewModel",
"../Common/SlotConst": "SlotConst",
"../Common/SlotModel": "SlotModel",
"../Common/SlotProxy": "SlotProxy"
} ],
SlotSpinButton: [ function(e, t, o) {
"use strict";
cc._RF.push(t, "8453cGiAdVLtI2u4k9MYRX7", "SlotSpinButton");
var n, a = this && this.__extends || (n = function(e, t) {
return (n = Object.setPrototypeOf || {
__proto__: []
} instanceof Array && function(e, t) {
e.__proto__ = t;
} || function(e, t) {
for (var o in t) Object.prototype.hasOwnProperty.call(t, o) && (e[o] = t[o]);
})(e, t);
}, function(e, t) {
n(e, t);
function o() {
this.constructor = e;
}
e.prototype = null === t ? Object.create(t) : (o.prototype = t.prototype, new o());
}), i = this && this.__decorate || function(e, t, o, n) {
var a, i = arguments.length, r = i < 3 ? t : null === n ? n = Object.getOwnPropertyDescriptor(t, o) : n;
if ("object" == typeof Reflect && "function" == typeof Reflect.decorate) r = Reflect.decorate(e, t, o, n); else for (var l = e.length - 1; l >= 0; l--) (a = e[l]) && (r = (i < 3 ? a(r) : i > 3 ? a(t, o, r) : a(t, o)) || r);
return i > 3 && r && Object.defineProperty(t, o, r), r;
};
Object.defineProperty(o, "__esModule", {
value: !0
});
var r = e("../../Game/client/model/LanguageModel"), l = e("../../Game/fromework/global/Tools"), s = e("../../Game/fromework/helper/ConfigHelper"), c = e("../../Game/fromework/helper/EventHelper"), u = e("../../client/model/ItemModel"), d = e("../Common/SlotConst"), p = e("../Common/SlotModel"), h = e("../Common/SlotProxy"), f = cc._decorator, _ = f.ccclass, m = f.property, y = function(e) {
a(t, e);
function t() {
var t = null !== e && e.apply(this, arguments) || this;
t.SpinButton = null;
t.IconSpin = null;
t.AutoCount = null;
t.isHaveFreeCount = !1;
t.IconFree = null;
t.FreeCount = null;
t.isHaveItem = !1;
t.ItemNode = null;
t.ItemCount = null;
t._exchangeCount = 0;
return t;
}
t.prototype.onLoad = function() {
this.SpinButton.isNotPlaySound = !0;
c.default.Instance.Global.bind(d.SlotNetEvent.S2C_ENTER_ROOM, this.onEnterRoom, this);
c.default.Instance.Global.bind(d.SlotNetEvent.S2C_EXCHANGE, this.onExchange, this);
c.default.Instance.Global.bind(d.SlotUIEvent.SLOT_UI_SPIN_REFRESH_BUTTON, this.refreshButtons, this);
c.default.Instance.Global.bind(d.SlotUIEvent.SLOT_UI_SPIN_REFRESH_LABEL, this.refreshButtonLabel, this);
};
t.prototype.onDestroy = function() {
c.default.Instance.Global.unbind(d.SlotNetEvent.S2C_ENTER_ROOM, this.onEnterRoom, this);
c.default.Instance.Global.unbind(d.SlotNetEvent.S2C_EXCHANGE, this.onExchange, this);
c.default.Instance.Global.unbind(d.SlotUIEvent.SLOT_UI_SPIN_REFRESH_BUTTON, this.refreshButtons, this);
c.default.Instance.Global.unbind(d.SlotUIEvent.SLOT_UI_SPIN_REFRESH_LABEL, this.refreshButtonLabel, this);
};
t.prototype.onEnterRoom = function() {
this.refreshButtons();
this.refreshButtonLabel();
this.checkItemExchange();
};
t.prototype.onExchange = function(e) {
var t = e.getUserData();
1 == this._exchangeCount ? l.Tools.TStr.replaceString(r.default.getString("SLOT_EXCHANGE_ALERT"), {
count: this._exchangeCount,
num: t.total_exchange
}) : l.Tools.TStr.replaceString(r.default.getString("SLOT_EXCHANGE_ALERT_HAVE"), {
count: this._exchangeCount,
num: t.total_exchange
});
this._exchangeCount = 0;
};
t.prototype.checkItemExchange = function() {
var e = p.default.Instance;
if (null != e.roomData.item && 0 != e.roomData.item.length) {
var t = s.ConfigHelper.Instance.getLine("item", e.roomData.item[0].toString());
if (t) {
var o = u.ItemProxy.Instance.getItemCount(parseInt(t.id)), n = e.userData.wild_step_info.now_top_step_num;
if (o > 0 && n > 0 && t.param != e.bet_fee) {
this._exchangeCount = o;
h.default.Instance.sendExchange();
}
}
}
};
t.prototype.refreshButtons = function() {
var e = p.default.Instance;
this.SpinButton.interactable = !e.isPlaySpin || e.isAuto;
var t = !0, o = e.isAuto;
if (this.isHaveFreeCount) {
null != this.IconFree && (this.IconFree.active = e.userData.free > 0);
null != this.FreeCount && (this.FreeCount.node.active = e.userData.free > 0);
t = !e.isAuto && 0 == e.userData.free;
o = e.isAuto && 0 == e.userData.free;
}
if (this.isHaveItem) {
var n = e.getNowGearItemCount();
this.ItemNode.active = n > 0;
t = !e.isAuto && !this.ItemNode.active;
o = e.isAuto && !this.ItemNode.active;
}
this.IconSpin.active = t;
this.AutoCount.node.active = o;
this.refreshButtonLabel();
};
t.prototype.refreshButtonLabel = function() {
var e, t, o = p.default.Instance;
if (this.isHaveFreeCount) {
this.FreeCount.string = o.userData.free.toString();
this.AutoCount.string = o.autoCount.toString();
}
if (this.isHaveItem) {
var n = null !== (t = u.ItemProxy.Instance.getItemCount(null === (e = o.roomData) || void 0 === e ? void 0 : e.item[0])) && void 0 !== t ? t : 0;
this.ItemCount.string = n.toString();
}
this.AutoCount.string = o.autoCount.toString();
};
t.prototype.onSpinClicked = function() {
var e = p.default.Instance;
c.default.Instance.Global.emit(d.SlotUIEvent.SLOT_UI_HIDE_AUTO);
e.isAuto ? c.default.Instance.Global.emit(d.SlotUIEvent.SLOT_UI_STOP_AUTO) : c.default.Instance.Global.emit(d.SlotUIEvent.SLOT_UI_SPIN_PLAY);
};
i([ m(cc.Button) ], t.prototype, "SpinButton", void 0);
i([ m(cc.Node) ], t.prototype, "IconSpin", void 0);
i([ m(cc.Label) ], t.prototype, "AutoCount", void 0);
i([ m(cc.Boolean) ], t.prototype, "isHaveFreeCount", void 0);
i([ m({
type: cc.Node,
visible: function() {
return this.isHaveFreeCount;
}
}) ], t.prototype, "IconFree", void 0);
i([ m({
type: cc.Label,
visible: function() {
return this.isHaveFreeCount;
}
}) ], t.prototype, "FreeCount", void 0);
i([ m(cc.Boolean) ], t.prototype, "isHaveItem", void 0);
i([ m({
type: cc.Node,
visible: function() {
return this.isHaveItem;
}
}) ], t.prototype, "ItemNode", void 0);
i([ m({
type: cc.Label,
visible: function() {
return this.isHaveItem;
}
}) ], t.prototype, "ItemCount", void 0);
return i([ _ ], t);
}(cc.Component);
o.default = y;
cc._RF.pop();
}, {
"../../Game/client/model/LanguageModel": "LanguageModel",
"../../Game/fromework/global/Tools": "Tools",
"../../Game/fromework/helper/ConfigHelper": "ConfigHelper",
"../../Game/fromework/helper/EventHelper": "EventHelper",
"../../client/model/ItemModel": "ItemModel",
"../Common/SlotConst": "SlotConst",
"../Common/SlotModel": "SlotModel",
"../Common/SlotProxy": "SlotProxy"
} ],
SlotStruct: [ function(e, t, o) {
"use strict";
cc._RF.push(t, "5f1e5cKBZJO066tO8Rd/stx", "SlotStruct");
Object.defineProperty(o, "__esModule", {
value: !0
});
o.SlotStruct = void 0;
var n = e("../../Game/fromework/global/Tools");
(function(e) {
var t = function() {
function e(e) {
this.uid = 0;
this.name = "";
this.head_url = "";
this.sex = 0;
this.state = 0;
this.win_fee = 0;
this.res = 0;
this.free = 0;
this.bet_fee = 0;
this.free_win_fee = 0;
this.wild_step_info = null;
e && this.refresh(e);
}
e.prototype.refresh = function(e) {
this.uid = e.uid;
this.name = e.name;
this.head_url = e.head_url;
this.sex = e.sex;
this.state = e.state;
this.win_fee = n.Tools.TNumber.num2single(e.win_fee);
this.res = e.res;
this.free = e.free;
this.bet_fee = n.Tools.TNumber.num2single(e.bet_fee);
this.free_win_fee = n.Tools.TNumber.num2single(e.free_win_fee);
this.wild_step_info = new s(e.wild_step_info);
};
return e;
}();
e.UserData = t;
var o = function() {
function e(e) {
this.rid = 0;
this.rtype = "";
this.state = 0;
this.round = 0;
this.bet_fee_currency = [];
this.show_card = null;
this.item = [];
e && this.refresh(e);
}
e.prototype.refresh = function(e) {
this.rid = e.rid || 0;
this.rtype = e.rtype || 0;
this.state = e.state || 0;
this.round = e.round || 0;
this.bet_fee_currency = e.bet_fee_currency || 0;
null != e.show_card && (null != this.show_card ? this.show_card.refresh(e.show_card) : this.show_card = new i(e.show_card));
this.item = e.item || [];
};
return e;
}();
e.RoomData = o;
var a = function() {
function e(e) {
this.id = 0;
this.type = 0;
this.odds = [];
e && this.refresh(e);
}
e.prototype.refresh = function(e) {
this.id = e.id;
this.type = e.type;
this.odds = e.odds;
};
return e;
}();
e.SlotConfig = a;
var i = function() {
function e(e) {
this.cards = [];
this.win_raise_id = [];
this.scattr_info = null;
e && this.refresh(e);
}
e.prototype.refresh = function(e) {
this.cards = e.cards || [];
console.log("ShowCard:", e.cards);
this.win_raise_id.length = 0;
for (var t = 0; t < e.win_raise_id.length; t++) {
var o = new r(e.win_raise_id[t]);
this.win_raise_id.push(o);
}
null != this.scattr_info ? this.scattr_info.refresh(e.scattr_info) : this.scattr_info = new l(e.scattr_info);
};
return e;
}();
e.ShowCard = i;
var r = function() {
function e(e) {
this.multiple = 0;
this.highlight = [];
this.line = 0;
this.win_amount = 0;
e && this.refresh(e);
}
e.prototype.refresh = function(e) {
this.multiple = e.multiple || 0;
this.highlight = e.highlight || [];
this.line = e.line || 0;
this.win_amount = null != e.win_amount ? n.Tools.TNumber.num2single(e.win_amount) : 0;
};
return e;
}();
e.RaiseData = r;
var l = function() {
function e(e) {
this.highlight = [];
this.scattr_cnt = 0;
this.free_spin_cnt = 0;
e && this.refresh(e);
}
e.prototype.refresh = function(e) {
this.highlight = e.highlight || [];
this.scattr_cnt = e.scattr_cnt || 0;
this.free_spin_cnt = e.free_spin_cnt || 0;
this.highlight.sort(function(e, t) {
return e.x - t.x;
});
};
return e;
}();
e.ScattrData = l;
var s = function() {
function e(e) {
this.all_top_step_num = 0;
this.now_top_step_num = 0;
this.now_top_multiple = 0;
this.highlight = [];
e && this.refresh(e);
}
e.prototype.refresh = function(e) {
var t, o, n, a;
this.all_top_step_num = null !== (t = e.all_top_step_num) && void 0 !== t ? t : 0;
this.now_top_step_num = null !== (o = e.now_top_step_num) && void 0 !== o ? o : 0;
this.now_top_multiple = null !== (n = e.now_top_multiple) && void 0 !== n ? n : 0;
this.highlight = null !== (a = e.highlight) && void 0 !== a ? a : [];
};
return e;
}();
e.WildStepInfo = s;
})(o.SlotStruct || (o.SlotStruct = {}));
cc._RF.pop();
}, {
"../../Game/fromework/global/Tools": "Tools"
} ],
SlotTab: [ function(e, t, o) {
"use strict";
cc._RF.push(t, "1d718Z4YWhKZ6xXN7XnmSuL", "SlotTab");
var n, a = this && this.__extends || (n = function(e, t) {
return (n = Object.setPrototypeOf || {
__proto__: []
} instanceof Array && function(e, t) {
e.__proto__ = t;
} || function(e, t) {
for (var o in t) Object.prototype.hasOwnProperty.call(t, o) && (e[o] = t[o]);
})(e, t);
}, function(e, t) {
n(e, t);
function o() {
this.constructor = e;
}
e.prototype = null === t ? Object.create(t) : (o.prototype = t.prototype, new o());
}), i = this && this.__decorate || function(e, t, o, n) {
var a, i = arguments.length, r = i < 3 ? t : null === n ? n = Object.getOwnPropertyDescriptor(t, o) : n;
if ("object" == typeof Reflect && "function" == typeof Reflect.decorate) r = Reflect.decorate(e, t, o, n); else for (var l = e.length - 1; l >= 0; l--) (a = e[l]) && (r = (i < 3 ? a(r) : i > 3 ? a(t, o, r) : a(t, o)) || r);
return i > 3 && r && Object.defineProperty(t, o, r), r;
};
Object.defineProperty(o, "__esModule", {
value: !0
});
var r = e("../../Game/client/global/enum/game/Const"), l = e("../../Game/fromework/helper/AudioHelper"), s = e("../../Game/fromework/helper/EventHelper"), c = e("../Common/SlotConst"), u = e("../Common/SlotModel"), d = cc._decorator, p = d.ccclass, h = d.property, f = function(e) {
a(t, e);
function t() {
var t = null !== e && e.apply(this, arguments) || this;
t.TabParent = null;
t.GemEffect = null;
t.Prefab_Cell = null;
t.Prefab_Particle = null;
t.SlotSize = null;
t._gridMap = new Map();
return t;
}
t.prototype.onLoad = function() {
s.default.Instance.Global.bind(c.SlotNetEvent.S2C_ENTER_ROOM, this._onEnterRoom, this);
s.default.Instance.Global.bind(c.SlotNetEvent.S2C_CLEAN, this._onCleanTab, this);
s.default.Instance.Global.bind(c.SlotUIEvent.SLOT_UI_TAB_ADD, this._onAddNewTab, this);
s.default.Instance.Global.bind(c.SlotUIEvent.SLOT_UI_TAB_CLEAN, this._onCleanTab, this);
s.default.Instance.Global.bind(c.SlotUIEvent.SLOT_UI_TAB_CHANGE, this._onChange, this);
};
t.prototype.onDestroy = function() {
s.default.Instance.Global.unbind(c.SlotNetEvent.S2C_ENTER_ROOM, this._onEnterRoom, this);
s.default.Instance.Global.unbind(c.SlotNetEvent.S2C_CLEAN, this._onCleanTab, this);
s.default.Instance.Global.unbind(c.SlotUIEvent.SLOT_UI_TAB_ADD, this._onAddNewTab, this);
s.default.Instance.Global.unbind(c.SlotUIEvent.SLOT_UI_TAB_CLEAN, this._onCleanTab, this);
s.default.Instance.Global.unbind(c.SlotUIEvent.SLOT_UI_TAB_CHANGE, this._onChange, this);
};
t.prototype.getSlotPosition = function(e) {
return cc.v2(e.x * this.SlotSize.width + this.SlotSize.width / 2, e.y * this.SlotSize.height + this.SlotSize.height / 2);
};
t.prototype._onEnterRoom = function() {
var e, t, o, n, a = u.default.Instance;
this._onCleanTab();
for (var i = 0; i < (null === (t = null === (e = a.userData) || void 0 === e ? void 0 : e.wild_step_info) || void 0 === t ? void 0 : t.highlight.length); i++) {
var r = null === (n = null === (o = a.userData) || void 0 === o ? void 0 : o.wild_step_info) || void 0 === n ? void 0 : n.highlight[i], l = r.x.toString() + "|" + r.y.toString(), s = this.getSlotPosition(r), c = cc.instantiate(this.Prefab_Cell);
c.setParent(this.TabParent);
c.setPosition(s);
c.getComponent(sp.Skeleton).setAnimation(0, "slot_tab", !0);
this._gridMap.set(l, c);
}
};
t.prototype._onAddNewTab = function(e) {
for (var t = e.getUserData(), o = 0; o < t.length; o++) {
var n = t[o], a = n.x.toString() + "|" + n.y.toString(), i = this.getSlotPosition(n);
if (this._gridMap.has(a)) {
var r = cc.instantiate(this.Prefab_Particle);
r.setParent(this.TabParent);
r.setPosition(i);
s.default.Instance.Global.emit(c.SlotUIEvent.SLOT_UI_PROGRESS_MULTIPLE_EFFECT, r);
} else {
var l = cc.instantiate(this.Prefab_Cell);
l.setParent(this.TabParent);
l.setPosition(i);
l.getComponent(sp.Skeleton).setAnimation(0, "slot_tab", !0);
this._gridMap.set(a, l);
}
}
};
t.prototype._onChange = function() {
var e = this, t = u.default.Instance;
this.GemEffect.node.active = !0;
this.GemEffect.setCompleteListener(function() {
e.GemEffect.setCompleteListener(function() {});
e.GemEffect.node.active = !1;
l.default.Instance.playBundleEffect(r.BundleSoundPath.slot_tab_change);
e._gridMap.forEach(function(o, n) {
var a = n.split("|"), i = {
x: parseInt(a[0]),
y: parseInt(a[1])
}, r = t.getIDByPos(i);
if (11 != r && 12 != r) {
var l = cc.instantiate(e.Prefab_Particle);
l.setParent(e.TabParent);
l.setPosition(e.GemEffect.node.position);
cc.tween(l).to(.3, {
position: o.position
}).call(function() {
l.destroy();
o.getComponent(sp.Skeleton).setAnimation(0, "slot_tab_change", !1);
}).start();
}
});
});
this.GemEffect.setAnimation(0, "animation", !1);
};
t.prototype._onCleanTab = function() {
this._gridMap.clear();
this.TabParent.destroyAllChildren();
};
i([ h(cc.Node) ], t.prototype, "TabParent", void 0);
i([ h(sp.Skeleton) ], t.prototype, "GemEffect", void 0);
i([ h(cc.Prefab) ], t.prototype, "Prefab_Cell", void 0);
i([ h(cc.Prefab) ], t.prototype, "Prefab_Particle", void 0);
i([ h(cc.Size) ], t.prototype, "SlotSize", void 0);
return i([ p ], t);
}(cc.Component);
o.default = f;
cc._RF.pop();
}, {
"../../Game/client/global/enum/game/Const": "Const",
"../../Game/fromework/helper/AudioHelper": "AudioHelper",
"../../Game/fromework/helper/EventHelper": "EventHelper",
"../Common/SlotConst": "SlotConst",
"../Common/SlotModel": "SlotModel"
} ],
SlotUI: [ function(e, t, o) {
"use strict";
cc._RF.push(t, "12cb0aqF0ZJX7MHm1C8Y3em", "SlotUI");
var n, a = this && this.__extends || (n = function(e, t) {
return (n = Object.setPrototypeOf || {
__proto__: []
} instanceof Array && function(e, t) {
e.__proto__ = t;
} || function(e, t) {
for (var o in t) Object.prototype.hasOwnProperty.call(t, o) && (e[o] = t[o]);
})(e, t);
}, function(e, t) {
n(e, t);
function o() {
this.constructor = e;
}
e.prototype = null === t ? Object.create(t) : (o.prototype = t.prototype, new o());
}), i = this && this.__decorate || function(e, t, o, n) {
var a, i = arguments.length, r = i < 3 ? t : null === n ? n = Object.getOwnPropertyDescriptor(t, o) : n;
if ("object" == typeof Reflect && "function" == typeof Reflect.decorate) r = Reflect.decorate(e, t, o, n); else for (var l = e.length - 1; l >= 0; l--) (a = e[l]) && (r = (i < 3 ? a(r) : i > 3 ? a(t, o, r) : a(t, o)) || r);
return i > 3 && r && Object.defineProperty(t, o, r), r;
}, r = this && this.__awaiter || function(e, t, o, n) {
return new (o || (o = Promise))(function(a, i) {
function r(e) {
try {
s(n.next(e));
} catch (e) {
i(e);
}
}
function l(e) {
try {
s(n.throw(e));
} catch (e) {
i(e);
}
}
function s(e) {
e.done ? a(e.value) : (t = e.value, t instanceof o ? t : new o(function(e) {
e(t);
})).then(r, l);
var t;
}
s((n = n.apply(e, t || [])).next());
});
}, l = this && this.__generator || function(e, t) {
var o, n, a, i, r = {
label: 0,
sent: function() {
if (1 & a[0]) throw a[1];
return a[1];
},
trys: [],
ops: []
};
return i = {
next: l(0),
throw: l(1),
return: l(2)
}, "function" == typeof Symbol && (i[Symbol.iterator] = function() {
return this;
}), i;
function l(e) {
return function(t) {
return s([ e, t ]);
};
}
function s(i) {
if (o) throw new TypeError("Generator is already executing.");
for (;r; ) try {
if (o = 1, n && (a = 2 & i[0] ? n.return : i[0] ? n.throw || ((a = n.return) && a.call(n), 
0) : n.next) && !(a = a.call(n, i[1])).done) return a;
(n = 0, a) && (i = [ 2 & i[0], a.value ]);
switch (i[0]) {
case 0:
case 1:
a = i;
break;

case 4:
r.label++;
return {
value: i[1],
done: !1
};

case 5:
r.label++;
n = i[1];
i = [ 0 ];
continue;

case 7:
i = r.ops.pop();
r.trys.pop();
continue;

default:
if (!(a = r.trys, a = a.length > 0 && a[a.length - 1]) && (6 === i[0] || 2 === i[0])) {
r = 0;
continue;
}
if (3 === i[0] && (!a || i[1] > a[0] && i[1] < a[3])) {
r.label = i[1];
break;
}
if (6 === i[0] && r.label < a[1]) {
r.label = a[1];
a = i;
break;
}
if (a && r.label < a[2]) {
r.label = a[2];
r.ops.push(i);
break;
}
a[2] && r.ops.pop();
r.trys.pop();
continue;
}
i = t.call(e, r);
} catch (e) {
i = [ 6, e ];
n = 0;
} finally {
o = a = 0;
}
if (5 & i[0]) throw i[1];
return {
value: i[0] ? i[1] : void 0,
done: !0
};
}
};
Object.defineProperty(o, "__esModule", {
value: !0
});
var s = e("../../Game/client/global/enum/game/Const"), c = e("../../Game/client/global/enum/game/Event"), u = e("../../Game/client/model/LanguageModel"), d = e("../../Game/fromework/global/Tools"), p = e("../../Game/fromework/helper/AudioHelper"), h = e("../../Game/fromework/helper/ConfigHelper"), f = e("../../Game/fromework/helper/EventHelper"), _ = e("../../Game/fromework/helper/UIHelper"), m = e("../../Game/fromework/mvvm/modelView/ViewModel"), y = e("../../client/logic/Wallet/WalletHelper"), g = e("../../client/model/ItemModel"), v = e("../../client/model/LobbyModel"), C = e("../Common/SlotConst"), b = e("../Common/SlotModel"), I = e("../Common/SlotProxy"), E = e("./SlotHelp"), S = e("./SlotResult"), T = e("./SlotWin"), R = e("./TrackManager"), O = cc._decorator, A = O.ccclass, P = O.property, M = function(e) {
a(t, e);
function t() {
var t = null !== e && e.apply(this, arguments) || this;
t.TrackManager = null;
t.SlotResult = null;
t.SlotWin = null;
t.CloseButton = null;
t.HelpButton = null;
t.FastToggle = null;
t.AutoButton = null;
t.AutoCheck = null;
t.AutoSelect = null;
t.UserMoney = null;
t.WinMoney = null;
t.SubButton = null;
t.AddButton = null;
t.BetMoney = null;
return t;
}
t.prototype.onLoad = function() {
this.TrackManager.init();
this.SlotResult.init();
this.SlotWin.init();
f.default.Instance.Global.bind(C.SlotNetEvent.S2C_ENTER_ROOM, this.onEnterRoom, this);
f.default.Instance.Global.bind(C.SlotNetEvent.S2C_SPIN, this.onSpin, this);
f.default.Instance.Global.bind(C.SlotUIEvent.SLOT_UI_SPIN_PLAY, this.doSpin, this);
f.default.Instance.Global.bind(C.SlotUIEvent.SLOT_UI_HIDE_AUTO, this.onHideAuto, this);
f.default.Instance.Global.bind(C.SlotUIEvent.SLOT_UI_STOP_AUTO, this.stopAutoSpin, this);
f.default.Instance.Global.bind(c.GameEvent.S2C_SEND_AVAILABLE_BALANCE, this.onWalletChange, this);
};
t.prototype.onDestroy = function() {
this.unscheduleAllCallbacks();
f.default.Instance.Global.unbind(C.SlotNetEvent.S2C_ENTER_ROOM, this.onEnterRoom, this);
f.default.Instance.Global.unbind(C.SlotNetEvent.S2C_SPIN, this.onSpin, this);
f.default.Instance.Global.unbind(C.SlotUIEvent.SLOT_UI_SPIN_PLAY, this.doSpin, this);
f.default.Instance.Global.unbind(C.SlotUIEvent.SLOT_UI_HIDE_AUTO, this.onHideAuto, this);
f.default.Instance.Global.unbind(C.SlotUIEvent.SLOT_UI_STOP_AUTO, this.stopAutoSpin, this);
f.default.Instance.Global.unbind(c.GameEvent.S2C_SEND_AVAILABLE_BALANCE, this.onWalletChange, this);
};
t.prototype.onEnterRoom = function() {
var e, t, o = b.default.Instance;
b.default.Instance.betIndex = 0 == o.userData.bet_fee ? 0 : o.roomData.bet_fee_currency.indexOf(o.userData.bet_fee);
if (o.roomData.item.length > 0) {
var n = h.ConfigHelper.Instance.getLine("item", o.roomData.item[0].toString()), a = null !== (t = g.ItemProxy.Instance.getItemCount(null === (e = o.roomData) || void 0 === e ? void 0 : e.item[0])) && void 0 !== t ? t : 0;
if (null != n && a > 0 && n.param != o.bet_fee && 0 == o.userData.wild_step_info.now_top_step_num) {
var i = o.roomData.bet_fee_currency.indexOf(parseFloat(n.param));
-1 != i && (b.default.Instance.betIndex = i);
}
}
this.refreshFast();
this.refreshWinMoney(!0);
this.refreshBet();
this.refreshUserMoney();
};
t.prototype.delay = function(e) {
return r(this, void 0, Promise, function() {
var t = this;
return l(this, function() {
return [ 2, new Promise(function(o) {
return setTimeout(function() {
t && t.node && t.node.isValid && o();
}, 1e3 * e);
}) ];
});
});
};
t.prototype.onSpin = function() {
var e = this, t = b.default.Instance;
this.SlotResult.clear();
p.default.Instance.playBundleEffect(s.BundleSoundPath.slot_spin_start);
f.default.Instance.Global.emit(C.SlotUIEvent.SLOT_UI_SPIN_REFRESH_LABEL);
f.default.Instance.Global.emit(C.SlotUIEvent.SLOT_UI_PROGRESS_REFRESH);
this.TrackManager.playSpin(t.isFast, function() {
return r(e, void 0, void 0, function() {
var e, o, n, a, i, r, s, c, u, d, p = this;
return l(this, function(l) {
switch (l.label) {
case 0:
e = function() {
p.refreshUserMoney();
p.refreshWinMoney();
var e = 0, o = function() {
if (2 == ++e) {
b.default.Instance.isPlaySpin = !1;
var o = t.roomData.show_card.win_raise_id.length > 0 ? 0 : 1;
p.checkAutoSpin(o);
}
};
t.autoCount > 0 ? p.SlotResult.playResultTotal(t.roomData.show_card.win_raise_id, function() {
o();
}) : p.SlotResult.playResultLoop(t.roomData.show_card.win_raise_id, function() {
o();
});
p.playWin(function() {
o();
});
};
if (0 == (null === (a = null === (n = t.userData) || void 0 === n ? void 0 : n.wild_step_info) || void 0 === a ? void 0 : a.all_top_step_num)) return [ 3, 12 ];
o = t.getResultPosByType(t.getSlotConfigByType(1)[0].id);
if ((null === (r = null === (i = t.userData) || void 0 === i ? void 0 : i.wild_step_info) || void 0 === r ? void 0 : r.all_top_step_num) != (null === (c = null === (s = t.userData) || void 0 === s ? void 0 : s.wild_step_info) || void 0 === c ? void 0 : c.now_top_step_num)) return [ 3, 8 ];
f.default.Instance.Global.emit(C.SlotUIEvent.SLOT_UI_TAB_ADD, o);
return o.length > 0 ? [ 4, this.delay(.5) ] : [ 3, 2 ];

case 1:
l.sent();
l.label = 2;

case 2:
f.default.Instance.Global.emit(C.SlotUIEvent.SLOT_UI_PROGRESS_CLEAN);
return t.userData.wild_step_info.highlight.length > 0 ? [ 4, this.delay(.5) ] : [ 3, 6 ];

case 3:
l.sent();
f.default.Instance.Global.emit(C.SlotUIEvent.SLOT_UI_TAB_CHANGE);
return [ 4, this.delay(1.5) ];

case 4:
l.sent();
t.changeTabData();
this.TrackManager.changeWildSlot();
return [ 4, this.delay(.5) ];

case 5:
l.sent();
l.label = 6;

case 6:
f.default.Instance.Global.emit(C.SlotUIEvent.SLOT_UI_TAB_CLEAN);
return [ 4, this.delay(.1) ];

case 7:
l.sent();
e();
I.default.Instance.sendClean(t.bet_fee);
return [ 3, 11 ];

case 8:
f.default.Instance.Global.emit(C.SlotUIEvent.SLOT_UI_TAB_ADD, o);
return o.length > 0 ? [ 4, this.delay(.5) ] : [ 3, 10 ];

case 9:
l.sent();
l.label = 10;

case 10:
1 == (null === (d = null === (u = t.userData) || void 0 === u ? void 0 : u.wild_step_info) || void 0 === d ? void 0 : d.now_top_step_num) && f.default.Instance.Global.emit(C.SlotUIEvent.SLOT_UI_PROGRESS_MULTIPLE_STRING);
e();
l.label = 11;

case 11:
return [ 3, 13 ];

case 12:
e();
l.label = 13;

case 13:
return [ 2 ];
}
});
});
});
};
t.prototype.onWalletChange = function() {
b.default.Instance.isPlaySpin || this.refreshUserMoney();
};
t.prototype.playWin = function(e) {
var t = this, o = b.default.Instance, n = o.roomData.show_card.scattr_info.scattr_cnt, a = o.roomData.show_card.scattr_info.free_spin_cnt, i = o.userData.win_fee, r = i / o.bet_fee, l = function() {
n >= 3 ? t.SlotWin.showFree(o.isAuto, n, a, function() {
e && e();
}) : e && e();
};
0 == o.userData.free && 0 != o.userData.free_win_fee ? this.SlotWin.showTotalWin(o.isAuto, o.userData.free_win_fee, function() {
l();
}) : r >= 3 ? this.SlotWin.showWin(o.isAuto, r, i, function() {
l();
}) : l();
};
t.prototype.checkAutoSpin = function(e) {
var t = this;
void 0 === e && (e = .5);
var o = b.default.Instance;
if (o.autoCount > 0 && !o.isPlaySpin) this.scheduleOnce(function() {
o.checkDeductAutoCount() && o.autoCount--;
t.doSpin();
o.autoCount <= 0 && t.stopAutoSpin();
f.default.Instance.Global.emit(C.SlotUIEvent.SLOT_UI_SPIN_REFRESH_BUTTON);
t.refreshBet();
}, e); else {
f.default.Instance.Global.emit(C.SlotUIEvent.SLOT_UI_SPIN_REFRESH_BUTTON);
this.refreshBet();
}
};
t.prototype.refreshFast = function() {
this.FastToggle.isChecked = b.default.Instance.isFast;
};
t.prototype.refreshUserMoney = function(e) {
this.UserMoney.string = null != e ? e.toString() : m.VM.getValue("wallet.total");
};
t.prototype.refreshWinMoney = function(e) {
void 0 === e && (e = !1);
var t, o = b.default.Instance;
t = o.userData.free > 0 && o.userData.free_win_fee > 0 ? o.userData.free_win_fee : e ? 0 : o.userData.win_fee;
this.WinMoney.string = u.default.getString("MoneySymbol") + t;
};
t.prototype.refreshBet = function() {
var e = b.default.Instance;
e.betIndex >= e.roomData.bet_fee_currency.length && (e.betIndex = 0);
var t = null != e.userData.free && e.userData.free > 0;
this.AddButton.interactable = e.betIndex < e.roomData.bet_fee_currency.length - 1 && !t && !e.isAuto && !b.default.Instance.isPlaySpin;
this.SubButton.interactable = e.betIndex > 0 && !t && !e.isAuto && !e.isPlaySpin;
this.BetMoney.string = u.default.getString("MoneySymbol") + e.roomData.bet_fee_currency[e.betIndex];
this.AutoCheck.active = e.isAuto;
};
t.prototype.doSpin = function() {
var e = b.default.Instance, t = v.default.Instance.getGamePlay(e.roomData.rtype), o = v.default.Instance.getPlaySwitch(t.cls);
if (o && (!o || 3 != o.s) || e.checkRecharge()) {
var n = e.roomData.bet_fee_currency[e.betIndex] || e.roomData.bet_fee_currency[0];
if (e.userData.free > 0 || m.VM.getValue("wallet.total") >= n) {
e.userData.free <= 0 && this.refreshUserMoney(d.Tools.TFloat.sub(m.VM.getValue("wallet.total"), n));
this.refreshWinMoney(!0);
e.isPlaySpin = !0;
f.default.Instance.Global.emit(C.SlotUIEvent.SLOT_UI_SPIN_REFRESH_BUTTON);
this.refreshBet();
I.default.Instance.sendSpin(e.userData.free > 0 ? 0 : n);
} else {
this.stopAutoSpin();
y.default.Instance.openRechargeAlert(n, 0);
}
} else {
y.default.Instance.openRechargeAlert(100, 0, !1);
this.stopAutoSpin();
}
};
t.prototype.stopAutoSpin = function() {
var e = b.default.Instance;
e.isAuto;
e.isAuto = !1;
e.autoCount = 0;
f.default.Instance.Global.emit(C.SlotUIEvent.SLOT_UI_SPIN_REFRESH_BUTTON);
this.refreshBet();
};
t.prototype.onBetAddClicked = function() {
var e, t;
this.onHideAuto();
var o = b.default.Instance;
if (0 == (null === (t = null === (e = o.userData) || void 0 === e ? void 0 : e.wild_step_info) || void 0 === t ? void 0 : t.now_top_step_num) && o.betIndex != o.roomData.bet_fee_currency.length - 1) {
o.betIndex++;
f.default.Instance.Global.emit(C.SlotUIEvent.SLOT_UI_SPIN_REFRESH_BUTTON);
this.refreshBet();
}
};
t.prototype.onBetSubClicked = function() {
var e, t;
this.onHideAuto();
var o = b.default.Instance;
if (0 == (null === (t = null === (e = o.userData) || void 0 === e ? void 0 : e.wild_step_info) || void 0 === t ? void 0 : t.now_top_step_num) && 0 != o.betIndex) {
o.betIndex--;
f.default.Instance.Global.emit(C.SlotUIEvent.SLOT_UI_SPIN_REFRESH_BUTTON);
this.refreshBet();
}
};
t.prototype.onFastClicked = function() {
this.onHideAuto();
b.default.Instance.isFast = this.FastToggle.isChecked;
cc.sys.localStorage.setItem("SlotFastSwitch" + m.VM.getValue("user.uid"), JSON.stringify(b.default.Instance.isFast));
};
t.prototype.onAutoClicked = function() {
b.default.Instance.isAuto ? this.stopAutoSpin() : this.AutoSelect.active = !this.AutoSelect.active;
};
t.prototype.onSelectAutoCount = function(e, t) {
var o = b.default.Instance;
this.onHideAuto();
var n = parseInt(t);
o.isAuto = !0;
o.autoCount = n;
this.checkAutoSpin(0);
};
t.prototype.onHideAuto = function() {
this.AutoSelect.active = !1;
};
t.prototype.onHelpClicked = function() {
this.onHideAuto();
if (!b.default.Instance.isPlaySpin) {
var e = 200 == I.default.Instance.cls ? s.BundleUIPath.SlotHelp : s.BundleUIPath.SlotHelp201;
_.default.Instance.addBundleMaskLayer(e, function(e) {
e.getComponent(E.default).showView();
});
}
};
t.prototype.onCloseClicked = function() {
I.default.Instance.sendLeave();
};
i([ P(R.default) ], t.prototype, "TrackManager", void 0);
i([ P(S.default) ], t.prototype, "SlotResult", void 0);
i([ P(T.default) ], t.prototype, "SlotWin", void 0);
i([ P(cc.Button) ], t.prototype, "CloseButton", void 0);
i([ P(cc.Button) ], t.prototype, "HelpButton", void 0);
i([ P(cc.Toggle) ], t.prototype, "FastToggle", void 0);
i([ P(cc.Button) ], t.prototype, "AutoButton", void 0);
i([ P(cc.Node) ], t.prototype, "AutoCheck", void 0);
i([ P(cc.Node) ], t.prototype, "AutoSelect", void 0);
i([ P(cc.Label) ], t.prototype, "UserMoney", void 0);
i([ P(cc.Label) ], t.prototype, "WinMoney", void 0);
i([ P(cc.Button) ], t.prototype, "SubButton", void 0);
i([ P(cc.Button) ], t.prototype, "AddButton", void 0);
i([ P(cc.Label) ], t.prototype, "BetMoney", void 0);
return i([ A ], t);
}(cc.Component);
o.default = M;
cc._RF.pop();
}, {
"../../Game/client/global/enum/game/Const": "Const",
"../../Game/client/global/enum/game/Event": "Event",
"../../Game/client/model/LanguageModel": "LanguageModel",
"../../Game/fromework/global/Tools": "Tools",
"../../Game/fromework/helper/AudioHelper": "AudioHelper",
"../../Game/fromework/helper/ConfigHelper": "ConfigHelper",
"../../Game/fromework/helper/EventHelper": "EventHelper",
"../../Game/fromework/helper/UIHelper": "UIHelper",
"../../Game/fromework/mvvm/modelView/ViewModel": "ViewModel",
"../../client/logic/Wallet/WalletHelper": "WalletHelper",
"../../client/model/ItemModel": "ItemModel",
"../../client/model/LobbyModel": "LobbyModel",
"../Common/SlotConst": "SlotConst",
"../Common/SlotModel": "SlotModel",
"../Common/SlotProxy": "SlotProxy",
"./SlotHelp": "SlotHelp",
"./SlotResult": "SlotResult",
"./SlotWin": "SlotWin",
"./TrackManager": "TrackManager"
} ],
SlotWin: [ function(e, t, o) {
"use strict";
cc._RF.push(t, "9e658AEztZBZrpJ8bDRBlWP", "SlotWin");
var n, a = this && this.__extends || (n = function(e, t) {
return (n = Object.setPrototypeOf || {
__proto__: []
} instanceof Array && function(e, t) {
e.__proto__ = t;
} || function(e, t) {
for (var o in t) Object.prototype.hasOwnProperty.call(t, o) && (e[o] = t[o]);
})(e, t);
}, function(e, t) {
n(e, t);
function o() {
this.constructor = e;
}
e.prototype = null === t ? Object.create(t) : (o.prototype = t.prototype, new o());
}), i = this && this.__decorate || function(e, t, o, n) {
var a, i = arguments.length, r = i < 3 ? t : null === n ? n = Object.getOwnPropertyDescriptor(t, o) : n;
if ("object" == typeof Reflect && "function" == typeof Reflect.decorate) r = Reflect.decorate(e, t, o, n); else for (var l = e.length - 1; l >= 0; l--) (a = e[l]) && (r = (i < 3 ? a(r) : i > 3 ? a(t, o, r) : a(t, o)) || r);
return i > 3 && r && Object.defineProperty(t, o, r), r;
};
Object.defineProperty(o, "__esModule", {
value: !0
});
var r = e("../../Game/client/global/enum/game/Const"), l = e("../../Game/client/model/LanguageModel"), s = e("../../Game/fromework/global/ResLoader"), c = e("../../Game/fromework/helper/AudioHelper"), u = e("../Common/SlotProxy"), d = cc._decorator, p = d.ccclass, h = d.property, f = function(e) {
a(t, e);
function t() {
var t = null !== e && e.apply(this, arguments) || this;
t.View = null;
t.WinEffect = null;
t.Money = null;
t.FreeSpin = null;
t.ScatterEffect = null;
t.ScatterCount = null;
t.FreeCount = null;
t.CloseButton = null;
t._callFunc = null;
t._goldAudioIndex = -1;
t._cheerAudioIndex = -1;
return t;
}
t.prototype.init = function() {
var e = this, t = "Slot_200/Skeleton/slot_win_200";
s.default.Instance.loadBundleRes("" + t, sp.SkeletonData, function(o, n) {
o ? console.log("Slot " + u.default.Instance.cls + " load win effect " + t + " failed") : e.WinEffect && e.WinEffect.node && e.WinEffect.node.isValid && n && n.isValid && (e.WinEffect.skeletonData = n);
});
var o = "Slot_200/Skeleton/slot_free_200";
s.default.Instance.loadBundleRes("" + o, sp.SkeletonData, function(t, n) {
t ? console.log("Slot " + u.default.Instance.cls + " load free effect " + o + " failed") : e.ScatterEffect && e.ScatterEffect.node && e.ScatterEffect.node.isValid && n && n.isValid && (e.ScatterEffect.skeletonData = n);
});
};
t.prototype.showWin = function(e, t, o, n) {
var a = this;
this._callFunc = n;
this.View.active = !0;
this.WinEffect.node.active = !0;
this.CloseButton.interactable = !1;
var i = null, s = this.WinEffect.attachUtil;
s.generateAllAttachedNodes();
var u = s.getAttachedNodes("number")[0];
if (u) {
u.destroyAllChildren();
var d = cc.instantiate(this.Money);
d.parent = u;
d.active = !0;
d.setPosition(cc.Vec3.ZERO);
(i = d.getComponent(cc.Label)).string = "";
}
var p = this.getWinEffectName(t);
this.WinEffect.setCompleteListener(function() {
a.WinEffect.setCompleteListener(function() {});
a.WinEffect.setAnimation(0, p.loop, !0);
cc.tween({
a: 0
}).to(2, {
a: o
}, {
progress: function(e, t, o, n) {
if (i && i.isValid) {
var a = (t * n).toFixed(1);
i.string = l.default.getString("MoneySymbol") + a;
}
}
}).call(function() {
i.string = l.default.getString("MoneySymbol") + o;
a.CloseButton.interactable = !0;
}).delay(2).call(function() {
e && a.View.active && a.close();
}).start();
});
if (-1 != this._cheerAudioIndex) {
c.default.Instance.stopEffect(this._cheerAudioIndex);
this._cheerAudioIndex = -1;
}
this._cheerAudioIndex = c.default.Instance.playBundleEffect(r.BundleSoundPath.slot_bigwin_cheer, !1, null, !0);
if (-1 != this._goldAudioIndex) {
c.default.Instance.stopEffect(this._goldAudioIndex);
this._goldAudioIndex = -1;
}
this._goldAudioIndex = c.default.Instance.playBundleEffect(r.BundleSoundPath.slot_bigwin_gold, !1, null, !0);
this.WinEffect.setAnimation(0, p.show, !1);
};
t.prototype.showFree = function(e, t, o, n) {
var a = this;
this._callFunc = n;
this.View.active = !0;
this.FreeSpin.active = !0;
this.CloseButton.interactable = !1;
this.ScatterEffect.setAnimation(0, "free_loop", !0);
this.ScatterCount.string = "X" + t;
this.FreeCount.string = o.toString();
this.FreeSpin.scale = 0;
cc.tween(this.FreeSpin).to(.2, {
scale: 1
}).delay(1).call(function() {
a.CloseButton.interactable = !0;
}).start();
c.default.Instance.playBundleEffect(r.BundleSoundPath.slot_bigwin_cheer);
this.scheduleOnce(function() {
e && a.View.active && a.close();
}, 3);
};
t.prototype.showTotalWin = function(e, t, o) {
var n = this;
this._callFunc = o;
this.View.active = !0;
this.WinEffect.node.active = !0;
this.CloseButton.interactable = !1;
var a = null, i = this.WinEffect.attachUtil;
i.generateAllAttachedNodes();
var s = i.getAttachedNodes("number")[0];
if (s) {
s.destroyAllChildren();
var u = cc.instantiate(this.Money);
u.parent = s;
u.active = !0;
u.setPosition(cc.Vec3.ZERO);
(a = u.getComponent(cc.Label)).string = "";
}
this.WinEffect.setCompleteListener(function() {
n.WinEffect.setCompleteListener(function() {});
n.WinEffect.setAnimation(0, "win_total_loop", !0);
cc.tween({
a: 0
}).to(2, {
a: t
}, {
progress: function(e, t, o, n) {
if (a && a.isValid) {
var i = (t * n).toFixed(1);
a.string = l.default.getString("MoneySymbol") + i;
}
}
}).call(function() {
a.string = l.default.getString("MoneySymbol") + t;
n.CloseButton.interactable = !0;
}).delay(2).call(function() {
e && n.View.active && n.close();
}).start();
});
if (-1 != this._cheerAudioIndex) {
c.default.Instance.stopEffect(this._cheerAudioIndex);
this._cheerAudioIndex = -1;
}
this._cheerAudioIndex = c.default.Instance.playBundleEffect(r.BundleSoundPath.slot_bigwin_cheer, !1, null, !0);
if (-1 != this._goldAudioIndex) {
c.default.Instance.stopEffect(this._goldAudioIndex);
this._goldAudioIndex = -1;
}
this._goldAudioIndex = c.default.Instance.playBundleEffect(r.BundleSoundPath.slot_bigwin_gold, !1, null, !0);
this.WinEffect.setAnimation(0, "win_total", !1);
};
t.prototype.getWinEffectName = function(e) {
var t = {};
if (e >= 3 && e < 4) {
t.show = "win_big";
t.loop = "win_big_loop";
} else if (e >= 4 && e < 10) {
t.show = "win_mega";
t.loop = "win_mega_loop";
} else if (e >= 10) {
t.show = "win_super";
t.loop = "win_super_loop";
}
return t;
};
t.prototype.close = function() {
this.WinEffect.setCompleteListener(function() {});
this.WinEffect.node.active = !1;
this.ScatterEffect.setCompleteListener(function() {});
this.FreeSpin.active = !1;
this.View.active = !1;
if (-1 != this._cheerAudioIndex) {
c.default.Instance.stopEffect(this._cheerAudioIndex);
this._cheerAudioIndex = -1;
}
if (-1 != this._goldAudioIndex) {
c.default.Instance.stopEffect(this._goldAudioIndex);
this._goldAudioIndex = -1;
}
var e = this._callFunc;
this._callFunc = null;
e && e();
};
t.prototype.onCloseClicked = function() {
this.close();
};
i([ h(cc.Node) ], t.prototype, "View", void 0);
i([ h(sp.Skeleton) ], t.prototype, "WinEffect", void 0);
i([ h(cc.Node) ], t.prototype, "Money", void 0);
i([ h(cc.Node) ], t.prototype, "FreeSpin", void 0);
i([ h(sp.Skeleton) ], t.prototype, "ScatterEffect", void 0);
i([ h(cc.Label) ], t.prototype, "ScatterCount", void 0);
i([ h(cc.Label) ], t.prototype, "FreeCount", void 0);
i([ h(cc.Button) ], t.prototype, "CloseButton", void 0);
return i([ p ], t);
}(cc.Component);
o.default = f;
cc._RF.pop();
}, {
"../../Game/client/global/enum/game/Const": "Const",
"../../Game/client/model/LanguageModel": "LanguageModel",
"../../Game/fromework/global/ResLoader": "ResLoader",
"../../Game/fromework/helper/AudioHelper": "AudioHelper",
"../Common/SlotProxy": "SlotProxy"
} ],
Slot: [ function(e, t, o) {
"use strict";
cc._RF.push(t, "3e5bdnUmG1I5rHUme7R06ha", "Slot");
var n, a = this && this.__extends || (n = function(e, t) {
return (n = Object.setPrototypeOf || {
__proto__: []
} instanceof Array && function(e, t) {
e.__proto__ = t;
} || function(e, t) {
for (var o in t) Object.prototype.hasOwnProperty.call(t, o) && (e[o] = t[o]);
})(e, t);
}, function(e, t) {
n(e, t);
function o() {
this.constructor = e;
}
e.prototype = null === t ? Object.create(t) : (o.prototype = t.prototype, new o());
}), i = this && this.__decorate || function(e, t, o, n) {
var a, i = arguments.length, r = i < 3 ? t : null === n ? n = Object.getOwnPropertyDescriptor(t, o) : n;
if ("object" == typeof Reflect && "function" == typeof Reflect.decorate) r = Reflect.decorate(e, t, o, n); else for (var l = e.length - 1; l >= 0; l--) (a = e[l]) && (r = (i < 3 ? a(r) : i > 3 ? a(t, o, r) : a(t, o)) || r);
return i > 3 && r && Object.defineProperty(t, o, r), r;
};
Object.defineProperty(o, "__esModule", {
value: !0
});
var r = e("../../Game/client/global/enum/game/Const"), l = e("../../Game/fromework/global/ResLoader"), s = e("../../Game/fromework/helper/UIHelper"), c = e("../Common/SlotModel"), u = e("../Common/SlotProxy"), d = e("./SlotInfo"), p = cc._decorator, h = p.ccclass, f = p.property, _ = function(e) {
a(t, e);
function t() {
var t = null !== e && e.apply(this, arguments) || this;
t.Background = null;
t.WinEffect = null;
t.Icon = null;
t.Effect = null;
t._cid = 1;
return t;
}
Object.defineProperty(t.prototype, "cid", {
get: function() {
return this._cid;
},
enumerable: !1,
configurable: !0
});
t.prototype.refreshByID = function(e) {
this._cid = e;
this.refreshIcon();
this.refreshSkeleton();
};
t.prototype.playEffect = function() {
this.Icon.node.active = !1;
this.Effect.node.active = !0;
this.WinEffect.active = !0;
};
t.prototype.refreshIcon = function() {
var e = this, t = "Slot_" + u.default.Instance.cls + "/Image/Icon/slot_icon_" + u.default.Instance.cls + "_" + this._cid;
l.default.Instance.loadBundleRes("" + t, cc.SpriteFrame, function(o, n) {
o ? console.log("Slot " + e._cid + " load icon image " + t + " failed") : e.Icon && e.Icon.node && e.Icon.node.isValid && (e.Icon.spriteFrame = n);
});
};
t.prototype.refreshSkeleton = function() {
var e = this, t = "Slot_" + u.default.Instance.cls + "/Skeleton/slot_item_" + u.default.Instance.cls + "_" + this._cid;
l.default.Instance.loadBundleRes("" + t, sp.SkeletonData, function(o, n) {
if (o) console.log("Slot " + e._cid + " load icon skeleton " + t + " failed"); else if (e.Effect && e.Effect.node && e.Effect.node.isValid && n && n.isValid) {
e.Effect.skeletonData = n;
var a = "animation";
if (201 == u.default.Instance.cls) {
a = "dong";
e.Effect.premultipliedAlpha = !1;
}
e.Effect.setAnimation(0, a, !0);
}
});
};
t.prototype.onSlotClicked = function() {
var e = this;
if (!c.default.Instance.isPlaySpin) {
var t = 200 == u.default.Instance.cls ? r.BundleUIPath.SlotInfo : r.BundleUIPath.SlotInfo201;
s.default.Instance.addBundleMaskLayer(t, function(t) {
t.getComponent(d.default).showView(e._cid);
});
}
};
i([ f(cc.Node) ], t.prototype, "Background", void 0);
i([ f(cc.Node) ], t.prototype, "WinEffect", void 0);
i([ f(cc.Sprite) ], t.prototype, "Icon", void 0);
i([ f(sp.Skeleton) ], t.prototype, "Effect", void 0);
return i([ h ], t);
}(cc.Component);
o.default = _;
cc._RF.pop();
}, {
"../../Game/client/global/enum/game/Const": "Const",
"../../Game/fromework/global/ResLoader": "ResLoader",
"../../Game/fromework/helper/UIHelper": "UIHelper",
"../Common/SlotModel": "SlotModel",
"../Common/SlotProxy": "SlotProxy",
"./SlotInfo": "SlotInfo"
} ],
Sort: [ function(e, t, o) {
"use strict";
cc._RF.push(t, "453afRk+ZNNGYL/lEgka43z", "Sort");
var n = this && this.__decorate || function(e, t, o, n) {
var a, i = arguments.length, r = i < 3 ? t : null === n ? n = Object.getOwnPropertyDescriptor(t, o) : n;
if ("object" == typeof Reflect && "function" == typeof Reflect.decorate) r = Reflect.decorate(e, t, o, n); else for (var l = e.length - 1; l >= 0; l--) (a = e[l]) && (r = (i < 3 ? a(r) : i > 3 ? a(t, o, r) : a(t, o)) || r);
return i > 3 && r && Object.defineProperty(t, o, r), r;
};
Object.defineProperty(o, "__esModule", {
value: !0
});
var a = cc._decorator.ccclass, i = function() {
function e() {
this.needMjhandCardsNum = 13;
this.needRealTails = 1;
this.needTails = 2;
this.cardsType = {
no: 0,
realTails: 1,
tails: 2,
sameCards: 3
};
}
t = e;
Object.defineProperty(e, "Instance", {
get: function() {
null == t.instance && (t.instance = new t());
return t.instance;
},
enumerable: !1,
configurable: !0
});
e.prototype.isWildCard = function(e, t) {
return 65 == e || 66 == e || e % 16 == t % 16;
};
e.prototype.getCardsType = function(e, t) {
var o = e.length, n = 0, a = [], i = {}, r = {};
if (o < 3 || o > 9) return this.cardsType.no;
e.sort(function(e, t) {
return e % 16 - t % 16;
});
for (var l = !0, s = !1, c = 0; c < e.length; c++) {
var u = e[c], d = e[c + 1];
d && u + 1 != e[c + 1] && (l = !1);
if (this.isWildCard(u, t)) n++; else {
if (u == d) return this.cardsType.no;
var p = u % 16;
a.push(p);
i[p] = i[p] || 0;
i[p]++;
i[p] >= 2 && (s = !0);
var h = Math.floor(u / 16);
r[h] = r[h] || 0;
r[h]++;
}
}
if (l) return this.cardsType.realTails;
if (s && Object.keys(i).length > 1) return this.cardsType.no;
if (s && o <= 4) return this.cardsType.sameCards;
var f = a.length;
if (f <= 1) return this.cardsType.tails;
if (Object.keys(r).length > 1) return this.cardsType.no;
var _ = 0;
if (2 == f) {
_ = a[1] - a[0] - 1;
if (1 == a[0]) {
var m = 14 - a[1] - 1;
m < _ && (_ = m);
}
} else {
for (c = f - 1; c > 1; c--) _ += a[c] - a[c - 1] - 1;
if (1 == a[0]) {
var y = a[1] - a[0] - 1, g = 14 - a[f - 1] - 1;
_ += y > g ? g : y;
}
}
return _ <= n ? this.cardsType.tails : this.cardsType.no;
};
e.prototype.canWin = function(e, t, o) {
for (var n = {}, a = 0, i = {}, r = 0; r < e.length; r++) {
var l = e[r];
t && l.forEach(function(e) {
i[e] = i[e] || 0;
i[e]++;
});
a += l.length || 0;
var s = this.getCardsType(l, o);
if (s == this.cardsType.no) return !1;
n[s] = n[s] || 0;
n[s]++;
}
if (a != this.needMjhandCardsNum) return !1;
if (t) {
var c = {};
t.forEach(function(e) {
c[e] = c[e] || 0;
c[e]++;
});
for (var u in i) if (c[u] != i[u]) return !1;
}
return !(n[this.cardsType.realTails] < this.needRealTails || n[this.cardsType.realTails] + n[this.cardsType.tails] < this.needTails);
};
e.prototype.getLeft = function(e, t) {
var o = JSON.parse(JSON.stringify(e));
t.forEach(function(e) {
if (Array.isArray(e)) e.forEach(function(e) {
o[e]--;
o[e] || delete o[e];
}); else {
o[e]--;
o[e] || delete o[e];
}
});
return o;
};
e.prototype.getMinScore = function(e, t, o) {
void 0 === o && (o = !1);
for (var n = 99999, a = -1, i = 0; i < e.length; i++) {
var r = e[i][0];
if (o) {
for (var l = 0, s = 1; s < e[i].length; s++) l += e[i][s].length;
if (l + 1 == t) return e[i];
}
if (n > r) {
a = i;
n = r;
}
}
return e[a];
};
e.prototype.getAllObj = function(e) {
for (var t = {}, o = (e = e.sort()).length, n = 0; n < o; n++) {
var a = e[n];
t[a] = t[a] || 0;
t[a]++;
}
return t;
};
e.prototype.findBestGroup = function(e, t, o) {
void 0 === o && (o = !1);
var n = e.slice(), a = this.getAllObj(n), i = this.findRealTails(a), r = i.length;
if (r <= 0) return [ this.calCardsScore(n, t) ];
for (var l = [], s = function(e) {
var o = i[e], n = c.getLeft(a, o), r = c.findTails(n, t);
if (r.length <= 0) {
var s = c.calCardsScore(n, t);
l.push([ s, o ]);
} else r.forEach(function(e) {
l.push([ o, e ]);
});
}, c = this, u = 0; u < r; u++) s(u);
for (u = 0; u < l.length; u++) {
var d = l[u];
if ("number" != typeof d[0]) {
var p = this.getLeft(a, d), h = this.findLeftTailOrSet(p, t);
l[u] = h.concat(d);
}
}
return this.getMinScore(l, n.length, o);
};
e.prototype.calCardsScore = function(e, t) {
var o = 0;
if (e.constructor == Array) for (var n = 0; n < e.length; n++) {
var a = e[n];
this.isWildCard(a, t) || (o += 1 == (r = a % 16) || r > 9 ? 10 : r);
} else if (e.constructor == Object) for (var i in e) {
a = parseInt(i);
if (!this.isWildCard(a, t)) {
var r;
o += 1 == (r = a % 16) || r > 9 ? 10 * e[i] : r * e[i];
}
}
return o;
};
e.prototype.calCardsCombinationScore = function(e, t, o) {
for (var n = [], a = [], i = 0, r = {}, l = 0, s = 0, c = [], u = 0; u < e.length; u++) {
var d = e[u];
n.push(0);
t && d.forEach(function(e) {
r[e] = r[e] || 0;
r[e]++;
});
var p = this.getCardsType(d, o);
i += d.length;
p == this.cardsType.realTails ? l++ : p == this.cardsType.tails && s++;
a.push([ p, d ]);
}
if (i != this.needMjhandCardsNum) return [];
if (t) {
var h = {};
t.forEach(function(e) {
h[e] = h[e] || 0;
h[e]++;
});
for (var f in r) if (h[f] != r[f]) return [];
}
var _ = !1;
l > 0 && l + s > 1 && (_ = !0);
for (u = 0; u < a.length; u++) {
var m = a[u][0];
d = a[u][1];
m == this.cardsType.realTails ? c.push(0) : m != this.cardsType.no && _ ? c.push(0) : c.push(this.calCardsScore(d, o));
}
return c;
};
e.prototype.calLastCardsScore = function(e, t, o) {
var n = this.calCardsCombinationScore(e, t, o);
if (n.length <= 0) return n;
var a = 0;
n.forEach(function(e) {
a += e;
});
return a;
};
e.prototype.findLeftTailOrSet = function(e, t) {
var o = [], n = this.findTails(e, t), a = this.findSets(e, t), i = n.concat(a), r = this;
i.forEach(function(n) {
var a = JSON.parse(JSON.stringify(e));
n.forEach(function(e) {
a[e] && a[e]--;
a[e] || delete a[e];
});
var i = r.findTails(a, t), l = r.findSets(a, t).concat(i);
if (l.length <= 0) {
var s = r.calCardsScore(a, t);
o.push([ s, n ]);
} else l.forEach(function(e) {
var i = JSON.parse(JSON.stringify(a));
e.forEach(function(e) {
i[e] && i[e]--;
i[e] || delete i[e];
});
var l = r.calCardsScore(i, t);
o.push([ l, e, n ]);
});
});
if (0 == o.length) return [ this.calCardsScore(e, t) ];
for (var l = 99999, s = 0, c = 0; c < o.length; c++) {
var u = o[c];
if (l > u[0]) {
l = u[0];
s = c;
}
}
return o[s];
};
e.prototype.findSets = function(e, t) {
var o = JSON.parse(JSON.stringify(e)), n = [], a = 0, i = 0;
for (var r in o) {
if (this.isWildCard(parseInt(r), t)) {
for (var l = 0; l < o[r]; l++) {
n.push(parseInt(r));
a++;
}
delete o[r];
}
i += o[r];
}
if (i < 3) return [];
var s = [];
for (var r in o) {
var c = parseInt(r), u = {
0: 1,
1: 1,
2: 1,
3: 1
}, d = c % 16;
delete u[Math.floor(c / 16)];
var p = [ c ];
for (var h in u) {
var f = 16 * parseInt(h) + d;
if (o[f]) {
p.push(f);
delete o[f];
}
}
var _ = p.length;
4 == _ && s.push(p);
if (3 == _) s.push(p); else if (4 == _) {
s.push([ p[0], p[1], p[2] ]);
s.push([ p[0], p[1], p[3] ]);
s.push([ p[0], p[2], p[3] ]);
s.push([ p[1], p[2], p[3] ]);
}
if (a >= 1) if (2 == _) s.push([ p[0], p[1], n[0] ]); else if (3 == _) {
s.push([ p[0], p[1], n[0] ]);
s.push([ p[0], p[2], n[0] ]);
s.push([ p[1], p[2], n[0] ]);
} else if (4 == _) {
s.push([ p[0], p[1], n[0] ]);
s.push([ p[0], p[2], n[0] ]);
s.push([ p[0], p[3], n[0] ]);
s.push([ p[1], p[2], n[0] ]);
s.push([ p[1], p[3], n[0] ]);
s.push([ p[2], p[3], n[0] ]);
}
if (a >= 2) if (1 == _) s.push([ p[0], n[0], n[1] ]); else if (2 == _) {
s.push([ p[0], n[0], n[1] ]);
s.push([ p[1], n[0], n[1] ]);
} else if (3 == _) {
s.push([ p[0], n[0], n[1] ]);
s.push([ p[1], n[0], n[1] ]);
s.push([ p[2], n[0], n[1] ]);
} else if (4 == _) {
s.push([ p[0], n[0], n[1] ]);
s.push([ p[1], n[0], n[1] ]);
s.push([ p[2], n[0], n[1] ]);
s.push([ p[3], n[0], n[1] ]);
}
}
return s;
};
e.prototype.findTails = function(e, t) {
var o = JSON.parse(JSON.stringify(e)), n = [], a = 0, i = 0;
for (var r in o) {
i += o[r];
if (this.isWildCard(parseInt(r), t)) {
for (var l = 0; l < o[r]; l++) {
n.push(parseInt(r));
a++;
}
delete o[r];
}
}
if (i < 3) return [];
for (var r in o) if (null != o[r]) {
var s = parseInt(r), c = s % 16, u = Math.floor(s / 16);
for (l = 1; l <= a; l++) {
var d = c - l, p = 16 * u + d;
o[p] || (o[p] = 0);
if (d <= 1) break;
}
}
var h = [];
for (var r in o) {
var f = parseInt(r), _ = (u = Math.floor(f / 16), 0);
if (f % 16 <= 12) {
var m = !1;
_ = 16 * u + 13;
var y = 0;
for (l = f; l <= _ && (o[l] || n[y++]); l++) {
l % 16 == 13 && (m = !0);
if (l - f >= 2) {
for (var g = [], v = 0, C = f; C <= l; C++) o[C] ? g.push(C) : g.push(n[v++]);
h.push(g);
}
}
if (m) {
var b = 16 * u + 1, I = 16 * u + 13, E = 0;
g = [];
if (o[b]) {
for (C = f; C <= I; C++) o[C] ? g.push(C) : g.push(n[E++]);
g.push(b);
h.push(g);
} else {
g = [];
for (C = f; C <= I; C++) o[C] ? g.push(C) : g.push(n[E++]);
var S = n[E++];
if (S) {
g.push(S);
h.push(g);
}
}
}
}
}
return h;
};
e.prototype.findRealTails = function(e) {
var t = [];
for (var o in e) {
var n = parseInt(o), a = Math.floor(n / 16), i = 0;
if (n % 16 <= 12) {
var r = !1;
i = 16 * a + 13;
for (var l = n; l <= i && e[l]; l++) {
l % 16 == 13 && (r = !0);
if (l - n >= 2) {
for (var s = [], c = n; c <= l; c++) s.push(c);
t.push(s);
}
}
if (r) {
var u = 16 * a + 1, d = 16 * a + 13;
if (e[u]) {
for (s = [], c = n; c <= d; c++) s.push(c);
s.push(u);
t.push(s);
}
}
}
}
return t;
};
e.prototype.chooseCards = function(e, t) {
var o = this.findBestGroup(e, t);
o.shift();
if (o.length <= 0) return [ e ];
var n = {};
e.forEach(function(e) {
n[e] = n[e] || 0;
n[e]++;
});
o.forEach(function(e) {
e.forEach(function(e) {
n[e] && n[e]--;
n[e] || delete n[e];
});
});
var a = [];
for (var i in n) for (var r = parseInt(i), l = n[i], s = 0; s < l; s++) a.push(r);
o.push(a);
return o;
};
e.prototype.putCard = function(e, t) {
var o = this.findBestGroup(e, t, !0);
if (0 == o.shift()) for (var n = 0; n < o.length; n++) if (o[n].length >= 4) return {
type: 2,
card: o[n].pop(),
lastCards: o
};
var a = [], i = {};
e.forEach(function(e) {
i[e] = i[e] || 0;
i[e]++;
});
o.forEach(function(e) {
e.forEach(function(e) {
i[e] && i[e]--;
i[e] <= 0 && delete i[e];
});
});
var r = {
type: 1,
card: null,
lastCards: o
}, l = [], s = [], c = [];
for (var u in i) {
var d = parseInt(u);
if (i[u] >= 2) {
r.card = d;
return r;
}
for (var p = [ d - 2, d - 1, d + 1, d + 2 ], h = !1, f = 0; f < p.length; f++) if (i[p[f]]) {
h = !0;
break;
}
h || l.push(d);
var _ = d % 16;
p = [ 16 + _, 32 + _, 48 + _, 64 + _ ];
var m = !1;
for (f = 0; f < p.length; f++) if (d != p[f] && i[p[f]]) {
m = !0;
break;
}
m || s.push(d);
m || h || c.push(d);
a.push(d);
}
if (a.length <= 1) {
r.card = a.pop();
r.type = 2;
return r;
}
c.sort(function(e, t) {
return e % 16 - t % 16;
});
if (c.length > 0) {
r.card = c.pop();
return r;
}
var y = l.concat(s);
if (y.length > 0) {
y.sort(function(e, t) {
return e % 16 - t % 16;
});
r.card = y.pop();
return r;
}
a.sort(function(e, t) {
return e % 16 - t % 16;
});
r.card = a.pop();
return r;
};
var t;
e.instance = null;
return t = n([ a ], e);
}();
o.default = i;
cc._RF.pop();
}, {} ],
SplitPrizeItem: [ function(e, t, o) {
"use strict";
cc._RF.push(t, "1ee9aXmOqBHFqOw0XQ+5sEO", "SplitPrizeItem");
var n, a = this && this.__extends || (n = function(e, t) {
return (n = Object.setPrototypeOf || {
__proto__: []
} instanceof Array && function(e, t) {
e.__proto__ = t;
} || function(e, t) {
for (var o in t) Object.prototype.hasOwnProperty.call(t, o) && (e[o] = t[o]);
})(e, t);
}, function(e, t) {
n(e, t);
function o() {
this.constructor = e;
}
e.prototype = null === t ? Object.create(t) : (o.prototype = t.prototype, new o());
}), i = this && this.__decorate || function(e, t, o, n) {
var a, i = arguments.length, r = i < 3 ? t : null === n ? n = Object.getOwnPropertyDescriptor(t, o) : n;
if ("object" == typeof Reflect && "function" == typeof Reflect.decorate) r = Reflect.decorate(e, t, o, n); else for (var l = e.length - 1; l >= 0; l--) (a = e[l]) && (r = (i < 3 ? a(r) : i > 3 ? a(t, o, r) : a(t, o)) || r);
return i > 3 && r && Object.defineProperty(t, o, r), r;
};
Object.defineProperty(o, "__esModule", {
value: !0
});
var r = e("../../../../Game/fromework/global/Tools"), l = e("../../../../Game/client/model/LanguageModel"), s = cc._decorator, c = s.ccclass, u = s.property, d = function(e) {
a(t, e);
function t() {
var t = null !== e && e.apply(this, arguments) || this;
t.UserName = null;
t.Score = null;
t.Drops = null;
t.Amount = null;
t.Accepted = null;
t._data = null;
return t;
}
t.prototype.onItemInitCallFunc = function(e) {
this._data = e;
this.UserName.string = r.Tools.TStr.ellipsisString(this._data.user_name, 12);
this.Score.string = this._data.score + "";
this.Drops.string = this._data.drop + "";
this.Amount.string = this._data.amount + "";
1 == this._data.accepted && (this.Accepted.string = l.default.getString("SPLIT_PRIZE_STATE1"));
2 == this._data.accepted && (this.Accepted.string = l.default.getString("SPLIT_PRIZE_STATE2"));
3 == this._data.accepted && (this.Accepted.string = l.default.getString("SPLIT_PRIZE_STATE3"));
};
t.prototype.onItemEnterCallFunc = function() {
this.node.opacity = 255;
};
t.prototype.onItemExitCallFunc = function() {
this.node.opacity = 0;
};
i([ u(cc.Label) ], t.prototype, "UserName", void 0);
i([ u(cc.Label) ], t.prototype, "Score", void 0);
i([ u(cc.Label) ], t.prototype, "Drops", void 0);
i([ u(cc.Label) ], t.prototype, "Amount", void 0);
i([ u(cc.Label) ], t.prototype, "Accepted", void 0);
return i([ c ], t);
}(cc.Component);
o.default = d;
cc._RF.pop();
}, {
"../../../../Game/client/model/LanguageModel": "LanguageModel",
"../../../../Game/fromework/global/Tools": "Tools"
} ],
SplitPrize: [ function(e, t, o) {
"use strict";
cc._RF.push(t, "661fa0vu3tE/YRDbou3Fint", "SplitPrize");
var n, a = this && this.__extends || (n = function(e, t) {
return (n = Object.setPrototypeOf || {
__proto__: []
} instanceof Array && function(e, t) {
e.__proto__ = t;
} || function(e, t) {
for (var o in t) Object.prototype.hasOwnProperty.call(t, o) && (e[o] = t[o]);
})(e, t);
}, function(e, t) {
n(e, t);
function o() {
this.constructor = e;
}
e.prototype = null === t ? Object.create(t) : (o.prototype = t.prototype, new o());
}), i = this && this.__decorate || function(e, t, o, n) {
var a, i = arguments.length, r = i < 3 ? t : null === n ? n = Object.getOwnPropertyDescriptor(t, o) : n;
if ("object" == typeof Reflect && "function" == typeof Reflect.decorate) r = Reflect.decorate(e, t, o, n); else for (var l = e.length - 1; l >= 0; l--) (a = e[l]) && (r = (i < 3 ? a(r) : i > 3 ? a(t, o, r) : a(t, o)) || r);
return i > 3 && r && Object.defineProperty(t, o, r), r;
};
Object.defineProperty(o, "__esModule", {
value: !0
});
var r = e("../../../../Game/client/logic/game/GameHelper"), l = e("../../../../Game/client/model/LanguageModel"), s = e("../../../../Game/fromework/global/Tools"), c = e("../../../../Game/fromework/mvvm/modelView/ViewModel"), u = e("../../../../fromework/component/listView/ListView"), d = e("../../../model/GameModel"), p = e("../../../model/LobbyModel"), h = cc._decorator, f = h.ccclass, _ = h.property, m = function(e) {
a(t, e);
function t() {
var t = null !== e && e.apply(this, arguments) || this;
t.Title = null;
t.CountDown = null;
t.Tips = null;
t.Buttons = null;
t.ListView = null;
t._countDownTimeId = -1;
t._model = null;
t._callFunc = null;
return t;
}
t.prototype.setCountDown = function(e) {
var t = this;
if (-1 != this._countDownTimeId) {
r.Countdown.deleta(this._countDownTimeId, !1);
this._countDownTimeId = -1;
}
this._countDownTimeId = r.Countdown.creat(e, function(e) {
if (e) {
t._countDownTimeId = -1;
t.close();
}
}, function(e) {
t.CountDown.string = s.Tools.TStr.replaceAll(l.default.getString("END_WAIT1"), "%{num}", e);
}, this);
};
t.prototype._refreshView = function() {
this.setCountDown(this._model.getCountDown());
var e = p.default.Instance.getGamePlay(this._model.roomData.rtype);
this.Title.string = l.default.getString("GAME_BUTTON_SPLITE") + "|" + l.default.getString("COMMON_GAME_ID") + this._model.roomId + "|" + e.name + "#:" + this._model.roomData.round;
var t = this._model.splitDataMap.get(c.VM.getValue("user.uid"));
this.Tips.active = t && 2 == t.accepted;
this.Buttons.active = t && 2 == t.accepted;
var o = [];
this._model.splitDataMap.forEach(function(e) {
o.push(e);
});
this.ListView.datas = o;
};
t.prototype.show = function(e, t) {
this._model = e;
this._callFunc = t;
this._refreshView();
};
t.prototype.close = function() {
if (-1 != this._countDownTimeId) {
r.Countdown.deleta(this._countDownTimeId, !1);
this._countDownTimeId = -1;
}
if (this._callFunc) {
this._callFunc();
this._callFunc = null;
}
this._model = null;
this.node.removeFromParent(!0);
this.node.destroy();
};
t.prototype.onYesClicked = function() {
d.default.Instance.sendSplit(!0);
};
t.prototype.onNoClicked = function() {
d.default.Instance.sendSplit(!1);
};
t.prototype.onCloseBtnClicked = function() {
this.close();
};
t.prototype.onDestroy = function() {
if (-1 != this._countDownTimeId) {
r.Countdown.deleta(this._countDownTimeId, !1);
this._countDownTimeId = -1;
}
};
i([ _(cc.Label) ], t.prototype, "Title", void 0);
i([ _(cc.Label) ], t.prototype, "CountDown", void 0);
i([ _(cc.Node) ], t.prototype, "Tips", void 0);
i([ _(cc.Node) ], t.prototype, "Buttons", void 0);
i([ _(u.default) ], t.prototype, "ListView", void 0);
return i([ f ], t);
}(cc.Component);
o.default = m;
cc._RF.pop();
}, {
"../../../../Game/client/logic/game/GameHelper": "GameHelper",
"../../../../Game/client/model/LanguageModel": "LanguageModel",
"../../../../Game/fromework/global/Tools": "Tools",
"../../../../Game/fromework/mvvm/modelView/ViewModel": "ViewModel",
"../../../../fromework/component/listView/ListView": "ListView",
"../../../model/GameModel": "GameModel",
"../../../model/LobbyModel": "LobbyModel"
} ],
StringFormat: [ function(e, t, o) {
"use strict";
cc._RF.push(t, "3407a1iFb5NEqjoPmZpyQ3/", "StringFormat");
Object.defineProperty(o, "__esModule", {
value: !0
});
o.StringFormatFunction = void 0;
var n = function() {
function e() {}
e.prototype.deal = function(e, t) {
if ("" === t) return e;
var o, n = (t = t.toLowerCase().trim()).match(/^[a-z|A-Z]+/gi), a = t.match(/\d+$/gi), i = "", r = "";
n && (i = n[0]);
a && (o = parseInt(a[0]));
if ("number" == typeof e) switch (i) {
case "int":
r = this.int(e);
break;

case "fix":
r = this.fix(e, o);
break;

case "kmbt":
r = this.KMBT(e);
break;

case "per":
r = this.per(e, o);
break;

case "sep":
r = this.sep(e);
} else {
switch (i) {
case "limit":
r = this.limit(e, o);
}
r = e;
}
return r;
};
e.prototype.sep = function(e) {
return Math.round(e).toString().replace(new RegExp("(\\d)(?=(\\d{3})+$)", "ig"), "$1,");
};
e.prototype.time_m = function() {};
e.prototype.time_s = function() {};
e.prototype.time_ms = function() {};
e.prototype.timeStamp = function(e) {
return new Date(e).toString();
};
e.prototype.per = function(e, t) {
return Math.round(100 * e).toFixed(t);
};
e.prototype.int = function(e) {
return Math.round(e);
};
e.prototype.fix = function(e, t) {
return e.toFixed(t);
};
e.prototype.limit = function(e, t) {
return e.substring(0, t);
};
e.prototype.KMBT = function(e, t) {
void 0 === t && (t = "en");
t;
return this.compressUnit(e, [ 1e3, 1e6, 1e9, 1e12 ], [ "", "K", "M", "B", "T" ], 2);
};
e.prototype.compressUnit = function(e, t, o, n) {
void 0 === n && (n = 2);
var a, i, r = t, l = o;
for (i = 0; i < r.length; i++) if (e < r[i]) {
a = i > 0 ? (e / r[i - 1]).toFixed(n) : e.toFixed(0);
break;
}
return a + l[i];
};
return e;
}();
o.StringFormatFunction = new n();
cc._RF.pop();
}, {} ],
TPHelp_5: [ function(e, t, o) {
"use strict";
cc._RF.push(t, "20978RloiJF0Y6wdLE2xTLB", "TPHelp_5");
var n, a = this && this.__extends || (n = function(e, t) {
return (n = Object.setPrototypeOf || {
__proto__: []
} instanceof Array && function(e, t) {
e.__proto__ = t;
} || function(e, t) {
for (var o in t) Object.prototype.hasOwnProperty.call(t, o) && (e[o] = t[o]);
})(e, t);
}, function(e, t) {
n(e, t);
function o() {
this.constructor = e;
}
e.prototype = null === t ? Object.create(t) : (o.prototype = t.prototype, new o());
}), i = this && this.__decorate || function(e, t, o, n) {
var a, i = arguments.length, r = i < 3 ? t : null === n ? n = Object.getOwnPropertyDescriptor(t, o) : n;
if ("object" == typeof Reflect && "function" == typeof Reflect.decorate) r = Reflect.decorate(e, t, o, n); else for (var l = e.length - 1; l >= 0; l--) (a = e[l]) && (r = (i < 3 ? a(r) : i > 3 ? a(t, o, r) : a(t, o)) || r);
return i > 3 && r && Object.defineProperty(t, o, r), r;
};
Object.defineProperty(o, "__esModule", {
value: !0
});
var r = e("../../../../Game/fromework/helper/UIHelper"), l = e("../../component/Card_tp"), s = [ "1. Trail or Set (three of same rank)", "2. Pure Sequence", "3. Sequence (run)", "4. Color", "5. Pair (two cards of same rank)", "6. High Card" ], c = [ [ [ 1, 17, 33 ], [ 13, 29, 45 ], [ 2, 18, 34 ] ], [ [ 12, 13, 1 ], [ 1, 2, 3 ], [ 2, 3, 4 ] ], [ [ 44, 61, 33 ], [ 1, 18, 35 ], [ 2, 19, 36 ] ], [ [ 1, 4, 7 ], [ 18, 21, 24 ], [ 2, 3, 5 ] ], [ [ 1, 17, 61 ], [ 13, 29, 60 ], [ 2, 18, 51 ] ], [ [ 17, 45, 59 ], [ 1, 45, 26 ], [ 37, 3, 50 ] ] ], u = cc._decorator, d = u.ccclass, p = u.property, h = function(e) {
a(t, e);
function t() {
var t = null !== e && e.apply(this, arguments) || this;
t.Title = null;
t.GroupParent = null;
t.Group = null;
t.Content = null;
return t;
}
t.prototype.onLoad = function() {
for (var e = 0; e < 6; e++) {
var t = cc.instantiate(this.Title), o = t.getChildByName("Title").getComponent(cc.Label);
t.active = !0;
t.parent = this.Content;
o.string = s[e];
var n = cc.instantiate(this.GroupParent);
n.active = !0;
n.parent = this.Content;
for (var a = function(t) {
var o = c[e][t], a = cc.instantiate(i.Group);
a.active = !0;
a.position = cc.Vec3.ZERO;
a.parent = n;
a.children.forEach(function(e, t) {
e.getComponent(l.default).init(o[t], !0);
});
}, i = this, r = 0; r < 3; r++) a(r);
}
};
t.prototype.onCloseClicked = function() {
r.default.Instance.removeMaskLayer(this.node);
};
i([ p(cc.Node) ], t.prototype, "Title", void 0);
i([ p(cc.Node) ], t.prototype, "GroupParent", void 0);
i([ p(cc.Node) ], t.prototype, "Group", void 0);
i([ p(cc.Node) ], t.prototype, "Content", void 0);
return i([ d ], t);
}(cc.Component);
o.default = h;
cc._RF.pop();
}, {
"../../../../Game/fromework/helper/UIHelper": "UIHelper",
"../../component/Card_tp": "Card_tp"
} ],
TPHelp_6_7: [ function(e, t, o) {
"use strict";
cc._RF.push(t, "723ceYjHohClavNHjJ2E81S", "TPHelp_6_7");
var n, a = this && this.__extends || (n = function(e, t) {
return (n = Object.setPrototypeOf || {
__proto__: []
} instanceof Array && function(e, t) {
e.__proto__ = t;
} || function(e, t) {
for (var o in t) Object.prototype.hasOwnProperty.call(t, o) && (e[o] = t[o]);
})(e, t);
}, function(e, t) {
n(e, t);
function o() {
this.constructor = e;
}
e.prototype = null === t ? Object.create(t) : (o.prototype = t.prototype, new o());
}), i = this && this.__decorate || function(e, t, o, n) {
var a, i = arguments.length, r = i < 3 ? t : null === n ? n = Object.getOwnPropertyDescriptor(t, o) : n;
if ("object" == typeof Reflect && "function" == typeof Reflect.decorate) r = Reflect.decorate(e, t, o, n); else for (var l = e.length - 1; l >= 0; l--) (a = e[l]) && (r = (i < 3 ? a(r) : i > 3 ? a(t, o, r) : a(t, o)) || r);
return i > 3 && r && Object.defineProperty(t, o, r), r;
};
Object.defineProperty(o, "__esModule", {
value: !0
});
var r = e("../../../../Game/fromework/helper/UIHelper"), l = cc._decorator, s = l.ccclass, c = (l.property, 
function(e) {
a(t, e);
function t() {
return null !== e && e.apply(this, arguments) || this;
}
t.prototype.onCloseClicked = function() {
r.default.Instance.removeMaskLayer(this.node);
};
return i([ s ], t);
}(cc.Component));
o.default = c;
cc._RF.pop();
}, {
"../../../../Game/fromework/helper/UIHelper": "UIHelper"
} ],
TPRechargeAlertItem: [ function(e, t, o) {
"use strict";
cc._RF.push(t, "c0179nVQcxP9qjWzltc4tSZ", "TPRechargeAlertItem");
var n, a = this && this.__extends || (n = function(e, t) {
return (n = Object.setPrototypeOf || {
__proto__: []
} instanceof Array && function(e, t) {
e.__proto__ = t;
} || function(e, t) {
for (var o in t) Object.prototype.hasOwnProperty.call(t, o) && (e[o] = t[o]);
})(e, t);
}, function(e, t) {
n(e, t);
function o() {
this.constructor = e;
}
e.prototype = null === t ? Object.create(t) : (o.prototype = t.prototype, new o());
}), i = this && this.__decorate || function(e, t, o, n) {
var a, i = arguments.length, r = i < 3 ? t : null === n ? n = Object.getOwnPropertyDescriptor(t, o) : n;
if ("object" == typeof Reflect && "function" == typeof Reflect.decorate) r = Reflect.decorate(e, t, o, n); else for (var l = e.length - 1; l >= 0; l--) (a = e[l]) && (r = (i < 3 ? a(r) : i > 3 ? a(t, o, r) : a(t, o)) || r);
return i > 3 && r && Object.defineProperty(t, o, r), r;
};
Object.defineProperty(o, "__esModule", {
value: !0
});
var r = e("../../../../Game/fromework/helper/EventHelper"), l = cc._decorator, s = l.ccclass, c = l.property, u = function(e) {
a(t, e);
function t() {
var t = null !== e && e.apply(this, arguments) || this;
t.Deposit = null;
t.Bonus = null;
t.PayNum = null;
t._data = null;
return t;
}
t.prototype.refreshView = function(e) {
this._data = e;
this.Deposit.string = (this._data.deposit > 0 ? this._data.deposit + this._data.amount : this._data.amount).toString();
this.Bonus.string = (this._data.bonus > 0 ? this._data.bonus + this._data.amount : 0).toString();
this.PayNum.string = this._data.amount.toString();
};
t.prototype.onPayClicked = function() {
r.default.Instance.Global.emit("TEENPATTI_ALERT_CLICKED", this._data);
};
i([ c(cc.Label) ], t.prototype, "Deposit", void 0);
i([ c(cc.Label) ], t.prototype, "Bonus", void 0);
i([ c(cc.Label) ], t.prototype, "PayNum", void 0);
return i([ s ], t);
}(cc.Component);
o.default = u;
cc._RF.pop();
}, {
"../../../../Game/fromework/helper/EventHelper": "EventHelper"
} ],
TPRechargeAlert: [ function(e, t, o) {
"use strict";
cc._RF.push(t, "c0f21LdLmdHCJEyFts+p+bO", "TPRechargeAlert");
var n, a = this && this.__extends || (n = function(e, t) {
return (n = Object.setPrototypeOf || {
__proto__: []
} instanceof Array && function(e, t) {
e.__proto__ = t;
} || function(e, t) {
for (var o in t) Object.prototype.hasOwnProperty.call(t, o) && (e[o] = t[o]);
})(e, t);
}, function(e, t) {
n(e, t);
function o() {
this.constructor = e;
}
e.prototype = null === t ? Object.create(t) : (o.prototype = t.prototype, new o());
}), i = this && this.__decorate || function(e, t, o, n) {
var a, i = arguments.length, r = i < 3 ? t : null === n ? n = Object.getOwnPropertyDescriptor(t, o) : n;
if ("object" == typeof Reflect && "function" == typeof Reflect.decorate) r = Reflect.decorate(e, t, o, n); else for (var l = e.length - 1; l >= 0; l--) (a = e[l]) && (r = (i < 3 ? a(r) : i > 3 ? a(t, o, r) : a(t, o)) || r);
return i > 3 && r && Object.defineProperty(t, o, r), r;
};
Object.defineProperty(o, "__esModule", {
value: !0
});
var r = e("../../../logic/Wallet/WalletHelper"), l = e("../../../../Game/client/model/LanguageModel"), s = e("../../../model/WalletModel"), c = e("./TPRechargeAlertItem"), u = e("../../../../Game/client/model/CommonModel"), d = e("../../../../Game/fromework/helper/EventHelper"), p = e("../../../../Game/fromework/helper/UIHelper"), h = e("../../../global/PopHelper"), f = cc._decorator, _ = f.ccclass, m = f.property, y = function(e) {
a(t, e);
function t() {
var t = null !== e && e.apply(this, arguments) || this;
t.SmallGear = null;
t.BigGear = null;
t._activityData = null;
t._callFunc = null;
return t;
}
t.prototype.onLoad = function() {
d.default.Instance.Global.bind("TEENPATTI_ALERT_CLICKED", this.onItemClicked, this);
};
t.prototype.onDestroy = function() {
d.default.Instance.Global.unbind("TEENPATTI_ALERT_CLICKED", this.onItemClicked, this);
};
t.prototype.showAlert = function(e, t) {
this._callFunc = t;
var o = s.WalletProxy.Instance.rechargeGear.concat();
o.sort(function(e, t) {
return e - t;
});
for (var n = o[0], a = o[o.length - 1], i = Math.min(Math.max(200, 500 * e), a), r = n, l = n, c = 0; c < o.length; c++) if (o[c] >= i) {
r = o[c];
l = null != o[c + 1] ? o[c + 1] : o[c];
break;
}
this._activityData = s.WalletProxy.Instance.activityList[0];
if (r == l) {
var d = new u.Common.AddCashData();
if (null != this._activityData) {
var p = s.WalletProxy.Instance.getRechargeAmountRate(this._activityData.id, r);
d.amount = r;
d.deposit = p.deposit;
d.bonus = p.bonus;
} else {
d.amount = r;
d.deposit = 0;
d.bonus = 0;
}
this.BigGear.node.active = !1;
this.SmallGear.refreshView(d);
} else {
d = new u.Common.AddCashData();
if (null != this._activityData) {
p = s.WalletProxy.Instance.getRechargeAmountRate(this._activityData.id, r);
d.amount = r;
d.deposit = p.deposit;
d.bonus = p.bonus;
} else {
d.amount = r;
d.deposit = 0;
d.bonus = 0;
}
this.SmallGear.refreshView(d);
var h = new u.Common.AddCashData();
if (null != this._activityData) {
p = s.WalletProxy.Instance.getRechargeAmountRate(this._activityData.id, l);
h.amount = l;
h.deposit = p.deposit;
h.bonus = p.bonus;
} else {
h.amount = l;
h.deposit = 0;
h.bonus = 0;
}
this.BigGear.node.active = !0;
this.BigGear.refreshView(h);
}
};
t.prototype.onItemClicked = function(e) {
var t = this, o = e.getUserData();
if (o) {
var n = o.amount, a = this._activityData ? this._activityData.id : 0;
s.WalletProxy.Instance.sendPayment(n, a, o.deposit, o.bonus, function(e) {
var o = JSON.parse(e.response);
r.default.Instance.onPayment(o);
if (1 == o.code) {
t._callFunc && t._callFunc();
t.onCloseClicked();
}
});
} else h.PopHelper.Instance.showTips(l.default.getString("RECHARGE_INPUT_TIPS1"));
};
t.prototype.onCloseClicked = function() {
p.default.Instance.removeMaskLayer(this.node, !0);
};
i([ m(c.default) ], t.prototype, "SmallGear", void 0);
i([ m(c.default) ], t.prototype, "BigGear", void 0);
return i([ _ ], t);
}(cc.Component);
o.default = y;
cc._RF.pop();
}, {
"../../../../Game/client/model/CommonModel": "CommonModel",
"../../../../Game/client/model/LanguageModel": "LanguageModel",
"../../../../Game/fromework/helper/EventHelper": "EventHelper",
"../../../../Game/fromework/helper/UIHelper": "UIHelper",
"../../../global/PopHelper": "PopHelper",
"../../../logic/Wallet/WalletHelper": "WalletHelper",
"../../../model/WalletModel": "WalletModel",
"./TPRechargeAlertItem": "TPRechargeAlertItem"
} ],
TPWarDealer: [ function(e, t, o) {
"use strict";
cc._RF.push(t, "a1bc1NgNs9BQKxaq47wpuDZ", "TPWarDealer");
var n, a = this && this.__extends || (n = function(e, t) {
return (n = Object.setPrototypeOf || {
__proto__: []
} instanceof Array && function(e, t) {
e.__proto__ = t;
} || function(e, t) {
for (var o in t) Object.prototype.hasOwnProperty.call(t, o) && (e[o] = t[o]);
})(e, t);
}, function(e, t) {
n(e, t);
function o() {
this.constructor = e;
}
e.prototype = null === t ? Object.create(t) : (o.prototype = t.prototype, new o());
}), i = this && this.__decorate || function(e, t, o, n) {
var a, i = arguments.length, r = i < 3 ? t : null === n ? n = Object.getOwnPropertyDescriptor(t, o) : n;
if ("object" == typeof Reflect && "function" == typeof Reflect.decorate) r = Reflect.decorate(e, t, o, n); else for (var l = e.length - 1; l >= 0; l--) (a = e[l]) && (r = (i < 3 ? a(r) : i > 3 ? a(t, o, r) : a(t, o)) || r);
return i > 3 && r && Object.defineProperty(t, o, r), r;
};
Object.defineProperty(o, "__esModule", {
value: !0
});
var r = e("../../../Game/client/global/enum/game/Const"), l = e("../../../Game/client/global/enum/game/Event"), s = e("../../../Game/fromework/global/ResLoader"), c = e("../../../Game/fromework/helper/AudioHelper"), u = e("../../../Game/fromework/helper/EventHelper"), d = e("../../../platform/Platform"), p = e("../../Common/Component/CompositeCard"), h = e("../../Common/Utils/CompositeEvent"), f = e("../../Common/Utils/CompositeUtil"), _ = cc._decorator, m = _.ccclass, y = _.property, g = function(e) {
a(t, e);
function t() {
var t = null !== e && e.apply(this, arguments) || this;
t.QueenCards = null;
t.KingCards = null;
t.IconVS = null;
t.KingWin = null;
t.QueenWin = null;
t._queenCards = [];
t._kingCards = [];
return t;
}
t.prototype.onEnable = function() {
u.default.Instance.Global.bind(h.CompositeGameEvent.GAME_RECONNECT, this.onReconnect, this);
u.default.Instance.Global.bind(l.GameEvent.S2C_AB_DEAL, this.onDealerCard, this);
u.default.Instance.Global.bind(h.CompositeGameEvent.UI_EFFECT_START_BET, this.onStartBet, this);
u.default.Instance.Global.bind(h.CompositeGameEvent.UI_EFFECT_STOP_BET, this.onStopBet, this);
u.default.Instance.Global.bind(l.GameEvent.S2C_AB_SHOW, this.onShowCard, this);
u.default.Instance.Global.bind(l.GameEvent.S2C_RESET, this.onReset, this);
};
t.prototype.onDisable = function() {
u.default.Instance.Global.unbind(h.CompositeGameEvent.GAME_RECONNECT, this.onReconnect, this);
u.default.Instance.Global.unbind(l.GameEvent.S2C_AB_DEAL, this.onDealerCard, this);
u.default.Instance.Global.unbind(l.GameEvent.S2C_AB_SHOW, this.onShowCard, this);
u.default.Instance.Global.unbind(l.GameEvent.S2C_RESET, this.onReset, this);
};
t.prototype.onLoad = function() {
cc.game.on(cc.game.EVENT_SHOW, this._onReset, this);
};
t.prototype.onDestroy = function() {
this.unscheduleAllCallbacks();
cc.game.off(cc.game.EVENT_SHOW, this._onReset, this);
};
t.prototype._onReset = function() {
this._queenCards.forEach(function(e) {
e && e.node && e.node.isValid && e.node.stopAllActions();
});
this._kingCards.forEach(function(e) {
e && e.node && e.node.isValid && e.node.stopAllActions();
});
this.QueenCards.stopAllActions();
this.QueenCards.destroyAllChildren();
this.KingCards.stopAllActions();
this.KingCards.destroyAllChildren();
this._queenCards.length = 0;
this._kingCards.length = 0;
};
t.prototype.createCard = function(e, t) {
var o = this;
this._onReset();
s.default.Instance.loadBundleRes(r.BundleUIPath.CompositeCard, cc.Prefab, function(n, a) {
if (n) d.default.log("TPWarDealer Can Not Load CompositeCard!"); else {
for (var i = 2; i >= 0; i--) {
var r = cc.instantiate(a);
r.scale = .51;
r.active = t;
r.parent = o.QueenCards;
var l = .51 * r.width / 2 + 82 * i;
d.default.log("TP:" + l);
r.setPosition(cc.v3(-l, 0, 0));
var s = r.getComponent(p.default);
s.init(0, !1);
o._queenCards.push(s);
}
for (i = 0; i < 3; i++) {
var c = cc.instantiate(a);
c.scale = .51;
c.active = t;
c.parent = o.KingCards;
l = .51 * c.width / 2 + 82 * i;
c.setPosition(cc.v3(l, 0, 0));
var u = c.getComponent(p.default);
u.init(0, !1);
o._kingCards.push(u);
}
e && e();
}
});
};
t.prototype.onReconnect = function() {
var e = this, t = f.default.Game.Model;
this._onReset();
this.IconVS.opacity = 2 != t.roomData.state ? 255 : 0;
if (1 == t.roomData.state || 2 == t.roomData.state) this.createCard(function() {}, !0); else if (3 == t.roomData.state) {
this.createCard(function() {
e._queenCards.forEach(function(e, o) {
e.init(null != t.show_card[0][o] ? t.show_card[0][o] : 0, null != t.show_card[0][o]);
});
e._kingCards.forEach(function(e, o) {
e.init(null != t.show_card[1][o] ? t.show_card[1][o] : 0, null != t.show_card[1][o]);
});
}, !0);
u.default.Instance.Global.emit(h.OddsEvent.ODDS_RECYCLING);
}
};
t.prototype.onStartBet = function() {
this.IconVS.runAction(cc.fadeOut(.1));
};
t.prototype.onStopBet = function() {
this.IconVS.runAction(cc.fadeIn(.1));
};
t.prototype.onDealerCard = function() {
var e = this, t = (f.default.Game.Model, function() {
e._queenCards.forEach(function(e) {
var t = e.node.position;
e.node.position = cc.v3(t.x + 50, t.y, t.x);
e.node.opacity = 0;
e.node.active = !0;
cc.tween(e.node).to(.2, {
position: t,
opacity: 255
}).call(function() {
c.default.Instance.playBundleEffect(r.BundleSoundPath.common_draw);
}).start();
});
e._kingCards.forEach(function(t, o) {
var n = t.node.position;
t.node.position = cc.v3(n.x - 50, n.y, n.x);
t.node.opacity = 0;
t.node.active = !0;
cc.tween(t.node).to(.2, {
position: n,
opacity: 255
}).call(function() {
c.default.Instance.playBundleEffect(r.BundleSoundPath.common_draw);
o == e._kingCards.length - 1 && u.default.Instance.Global.emit(h.CompositeUIEvent.UI_PLAY_START_BET);
}).start();
});
}), o = 0 == this._queenCards.length || 0 == this._kingCards.length;
this._queenCards.forEach(function(e) {
e && e.node && e.node.isValid || (o = !0);
});
this._kingCards.forEach(function(e) {
e && e.node && e.node.isValid || (o = !0);
});
o ? this.createCard(function() {
t();
}, !1) : t();
};
t.prototype.playWinEffect = function() {
var e = this;
if (this && this.node && this.node.isValid) {
var t = f.default.Game.Model.win_options;
cc.tween(this.node).delay(.4).call(function() {
var o = -1 != t.indexOf(0) ? 0 : 1;
0 == o ? e.KingWin.active = !0 : 1 == o && (e.QueenWin.active = !0);
u.default.Instance.Global.emit(h.OddsEvent.ODDS_SHOW_WIN);
}).delay(2.5).call(function() {
e.KingWin.active = !1;
e.QueenWin.active = !1;
u.default.Instance.Global.emit(h.OddsEvent.ODDS_RECYCLING);
}).start();
}
};
t.prototype.onShowCard = function() {
var e = this, t = f.default.Game.Model, o = function(e, t, o, n) {
e.node.active = !0;
e.node.opacity = 255;
e.init(t, !1);
e.flipCard(o, cc.v3(0, -180, 0), !1, function() {
n && n();
});
c.default.Instance.playBundleEffect(r.BundleSoundPath.common_discard);
}, n = function() {
var n = cc.tween().call(function() {
e && e._queenCards && e._kingCards[0] && e._kingCards[0].isValid && t && t.show_card && t.show_card[1] && t.show_card[1][0] && o(e._kingCards[0], t.show_card[1][0], .4);
e && e._queenCards && e._kingCards[1] && e._kingCards[1].isValid && t && t.show_card && t.show_card[1] && t.show_card[1][1] && o(e._kingCards[1], t.show_card[1][1], .4);
}), a = cc.tween().call(function() {
e && e._queenCards && e._kingCards[2] && e._kingCards[2].isValid && t && t.show_card && t.show_card[1] && t.show_card[1][2] ? o(e._kingCards[2], t.show_card[1][2], .6, function() {
e.playWinEffect();
}) : e.playWinEffect();
});
cc.tween(e.node).then(n).delay(1).then(a).start();
}, a = function() {
var n = cc.tween().call(function() {
e && e._queenCards && e._queenCards[0] && e._queenCards[0].isValid && t && t.show_card && t.show_card[0] && t.show_card[0][0] && o(e._queenCards[0], t.show_card[0][0], .4);
e && e._queenCards && e._queenCards[1] && e._queenCards[1].isValid && t && t.show_card && t.show_card[0] && t.show_card[0][1] && o(e._queenCards[1], t.show_card[0][1], .4);
}), a = cc.tween().call(function() {
e && e._queenCards && e._queenCards[2] && e._queenCards[2].isValid && t && t.show_card && t.show_card[0] && t.show_card[0][2] && o(e._queenCards[2], t.show_card[0][2], .6);
});
cc.tween(e.node).then(n).delay(1).then(a).start();
}, i = 0 == this._queenCards.length || 0 == this._kingCards.length;
this._queenCards.forEach(function(e) {
e && e.node && e.node.isValid || (i = !0);
});
this._kingCards.forEach(function(e) {
e && e.node && e.node.isValid || (i = !0);
});
if (i) this.createCard(function() {
a();
n();
}, !1); else {
a();
n();
}
};
t.prototype.onReset = function() {
var e = this;
this._queenCards.forEach(function(t, o) {
if (t && t.node && t.node.isValid) {
var n = t.node.position;
cc.tween(t.node).to(.2, {
position: cc.v3(n.x + 50, n.y, n.x),
opacity: 0
}).call(function() {
c.default.Instance.playBundleEffect(r.BundleSoundPath.common_draw);
o == e._queenCards.length - 1 && (e._queenCards.length = 0);
}).start();
}
});
this._kingCards.forEach(function(t, o) {
if (t && t.node && t.node.isValid) {
var n = t.node.position;
cc.tween(t.node).to(.2, {
position: cc.v3(n.x - 50, n.y, n.x),
opacity: 0
}).call(function() {
c.default.Instance.playBundleEffect(r.BundleSoundPath.common_draw);
o == e._kingCards.length - 1 && (e._kingCards.length = 0);
}).start();
}
});
};
i([ y(cc.Node) ], t.prototype, "QueenCards", void 0);
i([ y(cc.Node) ], t.prototype, "KingCards", void 0);
i([ y(cc.Node) ], t.prototype, "IconVS", void 0);
i([ y(cc.Node) ], t.prototype, "KingWin", void 0);
i([ y(cc.Node) ], t.prototype, "QueenWin", void 0);
return i([ m ], t);
}(cc.Component);
o.default = g;
cc._RF.pop();
}, {
"../../../Game/client/global/enum/game/Const": "Const",
"../../../Game/client/global/enum/game/Event": "Event",
"../../../Game/fromework/global/ResLoader": "ResLoader",
"../../../Game/fromework/helper/AudioHelper": "AudioHelper",
"../../../Game/fromework/helper/EventHelper": "EventHelper",
"../../../platform/Platform": "Platform",
"../../Common/Component/CompositeCard": "CompositeCard",
"../../Common/Utils/CompositeEvent": "CompositeEvent",
"../../Common/Utils/CompositeUtil": "CompositeUtil"
} ],
TPWarHelp: [ function(e, t, o) {
"use strict";
cc._RF.push(t, "f4711xuul9DJIoIDo/jvDrz", "TPWarHelp");
var n, a = this && this.__extends || (n = function(e, t) {
return (n = Object.setPrototypeOf || {
__proto__: []
} instanceof Array && function(e, t) {
e.__proto__ = t;
} || function(e, t) {
for (var o in t) Object.prototype.hasOwnProperty.call(t, o) && (e[o] = t[o]);
})(e, t);
}, function(e, t) {
n(e, t);
function o() {
this.constructor = e;
}
e.prototype = null === t ? Object.create(t) : (o.prototype = t.prototype, new o());
}), i = this && this.__decorate || function(e, t, o, n) {
var a, i = arguments.length, r = i < 3 ? t : null === n ? n = Object.getOwnPropertyDescriptor(t, o) : n;
if ("object" == typeof Reflect && "function" == typeof Reflect.decorate) r = Reflect.decorate(e, t, o, n); else for (var l = e.length - 1; l >= 0; l--) (a = e[l]) && (r = (i < 3 ? a(r) : i > 3 ? a(t, o, r) : a(t, o)) || r);
return i > 3 && r && Object.defineProperty(t, o, r), r;
};
Object.defineProperty(o, "__esModule", {
value: !0
});
var r = e("../../Common/Utils/CompositeUtil"), l = cc._decorator, s = l.ccclass, c = l.property, u = function(e) {
a(t, e);
function t() {
var t = null !== e && e.apply(this, arguments) || this;
t.RateAry = [];
return t;
}
t.prototype.onLoad = function() {
for (var e = r.default.Game.Model, t = 0; t < this.RateAry.length; t++) this.RateAry[t].string = "Win = bet*" + e.bet_options[t].x;
};
i([ c([ cc.Label ]) ], t.prototype, "RateAry", void 0);
return i([ s ], t);
}(cc.Component);
o.default = u;
cc._RF.pop();
}, {
"../../Common/Utils/CompositeUtil": "CompositeUtil"
} ],
TPWarModel: [ function(e, t, o) {
"use strict";
cc._RF.push(t, "e08898dIg5DSJaTqT444LpC", "TPWarModel");
var n, a = this && this.__extends || (n = function(e, t) {
return (n = Object.setPrototypeOf || {
__proto__: []
} instanceof Array && function(e, t) {
e.__proto__ = t;
} || function(e, t) {
for (var o in t) Object.prototype.hasOwnProperty.call(t, o) && (e[o] = t[o]);
})(e, t);
}, function(e, t) {
n(e, t);
function o() {
this.constructor = e;
}
e.prototype = null === t ? Object.create(t) : (o.prototype = t.prototype, new o());
});
Object.defineProperty(o, "__esModule", {
value: !0
});
o.TPWarModel = void 0;
var i = e("../../../Game/client/global/enum/game/Event"), r = e("../../../Game/client/global/enum/game/Game"), l = e("../../../Game/client/global/enum/net/C2S"), s = e("../../../Game/client/global/enum/net/S2C"), c = e("../../../client/logic/game/HearBeat"), u = e("../../../client/model/ErrorModel"), d = e("../../../Game/fromework/global/Tools"), p = e("../../../Game/fromework/helper/EventHelper"), h = e("../../../fromework/helper/NetHelper"), f = e("../../../Game/fromework/mvvm/modelView/ViewModel"), _ = e("../../Common/Utils/CompositeProxy"), m = e("./TPWarStruct"), y = function(e) {
a(t, e);
function t() {
var t = null !== e && e.apply(this, arguments) || this;
t.declearHistory = new m.TPWarStruct.DeclearHistory();
t.bet_fee_currency = [];
t.bet_options = [];
t.real_win_options = [];
return t;
}
Object.defineProperty(t, "Instance", {
get: function() {
t._instance || (t._instance = new t());
return t._instance;
},
enumerable: !1,
configurable: !0
});
t.prototype.clear = function() {
null != t._instance && (t._instance = null);
};
t.prototype.getCompensationCash = function() {
for (var e = new Map(), t = 0; t < this.win_options.length; t++) {
var o = this.roomBetRecord[this.win_options[t]];
if (0 != o.amount) {
var n = this.bet_options[this.win_options[t]];
e.set(this.win_options[t], o.amount * (n.x - 1));
}
}
return e;
};
t.prototype.getWinFee = function(e) {
var t = new Map();
if (this.declearData.user_data.has(String(e))) for (var o = this.declearData.user_data.get(String(e)), n = 0; n < o.bet_record.length; n++) {
var a = o.bet_record[n];
if (0 != a.amount) {
var i = t.has(n) ? t.get(n) : 0, r = this.bet_options[n];
t.set(n, i + a.amount * r.x);
}
}
return t;
};
t._instance = null;
return t;
}(_.CompositeModel);
o.TPWarModel = y;
var g = function(e) {
a(t, e);
function t() {
return null !== e && e.apply(this, arguments) || this;
}
Object.defineProperty(t, "Instance", {
get: function() {
t._instance || (t._instance = new t());
return t._instance;
},
enumerable: !1,
configurable: !0
});
t.prototype.Init = function() {
p.default.Instance.Net.bind(s.S2C.GAME.ROOM_ENTER_ROOM, this._onEnterRoom, this);
p.default.Instance.Net.bind(s.S2C.GAME.ROOM_SWITCH_ROOM, this._onSwitchRoom, this);
p.default.Instance.Net.bind(s.S2C.GAME.ROOM_DEAL, this._onDeal, this);
p.default.Instance.Net.bind(s.S2C.GAME.ROOM_START_BET, this._onStartBet, this);
p.default.Instance.Net.bind(s.S2C.GAME.ROOM_BET, this._onBet, this);
p.default.Instance.Net.bind(s.S2C.GAME.ROOM_BET_BATCH, this._onBetBatch, this);
p.default.Instance.Net.bind(s.S2C.GAME.ROOM_STOP_BET, this._onStopBet, this);
p.default.Instance.Net.bind(s.S2C.GAME.ROOM_SHOW, this._onShow, this);
p.default.Instance.Net.bind(s.S2C.GAME.ROOM_RESET_ROOM, this._onResetRoom, this);
p.default.Instance.Net.bind(s.S2C.GAME.ROOM_INTERACT, this._onInteract, this);
p.default.Instance.Net.bind(s.S2C.GAME.ROOM_RANK, this._onRank, this);
p.default.Instance.Net.bind(s.S2C.GAME.ROOM_LEAVE, this._onLeave, this);
p.default.Instance.Net.bind(s.S2C.GAME.ROOM_LEAVE_SINGLE, this._onLeaveSingle, this);
p.default.Instance.Net.bind(s.S2C.GAME.ROOM_DISMISS, this._onDismiss, this);
p.default.Instance.Net.bind(s.S2C.GAME.ROOM_SEND_AVAILABLE_BALANCE, this._onBalanceRefresh, this);
p.default.Instance.Global.bind(h.NetState.NET_WEBSOCKET_CONNECT_OPEN, this._onWsContented, this);
};
t.prototype.destory = function() {
p.default.Instance.Net.unbind(s.S2C.GAME.ROOM_ENTER_ROOM, this._onEnterRoom, this);
p.default.Instance.Net.unbind(s.S2C.GAME.ROOM_SWITCH_ROOM, this._onSwitchRoom, this);
p.default.Instance.Net.unbind(s.S2C.GAME.ROOM_DEAL, this._onDeal, this);
p.default.Instance.Net.unbind(s.S2C.GAME.ROOM_START_BET, this._onStartBet, this);
p.default.Instance.Net.unbind(s.S2C.GAME.ROOM_BET, this._onBet, this);
p.default.Instance.Net.unbind(s.S2C.GAME.ROOM_BET_BATCH, this._onBetBatch, this);
p.default.Instance.Net.unbind(s.S2C.GAME.ROOM_STOP_BET, this._onStopBet, this);
p.default.Instance.Net.unbind(s.S2C.GAME.ROOM_SHOW, this._onShow, this);
p.default.Instance.Net.unbind(s.S2C.GAME.ROOM_RESET_ROOM, this._onResetRoom, this);
p.default.Instance.Net.unbind(s.S2C.GAME.ROOM_INTERACT, this._onInteract, this);
p.default.Instance.Net.unbind(s.S2C.GAME.ROOM_RANK, this._onRank, this);
p.default.Instance.Net.unbind(s.S2C.GAME.ROOM_LEAVE, this._onLeave, this);
p.default.Instance.Net.unbind(s.S2C.GAME.ROOM_LEAVE_SINGLE, this._onLeaveSingle, this);
p.default.Instance.Net.unbind(s.S2C.GAME.ROOM_DISMISS, this._onDismiss, this);
p.default.Instance.Net.unbind(s.S2C.GAME.ROOM_SEND_AVAILABLE_BALANCE, this._onBalanceRefresh, this);
p.default.Instance.Global.unbind(h.NetState.NET_WEBSOCKET_CONNECT_OPEN, this._onWsContented, this);
};
t.prototype.clear = function() {};
t.prototype._onWsContented = function() {
c.default.Instance.begin();
var e = f.VM.getValue("lobby.roomID");
0 != e && this.sendEnterRoom(e);
};
Object.defineProperty(t.prototype, "roomID", {
get: function() {
return f.VM.getValue("lobby.roomID");
},
enumerable: !1,
configurable: !0
});
t.prototype.checkRoomID = function(e) {
return f.VM.getValue("lobby.roomID") == e;
};
t.prototype.checkRoomType = function(e) {
var t = e.split("_"), o = -1;
null != t && null != t[0] && (o = parseInt(t[0]));
return o == r.GameEnum.PlayType.GAME_TP_WAR;
};
t.prototype._onEnterRoom = function(t) {
var o = t.getUserData();
if (this.checkRoomID(o.rid)) {
var n = y.Instance;
if (null != o.user_data && o.uid == this.uid) {
n.bet_fee_currency = o.bet_fee_currency;
n.bet_options = o.bet_options;
n.declearHistory.refresh(o.declear_history);
}
e.prototype._onEnterRoom.call(this, o, n);
}
};
t.prototype._onSwitchRoom = function(e) {
var t = e.getUserData();
if (this.checkRoomType(t.room_type)) {
f.VM.getValue("lobby.roomID") != t.r && f.VM.setValue("lobby.roomID", parseInt(t.r));
p.default.Instance.Global.emit(i.GameEvent.S2C_SWITCH_ROOM, t.r);
}
};
t.prototype._onDeal = function(t) {
var o = t.getUserData();
if (this.checkRoomID(o.rid)) {
var n = y.Instance;
e.prototype._onDeal.call(this, o, n);
}
};
t.prototype._onStartBet = function(t) {
var o = t.getUserData();
if (this.checkRoomID(o.rid)) {
var n = y.Instance;
e.prototype._onStartBet.call(this, o, n);
}
};
t.prototype._onBet = function(t) {
var o = t.getUserData();
if (this.checkRoomID(o.rid)) {
var n = y.Instance;
e.prototype._onBet.call(this, o, n);
}
};
t.prototype._onBetBatch = function(t) {
var o = t.getUserData();
if (this.checkRoomID(o.rid)) {
var n = y.Instance;
e.prototype._onBetBatch.call(this, o, n);
}
};
t.prototype._onStopBet = function(t) {
var o = t.getUserData();
if (this.checkRoomID(o.rid)) {
var n = y.Instance;
e.prototype._onStopBet.call(this, o, n);
}
};
t.prototype._onShow = function(t) {
var o = t.getUserData();
if (this.checkRoomID(o.rid)) {
var n = y.Instance, a = new m.TPWarStruct.HistoryData({
d: o.room_data.show_card,
w: o.win_options
});
n.declearHistory.addHistory(a);
n.real_win_options = o.real_win_options;
e.prototype._onShow.call(this, o, n);
}
};
t.prototype._onResetRoom = function(t) {
var o = t.getUserData();
if (this.checkRoomID(o.rid)) {
var n = y.Instance;
e.prototype._onResetRoom.call(this, o, n);
}
};
t.prototype._onInteract = function(t) {
var o = t.getUserData();
if (this.checkRoomID(o.rid)) {
var n = y.Instance;
e.prototype._onInteract.call(this, o, n);
}
};
t.prototype._onRank = function(t) {
var o = t.getUserData();
if (this.checkRoomID(o.rid)) {
var n = y.Instance;
e.prototype._onRank.call(this, o, n);
}
};
t.prototype._onLeave = function(t) {
var o = t.getUserData();
if (this.checkRoomID(o.rid)) {
var n = y.Instance;
e.prototype._onLeave.call(this, o, n);
}
};
t.prototype._onLeaveSingle = function(t) {
var o = t.getUserData();
if (this.checkRoomID(o.rid) || 0 == f.VM.getValue("lobby.roomID")) {
var n = y.Instance;
e.prototype._onLeaveSingle.call(this, o, n);
}
};
t.prototype._onDismiss = function(t) {
var o = t.getUserData();
if (this.checkRoomID(o.rid)) {
var n = y.Instance;
e.prototype._onDismiss.call(this, o, n);
}
};
t.prototype._onBalanceRefresh = function(t) {
var o = t.getUserData();
if (!this.checkRoomID(o.rid)) {
var n = y.Instance;
e.prototype._onBalanceRefresh.call(this, o, n);
}
};
t.prototype.sendEnterRoom = function(e, t) {
void 0 === t && (t = !0);
var o = h.default.Instance.makeMsg(l.C2S.ROOM_ENTER_ROOM, {
u: this.uid,
t: this.token,
r: e,
is_open: t
});
h.default.Instance.send(o);
};
t.prototype.sendBet = function(e, t) {
var o = d.Tools.TNumber.num2thousand(e);
u.default.Instance.CompositeBetNum = e;
var n = h.default.Instance.makeMsg(l.C2S.ROOM_BET, {
u: this.uid,
t: this.token,
r: this.roomID,
fee: o,
option: t
});
h.default.Instance.send(n);
};
t.prototype.sendInteract = function(e, t, o) {
var n;
n = o ? {
u: this.uid,
t: this.token,
r: this.roomID,
to_u: e,
opt_type: t,
opt_val: o
} : {
u: this.uid,
t: this.token,
r: this.roomID,
to_u: e,
opt_type: t
};
var a = h.default.Instance.makeMsg(l.C2S.ROOM_INTERACT, n);
h.default.Instance.send(a);
};
t.prototype.sendRank = function(e, t) {
var o = h.default.Instance.makeMsg(l.C2S.ROOM_RANK, {
u: this.uid,
t: this.token,
r: this.roomID,
page: e,
count: t
});
h.default.Instance.send(o);
};
t.prototype.sendLeave = function() {
var e = h.default.Instance.makeMsg(l.C2S.ROOM_LEAVE, {
u: this.uid,
t: this.token,
r: this.roomID
});
h.default.Instance.send(e);
};
t._instance = null;
return t;
}(_.CompositeProxy);
o.default = g;
cc._RF.pop();
}, {
"../../../Game/client/global/enum/game/Event": "Event",
"../../../Game/client/global/enum/game/Game": "Game",
"../../../Game/client/global/enum/net/C2S": "C2S",
"../../../Game/client/global/enum/net/S2C": "S2C",
"../../../Game/fromework/global/Tools": "Tools",
"../../../Game/fromework/helper/EventHelper": "EventHelper",
"../../../Game/fromework/mvvm/modelView/ViewModel": "ViewModel",
"../../../client/logic/game/HearBeat": "HearBeat",
"../../../client/model/ErrorModel": "ErrorModel",
"../../../fromework/helper/NetHelper": "NetHelper",
"../../Common/Utils/CompositeProxy": "CompositeProxy",
"./TPWarStruct": "TPWarStruct"
} ],
TPWarRecordSmall: [ function(e, t, o) {
"use strict";
cc._RF.push(t, "8b6eaSzTzRKv7YwnE6PaYKw", "TPWarRecordSmall");
var n, a = this && this.__extends || (n = function(e, t) {
return (n = Object.setPrototypeOf || {
__proto__: []
} instanceof Array && function(e, t) {
e.__proto__ = t;
} || function(e, t) {
for (var o in t) Object.prototype.hasOwnProperty.call(t, o) && (e[o] = t[o]);
})(e, t);
}, function(e, t) {
n(e, t);
function o() {
this.constructor = e;
}
e.prototype = null === t ? Object.create(t) : (o.prototype = t.prototype, new o());
}), i = this && this.__decorate || function(e, t, o, n) {
var a, i = arguments.length, r = i < 3 ? t : null === n ? n = Object.getOwnPropertyDescriptor(t, o) : n;
if ("object" == typeof Reflect && "function" == typeof Reflect.decorate) r = Reflect.decorate(e, t, o, n); else for (var l = e.length - 1; l >= 0; l--) (a = e[l]) && (r = (i < 3 ? a(r) : i > 3 ? a(t, o, r) : a(t, o)) || r);
return i > 3 && r && Object.defineProperty(t, o, r), r;
};
Object.defineProperty(o, "__esModule", {
value: !0
});
var r = e("../../../Game/client/global/enum/game/Event"), l = e("../../../Game/fromework/helper/EventHelper"), s = e("../../Common/Utils/CompositeUtil"), c = cc._decorator, u = c.ccclass, d = c.property, p = function(e) {
a(t, e);
function t() {
var t = null !== e && e.apply(this, arguments) || this;
t.TopRecordParent = null;
t.TopRecordItem = null;
t.Queen_Frame = null;
t.King_Frame = null;
t.Light = null;
t.MaxCount = 14;
return t;
}
t.prototype.onEnable = function() {
l.default.Instance.Global.bind(r.GameEvent.S2C_ENTER_ROOM, this._onEnterRoom, this);
l.default.Instance.Global.bind(r.GameEvent.S2C_RESET, this._onResetRoom, this);
};
t.prototype.onDisable = function() {
l.default.Instance.Global.unbind(r.GameEvent.S2C_ENTER_ROOM, this._onEnterRoom, this);
l.default.Instance.Global.unbind(r.GameEvent.S2C_RESET, this._onResetRoom, this);
};
t.prototype.onLoad = function() {
this.refreshTopRecord(!1);
};
t.prototype._onEnterRoom = function() {
this.refreshTopRecord(!1);
};
t.prototype._onResetRoom = function() {
this.refreshTopRecord(!0);
};
t.prototype.refreshTopRecord = function(e) {
var t = this;
void 0 === e && (e = !1);
var o = s.default.Game.Model;
this.TopRecordParent.destroyAllChildren();
for (var n = o.declearHistory.getSimpleHistory(this.MaxCount), a = 0; a < n.length; a++) {
var i = n[a], r = cc.instantiate(this.TopRecordItem);
r.active = !0;
r.setPosition(cc.Vec2.ZERO);
r.parent = this.TopRecordParent;
r.getChildByName("Background").getComponent(cc.Sprite).spriteFrame = 0 == i.win ? this.King_Frame : this.Queen_Frame;
r.getChildByName("Points").getComponent(cc.Label).string = i.getTypeString();
}
if (e && null != this.Light) {
this.TopRecordParent.getComponent(cc.Layout).updateLayout();
var l = this.TopRecordParent.children[this.TopRecordParent.children.length - 1], c = l.parent.convertToWorldSpaceAR(l.position), u = this.Light.node.parent.convertToNodeSpaceAR(c);
this.Light.node.position = u;
this.Light.node.active = !0;
this.Light.armatureName = "Armature";
this.Light.once(dragonBones.EventObject.COMPLETE, function() {
t.Light.node.active = !1;
}, this);
this.Light.playAnimation("animation_new_details", 1);
}
};
i([ d(cc.Node) ], t.prototype, "TopRecordParent", void 0);
i([ d(cc.Node) ], t.prototype, "TopRecordItem", void 0);
i([ d(cc.SpriteFrame) ], t.prototype, "Queen_Frame", void 0);
i([ d(cc.SpriteFrame) ], t.prototype, "King_Frame", void 0);
i([ d(dragonBones.ArmatureDisplay) ], t.prototype, "Light", void 0);
i([ d ], t.prototype, "MaxCount", void 0);
return i([ u ], t);
}(cc.Component);
o.default = p;
cc._RF.pop();
}, {
"../../../Game/client/global/enum/game/Event": "Event",
"../../../Game/fromework/helper/EventHelper": "EventHelper",
"../../Common/Utils/CompositeUtil": "CompositeUtil"
} ],
TPWarRecord: [ function(e, t, o) {
"use strict";
cc._RF.push(t, "a8d21S1dppGfJSD0id7gGK6", "TPWarRecord");
var n, a = this && this.__extends || (n = function(e, t) {
return (n = Object.setPrototypeOf || {
__proto__: []
} instanceof Array && function(e, t) {
e.__proto__ = t;
} || function(e, t) {
for (var o in t) Object.prototype.hasOwnProperty.call(t, o) && (e[o] = t[o]);
})(e, t);
}, function(e, t) {
n(e, t);
function o() {
this.constructor = e;
}
e.prototype = null === t ? Object.create(t) : (o.prototype = t.prototype, new o());
}), i = this && this.__decorate || function(e, t, o, n) {
var a, i = arguments.length, r = i < 3 ? t : null === n ? n = Object.getOwnPropertyDescriptor(t, o) : n;
if ("object" == typeof Reflect && "function" == typeof Reflect.decorate) r = Reflect.decorate(e, t, o, n); else for (var l = e.length - 1; l >= 0; l--) (a = e[l]) && (r = (i < 3 ? a(r) : i > 3 ? a(t, o, r) : a(t, o)) || r);
return i > 3 && r && Object.defineProperty(t, o, r), r;
};
Object.defineProperty(o, "__esModule", {
value: !0
});
var r = e("../../../Game/fromework/helper/UIHelper"), l = e("../../Common/Utils/CompositeUtil"), s = cc._decorator, c = s.ccclass, u = s.property, d = function(e) {
a(t, e);
function t() {
var t = null !== e && e.apply(this, arguments) || this;
t.QueenWin = null;
t.KingWin = null;
t.BottomContent = null;
t.BottomRecordParent = null;
t.BottomRecordItem = null;
t.Queen_Frame = null;
t.King_Frame = null;
return t;
}
t.prototype.onLoad = function() {
var e = l.default.Game.Model;
if (e) {
var t = e.declearHistory.getWinRate();
this.QueenWin.string = (100 * t.queen).toFixed(0) + "%";
this.KingWin.string = (100 * t.king).toFixed(0) + "%";
} else {
this.QueenWin.string = "0%";
this.KingWin.string = "0%";
}
this.refreshBottomRecord();
};
t.prototype.refreshBottomRecord = function() {
var e = l.default.Game.Model;
this.BottomRecordParent.destroyAllChildren();
for (var t = e.declearHistory.getComplexHistory(18), o = 0, n = 0; n < t.length; n++) {
var a = t[n], i = 34.7 + 69.4 * n;
a.length > o && (o = a.length);
for (var r = 0; r < a.length; r++) {
var s = a[r], c = -(20 + 40 * r), u = cc.instantiate(this.BottomRecordItem);
u.active = !0;
u.setPosition(cc.v2(i, c));
u.parent = this.BottomRecordParent;
u.getChildByName("Background").getComponent(cc.Sprite).spriteFrame = 0 == s.win ? this.King_Frame : this.Queen_Frame;
u.getChildByName("Points").getComponent(cc.Label).string = s.getTypeString();
}
}
this.BottomContent.height = 40 * o;
};
t.prototype.onCloseClicked = function() {
r.default.Instance.removeMaskLayer(this.node, !0);
};
i([ u(cc.Label) ], t.prototype, "QueenWin", void 0);
i([ u(cc.Label) ], t.prototype, "KingWin", void 0);
i([ u(cc.Node) ], t.prototype, "BottomContent", void 0);
i([ u(cc.Node) ], t.prototype, "BottomRecordParent", void 0);
i([ u(cc.Node) ], t.prototype, "BottomRecordItem", void 0);
i([ u(cc.SpriteFrame) ], t.prototype, "Queen_Frame", void 0);
i([ u(cc.SpriteFrame) ], t.prototype, "King_Frame", void 0);
return i([ c ], t);
}(cc.Component);
o.default = d;
cc._RF.pop();
}, {
"../../../Game/fromework/helper/UIHelper": "UIHelper",
"../../Common/Utils/CompositeUtil": "CompositeUtil"
} ],
TPWarScene: [ function(e, t, o) {
"use strict";
cc._RF.push(t, "a965eedWQJDXLXwVDm3bpqs", "TPWarScene");
var n, a = this && this.__extends || (n = function(e, t) {
return (n = Object.setPrototypeOf || {
__proto__: []
} instanceof Array && function(e, t) {
e.__proto__ = t;
} || function(e, t) {
for (var o in t) Object.prototype.hasOwnProperty.call(t, o) && (e[o] = t[o]);
})(e, t);
}, function(e, t) {
n(e, t);
function o() {
this.constructor = e;
}
e.prototype = null === t ? Object.create(t) : (o.prototype = t.prototype, new o());
}), i = this && this.__decorate || function(e, t, o, n) {
var a, i = arguments.length, r = i < 3 ? t : null === n ? n = Object.getOwnPropertyDescriptor(t, o) : n;
if ("object" == typeof Reflect && "function" == typeof Reflect.decorate) r = Reflect.decorate(e, t, o, n); else for (var l = e.length - 1; l >= 0; l--) (a = e[l]) && (r = (i < 3 ? a(r) : i > 3 ? a(t, o, r) : a(t, o)) || r);
return i > 3 && r && Object.defineProperty(t, o, r), r;
};
Object.defineProperty(o, "__esModule", {
value: !0
});
var r = e("../../../Game/client/global/enum/game/Const"), l = e("../../../Game/fromework/helper/AudioHelper"), s = e("../../../Game/fromework/helper/EventHelper"), c = e("../../Common/Utils/CompositeEvent"), u = e("../../Common/Utils/CompositeUtil"), d = cc._decorator, p = d.ccclass, h = d.property, f = function(e) {
a(t, e);
function t() {
var t = null !== e && e.apply(this, arguments) || this;
t.TPWar = null;
t.Eff_Attack = null;
t.Node_VS = null;
t.Eff_VS = null;
return t;
}
t.prototype._init = function() {};
t.prototype._onGameHide = function() {
this.TPWar.node.active = !1;
this.Node_VS.active = !1;
this.Eff_Attack.node.active = !1;
this.unscheduleAllCallbacks();
};
t.prototype._onGameShow = function() {
this.TPWar.node.active = !0;
this.Node_VS.active = !1;
this.Eff_Attack.node.active = !1;
};
t.prototype._playQueenWin = function() {
var e = this;
this.TPWar.setAnimation(0, "gongnan", !1);
this.TPWar.setCompleteListener(function() {
e.TPWar.setCompleteListener(function() {});
e._playDefault();
});
this.Eff_Attack.node.active = !0;
this.Eff_Attack.premultipliedAlpha = !0;
this.Eff_Attack.setCompleteListener(function() {
e.Eff_Attack.setCompleteListener(function() {});
e.Eff_Attack.node.active = !1;
});
this.Eff_Attack.setAnimation(0, "animation_tp_war_king_gongji", !1);
l.default.Instance.playBundleEffect(r.BundleSoundPath.tpwar_queen_win);
};
t.prototype._playKingWin = function() {
var e = this;
this.TPWar.setAnimation(0, "gongnv", !1);
this.TPWar.setCompleteListener(function() {
e.TPWar.setCompleteListener(function() {});
e._playDefault();
});
this.Eff_Attack.node.active = !0;
this.Eff_Attack.setCompleteListener(function() {
e.Eff_Attack.setCompleteListener(function() {});
e.Eff_Attack.node.active = !1;
});
this.Eff_Attack.setAnimation(0, "animation_tp_war_queen_gongji", !1);
l.default.Instance.playBundleEffect(r.BundleSoundPath.tpwar_king_win);
};
t.prototype._playLuckyShotWin = function() {};
t.prototype._playJoin = function() {
var e = this;
this.TPWar.node.active = !0;
this.Node_VS.active = !1;
this.TPWar.setAnimation(0, "daiji", !1);
this.TPWar.setCompleteListener(function() {
e.TPWar.setCompleteListener(function() {});
e._playDefault();
});
};
t.prototype._playOut = function() {
var e = this;
this.TPWar.setAnimation(0, "daiji", !1);
this.TPWar.setCompleteListener(function() {
e.TPWar.setCompleteListener(function() {});
e.TPWar.node.active = !1;
e.Eff_VS.setAnimation(0, "animation", !1);
e.Node_VS.active = !0;
e.Eff_VS.setCompleteListener(function() {
e.Eff_VS.setCompleteListener(function() {});
e._playJoin();
});
});
};
t.prototype._playDefault = function() {
this.Node_VS.active = !1;
this.TPWar.setAnimation(0, "daiji", !0);
};
t.prototype._showEffect_Win = function() {
var e = u.default.Game.Model.win_options, t = -1 != e.indexOf(0) ? 0 : 1;
0 == t ? this._playKingWin() : 1 == t && this._playQueenWin();
-1 != e.indexOf(2) && this._playLuckyShotWin();
};
t.prototype._playStartBetting = function() {
this._playOut();
};
t.prototype._onStartBetting = function() {};
t.prototype.onEnable = function() {
s.default.Instance.Global.bind(c.CompositeUIEvent.UI_PLAY_START_BET, this._playStartBetting, this);
s.default.Instance.Global.bind(c.CompositeGameEvent.UI_EFFECT_START_BET, this._onStartBetting, this);
s.default.Instance.Global.bind(c.OddsEvent.ODDS_SHOW_WIN, this._showEffect_Win, this);
};
t.prototype.onDisable = function() {
s.default.Instance.Global.unbind(c.CompositeUIEvent.UI_PLAY_START_BET, this._playStartBetting, this);
s.default.Instance.Global.unbind(c.CompositeGameEvent.UI_EFFECT_START_BET, this._onStartBetting, this);
s.default.Instance.Global.unbind(c.OddsEvent.ODDS_SHOW_WIN, this._showEffect_Win, this);
};
t.prototype.onLoad = function() {
this._init();
cc.game.on(cc.game.EVENT_HIDE, this._onGameHide, this);
cc.game.on(cc.game.EVENT_SHOW, this._onGameShow, this);
};
t.prototype.start = function() {
this._playDefault();
};
i([ h(sp.Skeleton) ], t.prototype, "TPWar", void 0);
i([ h(sp.Skeleton) ], t.prototype, "Eff_Attack", void 0);
i([ h(cc.Node) ], t.prototype, "Node_VS", void 0);
i([ h(sp.Skeleton) ], t.prototype, "Eff_VS", void 0);
return i([ p ], t);
}(cc.Component);
o.default = f;
cc._RF.pop();
}, {
"../../../Game/client/global/enum/game/Const": "Const",
"../../../Game/fromework/helper/AudioHelper": "AudioHelper",
"../../../Game/fromework/helper/EventHelper": "EventHelper",
"../../Common/Utils/CompositeEvent": "CompositeEvent",
"../../Common/Utils/CompositeUtil": "CompositeUtil"
} ],
TPWarStruct: [ function(e, t, o) {
"use strict";
cc._RF.push(t, "b0d74KIn9xH7pdp3dM4W67q", "TPWarStruct");
Object.defineProperty(o, "__esModule", {
value: !0
});
o.TPWarStruct = void 0;
var n = e("../../../client/teenpatti/model/TeenPattiStruct");
(function(e) {
var t = function() {
function e(e) {
this.win = 0;
this.dealer = [];
e && this.refresh(e);
}
e.prototype.refresh = function(e) {
var t = -1 != e.w.indexOf(0) ? 0 : 1;
this.win = t;
this.dealer = e.d[t];
};
e.prototype.getTypeString = function() {
var e = n.TeenPattiCheckTools.checkCardType(this.dealer), t = "";
e == n.TeenPattiCardType.HighCard || e == n.TeenPattiCardType.HighCardA ? t = "HIGH" : e == n.TeenPattiCardType.Pair ? t = "PAIR" : e == n.TeenPattiCardType.Color ? t = "COLOR" : e == n.TeenPattiCardType.Sequence ? t = "SEQ" : e == n.TeenPattiCardType.PureSequence ? t = "PURE" : e == n.TeenPattiCardType.Trail && (t = "SET");
return t;
};
return e;
}();
e.HistoryData = t;
var o = function() {
function e(e) {
this.historyArray = [];
e && this.refresh(e);
}
e.prototype.refresh = function(e) {
var o = this;
this.historyArray.splice(0);
e.forEach(function(e) {
var n = new t(e);
o.historyArray.push(n);
});
};
e.prototype.getWinRate = function() {
var e = 0, t = 0, o = 0;
this.historyArray.forEach(function(n) {
e++;
0 == n.win ? t++ : o++;
});
return {
queen: t / e,
king: o / e
};
};
e.prototype.addHistory = function(e) {
100 == this.historyArray.length && this.historyArray.shift();
this.historyArray.push(e);
};
e.prototype.getSimpleHistory = function(e) {
for (var t = [], o = this.historyArray.length - 1; o >= 0; o--) {
var n = this.historyArray[o];
t.unshift(n);
if (t.length == e) break;
}
return t;
};
e.prototype.getComplexHistory = function(e) {
for (var t = [], o = -1, n = this.historyArray.length - 1; n >= 0; n--) {
var a = this.historyArray[n];
if (o != a.win) {
if (t.length == e) break;
o = a.win;
t.unshift([]);
}
t[0].length != e && t[0].unshift(a);
}
return t;
};
return e;
}();
e.DeclearHistory = o;
})(o.TPWarStruct || (o.TPWarStruct = {}));
cc._RF.pop();
}, {
"../../../client/teenpatti/model/TeenPattiStruct": "TeenPattiStruct"
} ],
TP_Eff_Win: [ function(e, t, o) {
"use strict";
cc._RF.push(t, "4dd493cv4tPmYPRAB2zkq3f", "TP_Eff_Win");
var n, a = this && this.__extends || (n = function(e, t) {
return (n = Object.setPrototypeOf || {
__proto__: []
} instanceof Array && function(e, t) {
e.__proto__ = t;
} || function(e, t) {
for (var o in t) Object.prototype.hasOwnProperty.call(t, o) && (e[o] = t[o]);
})(e, t);
}, function(e, t) {
n(e, t);
function o() {
this.constructor = e;
}
e.prototype = null === t ? Object.create(t) : (o.prototype = t.prototype, new o());
}), i = this && this.__decorate || function(e, t, o, n) {
var a, i = arguments.length, r = i < 3 ? t : null === n ? n = Object.getOwnPropertyDescriptor(t, o) : n;
if ("object" == typeof Reflect && "function" == typeof Reflect.decorate) r = Reflect.decorate(e, t, o, n); else for (var l = e.length - 1; l >= 0; l--) (a = e[l]) && (r = (i < 3 ? a(r) : i > 3 ? a(t, o, r) : a(t, o)) || r);
return i > 3 && r && Object.defineProperty(t, o, r), r;
};
Object.defineProperty(o, "__esModule", {
value: !0
});
var r = e("../model/TeenPattiStruct"), l = cc._decorator, s = l.ccclass, c = l.property, u = function(e) {
a(t, e);
function t() {
var t = null !== e && e.apply(this, arguments) || this;
t.Tiger = null;
t.Flower = null;
return t;
}
t.prototype.play = function(e) {
var t = this;
if (e == r.TeenPattiCardType.Trail) {
this.Tiger.active = !0;
this.Flower.active = !1;
this.Tiger.getComponent(cc.Animation).play("tp_tiger", 0);
this.scheduleOnce(function() {
t.Tiger.getComponent(cc.Animation).stop();
t.Tiger.active = !1;
t.node.removeFromParent(!0);
t.node.destroy();
}, 1.5);
} else if (e == r.TeenPattiCardType.PureSequence) {
this.Tiger.active = !1;
this.Flower.active = !0;
this.Flower.getComponent(cc.Animation).play("tp_flower", 0);
this.scheduleOnce(function() {
t.Flower.getComponent(cc.Animation).stop();
t.Flower.active = !1;
t.node.removeFromParent(!0);
t.node.destroy();
}, 1.5);
}
};
t.prototype.start = function() {};
i([ c(cc.Node) ], t.prototype, "Tiger", void 0);
i([ c(cc.Node) ], t.prototype, "Flower", void 0);
return i([ s ], t);
}(cc.Component);
o.default = u;
cc._RF.pop();
}, {
"../model/TeenPattiStruct": "TeenPattiStruct"
} ],
TP_Effect_Follow: [ function(e, t, o) {
"use strict";
cc._RF.push(t, "2d34d3Ijv9KcZMsRsaCrJ+L", "TP_Effect_Follow");
var n, a = this && this.__extends || (n = function(e, t) {
return (n = Object.setPrototypeOf || {
__proto__: []
} instanceof Array && function(e, t) {
e.__proto__ = t;
} || function(e, t) {
for (var o in t) Object.prototype.hasOwnProperty.call(t, o) && (e[o] = t[o]);
})(e, t);
}, function(e, t) {
n(e, t);
function o() {
this.constructor = e;
}
e.prototype = null === t ? Object.create(t) : (o.prototype = t.prototype, new o());
}), i = this && this.__decorate || function(e, t, o, n) {
var a, i = arguments.length, r = i < 3 ? t : null === n ? n = Object.getOwnPropertyDescriptor(t, o) : n;
if ("object" == typeof Reflect && "function" == typeof Reflect.decorate) r = Reflect.decorate(e, t, o, n); else for (var l = e.length - 1; l >= 0; l--) (a = e[l]) && (r = (i < 3 ? a(r) : i > 3 ? a(t, o, r) : a(t, o)) || r);
return i > 3 && r && Object.defineProperty(t, o, r), r;
};
Object.defineProperty(o, "__esModule", {
value: !0
});
var r = cc._decorator, l = r.ccclass, s = r.property, c = function(e) {
a(t, e);
function t() {
var t = null !== e && e.apply(this, arguments) || this;
t.Animation = null;
t.Sprite1 = null;
t.Sprite2 = null;
t.CardType_Frames = [];
t.Wager_Frames = [];
return t;
}
t.prototype.setAnimationPos = function(e) {
this.node.setPosition(e);
};
t.prototype.showCardTypeAnimation = function(e) {
var t = this, o = this.CardType_Frames[e];
if (null != o) {
this.Sprite1.spriteFrame = o;
this.Sprite2.spriteFrame = o;
this.Animation.play();
this.scheduleOnce(function() {
t.node.removeFromParent(!0);
t.node.destroy();
}, 1);
}
};
t.prototype.showWagerAnimation = function(e) {
var t = this;
this.Sprite1.spriteFrame = this.Wager_Frames[e ? 0 : 1];
this.Sprite2.spriteFrame = this.Wager_Frames[e ? 0 : 1];
this.Animation.play();
this.scheduleOnce(function() {
t.node.removeFromParent(!0);
t.node.destroy();
}, 1);
};
i([ s(cc.Animation) ], t.prototype, "Animation", void 0);
i([ s(cc.Sprite) ], t.prototype, "Sprite1", void 0);
i([ s(cc.Sprite) ], t.prototype, "Sprite2", void 0);
i([ s([ cc.SpriteFrame ]) ], t.prototype, "CardType_Frames", void 0);
i([ s([ cc.SpriteFrame ]) ], t.prototype, "Wager_Frames", void 0);
return i([ l ], t);
}(cc.Component);
o.default = c;
cc._RF.pop();
}, {} ],
TableBoard: [ function(e, t, o) {
"use strict";
cc._RF.push(t, "24379ftvt1O6Zg8bLXOsHCV", "TableBoard");
var n, a = this && this.__extends || (n = function(e, t) {
return (n = Object.setPrototypeOf || {
__proto__: []
} instanceof Array && function(e, t) {
e.__proto__ = t;
} || function(e, t) {
for (var o in t) Object.prototype.hasOwnProperty.call(t, o) && (e[o] = t[o]);
})(e, t);
}, function(e, t) {
n(e, t);
function o() {
this.constructor = e;
}
e.prototype = null === t ? Object.create(t) : (o.prototype = t.prototype, new o());
}), i = this && this.__decorate || function(e, t, o, n) {
var a, i = arguments.length, r = i < 3 ? t : null === n ? n = Object.getOwnPropertyDescriptor(t, o) : n;
if ("object" == typeof Reflect && "function" == typeof Reflect.decorate) r = Reflect.decorate(e, t, o, n); else for (var l = e.length - 1; l >= 0; l--) (a = e[l]) && (r = (i < 3 ? a(r) : i > 3 ? a(t, o, r) : a(t, o)) || r);
return i > 3 && r && Object.defineProperty(t, o, r), r;
};
Object.defineProperty(o, "__esModule", {
value: !0
});
var r = e("../../component/Card"), l = e("../../component/Dealer"), s = e("../../component/deck/CloseDeck"), c = e("../../component/deck/FinishDeck"), u = e("../../component/deck/OpenDeck"), d = e("../../component/Group"), p = e("../../component/HeadManager"), h = e("../../component/SequenceBulb"), f = e("../../model/GameModel"), _ = e("../Wallet/WalletHelper"), m = e("./TableOptTips"), y = e("./sort/Sort"), g = e("../../../Game/client/global/enum/game/Const"), v = e("../../../Game/fromework/helper/EventHelper"), C = e("../../../Game/fromework/mvvm/modelView/ViewModel"), b = e("../../../Game/client/global/enum/game/Event"), I = e("../../model/LobbyModel"), E = e("../../../Game/fromework/global/Tools"), S = e("../../../Game/client/global/enum/game/Game"), T = e("../../../Game/client/model/LanguageModel"), R = e("../../../Game/fromework/helper/AudioHelper"), O = e("../../../Game/Script/global/GlobalValue"), A = e("../../../Game/client/global/enum/game/UIUtils"), P = e("../../../Game/fromework/helper/UIHelper"), M = e("../../../Game/client/logic/game/GameHelper"), G = e("../../../Game/client/logic/game/sort/AutoSort"), w = e("../../../Game/client/logic/game/sort/CheckTools"), D = e("../../../platform/Platform"), L = e("../../global/PopHelper"), B = cc._decorator, N = B.ccclass, k = B.property, F = function(e) {
a(t, e);
function t() {
var t = null !== e && e.apply(this, arguments) || this;
t.Table = null;
t.Root = null;
t.PopLayer = null;
t.Prefab_Card = null;
t.Prefab_Group = null;
t.DeclareBtn = null;
t.SequenceBulb = null;
t.DeckTips = null;
t.OperationTips = null;
t.HeadManager = null;
t.Dealer = null;
t.OpenDeck = null;
t.FinishDeck = null;
t.CloseDeck = null;
t.FinishBtn = null;
t.DropBtn = null;
t.GroupBtn = null;
t.DiscardBtn = null;
t.ReadyButton = null;
t.SortBtn = null;
t.CardRecorder = null;
t.DeclareFail = null;
t.NewGroup = null;
t.BackButton = null;
t.RefreshButton = null;
t.ScoreBoardButton = null;
t.RechargeButton = null;
t.AutoPlayNode = null;
t.WaittingNode = null;
t.Room_Id_Lab = null;
t.Room_Name_Lab = null;
t.Room_Base_Lab = null;
t.Room_Base_Icon = null;
t.Room_Score_Lab = null;
t.Room_Wallet_Node = [];
t.BonusLine = null;
t.BonusNode = null;
t.Battery = null;
t.NetworkDelay = null;
t.AutoSortToggle = null;
t.AutoSortTips = null;
t.BtnGrayFrame = null;
t._isAutoSort = !0;
t._orderCards = new Array();
t._dealerCards = new Array();
t._wildCard = null;
t._operateCard = null;
t._openDeckCards = new Array();
t._selectCards = new Array();
t._deckTipsTimeId = -1;
t._translucentCard = null;
t._maxScore = g.TOTAL_GAME_SCORE;
t._init = !1;
t._isOpenRecharge = !1;
t._countDownKey = 123654789;
t._discard_time = 0;
t._handFromServer = [];
t._handFromClient = [];
t._groups = [];
t._cards = [];
t._touchStartType = 0;
t._curTouchCard = null;
t._curTouchCardGroupIndex = -1;
t._curTouchCardIndex = -1;
t._curTouchCardMoved = !1;
t._curTouchCarDest = cc.Vec2.ZERO;
t._curDestGroupIndex = -1;
t._curDestIndex = -1;
t._curDestPosition = null;
t._hasTouchCard = !1;
return t;
}
Object.defineProperty(t.prototype, "isAutoSort", {
get: function() {
return this._isAutoSort;
},
set: function(e) {
cc.sys.localStorage.setItem("AutoSortHandCards_New", JSON.stringify(e));
this._isAutoSort = e;
},
enumerable: !1,
configurable: !0
});
Object.defineProperty(t.prototype, "roomId", {
get: function() {
var e = C.VM.getValue("lobby.roomID");
if (0 != e) return e;
},
enumerable: !1,
configurable: !0
});
t.prototype._registerEvent = function() {
v.default.Instance.Global.bind(b.GameEvent.S2C_ENTER_ROOM, this._onEnterRoom, this);
v.default.Instance.Global.bind(b.GameEvent.S2C_SWITCH_ROOM, this._onSwitchRoom, this);
v.default.Instance.Global.bind(b.GameEvent.S2C_ORDER_SHOW, this._onOrderShow, this);
v.default.Instance.Global.bind(b.GameEvent.S2C_ORDER_CONFIRM, this._onOrderConfirm, this);
v.default.Instance.Global.bind(b.GameEvent.S2C_CARD_SHOW, this._onCardShow, this);
v.default.Instance.Global.bind(b.GameEvent.S2C_CARD_CONFIRM, this._onCardConfirm, this);
v.default.Instance.Global.bind(b.GameEvent.S2C_START_ROOM, this._onStartRoom, this);
v.default.Instance.Global.bind(b.GameEvent.S2C_DRAW, this._onDraw, this);
v.default.Instance.Global.bind(b.GameEvent.S2C_DISCARD, this._onDiscard, this);
v.default.Instance.Global.bind(b.GameEvent.S2C_FINISH, this._onFinish, this);
v.default.Instance.Global.bind(b.GameEvent.S2C_DECLEAR_SUCCESS, this._onDeclearSuccess, this);
v.default.Instance.Global.bind(b.GameEvent.S2C_DECLEAR_FAIL, this._onDeclearFail, this);
v.default.Instance.Global.bind(b.GameEvent.S2C_RESET, this._onReset, this);
v.default.Instance.Global.bind(b.GameEvent.S2C_LEAVE, this._onLeave, this);
v.default.Instance.Global.bind(b.GameEvent.S2C_LEAVE_SINGLE, this._onLeaveSingle, this);
v.default.Instance.Global.bind(b.GameEvent.S2C_DROP, this._onDrop, this);
v.default.Instance.Global.bind(b.GameEvent.S2C_DISMISS_ROOM, this._onDismiss, this);
v.default.Instance.Global.bind(b.GameEvent.S2C_KICK, this._onKick, this);
v.default.Instance.Global.bind(b.GameEvent.S2C_AUTOSORT, this._onAutoSort, this);
v.default.Instance.Global.bind(b.GameEvent.S2C_SEND_AVAILABLE_BALANCE, this.refreshLabel, this);
v.default.Instance.Global.bind(b.GameEvent.S2C_AUTOPLAY, this._onAutoPlay, this);
v.default.Instance.Global.bind(b.GameEvent.S2C_SCORE_WINDOW, this._onScoreWindow, this);
v.default.Instance.Global.bind(b.GameEvent.S2C_INITIATE_SPLIT, this._onInitiateSplit, this);
v.default.Instance.Global.bind(b.GameEvent.S2C_SPLIT, this._onSplit, this);
v.default.Instance.Global.bind(b.GameEvent.S2C_SPLIT_RESULT, this._onSplitResult, this);
v.default.Instance.Global.bind(b.GameEvent.S2C_REJOIN, this._onRejoin, this);
v.default.Instance.Global.bind(b.GameEvent.S2C_READY, this._onReady, this);
v.default.Instance.Global.bind(b.GameEvent.TABLE_REFRESH_TABLE, this._onRefreshTable, this);
v.default.Instance.Global.bind(b.GameEvent.GAME_GROUP_ADD_HERE, this._onGroupAddCards, this);
v.default.Instance.Global.bind(b.GameEvent.GAME_GROUP_LEFT, this._onGroupClickLeft, this);
v.default.Instance.Global.bind(b.GameEvent.GAME_GROUP_RIGHT, this._onGroupClickRight, this);
v.default.Instance.Global.bind(b.GameEvent.SELF_HEAD_COUNTDOWN, this._onSelfHeadCountdown, this);
v.default.Instance.Global.bind(b.GameEvent.SCORE_WINDOW_CLOSE, this._onScoreWindowClose, this);
v.default.Instance.Global.bind(b.GameEvent.TABLE_HEAD_SORT, this._onHeadSort, this);
v.default.Instance.Global.bind(b.TipsEvent.TIPS_READY_BUTTON_CLICKED, this.onReadyBtnClicked, this);
};
t.prototype._unRegisterEvent = function() {
v.default.Instance.Global.unbind(b.GameEvent.S2C_ENTER_ROOM, this._onEnterRoom, this);
v.default.Instance.Global.unbind(b.GameEvent.S2C_SWITCH_ROOM, this._onSwitchRoom, this);
v.default.Instance.Global.unbind(b.GameEvent.S2C_ORDER_SHOW, this._onOrderShow, this);
v.default.Instance.Global.unbind(b.GameEvent.S2C_ORDER_CONFIRM, this._onOrderConfirm, this);
v.default.Instance.Global.unbind(b.GameEvent.S2C_CARD_SHOW, this._onCardShow, this);
v.default.Instance.Global.unbind(b.GameEvent.S2C_CARD_CONFIRM, this._onCardConfirm, this);
v.default.Instance.Global.unbind(b.GameEvent.S2C_START_ROOM, this._onStartRoom, this);
v.default.Instance.Global.unbind(b.GameEvent.S2C_DRAW, this._onDraw, this);
v.default.Instance.Global.unbind(b.GameEvent.S2C_DISCARD, this._onDiscard, this);
v.default.Instance.Global.unbind(b.GameEvent.S2C_FINISH, this._onFinish, this);
v.default.Instance.Global.unbind(b.GameEvent.S2C_DECLEAR_SUCCESS, this._onDeclearSuccess, this);
v.default.Instance.Global.unbind(b.GameEvent.S2C_DECLEAR_FAIL, this._onDeclearFail, this);
v.default.Instance.Global.unbind(b.GameEvent.S2C_RESET, this._onReset, this);
v.default.Instance.Global.unbind(b.GameEvent.S2C_LEAVE, this._onLeave, this);
v.default.Instance.Global.unbind(b.GameEvent.S2C_LEAVE_SINGLE, this._onLeaveSingle, this);
v.default.Instance.Global.unbind(b.GameEvent.S2C_DROP, this._onDrop, this);
v.default.Instance.Global.unbind(b.GameEvent.S2C_DISMISS_ROOM, this._onDismiss, this);
v.default.Instance.Global.unbind(b.GameEvent.S2C_KICK, this._onKick, this);
v.default.Instance.Global.unbind(b.GameEvent.S2C_AUTOSORT, this._onAutoSort, this);
v.default.Instance.Global.unbind(b.GameEvent.S2C_SEND_AVAILABLE_BALANCE, this.refreshLabel, this);
v.default.Instance.Global.unbind(b.GameEvent.S2C_AUTOPLAY, this._onAutoPlay, this);
v.default.Instance.Global.unbind(b.GameEvent.S2C_SCORE_WINDOW, this._onScoreWindow, this);
v.default.Instance.Global.unbind(b.GameEvent.S2C_INITIATE_SPLIT, this._onInitiateSplit, this);
v.default.Instance.Global.unbind(b.GameEvent.S2C_SPLIT, this._onSplit, this);
v.default.Instance.Global.unbind(b.GameEvent.S2C_SPLIT_RESULT, this._onSplitResult, this);
v.default.Instance.Global.unbind(b.GameEvent.S2C_REJOIN, this._onRejoin, this);
v.default.Instance.Global.unbind(b.GameEvent.S2C_READY, this._onReady, this);
v.default.Instance.Global.unbind(b.GameEvent.TABLE_REFRESH_TABLE, this._onRefreshTable, this);
v.default.Instance.Global.unbind(b.GameEvent.GAME_GROUP_ADD_HERE, this._onGroupAddCards, this);
v.default.Instance.Global.unbind(b.GameEvent.GAME_GROUP_LEFT, this._onGroupClickLeft, this);
v.default.Instance.Global.unbind(b.GameEvent.GAME_GROUP_RIGHT, this._onGroupClickRight, this);
v.default.Instance.Global.unbind(b.GameEvent.SELF_HEAD_COUNTDOWN, this._onSelfHeadCountdown, this);
v.default.Instance.Global.unbind(b.GameEvent.SCORE_WINDOW_CLOSE, this._onScoreWindowClose, this);
v.default.Instance.Global.unbind(b.GameEvent.TABLE_HEAD_SORT, this._onHeadSort, this);
v.default.Instance.Global.unbind(b.TipsEvent.TIPS_READY_BUTTON_CLICKED, this.onReadyBtnClicked, this);
};
t.prototype.onEnable = function() {
this._registerEvent();
cc.game.on(cc.game.EVENT_SHOW, this._onRefreshTable, this);
};
t.prototype.onDestroy = function() {
this.unscheduleAllCallbacks();
this._unRegisterEvent();
cc.game.off(cc.game.EVENT_SHOW, this._onRefreshTable, this);
};
t.prototype.refreshLabel = function() {
var e = f.RoomModelManager.Instance.getModel(), t = I.default.Instance.getGamePlay(e.roomData.rtype), o = e.allUserData.getUserData(C.VM.getValue("user.uid")), n = E.Tools.TNumber.numFixed(e.roomData.base, 2), a = 0;
t.currency == S.GameEnum.MoneyType.CASH && (a = C.VM.getValue("wallet.total"));
t.currency == S.GameEnum.MoneyType.GOLD && (a = C.VM.getValue("wallet.gold"));
this._maxScore = t.rate;
var i;
i = t.cls == S.GameEnum.PlayType.RUMMY_POOL ? t.name + (e.roomData.round ? "-" + e.roomData.round : "") : t.cls == S.GameEnum.PlayType.RUMMY_DEALS ? e.roomData.round > t.deals_round ? T.default.getString("ROOM_NAME_TIEBREAKER") : t.name + (e.roomData.round ? "-" + e.roomData.round + "/" + t.deals_round : "") : t.name;
this.Room_Name_Lab.string = i;
this.Room_Id_Lab.string = e.roomData.rid + (e.roomData.round ? "-" + e.roomData.round : "");
this.Room_Base_Lab.string = t.currency == S.GameEnum.MoneyType.CASH ? T.default.getString("COMMON_RUPEE") + n : n;
this.Room_Base_Icon.active = t.currency == S.GameEnum.MoneyType.PRACTICE;
this.Room_Wallet_Node[0].active = t.currency != S.GameEnum.MoneyType.PRACTICE;
this.Room_Wallet_Node[1].active = t.currency == S.GameEnum.MoneyType.PRACTICE;
this.Room_Wallet_Node[2].parent.active = t.cls == S.GameEnum.PlayType.RUMMY_POOL || t.cls == S.GameEnum.PlayType.RUMMY_DEALS;
this.Room_Wallet_Node[0].getComponent(cc.Label).string = T.default.getString("COMMON_RUPEE") + a;
this.Room_Wallet_Node[1].getChildByName("Practice").getComponent(cc.Label).string = e.allUserData.getUserData(C.VM.getValue("user.uid")).practice + "";
this.Room_Wallet_Node[2].getComponent(cc.Label).string = E.Tools.TStr.replaceAll(T.default.getString("TABLE_PTS"), "%{num}", o ? o.tscore + "" : "0");
this.BonusLine.active = t.cls == S.GameEnum.PlayType.RUMMY_POOL || t.cls == S.GameEnum.PlayType.RUMMY_DEALS;
this.BonusNode.active = t.cls == S.GameEnum.PlayType.RUMMY_POOL || t.cls == S.GameEnum.PlayType.RUMMY_DEALS;
this.BonusNode.getChildByName("Bonus").getComponent(cc.Label).string = e.roomData.bonus ? e.roomData.bonus + "" : "";
this.ScoreBoardButton.node.active = t.cls == S.GameEnum.PlayType.RUMMY_POOL || t.cls == S.GameEnum.PlayType.RUMMY_DEALS;
};
t.prototype.openDeckPushCard = function(e) {
if (this._openDeckCards.length >= 2) {
var t = this._openDeckCards.shift();
this.destoryCard(t);
this._openDeckCards.push(e);
} else this._openDeckCards.push(e);
};
t.prototype.openDeckPopCard = function() {
if (this._openDeckCards.length > 0) return this._openDeckCards.pop();
};
t.prototype._refreshOpenDeckCard = function() {
var e = this, t = f.RoomModelManager.Instance.getModel();
this._openDeckCards.forEach(function(t) {
e.destoryCard(t);
});
this._openDeckCards.splice(0);
t.optData.last.forEach(function(o, n) {
var a = e.createCard(o, !0);
a.node.zIndex = g.DECK_ZINDEX + n;
a.node.setPosition(e.OpenDeck.node.getPosition());
a.node.scale = g.DESK_CARD_SCALE;
0 === n && (t.optData.last.length > 1 && a.WildCard.node.active ? a.WildCard.node.active = !1 : t.optData.last.length <= 1 && e._wildCard && M.GroupHelper.getFigure(e._wildCard.idx16) == M.GroupHelper.getFigure(o) && (a.WildCard.node.active = !0));
e._openDeckCards.push(a);
});
};
t.prototype.addSelectCard = function(e) {
var t = this;
this._selectCards.some(function(t) {
return t === e;
}) ? this.removeSelecCard(e) : this._selectCards.push(e);
this._cards.forEach(function(e, o) {
var n = !1;
e.forEach(function(e) {
t._selectCards.some(function(t) {
return t === e;
}) && (n = !0);
});
t._groups[o] && t._groups[o].setAddButton(!n && t._selectCards.length > 0);
});
this.refreshBottomBtns();
};
t.prototype.removeSelecCard = function(e) {
for (var t = -1, o = 0; o < this._selectCards.length; o++) if (this._selectCards[o] === e) {
t = o;
break;
}
-1 != t && this._selectCards.splice(t, 1);
};
t.prototype.clearAllSelectCard = function() {
this._selectCards.forEach(function(e) {
e && e.Clicked && e.node && e.node.isValid && e.onClick();
});
this._selectCards.splice(0);
this._groups.forEach(function(e) {
e.setAddButton(!1);
});
this.refreshBottomBtns();
};
t.prototype._getCardIndex = function(e) {
var t = -1, o = -1;
this._cards.forEach(function(n, a) {
n.forEach(function(n, i) {
if (n === e) {
t = a;
o = i;
}
});
});
return {
groupIndex: t,
cardIndex: o
};
};
t.prototype._onGroupAddCards = function(e) {
var t = this, o = e.getUserData(), n = -1;
this._groups.forEach(function(e, t) {
e === o && (n = t);
});
if (-1 != n) {
this._selectCards.forEach(function(e) {
var o = t._getCardIndex(e);
if (-1 != o.groupIndex && -1 != o.cardIndex) {
var a = t._handFromClient[o.groupIndex].indexOf(e.idx16);
if (-1 != a) {
t._handFromClient[o.groupIndex].splice(a, 1);
t._handFromClient[n].push(e.idx16);
}
}
});
for (var a = this._handFromClient.length - 1; a >= 0; a--) 0 == this._handFromClient[a].length && this._handFromClient.splice(a, 1);
this.clearAllSelectCard();
this.resetGroups(this._handFromClient);
this.resetCards(this._handFromClient);
f.default.Instance.sendSyncCard(this._handFromClient);
}
};
t.prototype._onGroupClickLeft = function(e) {
var t = e.getUserData(), o = -1;
this._groups.forEach(function(e, n) {
e === t && (o = n);
});
-1 != o && o - 1 >= 0 && (this._handFromClient[o] = this._handFromClient.splice(o - 1, 1, this._handFromClient[o])[0]);
this.resetGroups(this._handFromClient);
this.resetCards(this._handFromClient);
f.default.Instance.sendSyncCard(this._handFromClient);
};
t.prototype._onGroupClickRight = function(e) {
var t = e.getUserData(), o = -1;
this._groups.forEach(function(e, n) {
e === t && (o = n);
});
-1 != o && o + 1 < this._handFromClient.length && (this._handFromClient[o] = this._handFromClient.splice(o + 1, 1, this._handFromClient[o])[0]);
this.resetGroups(this._handFromClient);
this.resetCards(this._handFromClient);
f.default.Instance.sendSyncCard(this._handFromClient);
};
t.prototype._onSelfHeadCountdown = function(e) {
if (this && this.node && this.node.isValid) {
var t = f.RoomModelManager.Instance.getModel(), o = e.getUserData();
null == o.countDown && (o.countDown = 0);
!t.checkOptUser() || 0 != t.optData.cstate && 1 != t.optData.cstate || 1 == o.isFaultTime && o.countDown <= 20 && this.OperationTips.showOperationTips(t.optData.cstate);
}
};
t.prototype._onScoreWindowClose = function(e) {
var t = this, o = f.RoomModelManager.Instance.getModel(), n = o.allUserData.getUserData(C.VM.getValue("user.uid")), a = o.getPlay(), i = e.getUserData(), r = i.isLeave, l = i.isSwitch, s = i.isKick, c = !n || 2 == n.state;
1 == i.type && (r ? f.default.Instance.sendLeave(!1) : l && this.switchTableConfirm(function(e) {
if (e) {
t._isOpenRecharge = e;
t.leaveRoom();
}
}, !1));
if (2 == i.type) {
this.HeadManager.refresh(o);
if (c || !n || s) {
this.leaveRoom();
return;
}
if (r) f.default.Instance.sendLeave(!1); else if (a.cls == S.GameEnum.PlayType.RUMMY_POOL) {
D.default.log("[Game Table Reset]self res:" + n.res);
if (4 == n.res && 4 == n.state || 9 == o.optData.state && 1 == n.res) {
this.AutoPlayNode && (this.AutoPlayNode.active = !1);
L.PopHelper.Instance.showTotalResult(o, !1, function() {
t.leaveRoom();
}, function() {
t.switchTable();
});
}
} else if (a.cls == S.GameEnum.PlayType.RUMMY_DEALS) {
if (1 == o.dealsResult) {
var u = {
content: T.default.getString("TIPS_TIEBREAKER"),
rightTitle: T.default.getString("TABLE_BTN_YES")
};
L.PopHelper.Instance.showAlert(u);
}
if (2 == o.dealsResult) {
this.AutoPlayNode && (this.AutoPlayNode.active = !1);
L.PopHelper.Instance.showTotalResult(o, !1, function() {
t.leaveRoom();
}, function() {
t.switchTable();
});
}
} else l ? this.switchTableConfirm(function(e) {
if (e) {
t._isOpenRecharge = e;
t.leaveRoom();
}
}, !1) : o.allUserData.resetUserState();
}
3 == i.type && (l ? this.switchTableConfirm(function(e) {
t._isOpenRecharge = e;
t.leaveRoom();
}, !1) : this.leaveRoom());
5 == i.type && (r ? f.default.Instance.sendLeave(!1) : l && this.switchTableConfirm(function(e) {
if (e) {
t._isOpenRecharge = e;
f.default.Instance.sendLeave(!1);
}
}, !1));
};
t.prototype._onHeadSort = function() {
var e = f.RoomModelManager.Instance.getModel();
this.HeadManager.userSort(e.optData, e.allUserData);
};
t.prototype._refreshDelay = function() {};
t.prototype.refreshBottomBtns = function() {
var e = f.RoomModelManager.Instance.getModel(), t = (e.allUserData.getUserData(C.VM.getValue("user.uid")), 
I.default.Instance.getGamePlay(e.roomData.rtype)), o = this._selectCards.length;
this.DropBtn.changeInteractable(e.checkDrawClose() && 0 == o && t.cls != S.GameEnum.PlayType.RUMMY_DEALS, this.BtnGrayFrame);
this.DiscardBtn.changeInteractable(e.checkDiscard() && 1 == o, this.BtnGrayFrame);
this.FinishBtn.changeInteractable(e.checkDiscard() && this.__checkCouldFinish() && 1 == o, this.BtnGrayFrame);
this.GroupBtn.changeInteractable(o >= 2, this.BtnGrayFrame);
if (1 == this.FinishBtn.interactable) {
var n = this._getCardIndex(this._selectCards[0]);
if (-1 != n.groupIndex && -1 != n.cardIndex) {
var a = E.Tools.TArray.deepCopy(this._handFromClient);
a[n.groupIndex].splice(n.cardIndex, 1);
0 == M.GroupHelper.getTotalScore(a, e.roomData.xcard, this._maxScore, e.roomData.mcard) ? this.FinishBtn.node.getChildByName("LightBorder").active = !0 : this.FinishBtn.node.getChildByName("LightBorder").active = !1;
}
} else this.FinishBtn.node.getChildByName("LightBorder").active = !1;
};
t.prototype.createCard = function(e, t) {
var o = f.RoomModelManager.Instance.getModel(), n = cc.instantiate(this.Prefab_Card);
n.zIndex = g.CARD_ZINDEX;
this.Table.addChild(n);
var a = n.getComponent(r.default);
a.init(e, t, o.roomData.xcard);
return a;
};
t.prototype.destoryCard = function(e) {
if (e && e.node && e.node.isValid) {
e.node.removeFromParent(!0);
e.node.destroy();
}
};
t.prototype._refreshRoomOpt = function(e) {
var t = this;
void 0 === e && (e = !0);
var o = f.RoomModelManager.Instance.getModel(), n = I.default.Instance.getGamePlay(o.roomData.rtype), a = C.VM.getValue("user.uid"), i = o.allUserData.getUserData(a);
if (2 == o.optData.state || i && 2 != i.state) {
if (5 == i.state && 4 != i.res) {
this.AutoPlayNode.active = !0;
L.PopHelper.Instance.closeAlert();
L.PopHelper.Instance.hideTableMenu();
}
this.WaittingNode.active = 0 == i.state && 1 != o.optData.state && 2 != o.optData.state;
this.OpenDeck.setCountNodeActive(0 == i.state && 5 == o.optData.state);
this.OpenDeck.updateOpenCardCount(o.recordData.getDiscardCount());
var r = o.roomData.ready_switch && 2 == o.optData.state && i && 4 != i.confirm_state && 5 != i.state;
if (1 == o.optData.state) {
L.PopHelper.Instance.closeCountdown(this._countDownKey);
if (n.cls == S.GameEnum.PlayType.RUMMY_DEALS) {
var l = T.default.getString("TIPS_WAITING_DEALS");
L.PopHelper.Instance.showCountdown(l, -99, this._countDownKey, function() {}, this, this.PopLayer, null, r);
} else {
l = T.default.getString("TIPS_WAITING");
L.PopHelper.Instance.showCountdown(l, o.getCountDown(), this._countDownKey, function() {}, this, this.PopLayer, null, r);
v.default.Instance.Global.emit(b.GameEvent.SCORE_WINDOW_REFRESH_TIME, {
time: o.getCountDown()
});
}
} else if (2 == o.optData.state) {
L.PopHelper.Instance.closeCountdown(this._countDownKey);
l = T.default.getString("END_WAIT1");
n.cls == S.GameEnum.PlayType.RUMMY_DEALS && (l = E.Tools.TStr.replaceAll(T.default.getString("TIPS_STARTROOM_DEALS"), "%{round}", o.roomData.round));
L.PopHelper.Instance.showCountdown(l, o.getCountDown(), this._countDownKey, function() {}, this, this.PopLayer, null, r);
v.default.Instance.Global.emit(b.GameEvent.SCORE_WINDOW_REFRESH_TIME, {
time: o.getCountDown()
});
} else if (7 == o.optData.state) ; else if (8 == o.optData.state) {
L.PopHelper.Instance.closeCountdown(this._countDownKey);
l = T.default.getString("END_WAIT1");
L.PopHelper.Instance.showCountdown(l, o.getCountDown(), this._countDownKey, function() {}, this, this.PopLayer, null, r);
v.default.Instance.Global.emit(b.GameEvent.SCORE_WINDOW_REFRESH_TIME, {
time: o.getCountDown()
});
} else L.PopHelper.Instance.closeCountdown(this._countDownKey);
o.checkOptUser() && 0 == o.optData.cstate && 5 == o.optData.state && this.scheduleOnce(function() {
R.default.Instance.playBundleEffect(g.BundleSoundPath.rummy_own_round);
C.VM.getValue("lobbySet.isPlayVibration") && D.default.vibrator();
});
(!o.checkOptUser() || 1 != i.state && 0 != i.state) && this.OperationTips.hideOperationTips();
this.HeadManager.isPlayHeadAction = e;
this.HeadManager.refresh(o);
this.HeadManager.isPlayHeadAction = !0;
if (this._orderCards && this._orderCards.length > 0) {
this._orderCards.forEach(function(e) {
t.destoryCard(e);
});
this._orderCards.splice(0);
}
if ((5 == o.optData.state || 6 == o.optData.state || 7 == o.optData.state) && 3 == i.res) {
this.updateDeclareFail();
if (o.discardData.uid == a) {
var s = -1, c = -1;
this._cards.forEach(function(e, t) {
e.forEach(function(e, n) {
if (e.idx16 != o.discardData.card) ; else {
s = t;
c = n;
}
});
});
if (-1 != s && -1 != c) {
D.default.log("摸牌后超时，移除手牌：", s, c, o.discardData.card);
this._outHandCard(s, c, this.OpenDeck.node.getPosition(), g.SCALE_DESK, function(e) {
e.node.removeFromParent(!0);
e.node.destroy();
});
}
}
6 != o.optData.state && 7 != o.optData.state || (this.DeclareBtn.active = !1);
}
this.CloseDeck.setLightBorderActive(o.checkOptUser() && 5 == o.optData.state && 0 == o.optData.cstate);
this.FinishDeck.setLightBorderActive(o.checkOptUser() && 5 == o.optData.state && 1 == o.optData.cstate);
this.OpenDeck.setLightBorderActive(o.checkOptUser() && 5 == o.optData.state && (0 == o.optData.cstate || 1 == o.optData.cstate));
this.BackButton.interactable = 3 != o.optData.state && 4 != o.optData.state;
this.refreshLabel();
this.refreshBottomBtns();
}
};
t.prototype.hideSortTips = function() {
this.AutoSortTips.stopAllActions();
this.AutoSortTips.opacity = 75;
this.AutoSortTips.active = !1;
};
t.prototype.showSortButton = function() {
this.SortBtn.active = !0;
var e = cc.sys.localStorage.getItem("DalyAutoSortShow_New"), t = null, o = new Date().getDate();
if (e) {
if ((t = JSON.parse(e)).day != o) {
t.day = o;
t.count = 0;
}
} else t = {
day: o,
count: 0
};
if (!this.isAutoSort && t.count < 2) {
t.count++;
this.AutoSortTips.active = !0;
this.AutoSortTips.stopAllActions();
this.AutoSortTips.opacity = 75;
cc.tween(this.AutoSortTips).to(.8, {
opacity: 255
}).to(.8, {
opacity: 75
}).to(.8, {
opacity: 255
}).to(.8, {
opacity: 75
}).set({
active: !1
}).start();
cc.sys.localStorage.setItem("DalyAutoSortShow_New", "" + JSON.stringify(t));
}
};
t.prototype._onEnterRoom = function(e) {
var t = this, o = f.RoomModelManager.Instance.getModel(), n = e.getUserData(), a = f.default.Instance.oldRoomType;
if ("" != a && a != o.roomData.rtype) {
var i = I.default.Instance.getGamePlay(o.roomData.rtype);
f.default.Instance.oldRoomType = "";
null != i && L.PopHelper.Instance.showTips(E.Tools.TStr.replaceAll(T.default.getString("COMMON_SWITCH_TIPS"), "%{cash}", i.base));
}
if (!this._init) {
this._init = !0;
this.HeadManager.refreshUserCount(o.roomData.max);
G.default.Instance.init(this._maxScore, o.roomData.mcard);
}
this.Room_Score_Lab.string = E.Tools.TStr.replaceAll(T.default.getString("TABLE_SCORE"), "%{num}", 0);
if (n == C.VM.getValue("user.uid")) {
L.PopHelper.Instance.closeAlert();
6 != o.optData.state && 7 != o.optData.state && this.resetAll();
if (3 == o.optData.state) ; else if (4 == o.optData.state || 5 == o.optData.state || 6 == o.optData.state || 7 == o.optData.state) {
M.GroupHelper.setIsShowWildCard(!0);
this.CloseDeck.setSlotActive(!0);
this.FinishDeck.setSlotActive(!0);
this.OpenDeck.setSlotActive(!0);
this.HeadManager.userSort(o.optData, o.allUserData);
this._wildCard = this.createCard(o.roomData.xcard, !0);
this._wildCard.node.active = !0;
this._wildCard.node.zIndex = g.WILD_CARD_ZINDEX;
this._wildCard.node.scale = g.DESK_CARD_SCALE_WILD;
this._wildCard.node.setPosition(this.CloseDeck.getWildCardPosInTarget(this.Table));
this._wildCard.setCloseDeckWildIcon();
this._wildCard.flipCard(.1, cc.v3(0, -180, g.DESK_CARD_ROTATE_WILD), !1);
this.CloseDeck.setTipsCards(o.roomData.xcard);
o.optData.last.forEach(function(e, o) {
var n = t.createCard(e, !0);
n.node.zIndex = g.DECK_ZINDEX + o;
n.node.setPosition(t.OpenDeck.node.getPosition());
n.node.scale = g.DESK_CARD_SCALE;
t._openDeckCards.push(n);
});
this.showSortButton();
this.SortBtn.active = !0;
this.CardRecorder.active = !0;
if (o.checkSelfState()) {
var r = 0 != o.syncCard.length ? o.syncCard : w.default.group([ o.handCards ]);
this.creatHand(r);
this._cards.forEach(function(e) {
e.forEach(function(e) {
e && e.refreshWildCard();
});
});
}
if (6 == o.optData.state) {
if (o.checkOptUser()) {
this.DeclareBtn.active = !1;
this.scheduleOnce(function() {
t.onDeclareClicked();
}, 1);
} else this.DeclareBtn.active = !1;
if (o.roomData.fcard && 0 != o.roomData.fcard) {
this._operateCard = this.createCard(o.roomData.fcard, !0);
var l = this.FinishDeck.getFinishDeckPosInTarget(this.Table);
this._operateCard.pos = l;
}
}
if (7 == o.optData.state) {
if (o.checkIsDeclear()) {
this.DeclareBtn.active = !1;
L.PopHelper.Instance.showScoreWindow(1);
} else this.DeclareBtn.active = !0;
if (o.roomData.fcard && 0 != o.roomData.fcard) {
this._operateCard = this.createCard(o.roomData.fcard, !0);
l = this.FinishDeck.getFinishDeckPosInTarget(this.Table);
this._operateCard.pos = l;
}
}
} else 8 == o.optData.state && L.PopHelper.Instance.showSplitPrize(o);
this._refreshRoomOpt(!1);
} else this._refreshRoomOpt();
};
t.prototype._onSwitchRoom = function(e) {
M.Countdown.clear();
var t = e.getUserData();
f.default.Instance.sendEnterRoom(t);
};
t.prototype._onOrderShow = function() {
var e = f.RoomModelManager.Instance.getModel();
if (e.checkSelfState()) {
this._refreshRoomOpt();
L.PopHelper.Instance.closeAlert();
L.PopHelper.Instance.hideTableMenu();
L.PopHelper.Instance.hideScoreWindow();
for (var t = Object.keys(e.orderCard), o = 0; o < t.length; o++) {
var n = parseInt(t[o]), a = e.orderCard[n], i = this.createCard(a, !0), r = i.node.parent.convertToNodeSpaceAR(this.HeadManager.getOrderCardPos(n));
i.node.setPosition(r);
this._orderCards.push(i);
n == e.optData.order[0] && i.showLightBorder(!0);
}
var l = T.default.getString("TIPS_TLOSS");
if (e.optData.order[0] == C.VM.getValue("user.uid")) l = 1 == e.roomType ? T.default.getString("TIPS_WIN") : E.Tools.TStr.replaceAll(l, "%{name}", "You"); else {
var s = e.allUserData.getUserData(e.optData.order[0]);
l = E.Tools.TStr.replaceAll(l, "%{name}", s ? s.name : "");
}
L.PopHelper.Instance.showTips(l, this.PopLayer);
}
};
t.prototype._onOrderConfirm = function() {
f.RoomModelManager.Instance.getModel().checkSelfState();
};
t.prototype._onCardShow = function() {
var e = this, t = f.RoomModelManager.Instance.getModel();
L.PopHelper.Instance.closeAlert();
L.PopHelper.Instance.hideTableMenu();
L.PopHelper.Instance.hideScoreWindow();
if (this._operateCard) {
this.destoryCard(this._operateCard);
this._operateCard = null;
}
if (t.checkSelfState()) {
this._refreshRoomOpt();
var o = [];
t.handCards.forEach(function(t, o) {
var n = e.createCard(t, !1);
n.node.active = !1;
n.node.zIndex = g.CARD_ZINDEX + o;
e._dealerCards.push(n);
});
var n = function() {
e.CloseDeck.setSlotActive(!0);
e.CloseDeck.setTipsCards(t.roomData.xcard);
f.default.Instance.sendCardConfirm(o);
}, a = function() {
e.CloseDeck.getCloseDeckPosInTarget(e.Dealer.node);
e._cards.forEach(function(e) {
e.forEach(function(e) {
e && e.refreshWildCard();
});
});
e._openDeckCards.forEach(function(e) {
e && e.refreshWildCard();
});
e._wildCard && e._wildCard.refreshWildCard();
e.FinishDeck.setSlotActive(!0);
n();
}, i = function() {
e._refreshOpenDeckCard();
e.OpenDeck.setSlotActive(!0);
e._wildCard = e.createCard(t.roomData.realxcard, !1);
e._wildCard.node.zIndex = g.WILD_CARD_ZINDEX;
e._wildCard.setCloseDeckWildIcon();
var o = e.CloseDeck.getWildCardPosInTarget(e.Table);
e.Dealer.dealerWildCard(e._wildCard, o, a);
};
this.Dealer.dealerHandCard(this._dealerCards, g.CARD_HAND_POS_Y, function() {
e._dealerCards.forEach(function(t) {
e.destoryCard(t);
});
e._dealerCards.splice(0);
D.default.log("排序前", t.handCards);
o = w.default.group([ t.handCards ]);
D.default.log("手牌：", o);
e.creatHand(o);
f.default.Instance.sendSyncCard(o);
var n = e.createCard(t.optData.last[t.optData.last.length - 1], !1);
e.openDeckPushCard(n);
var a = e.OpenDeck.getOpenDeckPosInTarget(e.Table);
e.Dealer.dealerOpenDeck(n, a, i);
});
}
};
t.prototype._onCardConfirm = function() {
f.RoomModelManager.Instance.getModel().checkSelfState();
};
t.prototype._onStartRoom = function() {
if (f.RoomModelManager.Instance.getModel().checkSelfState()) {
this.showSortButton();
this.SortBtn.active = !0;
this.CardRecorder.active = !0;
this._refreshRoomOpt();
}
};
t.prototype._onDraw = function() {
var e = this, t = f.RoomModelManager.Instance.getModel();
if (t.checkOptUser()) {
this._refreshRoomOpt();
R.default.Instance.playBundleEffect(g.BundleSoundPath.common_draw);
if (0 == t.drawData.dt) (o = this.createCard(t.drawData.card, !0)) && this._pushNewCard(o, function() {
e.drawTipsAnimation();
e._checkCouldFinish();
f.default.Instance.sendSyncCard(e._handFromClient);
}); else {
var o = null, n = this.openDeckPopCard();
if (n) if (n.idx16 != t.drawData.card) {
o = this.createCard(t.drawData.card, !0);
this._openDeckCards.unshift(n);
var a = this.openDeckPopCard();
a.node.removeFromParent(!0);
a = null;
} else o = n; else o = this.createCard(t.drawData.card, !0);
o.node.position = this.OpenDeck.node.position;
this._pushNewCard(o, function() {
e._refreshOpenDeckCard();
e.drawTipsAnimation();
e._checkCouldFinish();
f.default.Instance.sendSyncCard(e._handFromClient);
});
}
L.PopHelper.Instance.hideWaiting(!0);
} else 0 == t.drawData.dt ? this.scheduleOnce(function() {
if (e && e.CloseDeck) {
e._refreshRoomOpt();
R.default.Instance.playBundleEffect(g.BundleSoundPath.common_draw);
var o = e.HeadManager.getHeadPosInTarget(e.CloseDeck.node, t.drawData.uid);
e.CloseDeck.otherUserDrawCloseAction(o, function() {});
}
}, t.optData.sim_time) : this.scheduleOnce(function() {
if (e && e.Table) {
e._refreshRoomOpt();
R.default.Instance.playBundleEffect(g.BundleSoundPath.common_draw);
var o = e.HeadManager.getHeadPosInTarget(e.Table, t.drawData.uid), n = e.openDeckPopCard();
n || (n = e.createCard(t.drawData.card, !0));
e.OpenDeck.otherUserDrawOpenAction(n, o, function() {
e.destoryCard(n);
e._refreshOpenDeckCard();
});
}
}, t.optData.sim_time);
};
t.prototype._onDiscard = function() {
var e = this, t = f.RoomModelManager.Instance.getModel();
if (t.discardData.uid == C.VM.getValue("user.uid")) {
this._refreshRoomOpt();
R.default.Instance.playBundleEffect(g.BundleSoundPath.common_discard);
var o = t.allUserData.getUserData(C.VM.getValue("user.uid"));
if (o && 2 != o.state) {
if (5 == o.state) {
this._handFromClient = E.Tools.TArray.deepCopy(t.declearCards);
this._out2Open_Client(t.discardData.card);
}
this._refreshOpenDeckCard();
this.resetGroups(this._handFromClient);
this.resetCards(this._handFromClient);
this._operateCard = null;
} else {
this._refreshOpenDeckCard();
this.resetGroups(this._handFromClient);
this.resetCards(this._handFromClient);
this._operateCard = null;
L.PopHelper.Instance.showScoreWindow(3);
}
} else this.scheduleOnce(function() {
e._refreshRoomOpt();
R.default.Instance.playBundleEffect(g.BundleSoundPath.common_discard);
var o = e.createCard(t.discardData.card, !0), n = e.HeadManager.getHeadPosInTarget(e.Table, t.discardData.uid);
e.OpenDeck.otherUserDiscardAction(o, n, function() {
e.openDeckPushCard(o);
e._refreshOpenDeckCard();
e._discard_time = Date.now();
});
}, t.optData.sim_time);
};
t.prototype._onFinish = function() {
var e = this, t = f.RoomModelManager.Instance.getModel();
this._refreshRoomOpt();
R.default.Instance.playBundleEffect(g.BundleSoundPath.common_discard);
if (t.checkOptUser()) {
if (this._operateCard) {
this._operateCard.Clicked && this._operateCard.onClick();
this.resetGroups(this._handFromClient);
this.resetCards(this._handFromClient);
}
} else {
var o = this.createCard(t.finishData.card, !1), n = this.HeadManager.getHeadPosInTarget(this.Table, t.finishData.uid);
this.FinishDeck.otherUserFinishAction(o, n, function() {
e._operateCard = o;
});
}
if (t.checkOptUser()) {
this.DeclareBtn.active = !1;
this.scheduleOnce(function() {
e.onDeclareClicked();
}, 1);
} else this.DeclareBtn.active = !1;
};
t.prototype._onDeclearSuccess = function() {
var e = f.RoomModelManager.Instance.getModel();
if (e.checkSelfState()) {
this._refreshRoomOpt();
if (e.checkIsDeclear()) {
this.DeclareBtn.active = !1;
L.PopHelper.Instance.showScoreWindow(1);
} else this.DeclareBtn.active = !0;
}
};
t.prototype._onDeclearFail = function() {
var e = this, t = f.RoomModelManager.Instance.getModel();
this.DeclareBtn.active = !1;
var o = t.allUserData.getUserData(C.VM.getValue("user.uid"));
if (o && (1 == o.state || 3 == o.state || 4 == o.state || 5 == o.state)) {
this._refreshRoomOpt();
if (t.finishData.uid == C.VM.getValue("user.uid")) {
L.PopHelper.Instance.showTips(T.default.getString("TIPS_YMAID"), this.PopLayer);
this.updateDeclareFail(!0);
} else {
var n = t.allUserData.getUserData(t.finishData.uid), a = E.Tools.TStr.replaceAll(T.default.getString("TIPS_OTHER_INVALID_DECLARE"), "%{name}", n.name);
L.PopHelper.Instance.showTips(a, this.PopLayer);
}
var i = this.OpenDeck.getOpenDeckPosInTarget(this.Table);
this.FinishDeck.finishMoveToOpen(this._operateCard, i, function() {
e.openDeckPushCard(e._operateCard);
e._refreshOpenDeckCard();
e._operateCard = null;
});
}
};
t.prototype._onReset = function() {
var e = f.RoomModelManager.Instance.getModel().allUserData.getUserData(C.VM.getValue("user.uid"));
if (e) {
this.DeclareBtn.active = !1;
this.SortBtn.active = !1;
e && 1 == e.res && R.default.Instance.playBundleEffect(g.BundleSoundPath.common_win);
this.Room_Wallet_Node[2].getComponent(cc.Label).string = E.Tools.TStr.replaceAll(T.default.getString("TABLE_PTS"), "%{num}", e ? e.tscore + "" : "0");
var t = !e || 2 == e.state, o = t ? 3 : 2;
L.PopHelper.Instance.showScoreWindow(o);
!t && this._refreshRoomOpt();
this.resetAll();
} else {
this.resetAll();
this.leaveRoom();
}
};
t.prototype._onLeave = function() {
f.RoomModelManager.Instance.getModel();
this._refreshRoomOpt();
};
t.prototype._onLeaveSingle = function() {
f.RoomModelManager.Instance.getModel();
this.leaveRoom();
};
t.prototype._onDrop = function() {
var e = f.RoomModelManager.Instance.getModel();
this._refreshRoomOpt();
if (e.dropData.uid == C.VM.getValue("user.uid")) {
var t = e.allUserData.getUserData(C.VM.getValue("user.uid"));
t && 2 != t.state ? this.updateDeclareFail(!0) : L.PopHelper.Instance.showScoreWindow(3);
} else {
var o = e.allUserData.getUserData(e.dropData.uid);
if (o && 5 != o.state) {
var n = o.name + "has dropped with " + o.score + " points.";
L.PopHelper.Instance.showTips(n, this.PopLayer);
}
}
};
t.prototype._onDismiss = function() {
var e = this, t = f.RoomModelManager.Instance.getModel();
if (1 == t.dismissData.state) this.leaveRoom(); else if (2 == t.dismissData.state) {
var o = {
content: T.default.getString("TIPS_UNABLE"),
leftTitle: T.default.getString("TABLE_BTN_NO"),
rightTitle: T.default.getString("TABLE_BTN_YES"),
leftCallFunc: function() {
e.leaveRoom();
},
rightCallFunc: function() {
e.switchTable();
},
isBanCancel: !0,
target: this
};
L.PopHelper.Instance.showAlert(o, this.PopLayer);
} else if (3 == t.dismissData.state) this.leaveRoom(); else if (4 == t.dismissData.state) {
var n;
n = O.default.getInstance().isCashGame ? {
content: T.default.getString("COMMON_TIPS_CASH"),
leftTitle: T.default.getString("SIGN_BACK"),
rightTitle: T.default.getString("COMMON_TIPS_BTN_ADDFUNDS"),
rightCallFunc: function() {
v.default.Instance.Global.emit(b.GameEvent.TABLE_LEAVE_ROOM, {
isRecharge: !0
});
},
leftCallFunc: this.leaveRoom.bind(this),
cancelCallFunc: this.leaveRoom.bind(this)
} : {
content: T.default.getString("COMMON_TIPS_CASH"),
leftTitle: T.default.getString("SIGN_BACK"),
leftCallFunc: this.leaveRoom.bind(this),
cancelCallFunc: this.leaveRoom.bind(this)
};
L.PopHelper.Instance.showAlert(n);
} else this.leaveRoom();
};
t.prototype._onKick = function() {};
t.prototype._onAutoSort = function() {
var e = f.RoomModelManager.Instance.getModel();
this._handFromClient = e.declearCards.concat();
this.resetGroups(this._handFromClient);
this.resetCards(this._handFromClient);
};
t.prototype._onRefreshTable = function() {
this.resetAll();
f.default.Instance.sendEnterRoom(this.roomId);
};
t.prototype._onAutoPlay = function(e) {
e.getUserData().uid == C.VM.getValue("user.uid") && (this.AutoPlayNode.active = !1);
this.HeadManager.hideAllCountDown();
this._refreshRoomOpt();
};
t.prototype._onScoreWindow = function() {
var e = f.RoomModelManager.Instance.getModel();
L.PopHelper.Instance.showScoreBoard(e);
};
t.prototype._onInitiateSplit = function() {
var e = f.RoomModelManager.Instance.getModel();
L.PopHelper.Instance.showSplitPrize(e);
};
t.prototype._onSplit = function() {
var e = f.RoomModelManager.Instance.getModel();
L.PopHelper.Instance.showSplitPrize(e);
};
t.prototype._onSplitResult = function() {
var e = this, t = f.RoomModelManager.Instance.getModel(), o = !0;
t.splitDataMap.forEach(function(e) {
3 == e.accepted && (o = !1);
});
L.PopHelper.Instance.hideSplitPrize();
o ? L.PopHelper.Instance.showTotalResult(t, !0, function() {
e.leaveRoom();
}) : L.PopHelper.Instance.showTips(T.default.getString("GAME_SPLIT_FAILED"));
};
t.prototype._onRejoin = function() {
var e = f.RoomModelManager.Instance.getModel(), t = e.allUserData.getUserData(e.rejoinData.uid);
1 == e.rejoinData.rejoin && L.PopHelper.Instance.showTips(t.name + " " + T.default.getString("GAME_REJOIN_SUCCESS"));
2 == e.rejoinData.rejoin && L.PopHelper.Instance.showTips(T.default.getString("GAME_REJOIN_FAILED"));
3 == e.rejoinData.rejoin && L.PopHelper.Instance.showTips(T.default.getString("GAME_REJOIN_FAILED"));
4 == e.rejoinData.rejoin && L.PopHelper.Instance.showTips(T.default.getString("GAME_REJOIN_FAILED"));
this._refreshRoomOpt();
};
t.prototype._onReady = function() {
this._refreshRoomOpt();
};
t.prototype.switchTable = function() {
var e = f.RoomModelManager.Instance.getModel().roomData.rtype;
f.RoomModelManager.Instance.clearModel();
f.default.Instance.sendSwitchRoom(e);
var t = this.WaittingNode.getChildByName("SwitchButton").getComponent(cc.Button), o = cc.find("Background/Label", t.node).getComponent(cc.Label);
A.UIUtils.disableButton(3, t, o);
};
t.prototype.resetAll = function() {
var e = this;
D.default.log("----------牌桌重置----------");
this.OpenDeck.reset();
this.FinishDeck.reset();
this.CloseDeck.reset();
this.Dealer.reset();
this._orderCards.forEach(function(t) {
e.destoryCard(t);
});
this._orderCards.splice(0);
this._dealerCards.forEach(function(t) {
e.destoryCard(t);
});
this._dealerCards.splice(0);
this._openDeckCards.forEach(function(t) {
e.destoryCard(t);
});
this._openDeckCards.splice(0);
this._selectCards.splice(0);
this._groups.forEach(function(e) {
e.node.removeFromParent(!0);
e.node.destroy();
});
this._groups.splice(0);
this._cards.forEach(function(t) {
t.forEach(function(t) {
e.destoryCard(t);
});
});
this._cards.splice(0);
this.destoryCard(this._wildCard);
this._wildCard = null;
this.destoryCard(this._operateCard);
this._operateCard = null;
this.CardRecorder.active = !1;
this.DeclareFail.active = !1;
this.DeclareBtn.active = !1;
this.SortBtn.active = !1;
this._discard_time = 0;
M.GroupHelper.setIsShowWildCard(!1);
this.Table.children.forEach(function(e) {
if (e && e.isValid && null != e.getComponent(r.default)) {
e.removeFromParent(!0);
e.destroy();
}
});
};
t.prototype.updateDeclareFail = function(e) {
void 0 === e && (e = !1);
var t = f.RoomModelManager.Instance.getModel(), o = t.allUserData.getUserData(C.VM.getValue("user.uid")), n = I.default.Instance.getGamePlay(t.roomData.rtype);
if (n.cls == S.GameEnum.PlayType.RUMMY_POOL || n.cls == S.GameEnum.PlayType.RUMMY_DEALS) {
this.DeclareFail.active = !(5 != t.optData.state && 6 != t.optData.state && 7 != t.optData.state || 3 != o.res && 4 != o.res || 5 == o.state);
this.DeclareFail.getChildByName("SwitchButton").active = !1;
} else if (5 != t.optData.state && 6 != t.optData.state && 7 != t.optData.state || 3 != o.res) {
this.DeclareFail.active = !1;
this.DeclareFail.getChildByName("SwitchButton").active = !1;
} else {
this.DeclareFail.active = !0;
this.DeclareFail.getChildByName("SwitchButton").active = !0;
6 == n.max && e && L.PopHelper.Instance.showScoreWindow(5);
}
};
t.prototype.leaveRoom = function() {
L.PopHelper.Instance.closeCountdown(this._countDownKey);
v.default.Instance.Global.emit(b.GameEvent.TABLE_LEAVE_ROOM, {
isRecharge: this._isOpenRecharge
});
this.HeadManager && this.HeadManager.reset();
this._init = !1;
};
t.prototype.levelRoomScore = function(e) {
var t = f.RoomModelManager.Instance.getModel(), o = t.allUserData.getUserData(C.VM.getValue("user.uid"));
return e && o ? 6 == t.optData.state || 7 == t.optData.state ? e.base * e.rate : o.draw ? e.base * Math.ceil(e.rate / 2) : e.base * Math.ceil(e.rate / 4) : "undefined";
};
t.prototype.leaveRoomConfirm = function() {
var e = f.RoomModelManager.Instance.getModel(), t = I.default.Instance.getGamePlay(e.roomData.rtype), o = e.allUserData.getUserData(C.VM.getValue("user.uid"));
if (t) if (!t || t.cls != S.GameEnum.PlayType.RUMMY_POINTS && t.cls != S.GameEnum.PlayType.RUMMY_TENCARD || !o || 0 != o.state) if (t.cls == S.GameEnum.PlayType.RUMMY_POOL || t.cls == S.GameEnum.PlayType.RUMMY_DEALS) if (0 != e.optData.state && 1 != e.optData.state && 9 != e.optData.state && o && 4 != o.res) if (2 == e.optData.state && 1 == e.roomData.round) f.default.Instance.sendLeave(!1); else {
var n = {
content: T.default.getString("TIPS_LEAVE_TABLE_POOL"),
leftTitle: T.default.getString("TABLE_BTN_NO"),
rightTitle: T.default.getString("TABLE_BTN_YES"),
rightCallFunc: function() {
f.default.Instance.sendLeave(!0);
},
target: this
};
L.PopHelper.Instance.showAlert(n, this.PopLayer);
} else f.default.Instance.sendLeave(!1); else if (0 != e.optData.state && 1 != e.optData.state && 2 != e.optData.state && o && 0 == o.res) {
var a = "";
if (t.currency == S.GameEnum.MoneyType.CASH || t.currency == S.GameEnum.MoneyType.GOLD) {
var i = this.levelRoomScore(t);
a = E.Tools.TStr.replaceAll(T.default.getString("TIPS_LEAVE_TABLE"), "%{num}", i);
} else a = T.default.getString("TIPS_LEAVE");
n = {
content: a,
leftTitle: T.default.getString("TABLE_BTN_NO"),
rightTitle: T.default.getString("TABLE_BTN_YES"),
rightCallFunc: function() {
f.default.Instance.sendLeave(!0);
},
target: this
};
L.PopHelper.Instance.showAlert(n, this.PopLayer);
} else f.default.Instance.sendLeave(!1); else f.default.Instance.sendLeave(!1); else this.leaveRoom();
};
t.prototype.switchTableConfirm = function(e, t) {
var o = this;
void 0 === t && (t = !0);
var n = f.RoomModelManager.Instance.getModel(), a = I.default.Instance.getGamePlay(n.roomData.rtype), i = n.allUserData.getUserData(C.VM.getValue("user.uid")), r = a && (a.cls == S.GameEnum.PlayType.RUMMY_POINTS || a.cls == S.GameEnum.PlayType.RUMMY_TENCARD) && i && 0 == i.state, l = 0 == n.optData.state || 1 == n.optData.state || 2 == n.optData.state, s = 3 == i.state || 6 == n.optData.state && 0 != i.res;
if (r || l || s) this.switchTable(); else {
if (a) {
var c = 0;
a.currency == S.GameEnum.MoneyType.GOLD && (c = C.VM.getValue("wallet.gold"));
a.currency == S.GameEnum.MoneyType.CASH && (c = C.VM.getValue("wallet.total"));
if (a.min_entry > c) {
var u = {
title: T.default.getString("PROMPT_NOTICE"),
content: T.default.getString("COMMON_TIPS_CASH"),
rightTitle: T.default.getString("COMMON_TIPS_BTN_ADDFUNDS"),
rightCallFunc: function() {
e && e(!0);
},
cancelCallFunc: function() {
e && e(!1);
}
};
L.PopHelper.Instance.showAlert(u);
return;
}
}
if (t) {
var d = "";
if (a.currency == S.GameEnum.MoneyType.CASH || a.currency == S.GameEnum.MoneyType.GOLD) {
var p = this.levelRoomScore(a);
d = E.Tools.TStr.replaceAll(T.default.getString("TIPS_LEAVE_TABLE"), "%{num}", p);
} else d = T.default.getString("TIPS_SWITCH_TABLE");
var h = {
content: d,
leftTitle: T.default.getString("TABLE_BTN_NO"),
leftCallFunc: e,
rightTitle: T.default.getString("TABLE_BTN_YES"),
rightCallFunc: function() {
o.switchTable();
},
cancelCallFunc: e,
target: this
};
L.PopHelper.Instance.showAlert(h, this.PopLayer);
} else this.switchTable();
}
};
t.prototype._checkFinish = function(e) {
var t = this;
void 0 === e && (e = !0);
var o = f.RoomModelManager.Instance.getModel(), n = I.default.Instance.getGamePlay(o.roomData.rtype), a = 0, i = -1, r = -1;
this._cards.forEach(function(e) {
e.forEach(function() {
a++;
});
});
if ((1 != o.optData.cstate || 0 != this._selectCards.length) && e) return {
groupIndex: i,
cardIndex: r
};
if (n.cls == S.GameEnum.PlayType.RUMMY_POINTS && 14 != a) return {
groupIndex: i,
cardIndex: r
};
if (n.cls == S.GameEnum.PlayType.RUMMY_TENCARD && 11 != a) return {
groupIndex: i,
cardIndex: r
};
var l = 0;
this._groups.forEach(function(e) {
0 != e.score && l++;
});
if (0 == l) for (var s = 0, c = this._cards.length; s < c; s++) {
var u = this._cards[s];
if (u.length >= 4) {
for (var d = 999, p = 0, h = u.length; p < h; p++) {
var _ = u[p];
if (!M.GroupHelper.checkWild(_.idx16, o.roomData.xcard) && _.idx16 < d) {
d = _.idx16;
r = p;
}
}
if (-1 != r) {
i = s;
break;
}
}
}
1 == l && this._cards.forEach(function(e, n) {
if (1 == e.length && !M.GroupHelper.checkWild(t._cards[n][0].idx16, o.roomData.xcard)) {
i = n;
r = e.length - 1;
}
});
return {
groupIndex: i,
cardIndex: r
};
};
t.prototype.setFinishCard = function(e, t) {
if (-1 != e && -1 != t) {
var o = this._cards[e][t];
o.onClick();
this.addSelectCard(o);
this.refreshBottomBtns();
}
};
t.prototype.__checkCouldFinish = function() {
var e = f.RoomModelManager.Instance.getModel(), t = this._checkFinish(!1);
return -1 != t.groupIndex && -1 != t.cardIndex || 2 == y.default.Instance.putCard(E.Tools.TArray.flatten(this._handFromClient), e.roomData.xcard).type && 14 == E.Tools.TArray.getLength(this._handFromClient);
};
t.prototype._checkCouldFinish = function() {
var e = f.RoomModelManager.Instance.getModel(), t = this._checkFinish(!1);
if (-1 != t.groupIndex && -1 != t.cardIndex) this.setFinishCard(t.groupIndex, t.cardIndex); else {
var o = y.default.Instance.putCard(E.Tools.TArray.flatten(this._handFromClient), e.roomData.xcard);
if (2 == o.type && 14 == E.Tools.TArray.getLength(this._handFromClient)) for (var n = 0; n < this._cards.length; ++n) for (var a = this._cards[n], i = 0; i < a.length; ++i) if (o.card == a[i].idx16) {
this.setFinishCard(n, i);
return;
}
}
};
t.prototype.__checkFinish = function() {
var e = f.RoomModelManager.Instance.getModel(), t = this._checkFinish(!1);
if (-1 != t.groupIndex && -1 != t.cardIndex) return !0;
var o = y.default.Instance.putCard(E.Tools.TArray.flatten(this._handFromClient), e.roomData.xcard);
if (2 == o.type) {
this._handFromClient = o.lastCards.concat([ [ o.card ] ]);
this.resetGroups(this._handFromClient);
this.resetCards(this._handFromClient);
this._curTouchCardGroupIndex = this._groups.length - 1;
this._curTouchCardIndex = this._cards[this._curTouchCardGroupIndex].length - 1;
this._selectCards.length = 0;
this._selectCards.push(this._cards[this._curTouchCardGroupIndex][this._curTouchCardIndex]);
return !0;
}
L.PopHelper.Instance.showTips(T.default.getString("GAME_COULDNOT_FINISH"));
return !1;
};
t.prototype.showFinishAlert = function(e, t) {
var o = f.RoomModelManager.Instance.getModel(), n = this._checkFinish(!1);
if (-1 != n.groupIndex && -1 != n.cardIndex) e(); else {
var a = y.default.Instance.putCard(E.Tools.TArray.flatten(this._handFromClient), o.roomData.xcard);
if (2 == a.type) {
this._handFromClient = a.lastCards;
e(a.card);
} else {
L.PopHelper.Instance.showTips(T.default.getString("GAME_COULDNOT_FINISH"));
t && t();
}
}
};
t.prototype.drawTipsAnimation = function() {
var e = this;
this.scheduleOnce(function() {
var t, o = f.RoomModelManager.Instance.getModel(), n = -1;
e._cards.forEach(function(e, a) {
e.forEach(function(e, i) {
if (e.idx16 == o.drawData.card) {
t = a;
n = i;
}
});
});
if (-1 != t && -1 != n) {
var a = e._cards[t][n];
a && a.drawTipAnimation();
}
});
};
t.prototype.playAutoSortAnimation = function(e, t) {
var o = this;
if (E.Tools.TArray.equals(e, this._handFromClient)) return !1;
this._curTouchCardMoved = !0;
for (var n = [], a = 0; a < this._handFromClient.length; a++) for (var i = this._handFromClient[a], r = 0; r < i.length; r++) for (var l = this._handFromClient[a][r], s = 0; s < e.length; s++) {
for (var c = e[s], u = !1, d = 0; d < c.length; d++) if (l == e[s][d]) {
for (var p = !1, h = 0; h < n.length; h++) n[h].toI == s && n[h].toJ == d && (p = !0);
if (!p) {
n.push({
fromI: a,
fromJ: r,
toI: s,
toJ: d
});
u = !0;
break;
}
}
if (u) break;
}
var _ = this._getCardsPosition(e), m = f.RoomModelManager.Instance.getModel().optData.cstate;
n.forEach(function(e, a) {
o._cards[e.fromI][e.fromJ].moveCard(.3, _[e.toI][e.toJ], g.HAND_CARD_SCALE, g.HAND_CARD_SCALE, null, !1, !1);
a == n.length - 1 && o.scheduleOnce(function() {
t && t.apply(o);
1 == m && o.scheduleOnce(function() {
o.drawTipsAnimation();
}, .1);
}, .31);
});
return !0;
};
t.prototype.onDropClicked = function() {
if (f.RoomModelManager.Instance.getModel().checkDrop()) {
var e = {
content: T.default.getString("TIPS_DROP"),
rightTitle: T.default.getString("TABLE_BTN_YES"),
leftTitle: T.default.getString("TABLE_BTN_NO"),
rightCallFunc: function() {
f.default.Instance.sendDrop();
}
};
L.PopHelper.Instance.showAlert(e);
}
};
t.prototype.onFinishClicked = function() {
if (f.RoomModelManager.Instance.getModel().checkDiscard() && this.__checkFinish()) {
var e = 1 == this._selectCards.length ? this._selectCards[0] : null;
if (e) {
this.OperationTips.hideOperationTips();
this._removeCard(e);
this._operateCard = e;
e.Clicked && e.onClick();
this.FinishDeck.selfFinishAction(e, function() {});
f.default.Instance.sendFinish(e.idx16, this._handFromClient);
}
}
};
t.prototype.onDiscardClicked = function() {
var e = this, t = f.RoomModelManager.Instance.getModel(), o = 1 == this._selectCards.length ? this._selectCards[0] : null;
if (t.checkDiscard() && o) {
this.OperationTips.hideOperationTips();
this._removeCard(o);
this._operateCard = o;
o.Clicked && o.onClick();
this.OpenDeck.selfDisCardAction(o, function() {
e.openDeckPushCard(o);
e._refreshOpenDeckCard();
});
f.default.Instance.sendDiscard(o.idx16, this._handFromClient);
}
};
t.prototype.onGroupClicked = function() {
var e = this, t = f.RoomModelManager.Instance.getModel(), o = E.Tools.TArray.deepCopy(this._handFromClient);
this._selectCards.forEach(function(t) {
var n = e._getCardIndex(t);
if (-1 != n.groupIndex && -1 != n.cardIndex) {
var a = o[n.groupIndex].indexOf(t.idx16);
-1 != a && o[n.groupIndex].splice(a, 1);
}
});
for (var n = o.length - 1; n >= 0; n--) 0 == o[n].length && o.splice(n, 1);
if (o.length < g.MAX_GROUPCOUNT) {
var a = [];
this._selectCards.forEach(function(t) {
a.push(t.idx16);
e._removeCard(t);
e.destoryCard(t);
});
this.clearAllSelectCard();
this._handFromClient.unshift(a);
this.resetGroups(this._handFromClient);
this.resetCards(this._handFromClient);
f.default.Instance.sendSyncCard(this._handFromClient);
} else {
var i = 0;
o.forEach(function(e) {
M.GroupHelper.getGroupType(e, t.roomData.xcard) == S.GameEnum.GroupType.Invalid && i++;
});
if (i > 1) {
var r = [];
this._selectCards.forEach(function(t) {
r.push(t.idx16);
e._removeCard(t);
e.destoryCard(t);
});
this.clearAllSelectCard();
var l = 0, s = [];
for (n = o.length - 1; n >= 0; n--) if (M.GroupHelper.getGroupType(o[n], t.roomData.xcard) == S.GameEnum.GroupType.Invalid && l < 2) {
var c = this._handFromClient.splice(n, 1);
s = s.concat(c[0]);
l++;
}
this._handFromClient.push(s);
this._handFromClient.unshift(r);
this.resetGroups(this._handFromClient);
this.resetCards(this._handFromClient);
f.default.Instance.sendSyncCard(this._handFromClient);
} else {
var u = E.Tools.TStr.replaceAll(T.default.getString("TIPS_GROUPS"), "%{num}", g.MAX_GROUPCOUNT);
L.PopHelper.Instance.showTips(u, this.PopLayer);
}
}
};
t.prototype.onReadyBtnClicked = function() {
var e = f.RoomModelManager.Instance.getModel();
e.roomData.ready_switch && 2 == e.optData.state && f.default.Instance.sendReady();
};
t.prototype.onCardRecorderClicked = function() {
var e = f.RoomModelManager.Instance.getModel();
L.PopHelper.Instance.showCardRecorder(e, this.PopLayer);
};
t.prototype.onLeaveClicked = function() {
var e = f.RoomModelManager.Instance.getModel(), t = I.default.Instance.getGamePlay(e.roomData.rtype), o = null != t ? t.cls : S.GameEnum.PlayType.RUMMY_POOL, n = {
leaveCallFunc: this.leaveRoomConfirm,
switchCallFunc: this.switchTableConfirm,
playType: o,
target: this
};
L.PopHelper.Instance.showTableMenu(n, this.PopLayer);
};
t.prototype.onSequenceBulbClicked = function() {
this.SequenceBulb.showBulb();
};
t.prototype.onAutoSortClicked = function() {
var e = this, t = f.RoomModelManager.Instance.getModel();
this.hideSortTips();
var o;
o = null == t.declearAutoSortCards || t.declearAutoSortCards.length <= 0 ? G.default.Instance.getHands(this._handFromClient, t.roomData.xcard) : E.Tools.TArray.deepCopy(t.declearAutoSortCards);
D.default.log(o);
D.default.log(this._handFromClient);
return this.playAutoSortAnimation(o, function() {
e._handFromClient = o;
e.resetGroups(e._handFromClient);
e.resetCards(e._handFromClient);
});
};
t.prototype.onDeclareClicked = function() {
var e = this, t = f.RoomModelManager.Instance.getModel();
if (6 == t.optData.state) if (0 == M.GroupHelper.getTotalScore(this._handFromClient, t.roomData.xcard, this._maxScore, t.roomData.mcard)) f.default.Instance.sendDeclear(this._handFromClient); else {
var o = {
content: T.default.getString("GAME_FRAUD_FINISH_TIP"),
leftTitle: T.default.getString("TABLE_BTN_YES"),
rightTitle: T.default.getString("TABLE_BTN_NO"),
leftCallFunc: function() {
f.default.Instance.sendDeclear(e._handFromClient);
}
};
L.PopHelper.Instance.showAlert(o);
} else if (M.GroupHelper.isBestDeclare(this._handFromClient, t.roomData.xcard, this._maxScore, t.roomData.mcard)) f.default.Instance.sendDeclear(this._handFromClient); else {
o = {
content: T.default.getString("TIPS_DECLARE_CONFIRM"),
leftTitle: T.default.getString("TABLE_DECLARE"),
rightTitle: T.default.getString("ALERT_BTN_CHECK"),
leftCallFunc: function() {
f.default.Instance.sendDeclear(e._handFromClient);
}
};
L.PopHelper.Instance.showAlert(o);
}
};
t.prototype.onVaildTipsClick = function() {};
t.prototype.onClickWildCard = function() {
5 == f.RoomModelManager.Instance.getModel().optData.state && this.CloseDeck.showWildTips();
};
t.prototype.onCloseDeckClicked = function() {
var e = f.RoomModelManager.Instance.getModel();
if (5 == e.optData.state) if (e.checkOptUser()) {
if (0 == e.optData.cstate) {
this.OperationTips.hideOperationTips();
f.default.Instance.sendDraw(0);
var t = cc.v2(this.CloseDeck.node.x, this.CloseDeck.node.y);
t = this.CloseDeck.node.parent.convertToWorldSpaceAR(t);
L.PopHelper.Instance.showWaiting(.4, t);
}
if (1 == e.optData.cstate) {
var o = T.default.getString("TIPS_CARD");
this.showDeckTips(this.CloseDeck.node, o);
}
} else {
o = T.default.getString("TIPS_WAIT");
this.showDeckTips(this.CloseDeck.node, o);
}
};
t.prototype.onFinishDeckClicked = function() {
var e = f.RoomModelManager.Instance.getModel();
if (5 == e.optData.state) if (e.checkOptUser()) {
if (0 == e.optData.cstate) {
var t = T.default.getString("TIPS_BEFOR");
this.showDeckTips(this.FinishDeck.node, t);
}
if (1 == e.optData.cstate) {
t = T.default.getString("TIPS_SELECT");
this.showDeckTips(this.FinishDeck.node, t);
}
} else {
t = T.default.getString("TIPS_TURN");
this.showDeckTips(this.FinishDeck.node, t);
}
};
t.prototype.onOpenDeckClicked = function() {
var e = f.RoomModelManager.Instance.getModel();
if (5 == e.optData.state) if (e.checkOptUser()) {
if (0 == e.optData.cstate) {
if (Date.now() - this._discard_time < 300) return;
var t = e.optData.last[e.optData.last.length - 1];
if (!M.GroupHelper.checkWild(t, e.roomData.xcard) || 0 == e.optData.circle && 0 == e.optData.curr) {
this.OperationTips.hideOperationTips();
f.default.Instance.sendDraw(1);
var o = cc.v2(this.OpenDeck.node.x, this.OpenDeck.node.y);
o = this.OpenDeck.node.parent.convertToWorldSpaceAR(o);
L.PopHelper.Instance.showWaiting(.4, o);
} else L.PopHelper.Instance.showTips(T.default.getString("TIPS_JOKER"), this.PopLayer);
}
if (1 == e.optData.cstate) {
var n = T.default.getString("TIPS_CARD");
this.showDeckTips(this.OpenDeck.node, n);
}
} else {
n = T.default.getString("TIPS_WAIT");
this.showDeckTips(this.OpenDeck.node, n);
}
};
t.prototype.showDeckTips = function(e, t) {
var o = this, n = cc.v2(e.x, e.y - e.height / 2 - 10);
cc.find("DeckTips/TipsLab", this.DeckTips).getComponent(cc.Label).string = t;
this.DeckTips.setPosition(n);
if (-1 != this._deckTipsTimeId) {
clearTimeout(this._deckTipsTimeId);
this._deckTipsTimeId = -1;
}
this.DeckTips.active = !0;
this._deckTipsTimeId = setTimeout(function() {
o.DeckTips && (o.DeckTips.active = !1);
}, 3e3);
};
t.prototype.hideDeckTips = function() {
if (-1 != this._deckTipsTimeId) {
clearTimeout(this._deckTipsTimeId);
this._deckTipsTimeId = -1;
}
this.DeckTips.active = !1;
};
t.prototype.onHelpClicked = function() {
P.default.Instance.addBundleMaskLayer(g.BundleUIPath.HelpView);
};
t.prototype.onSettingClicked = function() {
P.default.Instance.addBundleMaskLayer(g.BundleUIPath.GameSetting);
};
t.prototype.onRechargeClicked = function() {
_.default.Instance.openRecharge();
};
t.prototype.showNewGroup = function() {
if (!this.NewGroup.active && this._cards.length < g.MAX_GROUPCOUNT) {
var e = this._cards[this._cards.length - 1];
if (!e) return;
var t = e[e.length - 1];
if (!t || !t.node) return;
var o = t.node.getPosition();
o.x = o.x + M.GroupHelper.CardWidth();
this.NewGroup.setPosition(o);
this.NewGroup.active = !0;
}
};
t.prototype.hideNewGroup = function() {
this.NewGroup.active = !1;
};
t.prototype.onAutoPlayClicked = function() {
f.default.Instance.sendAutoPlay();
};
t.prototype.onScoreBoardClicked = function() {
f.default.Instance.sendScoreBoard();
};
t.prototype.onRefreshClicked = function() {
var e = this.RefreshButton.node.getChildByName("Time").getComponent(cc.Label);
A.UIUtils.disableButton(3, this.RefreshButton, e);
this._onRefreshTable();
};
t.prototype._resetTouch = function() {
this._curTouchCardMoved = !1;
this._curTouchCardGroupIndex = -1;
this._curTouchCardIndex = -1;
this._curDestIndex = -1;
this._curDestGroupIndex = -1;
this._curDestPosition = null;
this._curTouchCard = null;
this._curTouchCarDest = cc.Vec2.ZERO;
this._hasTouchCard = !1;
};
t.prototype._getTouchCard = function(e) {
if (this._curTouchCardMoved) return !1;
for (var t = this._cards.length - 1; t >= 0; t--) for (var o = this._cards[t], n = o.length - 1; n >= 0; n--) {
var a = o[n];
if (a.box.contains(e)) {
this._curTouchCardGroupIndex = t;
this._curTouchCardIndex = n;
this._curDestGroupIndex = t;
this._curDestIndex = n;
this._curTouchCard = a;
this._curTouchCarDest = a.pos;
this._curDestPosition = a.pos;
return !0;
}
}
return !1;
};
t.prototype._checkChangeGroup = function(e) {
var t = this._groups.length - 1;
if (this._curDestGroupIndex < 0 || this._curDestGroupIndex > t) return !1;
var o = this._groups[this._curDestGroupIndex].node.getBoundingBoxToWorld(), n = this._curTouchCard.box.xMin, a = this._curTouchCard.box.xMax, i = o.xMin, r = o.xMax;
if (e > 0 && a > r && this._curDestGroupIndex < t) {
this._groups[this._curDestGroupIndex].node.width -= M.GroupHelper.CardShowWidth();
this._groups[this._curDestGroupIndex].node.x -= M.GroupHelper.CardShowWidth() / 2;
this._curDestGroupIndex++;
this._groups[this._curDestGroupIndex].node.width += M.GroupHelper.CardShowWidth();
this._groups[this._curDestGroupIndex].node.x -= M.GroupHelper.CardShowWidth() / 2;
this._curDestIndex = 0;
if (!(l = this._cards[this._curDestGroupIndex][this._curDestIndex])) return !1;
this._curDestPosition = l.pos.sub(cc.v2(M.GroupHelper.CardShowWidth(), 0));
return !0;
}
if (e < 0 && n < i && this._curDestGroupIndex > 0) {
this._groups[this._curDestGroupIndex].node.width -= M.GroupHelper.CardShowWidth();
this._groups[this._curDestGroupIndex].node.x += M.GroupHelper.CardShowWidth() / 2;
this._curDestGroupIndex--;
this._groups[this._curDestGroupIndex].node.width += M.GroupHelper.CardShowWidth();
this._groups[this._curDestGroupIndex].node.x += M.GroupHelper.CardShowWidth() / 2;
this._curDestIndex = this._cards[this._curDestGroupIndex].length;
var l;
if (!(l = this._cards[this._curDestGroupIndex][this._curDestIndex - 1])) return !1;
this._curDestPosition = l.pos.add(cc.v2(M.GroupHelper.CardShowWidth(), 0));
return !0;
}
return !1;
};
t.prototype._onCardMove = function(e) {
this._curTouchCardMoved = !0;
if (this._curTouchCard && this._curTouchCard.node) {
var t = this._curTouchCard.pos.x;
this._curTouchCard.pos = this._curTouchCard.pos.add(e);
if (!this._checkChangeGroup(e.x)) for (var o = this._curTouchCard.pos.x, n = this._cards.length - 1; n >= 0; n--) for (var a = this._cards[n], i = a.length - 1; i >= 0; i--) {
var r = a[i];
if (r != this._curTouchCard) {
var l = r.pos.x;
if (l > t + 8 && l <= o + 8) {
this._curDestGroupIndex = n;
this._curDestIndex = i;
this._curDestPosition = cc.v2(r.pos.x, r.pos.y);
r.toLeft();
break;
}
if (l < t - 8 && l >= o - 8) {
this._curDestGroupIndex = n;
this._curDestIndex = i;
this._curDestPosition = cc.v2(r.pos.x, r.pos.y);
r.toRight();
break;
}
}
}
}
};
t.prototype._onCardMoveEnd = function(e) {
if (this._curTouchCard && this._curTouchCard.node) if (7 == e) {
var t = this._groups[0].node.getBoundingBox().xMin, o = this._groups[this._groups.length - 1].node.getBoundingBox().xMax;
if (this._curTouchCard.pos.x <= o && this._curTouchCard.pos.x >= t) {
this._cards[this._curTouchCardGroupIndex].splice(this._curTouchCardIndex, 1);
this._cards[this._curDestGroupIndex].splice(this._curDestIndex, 0, this._curTouchCard);
this._curDestGroupIndex, this._curTouchCardGroupIndex;
this._cards2hand();
} else if (this._curTouchCard.pos.x < t) if (this._groups.length < g.MAX_GROUPCOUNT) {
this._cards[0][0] == this._curTouchCard ? this._curDestPosition = this._cards[0][1].pos.sub(cc.v2(M.GroupHelper.CardShowWidth() + M.GroupHelper.GroupDefaultWidth() / 2, 0)) : this._curDestPosition = this._cards[0][0].pos.sub(cc.v2(M.GroupHelper.CardShowWidth() + M.GroupHelper.GroupDefaultWidth() / 2, 0));
this._cards[this._curTouchCardGroupIndex].splice(this._curTouchCardIndex, 1);
this._cards.unshift([ this._curTouchCard ]);
this._cards2hand();
} else {
var n = E.Tools.TStr.replaceAll(T.default.getString("TIPS_GROUPS"), "%{num}", g.MAX_GROUPCOUNT);
L.PopHelper.Instance.showTips(n, this.PopLayer);
this._card2Original();
} else if (this._curTouchCard.pos.x > o) if (this._groups.length < g.MAX_GROUPCOUNT) {
var a = this._cards.length - 1, i = this._cards[a].length - 1;
if (this._cards[a][i] == this._curTouchCard) {
if (i - 1 < 0) return;
this._curDestPosition = this._cards[a][i - 1].pos.add(cc.v2(M.GroupHelper.CardShowWidth() + M.GroupHelper.GroupDefaultWidth() / 2, 0));
} else this._curDestPosition = this._cards[a][i].pos.add(cc.v2(M.GroupHelper.CardShowWidth() + M.GroupHelper.GroupDefaultWidth() / 2, 0));
this._cards[this._curTouchCardGroupIndex].splice(this._curTouchCardIndex, 1);
this._cards.push([ this._curTouchCard ]);
this._cards2hand();
} else {
n = E.Tools.TStr.replaceAll(T.default.getString("TIPS_GROUPS"), "%{num}", g.MAX_GROUPCOUNT);
L.PopHelper.Instance.showTips(n, this.PopLayer);
this._card2Original();
}
f.default.Instance.sendSyncCard(this._handFromClient);
} else if (8 == e) {
this._curTouchCard.onClick();
this.addSelectCard(this._curTouchCard);
}
};
t.prototype._getTouchStartAction = function(e) {
this.CloseDeck.node.getBoundingBoxToWorld().contains(e) ? this._touchStartType = 1 : this.OpenDeck.node.getBoundingBoxToWorld().contains(e) ? this._touchStartType = 2 : this._touchStartType = 0;
};
t.prototype._getTouchMoveAction = function(e) {
var t = f.RoomModelManager.Instance.getModel();
return this._hasTouchCard && this.FinishDeck.node.getBoundingBoxToWorld().contains(e) && t.checkDiscard() ? 3 : this._hasTouchCard && this.OpenDeck.node.getBoundingBoxToWorld().contains(e) && t.checkDiscard() ? 5 : this._hasTouchCard && this._curTouchCard && this._curTouchCard.node && this._curTouchCard.node.scale <= g.SCALE_DESK && t.checkDiscard() ? 6 : this._hasTouchCard && (1 == this._touchStartType || 2 == this._touchStartType) && t.checkDraw() ? 10 : 0;
};
t.prototype._getTouchEndAction = function(e) {
var t = f.RoomModelManager.Instance.getModel();
return !this._hasTouchCard && this.CloseDeck.node.getBoundingBoxToWorld().contains(e) ? 1 : !this._hasTouchCard && this.FinishDeck.node.getBoundingBoxToWorld().contains(e) ? 2 : this._hasTouchCard && this.FinishDeck.node.getBoundingBoxToWorld().contains(e) && t.checkDiscard() ? 3 : !this._hasTouchCard && this.OpenDeck.node.getBoundingBoxToWorld().contains(e) ? 4 : this._hasTouchCard && this.OpenDeck.node.getBoundingBoxToWorld().contains(e) && t.checkDiscard() ? 5 : this._hasTouchCard && this._curTouchCard && this._curTouchCard.node && this._curTouchCard.node.scale <= g.SCALE_DESK && t.checkDiscard() ? 6 : this._hasTouchCard && this._curTouchCardMoved ? 7 : this._hasTouchCard && !this._curTouchCardMoved ? 8 : this._hasTouchCard || this._curTouchCardMoved || null == this._wildCard || !this._wildCard.node.getBoundingBoxToWorld().contains(e) ? 0 : 9;
};
t.prototype._onTouchStart = function(e) {
var t = e.getLocation();
this._resetTouch();
this._getTouchStartAction(t);
1 == this._touchStartType || 2 == this._touchStartType || 0 == this._touchStartType && (this._hasTouchCard = this._getTouchCard(t));
this.hideDeckTips();
this.CloseDeck.hideWildTips();
};
t.prototype._onTouchMove = function(e) {
var t = e.getDelta();
if (this._hasTouchCard) {
this.showNewGroup();
this._onCardMove(t);
var o = e.getLocation(), n = this._getTouchMoveAction(o);
if (0 == n) this._translucentCard && this._translucentCard.node && this._translucentCard.isValid && (this._translucentCard.node.active = !1); else if (10 == n) ; else {
var a = f.RoomModelManager.Instance.getModel(), i = null;
3 == n ? i = this.FinishDeck.node.getPosition() : 5 != n && 6 != n || (i = this.OpenDeck.node.getPosition());
if (!this._translucentCard || !this._translucentCard.node || !this._translucentCard.isValid) {
this._translucentCard = this.createCard(this._curTouchCard.idx16, !0);
this._translucentCard.node.scale = g.SCALE_DESK;
this._translucentCard.node.zIndex = g.DECK_ZINDEX + 20;
}
this._translucentCard.node.active = !0;
this._translucentCard.showTranslucentMask(!0);
this._translucentCard.node.setPosition(i);
this._translucentCard.init(this._curTouchCard.idx16, !0, a.roomData.xcard);
}
}
};
t.prototype._onTouchEnd = function(e) {
var t = this, o = e.getLocation(), n = this._getTouchEndAction(o), a = this._curTouchCard, i = this._curDestPosition;
if (this._curTouchCardMoved) {
this.clearAllSelectCard();
this._curTouchCard && this._curTouchCard.Clicked && this._curTouchCard.onClick();
}
this.hideNewGroup();
this._translucentCard && this._translucentCard.node && this._translucentCard.isValid && (this._translucentCard.node.active = !1);
1 == n ? this.onCloseDeckClicked() : 2 == n ? this.onFinishDeckClicked() : 3 == n ? this._out2Finish() : 4 == n ? this.onOpenDeckClicked() : 5 == n ? this._out2Open() : 6 == n ? this._out2Open() : 7 == n ? this._onCardMoveEnd(n) : 8 == n ? this._onCardMoveEnd(n) : 9 == n && this.onClickWildCard();
3 != n && this._resetTouch();
if (7 == n) if (i) a.moveCard(.1, i, g.HAND_CARD_SCALE, g.HAND_CARD_SCALE, function() {
t.resetGroups(t._handFromClient);
t.resetCards(t._handFromClient);
}); else {
this.resetGroups(this._handFromClient);
this.resetCards(this._handFromClient);
}
};
t.prototype._onTouchCancel = function() {
this._card2Original();
};
t.prototype._bindTouchFunc = function() {
var e = this;
this.Root.on(cc.Node.EventType.TOUCH_START, function(t) {
e._onTouchStart(t);
});
this.Root.on(cc.Node.EventType.TOUCH_MOVE, function(t) {
var o = t.getStartLocation(), n = t.getLocation();
Math.abs(o.subSelf(n).mag()) > 20 && e._onTouchMove(t);
});
this.Root.on(cc.Node.EventType.TOUCH_END, function(t) {
e._onTouchEnd(t);
});
this.Root.on(cc.Node.EventType.TOUCH_CANCEL, function(t) {
e._onTouchCancel(t);
});
};
t.prototype._removeCard = function(e) {
for (var t = !1, o = 0; o < this._cards.length; o++) {
for (var n = this._cards[o], a = 0; a < n.length; a++) if (n[a] == e) {
this._cards[o].splice(a, 1)[0];
t = !0;
break;
}
if (t) break;
}
this._cards2hand();
};
t.prototype._cards2hand = function() {
var e = this;
this._handFromClient.splice(0);
this._handFromClient = [];
this._cards.forEach(function(t) {
var o = [];
t.forEach(function(e) {
o.push(e.idx16);
});
o.length > 0 && e._handFromClient.push(o);
});
D.default.log("当前手牌：" + this._handFromClient);
};
t.prototype.getGroupWidth = function(e) {
return (e - 1) * M.GroupHelper.CardShowWidth() + M.GroupHelper.GroupDefaultWidth();
};
t.prototype._refreshBulb = function(e, t, o, n) {
var a = o > this._maxScore ? this._maxScore : o;
this.SequenceBulb.refreshBulb(e, t, o, n);
this.Room_Score_Lab.string = E.Tools.TStr.replaceAll(T.default.getString("TABLE_SCORE"), "%{num}", a);
};
t.prototype._getCardsPosition = function(e) {
var t = this, o = [], n = [], a = 0;
e.forEach(function(e) {
a += t.getGroupWidth(e.length);
});
var i = 0, r = -a / 2;
e.forEach(function(e) {
var n = t.getGroupWidth(e.length), a = r + i + n / 2;
i += n;
o.push({
x: a,
width: n
});
});
e.forEach(function(e, t) {
var a = o[t], i = a.x - a.width / 2 + (M.GroupHelper.GroupDefaultWidth() - M.GroupHelper.CardWidth()) / 2 + M.GroupHelper.CardWidth() / 2, r = [];
e.forEach(function(e, t) {
r.push(cc.v2(i + t * M.GroupHelper.CardShowWidth(), g.CARD_HAND_POS_Y));
});
n.push(r);
});
return n;
};
t.prototype._creatGroups = function(e) {
var t = this, o = f.RoomModelManager.Instance.getModel(), n = 0;
e.forEach(function(e) {
n += t.getGroupWidth(e.length);
});
var a = 0, i = -n / 2, r = 0, l = !1, s = 0;
e.forEach(function(e) {
var t = M.GroupHelper.getGroupType(e, o.roomData.xcard);
if (t == S.GameEnum.GroupType.PureSequence) {
l = !0;
r++;
} else t == S.GameEnum.GroupType.Sequence && r++;
});
var c = 0;
e.forEach(function(n) {
++c;
var u = t.getGroupWidth(n.length), p = i + a + u / 2;
a += u;
var h = cc.instantiate(t.Prefab_Group);
h.width = u;
h.position = cc.v3(p, g.CARD_HAND_POS_Y - 89, 0);
h.zIndex = g.GROUP_ZINDEX;
h.parent = t.Table;
var f = h.getComponent(d.default), _ = M.GroupHelper.getGroupType(n, o.roomData.xcard), m = M.GroupHelper.getScore(n, l, r, o.roomData.xcard, o.roomData.mcard);
s += m;
f.init(_, m, l, 1 == c ? -1 : c == e.length ? 1 : 0);
t._groups.push(f);
});
this._refreshBulb(l, r, s, o.roomData.mcard);
};
t.prototype._creatCards = function(e) {
var t = this, o = f.RoomModelManager.Instance.getModel();
e.forEach(function(e, n) {
var a = t._groups[n].node, i = a.x - a.width / 2 + (M.GroupHelper.GroupDefaultWidth() - M.GroupHelper.CardWidth()) / 2 + M.GroupHelper.CardWidth() / 2, l = [];
e.forEach(function(e, n) {
var a = cc.instantiate(t.Prefab_Card).getComponent(r.default);
a.node.parent = t.Table;
a.init(e, !0, o.roomData.xcard);
a.pos = cc.v2(i + n * M.GroupHelper.CardShowWidth(), g.CARD_HAND_POS_Y);
l.push(a);
});
t._cards.push(l);
});
var n = this._checkFinish();
this.setFinishCard(n.groupIndex, n.cardIndex);
};
t.prototype._pushNewCard = function(e, t) {
var o = this;
void 0 === t && (t = null);
if (this._cards.length < g.MAX_GROUPCOUNT) {
this.clearAllSelectCard();
this._cards.push([ e ]);
this._cards2hand();
this.resetGroups(this._handFromClient);
var n = this._getCardsPosition(this._handFromClient), a = this._cards.length - 1, i = this._cards[a].length - 1, r = n[a][i], l = this._cards[a - 1][this._cards[a - 1].length - 1].node.zIndex + 1;
e.node.zIndex = l;
for (var s = 0; s < this._cards.length; s++) for (var c = this._cards[s], u = 0; u < c.length; u++) {
var d = c[u];
d != e && d.moveCard(.5, n[s][u], 1, 1, null, !1, !1);
}
e.moveCard(.5, r, 1, 1, function() {
o.resetCards(o._handFromClient);
o.scheduleOnce(function() {
t && t();
}, .1);
});
} else {
var p = this._cards.length - 1, h = this._cards[p].length - 1;
this.clearAllSelectCard();
this._cards[p].push(e);
this._cards2hand();
this.resetGroups(this._handFromClient);
var f = this._cards[p][h].pos.add(cc.v2(M.GroupHelper.CardShowWidth(), 0)), _ = this._cards[p][h].node.zIndex + 1;
e.node.zIndex = _;
e.moveCard(.5, f, 1, 1, function() {
o.resetCards(o._handFromClient);
o.scheduleOnce(function() {
t && t();
}, .15);
});
}
};
t.prototype._card2Original = function() {
var e = this;
this._curTouchCard && this._curTouchCard.node && this._curTouchCard.node.isValid && this._curTouchCard.moveCard(.2, this._curTouchCarDest, g.HAND_CARD_SCALE, g.HAND_CARD_SCALE, function() {
e.resetGroups(e._handFromClient);
e.resetCards(e._handFromClient);
}, !0, !1);
this.hideNewGroup();
this._translucentCard && this._translucentCard.node && this._translucentCard.isValid && (this._translucentCard.node.active = !1);
this._resetTouch();
};
t.prototype._out2Finish = function() {
if (this.__checkFinish()) {
var e = this._curTouchCardGroupIndex, t = this._curTouchCardIndex;
if (!this || !this._cards || !this._cards[e]) {
D.default.log("[Rummy Game Error:_out2Finish]:can not find _cards!");
return;
}
var o = this._cards[e].splice(t, 1)[0];
if (o) {
this.OperationTips.hideOperationTips();
this._cards2hand();
this._operateCard = o;
o.Clicked && o.onClick();
this.FinishDeck.selfFinishAction(o, function() {});
f.default.Instance.sendFinish(this._operateCard.idx16, this._handFromClient);
} else D.default.log("[Rummy Game Error:_out2Finish]:can not find operate card!");
} else this._card2Original();
};
t.prototype._out2Open = function() {
this._out2Open_Client() && f.default.Instance.sendDiscard(this._operateCard.idx16, this._handFromClient);
};
t.prototype._out2Open_Client = function(e) {
var t = this, o = function() {
if (e) {
for (var o = t._cards.length - 1; o >= 0; o--) for (var n = t._cards[o].length - 1; n >= 0; n--) if (t._cards[o][n].idx16 == e) {
t._curTouchCardGroupIndex = o;
t._curTouchCardIndex = n;
return t._cards[t._curTouchCardGroupIndex].splice(t._curTouchCardIndex, 1)[0];
}
return null;
}
return -1 != t._curTouchCardGroupIndex && -1 != t._curTouchCardIndex ? t._cards[t._curTouchCardGroupIndex].splice(t._curTouchCardIndex, 1)[0] : null;
}();
if (o) {
this.OperationTips.hideOperationTips();
this._cards2hand();
this._operateCard = o;
this.OpenDeck.selfDisCardAction(o, function() {
t.openDeckPushCard(o);
t._refreshOpenDeckCard();
});
return !0;
}
D.default.log("[Rummy Game Error:_out2Open]:can not find operate card!");
return !1;
};
t.prototype._outHandCard = function(e, t, o, n, a) {
var i = this, r = this._cards[e].splice(t, 1)[0];
r.Clicked && r.onClick();
this._cards2hand();
r.moveCard(.2, o, n, n, function() {
i.resetGroups(i._handFromClient);
i.resetCards(i._handFromClient);
a && a(r);
}, !0, !1);
};
t.prototype.resetGroups = function(e) {
this._groups.forEach(function(e) {
e.node.removeFromParent(!0);
e.node.destroy();
});
this._groups.splice(0);
this._creatGroups(e);
};
t.prototype.resetCards = function(e) {
this._cards.forEach(function(e) {
e.forEach(function(e) {
e.node.removeFromParent(!0);
e.node.destroy();
});
e.splice(0);
});
this._cards.splice(0);
this.clearAllSelectCard();
this._creatCards(e);
};
t.prototype.creatHand = function(e) {
this._handFromServer = e;
this._handFromClient = E.Tools.TArray.deepCopy(e);
this._creatGroups(e);
this._creatCards(e);
};
t.prototype.onLoad = function() {
this.NetworkDelay.node.active = !1;
};
t.prototype.start = function() {
this.OpenDeck.node.zIndex = g.DECK_ZINDEX;
this.FinishDeck.node.zIndex = g.DECK_ZINDEX;
this.CloseDeck.node.zIndex = g.DECK_ZINDEX;
this.Dealer.node.zIndex = g.DEALER_ZINDEX;
var e = JSON.parse(cc.sys.localStorage.getItem("AutoSortHandCards_New"));
this.isAutoSort = null == e || e;
this._bindTouchFunc();
};
i([ k(cc.Node) ], t.prototype, "Table", void 0);
i([ k(cc.Node) ], t.prototype, "Root", void 0);
i([ k(cc.Node) ], t.prototype, "PopLayer", void 0);
i([ k(cc.Prefab) ], t.prototype, "Prefab_Card", void 0);
i([ k(cc.Prefab) ], t.prototype, "Prefab_Group", void 0);
i([ k(cc.Node) ], t.prototype, "DeclareBtn", void 0);
i([ k(h.default) ], t.prototype, "SequenceBulb", void 0);
i([ k(cc.Node) ], t.prototype, "DeckTips", void 0);
i([ k(m.default) ], t.prototype, "OperationTips", void 0);
i([ k(p.default) ], t.prototype, "HeadManager", void 0);
i([ k(l.default) ], t.prototype, "Dealer", void 0);
i([ k(u.default) ], t.prototype, "OpenDeck", void 0);
i([ k(c.default) ], t.prototype, "FinishDeck", void 0);
i([ k(s.default) ], t.prototype, "CloseDeck", void 0);
i([ k(cc.Button) ], t.prototype, "FinishBtn", void 0);
i([ k(cc.Button) ], t.prototype, "DropBtn", void 0);
i([ k(cc.Button) ], t.prototype, "GroupBtn", void 0);
i([ k(cc.Button) ], t.prototype, "DiscardBtn", void 0);
i([ k(cc.Node) ], t.prototype, "ReadyButton", void 0);
i([ k(cc.Node) ], t.prototype, "SortBtn", void 0);
i([ k(cc.Node) ], t.prototype, "CardRecorder", void 0);
i([ k(cc.Node) ], t.prototype, "DeclareFail", void 0);
i([ k(cc.Node) ], t.prototype, "NewGroup", void 0);
i([ k(cc.Button) ], t.prototype, "BackButton", void 0);
i([ k(cc.Button) ], t.prototype, "RefreshButton", void 0);
i([ k(cc.Button) ], t.prototype, "ScoreBoardButton", void 0);
i([ k(cc.Button) ], t.prototype, "RechargeButton", void 0);
i([ k(cc.Node) ], t.prototype, "AutoPlayNode", void 0);
i([ k(cc.Node) ], t.prototype, "WaittingNode", void 0);
i([ k(cc.Label) ], t.prototype, "Room_Id_Lab", void 0);
i([ k(cc.Label) ], t.prototype, "Room_Name_Lab", void 0);
i([ k(cc.Label) ], t.prototype, "Room_Base_Lab", void 0);
i([ k(cc.Node) ], t.prototype, "Room_Base_Icon", void 0);
i([ k(cc.Label) ], t.prototype, "Room_Score_Lab", void 0);
i([ k([ cc.Node ]) ], t.prototype, "Room_Wallet_Node", void 0);
i([ k(cc.Node) ], t.prototype, "BonusLine", void 0);
i([ k(cc.Node) ], t.prototype, "BonusNode", void 0);
i([ k(cc.ProgressBar) ], t.prototype, "Battery", void 0);
i([ k(cc.Label) ], t.prototype, "NetworkDelay", void 0);
i([ k(cc.Toggle) ], t.prototype, "AutoSortToggle", void 0);
i([ k(cc.Node) ], t.prototype, "AutoSortTips", void 0);
i([ k(cc.SpriteFrame) ], t.prototype, "BtnGrayFrame", void 0);
return i([ N ], t);
}(cc.Component);
o.default = F;
cc._RF.pop();
}, {
"../../../Game/Script/global/GlobalValue": "GlobalValue",
"../../../Game/client/global/enum/game/Const": "Const",
"../../../Game/client/global/enum/game/Event": "Event",
"../../../Game/client/global/enum/game/Game": "Game",
"../../../Game/client/global/enum/game/UIUtils": "UIUtils",
"../../../Game/client/logic/game/GameHelper": "GameHelper",
"../../../Game/client/logic/game/sort/AutoSort": "AutoSort",
"../../../Game/client/logic/game/sort/CheckTools": "CheckTools",
"../../../Game/client/model/LanguageModel": "LanguageModel",
"../../../Game/fromework/global/Tools": "Tools",
"../../../Game/fromework/helper/AudioHelper": "AudioHelper",
"../../../Game/fromework/helper/EventHelper": "EventHelper",
"../../../Game/fromework/helper/UIHelper": "UIHelper",
"../../../Game/fromework/mvvm/modelView/ViewModel": "ViewModel",
"../../../platform/Platform": "Platform",
"../../component/Card": "Card",
"../../component/Dealer": "Dealer",
"../../component/Group": "Group",
"../../component/HeadManager": "HeadManager",
"../../component/SequenceBulb": "SequenceBulb",
"../../component/deck/CloseDeck": "CloseDeck",
"../../component/deck/FinishDeck": "FinishDeck",
"../../component/deck/OpenDeck": "OpenDeck",
"../../global/PopHelper": "PopHelper",
"../../model/GameModel": "GameModel",
"../../model/LobbyModel": "LobbyModel",
"../Wallet/WalletHelper": "WalletHelper",
"./TableOptTips": "TableOptTips",
"./sort/Sort": "Sort"
} ],
TableListItem: [ function(e, t, o) {
"use strict";
cc._RF.push(t, "09264400uRDVZJGII8tKNZW", "TableListItem");
var n, a = this && this.__extends || (n = function(e, t) {
return (n = Object.setPrototypeOf || {
__proto__: []
} instanceof Array && function(e, t) {
e.__proto__ = t;
} || function(e, t) {
for (var o in t) Object.prototype.hasOwnProperty.call(t, o) && (e[o] = t[o]);
})(e, t);
}, function(e, t) {
n(e, t);
function o() {
this.constructor = e;
}
e.prototype = null === t ? Object.create(t) : (o.prototype = t.prototype, new o());
}), i = this && this.__decorate || function(e, t, o, n) {
var a, i = arguments.length, r = i < 3 ? t : null === n ? n = Object.getOwnPropertyDescriptor(t, o) : n;
if ("object" == typeof Reflect && "function" == typeof Reflect.decorate) r = Reflect.decorate(e, t, o, n); else for (var l = e.length - 1; l >= 0; l--) (a = e[l]) && (r = (i < 3 ? a(r) : i > 3 ? a(t, o, r) : a(t, o)) || r);
return i > 3 && r && Object.defineProperty(t, o, r), r;
};
Object.defineProperty(o, "__esModule", {
value: !0
});
var r, l = cc._decorator, s = l.ccclass, c = l.property, u = l.disallowMultiple, d = l.menu, p = l.executionOrder;
(function(e) {
e[e.NONE = 0] = "NONE";
e[e.TOGGLE = 1] = "TOGGLE";
e[e.SWITCH = 2] = "SWITCH";
})(r || (r = {}));
var h = function(e) {
a(t, e);
function t() {
var t = null !== e && e.apply(this, arguments) || this;
t.selectedMode = r.NONE;
t.selectedFlag = null;
t.selectedSpriteFrame = null;
t._unselectedSpriteFrame = null;
t.adaptiveSize = !1;
t._selected = !1;
t._eventReg = !1;
return t;
}
Object.defineProperty(t.prototype, "selected", {
get: function() {
return this._selected;
},
set: function(e) {
this._selected = e;
if (this.selectedFlag) switch (this.selectedMode) {
case r.TOGGLE:
this.selectedFlag.active = e;
break;

case r.SWITCH:
var t = this.selectedFlag.getComponent(cc.Sprite);
t && (t.spriteFrame = e ? this.selectedSpriteFrame : this._unselectedSpriteFrame);
}
},
enumerable: !1,
configurable: !0
});
Object.defineProperty(t.prototype, "btnCom", {
get: function() {
this._btnCom || (this._btnCom = this.node.getComponent(cc.Button));
return this._btnCom;
},
enumerable: !1,
configurable: !0
});
t.prototype.onLoad = function() {
if (this.selectedMode == r.SWITCH) {
var e = this.selectedFlag.getComponent(cc.Sprite);
this._unselectedSpriteFrame = e.spriteFrame;
}
};
t.prototype.onDestroy = function() {
this.node.off(cc.Node.EventType.SIZE_CHANGED, this._onSizeChange, this);
};
t.prototype._registerEvent = function() {
if (!this._eventReg) {
this.btnCom && this.list.selectedMode > 0 && this.btnCom.clickEvents.unshift(this.createEvt(this, "onClickThis"));
this.adaptiveSize && this.node.on(cc.Node.EventType.SIZE_CHANGED, this._onSizeChange, this);
this._eventReg = !0;
}
};
t.prototype._onSizeChange = function() {
this.list._onItemAdaptive(this.node);
};
t.prototype.createEvt = function(e, t, o) {
void 0 === o && (o = null);
if (e.isValid) {
e.comName = e.comName || e.name.match(/\<(.*?)\>/g).pop().replace(/\<|>/g, "");
var n = new cc.Component.EventHandler();
n.target = o || e.node;
n.component = e.comName;
n.handler = t;
return n;
}
};
t.prototype.showAni = function(e, t, o) {
var n, a = this;
switch (e) {
case 0:
n = cc.tween(a.node).to(.2, {
scale: .7
}).by(.3, {
y: 2 * a.node.height
});
break;

case 1:
n = cc.tween(a.node).to(.2, {
scale: .7
}).by(.3, {
x: 2 * a.node.width
});
break;

case 2:
n = cc.tween(a.node).to(.2, {
scale: .7
}).by(.3, {
y: -2 * a.node.height
});
break;

case 3:
n = cc.tween(a.node).to(.2, {
scale: .7
}).by(.3, {
x: -2 * a.node.width
});
break;

default:
n = cc.tween(a.node).to(.3, {
scale: .1
});
}
(t || o) && n.call(function() {
if (o) {
a.list._delSingleItem(a.node);
for (var e = a.list.displayData.length - 1; e >= 0; e--) if (a.list.displayData[e].id == a.listId) {
a.list.displayData.splice(e, 1);
break;
}
}
t();
});
n.start();
};
t.prototype.onClickThis = function() {
this.list.selectedId = this.listId;
};
i([ c({
type: cc.Enum(r),
tooltip: !1
}) ], t.prototype, "selectedMode", void 0);
i([ c({
type: cc.Node,
tooltip: !1,
visible: function() {
return this.selectedMode > r.NONE;
}
}) ], t.prototype, "selectedFlag", void 0);
i([ c({
type: cc.SpriteFrame,
tooltip: !1,
visible: function() {
return this.selectedMode == r.SWITCH;
}
}) ], t.prototype, "selectedSpriteFrame", void 0);
i([ c({
tooltip: !1
}) ], t.prototype, "adaptiveSize", void 0);
return i([ s, u(), d("自定义组件/TableListItem"), p(-5001) ], t);
}(cc.Component);
o.default = h;
cc._RF.pop();
}, {} ],
TableList: [ function(e, t, o) {
"use strict";
cc._RF.push(t, "c488aiSbrZPO5c97aklxYqi", "TableList");
var n, a = this && this.__extends || (n = function(e, t) {
return (n = Object.setPrototypeOf || {
__proto__: []
} instanceof Array && function(e, t) {
e.__proto__ = t;
} || function(e, t) {
for (var o in t) Object.prototype.hasOwnProperty.call(t, o) && (e[o] = t[o]);
})(e, t);
}, function(e, t) {
n(e, t);
function o() {
this.constructor = e;
}
e.prototype = null === t ? Object.create(t) : (o.prototype = t.prototype, new o());
}), i = this && this.__decorate || function(e, t, o, n) {
var a, i = arguments.length, r = i < 3 ? t : null === n ? n = Object.getOwnPropertyDescriptor(t, o) : n;
if ("object" == typeof Reflect && "function" == typeof Reflect.decorate) r = Reflect.decorate(e, t, o, n); else for (var l = e.length - 1; l >= 0; l--) (a = e[l]) && (r = (i < 3 ? a(r) : i > 3 ? a(t, o, r) : a(t, o)) || r);
return i > 3 && r && Object.defineProperty(t, o, r), r;
};
Object.defineProperty(o, "__esModule", {
value: !0
});
var r, l, s, c = e("../../../platform/Platform"), u = e("./TableListItem"), d = cc._decorator, p = d.ccclass, h = d.property, f = d.disallowMultiple, _ = d.menu, m = d.executionOrder, y = d.requireComponent;
(function(e) {
e[e.NODE = 1] = "NODE";
e[e.PREFAB = 2] = "PREFAB";
})(r || (r = {}));
(function(e) {
e[e.NORMAL = 1] = "NORMAL";
e[e.ADHERING = 2] = "ADHERING";
e[e.PAGE = 3] = "PAGE";
})(l || (l = {}));
(function(e) {
e[e.NONE = 0] = "NONE";
e[e.SINGLE = 1] = "SINGLE";
e[e.MULT = 2] = "MULT";
})(s || (s = {}));
var g = function(e) {
a(t, e);
function t() {
var t = null !== e && e.apply(this, arguments) || this;
t.templateType = r.NODE;
t.tmpNode = null;
t.tmpPrefab = null;
t._slideMode = l.NORMAL;
t.pageDistance = .3;
t.pageChangeEvent = new cc.Component.EventHandler();
t._virtual = !0;
t.cyclic = !1;
t.lackCenter = !1;
t.lackSlide = !1;
t._updateRate = 0;
t.frameByFrameRenderNum = 0;
t.renderEvent = new cc.Component.EventHandler();
t.selectedMode = s.NONE;
t.repeatEventSingle = !1;
t.selectedEvent = new cc.Component.EventHandler();
t._selectedId = -1;
t._forceUpdate = !1;
t._updateDone = !0;
t._numItems = 0;
t._inited = !1;
t._needUpdateWidget = !1;
t._aniDelRuning = !1;
t._doneAfterUpdate = !1;
t.adhering = !1;
t._adheringBarrier = !1;
t.curPageNum = 0;
return t;
}
Object.defineProperty(t.prototype, "slideMode", {
get: function() {
return this._slideMode;
},
set: function(e) {
this._slideMode = e;
},
enumerable: !1,
configurable: !0
});
Object.defineProperty(t.prototype, "virtual", {
get: function() {
return this._virtual;
},
set: function(e) {
null != e && (this._virtual = e);
0 != this._numItems && this._onScrolling();
},
enumerable: !1,
configurable: !0
});
Object.defineProperty(t.prototype, "updateRate", {
get: function() {
return this._updateRate;
},
set: function(e) {
e >= 0 && e <= 6 && (this._updateRate = e);
},
enumerable: !1,
configurable: !0
});
Object.defineProperty(t.prototype, "selectedId", {
get: function() {
return this._selectedId;
},
set: function(e) {
var t, o = this;
switch (o.selectedMode) {
case s.SINGLE:
if (!o.repeatEventSingle && e == o._selectedId) return;
t = o.getItemByListId(e);
var n = void 0;
o._selectedId >= 0 ? o._lastSelectedId = o._selectedId : o._lastSelectedId = null;
o._selectedId = e;
t && ((n = t.getComponent(u.default)).selected = !0);
if (o._lastSelectedId >= 0 && o._lastSelectedId != o._selectedId) {
var a = o.getItemByListId(o._lastSelectedId);
a && (a.getComponent(u.default).selected = !1);
}
o.selectedEvent && cc.Component.EventHandler.emitEvents([ o.selectedEvent ], t, e % this._actualNumItems, null == o._lastSelectedId ? null : o._lastSelectedId % this._actualNumItems);
break;

case s.MULT:
if (!(t = o.getItemByListId(e))) return;
n = t.getComponent(u.default);
o._selectedId >= 0 && (o._lastSelectedId = o._selectedId);
o._selectedId = e;
var i = !n.selected;
n.selected = i;
var r = o.multSelected.indexOf(e);
i && r < 0 ? o.multSelected.push(e) : !i && r >= 0 && o.multSelected.splice(r, 1);
o.selectedEvent && cc.Component.EventHandler.emitEvents([ o.selectedEvent ], t, e % this._actualNumItems, null == o._lastSelectedId ? null : o._lastSelectedId % this._actualNumItems, i);
}
},
enumerable: !1,
configurable: !0
});
Object.defineProperty(t.prototype, "numItems", {
get: function() {
return this._actualNumItems;
},
set: function(e) {
var t = this;
if (t.checkInited(!1)) if (null == e || e < 0) c.default.error("numItems set the wrong::", e); else {
t._actualNumItems = t._numItems = e;
t._forceUpdate = !0;
if (t._virtual) {
t._resizeContent();
t.cyclic && (t._numItems = t._cyclicNum * t._numItems);
t._onScrolling();
t.frameByFrameRenderNum || t.slideMode != l.PAGE || (t.curPageNum = t.nearestListId);
} else {
if (t.cyclic) {
t._resizeContent();
t._numItems = t._cyclicNum * t._numItems;
}
var o = t.content.getComponent(cc.Layout);
o && (o.enabled = !0);
t._delRedundantItem();
t.firstListId = 0;
if (t.frameByFrameRenderNum > 0) {
for (var n = t.frameByFrameRenderNum > t._numItems ? t._numItems : t.frameByFrameRenderNum, a = 0; a < n; a++) t._createOrUpdateItem2(a);
if (t.frameByFrameRenderNum < t._numItems) {
t._updateCounter = t.frameByFrameRenderNum;
t._updateDone = !1;
}
} else {
for (a = 0; a < t._numItems; a++) t._createOrUpdateItem2(a);
t.displayItemNum = t._numItems;
}
}
}
},
enumerable: !1,
configurable: !0
});
Object.defineProperty(t.prototype, "scrollView", {
get: function() {
return this._scrollView;
},
enumerable: !1,
configurable: !0
});
t.prototype.onLoad = function() {
this._init();
};
t.prototype.onDestroy = function() {
var e = this;
cc.isValid(e._itemTmp) && e._itemTmp.destroy();
cc.isValid(e.tmpNode) && e.tmpNode.destroy();
e._pool && e._pool.clear();
};
t.prototype.onEnable = function() {
this._registerEvent();
this._init();
if (this._aniDelRuning) {
this._aniDelRuning = !1;
if (this._aniDelItem) {
if (this._aniDelBeforePos) {
this._aniDelItem.position = this._aniDelBeforePos;
delete this._aniDelBeforePos;
}
if (this._aniDelBeforeScale) {
this._aniDelItem.scale = this._aniDelBeforeScale;
delete this._aniDelBeforeScale;
}
delete this._aniDelItem;
}
if (this._aniDelCB) {
this._aniDelCB();
delete this._aniDelCB;
}
}
};
t.prototype.onDisable = function() {
this._unregisterEvent();
};
t.prototype._registerEvent = function() {
var e = this;
e.node.on(cc.Node.EventType.TOUCH_START, e._onTouchStart, e, !0);
e.node.on("touch-up", e._onTouchUp, e);
e.node.on(cc.Node.EventType.TOUCH_CANCEL, e._onTouchCancelled, e, !0);
e.node.on("scroll-began", e._onScrollBegan, e, !0);
e.node.on("scroll-ended", e._onScrollEnded, e, !0);
e.node.on("scrolling", e._onScrolling, e, !0);
e.node.on(cc.Node.EventType.SIZE_CHANGED, e._onSizeChanged, e);
};
t.prototype._unregisterEvent = function() {
var e = this;
e.node.off(cc.Node.EventType.TOUCH_START, e._onTouchStart, e, !0);
e.node.off("touch-up", e._onTouchUp, e);
e.node.off(cc.Node.EventType.TOUCH_CANCEL, e._onTouchCancelled, e, !0);
e.node.off("scroll-began", e._onScrollBegan, e, !0);
e.node.off("scroll-ended", e._onScrollEnded, e, !0);
e.node.off("scrolling", e._onScrolling, e, !0);
e.node.off(cc.Node.EventType.SIZE_CHANGED, e._onSizeChanged, e);
};
t.prototype._init = function() {
var e = this;
if (!e._inited) {
e._scrollView = e.node.getComponent(cc.ScrollView);
e.content = e._scrollView.content;
if (e.content) {
e._layout = e.content.getComponent(cc.Layout);
e._align = e._layout.type;
e._resizeMode = e._layout.resizeMode;
e._startAxis = e._layout.startAxis;
e._topGap = e._layout.paddingTop;
e._rightGap = e._layout.paddingRight;
e._bottomGap = e._layout.paddingBottom;
e._leftGap = e._layout.paddingLeft;
e._columnGap = e._layout.spacingX;
e._lineGap = e._layout.spacingY;
e._colLineNum;
e._verticalDir = e._layout.verticalDirection;
e._horizontalDir = e._layout.horizontalDirection;
e.setTemplateItem(cc.instantiate(e.templateType == r.PREFAB ? e.tmpPrefab : e.tmpNode));
if (e._slideMode == l.ADHERING || e._slideMode == l.PAGE) {
e._scrollView.inertia = !1;
e._scrollView._onMouseWheel = function() {};
}
e.virtual || (e.lackCenter = !1);
e._lastDisplayData = [];
e.displayData = [];
e._pool = new cc.NodePool();
e._forceUpdate = !1;
e._updateCounter = 0;
e._updateDone = !0;
e.curPageNum = 0;
if (e.cyclic) {
e._scrollView._processAutoScrolling = this._processAutoScrolling.bind(e);
e._scrollView._startBounceBackIfNeeded = function() {
return !1;
};
}
switch (e._align) {
case cc.Layout.Type.HORIZONTAL:
switch (e._horizontalDir) {
case cc.Layout.HorizontalDirection.LEFT_TO_RIGHT:
e._alignCalcType = 1;
break;

case cc.Layout.HorizontalDirection.RIGHT_TO_LEFT:
e._alignCalcType = 2;
}
break;

case cc.Layout.Type.VERTICAL:
switch (e._verticalDir) {
case cc.Layout.VerticalDirection.TOP_TO_BOTTOM:
e._alignCalcType = 3;
break;

case cc.Layout.VerticalDirection.BOTTOM_TO_TOP:
e._alignCalcType = 4;
}
break;

case cc.Layout.Type.GRID:
switch (e._startAxis) {
case cc.Layout.AxisDirection.HORIZONTAL:
switch (e._verticalDir) {
case cc.Layout.VerticalDirection.TOP_TO_BOTTOM:
e._alignCalcType = 3;
break;

case cc.Layout.VerticalDirection.BOTTOM_TO_TOP:
e._alignCalcType = 4;
}
break;

case cc.Layout.AxisDirection.VERTICAL:
switch (e._horizontalDir) {
case cc.Layout.HorizontalDirection.LEFT_TO_RIGHT:
e._alignCalcType = 1;
break;

case cc.Layout.HorizontalDirection.RIGHT_TO_LEFT:
e._alignCalcType = 2;
}
}
}
e.content.removeAllChildren();
e._inited = !0;
} else c.default.error(e.node.name + "'s cc.ScrollView unset content!");
}
};
t.prototype._processAutoScrolling = function(e) {
this._scrollView._autoScrollAccumulatedTime += 1 * e;
var t = Math.min(1, this._scrollView._autoScrollAccumulatedTime / this._scrollView._autoScrollTotalTime);
if (this._scrollView._autoScrollAttenuate) {
var o = t - 1;
t = o * o * o * o * o + 1;
}
var n = this._scrollView._autoScrollStartPosition.add(this._scrollView._autoScrollTargetDelta.mul(t)), a = this._scrollView.getScrollEndedEventTiming(), i = Math.abs(t - 1) <= a;
if (Math.abs(t - 1) <= this._scrollView.getScrollEndedEventTiming() && !this._scrollView._isScrollEndedWithThresholdEventFired) {
this._scrollView._dispatchEvent("scroll-ended-with-threshold");
this._scrollView._isScrollEndedWithThresholdEventFired = !0;
}
i && (this._scrollView._autoScrolling = !1);
var r = n.sub(this._scrollView.getContentPosition());
this._scrollView._moveContent(this._scrollView._clampDelta(r), i);
this._scrollView._dispatchEvent("scrolling");
if (!this._scrollView._autoScrolling) {
this._scrollView._isBouncing = !1;
this._scrollView._scrolling = !1;
this._scrollView._dispatchEvent("scroll-ended");
}
};
t.prototype.setTemplateItem = function(e) {
if (e) {
var t = this;
t._itemTmp = e;
t._resizeMode == cc.Layout.ResizeMode.CHILDREN ? t._itemSize = t._layout.cellSize : t._itemSize = cc.size(e.width, e.height);
var o = e.getComponent(u.default), n = !1;
o || (n = !0);
n && (t.selectedMode = s.NONE);
(o = e.getComponent(cc.Widget)) && o.enabled && (t._needUpdateWidget = !0);
t.selectedMode == s.MULT && (t.multSelected = []);
switch (t._align) {
case cc.Layout.Type.HORIZONTAL:
t._colLineNum = 1;
t._sizeType = !1;
break;

case cc.Layout.Type.VERTICAL:
t._colLineNum = 1;
t._sizeType = !0;
break;

case cc.Layout.Type.GRID:
switch (t._startAxis) {
case cc.Layout.AxisDirection.HORIZONTAL:
var a = t.content.width - t._leftGap - t._rightGap;
t._colLineNum = Math.floor((a + t._columnGap) / (t._itemSize.width + t._columnGap));
t._sizeType = !0;
break;

case cc.Layout.AxisDirection.VERTICAL:
var i = t.content.height - t._topGap - t._bottomGap;
t._colLineNum = Math.floor((i + t._lineGap) / (t._itemSize.height + t._lineGap));
t._sizeType = !1;
}
}
}
};
t.prototype.checkInited = function(e) {
void 0 === e && (e = !0);
if (!this._inited) {
e && c.default.error("List initialization not completed!");
return !1;
}
return !0;
};
t.prototype._resizeContent = function() {
var e, t = this;
switch (t._align) {
case cc.Layout.Type.HORIZONTAL:
if (t._customSize) {
var o = t._getFixedSize(null);
e = t._leftGap + o.val + t._itemSize.width * (t._numItems - o.count) + t._columnGap * (t._numItems - 1) + t._rightGap;
} else e = t._leftGap + t._itemSize.width * t._numItems + t._columnGap * (t._numItems - 1) + t._rightGap;
break;

case cc.Layout.Type.VERTICAL:
if (t._customSize) {
o = t._getFixedSize(null);
e = t._topGap + o.val + t._itemSize.height * (t._numItems - o.count) + t._lineGap * (t._numItems - 1) + t._bottomGap;
} else e = t._topGap + t._itemSize.height * t._numItems + t._lineGap * (t._numItems - 1) + t._bottomGap;
break;

case cc.Layout.Type.GRID:
t.lackCenter && (t.lackCenter = !1);
switch (t._startAxis) {
case cc.Layout.AxisDirection.HORIZONTAL:
var n = Math.ceil(t._numItems / t._colLineNum);
e = t._topGap + t._itemSize.height * n + t._lineGap * (n - 1) + t._bottomGap;
break;

case cc.Layout.AxisDirection.VERTICAL:
var a = Math.ceil(t._numItems / t._colLineNum);
e = t._leftGap + t._itemSize.width * a + t._columnGap * (a - 1) + t._rightGap;
}
}
var i = t.content.getComponent(cc.Layout);
i && (i.enabled = !1);
t._allItemSize = e;
t._allItemSizeNoEdge = t._allItemSize - (t._sizeType ? t._topGap + t._bottomGap : t._leftGap + t._rightGap);
if (t.cyclic) {
var r = t._sizeType ? t.node.height : t.node.width;
t._cyclicPos1 = 0;
r -= t._cyclicPos1;
t._cyclicNum = Math.ceil(r / t._allItemSizeNoEdge) + 1;
var l = t._sizeType ? t._lineGap : t._columnGap;
t._cyclicPos2 = t._cyclicPos1 + t._allItemSizeNoEdge + l;
t._cyclicAllItemSize = t._allItemSize + t._allItemSizeNoEdge * (t._cyclicNum - 1) + l * (t._cyclicNum - 1);
t._cycilcAllItemSizeNoEdge = t._allItemSizeNoEdge * t._cyclicNum;
t._cycilcAllItemSizeNoEdge += l * (t._cyclicNum - 1);
}
t._lack = !t.cyclic && t._allItemSize < (t._sizeType ? t.node.height : t.node.width);
var s = t._lack && t.lackCenter || !t.lackSlide ? .1 : 0, c = t._lack ? (t._sizeType ? t.node.height : t.node.width) - s : t.cyclic ? t._cyclicAllItemSize : t._allItemSize;
c < 0 && (c = 0);
t._sizeType ? t.content.height = c : t.content.width = c;
};
t.prototype._onScrolling = function(e) {
void 0 === e && (e = null);
null == this.frameCount && (this.frameCount = this._updateRate);
if (!this._forceUpdate && e && "scroll-ended" != e.type && this.frameCount > 0) this.frameCount--; else {
this.frameCount = this._updateRate;
if (!this._aniDelRuning) {
if (this.cyclic) {
var t = this.content.getPosition();
t = this._sizeType ? t.y : t.x;
var o = this._allItemSizeNoEdge + (this._sizeType ? this._lineGap : this._columnGap), n = this._sizeType ? cc.v2(0, o) : cc.v2(o, 0);
switch (this._alignCalcType) {
case 1:
if (t > -this._cyclicPos1) {
this.content.x = -this._cyclicPos2;
this._scrollView.isAutoScrolling() && (this._scrollView._autoScrollStartPosition = this._scrollView._autoScrollStartPosition.sub(n));
} else if (t < -this._cyclicPos2) {
this.content.x = -this._cyclicPos1;
this._scrollView.isAutoScrolling() && (this._scrollView._autoScrollStartPosition = this._scrollView._autoScrollStartPosition.add(n));
}
break;

case 2:
if (t < this._cyclicPos1) {
this.content.x = this._cyclicPos2;
this._scrollView.isAutoScrolling() && (this._scrollView._autoScrollStartPosition = this._scrollView._autoScrollStartPosition.add(n));
} else if (t > this._cyclicPos2) {
this.content.x = this._cyclicPos1;
this._scrollView.isAutoScrolling() && (this._scrollView._autoScrollStartPosition = this._scrollView._autoScrollStartPosition.sub(n));
}
break;

case 3:
if (t < this._cyclicPos1) {
this.content.y = this._cyclicPos2;
this._scrollView.isAutoScrolling() && (this._scrollView._autoScrollStartPosition = this._scrollView._autoScrollStartPosition.add(n));
} else if (t > this._cyclicPos2) {
this.content.y = this._cyclicPos1;
this._scrollView.isAutoScrolling() && (this._scrollView._autoScrollStartPosition = this._scrollView._autoScrollStartPosition.sub(n));
}
break;

case 4:
if (t > -this._cyclicPos1) {
this.content.y = -this._cyclicPos2;
this._scrollView.isAutoScrolling() && (this._scrollView._autoScrollStartPosition = this._scrollView._autoScrollStartPosition.sub(n));
} else if (t < -this._cyclicPos2) {
this.content.y = -this._cyclicPos1;
this._scrollView.isAutoScrolling() && (this._scrollView._autoScrollStartPosition = this._scrollView._autoScrollStartPosition.add(n));
}
}
}
this._calcViewPos();
var a, i, r, l;
if (this._sizeType) {
a = this.viewTop;
r = this.viewBottom;
} else {
i = this.viewRight;
l = this.viewLeft;
}
if (this._virtual) {
this.displayData = [];
var s = void 0, c = 0, u = this._numItems - 1;
if (this._customSize) for (var d = !1; c <= u && !d; c++) {
s = this._calcItemPos(c);
switch (this._align) {
case cc.Layout.Type.HORIZONTAL:
s.right >= l && s.left <= i ? this.displayData.push(s) : 0 != c && this.displayData.length > 0 && (d = !0);
break;

case cc.Layout.Type.VERTICAL:
s.bottom <= a && s.top >= r ? this.displayData.push(s) : 0 != c && this.displayData.length > 0 && (d = !0);
break;

case cc.Layout.Type.GRID:
switch (this._startAxis) {
case cc.Layout.AxisDirection.HORIZONTAL:
s.bottom <= a && s.top >= r ? this.displayData.push(s) : 0 != c && this.displayData.length > 0 && (d = !0);
break;

case cc.Layout.AxisDirection.VERTICAL:
s.right >= l && s.left <= i ? this.displayData.push(s) : 0 != c && this.displayData.length > 0 && (d = !0);
}
}
} else {
var p = this._itemSize.width + this._columnGap, h = this._itemSize.height + this._lineGap;
switch (this._alignCalcType) {
case 1:
c = (l - this._leftGap) / p;
u = (i - this._leftGap) / p;
break;

case 2:
c = (-i - this._rightGap) / p;
u = (-l - this._rightGap) / p;
break;

case 3:
c = (-a - this._topGap) / h;
u = (-r - this._topGap) / h;
break;

case 4:
c = (r - this._bottomGap) / h;
u = (a - this._bottomGap) / h;
}
c = Math.floor(c) * this._colLineNum;
u = Math.ceil(u) * this._colLineNum;
c < 0 && (c = 0);
--u >= this._numItems && (u = this._numItems - 1);
for (;c <= u; c++) this.displayData.push(this._calcItemPos(c));
}
this._delRedundantItem();
if (this.displayData.length <= 0 || !this._numItems) {
this._lastDisplayData = [];
return;
}
this.firstListId = this.displayData[0].id;
this.displayItemNum = this.displayData.length;
var f = this._lastDisplayData.length, _ = this.displayItemNum != f;
if (_) {
this.frameByFrameRenderNum > 0 && this._lastDisplayData.sort(function(e, t) {
return e - t;
});
_ = this.firstListId != this._lastDisplayData[0] || this.displayData[this.displayItemNum - 1].id != this._lastDisplayData[f - 1];
}
if (this._forceUpdate || _) if (this.frameByFrameRenderNum > 0) if (this._numItems > 0) {
this._updateDone ? this._updateCounter = 0 : this._doneAfterUpdate = !0;
this._updateDone = !1;
} else {
this._updateCounter = 0;
this._updateDone = !0;
} else {
this._lastDisplayData = [];
for (var m = 0; m < this.displayItemNum; m++) this._createOrUpdateItem(this.displayData[m]);
this._forceUpdate = !1;
}
this._calcNearestItem();
}
}
}
};
t.prototype._calcViewPos = function() {
var e = this.content.getPosition();
switch (this._alignCalcType) {
case 1:
this.elasticLeft = e.x > 0 ? e.x : 0;
this.viewLeft = (e.x < 0 ? -e.x : 0) - this.elasticLeft;
this.viewRight = this.viewLeft + this.node.width;
this.elasticRight = this.viewRight > this.content.width ? Math.abs(this.viewRight - this.content.width) : 0;
this.viewRight += this.elasticRight;
break;

case 2:
this.elasticRight = e.x < 0 ? -e.x : 0;
this.viewRight = (e.x > 0 ? -e.x : 0) + this.elasticRight;
this.viewLeft = this.viewRight - this.node.width;
this.elasticLeft = this.viewLeft < -this.content.width ? Math.abs(this.viewLeft + this.content.width) : 0;
this.viewLeft -= this.elasticLeft;
break;

case 3:
this.elasticTop = e.y < 0 ? Math.abs(e.y) : 0;
this.viewTop = (e.y > 0 ? -e.y : 0) + this.elasticTop;
this.viewBottom = this.viewTop - this.node.height;
this.elasticBottom = this.viewBottom < -this.content.height ? Math.abs(this.viewBottom + this.content.height) : 0;
this.viewBottom += this.elasticBottom;
break;

case 4:
this.elasticBottom = e.y > 0 ? Math.abs(e.y) : 0;
this.viewBottom = (e.y < 0 ? -e.y : 0) - this.elasticBottom;
this.viewTop = this.viewBottom + this.node.height;
this.elasticTop = this.viewTop > this.content.height ? Math.abs(this.viewTop - this.content.height) : 0;
this.viewTop -= this.elasticTop;
}
};
t.prototype._calcItemPos = function(e) {
var t, o, n, a, i, r, l, s;
switch (this._align) {
case cc.Layout.Type.HORIZONTAL:
switch (this._horizontalDir) {
case cc.Layout.HorizontalDirection.LEFT_TO_RIGHT:
if (this._customSize) {
var c = this._getFixedSize(e);
i = this._leftGap + (this._itemSize.width + this._columnGap) * (e - c.count) + (c.val + this._columnGap * c.count);
t = (u = this._customSize[e]) > 0 ? u : this._itemSize.width;
} else {
i = this._leftGap + (this._itemSize.width + this._columnGap) * e;
t = this._itemSize.width;
}
if (this.lackCenter) {
i -= this._leftGap;
i += this.content.width / 2 - this._allItemSizeNoEdge / 2;
}
return {
id: e,
left: i,
right: r = i + t,
x: i + this._itemTmp.anchorX * t,
y: this._itemTmp.y
};

case cc.Layout.HorizontalDirection.RIGHT_TO_LEFT:
if (this._customSize) {
c = this._getFixedSize(e);
r = -this._rightGap - (this._itemSize.width + this._columnGap) * (e - c.count) - (c.val + this._columnGap * c.count);
t = (u = this._customSize[e]) > 0 ? u : this._itemSize.width;
} else {
r = -this._rightGap - (this._itemSize.width + this._columnGap) * e;
t = this._itemSize.width;
}
if (this.lackCenter) {
r += this._rightGap;
r -= this.content.width / 2 - this._allItemSizeNoEdge / 2;
}
return {
id: e,
right: r,
left: i = r - t,
x: i + this._itemTmp.anchorX * t,
y: this._itemTmp.y
};
}
break;

case cc.Layout.Type.VERTICAL:
switch (this._verticalDir) {
case cc.Layout.VerticalDirection.TOP_TO_BOTTOM:
if (this._customSize) {
c = this._getFixedSize(e);
n = -this._topGap - (this._itemSize.height + this._lineGap) * (e - c.count) - (c.val + this._lineGap * c.count);
o = (u = this._customSize[e]) > 0 ? u : this._itemSize.height;
} else {
n = -this._topGap - (this._itemSize.height + this._lineGap) * e;
o = this._itemSize.height;
}
if (this.lackCenter) {
n += this._topGap;
n -= this.content.height / 2 - this._allItemSizeNoEdge / 2;
}
return {
id: e,
top: n,
bottom: a = n - o,
x: this._itemTmp.x,
y: a + this._itemTmp.anchorY * o
};

case cc.Layout.VerticalDirection.BOTTOM_TO_TOP:
if (this._customSize) {
var u;
c = this._getFixedSize(e);
a = this._bottomGap + (this._itemSize.height + this._lineGap) * (e - c.count) + (c.val + this._lineGap * c.count);
o = (u = this._customSize[e]) > 0 ? u : this._itemSize.height;
} else {
a = this._bottomGap + (this._itemSize.height + this._lineGap) * e;
o = this._itemSize.height;
}
if (this.lackCenter) {
a -= this._bottomGap;
a += this.content.height / 2 - this._allItemSizeNoEdge / 2;
}
return {
id: e,
top: n = a + o,
bottom: a,
x: this._itemTmp.x,
y: a + this._itemTmp.anchorY * o
};
}

case cc.Layout.Type.GRID:
var d = Math.floor(e / this._colLineNum);
switch (this._startAxis) {
case cc.Layout.AxisDirection.HORIZONTAL:
switch (this._verticalDir) {
case cc.Layout.VerticalDirection.TOP_TO_BOTTOM:
s = (a = (n = -this._topGap - (this._itemSize.height + this._lineGap) * d) - this._itemSize.height) + this._itemTmp.anchorY * this._itemSize.height;
break;

case cc.Layout.VerticalDirection.BOTTOM_TO_TOP:
n = (a = this._bottomGap + (this._itemSize.height + this._lineGap) * d) + this._itemSize.height;
s = a + this._itemTmp.anchorY * this._itemSize.height;
}
l = this._leftGap + e % this._colLineNum * (this._itemSize.width + this._columnGap);
switch (this._horizontalDir) {
case cc.Layout.HorizontalDirection.LEFT_TO_RIGHT:
l += this._itemTmp.anchorX * this._itemSize.width;
l -= this.content.anchorX * this.content.width;
break;

case cc.Layout.HorizontalDirection.RIGHT_TO_LEFT:
l += (1 - this._itemTmp.anchorX) * this._itemSize.width;
l -= (1 - this.content.anchorX) * this.content.width;
l *= -1;
}
return {
id: e,
top: n,
bottom: a,
x: l,
y: s
};

case cc.Layout.AxisDirection.VERTICAL:
switch (this._horizontalDir) {
case cc.Layout.HorizontalDirection.LEFT_TO_RIGHT:
r = (i = this._leftGap + (this._itemSize.width + this._columnGap) * d) + this._itemSize.width;
l = i + this._itemTmp.anchorX * this._itemSize.width;
l -= this.content.anchorX * this.content.width;
break;

case cc.Layout.HorizontalDirection.RIGHT_TO_LEFT:
l = (i = (r = -this._rightGap - (this._itemSize.width + this._columnGap) * d) - this._itemSize.width) + this._itemTmp.anchorX * this._itemSize.width;
l += (1 - this.content.anchorX) * this.content.width;
}
s = -this._topGap - e % this._colLineNum * (this._itemSize.height + this._lineGap);
switch (this._verticalDir) {
case cc.Layout.VerticalDirection.TOP_TO_BOTTOM:
s -= (1 - this._itemTmp.anchorY) * this._itemSize.height;
s += (1 - this.content.anchorY) * this.content.height;
break;

case cc.Layout.VerticalDirection.BOTTOM_TO_TOP:
s -= this._itemTmp.anchorY * this._itemSize.height;
s += this.content.anchorY * this.content.height;
s *= -1;
}
return {
id: e,
left: i,
right: r,
x: l,
y: s
};
}
}
};
t.prototype._calcExistItemPos = function(e) {
var t = this.getItemByListId(e);
if (!t) return null;
var o = {
id: e,
x: t.x,
y: t.y
};
if (this._sizeType) {
o.top = t.y + t.height * (1 - t.anchorY);
o.bottom = t.y - t.height * t.anchorY;
} else {
o.left = t.x - t.width * t.anchorX;
o.right = t.x + t.width * (1 - t.anchorX);
}
return o;
};
t.prototype.getItemPos = function(e) {
return this._virtual ? this._calcItemPos(e) : this.frameByFrameRenderNum ? this._calcItemPos(e) : this._calcExistItemPos(e);
};
t.prototype._getFixedSize = function(e) {
if (!this._customSize) return null;
null == e && (e = this._numItems);
var t = 0, o = 0;
for (var n in this._customSize) if (parseInt(n) < e) {
t += this._customSize[n];
o++;
}
return {
val: t,
count: o
};
};
t.prototype._onScrollBegan = function() {
this._beganPos = this._sizeType ? this.viewTop : this.viewLeft;
};
t.prototype._onScrollEnded = function() {
var e = this;
e.curScrollIsTouch = !1;
if (null != e.scrollToListId) {
var t = e.getItemByListId(e.scrollToListId);
e.scrollToListId = null;
t && cc.tween(t).to(.1, {
scale: 1.06
}).to(.1, {
scale: 1
}).start();
}
e._onScrolling();
e._slideMode != l.ADHERING || e.adhering ? e._slideMode == l.PAGE && (null != e._beganPos && e.curScrollIsTouch ? this._pageAdhere() : e.adhere()) : e.adhere();
};
t.prototype._onTouchStart = function(e, t) {
if (!this._scrollView.hasNestedViewGroup(e, t)) {
this.curScrollIsTouch = !0;
if (e.eventPhase !== cc.Event.AT_TARGET || e.target !== this.node) {
for (var o = e.target; null == o._listId && o.parent; ) o = o.parent;
this._scrollItem = null != o._listId ? o : e.target;
}
}
};
t.prototype._onTouchUp = function() {
var e = this;
e._scrollPos = null;
if (e._slideMode == l.ADHERING) {
this.adhering && (this._adheringBarrier = !0);
e.adhere();
} else e._slideMode == l.PAGE && (null != e._beganPos ? this._pageAdhere() : e.adhere());
this._scrollItem = null;
};
t.prototype._onTouchCancelled = function(e, t) {
var o = this;
if (!o._scrollView.hasNestedViewGroup(e, t) && !e.simulate) {
o._scrollPos = null;
if (o._slideMode == l.ADHERING) {
o.adhering && (o._adheringBarrier = !0);
o.adhere();
} else o._slideMode == l.PAGE && (null != o._beganPos ? o._pageAdhere() : o.adhere());
this._scrollItem = null;
}
};
t.prototype._onSizeChanged = function() {
this.checkInited(!1) && this._onScrolling();
};
t.prototype._onItemAdaptive = function(e) {
if (!this._sizeType && e.width != this._itemSize.width || this._sizeType && e.height != this._itemSize.height) {
this._customSize || (this._customSize = {});
var t = this._sizeType ? e.height : e.width;
if (this._customSize[e._listId] != t) {
this._customSize[e._listId] = t;
this._resizeContent();
this.updateAll();
if (null != this._scrollToListId) {
this._scrollPos = null;
this.unschedule(this._scrollToSo);
this.scrollTo(this._scrollToListId, Math.max(0, this._scrollToEndTime - new Date().getTime() / 1e3));
}
}
}
};
t.prototype._pageAdhere = function() {
var e = this;
if (e.cyclic || !(e.elasticTop > 0 || e.elasticRight > 0 || e.elasticBottom > 0 || e.elasticLeft > 0)) {
var t = e._sizeType ? e.viewTop : e.viewLeft, o = (e._sizeType ? e.node.height : e.node.width) * e.pageDistance;
if (Math.abs(e._beganPos - t) > o) switch (e._alignCalcType) {
case 1:
case 4:
e._beganPos > t ? e.prePage(.5) : e.nextPage(.5);
break;

case 2:
case 3:
e._beganPos < t ? e.prePage(.5) : e.nextPage(.5);
} else e.elasticTop <= 0 && e.elasticRight <= 0 && e.elasticBottom <= 0 && e.elasticLeft <= 0 && e.adhere();
e._beganPos = null;
}
};
t.prototype.adhere = function() {
var e = this;
if (e.checkInited() && !(e.elasticTop > 0 || e.elasticRight > 0 || e.elasticBottom > 0 || e.elasticLeft > 0)) {
e.adhering = !0;
e._calcNearestItem();
var t = (e._sizeType ? e._topGap : e._leftGap) / (e._sizeType ? e.node.height : e.node.width);
e.scrollTo(e.nearestListId, .7, t);
}
};
t.prototype.update = function() {
if (!(this.frameByFrameRenderNum <= 0 || this._updateDone)) if (this._virtual) {
for (var e = this._updateCounter + this.frameByFrameRenderNum > this.displayItemNum ? this.displayItemNum : this._updateCounter + this.frameByFrameRenderNum, t = this._updateCounter; t < e; t++) {
var o = this.displayData[t];
o && this._createOrUpdateItem(o);
}
if (this._updateCounter >= this.displayItemNum - 1) if (this._doneAfterUpdate) {
this._updateCounter = 0;
this._updateDone = !1;
this._doneAfterUpdate = !1;
} else {
this._updateDone = !0;
this._delRedundantItem();
this._forceUpdate = !1;
this._calcNearestItem();
this.slideMode == l.PAGE && (this.curPageNum = this.nearestListId);
} else this._updateCounter += this.frameByFrameRenderNum;
} else if (this._updateCounter < this._numItems) {
for (e = this._updateCounter + this.frameByFrameRenderNum > this._numItems ? this._numItems : this._updateCounter + this.frameByFrameRenderNum, 
t = this._updateCounter; t < e; t++) this._createOrUpdateItem2(t);
this._updateCounter += this.frameByFrameRenderNum;
} else {
this._updateDone = !0;
this._calcNearestItem();
this.slideMode == l.PAGE && (this.curPageNum = this.nearestListId);
}
};
t.prototype._createOrUpdateItem = function(e) {
var t = this.getItemByListId(e.id);
if (t) {
if (this._forceUpdate && this.renderEvent) {
t.setPosition(cc.v2(e.x, e.y));
this._resetItemSize(t);
this.renderEvent && cc.Component.EventHandler.emitEvents([ this.renderEvent ], t, e.id % this._actualNumItems);
}
} else {
var o = this._pool.size() > 0;
t = o ? this._pool.get() : cc.instantiate(this._itemTmp);
if (!o || !cc.isValid(t)) {
t = cc.instantiate(this._itemTmp);
o = !1;
}
if (t._listId != e.id) {
t._listId = e.id;
t.setContentSize(this._itemSize);
}
t.setPosition(cc.v2(e.x, e.y));
this._resetItemSize(t);
this.content.addChild(t);
if (o && this._needUpdateWidget) {
var n = t.getComponent(cc.Widget);
n && n.updateAlignment();
}
t.setSiblingIndex(this.content.childrenCount - 1);
var a = t.getComponent(u.default);
t.listItem = a;
if (a) {
a.listId = e.id;
a.list = this;
a._registerEvent();
}
this.renderEvent && cc.Component.EventHandler.emitEvents([ this.renderEvent ], t, e.id % this._actualNumItems);
}
this._resetItemSize(t);
this._updateListItem(t.listItem);
this._lastDisplayData.indexOf(e.id) < 0 && this._lastDisplayData.push(e.id);
};
t.prototype._createOrUpdateItem2 = function(e) {
var t, o = this.content.children[e];
if (o) {
if (this._forceUpdate && this.renderEvent) {
o._listId = e;
t && (t.listId = e);
this.renderEvent && cc.Component.EventHandler.emitEvents([ this.renderEvent ], o, e % this._actualNumItems);
}
} else {
(o = cc.instantiate(this._itemTmp))._listId = e;
this.content.addChild(o);
t = o.getComponent(u.default);
o.listItem = t;
if (t) {
t.listId = e;
t.list = this;
t._registerEvent();
}
this.renderEvent && cc.Component.EventHandler.emitEvents([ this.renderEvent ], o, e % this._actualNumItems);
}
this._updateListItem(t);
this._lastDisplayData.indexOf(e) < 0 && this._lastDisplayData.push(e);
};
t.prototype._updateListItem = function(e) {
if (e && this.selectedMode > s.NONE) {
var t = e.node;
switch (this.selectedMode) {
case s.SINGLE:
e.selected = this.selectedId == t._listId;
break;

case s.MULT:
e.selected = this.multSelected.indexOf(t._listId) >= 0;
}
}
};
t.prototype._resetItemSize = function() {};
t.prototype._updateItemPos = function(e) {
var t = isNaN(e) ? e : this.getItemByListId(e), o = this.getItemPos(t._listId);
t.setPosition(o.x, o.y);
};
t.prototype.setMultSelected = function(e, t) {
var o = this;
if (o.checkInited()) {
Array.isArray(e) || (e = [ e ]);
if (null == t) o.multSelected = e; else {
var n = void 0, a = void 0;
if (t) for (var i = e.length - 1; i >= 0; i--) {
n = e[i];
(a = o.multSelected.indexOf(n)) < 0 && o.multSelected.push(n);
} else for (i = e.length - 1; i >= 0; i--) {
n = e[i];
(a = o.multSelected.indexOf(n)) >= 0 && o.multSelected.splice(a, 1);
}
}
o._forceUpdate = !0;
o._onScrolling();
}
};
t.prototype.getMultSelected = function() {
return this.multSelected;
};
t.prototype.hasMultSelected = function(e) {
return this.multSelected && this.multSelected.indexOf(e) >= 0;
};
t.prototype.updateItem = function(e) {
if (this.checkInited()) {
Array.isArray(e) || (e = [ e ]);
for (var t = 0, o = e.length; t < o; t++) {
var n = e[t], a = this.getItemByListId(n);
a && cc.Component.EventHandler.emitEvents([ this.renderEvent ], a, n % this._actualNumItems);
}
}
};
t.prototype.updateAll = function() {
this.checkInited() && (this.numItems = this.numItems);
};
t.prototype.getItemByListId = function(e) {
if (this.content) for (var t = this.content.childrenCount - 1; t >= 0; t--) {
var o = this.content.children[t];
if (o._listId == e) return o;
}
};
t.prototype._getOutsideItem = function() {
for (var e, t = [], o = this.content.childrenCount - 1; o >= 0; o--) {
e = this.content.children[o];
this.displayData.find(function(t) {
return t.id == e._listId;
}) || t.push(e);
}
return t;
};
t.prototype._delRedundantItem = function() {
if (this._virtual) for (var e = this._getOutsideItem(), t = e.length - 1; t >= 0; t--) {
var o = e[t];
if (!this._scrollItem || o._listId != this._scrollItem._listId) {
o.isCached = !0;
this._pool.put(o);
for (var n = this._lastDisplayData.length - 1; n >= 0; n--) if (this._lastDisplayData[n] == o._listId) {
this._lastDisplayData.splice(n, 1);
break;
}
}
} else for (;this.content.childrenCount > this._numItems; ) this._delSingleItem(this.content.children[this.content.childrenCount - 1]);
};
t.prototype._delSingleItem = function(e) {
e.removeFromParent();
e.destroy && e.destroy();
e = null;
};
t.prototype.aniDelItem = function(e, t, o) {
var n = this;
if (!n.checkInited() || n.cyclic || !n._virtual) return c.default.error("This function is not allowed to be called!");
if (!t) return c.default.error("CallFunc are not allowed to be NULL, You need to delete the corresponding index in the data array in the CallFunc!");
if (n._aniDelRuning) return c.default.warn("Please wait for the current deletion to finish!");
var a, i = n.getItemByListId(e);
if (i) {
a = i.getComponent(u.default);
n._aniDelRuning = !0;
n._aniDelCB = t;
n._aniDelItem = i;
n._aniDelBeforePos = i.position;
n._aniDelBeforeScale = i.scale;
var r = n.displayData[n.displayData.length - 1].id, l = a.selected;
a.showAni(o, function() {
var o, a, c;
r < n._numItems - 2 && (o = r + 1);
if (null != o) {
var u = n._calcItemPos(o);
n.displayData.push(u);
n._virtual ? n._createOrUpdateItem(u) : n._createOrUpdateItem2(o);
} else n._numItems--;
if (n.selectedMode == s.SINGLE) l ? n._selectedId = -1 : n._selectedId - 1 >= 0 && n._selectedId--; else if (n.selectedMode == s.MULT && n.multSelected.length) {
var d = n.multSelected.indexOf(e);
d >= 0 && n.multSelected.splice(d, 1);
for (var p = n.multSelected.length - 1; p >= 0; p--) (_ = n.multSelected[p]) >= e && n.multSelected[p]--;
}
if (n._customSize) {
n._customSize[e] && delete n._customSize[e];
var h = {}, f = void 0;
for (var _ in n._customSize) {
f = n._customSize[_];
var m = parseInt(_);
h[m - (m >= e ? 1 : 0)] = f;
}
n._customSize = h;
}
for (p = null != o ? o : r; p >= e + 1; p--) if (i = n.getItemByListId(p)) {
var y = n._calcItemPos(p - 1);
a = cc.tween(i).to(.2333, {
position: cc.v2(y.x, y.y)
});
if (p <= e + 1) {
c = !0;
a.call(function() {
n._aniDelRuning = !1;
t(e);
delete n._aniDelCB;
});
}
a.start();
}
if (!c) {
n._aniDelRuning = !1;
t(e);
n._aniDelCB = null;
}
}, !0);
} else t(e);
};
t.prototype.scrollTo = function(e, t, o, n) {
void 0 === t && (t = .5);
void 0 === o && (o = null);
void 0 === n && (n = !1);
var a = this;
if (a.checkInited(!1)) {
null == t ? t = .5 : t < 0 && (t = 0);
e < 0 ? e = 0 : e >= a._numItems && (e = a._numItems - 1);
!a._virtual && a._layout && a._layout.enabled && a._layout.updateLayout();
var i, r, l = a.getItemPos(e);
if (!l) return !1;
switch (a._alignCalcType) {
case 1:
i = l.left;
i -= null != o ? a.node.width * o : a._leftGap;
l = cc.v2(i, 0);
break;

case 2:
i = l.right - a.node.width;
i += null != o ? a.node.width * o : a._rightGap;
l = cc.v2(i + a.content.width, 0);
break;

case 3:
r = l.top;
r += null != o ? a.node.height * o : a._topGap;
l = cc.v2(0, -r);
break;

case 4:
r = l.bottom + a.node.height;
r -= null != o ? a.node.height * o : a._bottomGap;
l = cc.v2(0, -r + a.content.height);
}
var s = a.content.getPosition();
s = Math.abs(a._sizeType ? s.y : s.x);
var c = a._sizeType ? l.y : l.x;
if (Math.abs((null != a._scrollPos ? a._scrollPos : s) - c) > .5) {
a._scrollView.scrollToOffset(l, t);
a._scrollToListId = e;
a._scrollToEndTime = new Date().getTime() / 1e3 + t;
a._scrollToSo = a.scheduleOnce(function() {
a._adheringBarrier || (a.adhering = a._adheringBarrier = !1);
a._scrollPos = a._scrollToListId = a._scrollToEndTime = a._scrollToSo = null;
if (n) {
var t = a.getItemByListId(e);
t && cc.tween(t).to(.1, {
scale: 1.05
}).to(.1, {
scale: 1
}).start();
}
}, t + .1);
t <= 0 && a._onScrolling();
}
}
};
t.prototype._calcNearestItem = function() {
var e, t, o, n, a, i, r = this;
r.nearestListId = null;
r._virtual && r._calcViewPos();
o = r.viewTop;
n = r.viewRight;
a = r.viewBottom;
i = r.viewLeft;
for (var l = !1, s = 0; s < r.content.childrenCount && !l; s += r._colLineNum) if (e = r._virtual ? r.displayData[s] : r._calcExistItemPos(s)) {
t = r._sizeType ? (e.top + e.bottom) / 2 : t = (e.left + e.right) / 2;
switch (r._alignCalcType) {
case 1:
if (e.right >= i) {
r.nearestListId = e.id;
i > t && (r.nearestListId += r._colLineNum);
l = !0;
}
break;

case 2:
if (e.left <= n) {
r.nearestListId = e.id;
n < t && (r.nearestListId += r._colLineNum);
l = !0;
}
break;

case 3:
if (e.bottom <= o) {
r.nearestListId = e.id;
o < t && (r.nearestListId += r._colLineNum);
l = !0;
}
break;

case 4:
if (e.top >= a) {
r.nearestListId = e.id;
a > t && (r.nearestListId += r._colLineNum);
l = !0;
}
}
}
if ((e = r._virtual ? r.displayData[r.displayItemNum - 1] : r._calcExistItemPos(r._numItems - 1)) && e.id == r._numItems - 1) {
t = r._sizeType ? (e.top + e.bottom) / 2 : t = (e.left + e.right) / 2;
switch (r._alignCalcType) {
case 1:
n > t && (r.nearestListId = e.id);
break;

case 2:
i < t && (r.nearestListId = e.id);
break;

case 3:
a < t && (r.nearestListId = e.id);
break;

case 4:
o > t && (r.nearestListId = e.id);
}
}
};
t.prototype.prePage = function(e) {
void 0 === e && (e = .5);
this.checkInited() && this.skipPage(this.curPageNum - 1, e);
};
t.prototype.nextPage = function(e) {
void 0 === e && (e = .5);
this.checkInited() && this.skipPage(this.curPageNum + 1, e);
};
t.prototype.skipPage = function(e, t) {
var o = this;
if (o.checkInited()) {
if (o._slideMode != l.PAGE) return c.default.error("This function is not allowed to be called, Must SlideMode = PAGE!");
if (!(e < 0 || e >= o._numItems) && o.curPageNum != e) {
o.curPageNum = e;
o.pageChangeEvent && cc.Component.EventHandler.emitEvents([ o.pageChangeEvent ], e);
o.scrollTo(e, t);
}
}
};
t.prototype.calcCustomSize = function(e) {
var t = this;
if (t.checkInited()) {
if (!t._itemTmp) return c.default.error("Unset template item!");
if (!t.renderEvent) return c.default.error("Unset Render-Event!");
t._customSize = {};
var o = cc.instantiate(t._itemTmp);
t.content.addChild(o);
for (var n = 0; n < e; n++) {
cc.Component.EventHandler.emitEvents([ t.renderEvent ], o, n);
o.height == t._itemSize.height && o.width == t._itemSize.width || (t._customSize[n] = t._sizeType ? o.height : o.width);
}
Object.keys(t._customSize).length || (t._customSize = null);
o.removeFromParent();
o.destroy && o.destroy();
return t._customSize;
}
};
i([ h({
type: cc.Enum(r),
tooltip: !1
}) ], t.prototype, "templateType", void 0);
i([ h({
type: cc.Node,
tooltip: !1,
visible: function() {
return this.templateType == r.NODE;
}
}) ], t.prototype, "tmpNode", void 0);
i([ h({
type: cc.Prefab,
tooltip: !1,
visible: function() {
return this.templateType == r.PREFAB;
}
}) ], t.prototype, "tmpPrefab", void 0);
i([ h() ], t.prototype, "_slideMode", void 0);
i([ h({
type: cc.Enum(l),
tooltip: !1
}) ], t.prototype, "slideMode", null);
i([ h({
type: cc.Float,
range: [ 0, 1, .1 ],
tooltip: !1,
slide: !0,
visible: function() {
return this._slideMode == l.PAGE;
}
}) ], t.prototype, "pageDistance", void 0);
i([ h({
type: cc.Component.EventHandler,
tooltip: !1,
visible: function() {
return this._slideMode == l.PAGE;
}
}) ], t.prototype, "pageChangeEvent", void 0);
i([ h() ], t.prototype, "_virtual", void 0);
i([ h({
type: cc.Boolean,
tooltip: !1
}) ], t.prototype, "virtual", null);
i([ h({
tooltip: !1,
visible: function() {
var e = this.slideMode == l.NORMAL;
e || (this.cyclic = !1);
return e;
}
}) ], t.prototype, "cyclic", void 0);
i([ h({
tooltip: !1,
visible: function() {
return this.virtual;
}
}) ], t.prototype, "lackCenter", void 0);
i([ h({
tooltip: !1,
visible: function() {
var e = this.virtual && !this.lackCenter;
e || (this.lackSlide = !1);
return e;
}
}) ], t.prototype, "lackSlide", void 0);
i([ h({
type: cc.Integer
}) ], t.prototype, "_updateRate", void 0);
i([ h({
type: cc.Integer,
range: [ 0, 6, 1 ],
tooltip: !1,
slide: !0
}) ], t.prototype, "updateRate", null);
i([ h({
type: cc.Integer,
range: [ 0, 12, 1 ],
tooltip: !1,
slide: !0
}) ], t.prototype, "frameByFrameRenderNum", void 0);
i([ h({
type: cc.Component.EventHandler,
tooltip: !1
}) ], t.prototype, "renderEvent", void 0);
i([ h({
type: cc.Enum(s),
tooltip: !1
}) ], t.prototype, "selectedMode", void 0);
i([ h({
tooltip: !1,
visible: function() {
return this.selectedMode == s.SINGLE;
}
}) ], t.prototype, "repeatEventSingle", void 0);
i([ h({
type: cc.Component.EventHandler,
tooltip: !1,
visible: function() {
return this.selectedMode > s.NONE;
}
}) ], t.prototype, "selectedEvent", void 0);
i([ h({
serializable: !1
}) ], t.prototype, "_numItems", void 0);
return i([ p, f(), _("自定义组件/TableList"), y(cc.ScrollView), m(-5e3) ], t);
}(cc.Component);
o.default = g;
cc._RF.pop();
}, {
"../../../platform/Platform": "Platform",
"./TableListItem": "TableListItem"
} ],
TableManager: [ function(e, t, o) {
"use strict";
cc._RF.push(t, "6ea30qIgp5Gm7MDW7ub0NtN", "TableManager");
var n, a = this && this.__extends || (n = function(e, t) {
return (n = Object.setPrototypeOf || {
__proto__: []
} instanceof Array && function(e, t) {
e.__proto__ = t;
} || function(e, t) {
for (var o in t) Object.prototype.hasOwnProperty.call(t, o) && (e[o] = t[o]);
})(e, t);
}, function(e, t) {
n(e, t);
function o() {
this.constructor = e;
}
e.prototype = null === t ? Object.create(t) : (o.prototype = t.prototype, new o());
}), i = this && this.__decorate || function(e, t, o, n) {
var a, i = arguments.length, r = i < 3 ? t : null === n ? n = Object.getOwnPropertyDescriptor(t, o) : n;
if ("object" == typeof Reflect && "function" == typeof Reflect.decorate) r = Reflect.decorate(e, t, o, n); else for (var l = e.length - 1; l >= 0; l--) (a = e[l]) && (r = (i < 3 ? a(r) : i > 3 ? a(t, o, r) : a(t, o)) || r);
return i > 3 && r && Object.defineProperty(t, o, r), r;
};
Object.defineProperty(o, "__esModule", {
value: !0
});
var r = e("../../../Game/BundleManager"), l = e("../../../Game/Script/global/GlobalValue"), s = e("../../../Game/client/global/enum/game/Const"), c = e("../../../Game/client/global/enum/game/Event"), u = e("../../../Game/client/logic/game/GameHelper"), d = e("../../../Game/client/model/LanguageModel"), p = e("../../../Game/fromework/global/ResLoader"), h = e("../../../Game/fromework/helper/EventHelper"), f = e("../../../Game/fromework/mvvm/modelView/ViewModel"), _ = e("../../../platform/Platform"), m = e("../../global/PopHelper"), y = e("../../model/GameModel"), g = e("../Wallet/WalletHelper"), v = e("./TableBoard"), C = cc._decorator, b = C.ccclass, I = C.property, E = function(e) {
a(t, e);
function t() {
var t = null !== e && e.apply(this, arguments) || this;
t.Prefab_Table = null;
t._table = null;
return t;
}
t.prototype.onEnable = function() {
h.default.Instance.Global.bind(c.GameEvent.TABLE_LEAVE_ROOM, this.closeGame, this);
h.default.Instance.Global.bind("ErrorCode13", this.onError13, this);
h.default.Instance.Global.bind("ErrorCode123", this.onError123, this);
};
t.prototype.onDisable = function() {
h.default.Instance.Global.unbind(c.GameEvent.TABLE_LEAVE_ROOM, this.closeGame, this);
h.default.Instance.Global.unbind("ErrorCode13", this.onError13, this);
h.default.Instance.Global.unbind("ErrorCode123", this.onError123, this);
};
t.prototype.onError13 = function() {
var e, t = function() {
h.default.Instance.Global.emit(c.GameEvent.TABLE_LEAVE_ROOM, {
isRecharge: !1
});
};
e = l.default.getInstance().isCashGame ? {
content: d.default.getString("COMMON_TIPS_CASH"),
leftTitle: d.default.getString("SIGN_BACK"),
leftCallFunc: t,
rightTitle: d.default.getString("COMMON_TIPS_BTN_ADDFUNDS"),
rightCallFunc: function() {
h.default.Instance.Global.emit(c.GameEvent.TABLE_LEAVE_ROOM, {
isRecharge: !0
});
},
cancelCallFunc: t
} : {
content: d.default.getString("COMMON_TIPS_CASH"),
leftTitle: d.default.getString("SIGN_BACK"),
leftCallFunc: t,
cancelCallFunc: t
};
m.PopHelper.Instance.showAlert(e);
};
t.prototype.onError123 = function() {
m.PopHelper.Instance.showTips("You can only play 1 tables in the same time");
};
t.prototype.createTable = function() {
if (!this._table || !this._table.node || !this._table.node.isValid) {
var e = cc.instantiate(this.Prefab_Table);
this.node.addChild(e);
this._table = e.getComponent(v.default);
}
};
t.prototype.removeTable = function() {
if (this._table && this._table.node && this._table.isValid) {
this._table.node.removeFromParent(!0);
this._table.node.destroy();
this._table = null;
}
};
t.prototype.startGame = function() {
var e = f.VM.getValue("lobby.roomID");
if (0 != e) {
this.createTable();
y.default.Instance.sendEnterRoom(e);
}
};
t.prototype.closeGame = function(e) {
var t = e.getUserData();
f.VM.setValue("lobby.roomID", 0);
this.removeTable();
m.PopHelper.Instance.showWaiting(1, "Loading");
for (var o = [ s.BundleUIPath.LobbyView ], n = 0, a = 0; a < o.length; a++) p.default.Instance.loadBundleRes(o[a], cc.Prefab, function() {
++n == o.length && cc.director.preloadScene(s.Scene.Lobby, null, function() {
m.PopHelper.Instance.hideWaiting();
u.Countdown.clear();
r.default.getInstance().enterBundleScene(s.Scene.Lobby, function() {
t.isRecharge ? g.default.Instance.openRecharge() : t.isWithdraw && g.default.Instance.openWithdraw();
});
_.default.setOrientation(s.Orientation.Landscape);
});
});
};
i([ I(cc.Prefab) ], t.prototype, "Prefab_Table", void 0);
return i([ b ], t);
}(cc.Component);
o.default = E;
cc._RF.pop();
}, {
"../../../Game/BundleManager": "BundleManager",
"../../../Game/Script/global/GlobalValue": "GlobalValue",
"../../../Game/client/global/enum/game/Const": "Const",
"../../../Game/client/global/enum/game/Event": "Event",
"../../../Game/client/logic/game/GameHelper": "GameHelper",
"../../../Game/client/model/LanguageModel": "LanguageModel",
"../../../Game/fromework/global/ResLoader": "ResLoader",
"../../../Game/fromework/helper/EventHelper": "EventHelper",
"../../../Game/fromework/mvvm/modelView/ViewModel": "ViewModel",
"../../../platform/Platform": "Platform",
"../../global/PopHelper": "PopHelper",
"../../model/GameModel": "GameModel",
"../Wallet/WalletHelper": "WalletHelper",
"./TableBoard": "TableBoard"
} ],
TableMenu: [ function(e, t, o) {
"use strict";
cc._RF.push(t, "eeb7eno7bBPPrJ+8mCuAsml", "TableMenu");
var n, a = this && this.__extends || (n = function(e, t) {
return (n = Object.setPrototypeOf || {
__proto__: []
} instanceof Array && function(e, t) {
e.__proto__ = t;
} || function(e, t) {
for (var o in t) Object.prototype.hasOwnProperty.call(t, o) && (e[o] = t[o]);
})(e, t);
}, function(e, t) {
n(e, t);
function o() {
this.constructor = e;
}
e.prototype = null === t ? Object.create(t) : (o.prototype = t.prototype, new o());
}), i = this && this.__decorate || function(e, t, o, n) {
var a, i = arguments.length, r = i < 3 ? t : null === n ? n = Object.getOwnPropertyDescriptor(t, o) : n;
if ("object" == typeof Reflect && "function" == typeof Reflect.decorate) r = Reflect.decorate(e, t, o, n); else for (var l = e.length - 1; l >= 0; l--) (a = e[l]) && (r = (i < 3 ? a(r) : i > 3 ? a(t, o, r) : a(t, o)) || r);
return i > 3 && r && Object.defineProperty(t, o, r), r;
};
Object.defineProperty(o, "__esModule", {
value: !0
});
var r = cc._decorator, l = r.ccclass, s = r.property, c = function(e) {
a(t, e);
function t() {
var t = null !== e && e.apply(this, arguments) || this;
t.Panel = null;
t.SwitchButton = null;
t._openParam = null;
t._orignalPos = null;
return t;
}
t.prototype.show = function(e) {
var t = this;
this._openParam = e;
this.SwitchButton.node.getChildByName("Background"), this.SwitchButton.node.getChildByName("Label");
this.node.getComponent(cc.Widget).updateAlignment();
this.Panel.getComponent(cc.Widget).updateAlignment();
this.Panel.opacity = 0;
this.scheduleOnce(function() {
t.Panel.opacity = 255;
t._orignalPos = cc.v2(-t.node.width / 2, t.node.height / 2);
t.Panel.setPosition(t._orignalPos);
t.openAction();
});
};
t.prototype.close = function() {
this.onBackClicked();
};
t.prototype.openAction = function() {
this.Panel.setPosition(cc.v2(this.Panel.x - this.Panel.width, this._orignalPos.y));
this.Panel.runAction(cc.moveTo(.1, cc.v2(this._orignalPos.x, this._orignalPos.y)));
};
t.prototype.closeAction = function(e) {
var t = this;
this.Panel.runAction(cc.sequence(cc.moveTo(.1, cc.v2(this._orignalPos.x - this.Panel.width, this._orignalPos.y)), cc.callFunc(function() {
e && e();
t.node.removeFromParent(!0);
t.node.destroy();
})));
};
t.prototype.onLeaveClicked = function() {
var e = this;
this.closeAction(function() {
e._openParam.leaveCallFunc && (e._openParam.target ? e._openParam.leaveCallFunc.call(e._openParam.target) : e._openParam.leaveCallFunc());
});
};
t.prototype.onSwitchClicked = function() {
var e = this;
this.closeAction(function() {
e._openParam.switchCallFunc && (e._openParam.target ? e._openParam.switchCallFunc.call(e._openParam.target) : e._openParam.switchCallFunc());
});
};
t.prototype.onBackClicked = function() {
this.closeAction();
};
i([ s(cc.Node) ], t.prototype, "Panel", void 0);
i([ s(cc.Button) ], t.prototype, "SwitchButton", void 0);
return i([ l ], t);
}(cc.Component);
o.default = c;
cc._RF.pop();
}, {} ],
TableOptTips: [ function(e, t, o) {
"use strict";
cc._RF.push(t, "5f64asmiQZLP7ana/R+7nd7", "TableOptTips");
var n, a = this && this.__extends || (n = function(e, t) {
return (n = Object.setPrototypeOf || {
__proto__: []
} instanceof Array && function(e, t) {
e.__proto__ = t;
} || function(e, t) {
for (var o in t) Object.prototype.hasOwnProperty.call(t, o) && (e[o] = t[o]);
})(e, t);
}, function(e, t) {
n(e, t);
function o() {
this.constructor = e;
}
e.prototype = null === t ? Object.create(t) : (o.prototype = t.prototype, new o());
}), i = this && this.__decorate || function(e, t, o, n) {
var a, i = arguments.length, r = i < 3 ? t : null === n ? n = Object.getOwnPropertyDescriptor(t, o) : n;
if ("object" == typeof Reflect && "function" == typeof Reflect.decorate) r = Reflect.decorate(e, t, o, n); else for (var l = e.length - 1; l >= 0; l--) (a = e[l]) && (r = (i < 3 ? a(r) : i > 3 ? a(t, o, r) : a(t, o)) || r);
return i > 3 && r && Object.defineProperty(t, o, r), r;
};
Object.defineProperty(o, "__esModule", {
value: !0
});
var r = e("../../../Game/client/model/LanguageModel"), l = cc._decorator, s = l.ccclass, c = l.property, u = function(e) {
a(t, e);
function t() {
var t = null !== e && e.apply(this, arguments) || this;
t.TipsLabel = null;
t.DrawTips = null;
t.DiscardTips = null;
t.CloseDeck = null;
t.FinishDeck = null;
t.OpenDeck = null;
return t;
}
t.prototype.showOperationTips = function(e) {
this.node.active = !0;
if (0 == e) {
this.TipsLabel.string = r.default.getString("GAME_TIPS_HAND_DRAW");
this.DrawTips.active = !0;
this.DiscardTips.active = !1;
}
if (1 == e) {
this.TipsLabel.string = r.default.getString("GAME_TIPS_HAND_DISCARD");
this.DrawTips.active = !1;
this.DiscardTips.active = !0;
}
};
t.prototype.hideOperationTips = function() {
this.node.active = !1;
};
t.prototype.getState = function() {
return this.node.active;
};
i([ c(cc.Label) ], t.prototype, "TipsLabel", void 0);
i([ c(cc.Node) ], t.prototype, "DrawTips", void 0);
i([ c(cc.Node) ], t.prototype, "DiscardTips", void 0);
i([ c(cc.Node) ], t.prototype, "CloseDeck", void 0);
i([ c(cc.Node) ], t.prototype, "FinishDeck", void 0);
i([ c(cc.Node) ], t.prototype, "OpenDeck", void 0);
return i([ s ], t);
}(cc.Component);
o.default = u;
cc._RF.pop();
}, {
"../../../Game/client/model/LanguageModel": "LanguageModel"
} ],
TaskButton: [ function(e, t, o) {
"use strict";
cc._RF.push(t, "857a3WpqWdBQa8OYokgmJn/", "TaskButton");
var n, a = this && this.__extends || (n = function(e, t) {
return (n = Object.setPrototypeOf || {
__proto__: []
} instanceof Array && function(e, t) {
e.__proto__ = t;
} || function(e, t) {
for (var o in t) Object.prototype.hasOwnProperty.call(t, o) && (e[o] = t[o]);
})(e, t);
}, function(e, t) {
n(e, t);
function o() {
this.constructor = e;
}
e.prototype = null === t ? Object.create(t) : (o.prototype = t.prototype, new o());
}), i = this && this.__decorate || function(e, t, o, n) {
var a, i = arguments.length, r = i < 3 ? t : null === n ? n = Object.getOwnPropertyDescriptor(t, o) : n;
if ("object" == typeof Reflect && "function" == typeof Reflect.decorate) r = Reflect.decorate(e, t, o, n); else for (var l = e.length - 1; l >= 0; l--) (a = e[l]) && (r = (i < 3 ? a(r) : i > 3 ? a(t, o, r) : a(t, o)) || r);
return i > 3 && r && Object.defineProperty(t, o, r), r;
};
Object.defineProperty(o, "__esModule", {
value: !0
});
var r = e("../../../../Game/fromework/global/Tools"), l = e("../../../../Game/fromework/helper/EventHelper"), s = e("../../../../Game/client/global/enum/game/Event"), c = e("./TaskModel"), u = cc._decorator, d = u.ccclass, p = u.property, h = function(e) {
a(t, e);
function t() {
var t = null !== e && e.apply(this, arguments) || this;
t.TaskCount = null;
return t;
}
t.prototype.onLoad = function() {
l.default.Instance.Global.bind(s.RedDotEvent.REFRESH_RED_DOT, this.refreshState, this);
l.default.Instance.Global.bind(s.RedDotEvent.REFRESH_RED_DOT_DATA, this.refreshTaskCount, this);
};
t.prototype.onDestroy = function() {
l.default.Instance.Global.unbind(s.RedDotEvent.REFRESH_RED_DOT, this.refreshState, this);
l.default.Instance.Global.unbind(s.RedDotEvent.REFRESH_RED_DOT_DATA, this.refreshTaskCount, this);
};
t.prototype.start = function() {
this.refreshState();
this.refreshTaskCount();
};
t.prototype.refreshState = function() {};
t.prototype.refreshTaskCount = function() {
var e = c.TaskProxy.Instance.taskLobbyData;
null != e && (this.TaskCount.string = r.Tools.TNumber.simplifyNumber(e.count) + "<color=#FFFFFF>/" + r.Tools.TNumber.simplifyNumber(e.target) + "</c>");
};
i([ p(cc.RichText) ], t.prototype, "TaskCount", void 0);
return i([ d ], t);
}(cc.Component);
o.default = h;
cc._RF.pop();
}, {
"../../../../Game/client/global/enum/game/Event": "Event",
"../../../../Game/fromework/global/Tools": "Tools",
"../../../../Game/fromework/helper/EventHelper": "EventHelper",
"./TaskModel": "TaskModel"
} ],
TaskEvent: [ function(e, t, o) {
"use strict";
cc._RF.push(t, "7582ejSQ39DQZlmFUxjl8bo", "TaskEvent");
Object.defineProperty(o, "__esModule", {
value: !0
});
o.TaskType = o.TaskEvent = void 0;
o.TaskEvent = {
TASK_GET_TASK_LIST: "TASK_GET_TASK_LIST",
TASK_GET_REWARD: "TASK_GET_REWARD",
TASK_UI_CLOSE_VIEW: "TASK_UI_CLOSE_VIEW"
};
(function(e) {
e[e.Daily = 1] = "Daily";
e[e.Weekly = 2] = "Weekly";
e[e.Career = 3] = "Career";
e[e.Box = 4] = "Box";
})(o.TaskType || (o.TaskType = {}));
cc._RF.pop();
}, {} ],
TaskItem: [ function(e, t, o) {
"use strict";
cc._RF.push(t, "572a7k6XKBGgaSc0sMZV4L/", "TaskItem");
var n, a = this && this.__extends || (n = function(e, t) {
return (n = Object.setPrototypeOf || {
__proto__: []
} instanceof Array && function(e, t) {
e.__proto__ = t;
} || function(e, t) {
for (var o in t) Object.prototype.hasOwnProperty.call(t, o) && (e[o] = t[o]);
})(e, t);
}, function(e, t) {
n(e, t);
function o() {
this.constructor = e;
}
e.prototype = null === t ? Object.create(t) : (o.prototype = t.prototype, new o());
}), i = this && this.__decorate || function(e, t, o, n) {
var a, i = arguments.length, r = i < 3 ? t : null === n ? n = Object.getOwnPropertyDescriptor(t, o) : n;
if ("object" == typeof Reflect && "function" == typeof Reflect.decorate) r = Reflect.decorate(e, t, o, n); else for (var l = e.length - 1; l >= 0; l--) (a = e[l]) && (r = (i < 3 ? a(r) : i > 3 ? a(t, o, r) : a(t, o)) || r);
return i > 3 && r && Object.defineProperty(t, o, r), r;
};
Object.defineProperty(o, "__esModule", {
value: !0
});
var r = e("../../../../Game/fromework/helper/EventHelper"), l = e("../../../../Game/fromework/helper/UIHelper"), s = e("../../../../Game/client/global/enum/game/Event"), c = e("../../../../Game/client/global/enum/game/Game"), u = e("../../Wallet/WalletHelper"), d = e("../UserInfo/UserInfo"), p = e("./TaskEvent"), h = e("./TaskModel"), f = e("../../../../Game/client/global/enum/game/Const"), _ = cc._decorator, m = _.ccclass, y = _.property, g = function(e) {
a(t, e);
function t() {
var t = null !== e && e.apply(this, arguments) || this;
t.Condition = null;
t.CashIcon = null;
t.BonusIcon = null;
t.ItemIcon = null;
t.Progress = null;
t.ProgressLabel = null;
t.GoButton = null;
t.RewardButton = null;
t.FinishNode = null;
t._index = 0;
t._taskData = null;
return t;
}
t.prototype.refresh = function(e, t) {
this._index = t;
this._taskData = e;
this.Condition.string = this._taskData.title;
var o = this._taskData.reward_list[0];
if (1 == o.rtype) {
this.CashIcon.active = o.type == c.GameEnum.MoneyType.CASH;
this.BonusIcon.active = o.type == c.GameEnum.MoneyType.BONUS;
this.ItemIcon.active = !1;
this.CashIcon.getChildByName("Reward").getComponent(cc.Label).string = o.num.toString();
this.BonusIcon.getChildByName("Reward").getComponent(cc.Label).string = o.num.toString();
} else if (2 == this._taskData.reward_list[0].rtype) {
this.CashIcon.active = !1;
this.BonusIcon.active = !1;
this.ItemIcon.active = !0;
this.ItemIcon.getChildByName("Reward").getComponent(cc.Label).string = o.num.toString();
}
var n = this._taskData.count / this._taskData.target;
n < 0 && (n = 0);
n > 1 && (n = 1);
this.Progress.progress = n;
this.ProgressLabel.string = Math.min(this._taskData.count, this._taskData.target) + "/" + this._taskData.target;
this.GoButton.active = 0 == this._taskData.state;
this.RewardButton.active = 1 == this._taskData.state;
this.FinishNode.active = 2 == this._taskData.state;
};
t.prototype.onGoClicked = function() {
if (0 == this._taskData.state) {
1 == this._taskData.item || 4 == this._taskData.item || 6 == this._taskData.item ? r.default.Instance.Global.emit(s.GameUIEvent.LOBBY_CASH_JOIN, this._taskData.item_target) : 2 == this._taskData.item ? u.default.Instance.openRecharge() : 3 == this._taskData.item ? l.default.Instance.addBundleMaskLayer(f.BundleUIPath.MonthCard) : 5 == this._taskData.item ? u.default.Instance.openReferearn() : 13 == this._taskData.item ? l.default.Instance.addBundleMaskLayer(f.BundleUIPath.UserInfo, function(e) {
e.getComponent(d.default).InitView(0);
}) : 14 == this._taskData.item && u.default.Instance.openWithdraw();
r.default.Instance.Global.emit(p.TaskEvent.TASK_UI_CLOSE_VIEW);
}
};
t.prototype.onRewardClicked = function() {
1 == this._taskData.state && h.TaskProxy.Instance.sendTaskGetReward(this._taskData.id);
};
i([ y(cc.Label) ], t.prototype, "Condition", void 0);
i([ y(cc.Node) ], t.prototype, "CashIcon", void 0);
i([ y(cc.Node) ], t.prototype, "BonusIcon", void 0);
i([ y(cc.Node) ], t.prototype, "ItemIcon", void 0);
i([ y(cc.ProgressBar) ], t.prototype, "Progress", void 0);
i([ y(cc.Label) ], t.prototype, "ProgressLabel", void 0);
i([ y(cc.Node) ], t.prototype, "GoButton", void 0);
i([ y(cc.Node) ], t.prototype, "RewardButton", void 0);
i([ y(cc.Node) ], t.prototype, "FinishNode", void 0);
return i([ m ], t);
}(cc.Component);
o.default = g;
cc._RF.pop();
}, {
"../../../../Game/client/global/enum/game/Const": "Const",
"../../../../Game/client/global/enum/game/Event": "Event",
"../../../../Game/client/global/enum/game/Game": "Game",
"../../../../Game/fromework/helper/EventHelper": "EventHelper",
"../../../../Game/fromework/helper/UIHelper": "UIHelper",
"../../Wallet/WalletHelper": "WalletHelper",
"../UserInfo/UserInfo": "UserInfo",
"./TaskEvent": "TaskEvent",
"./TaskModel": "TaskModel"
} ],
TaskModel: [ function(e, t, o) {
"use strict";
cc._RF.push(t, "724eeujSO5M2IZu2T4eAUEX", "TaskModel");
Object.defineProperty(o, "__esModule", {
value: !0
});
o.TaskProxy = void 0;
var n = e("../../../../Game/fromework/helper/EventHelper"), a = e("../../../../fromework/helper/NetHelper"), i = e("../../../../Game/fromework/mvvm/modelView/ViewModel"), r = e("../../../../Game/client/global/enum/game/Event"), l = e("../../../../Game/client/global/enum/game/Game"), s = e("./TaskEvent"), c = e("./TaskStruct"), u = e("../../../../Game/client/global/enum/net/S2C"), d = e("../../../../Game/client/global/enum/net/C2S"), p = function() {
function e() {
this._day_time = -1;
this._week_time = -1;
this._taskMap = new Map();
this._taskLobbyData = new c.TaskStruct.TaskData();
}
Object.defineProperty(e, "Instance", {
get: function() {
e._instance || (e._instance = new e());
return e._instance;
},
enumerable: !1,
configurable: !0
});
e.prototype.Init = function() {
n.default.Instance.Net.bind(u.S2C.TASK.TASK_MAIN, this._onTaskMain, this);
n.default.Instance.Net.bind(u.S2C.TASK.TASK_GET_REWARD, this._onGetReward, this);
};
e.prototype.clear = function() {
n.default.Instance.Net.unbind(u.S2C.TASK.TASK_MAIN, this._onTaskMain, this);
n.default.Instance.Net.unbind(u.S2C.TASK.TASK_GET_REWARD, this._onGetReward, this);
this._day_time = -1;
this._week_time = -1;
this._taskMap.clear();
};
Object.defineProperty(e.prototype, "uid", {
get: function() {
return i.VM.getValue("user.uid");
},
enumerable: !1,
configurable: !0
});
Object.defineProperty(e.prototype, "token", {
get: function() {
return i.VM.getValue("user.token");
},
enumerable: !1,
configurable: !0
});
Object.defineProperty(e.prototype, "day_time", {
get: function() {
return this._day_time;
},
enumerable: !1,
configurable: !0
});
Object.defineProperty(e.prototype, "week_time", {
get: function() {
return this._week_time;
},
enumerable: !1,
configurable: !0
});
Object.defineProperty(e.prototype, "taskMap", {
get: function() {
return this._taskMap;
},
enumerable: !1,
configurable: !0
});
Object.defineProperty(e.prototype, "taskLobbyData", {
get: function() {
return this._taskLobbyData;
},
set: function(e) {
null == e ? this._taskLobbyData = null : null != this._taskLobbyData ? this._taskLobbyData.refresh(e) : this._taskLobbyData = new c.TaskStruct.TaskData(e);
},
enumerable: !1,
configurable: !0
});
e.prototype.getTaskListByType = function(e) {
var t = [];
this.taskMap.forEach(function(o) {
o.type == e && t.push(o);
});
return t;
};
e.prototype.checkReddot = function() {
var e = 0, t = 0, o = 0;
this.taskMap.forEach(function(n) {
n.type == s.TaskType.Daily ? 1 == n.state && e++ : n.type == s.TaskType.Weekly ? 1 == n.state && t++ : n.type == s.TaskType.Career && 1 == n.state && o++;
});
n.default.Instance.Global.emit(r.RedDotEvent.REFRESH_RED_DOT_DATA, {
key: l.GameEnum.RedDotKey.DailyTask,
value: e
});
n.default.Instance.Global.emit(r.RedDotEvent.REFRESH_RED_DOT_DATA, {
key: l.GameEnum.RedDotKey.WeeklyTask,
value: t
});
n.default.Instance.Global.emit(r.RedDotEvent.REFRESH_RED_DOT_DATA, {
key: l.GameEnum.RedDotKey.CareerTask,
value: o
});
};
e.prototype._onTaskMain = function(e) {
var t = e.getUserData(), o = new Date().getTime();
this._day_time = o + 1e3 * t.day_time;
this._week_time = o + 1e3 * t.week_time;
this._taskMap.clear();
for (var a = 0; a < t.task.length; a++) {
var i = new c.TaskStruct.TaskData(t.task[a]);
this._taskMap.set(i.id, i);
}
this.checkReddot();
n.default.Instance.Global.emit(s.TaskEvent.TASK_GET_TASK_LIST);
};
e.prototype._onGetReward = function(e) {
var t = e.getUserData();
this._taskMap.clear();
for (var o = 0; o < t.task.length; o++) {
var a = new c.TaskStruct.TaskData(t.task[o]);
this._taskMap.set(a.id, a);
}
var i = {};
for (o = 0; o < t.reward.length; o++) {
var r = t.reward[o];
i[r.currency] = r.reward;
}
this.checkReddot();
n.default.Instance.Global.emit(s.TaskEvent.TASK_GET_REWARD, i);
};
e.prototype.sendTaskMain = function() {
var e = a.default.Instance.makeMsg(d.C2S.TASK_MAIN, {
u: this.uid,
t: this.token
});
a.default.Instance.send(e);
};
e.prototype.sendTaskGetReward = function(e) {
var t = a.default.Instance.makeMsg(d.C2S.TASK_GET_REWARD, {
u: this.uid,
t: this.token,
tid: e
});
a.default.Instance.send(t);
};
e._instance = null;
return e;
}();
o.TaskProxy = p;
cc._RF.pop();
}, {
"../../../../Game/client/global/enum/game/Event": "Event",
"../../../../Game/client/global/enum/game/Game": "Game",
"../../../../Game/client/global/enum/net/C2S": "C2S",
"../../../../Game/client/global/enum/net/S2C": "S2C",
"../../../../Game/fromework/helper/EventHelper": "EventHelper",
"../../../../Game/fromework/mvvm/modelView/ViewModel": "ViewModel",
"../../../../fromework/helper/NetHelper": "NetHelper",
"./TaskEvent": "TaskEvent",
"./TaskStruct": "TaskStruct"
} ],
TaskStruct: [ function(e, t, o) {
"use strict";
cc._RF.push(t, "3f687v1NXpPqbzfinM2rJCG", "TaskStruct");
Object.defineProperty(o, "__esModule", {
value: !0
});
o.TaskStruct = void 0;
var n = e("../../../../Game/client/model/CommonModel");
(function(e) {
var t = function() {
function e(e) {
this.id = 0;
this.title = "";
this.target = 0;
this.currency = 0;
this.reward = 0;
this.reward_list = [];
this.type = 0;
this.item = 0;
this.count = 0;
this.state = 0;
this.item_target = "";
this.order = 0;
e && this.refresh(e);
}
e.prototype.refresh = function(e) {
this.id = e.id;
this.title = e.title;
this.target = parseInt(e.target);
this.currency = parseInt(e.currency);
this.reward = parseFloat(e.reward);
this.type = parseInt(e.type);
this.item = parseInt(e.item);
this.count = parseInt(e.count);
this.state = parseInt(e.state);
this.item_target = e.item_target;
this.order = parseInt(e.order);
this.reward_list = [];
for (var t = 0; t < e.reward_list.length; t++) {
var o = new n.Common.Reward(e.reward_list[t]);
this.reward_list.push(o);
}
};
return e;
}();
e.TaskData = t;
})(o.TaskStruct || (o.TaskStruct = {}));
cc._RF.pop();
}, {
"../../../../Game/client/model/CommonModel": "CommonModel"
} ],
TaskView: [ function(e, t, o) {
"use strict";
cc._RF.push(t, "f2c95momQJGR4lLoUBSzfer", "TaskView");
var n, a = this && this.__extends || (n = function(e, t) {
return (n = Object.setPrototypeOf || {
__proto__: []
} instanceof Array && function(e, t) {
e.__proto__ = t;
} || function(e, t) {
for (var o in t) Object.prototype.hasOwnProperty.call(t, o) && (e[o] = t[o]);
})(e, t);
}, function(e, t) {
n(e, t);
function o() {
this.constructor = e;
}
e.prototype = null === t ? Object.create(t) : (o.prototype = t.prototype, new o());
}), i = this && this.__decorate || function(e, t, o, n) {
var a, i = arguments.length, r = i < 3 ? t : null === n ? n = Object.getOwnPropertyDescriptor(t, o) : n;
if ("object" == typeof Reflect && "function" == typeof Reflect.decorate) r = Reflect.decorate(e, t, o, n); else for (var l = e.length - 1; l >= 0; l--) (a = e[l]) && (r = (i < 3 ? a(r) : i > 3 ? a(t, o, r) : a(t, o)) || r);
return i > 3 && r && Object.defineProperty(t, o, r), r;
};
Object.defineProperty(o, "__esModule", {
value: !0
});
var r = e("../../../../fromework/component/TableView/TableList"), l = e("../../../../Game/client/model/LanguageModel"), s = e("./TaskEvent"), c = e("./TaskItem"), u = e("./TaskModel"), d = e("../../../../Game/fromework/helper/EventHelper"), p = e("../../../global/PopHelper"), h = e("../../../../Game/fromework/global/Tools"), f = e("../../../../Game/fromework/helper/UIHelper"), _ = e("../../../global/Global"), m = cc._decorator, y = m.ccclass, g = m.property, v = function(e) {
a(t, e);
function t() {
var t = null !== e && e.apply(this, arguments) || this;
t.TaskTableList = null;
t.DailyTask = null;
t.WeeklyTask = null;
t.CareerTask = null;
t.TaskBox = null;
t.TaskBoxCondition = null;
t.RefreshTime = null;
t._curTaskType = s.TaskType.Daily;
t._dailyList = [];
t._weeklyList = [];
t._careerList = [];
t._boxList = [];
return t;
}
t.prototype.onLoad = function() {
d.default.Instance.Global.bind(s.TaskEvent.TASK_GET_TASK_LIST, this.onGetTaskList, this);
d.default.Instance.Global.bind(s.TaskEvent.TASK_GET_REWARD, this.onGetReward, this);
d.default.Instance.Global.bind(s.TaskEvent.TASK_UI_CLOSE_VIEW, this.onCloseClicked, this);
};
t.prototype.onDestroy = function() {
d.default.Instance.Global.unbind(s.TaskEvent.TASK_GET_TASK_LIST, this.onGetTaskList, this);
d.default.Instance.Global.unbind(s.TaskEvent.TASK_GET_REWARD, this.onGetReward, this);
d.default.Instance.Global.unbind(s.TaskEvent.TASK_UI_CLOSE_VIEW, this.onCloseClicked, this);
};
t.prototype.start = function() {
u.TaskProxy.Instance.sendTaskMain();
};
t.prototype.onGetTaskList = function() {
this.refreshTaskData();
this.selectDefaultTaskType();
this.refreshTime();
this.refreshTaskToggle();
this.refreshTaskList();
this.refreshBox();
};
t.prototype.onGetReward = function(e) {
var t = e.getUserData();
p.PopHelper.Instance.showReward(_.Global.Instance.changeReward(t), function() {});
this.refreshTaskData();
this.refreshTaskList();
this.refreshBox();
};
t.prototype.refreshTaskToggle = function() {
this._curTaskType == s.TaskType.Daily ? this.DailyTask.isChecked = !0 : this._curTaskType == s.TaskType.Weekly ? this.WeeklyTask.isChecked = !0 : this._curTaskType == s.TaskType.Career ? this.CareerTask.isChecked = !0 : this.DailyTask.isChecked = !0;
};
t.prototype.onListRender = function(e, t) {
var o;
o = this._curTaskType == s.TaskType.Daily ? this._dailyList[t] : this._curTaskType == s.TaskType.Weekly ? this._weeklyList[t] : this._curTaskType == s.TaskType.Career ? this._careerList[t] : this._dailyList[t];
e.getComponent(c.default).refresh(o, t);
};
t.prototype.refreshTaskList = function() {
this._curTaskType == s.TaskType.Daily ? this.TaskTableList.numItems = this._dailyList.length : this._curTaskType == s.TaskType.Weekly ? this.TaskTableList.numItems = this._weeklyList.length : this._curTaskType == s.TaskType.Career ? this.TaskTableList.numItems = this._careerList.length : this.TaskTableList.numItems = this._dailyList.length;
};
t.prototype.refreshBox = function() {
var e = this._boxList[0];
if (e) if (0 == e.state) {
var t = e.target - e.count;
this.TaskBoxCondition.string = h.Tools.TStr.replaceAll(l.default.getString("TASK_BOX_UNAVAILABLE"), "%{count}", t);
} else 1 == e.state ? this.TaskBoxCondition.string = l.default.getString("TASK_BOX_AVAILABLE") : 2 == e.state && (this.TaskBoxCondition.string = l.default.getString("TASK_BOX_AVAILABLE"));
};
t.prototype.refreshTime = function() {
var e = this, t = 0;
if (this._curTaskType == s.TaskType.Daily) {
this.RefreshTime.node.active = !0;
t = Math.floor((u.TaskProxy.Instance.day_time - new Date().getTime()) / 1e3);
} else {
if (this._curTaskType != s.TaskType.Weekly) {
this.unscheduleAllCallbacks();
this.RefreshTime.node.active = !1;
return;
}
this.RefreshTime.node.active = !0;
t = Math.floor((u.TaskProxy.Instance.week_time - new Date().getTime()) / 1e3);
}
if (t <= 0) {
this.unscheduleAllCallbacks();
u.TaskProxy.Instance.sendTaskMain();
} else {
var o = function() {
if (e && e.node && e.node.isValid) {
var o = h.Tools.TDate.second2Hour(t), n = h.Tools.TDate.fix2(o.hour) + ":" + h.Tools.TDate.fix2(o.minu) + ":" + h.Tools.TDate.fix2(o.sec);
e.RefreshTime.string = h.Tools.TStr.replaceAll(l.default.getString("TASK_REFRESH_TIME"), "%{time}", n);
if (--t <= 0) {
e.unscheduleAllCallbacks();
u.TaskProxy.Instance.sendTaskMain();
}
}
};
this.unscheduleAllCallbacks();
o();
this.schedule(o, 1);
}
};
t.prototype.checkTaskState = function(e) {
for (var t = !0, o = 0; o < e.length; o++) if (2 != e[o].state) {
t = !1;
break;
}
return t;
};
t.prototype.refreshTaskData = function() {
var e = function(e) {
e.sort(function(e, t) {
return e.state == t.state ? t.order - e.order : 1 == e.state ? -1 : 1 == t.state ? 1 : 0 == e.state ? -1 : 0 == t.state ? 1 : 0;
});
return e;
};
this._dailyList = e(u.TaskProxy.Instance.getTaskListByType(s.TaskType.Daily));
this._weeklyList = e(u.TaskProxy.Instance.getTaskListByType(s.TaskType.Weekly));
this._careerList = e(u.TaskProxy.Instance.getTaskListByType(s.TaskType.Career));
this._boxList = e(u.TaskProxy.Instance.getTaskListByType(s.TaskType.Box));
};
t.prototype.selectDefaultTaskType = function() {
this.checkTaskState(this._dailyList) ? this.checkTaskState(this._weeklyList) ? this.checkTaskState(this._careerList) ? this._curTaskType = s.TaskType.Daily : this._curTaskType = s.TaskType.Career : this._curTaskType = s.TaskType.Weekly : this._curTaskType = s.TaskType.Daily;
};
t.prototype.onTaskToggleClicked = function(e, t) {
this._curTaskType = parseInt(t);
this.refreshTaskList();
this.refreshTime();
};
t.prototype.onTaskBoxClicked = function() {
var e = this._boxList[0];
if (e) if (1 == e.state) u.TaskProxy.Instance.sendTaskGetReward(e.id); else {
var t = e.target - e.count;
p.PopHelper.Instance.showTips(h.Tools.TStr.replaceAll(l.default.getString("TASK_BOX_UNAVAILABLE"), "%{count}", t));
}
};
t.prototype.onCloseClicked = function() {
f.default.Instance.removeMaskLayer(this.node, !0);
};
i([ g(r.default) ], t.prototype, "TaskTableList", void 0);
i([ g(cc.Toggle) ], t.prototype, "DailyTask", void 0);
i([ g(cc.Toggle) ], t.prototype, "WeeklyTask", void 0);
i([ g(cc.Toggle) ], t.prototype, "CareerTask", void 0);
i([ g(dragonBones.ArmatureDisplay) ], t.prototype, "TaskBox", void 0);
i([ g(cc.Label) ], t.prototype, "TaskBoxCondition", void 0);
i([ g(cc.Label) ], t.prototype, "RefreshTime", void 0);
return i([ y ], t);
}(cc.Component);
o.default = v;
cc._RF.pop();
}, {
"../../../../Game/client/model/LanguageModel": "LanguageModel",
"../../../../Game/fromework/global/Tools": "Tools",
"../../../../Game/fromework/helper/EventHelper": "EventHelper",
"../../../../Game/fromework/helper/UIHelper": "UIHelper",
"../../../../fromework/component/TableView/TableList": "TableList",
"../../../global/Global": "Global",
"../../../global/PopHelper": "PopHelper",
"./TaskEvent": "TaskEvent",
"./TaskItem": "TaskItem",
"./TaskModel": "TaskModel"
} ],
TeenPattiInfo: [ function(e, t, o) {
"use strict";
cc._RF.push(t, "ea8a8k9kPNHqLpbv2YHt6wc", "TeenPattiInfo");
var n, a = this && this.__extends || (n = function(e, t) {
return (n = Object.setPrototypeOf || {
__proto__: []
} instanceof Array && function(e, t) {
e.__proto__ = t;
} || function(e, t) {
for (var o in t) Object.prototype.hasOwnProperty.call(t, o) && (e[o] = t[o]);
})(e, t);
}, function(e, t) {
n(e, t);
function o() {
this.constructor = e;
}
e.prototype = null === t ? Object.create(t) : (o.prototype = t.prototype, new o());
}), i = this && this.__decorate || function(e, t, o, n) {
var a, i = arguments.length, r = i < 3 ? t : null === n ? n = Object.getOwnPropertyDescriptor(t, o) : n;
if ("object" == typeof Reflect && "function" == typeof Reflect.decorate) r = Reflect.decorate(e, t, o, n); else for (var l = e.length - 1; l >= 0; l--) (a = e[l]) && (r = (i < 3 ? a(r) : i > 3 ? a(t, o, r) : a(t, o)) || r);
return i > 3 && r && Object.defineProperty(t, o, r), r;
};
Object.defineProperty(o, "__esModule", {
value: !0
});
var r = e("../../../../Game/fromework/helper/UIHelper"), l = e("../../../model/LobbyModel"), s = e("../../model/TeenPattiModel"), c = cc._decorator, u = c.ccclass, d = c.property, p = function(e) {
a(t, e);
function t() {
var t = null !== e && e.apply(this, arguments) || this;
t.Panel = null;
t.TableId = null;
t.BootValue = null;
t.MaximunBlinds = null;
t.ChaalLimit = null;
t.PotLimit = null;
t.GameType = null;
t._roomId = 0;
return t;
}
t.prototype.openAction = function() {
this.Panel.setPosition(cc.v2(0, this.node.height / 2 + this.Panel.height / 2));
this.Panel.runAction(cc.moveTo(.1, cc.v2(0, 0)));
};
t.prototype.closeAction = function(e) {
var t = this;
this.Panel.runAction(cc.sequence(cc.moveTo(.1, cc.v2(0, -(this.node.height / 2 + this.Panel.height / 2))), cc.callFunc(function() {
e && e();
r.default.Instance.removeMaskLayer(t.node);
})));
};
t.prototype.refreshView = function() {
var e = s.TeenPattiModel.Instance;
e || this.closeAction();
var t = l.default.Instance.getGamePlay(e.roomData.rtype);
this.TableId.string = this._roomId + "";
this.BootValue.string = t.base + "";
this.MaximunBlinds.string = t.max_blind + "";
this.ChaalLimit.string = t.chaal_limit + "";
this.PotLimit.string = t.pot_limit + "";
this.GameType.string = t.name;
};
t.prototype.InitView = function(e) {
this._roomId = e;
this.refreshView();
this.openAction();
};
t.prototype.onCloseClicked = function() {
this.closeAction();
};
i([ d(cc.Node) ], t.prototype, "Panel", void 0);
i([ d(cc.Label) ], t.prototype, "TableId", void 0);
i([ d(cc.Label) ], t.prototype, "BootValue", void 0);
i([ d(cc.Label) ], t.prototype, "MaximunBlinds", void 0);
i([ d(cc.Label) ], t.prototype, "ChaalLimit", void 0);
i([ d(cc.Label) ], t.prototype, "PotLimit", void 0);
i([ d(cc.Label) ], t.prototype, "GameType", void 0);
return i([ u ], t);
}(cc.Component);
o.default = p;
cc._RF.pop();
}, {
"../../../../Game/fromework/helper/UIHelper": "UIHelper",
"../../../model/LobbyModel": "LobbyModel",
"../../model/TeenPattiModel": "TeenPattiModel"
} ],
TeenPattiLogic: [ function(e, t, o) {
"use strict";
cc._RF.push(t, "bfd7f/UYtRKt7p8mhB93Rum", "TeenPattiLogic");
Object.defineProperty(o, "__esModule", {
value: !0
});
var n = e("../../logic/Wallet/WalletHelper"), a = e("../../../Game/client/model/LanguageModel"), i = e("../../model/LobbyModel"), r = e("./TeenPattiModel"), l = e("./TeenPattiStruct"), s = e("../../logic/active/ActiveManager"), c = e("../../logic/ui/ChairAlert/ChairAlert"), u = e("../../model/WalletModel"), d = e("../../../Game/fromework/helper/EventHelper"), p = e("../../../Game/client/global/enum/game/Event"), h = e("../../../Game/Script/global/GlobalValue"), f = e("../../../Game/fromework/helper/UIHelper"), _ = e("../../../Game/client/global/enum/game/Const"), m = e("../../../Game/client/global/enum/game/Game"), y = e("../../../Game/fromework/global/Tools"), g = e("../../../Game/fromework/mvvm/modelView/ViewModel"), v = e("../../../Game/fromework/helper/AudioHelper"), C = e("../../global/PopHelper"), b = e("../../../platform/Platform"), I = e("../../../Game/BundleManager"), E = function() {
function e(e) {
this._gameUI = null;
this._countDownKey = 5656156;
this._isShowResetCard = !1;
this._gameUI = e;
this.bindEvent();
}
Object.defineProperty(e.prototype, "roomID", {
get: function() {
return r.default.Instance.roomID;
},
enumerable: !1,
configurable: !0
});
Object.defineProperty(e.prototype, "isShowResetCard", {
get: function() {
return this._isShowResetCard;
},
enumerable: !1,
configurable: !0
});
e.prototype.bindEvent = function() {
d.default.Instance.Global.bind(p.GameEvent.S2C_ENTER_ROOM, this._onEnterRoom, this);
d.default.Instance.Global.bind(p.GameEvent.S2C_SWITCH_ROOM, this._onSwitchRoom, this);
d.default.Instance.Global.bind(p.GameEvent.S2C_CARD_SHOW, this._onCardShow, this);
d.default.Instance.Global.bind(p.GameEvent.S2C_CARD_CONFIRM, this._onCardConfirm, this);
d.default.Instance.Global.bind(p.GameEvent.S2C_START_ROOM, this._onStartRoom, this);
d.default.Instance.Global.bind(p.GameEvent.S2C_RESET, this._onReset, this);
d.default.Instance.Global.bind(p.GameEvent.S2C_LEAVE, this._onLeave, this);
d.default.Instance.Global.bind(p.GameEvent.S2C_LEAVE_SINGLE, this._onLeaveSingle, this);
d.default.Instance.Global.bind(p.GameEvent.S2C_DROP, this._onDrop, this);
d.default.Instance.Global.bind(p.GameEvent.S2C_DISMISS_ROOM, this._onDismiss, this);
d.default.Instance.Global.bind(p.GameEvent.S2C_SEE_CARD, this._onSeeCard, this);
d.default.Instance.Global.bind(p.GameEvent.S2C_WAGER, this._onWager, this);
d.default.Instance.Global.bind(p.GameEvent.S2C_INITIATE_COMPARE, this._onInitiateCompare, this);
d.default.Instance.Global.bind(p.GameEvent.S2C_CONFIRM_COMPARE, this._onConfirmCompare, this);
d.default.Instance.Global.bind(p.GameEvent.S2C_GET_RECHARGE_AMOUNT, this._onGetRechargeAmount, this);
d.default.Instance.Global.bind(p.GameEvent.S2C_INITIATE_RECHARGE, this._onInitRecharge, this);
d.default.Instance.Global.bind(p.GameEvent.S2C_FINISH_RECHARGE, this._onFinishRecharge, this);
d.default.Instance.Global.bind(p.GameEvent.S2C_SEND_AVAILABLE_BALANCE, this._onRefreshWallet, this);
d.default.Instance.Global.bind(p.GameEvent.TABLE_REFRESH_TABLE, this._onRefreshTable, this);
cc.game.on(cc.game.EVENT_SHOW, this._onRefreshTable, this);
d.default.Instance.Global.bind(p.ErrorCodeEvent.ERROR_EVENT_106, this._EnterRoomError, this);
d.default.Instance.Global.bind("ErrorCode13", this.onError13, this);
};
e.prototype.unbindEvent = function() {
d.default.Instance.Global.unbind(p.GameEvent.S2C_ENTER_ROOM, this._onEnterRoom, this);
d.default.Instance.Global.unbind(p.GameEvent.S2C_SWITCH_ROOM, this._onSwitchRoom, this);
d.default.Instance.Global.unbind(p.GameEvent.S2C_CARD_SHOW, this._onCardShow, this);
d.default.Instance.Global.unbind(p.GameEvent.S2C_CARD_CONFIRM, this._onCardConfirm, this);
d.default.Instance.Global.unbind(p.GameEvent.S2C_START_ROOM, this._onStartRoom, this);
d.default.Instance.Global.unbind(p.GameEvent.S2C_RESET, this._onReset, this);
d.default.Instance.Global.unbind(p.GameEvent.S2C_LEAVE, this._onLeave, this);
d.default.Instance.Global.unbind(p.GameEvent.S2C_LEAVE_SINGLE, this._onLeaveSingle, this);
d.default.Instance.Global.unbind(p.GameEvent.S2C_DROP, this._onDrop, this);
d.default.Instance.Global.unbind(p.GameEvent.S2C_DISMISS_ROOM, this._onDismiss, this);
d.default.Instance.Global.unbind(p.GameEvent.S2C_SEE_CARD, this._onSeeCard, this);
d.default.Instance.Global.unbind(p.GameEvent.S2C_WAGER, this._onWager, this);
d.default.Instance.Global.unbind(p.GameEvent.S2C_INITIATE_COMPARE, this._onInitiateCompare, this);
d.default.Instance.Global.unbind(p.GameEvent.S2C_CONFIRM_COMPARE, this._onConfirmCompare, this);
d.default.Instance.Global.unbind(p.GameEvent.S2C_GET_RECHARGE_AMOUNT, this._onGetRechargeAmount, this);
d.default.Instance.Global.unbind(p.GameEvent.S2C_INITIATE_RECHARGE, this._onInitRecharge, this);
d.default.Instance.Global.unbind(p.GameEvent.S2C_FINISH_RECHARGE, this._onFinishRecharge, this);
d.default.Instance.Global.unbind(p.GameEvent.S2C_SEND_AVAILABLE_BALANCE, this._onRefreshWallet, this);
d.default.Instance.Global.unbind(p.GameEvent.TABLE_REFRESH_TABLE, this._onRefreshTable, this);
cc.game.off(cc.game.EVENT_SHOW, this._onRefreshTable, this);
d.default.Instance.Global.unbind(p.ErrorCodeEvent.ERROR_EVENT_106, this._EnterRoomError, this);
d.default.Instance.Global.unbind("ErrorCode13", this.onError13, this);
};
e.prototype._EnterRoomError = function() {
var e = this, t = {
content: "I am very sorry, you have to leave the room because of the time limit",
rightTitle: a.default.getString("TABLE_BTN_YES"),
rightCallFunc: function() {
e.leaveRoom();
}
};
C.PopHelper.Instance.showAlert(t);
};
e.prototype.onError13 = function() {
var e, t = this, o = function() {
t.leaveRoom();
};
e = h.default.getInstance().isCashGame ? {
content: a.default.getString("COMMON_TIPS_CASH"),
leftTitle: a.default.getString("SIGN_BACK"),
leftCallFunc: o,
rightTitle: a.default.getString("COMMON_TIPS_BTN_ADDFUNDS"),
rightCallFunc: function() {
t.leaveRoom();
},
cancelCallFunc: o
} : {
content: a.default.getString("COMMON_TIPS_CASH"),
leftTitle: a.default.getString("SIGN_BACK"),
leftCallFunc: o,
cancelCallFunc: o
};
C.PopHelper.Instance.showAlert(e);
};
e.prototype._refreshRoomOpt = function() {
var e = this, t = r.TeenPattiModel.Instance, o = t.allUserData.getKickReason(g.VM.getValue("user.uid"));
if (0 != o) {
if (2 == o) {
r.default.Instance.isKickByMoney = !0;
i.default.Instance.kickRoomType = t.roomData.rtype;
this._gameUI.scheduleOnce(function() {
e._gameUI && e._gameUI.node && e._gameUI.node.isValid && e.leaveRoom();
}, 3);
return;
}
if (5 != o) {
if (6 == o) {
f.default.Instance.addBundleMaskLayer(_.BundleUIPath.ChairAlert, function(t) {
s.default.Instance.isOpenWithdraw = !0;
t.getComponent(c.default).showView(function() {
e.leaveRoom(!0);
});
}, C.PopZindex.Alert);
return;
}
this.leaveRoom();
return;
}
this._gameUI.scheduleOnce(function() {
if (e._gameUI && e._gameUI.node && e._gameUI.node.isValid) {
e._gameUI.resetAll();
C.PopHelper.Instance.closeCountdown(e._countDownKey);
i.default.Instance.sendJoinRoom(t.nextRoomType);
r.TeenPattiModel.clear();
}
}, 3);
}
if (t.optData.state == m.GameEnum.RoomState.ROOM_BASE_STATE_WAIT) {
C.PopHelper.Instance.closeCountdown(this._countDownKey);
var n = a.default.getString("TIPS_WAITING_DEALS");
C.PopHelper.Instance.showCountdown(n, -99, this._countDownKey, function() {}, this, this._gameUI.PopLayer, cc.v2(0, 0));
} else if (t.optData.state == m.GameEnum.RoomState.ROOM_BASE_STATE_MATCH) {
C.PopHelper.Instance.closeCountdown(this._countDownKey);
n = a.default.getString("END_WAIT1");
C.PopHelper.Instance.showCountdown(n, t.getCountDown(), this._countDownKey, function() {}, this, this._gameUI.PopLayer, cc.v2(0, 0));
} else C.PopHelper.Instance.closeCountdown(this._countDownKey);
var l = t.allUserData.getRechargeUser();
null != l ? this._gameUI.showRechargeTips(l, t.getCountDown()) : this._gameUI.hideRechargeTips();
this._gameUI.refreshHead();
this._gameUI.refreshButton();
this._gameUI.refreshWager();
this._gameUI.refreshRecharge();
};
e.prototype._reconnect = function() {
var e = r.TeenPattiModel.Instance, t = e.getPlayerData();
e.optData.state, m.GameEnum.RoomState.ROOM_BASE_STATE_WAIT;
e.optData.state, m.GameEnum.RoomState.ROOM_BASE_STATE_MATCH;
e.optData.state, m.GameEnum.RoomState.ROOM_BASE_STATE_SENDCARD;
if (e.optData.state == m.GameEnum.RoomState.ROOM_BASE_STATE_START || e.optData.state == m.GameEnum.RoomState.ROOM_BASE_STATE_DECLEAR || e.optData.state == m.GameEnum.RoomState.ROOM_BASE_STATE_COMPARE_CARD) {
var o = e.optData.order.indexOf(t.uid) >= 0;
this._gameUI.setCardBySeatIndex(0, o);
if (o) {
var n = t.res != m.GameEnum.UserResult.ROOM_USER_RESULT_PLAY;
this.isSeeCard() ? this._gameUI.setCardBlack(t.hand, t.hand_real_card, n) : this._gameUI.setCardBlack([], [], n);
}
}
this._gameUI.refreshBonus();
this._gameUI.refreshWallet();
this._gameUI.reconnectChip();
};
e.prototype._onEnterRoom = function(e) {
var t = r.TeenPattiModel.Instance, o = e.getUserData(), n = r.default.Instance.oldRoomType;
if ("" != n && n != t.roomData.rtype) {
var l = i.default.Instance.getGamePlay(t.roomData.rtype);
r.default.Instance.oldRoomType = "";
null != l && C.PopHelper.Instance.showTips(y.Tools.TStr.replaceAll(a.default.getString("COMMON_SWITCH_TIPS"), "%{cash}", l.base), null, cc.v2(0, -130));
}
if (o != g.VM.getValue("user.uid")) this._refreshRoomOpt(); else {
t.getPlayerData();
this._refreshRoomOpt();
this._reconnect();
}
this._gameUI.refreshTopInfo();
};
e.prototype._onSwitchRoom = function(e) {
var t = e.getUserData();
r.default.Instance.sendEnterRoom(t);
};
e.prototype._onCardShow = function() {
r.TeenPattiModel.Instance;
this._gameUI.resetAll();
C.PopHelper.Instance.closeAlert();
C.PopHelper.Instance.hideTableMenu();
this._isShowResetCard = !1;
this._refreshRoomOpt();
var e = this.getDealerSeatIndex();
this._gameUI.playDealerAnimation(e, function() {});
var t = 1.2 + .3 * 3 * e.length;
this._gameUI.scheduleOnce(function() {
r.default.Instance.sendCardConfirm();
}, t);
};
e.prototype._onCardConfirm = function() {
r.TeenPattiModel.Instance;
this._refreshRoomOpt();
};
e.prototype._onStartRoom = function() {
var e = r.TeenPattiModel.Instance;
this._gameUI.resetAllCardPos();
this._refreshRoomOpt();
e.checkOptUser() && e.optData.state == m.GameEnum.RoomState.ROOM_BASE_STATE_START && this._gameUI.playAudio(_.BundleSoundPath.rummy_own_round);
};
e.prototype._onReset = function() {
var e = this;
this._gameUI.scheduleOnce(function() {
if (e._gameUI && e._gameUI.node && e._gameUI.node.isValid) {
var t = r.TeenPattiModel.Instance;
e._refreshRoomOpt();
e._isShowResetCard = !0;
var o = [], n = [];
t.resetData.bonus.forEach(function(a, i) {
o.push(e.getSeatIndexByUid(i));
n.push(a);
var s;
if (null != (s = r.default.Instance.cls == m.GameEnum.PlayType.TP_3PATTI ? t.resetData.hand_card.get(i) : t.resetData.hand_real_card.get(i)) && 0 != s.length && i == g.VM.getValue("user.uid")) {
var c = l.TeenPattiCheckTools.checkCardType(s);
e._gameUI.showWinAnimation(c, 0);
}
});
e._gameUI.BonusLabel.string = "0";
e._gameUI.playWinAnimation(o, n);
e._gameUI.showHandCard(t.resetData.hand_card, t.resetData.hand_real_card);
1 == t.resetData.reset_type && e._gameUI.showPoolFull();
t.allUserData.kickList = {};
}
}, .8);
};
e.prototype._onLeave = function() {
var e = r.TeenPattiModel.Instance;
this._refreshRoomOpt();
e.checkOptUser() && e.optData.state == m.GameEnum.RoomState.ROOM_BASE_STATE_START && this._gameUI.playAudio(_.BundleSoundPath.rummy_own_round);
};
e.prototype._onLeaveSingle = function(e) {
var t = e.getUserData();
t && t.time_out && (r.default.Instance.lose_fee = t.lose_fee);
this.leaveRoom();
};
e.prototype._onDrop = function() {
r.TeenPattiModel.Instance;
this._refreshRoomOpt();
v.default.Instance.playBundleEffect("resources/sound/teenpatti/buttonSound/pack", !1, null, !1, !0);
C.PopHelper.Instance.hideWaiting(!0);
};
e.prototype._onDismiss = function(e) {
var t = this, o = r.TeenPattiModel.Instance;
if (4 == e.getUserData().state) {
r.default.Instance.isKickByMoney = !0;
i.default.Instance.kickRoomType = o.roomData.rtype;
this._gameUI.scheduleOnce(function() {
t.leaveRoom();
}, 3);
} else this.leaveRoom();
};
e.prototype._onSeeCard = function(e) {
var t = this, o = r.TeenPattiModel.Instance.getPlayerData(), n = e.getUserData();
this._refreshRoomOpt();
if (n.uid == g.VM.getValue("user.uid")) {
C.PopHelper.Instance.hideWaiting(!0);
this._gameUI.SeeButton.node.active = !1;
var a, i = o.hand;
a = r.default.Instance.cls == m.GameEnum.PlayType.TP_3PATTI ? o.hand : o.hand_real_card;
this._gameUI.playAudio(_.BundleSoundPath.tp_seen);
null != i && 0 != i.length && this._gameUI.playShowCardAction(i, a, function() {
if (null != a && 0 != a.length) {
var e = l.TeenPattiCheckTools.checkCardType(a);
t._gameUI.playSeeCardEffect(e);
}
});
}
};
e.prototype._onWager = function(e) {
var t = this, o = r.TeenPattiModel.Instance, n = e.getUserData(), a = o.allUserData.getUserData(n.uid), i = this.getSeatIndexByUid(n.uid), l = n.min_fee, s = a.fee;
this._refreshRoomOpt();
C.PopHelper.Instance.hideWaiting(!0);
var c = a.hand_real_card, u = this._gameUI.getSeenTagState(i) || c.length > 0;
if (o.checkOptUser() && o.optData.state == m.GameEnum.RoomState.ROOM_BASE_STATE_START) {
this._gameUI.playAudio(_.BundleSoundPath.rummy_own_round);
g.VM.getValue("lobbySet.isPlayVibration") && b.default.vibrator();
}
o.checkOptUser() ? this._gameUI.playWager(i, s, l, a.tp_state) : this._gameUI.scheduleOnce(function() {
t._gameUI.playWager(i, s, l, a.tp_state);
}, o.optData.sim_time);
s > l ? v.default.Instance.playBundleEffect("resources/sound/teenpatti/buttonSound/double", !1, null, !1, !0) : u ? v.default.Instance.playBundleEffect("resources/sound/teenpatti/buttonSound/chaal", !1, null, !1, !0) : v.default.Instance.playBundleEffect("resources/sound/teenpatti/buttonSound/blind", !1, null, !1, !0);
};
e.prototype._onInitiateCompare = function(e) {
var t = this, o = r.TeenPattiModel.Instance, n = e.getUserData(), a = this.getPlayingUserCount();
this._refreshRoomOpt();
C.PopHelper.Instance.hideWaiting(!0);
var i = n.uid, l = o.optData.order[o.optData.curr], s = this.getSeatIndexByUid(i), c = this.getSeatIndexByUid(l);
this._gameUI.playCompare(s, !0);
this._gameUI.showStateAction(s, "Show");
this._gameUI.playArrow(s, c, function() {
a <= 2 && t._gameUI.playVS(function() {
t._gameUI.playCompare(s, !1);
t._gameUI.playArrowFadeOut(function() {
t._gameUI.destroyArrow();
});
});
});
if (l == g.VM.getValue("user.uid")) if (a > 2) {
var u = o.allUserData.getUserData(i), d = o.allUserData.getUserData(l);
this._gameUI.showCompareAlert(o.getCountDown(), u, d);
v.default.Instance.playBundleEffect(_.BundleSoundPath.rummy_own_round);
g.VM.getValue("lobbySet.isPlayVibration") && b.default.vibrator();
} else this._gameUI.Bottom.active = !1;
var p = this.getPlayingUserCount();
this._gameUI.scheduleOnce(function() {
p > 2 ? v.default.Instance.playBundleEffect("resources/sound/teenpatti/buttonSound/side_show", !1, null, !1, !0) : v.default.Instance.playBundleEffect("resources/sound/teenpatti/buttonSound/show", !1, null, !1, !0);
}, .7);
};
e.prototype._onConfirmCompare = function(e) {
var t = this, o = (r.TeenPattiModel.Instance, e.getUserData()), n = o.res, a = o.active_uid, i = o.passive_uid, l = this.getSeatIndexByUid(a), s = this.getSeatIndexByUid(i);
if (n) this._gameUI.playVS(function() {
t._gameUI.playCompare(l, !0);
t._gameUI.playCompare(s, !0);
t._gameUI.playArrowFadeOut(function() {
t._gameUI.playCompare(l, !1);
t._gameUI.playCompare(s, !1);
t._gameUI.destroyArrow();
t._refreshRoomOpt();
});
}); else {
this._gameUI.playCompare(l, !1);
this._gameUI.playCompare(s, !1);
this._gameUI.showStateAction(s, "Reject");
this._gameUI.playArrowFadeOut(function() {
t._gameUI.destroyArrow();
t._refreshRoomOpt();
t._gameUI.showStateAction(s, "Reject");
});
}
};
e.prototype._onGetRechargeAmount = function(e) {
var t = e.getUserData().amount;
r.default.Instance.sendInitRecharge();
u.WalletProxy.Instance.sendPayment(t, 0, 0, 0, function(e) {
var t = JSON.parse(e.response);
n.default.Instance.onPayment(t);
});
};
e.prototype._onInitRecharge = function() {
this._refreshRoomOpt();
};
e.prototype._onFinishRecharge = function() {
this._refreshRoomOpt();
};
e.prototype._onRefreshTable = function() {
this._gameUI.resetAll();
this._gameUI.setRefreshCountDown();
r.default.Instance.sendEnterRoom(this.roomID);
};
e.prototype._onRefreshWallet = function() {
this._gameUI.refreshWallet();
};
e.prototype.leaveRoom = function(e) {
void 0 === e && (e = !1);
C.PopHelper.Instance.closeCountdown(this._countDownKey);
C.PopHelper.Instance.showWaiting(1);
g.VM.setValue("lobby.roomID", 0);
r.TeenPattiModel.clear();
C.PopHelper.Instance.hideWaiting();
I.default.getInstance().enterBundleScene(_.Scene.Lobby, function() {
e && n.default.Instance.openWithdraw();
});
b.default.setOrientation(_.Orientation.Landscape);
};
e.prototype.checkPacked = function() {
var e = r.TeenPattiModel.Instance, t = e.getPlayerData();
return !!e.checkOptUser() && (t.state == m.GameEnum.UserState.ROOM_USER_STATE_PLAY && t.res == m.GameEnum.UserResult.ROOM_USER_RESULT_PLAY);
};
e.prototype.checkShow = function() {
var e = r.TeenPattiModel.Instance, t = e.getPlayerData();
return !!e.checkOptUser() && (t.state == m.GameEnum.UserState.ROOM_USER_STATE_PLAY && t.res == m.GameEnum.UserResult.ROOM_USER_RESULT_PLAY && t.can_compare);
};
e.prototype.checkWager = function() {
var e = r.TeenPattiModel.Instance, t = e.getPlayerData();
return !!e.checkOptUser() && (t.state == m.GameEnum.UserState.ROOM_USER_STATE_PLAY && t.res == m.GameEnum.UserResult.ROOM_USER_RESULT_PLAY && (0 != t.min_fee || 0 != t.max_fee));
};
e.prototype.checkSeeCard = function() {
var e = r.TeenPattiModel.Instance, t = e.getPlayerData(), o = e.optData.state == m.GameEnum.RoomState.ROOM_BASE_STATE_START || e.optData.state == m.GameEnum.RoomState.ROOM_BASE_STATE_COMPARE_CARD || e.optData.state == m.GameEnum.RoomState.ROOM_BASE_STATE_RECHARGE, n = t.state == m.GameEnum.UserState.ROOM_USER_STATE_PLAY && t.res == m.GameEnum.UserResult.ROOM_USER_RESULT_PLAY, a = t.tp_state == m.GameEnum.TP_UserState.ROOM_USER_STATE_INIT || t.tp_state == m.GameEnum.TP_UserState.ROOM_USER_STATE_BLIND, i = 0 == t.hand.length;
return o && n && a && i;
};
e.prototype.isSeeCard = function() {
var e = r.TeenPattiModel.Instance.getPlayerData(), t = e.state == m.GameEnum.UserState.ROOM_USER_STATE_PLAY && e.res == m.GameEnum.UserResult.ROOM_USER_RESULT_PLAY, o = e.tp_state != m.GameEnum.TP_UserState.ROOM_USER_STATE_INIT && e.tp_state != m.GameEnum.TP_UserState.ROOM_USER_STATE_BLIND, n = e.hand.length > 0;
return t && o && n;
};
e.prototype.isCurrentSeeCard = function() {
var e = r.TeenPattiModel.Instance.getCurrentPlayerData(), t = e.state == m.GameEnum.UserState.ROOM_USER_STATE_PLAY && e.res == m.GameEnum.UserResult.ROOM_USER_RESULT_PLAY, o = e.tp_state != m.GameEnum.TP_UserState.ROOM_USER_STATE_INIT && e.tp_state != m.GameEnum.TP_UserState.ROOM_USER_STATE_BLIND;
return t && o;
};
e.prototype.getOrder = function() {
var e = r.TeenPattiModel.Instance.optData.join_order.concat(), t = g.VM.getValue("user.uid"), o = e.indexOf(t);
0 != o && (e = e.concat(e.splice(0, o)));
return e;
};
e.prototype.getDealerSeatIndex = function() {
var e = r.TeenPattiModel.Instance, t = this.getOrder(), o = [];
t.forEach(function(t, n) {
e.optData.order.indexOf(t) >= 0 && o.push(n);
});
return o;
};
e.prototype.getSeatIndexByUid = function(e) {
return this.getOrder().indexOf(e);
};
e.prototype.getDSeatUid = function() {
var e = r.TeenPattiModel.Instance;
return e.optData.order[e.optData.order.length - 1];
};
e.prototype.getOptUid = function() {
var e = r.TeenPattiModel.Instance;
return e.optData.order[e.optData.curr];
};
e.prototype.getPlayingUserCount = function() {
for (var e = r.TeenPattiModel.Instance, t = 0, o = e.optData.join_order.length - 1, n = 0; n <= o; n++) {
var a = e.optData.join_order[n];
if (0 != a) {
var i = e.allUserData.getUserData(a);
i && 1 == i.state && 0 == i.res && t++;
}
}
return t;
};
e.prototype.checkWild = function(e) {
return r.TeenPattiModel.Instance.roomData.xcard.indexOf(e) >= 0;
};
return e;
}();
o.default = E;
cc._RF.pop();
}, {
"../../../Game/BundleManager": "BundleManager",
"../../../Game/Script/global/GlobalValue": "GlobalValue",
"../../../Game/client/global/enum/game/Const": "Const",
"../../../Game/client/global/enum/game/Event": "Event",
"../../../Game/client/global/enum/game/Game": "Game",
"../../../Game/client/model/LanguageModel": "LanguageModel",
"../../../Game/fromework/global/Tools": "Tools",
"../../../Game/fromework/helper/AudioHelper": "AudioHelper",
"../../../Game/fromework/helper/EventHelper": "EventHelper",
"../../../Game/fromework/helper/UIHelper": "UIHelper",
"../../../Game/fromework/mvvm/modelView/ViewModel": "ViewModel",
"../../../platform/Platform": "Platform",
"../../global/PopHelper": "PopHelper",
"../../logic/Wallet/WalletHelper": "WalletHelper",
"../../logic/active/ActiveManager": "ActiveManager",
"../../logic/ui/ChairAlert/ChairAlert": "ChairAlert",
"../../model/LobbyModel": "LobbyModel",
"../../model/WalletModel": "WalletModel",
"./TeenPattiModel": "TeenPattiModel",
"./TeenPattiStruct": "TeenPattiStruct"
} ],
TeenPattiModel: [ function(e, t, o) {
"use strict";
cc._RF.push(t, "b6640hXA2hFLJ5HqftqMtCB", "TeenPattiModel");
Object.defineProperty(o, "__esModule", {
value: !0
});
o.TeenPattiModel = void 0;
var n = e("../../../Game/client/global/enum/game/Event"), a = e("../../../Game/client/global/enum/game/Game"), i = e("../../../Game/client/global/enum/net/C2S"), r = e("../../../Game/client/global/enum/net/S2C"), l = e("../../../Game/fromework/global/Tools"), s = e("../../../Game/fromework/helper/EventHelper"), c = e("../../../Game/fromework/mvvm/modelView/ViewModel"), u = e("../../../platform/Platform"), d = e("../../../fromework/helper/NetHelper"), p = e("../../logic/game/HearBeat"), h = e("../../model/WalletModel"), f = e("./TeenPattiStruct"), _ = function() {
function e() {
this.sTime = 0;
this.roomData = new f.TeenPattiStruct.RoomData();
this.allUserData = new f.TeenPattiStruct.AllUserData();
this.optData = new f.TeenPattiStruct.OptData();
this.resetData = new f.TeenPattiStruct.ResetData();
this.nextRoomType = "";
}
Object.defineProperty(e, "Instance", {
get: function() {
e._instance || (e._instance = new e());
return e._instance;
},
enumerable: !1,
configurable: !0
});
e.clear = function() {
null != e._instance && (e._instance = null);
};
e.prototype.getPlayerData = function() {
return this.allUserData.getUserData(c.VM.getValue("user.uid"));
};
e.prototype.getCurrentPlayerData = function() {
return this.allUserData.getUserData(this.optData.order[this.optData.curr]);
};
e.prototype.checkOptUser = function() {
return this.optData.order[this.optData.curr] == c.VM.getValue("user.uid");
};
e.prototype.getCountDown = function() {
u.default.log("倒计时：", this.optData.dl, this.sTime);
return Math.ceil(this.optData.dl - this.sTime);
};
e.prototype.checkWildCard = function(e) {
return -1 != this.roomData.xcard.indexOf(e);
};
e._instance = null;
return e;
}();
o.TeenPattiModel = _;
var m = function() {
function e() {
this._oldRoomType = "";
this.lose_fee = 0;
this.isKickByMoney = !1;
this._cls = a.GameEnum.PlayType.TP_3PATTI;
}
Object.defineProperty(e, "Instance", {
get: function() {
e._instance || (e._instance = new e());
return e._instance;
},
enumerable: !1,
configurable: !0
});
e.prototype.clear = function() {
this.destory();
};
Object.defineProperty(e.prototype, "oldRoomType", {
get: function() {
return this._oldRoomType;
},
set: function(e) {
this._oldRoomType = e;
},
enumerable: !1,
configurable: !0
});
e.prototype.Init = function() {
s.default.Instance.Net.bind(r.S2C.GAME.ROOM_ENTER_ROOM, this._onEnterRoom, this);
s.default.Instance.Net.bind(r.S2C.GAME.ROOM_SWITCH_ROOM, this._onSwitchRoom, this);
s.default.Instance.Net.bind(r.S2C.GAME.ROOM_CARD_SHOW, this._onCardShow, this);
s.default.Instance.Net.bind(r.S2C.GAME.ROOM_CARD_CONFIRM, this._onCardConfirm, this);
s.default.Instance.Net.bind(r.S2C.GAME.ROOM_START_ROOM, this._onStartRoom, this);
s.default.Instance.Net.bind(r.S2C.GAME.ROOM_RESET_ROOM, this._onResetRoom, this);
s.default.Instance.Net.bind(r.S2C.GAME.ROOM_LEAVE, this._onLeave, this);
s.default.Instance.Net.bind(r.S2C.GAME.ROOM_LEAVE_SINGLE, this._onLeaveSingle, this);
s.default.Instance.Net.bind(r.S2C.GAME.ROOM_DROP, this._onDrop, this);
s.default.Instance.Net.bind(r.S2C.GAME.ROOM_DISMISS, this._onDismiss, this);
s.default.Instance.Net.bind(r.S2C.GAME.ROOM_SEND_AVAILABLE_BALANCE, this._onBalanceRefresh, this);
s.default.Instance.Net.bind(r.S2C.GAME.ROOM_SEE_CARD, this._onSeeCard, this);
s.default.Instance.Net.bind(r.S2C.GAME.ROOM_WAGER, this._onWager, this);
s.default.Instance.Net.bind(r.S2C.GAME.ROOM_INITIATE_COMPARE, this._onInitiateCompare, this);
s.default.Instance.Net.bind(r.S2C.GAME.ROOM_CONFIRM_COMPARE, this._onConfirmCompare, this);
s.default.Instance.Net.bind(r.S2C.GAME.ROOM_GET_RECHARGE_AMOUNT, this._onGetRechargeAmount, this);
s.default.Instance.Net.bind(r.S2C.GAME.ROOM_INITIATE_RECHARGE, this._onInitRecharge, this);
s.default.Instance.Net.bind(r.S2C.GAME.ROOM_FINISH_RECHARGE, this._onFinishRecharge, this);
s.default.Instance.Global.bind(d.NetState.NET_WEBSOCKET_CONNECT_OPEN, this._onWsContented, this);
};
e.prototype.destory = function() {
s.default.Instance.Net.unbind(r.S2C.GAME.ROOM_ENTER_ROOM, this._onEnterRoom, this);
s.default.Instance.Net.unbind(r.S2C.GAME.ROOM_SWITCH_ROOM, this._onSwitchRoom, this);
s.default.Instance.Net.unbind(r.S2C.GAME.ROOM_CARD_SHOW, this._onCardShow, this);
s.default.Instance.Net.unbind(r.S2C.GAME.ROOM_CARD_CONFIRM, this._onCardConfirm, this);
s.default.Instance.Net.unbind(r.S2C.GAME.ROOM_START_ROOM, this._onStartRoom, this);
s.default.Instance.Net.unbind(r.S2C.GAME.ROOM_RESET_ROOM, this._onResetRoom, this);
s.default.Instance.Net.unbind(r.S2C.GAME.ROOM_LEAVE, this._onLeave, this);
s.default.Instance.Net.unbind(r.S2C.GAME.ROOM_LEAVE_SINGLE, this._onLeaveSingle, this);
s.default.Instance.Net.unbind(r.S2C.GAME.ROOM_DROP, this._onDrop, this);
s.default.Instance.Net.unbind(r.S2C.GAME.ROOM_DISMISS, this._onDismiss, this);
s.default.Instance.Net.unbind(r.S2C.GAME.ROOM_SEND_AVAILABLE_BALANCE, this._onBalanceRefresh, this);
s.default.Instance.Net.unbind(r.S2C.GAME.ROOM_SEE_CARD, this._onSeeCard, this);
s.default.Instance.Net.unbind(r.S2C.GAME.ROOM_WAGER, this._onWager, this);
s.default.Instance.Net.unbind(r.S2C.GAME.ROOM_INITIATE_COMPARE, this._onInitiateCompare, this);
s.default.Instance.Net.unbind(r.S2C.GAME.ROOM_CONFIRM_COMPARE, this._onConfirmCompare, this);
s.default.Instance.Net.unbind(r.S2C.GAME.ROOM_GET_RECHARGE_AMOUNT, this._onGetRechargeAmount, this);
s.default.Instance.Net.unbind(r.S2C.GAME.ROOM_INITIATE_RECHARGE, this._onInitRecharge, this);
s.default.Instance.Net.unbind(r.S2C.GAME.ROOM_FINISH_RECHARGE, this._onFinishRecharge, this);
s.default.Instance.Global.unbind(d.NetState.NET_WEBSOCKET_CONNECT_OPEN, this._onWsContented, this);
this._oldRoomType = "";
};
Object.defineProperty(e.prototype, "uid", {
get: function() {
return c.VM.getValue("user.uid");
},
enumerable: !1,
configurable: !0
});
Object.defineProperty(e.prototype, "token", {
get: function() {
return c.VM.getValue("user.token");
},
enumerable: !1,
configurable: !0
});
Object.defineProperty(e.prototype, "roomID", {
get: function() {
return c.VM.getValue("lobby.roomID");
},
enumerable: !1,
configurable: !0
});
Object.defineProperty(e.prototype, "cls", {
get: function() {
return this._cls;
},
set: function(e) {
this._cls = e;
},
enumerable: !1,
configurable: !0
});
e.prototype.checkRoomID = function(e) {
return c.VM.getValue("lobby.roomID") == e;
};
e.prototype.refreshWallet = function(e) {
if (e.currency_data) {
null != e.currency_data[a.GameEnum.MoneyType.CASH] && c.VM.setValue("wallet.total", e.currency_data[a.GameEnum.MoneyType.CASH]);
null != e.currency_data[a.GameEnum.MoneyType.PRACTICE] && c.VM.setValue("wallet.practice", e.currency_data[a.GameEnum.MoneyType.PRACTICE]);
null != e.currency_data[a.GameEnum.MoneyType.GOLD] && c.VM.setValue("wallet.gold", e.currency_data[a.GameEnum.MoneyType.GOLD]);
}
};
e.prototype._onWsContented = function() {
p.default.Instance.begin();
var e = c.VM.getValue("lobby.roomID");
0 != e && this.sendEnterRoom(e);
};
e.prototype._onEnterRoom = function(e) {
var t = e.getUserData();
if (this.checkRoomID(t.rid)) {
var o = _.Instance;
o.roomData.refresh(t.room_data);
o.optData.refresh(t.room_data);
o.sTime = t.stime;
o.allUserData.refresh(t.user_data);
this.refreshWallet(t);
s.default.Instance.Global.emit(n.GameEvent.S2C_ENTER_ROOM, t.uid);
}
};
e.prototype._onSwitchRoom = function(e) {
var t = e.getUserData();
c.VM.getValue("lobby.roomID") != t.r && c.VM.setValue("lobby.roomID", parseInt(t.r));
s.default.Instance.Global.emit(n.GameEvent.S2C_SWITCH_ROOM, t.r);
};
e.prototype._onCardShow = function(e) {
var t = e.getUserData();
if (this.checkRoomID(t.rid)) {
var o = _.Instance;
o.roomData.refresh(t.room_data);
o.optData.refresh(t.room_data);
o.allUserData.refresh(t.user_data);
s.default.Instance.Global.emit(n.GameEvent.S2C_CARD_SHOW);
}
};
e.prototype._onCardConfirm = function(e) {
var t = e.getUserData();
this.checkRoomID(t.rid) && s.default.Instance.Global.emit(n.GameEvent.S2C_CARD_CONFIRM);
};
e.prototype._onStartRoom = function(e) {
var t = e.getUserData();
if (this.checkRoomID(t.rid)) {
var o = _.Instance;
o.roomData.refresh(t.room_data);
o.optData.refresh(t.room_data);
o.sTime = t.stime;
o.allUserData.refresh(t.user_data);
s.default.Instance.Global.emit(n.GameEvent.S2C_START_ROOM);
}
};
e.prototype._onResetRoom = function(e) {
var t = e.getUserData();
if (this.checkRoomID(t.rid)) {
var o = _.Instance;
o.optData.refresh(t.opt_data);
o.sTime = t.stime;
o.allUserData.refresh(t.user_data);
o.allUserData.kickList = {};
o.allUserData.kickList = t.kick_data;
o.resetData.refresh(t);
if (5 == o.allUserData.getKickReason(this.uid)) {
this._oldRoomType = o.roomData.rtype;
o.nextRoomType = t.kick_switch_rtype;
}
this.refreshWallet(t);
s.default.Instance.Global.emit(n.GameEvent.S2C_RESET);
}
};
e.prototype._onLeave = function(e) {
var t = e.getUserData();
if (this.checkRoomID(t.rid)) {
var o = _.Instance;
o.optData.refresh(t.opt_data);
o.sTime = t.stime;
o.allUserData.refresh(t.user_data);
s.default.Instance.Global.emit(n.GameEvent.S2C_LEAVE);
}
};
e.prototype._onLeaveSingle = function(e) {
var t = e.getUserData();
if (this.checkRoomID(t.rid) || 0 == c.VM.getValue("lobby.roomID")) {
_.Instance.sTime = t.stime;
s.default.Instance.Global.emit(n.GameEvent.S2C_LEAVE_SINGLE, t);
}
};
e.prototype._onDrop = function(e) {
var t = e.getUserData();
if (this.checkRoomID(t.rid)) {
var o = _.Instance;
o.optData.refresh(t.opt_data);
o.sTime = t.stime;
o.allUserData.refresh(t.user_data);
this.refreshWallet(t);
s.default.Instance.Global.emit(n.GameEvent.S2C_DROP);
}
};
e.prototype._onDismiss = function(e) {
var t = e.getUserData();
this.checkRoomID(t.rid) && s.default.Instance.Global.emit(n.GameEvent.S2C_DISMISS_ROOM, {
state: t.state
});
};
e.prototype._onBalanceRefresh = function(e) {
var t = e.getUserData();
if (!this.checkRoomID(t.rid)) {
var o = _.Instance.getPlayerData();
o && (o.total_fee = l.Tools.TNumber.numFixed(l.Tools.TNumber.num2single(t.total_fee), 2));
h.WalletProxy.Instance.refreshWallet(t);
s.default.Instance.Global.emit(n.GameEvent.S2C_SEND_AVAILABLE_BALANCE);
}
};
e.prototype._onSeeCard = function(e) {
var t = e.getUserData();
if (this.checkRoomID(t.rid)) {
var o = _.Instance;
o.sTime = t.stime;
o.allUserData.refresh(t.user_data);
s.default.Instance.Global.emit(n.GameEvent.S2C_SEE_CARD, {
uid: t.uid
});
}
};
e.prototype._onWager = function(e) {
var t = e.getUserData();
if (this.checkRoomID(t.rid)) {
var o = _.Instance;
o.optData.refresh(t.opt_data);
o.sTime = t.stime;
o.allUserData.refresh(t.user_data);
s.default.Instance.Global.emit(n.GameEvent.S2C_WAGER, {
uid: t.uid,
min_fee: t.min_fee
});
}
};
e.prototype._onInitiateCompare = function(e) {
var t = e.getUserData();
if (this.checkRoomID(t.rid)) {
var o = _.Instance;
o.optData.refresh(t.opt_data);
o.sTime = t.stime;
o.allUserData.refresh(t.user_data);
s.default.Instance.Global.emit(n.GameEvent.S2C_INITIATE_COMPARE, {
uid: t.uid
});
}
};
e.prototype._onConfirmCompare = function(e) {
var t = e.getUserData();
if (this.checkRoomID(t.rid)) {
var o = _.Instance;
o.optData.refresh(t.opt_data);
o.sTime = t.stime;
o.allUserData.refresh(t.user_data);
s.default.Instance.Global.emit(n.GameEvent.S2C_CONFIRM_COMPARE, {
res: t.res,
active_uid: t.active_uid,
passive_uid: t.passive_uid
});
}
};
e.prototype._onGetRechargeAmount = function(e) {
var t = e.getUserData();
this.checkRoomID(t.rid) && s.default.Instance.Global.emit(n.GameEvent.S2C_GET_RECHARGE_AMOUNT, {
amount: t.amount
});
};
e.prototype._onInitRecharge = function(e) {
var t = e.getUserData();
if (this.checkRoomID(t.rid)) {
var o = _.Instance;
o.optData.refresh(t.opt_data);
o.sTime = t.stime;
o.allUserData.refresh(t.user_data);
s.default.Instance.Global.emit(n.GameEvent.S2C_INITIATE_RECHARGE);
}
};
e.prototype._onFinishRecharge = function(e) {
var t = e.getUserData();
if (this.checkRoomID(t.rid)) {
var o = _.Instance;
o.optData.refresh(t.opt_data);
o.sTime = t.stime;
o.allUserData.refresh(t.user_data);
s.default.Instance.Global.emit(n.GameEvent.S2C_FINISH_RECHARGE);
}
};
e.prototype.sendEnterRoom = function(e, t) {
void 0 === t && (t = !0);
var o = d.default.Instance.makeMsg(i.C2S.ROOM_ENTER_ROOM, {
u: this.uid,
t: this.token,
r: e,
is_open: t
});
d.default.Instance.send(o);
};
e.prototype.sendSwitchRoom = function(e) {
var t = cc.Vec2.ZERO, o = d.default.Instance.makeMsg(i.C2S.ROOM_SWITCH_ROOM, {
u: this.uid,
t: this.token,
r: this.roomID,
rtype: e,
lng: t.y,
lat: t.x
});
d.default.Instance.send(o);
};
e.prototype.sendCardConfirm = function() {
var e = d.default.Instance.makeMsg(i.C2S.ROOM_CARD_CONFIRM, {
u: this.uid,
t: this.token,
r: this.roomID
});
d.default.Instance.send(e);
};
e.prototype.sendLeave = function() {
var e = d.default.Instance.makeMsg(i.C2S.ROOM_LEAVE, {
u: this.uid,
t: this.token,
r: this.roomID
});
d.default.Instance.send(e);
};
e.prototype.sendDrop = function() {
var e = d.default.Instance.makeMsg(i.C2S.ROOM_DROP, {
u: this.uid,
t: this.token,
r: this.roomID
});
d.default.Instance.send(e);
};
e.prototype.sendSeeCard = function() {
var e = d.default.Instance.makeMsg(i.C2S.ROOM_SEE_CARD, {
u: this.uid,
t: this.token,
r: this.roomID
});
d.default.Instance.send(e);
};
e.prototype.sendWager = function(e) {
var t = d.default.Instance.makeMsg(i.C2S.ROOM_WAGER, {
u: this.uid,
t: this.token,
r: this.roomID,
fee: e
});
d.default.Instance.send(t);
};
e.prototype.sendInitiateCompare = function() {
var e = d.default.Instance.makeMsg(i.C2S.ROOM_INITIATE_COMPARE, {
u: this.uid,
t: this.token,
r: this.roomID
});
d.default.Instance.send(e);
};
e.prototype.sendConfirmCompare = function(e) {
var t = d.default.Instance.makeMsg(i.C2S.ROOM_CONFIRM_COMPARE, {
u: this.uid,
t: this.token,
r: this.roomID,
result: e
});
d.default.Instance.send(t);
};
e.prototype.sendGetRechargeAmount = function() {
var e = d.default.Instance.makeMsg(i.C2S.ROOM_GET_RECHARGE_AMOUNT, {
u: this.uid,
t: this.token,
r: this.roomID
});
d.default.Instance.send(e);
};
e.prototype.sendInitRecharge = function() {
var e = d.default.Instance.makeMsg(i.C2S.ROOM_INITIATE_RECHARGE, {
u: this.uid,
t: this.token,
r: this.roomID
});
d.default.Instance.send(e);
};
e.prototype.sendFinishRecharge = function() {
var e = d.default.Instance.makeMsg(i.C2S.ROOM_FINISH_RECHARGE, {
u: this.uid,
t: this.token,
r: this.roomID
});
d.default.Instance.send(e);
};
e._instance = null;
return e;
}();
o.default = m;
cc._RF.pop();
}, {
"../../../Game/client/global/enum/game/Event": "Event",
"../../../Game/client/global/enum/game/Game": "Game",
"../../../Game/client/global/enum/net/C2S": "C2S",
"../../../Game/client/global/enum/net/S2C": "S2C",
"../../../Game/fromework/global/Tools": "Tools",
"../../../Game/fromework/helper/EventHelper": "EventHelper",
"../../../Game/fromework/mvvm/modelView/ViewModel": "ViewModel",
"../../../fromework/helper/NetHelper": "NetHelper",
"../../../platform/Platform": "Platform",
"../../logic/game/HearBeat": "HearBeat",
"../../model/WalletModel": "WalletModel",
"./TeenPattiStruct": "TeenPattiStruct"
} ],
TeenPattiScene: [ function(e, t, o) {
"use strict";
cc._RF.push(t, "e97e9aa1BhFD6df3UFJLEgR", "TeenPattiScene");
var n, a = this && this.__extends || (n = function(e, t) {
return (n = Object.setPrototypeOf || {
__proto__: []
} instanceof Array && function(e, t) {
e.__proto__ = t;
} || function(e, t) {
for (var o in t) Object.prototype.hasOwnProperty.call(t, o) && (e[o] = t[o]);
})(e, t);
}, function(e, t) {
n(e, t);
function o() {
this.constructor = e;
}
e.prototype = null === t ? Object.create(t) : (o.prototype = t.prototype, new o());
}), i = this && this.__decorate || function(e, t, o, n) {
var a, i = arguments.length, r = i < 3 ? t : null === n ? n = Object.getOwnPropertyDescriptor(t, o) : n;
if ("object" == typeof Reflect && "function" == typeof Reflect.decorate) r = Reflect.decorate(e, t, o, n); else for (var l = e.length - 1; l >= 0; l--) (a = e[l]) && (r = (i < 3 ? a(r) : i > 3 ? a(t, o, r) : a(t, o)) || r);
return i > 3 && r && Object.defineProperty(t, o, r), r;
};
Object.defineProperty(o, "__esModule", {
value: !0
});
var r = e("../../global/PopHelper"), l = e("../../../Game/client/global/enum/game/Const"), s = e("../../../Game/client/global/enum/game/Event"), c = e("../../../Game/fromework/helper/AudioHelper"), u = e("../../../Game/fromework/helper/EventHelper"), d = e("../../../Game/fromework/helper/UIHelper"), p = e("../../../Game/fromework/mvvm/modelView/ViewModel"), h = e("../../component/NetworkDelay"), f = e("../../teenpatti/model/TeenPattiModel"), _ = e("../../teenpatti/ui/game/TeenPattiUI"), m = e("../game/HearBeat"), y = cc._decorator, g = y.ccclass, v = y.property, C = y.menu, b = function(e) {
a(t, e);
function t() {
var t = null !== e && e.apply(this, arguments) || this;
t.Background = null;
t.UILayer = null;
t.TopLayer = null;
t.TeenPattiGame = null;
t._teenPattiUI = null;
return t;
}
t.prototype.onEnable = function() {
u.default.Instance.Global.bind(s.LobbyEvent.LOBBY_JOIN, this._onJoin, this);
};
t.prototype.onDisable = function() {
u.default.Instance.Global.unbind(s.LobbyEvent.LOBBY_JOIN, this._onJoin, this);
};
t.prototype._initNetworkDelay = function() {
d.default.Instance.addBundleLayer(l.BundleUIPath.NetworkDelay, function(e) {
var t = e.getComponent(h.default);
t.init();
t.node.position = cc.v3(-190, 355, 0);
});
};
t.prototype._onJoin = function() {
var e = this, t = p.VM.getValue("lobby.roomID");
this._teenPattiUI && this._teenPattiUI.node && this._teenPattiUI.node.isValid || d.default.Instance.addBundleLayer("resources/prefab_tp/ui/game/TeenPattiGame", function(t) {
e._teenPattiUI = t.getComponent(_.default);
e._teenPattiUI.startGame();
});
f.default.Instance.sendEnterRoom(t);
};
t.prototype.onLoad = function() {
c.default.Instance.stopBGM();
c.default.Instance.playBGMBundle(l.BundleSoundPath.bgm_game);
r.PopHelper.Instance.addLotoFastMarquee(this.TopLayer);
m.default.Instance.intervalTime = 5e3;
};
t.prototype.onDestroy = function() {
f.default.Instance.destory();
};
t.prototype.start = function() {
d.default.Instance.setLayers(this.Background, this.UILayer, this.TopLayer);
this._initNetworkDelay();
f.default.Instance.Init();
this._onJoin();
};
i([ v(cc.Node) ], t.prototype, "Background", void 0);
i([ v(cc.Node) ], t.prototype, "UILayer", void 0);
i([ v(cc.Node) ], t.prototype, "TopLayer", void 0);
i([ v(cc.Prefab) ], t.prototype, "TeenPattiGame", void 0);
return i([ g, C("Scene/GameScene") ], t);
}(cc.Component);
o.default = b;
cc._RF.pop();
}, {
"../../../Game/client/global/enum/game/Const": "Const",
"../../../Game/client/global/enum/game/Event": "Event",
"../../../Game/fromework/helper/AudioHelper": "AudioHelper",
"../../../Game/fromework/helper/EventHelper": "EventHelper",
"../../../Game/fromework/helper/UIHelper": "UIHelper",
"../../../Game/fromework/mvvm/modelView/ViewModel": "ViewModel",
"../../component/NetworkDelay": "NetworkDelay",
"../../global/PopHelper": "PopHelper",
"../../teenpatti/model/TeenPattiModel": "TeenPattiModel",
"../../teenpatti/ui/game/TeenPattiUI": "TeenPattiUI",
"../game/HearBeat": "HearBeat"
} ],
TeenPattiStruct: [ function(e, t, o) {
"use strict";
cc._RF.push(t, "f6b5c2z7kZJgbFKYiiC+Qkt", "TeenPattiStruct");
Object.defineProperty(o, "__esModule", {
value: !0
});
o.TeenPattiCheckTools = o.TeenPattiCardType = o.TeenPattiStruct = void 0;
var n, a = e("../../../Game/client/global/enum/game/Game");
(function(e) {
var t = function() {
function e(e) {
this.rid = 0;
this.rtype = "";
this.curr = 0;
this.state = 0;
this.max = 0;
this.base = 0;
this.mcard = 0;
this.dl = 0;
this.order = [];
this.circle = 0;
this.bonus = 0;
this.join_order = [];
this.wager_history = {};
this.xcard = [];
e && this.refresh(e);
}
e.prototype.refresh = function(e) {
this.rid = e.rid;
this.rtype = e.rtype;
this.curr = e.curr;
this.state = e.state;
this.max = e.max;
this.base = e.base;
this.mcard = e.mcard;
this.dl = e.dl;
this.order = e.order;
this.circle = e.circle;
this.bonus = e.bonus;
this.join_order = e.join_order;
this.wager_history = e.wager_history ? e.wager_history : {};
this.xcard = e.xcard ? e.xcard : [];
};
return e;
}();
e.RoomData = t;
var o = function() {
function e(e) {
this.curr = 0;
this.state = 0;
this.dl = 0;
this.order = [];
this.circle = 0;
this.bonus = 0;
this.join_order = [];
this.sim_time = 0;
e && this.refresh(e);
}
e.prototype.refresh = function(e) {
this.curr = e.curr;
this.state = e.state;
this.dl = e.dl;
this.order = e.order;
this.circle = e.circle;
this.bonus = e.bonus;
this.join_order = e.join_order;
this.sim_time = e.sim_time;
};
return e;
}();
e.OptData = o;
var n = function() {
function e(e) {
this.uid = 0;
this.name = "";
this.head_url = "";
this.state = -1;
this.tp_state = 0;
this.res = 0;
this.total_fee = 0;
this.min_fee = 0;
this.max_fee = 0;
this.hand = [];
this.hand_real_card = [];
this.wager_fee = 0;
this.is_recharging = !1;
this.daily_recharge_max = 0;
this.daily_recharge_count = 0;
e && this.refresh(e);
}
e.prototype.refresh = function(e) {
this.uid = e.uid;
this.name = e.name;
this.head_url = e.head_url;
this.state = e.state;
this.tp_state = e.tp_state;
this.res = e.res;
this.can_compare = e.can_compare;
this.fee = e.fee;
this.total_fee = e.total_fee;
this.min_fee = e.min_fee;
this.max_fee = e.max_fee;
this.hand = e.hand ? e.hand : [];
this.hand_real_card = e.hand_real_card ? e.hand_real_card : [];
this.wager_fee = null != e.wager_fee ? e.wager_fee : 0;
this.is_recharging = null != e.is_recharging && e.is_recharging;
this.daily_recharge_max = null != e.daily_recharge_max ? e.daily_recharge_max : 0;
this.daily_recharge_count = null != e.daily_recharge_count ? e.daily_recharge_count : 0;
};
return e;
}();
e.UserData = n;
var a = function() {
function e(e) {
this._userMap = new Map();
this.kickList = {};
e && this.refresh(e);
}
Object.defineProperty(e.prototype, "userMap", {
get: function() {
return this._userMap;
},
enumerable: !1,
configurable: !0
});
e.prototype.refresh = function(e) {
var t = this, o = Object.keys(e);
this._userMap.forEach(function(e, n) {
o.indexOf(String(n)) < 0 && t._userMap.delete(n);
});
o.forEach(function(o) {
var a = new n(e[o]);
t._userMap.set(parseInt(o), a);
});
};
e.prototype.refreshOptUser = function(e) {
this._userMap.has(e.uid) && this._userMap.set(e.uid, e);
};
e.prototype.getKickReason = function(e) {
return null == this.kickList[e] ? 0 : this.kickList[e];
};
e.prototype.resetUserState = function() {
this._userMap.forEach(function(e) {
e.state = 1;
e.res = 0;
});
};
e.prototype.getUserData = function(e) {
return this._userMap.has(e) ? this._userMap.get(e) : null;
};
e.prototype.getRechargeUser = function() {
var e = null;
this._userMap.forEach(function(t) {
t.is_recharging && (e = t);
});
return e;
};
return e;
}();
e.AllUserData = a;
var i = function() {
function e(e) {
this.bonus = new Map();
this.hand_card = new Map();
this.hand_real_card = new Map();
this.reset_type = 0;
e && this.refresh(e);
}
e.prototype.refresh = function(e) {
var t = this;
this.bonus.clear();
this.hand_card.clear();
this.hand_real_card.clear();
Object.keys(e.bonus).forEach(function(o) {
t.bonus.set(parseInt(o), e.bonus[o]);
});
Object.keys(e.hand_card).forEach(function(o) {
t.hand_card.set(parseInt(o), e.hand_card[o]);
});
Object.keys(e.hand_real_card).forEach(function(o) {
t.hand_real_card.set(parseInt(o), e.hand_real_card[o]);
});
this.reset_type = e.reset_type;
};
return e;
}();
e.ResetData = i;
})(o.TeenPattiStruct || (o.TeenPattiStruct = {}));
(function(e) {
e[e.HighCard = 0] = "HighCard";
e[e.HighCardA = 1] = "HighCardA";
e[e.Pair = 2] = "Pair";
e[e.Color = 3] = "Color";
e[e.Sequence = 4] = "Sequence";
e[e.PureSequence = 5] = "PureSequence";
e[e.Trail = 6] = "Trail";
})(n = o.TeenPattiCardType || (o.TeenPattiCardType = {}));
(function() {
function e(e) {
return e % 16;
}
function t(e) {
var t = !1, o = !1, n = !1;
e.forEach(function(e) {
1 == e ? n = !0 : 12 == e ? t = !0 : 13 == e && (o = !0);
});
return t && o && n;
}
function i(e) {
return 1 == new Set(e).size;
}
function r(e) {
if (t(e)) return !0;
for (var o = !0, n = 0; n < e.length; n++) n != e.length - 1 && e[n] + 1 != e[n + 1] && (o = !1);
return o;
}
function l(e) {
return 1 == new Set(e).size;
}
function s(e) {
var t = e.length;
return new Set(e).size < t;
}
function c(e) {
var t = !1;
e.forEach(function(e) {
1 == e && (t = !0);
});
return t;
}
(o.TeenPattiCheckTools || (o.TeenPattiCheckTools = {})).checkCardType = function(t) {
var o = [], u = [];
t.forEach(function(t) {
o.push(65 == (n = t) ? a.GameEnum.Pattern.LittleJoker : 66 == n ? a.GameEnum.Pattern.BigJoker : Math.floor(n / 16));
var n;
u.push(e(t));
});
o.sort(function(e, t) {
return e - t;
});
u.sort(function(e, t) {
return e - t;
});
if (i(u)) return n.Trail;
var d = r(u), p = l(o);
return d && p ? n.PureSequence : d ? n.Sequence : p ? n.Color : s(u) ? n.Pair : c(u) ? n.HighCardA : n.HighCard;
};
})();
cc._RF.pop();
}, {
"../../../Game/client/global/enum/game/Game": "Game"
} ],
TeenPattiUI: [ function(e, t, o) {
"use strict";
cc._RF.push(t, "62ea5CdJcJBgqHUsJgtWqy2", "TeenPattiUI");
var n, a = this && this.__extends || (n = function(e, t) {
return (n = Object.setPrototypeOf || {
__proto__: []
} instanceof Array && function(e, t) {
e.__proto__ = t;
} || function(e, t) {
for (var o in t) Object.prototype.hasOwnProperty.call(t, o) && (e[o] = t[o]);
})(e, t);
}, function(e, t) {
n(e, t);
function o() {
this.constructor = e;
}
e.prototype = null === t ? Object.create(t) : (o.prototype = t.prototype, new o());
}), i = this && this.__decorate || function(e, t, o, n) {
var a, i = arguments.length, r = i < 3 ? t : null === n ? n = Object.getOwnPropertyDescriptor(t, o) : n;
if ("object" == typeof Reflect && "function" == typeof Reflect.decorate) r = Reflect.decorate(e, t, o, n); else for (var l = e.length - 1; l >= 0; l--) (a = e[l]) && (r = (i < 3 ? a(r) : i > 3 ? a(t, o, r) : a(t, o)) || r);
return i > 3 && r && Object.defineProperty(t, o, r), r;
};
Object.defineProperty(o, "__esModule", {
value: !0
});
var r = e("../../../component/Chip"), l = e("../../../logic/ui/settings/GameSetView"), s = e("../../../../Game/client/model/LanguageModel"), c = e("../../../model/UserModel"), u = e("../../component/Card_tp"), d = e("../../component/PlayerHead_tp"), p = e("../../component/TP_Effect_Follow"), h = e("../../component/TP_Eff_Win"), f = e("../../component/VSArrow"), _ = e("../../model/TeenPattiLogic"), m = e("../../model/TeenPattiModel"), y = e("../../model/TeenPattiStruct"), g = e("./CompateAlert"), v = e("../../../../Game/fromework/global/ResLoader"), C = e("../../../../Game/fromework/global/Tools"), b = e("../../../../Game/client/global/enum/game/Game"), I = e("../../../../Game/fromework/helper/EventHelper"), E = e("../../../../Game/client/global/enum/game/Event"), S = e("../../../../Game/fromework/mvvm/modelView/ViewModel"), T = e("../../../../Game/Script/global/GlobalValue"), R = e("../../../model/LobbyModel"), O = e("../../../../Game/client/global/enum/game/Const"), A = e("../../../../Game/fromework/helper/UIHelper"), P = e("../../../../Game/fromework/helper/AudioHelper"), M = e("../../../../Game/client/global/enum/game/UIUtils"), G = e("../../../global/PopHelper"), w = e("../../../../platform/Platform"), D = [ cc.v2(-40, -65), cc.v2(0, -60), cc.v2(40, -65) ], L = [ cc.v2(-15, 0), cc.v2(0, 3), cc.v2(15, 0) ], B = [ 15, 0, -15 ], N = [ .8, .3, .3, .3, .3 ], k = [ cc.v2(-150, -315), cc.v2(580, 0), cc.v2(345, 220), cc.v2(-345, 220), cc.v2(-580, 0) ], F = cc._decorator, H = F.ccclass, U = F.property, V = function(e) {
a(t, e);
function t() {
var t = null !== e && e.apply(this, arguments) || this;
t.Prefab_Card = null;
t.Prefab_Head = null;
t.Prefab_Chip = null;
t.Background_Sprite = null;
t.Table_Sprite = [];
t.Table_Font_Sprite = null;
t.Bonus_Sprite = null;
t.Bottom = null;
t.ChipLayer = null;
t.HeadLayer = null;
t.PopLayer = null;
t.Waitting = null;
t.CardParents = [];
t.Bonus = null;
t.Dealer = null;
t.RechargeButton = null;
t.RechargeButtonTips = null;
t.RefreshButton = null;
t.BackButton = null;
t.PackButton = null;
t.ShowButton = null;
t.WagerButton_B = null;
t.WagerButton_S = null;
t.SeeButton = null;
t.ExchangeButton = null;
t.RoomID = null;
t.BaseLabel = null;
t.BonusLabel = null;
t.WalletLabel = null;
t.userName = null;
t.GetMoney = null;
t.RechargeTips = null;
t.RechargeTitle = null;
t.RechargeTime = null;
t.SeeCardEffect = null;
t.exchangeTableButton = null;
t._logic = null;
t._userHeads = [];
t._compareArrow = null;
t._rechargeTimeID = -1;
t._firstSwitchTableShow = !1;
return t;
}
Object.defineProperty(t.prototype, "roomID", {
get: function() {
return m.default.Instance.roomID;
},
enumerable: !1,
configurable: !0
});
t.prototype.onEnable = function() {
I.default.Instance.Global.bind(E.GameEvent.TABLE_SWITCH_TABLE, this.switchTable, this);
I.default.Instance.Global.bind(E.GameEvent.S2C_SEE_CARD, this._onSeeCard, this);
};
t.prototype.onDisable = function() {
I.default.Instance.Global.unbind(E.GameEvent.TABLE_SWITCH_TABLE, this.switchTable, this);
I.default.Instance.Global.unbind(E.GameEvent.S2C_SEE_CARD, this._onSeeCard, this);
};
t.prototype.onLoad = function() {
var e = this;
v.default.Instance.loadBundleRes("resources/Texture/Teenpatti/tp_bg_" + m.default.Instance.cls, cc.SpriteFrame, function(t, o) {
t ? w.default.log("teenpatti load image error:" + t.message) : e.Background_Sprite && e.Background_Sprite.node && e.Background_Sprite.node.isValid && (e.Background_Sprite.spriteFrame = o);
});
v.default.Instance.loadBundleRes("resources/Texture/Teenpatti/tp_bg_bonus_" + m.default.Instance.cls, cc.SpriteFrame, function(t, o) {
t ? w.default.log("teenpatti load image error:" + t.message) : e.Bonus_Sprite && e.Bonus_Sprite.node && e.Bonus_Sprite.node.isValid && (e.Bonus_Sprite.spriteFrame = o);
});
v.default.Instance.loadBundleRes("resources/Texture/Teenpatti/tp_bg_table_" + m.default.Instance.cls, cc.SpriteFrame, function(t, o) {
t ? w.default.log("teenpatti load image error:" + t.message) : e.Table_Sprite.forEach(function(e) {
e && e.node && e.node.isValid && (e.spriteFrame = o);
});
});
v.default.Instance.loadBundleRes("resources/Texture/Teenpatti/tp_table_font_" + m.default.Instance.cls, cc.SpriteFrame, function(t, o) {
t ? w.default.log("teenpatti load image error:" + t.message) : e.Table_Font_Sprite && e.Table_Font_Sprite.node && e.Table_Font_Sprite.node.isValid && (e.Table_Font_Sprite.spriteFrame = o);
});
this.hideExchangeButton();
};
t.prototype.onDestroy = function() {
this.unscheduleAllCallbacks();
if (-1 != this._rechargeTimeID) {
clearInterval(this._rechargeTimeID);
this._rechargeTimeID = -1;
}
this._logic.unbindEvent();
};
t.prototype._onSeeCard = function(e) {
var t = m.TeenPattiModel.Instance, o = (t.getPlayerData(), e.getUserData());
if (!t.checkOptUser() && o.uid == S.VM.getValue("user.uid")) {
this.showExchangeButton();
this._firstSwitchTableShow = !0;
}
};
t.prototype.init = function() {
for (var e = 0; e < 5; e++) {
var t = cc.instantiate(this.Prefab_Head);
t.setPosition(k[e]);
t.parent = this.HeadLayer;
var o = t.getComponent(d.default);
0 == e ? o.isSelfHead = !0 : o.setIndex(e);
this._userHeads.push(o);
0 == e && (o.CardParent = this.CardParents[0]);
for (var n = 0; n < 3; n++) {
var a = cc.instantiate(this.Prefab_Card);
a.parent = o.CardParent;
a.active = !1;
a.name = "HandCard" + n;
a.setAnchorPoint(.5, 0);
a.setPosition(0 == e ? D[n] : L[n]);
a.scale = N[e];
a.getComponent(u.default).setEulerAngles(cc.v3(0, 0, B[n]));
a.zIndex = e + n;
}
}
};
t.prototype.getCardsByIndex = function(e) {
var t = this._userHeads[e].CardParent, o = [];
if (!t) return o;
for (var n = 0; n < 3; n++) {
var a = t.getChildByName("HandCard" + n);
a && o.push(a);
}
return o;
};
t.prototype.getSeenTagState = function(e) {
return this._userHeads[e].getSeenState();
};
t.prototype.getEffectWorldPos = function(e) {
var t = this._userHeads[e] ? this._userHeads[e].CardParent : null;
if (!t || !t.isValid) return cc.Vec2.ZERO;
var o = t.parent.convertToWorldSpaceAR(t.getPosition());
return 0 == e ? cc.v2(o.x, o.y + 148) : cc.v2(o.x, o.y - 70);
};
t.prototype.getChipPosition = function() {
var e = cc.v2(0, 20), t = cc.size(52, 49), o = 2 * Math.random() * Math.PI, n = C.Tools.TNumber.randomMinMax(0, Math.pow(500, 2)), a = Math.cos(o) * Math.pow(n, .47), i = Math.sin(o) * Math.pow(n, .4), r = cc.v2(a + e.x, i + e.y), l = this.Bonus.getBoundingBox();
l.x -= t.width / 2;
l.y -= t.height / 2;
l.width += t.width;
l.height += t.height;
if (l.contains(r)) {
a = r.x > this.Bonus.x ? this.Bonus.x + (this.Bonus.width / 2 + t.width) : this.Bonus.x - (this.Bonus.width / 2 + t.width);
i = (r.y, this.Bonus.y, this.Bonus.y - (this.Bonus.height / 2 + t.height));
r = cc.v2(a, i);
}
return cc.v3(r.x, r.y, 0);
};
t.prototype.startGame = function() {
this._logic = new _.default(this);
this.init();
};
t.prototype.closeGame = function() {
this._logic.unbindEvent();
G.PopHelper.Instance.closeCountdown(this._logic._countDownKey);
this.node.removeFromParent(!0);
this.node.destroy();
};
t.prototype.resetAll = function() {
var e = m.default.Instance.cls == b.GameEnum.PlayType.TP_JOKER;
this.BonusLabel.string = "";
this._userHeads.forEach(function(t, o) {
t.CardParent.children.forEach(function(t, n) {
t.active = !1;
t.setAnchorPoint(.5, 0);
t.setPosition(0 == o ? D[n] : L[n]);
t.scale = N[o];
var a = t.getComponent(u.default);
a.open = !1;
e && 2 == n && a.init(66, !0, !0);
a.setEulerAngles(cc.v3(0, 0, B[n]));
});
t.refresh();
t.setNormalCard();
t.WinNode.active = !1;
t.SeenNode.active = !1;
t.CompareNode.active = !1;
t.State.active = !1;
});
this.ChipLayer.destroyAllChildren();
this.BonusLabel.string = "0";
this.destroyArrow();
this.Dealer.active = !1;
if (-1 != this._rechargeTimeID) {
clearInterval(this._rechargeTimeID);
this._rechargeTimeID = -1;
}
I.default.Instance.Global.emit(E.TeenPattiEvent.TP_CLOSE_COMPATE);
this.hideExchangeButton();
};
t.prototype.resetAllCardPos = function() {
this._userHeads.forEach(function(e, t) {
e.CardParent.children.forEach(function(e, o) {
e.stopAllActions();
e.setPosition(0 == t ? D[o] : L[o]);
e.scale = N[t];
e.getComponent(u.default).setEulerAngles(cc.v3(0, 0, B[o]));
});
});
};
t.prototype.refreshHead = function() {
var e = this, t = m.TeenPattiModel.Instance, o = this._logic.getOrder(), n = this._logic.getDSeatUid(), a = this._logic.getOptUid(), i = S.VM.getValue("user.uid");
this._userHeads.forEach(function(r, l) {
var s, c, u, d, p = o[l];
if (0 == p) {
e.setCardBySeatIndex(l, !1);
r.refresh();
} else {
var h = t.allUserData.getUserData(p), f = (null === (s = t.optData) || void 0 === s ? void 0 : s.state) == b.GameEnum.RoomState.ROOM_BASE_STATE_START || (null === (c = t.optData) || void 0 === c ? void 0 : c.state) == b.GameEnum.RoomState.ROOM_BASE_STATE_COMPARE_CARD, _ = (null == h ? void 0 : h.state) == b.GameEnum.UserState.ROOM_USER_STATE_PLAY;
if (p == i) {
var m = f && _ || (null === (u = t.optData) || void 0 === u ? void 0 : u.state) == b.GameEnum.RoomState.ROOM_BASE_STATE_MATCH && h.hand.length > 0;
e.setCardBySeatIndex(l, m);
var y = h.res != b.GameEnum.UserResult.ROOM_USER_RESULT_PLAY;
h.hand.length > 0 ? e.setCardBlack(h.hand, h.hand_real_card, y) : e.setCardBlack([], [], y);
var g = (null == h ? void 0 : h.state) == b.GameEnum.UserState.ROOM_USER_STATE_WATCH;
e.Waitting.active = g;
e.userName.string = C.Tools.TStr.ellipsisString(h.name, 12);
} else if ((null === (d = t.optData) || void 0 === d ? void 0 : d.state) == b.GameEnum.RoomState.ROOM_BASE_STATE_MATCH) {
var v = e.getCardStateBySeatIndex(l);
e.setCardBySeatIndex(l, _ && e._logic.isShowResetCard && v);
} else e.setCardBySeatIndex(l, f && _);
r.refresh(h);
r.DSeat.active = n == p;
if (p == a) if (f && _) {
r.stopCountDown();
r.startCountDown(t.getCountDown());
} else r.stopCountDown(); else r.stopCountDown();
}
});
};
t.prototype.refreshButton = function() {
var e = m.TeenPattiModel.Instance, t = e.getPlayerData();
if (e.checkOptUser() && e.optData.state == b.GameEnum.RoomState.ROOM_BASE_STATE_START && t && 0 == t.res) {
this.Bottom.active = !0;
this._firstSwitchTableShow = !1;
this.PackButton.interactable = t.state == b.GameEnum.UserState.ROOM_USER_STATE_PLAY;
this.ShowButton.interactable = t.can_compare;
this.WagerButton_B.node.active = t.state == b.GameEnum.UserState.ROOM_USER_STATE_PLAY && t.max_fee != t.min_fee;
this.WagerButton_S.interactable = t.state == b.GameEnum.UserState.ROOM_USER_STATE_PLAY;
this.hideExchangeButton();
var o = cc.find("Background/Font_Show", this.ShowButton.node), n = cc.find("Background/Font_Side_Show", this.ShowButton.node), a = this._logic.getPlayingUserCount();
o.active = a <= 2;
n.active = a > 2;
} else {
this.Bottom.active = !1;
if (!this._firstSwitchTableShow) {
this.hideExchangeButton();
var i = 3 == t.state || 5 == e.optData.state && 0 != t.res;
e.optData.state == b.GameEnum.RoomState.ROOM_BASE_STATE_START && i && this.showExchangeButton();
}
}
this.SeeButton.node.active = this._logic.checkSeeCard();
this.BackButton.interactable = e.optData.state != b.GameEnum.RoomState.ROOM_BASE_STATE_COMPARE && e.optData.state != b.GameEnum.RoomState.ROOM_BASE_STATE_SENDCARD;
};
t.prototype.refreshBonus = function() {
var e = m.TeenPattiModel.Instance;
this.Bonus.active = !0;
this.BonusLabel.string = e.optData.bonus + "";
};
t.prototype.refreshWallet = function() {
var e = m.TeenPattiModel.Instance.getPlayerData(), t = T.default.getInstance().isCashGame ? s.default.getString("MoneySymbol") : "G";
this.WalletLabel.string = t + e.total_fee;
};
t.prototype.refreshRecharge = function() {
var e = m.TeenPattiModel.Instance.getPlayerData(), t = e.total_fee < 2 * e.min_fee;
cc.find("Back/MoneyTips", this.WalletLabel.node.parent).active = t;
this.WalletLabel.node.color = t ? cc.color(255, 211, 13) : cc.color(253, 217, 21);
var o = T.default.getInstance().isCashGame || c.default.checkOrganicSwitch(c.OrganicSwitch.ORGANIC_FUNC_SWITCH_RECHARGE);
this.RechargeButton.active = t && o;
t && o && (this.RechargeButtonTips.string = C.Tools.TStr.replaceString(s.default.getString("TP_RECHARGE_BUTTON_TIPS"), {
count: e.daily_recharge_count,
max: e.daily_recharge_max
}));
};
t.prototype.refreshWager = function() {
var e = m.TeenPattiModel.Instance.getPlayerData(), t = this._logic.isSeeCard(), o = cc.find("Background/Font_Blind", this.WagerButton_S.node), n = cc.find("Background/Font_Chaal", this.WagerButton_S.node), a = cc.find("Background/Number", this.WagerButton_S.node).getComponent(cc.Label);
o && (o.active = !t);
n && (n.active = t);
a && (a.string = s.default.getString("MoneySymbol") + e.min_fee);
var i = cc.find("Background/Font_Blind", this.WagerButton_B.node), r = cc.find("Background/Font_Chaal", this.WagerButton_B.node), l = cc.find("Background/Number", this.WagerButton_B.node).getComponent(cc.Label);
i && (i.active = !t);
r && (r.active = t);
l && (l.string = s.default.getString("MoneySymbol") + e.max_fee);
};
t.prototype.setCardBlack = function(e, t, o) {
var n = this, a = this.getCardsByIndex(0), i = m.default.Instance.cls == b.GameEnum.PlayType.TP_JOKER;
e.length > 0 ? a.forEach(function(a, i) {
var r = a.getComponent(u.default);
m.default.Instance.cls == b.GameEnum.PlayType.TP_3PATTI ? r.init(e[i], !0) : m.default.Instance.cls == b.GameEnum.PlayType.TP_JOKER ? r.init(t[i], !0, 2 == i) : m.default.Instance.cls == b.GameEnum.PlayType.TP_AK47 && r.init(t[i], !0, t[i] != e[i] || n._logic.checkWild(e[i]));
r.setBlackMask(o);
}) : a.forEach(function(e, t) {
var n = e.getComponent(u.default);
i && 2 == t ? n.init(66, !0, !0) : n.init(1, !1);
n.setBlackMask(o);
});
};
t.prototype.setCardBySeatIndex = function(e, t) {
var o = this._userHeads[e].CardParent;
o && o.children.forEach(function(e) {
e.active = t;
});
};
t.prototype.getCardStateBySeatIndex = function(e) {
var t = this._userHeads[e].CardParent;
if (t && t.children[0]) {
var o = t.children[0].getComponent(u.default);
if (o) return o.open;
}
return !1;
};
t.prototype.refreshTopInfo = function() {
var e = m.TeenPattiModel.Instance, t = R.default.Instance.getGamePlay(e.roomData.rtype), o = C.Tools.TNumber.numFixed(e.roomData.base, 2);
this.RoomID.string = "#" + e.roomData.rid;
this.BaseLabel.string = 1 == t.currency ? s.default.getString("COMMON_RUPEE") + o : o;
};
t.prototype.playDealerCard = function(e, t) {
var o = this, n = m.default.Instance.cls == b.GameEnum.PlayType.TP_JOKER;
this.Dealer.active = !0;
this.Dealer.opacity = 0;
this.Dealer.x = -50;
cc.tween(this.Dealer).to(.3, {
opacity: 255,
x: 0
}).call(function() {
for (var a = 0, i = function(i) {
for (var r = function(r) {
var l = e[r], s = o._userHeads[l].CardParent.getChildByName("HandCard" + i), c = s.getComponent(u.default);
if (!s) {
w.default.log("TeenPatti playDealerCard can not find card:" + r + "|" + i);
return "continue";
}
var d = o.Dealer.parent.convertToWorldSpaceAR(o.Dealer.getPosition()), p = s.parent.convertToNodeSpaceAR(d);
s.active = !1;
s.setPosition(p);
s.scale = .3;
s.eulerAngles = cc.Vec3.ZERO;
n && 2 == i ? c.init(66, !0, !0) : c.open = !1;
var h = 0 == l ? D[i] : L[i];
a += .1;
o.scheduleOnce(function() {
cc.tween(s).call(function() {
s.active = !0;
}).to(.2, {
position: cc.v3(h.x, h.y, 0),
scale: N[l],
eulerAngles: cc.v3(0, 0, B[i])
}).call(function() {
c.setEulerAngles(cc.v3(0, 0, B[i]));
o.playAudio(O.BundleSoundPath.common_discard);
2 == i && r == e.length - 1 && cc.tween(o.Dealer).to(.3, {
opacity: 0,
x: -50
}).call(function() {
o.Dealer.active = !1;
t && t();
}).start();
}).start();
}, a);
}, l = 0; l < e.length; l++) r(l);
}, r = 0; r < 3; r++) i(r);
}.bind(this)).start();
this.scheduleOnce(function() {
0 != o.Dealer.opacity && cc.tween(o.Dealer).to(.3, {
opacity: 0,
x: -50
}).call(function() {
o.Dealer.active = !1;
t && t();
}).start();
}, 3);
};
t.prototype.playDealerAnimation = function(e, t) {
for (var o = this, n = m.TeenPattiModel.Instance, a = function(a) {
var r = i._userHeads[e[a]];
r && r.node && r.node.isValid && i.playChip(e[a], n.roomData.base, function() {
if (a == e.length - 1) {
o.refreshBonus();
o.refreshWallet();
o.scheduleOnce(function() {
o.playDealerCard(e, function() {
t && t();
});
}, .5);
}
});
}, i = this, r = 0; r < e.length; r++) a(r);
};
t.prototype.playShowCardAction = function(e, t, o) {
var n = this, a = this.getCardsByIndex(0), i = m.default.Instance.cls == b.GameEnum.PlayType.TP_JOKER, r = m.default.Instance.cls == b.GameEnum.PlayType.TP_AK47;
a.forEach(function(o, a) {
var l = n._logic.checkWild(e[a]);
i && 2 == a ? o.getComponent(u.default).init(66, !0, !0) : r && e[a] != t[a] ? o.getComponent(u.default).init(e[a], !1, !0) : o.getComponent(u.default).init(e[a], !1, l);
o.active = !0;
});
var l = function(s) {
var c = s;
if (a[c]) {
var d = a[c].getComponent(u.default);
if (i && 2 == c) d.playJokerChange(t[c], function() {
c == a.length - 1 && o && o();
}); else if (r && e[c] != t[c]) {
var p = d.node.getRotation(new cc.Quat());
d.flipCard(.2, cc.v3(p.x, 180, p.z), !1, function() {
d.playJokerChange(t[c], function() {
c == a.length - 1 && o && o();
});
});
} else {
p = d.node.getRotation(new cc.Quat());
d.flipCard(.2, cc.v3(p.x, 180, p.z), !1, function() {
c == a.length - 1 && o && o();
});
}
n.scheduleOnce(function() {
n && n.node && n.node.isValid && l(++s);
}, .02);
}
};
l(0);
};
t.prototype.showCompareAlert = function(e, t, o) {
A.default.Instance.addBundleMaskLayer("resources/prefab_tp/ui/game/CompareAlert", function(n) {
n.getComponent(g.default).InitView(e, t, o, function(e) {
m.default.Instance.sendConfirmCompare(e);
});
}, 1);
};
t.prototype.reconnectChip = function() {
var e = this, t = m.TeenPattiModel.Instance;
this.ChipLayer.destroyAllChildren();
for (var o in t.roomData.wager_history) t.roomData.wager_history[o].forEach(function(t) {
r.default.division(t).forEach(function(t) {
var o = cc.instantiate(e.Prefab_Chip);
o.parent = e.ChipLayer;
o.setPosition(e.getChipPosition());
var n = o.getComponent(r.default), a = n.getTargetScale(o.position);
o.scale = a.scale;
o.eulerAngles = cc.v3(a.angle, 0, 0);
n.init(t);
});
});
};
t.prototype.playChip = function(e, t, o) {
var n = this, a = this._userHeads[e];
if (a && a.node && a.isValid) {
this.playAudio(O.BundleSoundPath.common_chip);
var i = r.default.division(t);
i.forEach(function(e, t) {
var l = cc.instantiate(n.Prefab_Chip);
l.parent = n.ChipLayer;
l.setPosition(a.node.getPosition());
var s = n.getChipPosition(), c = l.getComponent(r.default);
c.init(e);
c.throw(s, function() {
t == i.length - 1 && o && o();
});
});
}
};
t.prototype.playWager = function(e, t, o, n) {
var a = this, i = this._userHeads[e];
if (i && i.node && i.isValid) {
this.refreshBonus();
this.refreshWallet();
this.playChip(e, t, function() {});
t > o && A.default.Instance.addBundleMaskLayer("resources/prefab_tp/effect/TP_Eff_Follow", function(t) {
var o = t.getComponent(p.default), i = a.getEffectWorldPos(e);
o.setAnimationPos(t.parent.convertToNodeSpaceAR(i));
o.showWagerAnimation(n == b.GameEnum.TP_UserState.ROOM_USER_STATE_BLIND);
}, 0);
}
};
t.prototype.playCompare = function(e, t) {
var o = this._userHeads[e];
o && o.node && o.isValid && o.setCompareEffect(t);
};
t.prototype.playGetMoney = function(e, t) {
var o = this;
this.GetMoney.string = "+" + s.default.getString("MoneySymbol") + e;
this.GetMoney.node.setPosition(0, 0);
this.GetMoney.node.opacity = 0;
this.GetMoney.node.active = !0;
cc.Tween.stopAllByTarget(this.GetMoney.node);
cc.tween(this.GetMoney.node).by(.8, {
y: 150,
opacity: 255
}).delay(1).call(function() {
o.GetMoney.node.active = !1;
t && t();
}).start();
};
t.prototype.playWinAnimation = function(e, t) {
this.playAudio(O.BundleSoundPath.common_chip_collect);
for (var o = C.Tools.TArray.division(this.ChipLayer.children, e.length), n = function(t) {
var n = o[t];
if (null == e[t] || null == a._userHeads[e[t]] || !a._userHeads[e[t]].node || !a._userHeads[e[t]].node.isValid) return "continue";
var i = a._userHeads[e[t]].node.position;
n.forEach(function(e) {
e && e.isValid && e.getComponent(r.default).throw(i, function() {
if (e && e.isValid) {
e.removeFromParent(!0);
e.destroy();
}
});
});
}, a = this, i = 0; i < o.length; i++) n(i);
for (i = 0; i < e.length; i++) {
var l = this._userHeads[e[i]], s = null != t[i] ? t[i] : 0;
if (l && l.isSelfHead) {
this.playGetMoney(s);
this.refreshWallet();
}
l && l.node && l.node.isValid && l.playWinAnimation();
}
};
t.prototype.showHandCard = function(e, t) {
var o = this;
e.forEach(function(e, n) {
var a = t.get(n), i = o._logic.getSeatIndexByUid(n), r = o._userHeads[i];
if (r && r.node && r.node.isValid) {
r.SeenNode.active = !1;
!r.isSelfHead && r.setResultCard();
r.CardParent && r.CardParent.children.forEach(function(t, n) {
t.active = !0;
var i = t.getComponent(u.default);
m.default.Instance.cls == b.GameEnum.PlayType.TP_3PATTI ? i.init(e[n], !0) : m.default.Instance.cls == b.GameEnum.PlayType.TP_JOKER ? i.init(a[n], !0, 2 == n) : m.default.Instance.cls == b.GameEnum.PlayType.TP_AK47 && i.init(a[n], !0, a[n] != e[n] || o._logic.checkWild(e[n]));
});
}
});
};
t.prototype.playAudio = function(e) {
this.scheduleOnce(function() {
P.default.Instance.playBundleEffect(e);
});
};
t.prototype.showStateAction = function(e, t) {
var o = this._userHeads[e];
o && o.node && o.isValid && o.showStateAction(t);
};
t.prototype.playArrow = function(e, t, o) {
var n = this, a = k[e], i = k[t];
v.default.Instance.loadBundleRes("resources/prefab_tp/component/Compare", cc.Prefab, function(e, t) {
if (e) w.default.error(e); else {
null != n._compareArrow && n.destroyArrow();
n.playAudio(O.BundleSoundPath.tp_compare);
n._compareArrow = cc.instantiate(t);
n._compareArrow.parent = n.HeadLayer;
n._compareArrow.zIndex = -99;
n._compareArrow.getComponent(f.default).pointTo(a, i, function() {
o && o();
});
}
});
};
t.prototype.playVS = function(e) {
if (this._compareArrow && this._compareArrow.isValid) {
var t = this._compareArrow.getComponent(f.default);
this.playAudio(O.BundleSoundPath.tp_vs);
t.showVS(function() {
e && e();
});
}
};
t.prototype.playArrowFadeOut = function(e) {
this._compareArrow && this._compareArrow.isValid && this._compareArrow.getComponent(f.default).fadeOut(function() {
e && e();
});
};
t.prototype.destroyArrow = function() {
if (this._compareArrow && this._compareArrow.isValid) {
this._compareArrow.removeFromParent(!0);
this._compareArrow.destroy();
this._compareArrow = null;
}
};
t.prototype.showPoolFull = function() {
var e = this;
A.default.Instance.addBundleMaskLayer("resources/prefab_tp/effect/TP_Eff_Full", function(t) {
t.zIndex = 79;
var o = e.Bonus.parent.convertToWorldSpaceAR(e.Bonus.getPosition());
t.setPosition(t.parent.convertToNodeSpaceAR(o));
e.scheduleOnce(function() {
if (t && t.isValid) {
t.removeFromParent(!0);
t.destroy();
}
}, 1);
});
};
t.prototype.playSeeCardEffect = function(e, t) {
var o, n = this;
"" != (o = e == y.TeenPattiCardType.HighCard || e == y.TeenPattiCardType.HighCardA ? "resources/prefab_tp/effect/TP_See_0" : "resources/prefab_tp/effect/TP_See_" + e) && v.default.Instance.loadBundleRes(o, cc.Prefab, function(e, o) {
if (e) w.default.log("Load See Card Effect Prefab Error:" + e.message); else {
var a = cc.instantiate(o);
a.parent = n.SeeCardEffect;
a.position = cc.Vec3.ZERO;
var i = a.getComponent(dragonBones.ArmatureDisplay);
i.armatureName = "Armature";
i.once(dragonBones.EventObject.COMPLETE, function() {
t && t();
n && n.node && n.node.isValid && n.SeeCardEffect.destroyAllChildren();
}, n);
i.playAnimation("seecard", 1);
}
});
};
t.prototype.showWinAnimation = function(e, t) {
var o = this, n = "resources/prefab_tp/effect/TP_Eff_Follow";
(0 == t && e == y.TeenPattiCardType.Trail || e == y.TeenPattiCardType.PureSequence) && (n = "resources/prefab_tp/effect/TP_Eff_Win");
A.default.Instance.addBundleMaskLayer(n, function(n) {
if (0 == t && e == y.TeenPattiCardType.Trail || e == y.TeenPattiCardType.PureSequence) {
n.zIndex = 99;
(a = n.getComponent(h.default)).play(e);
} else {
n.zIndex = 89;
var a = n.getComponent(p.default), i = o.getEffectWorldPos(t);
a.setAnimationPos(n.parent.convertToNodeSpaceAR(i));
a.showCardTypeAnimation(e);
}
}, 0);
};
t.prototype.setRefreshCountDown = function() {
var e = this.RefreshButton.node.getChildByName("Time").getComponent(cc.Label);
M.UIUtils.disableButton(3, this.RefreshButton, e);
};
t.prototype.showRechargeTips = function(e, t) {
var o = this;
this.RechargeTips.active = !0;
this.RechargeTitle.string = "<color=#ffe611>" + e.name + "</c> is recharging, please wait for him";
var n = t;
this.RechargeTime.string = n.toString();
if (-1 != this._rechargeTimeID) {
clearInterval(this._rechargeTimeID);
this._rechargeTimeID = -1;
}
this._rechargeTimeID = setInterval(function() {
n--;
o && o.node && o.node.isValid && (o.RechargeTime.string = n.toString());
}, 1e3);
};
t.prototype.hideRechargeTips = function() {
this.RechargeTips.active = !1;
if (-1 != this._rechargeTimeID) {
clearInterval(this._rechargeTimeID);
this._rechargeTimeID = -1;
}
};
t.prototype.onPackedClicked = function() {
if (this._logic.checkPacked()) {
P.default.Instance.playBundleEffect(O.BundleSoundPath.tp_pack);
P.default.Instance.playBundleEffect("resources/sound/teenpatti/buttonSound/pack", !1, null, !1, !0);
m.default.Instance.sendDrop();
var e = this.PackButton.node.parent.convertToWorldSpaceAR(this.PackButton.node.position);
G.PopHelper.Instance.showWaiting(.4, cc.v2(e.x, e.y), .7);
}
};
t.prototype.showExchangeButton = function() {
this.exchangeTableButton.node.active = !0;
};
t.prototype.hideExchangeButton = function() {
this.exchangeTableButton.node.active = !1;
};
t.prototype.onExchangeTableClicked = function() {
this.switchTableConfirm(null, !0);
this.hideExchangeButton();
};
t.prototype.onShowClicked = function() {
var e = m.TeenPattiModel.Instance.getPlayerData();
if (this._logic.checkShow()) if (e.total_fee >= e.min_fee) {
P.default.Instance.playBundleEffect(O.BundleSoundPath.tp_pack);
m.default.Instance.sendInitiateCompare();
var t = this.ShowButton.node.parent.convertToWorldSpaceAR(this.ShowButton.node.position);
G.PopHelper.Instance.showWaiting(.4, cc.v2(t.x, t.y), .7);
} else this.onRechargeClicked();
};
t.prototype.onWagerSmallClicked = function() {
var e = m.TeenPattiModel.Instance.getPlayerData();
if (this._logic.checkWager()) {
var t = e.min_fee;
if (e.total_fee >= t) {
m.default.Instance.sendWager(t);
var o = this.WagerButton_S.node.parent.convertToWorldSpaceAR(this.WagerButton_S.node.position);
G.PopHelper.Instance.showWaiting(.4, cc.v2(o.x, o.y));
} else this.onRechargeClicked();
}
};
t.prototype.onWagerBigClicked = function() {
var e = m.TeenPattiModel.Instance.getPlayerData();
if (this._logic.checkWager()) {
var t = e.max_fee;
if (e.total_fee >= t) {
m.default.Instance.sendWager(t);
var o = this.WagerButton_B.node.parent.convertToWorldSpaceAR(this.WagerButton_B.node.position);
G.PopHelper.Instance.showWaiting(.4, cc.v2(o.x, o.y));
} else this.onRechargeClicked();
}
};
t.prototype.onSeeButtonClicked = function() {
if (this._logic.checkSeeCard()) {
m.default.Instance.sendSeeCard();
var e = this.SeeButton.node.parent.convertToWorldSpaceAR(this.SeeButton.node.position);
G.PopHelper.Instance.showWaiting(.4, cc.v2(e.x, e.y), .5);
}
};
t.prototype.leaveRoomConfirm = function() {
var e = m.TeenPattiModel.Instance.getPlayerData();
if (e && 0 == e.res && 1 == e.state && 0 != e.wager_fee) {
var t = {
content: C.Tools.TStr.replaceAll(s.default.getString("TIPS_LEAVE_TABLE"), "%{num}", e.wager_fee),
leftTitle: s.default.getString("TABLE_BTN_NO"),
rightTitle: s.default.getString("TABLE_BTN_YES"),
rightCallFunc: function() {
m.default.Instance.sendLeave();
},
target: this
};
G.PopHelper.Instance.showAlert(t, this.PopLayer);
} else m.default.Instance.sendLeave();
};
t.prototype.switchTableConfirm = function(e, t) {
var o = this;
void 0 === t && (t = !0);
var n = m.TeenPattiModel.Instance, a = R.default.Instance.getGamePlay(n.roomData.rtype), i = n.getPlayerData(), r = i && 0 == i.state, l = 0 == n.optData.state || 1 == n.optData.state || 2 == n.optData.state, c = 3 == i.state || 5 == n.optData.state && 0 != i.res;
if (r || l || c) this.switchTable(); else if (t) {
var u = {
content: a.currency == b.GameEnum.MoneyType.CASH || a.currency == b.GameEnum.MoneyType.GOLD ? C.Tools.TStr.replaceAll(s.default.getString("TIPS_LEAVE_TABLE"), "%{num}", i.wager_fee) : s.default.getString("TIPS_SWITCH_TABLE"),
leftTitle: s.default.getString("TABLE_BTN_NO"),
leftCallFunc: e,
rightTitle: s.default.getString("TABLE_BTN_YES"),
rightCallFunc: function() {
o.switchTable();
},
cancelCallFunc: e,
target: this
};
G.PopHelper.Instance.showAlert(u, this.PopLayer);
} else this.switchTable();
};
t.prototype.switchTable = function() {
var e = m.TeenPattiModel.Instance;
G.PopHelper.Instance.closeCountdown(this._logic._countDownKey);
m.default.Instance.sendSwitchRoom(e.roomData.rtype);
};
t.prototype.onLeaveClicked = function() {
var e = {
leaveCallFunc: this.leaveRoomConfirm,
switchCallFunc: this.switchTableConfirm,
playType: m.default.Instance.cls,
target: this
};
G.PopHelper.Instance.showTableMenu(e, this.PopLayer);
};
t.prototype.onRefreshClicked = function() {
this._logic._onRefreshTable();
};
t.prototype.onRechargeClicked = function() {
(T.default.getInstance().isCashGame || c.default.checkOrganicSwitch(c.OrganicSwitch.ORGANIC_FUNC_SWITCH_RECHARGE)) && m.default.Instance.sendGetRechargeAmount();
};
t.prototype.onHelpClicked = function() {
var e = m.default.Instance.cls;
e == b.GameEnum.PlayType.TP_3PATTI ? A.default.Instance.addBundleMaskLayer("resources/prefab_tp/ui/game/HelpView_5", null, 99) : e == b.GameEnum.PlayType.TP_AK47 ? A.default.Instance.addBundleMaskLayer("resources/prefab_tp/ui/game/HelpView_6", null, 99) : e == b.GameEnum.PlayType.TP_JOKER && A.default.Instance.addBundleMaskLayer("resources/prefab_tp/ui/game/HelpView_7", null, 99);
};
t.prototype.onSettingClicked = function() {
A.default.Instance.addBundleMaskLayer(O.BundleUIPath.GameSetView, function(e) {
e.getComponent(l.default).InitView();
});
};
t.prototype.onMoneyTipsClicked = function() {
var e = cc.find("Back/MoneyTips", this.WalletLabel.node.parent);
e && e.active && G.PopHelper.Instance.showTips(s.default.getString("TP_MONEY_TIPS"), null, cc.v2(0, -130));
};
i([ U(cc.Prefab) ], t.prototype, "Prefab_Card", void 0);
i([ U(cc.Prefab) ], t.prototype, "Prefab_Head", void 0);
i([ U(cc.Prefab) ], t.prototype, "Prefab_Chip", void 0);
i([ U(cc.Sprite) ], t.prototype, "Background_Sprite", void 0);
i([ U([ cc.Sprite ]) ], t.prototype, "Table_Sprite", void 0);
i([ U(cc.Sprite) ], t.prototype, "Table_Font_Sprite", void 0);
i([ U(cc.Sprite) ], t.prototype, "Bonus_Sprite", void 0);
i([ U(cc.Node) ], t.prototype, "Bottom", void 0);
i([ U(cc.Node) ], t.prototype, "ChipLayer", void 0);
i([ U(cc.Node) ], t.prototype, "HeadLayer", void 0);
i([ U(cc.Node) ], t.prototype, "PopLayer", void 0);
i([ U(cc.Node) ], t.prototype, "Waitting", void 0);
i([ U([ cc.Node ]) ], t.prototype, "CardParents", void 0);
i([ U(cc.Node) ], t.prototype, "Bonus", void 0);
i([ U(cc.Node) ], t.prototype, "Dealer", void 0);
i([ U(cc.Node) ], t.prototype, "RechargeButton", void 0);
i([ U(cc.Label) ], t.prototype, "RechargeButtonTips", void 0);
i([ U(cc.Button) ], t.prototype, "RefreshButton", void 0);
i([ U(cc.Button) ], t.prototype, "BackButton", void 0);
i([ U(cc.Button) ], t.prototype, "PackButton", void 0);
i([ U(cc.Button) ], t.prototype, "ShowButton", void 0);
i([ U(cc.Button) ], t.prototype, "WagerButton_B", void 0);
i([ U(cc.Button) ], t.prototype, "WagerButton_S", void 0);
i([ U(cc.Button) ], t.prototype, "SeeButton", void 0);
i([ U(cc.Button) ], t.prototype, "ExchangeButton", void 0);
i([ U(cc.Label) ], t.prototype, "RoomID", void 0);
i([ U(cc.Label) ], t.prototype, "BaseLabel", void 0);
i([ U(cc.Label) ], t.prototype, "BonusLabel", void 0);
i([ U(cc.Label) ], t.prototype, "WalletLabel", void 0);
i([ U(cc.Label) ], t.prototype, "userName", void 0);
i([ U(cc.Label) ], t.prototype, "GetMoney", void 0);
i([ U(cc.Node) ], t.prototype, "RechargeTips", void 0);
i([ U(cc.RichText) ], t.prototype, "RechargeTitle", void 0);
i([ U(cc.Label) ], t.prototype, "RechargeTime", void 0);
i([ U(cc.Node) ], t.prototype, "SeeCardEffect", void 0);
i([ U(cc.Button) ], t.prototype, "exchangeTableButton", void 0);
return i([ H ], t);
}(cc.Component);
o.default = V;
cc._RF.pop();
}, {
"../../../../Game/Script/global/GlobalValue": "GlobalValue",
"../../../../Game/client/global/enum/game/Const": "Const",
"../../../../Game/client/global/enum/game/Event": "Event",
"../../../../Game/client/global/enum/game/Game": "Game",
"../../../../Game/client/global/enum/game/UIUtils": "UIUtils",
"../../../../Game/client/model/LanguageModel": "LanguageModel",
"../../../../Game/fromework/global/ResLoader": "ResLoader",
"../../../../Game/fromework/global/Tools": "Tools",
"../../../../Game/fromework/helper/AudioHelper": "AudioHelper",
"../../../../Game/fromework/helper/EventHelper": "EventHelper",
"../../../../Game/fromework/helper/UIHelper": "UIHelper",
"../../../../Game/fromework/mvvm/modelView/ViewModel": "ViewModel",
"../../../../platform/Platform": "Platform",
"../../../component/Chip": "Chip",
"../../../global/PopHelper": "PopHelper",
"../../../logic/ui/settings/GameSetView": "GameSetView",
"../../../model/LobbyModel": "LobbyModel",
"../../../model/UserModel": "UserModel",
"../../component/Card_tp": "Card_tp",
"../../component/PlayerHead_tp": "PlayerHead_tp",
"../../component/TP_Eff_Win": "TP_Eff_Win",
"../../component/TP_Effect_Follow": "TP_Effect_Follow",
"../../component/VSArrow": "VSArrow",
"../../model/TeenPattiLogic": "TeenPattiLogic",
"../../model/TeenPattiModel": "TeenPattiModel",
"../../model/TeenPattiStruct": "TeenPattiStruct",
"./CompateAlert": "CompateAlert"
} ],
TestScene: [ function(e, t, o) {
"use strict";
cc._RF.push(t, "cb785SNAtlDe5EePrVW6R5k", "TestScene");
var n, a = this && this.__extends || (n = function(e, t) {
return (n = Object.setPrototypeOf || {
__proto__: []
} instanceof Array && function(e, t) {
e.__proto__ = t;
} || function(e, t) {
for (var o in t) Object.prototype.hasOwnProperty.call(t, o) && (e[o] = t[o]);
})(e, t);
}, function(e, t) {
n(e, t);
function o() {
this.constructor = e;
}
e.prototype = null === t ? Object.create(t) : (o.prototype = t.prototype, new o());
}), i = this && this.__decorate || function(e, t, o, n) {
var a, i = arguments.length, r = i < 3 ? t : null === n ? n = Object.getOwnPropertyDescriptor(t, o) : n;
if ("object" == typeof Reflect && "function" == typeof Reflect.decorate) r = Reflect.decorate(e, t, o, n); else for (var l = e.length - 1; l >= 0; l--) (a = e[l]) && (r = (i < 3 ? a(r) : i > 3 ? a(t, o, r) : a(t, o)) || r);
return i > 3 && r && Object.defineProperty(t, o, r), r;
};
Object.defineProperty(o, "__esModule", {
value: !0
});
var r = e("../../../Game/client/global/enum/game/Event"), l = e("../../../Game/fromework/global/Tools"), s = e("../../../Game/fromework/helper/EventHelper"), c = cc._decorator, u = c.ccclass, d = c.property, p = function(e) {
a(t, e);
function t() {
var t = null !== e && e.apply(this, arguments) || this;
t.Bonus = null;
t.TestChip = null;
t.ChipLayer = null;
t.TestOddsArea = null;
return t;
}
t.prototype.onLoad = function() {
for (var e = 0; e < 100; e++) {
var t = l.Tools.TNumber.randomNumber(0, this.TestOddsArea.children.length - 1), o = cc.instantiate(this.TestChip), n = this.TestOddsArea.convertToWorldSpaceAR(this.TestOddsArea.children[t].position).add(cc.v3((Math.random() > .5 ? 1 : -1) * Math.random() * 15, (Math.random() > .5 ? 1 : -1) * Math.random() * 15, 0)).sub(cc.v3(cc.winSize.width / 2, cc.winSize.height / 2, 0));
o.parent = this.ChipLayer;
o.setPosition(n.x, n.y);
}
};
t.prototype.onTestClicked = function() {
s.default.Instance.Global.emit(r.GameEvent.S2C_AB_SHOW);
};
t.prototype.onTestResetClicked = function() {
s.default.Instance.Global.emit(r.GameEvent.S2C_RESET);
};
i([ d(cc.Node) ], t.prototype, "Bonus", void 0);
i([ d(cc.Node) ], t.prototype, "TestChip", void 0);
i([ d(cc.Node) ], t.prototype, "ChipLayer", void 0);
i([ d(cc.Node) ], t.prototype, "TestOddsArea", void 0);
return i([ u ], t);
}(cc.Component);
o.default = p;
cc._RF.pop();
}, {
"../../../Game/client/global/enum/game/Event": "Event",
"../../../Game/fromework/global/Tools": "Tools",
"../../../Game/fromework/helper/EventHelper": "EventHelper"
} ],
TestTools: [ function(e, t, o) {
"use strict";
cc._RF.push(t, "f0ea4h62jVP3aaC9li0Ax8M", "TestTools");
Object.defineProperty(o, "__esModule", {
value: !0
});
o.TestTool = void 0;
var n = e("../../../Game/client/logic/game/GameHelper"), a = e("../../../Game/fromework/global/Tools"), i = [ 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59, 60, 61, 66, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59, 60, 61, 66 ], r = function() {
function e() {}
e.getWild = function() {
if (!e._wild) {
var t = a.Tools.TNumber.randomNumber(0, e._cards.length - 13);
e._wild = e._cards[t];
e._cards.splice(t, 1);
}
return e._wild;
};
e.reset = function() {
e._cards.splice(0);
e._cards = i.slice();
delete e._wild;
e._wild = null;
};
e.getHandCards = function() {
var t = a.Tools.TArray.upsetArr(e._cards), o = a.Tools.TNumber.randomNumber(0, e._cards.length - 13), n = a.Tools.TArray.getArrayNum(t, o, o + 12);
e._cards.splice(t, 13);
var i = [];
n.forEach(function(e) {
i.push(e);
});
return i;
};
e.getCard = function() {
return e._cards.length <= 0 ? null : e._cards.shift();
};
e.checkWild = function(e, t) {
e.forEach(function(e) {
e.forEach(function(e) {
e.figure == n.GroupHelper.getFigure(t) && (e.WildCard.node.active = !0);
});
});
};
e._cards = i.slice();
e._wild = 0;
return e;
}();
o.TestTool = r;
cc._RF.pop();
}, {
"../../../Game/client/logic/game/GameHelper": "GameHelper",
"../../../Game/fromework/global/Tools": "Tools"
} ],
ThirtyDaysSignUp: [ function(e, t, o) {
"use strict";
cc._RF.push(t, "6458fKgIdtDz6lzAmhluAwR", "ThirtyDaysSignUp");
var n, a = this && this.__extends || (n = function(e, t) {
return (n = Object.setPrototypeOf || {
__proto__: []
} instanceof Array && function(e, t) {
e.__proto__ = t;
} || function(e, t) {
for (var o in t) Object.prototype.hasOwnProperty.call(t, o) && (e[o] = t[o]);
})(e, t);
}, function(e, t) {
n(e, t);
function o() {
this.constructor = e;
}
e.prototype = null === t ? Object.create(t) : (o.prototype = t.prototype, new o());
}), i = this && this.__decorate || function(e, t, o, n) {
var a, i = arguments.length, r = i < 3 ? t : null === n ? n = Object.getOwnPropertyDescriptor(t, o) : n;
if ("object" == typeof Reflect && "function" == typeof Reflect.decorate) r = Reflect.decorate(e, t, o, n); else for (var l = e.length - 1; l >= 0; l--) (a = e[l]) && (r = (i < 3 ? a(r) : i > 3 ? a(t, o, r) : a(t, o)) || r);
return i > 3 && r && Object.defineProperty(t, o, r), r;
};
Object.defineProperty(o, "__esModule", {
value: !0
});
o.NoticeType = void 0;
var r = e("../../../../Game/fromework/helper/UIHelper"), l = e("../../../../Game/Script/global/GlobalValue"), s = e("../../../../Game/client/global/enum/game/Const"), c = e("../../active/ActiveModel"), u = e("../../../../platform/Platform"), d = e("../../../global/PopHelper"), p = e("../../../../Game/fromework/helper/AudioHelper"), h = cc._decorator, f = h.ccclass, _ = h.property;
(function(e) {
e[e.Welfare = 1] = "Welfare";
e[e.SignIn = 2] = "SignIn";
e[e.Festival = 3] = "Festival";
e[e.FirstCharge = 4] = "FirstCharge";
e[e.DailyCharge = 5] = "DailyCharge";
})(o.NoticeType || (o.NoticeType = {}));
var m = function(e) {
a(t, e);
function t() {
var t = null !== e && e.apply(this, arguments) || this;
t.SignPanel = null;
t.RightPanel = null;
t.btnDownLoad = null;
t.coinSprFra = null;
t.rewardNode = null;
t.getThirtySignAllDatas = null;
return t;
}
t.prototype.onEnable = function() {};
t.prototype.onDisable = function() {};
t.prototype.onLoad = function() {
var e = this;
this.RightPanel.active = !1;
d.PopHelper.Instance.showWaiting(0, "loading...");
c.ActiveProxy.Instance.getThirtyDayData(function(t) {
if (t) {
d.PopHelper.Instance.hideWaiting();
e.RightPanel.active = !0;
e.getThirtySignAllDatas = t;
e.initUI(t);
}
});
};
t.prototype.isNeedLoadPack = function() {
return !!cc.sys.isBrowser || cc.sys.os == cc.sys.OS_ANDROID && "com.web.dwnld.a1.safeapk" !== u.default.getPackageName() && !u.default.getPackageName().includes("com.wsx.edctp.a1");
};
t.prototype.onDestroy = function() {};
t.prototype.initUI = function(e) {
for (var t = this, o = e.day_list, n = e.can_sign, a = e.is_pay, i = !1, r = -1, l = 1; l <= 30; l++) {
var s = o[l - 1], u = this.SignPanel.getChildByName("SignInItem" + l), d = u.getChildByName("Background");
d.getComponent(cc.Button).tag = l;
d.getComponent(cc.Button).node.on("click", function(e) {
var o = e.tag;
n && r == o && t.onRequestGetReward(r);
}, this);
u.getChildByName("Title").getComponent(cc.Label).string = l + "Day";
u.getChildByName("Reward").getComponent(cc.Label).string = s.cash + "";
var p = u.getChildByName("Finish"), h = u.getChildByName("current");
if (s.is_sign) {
p.active = !0;
h.active = !1;
} else {
p.active = !1;
h.active = !1;
}
if (!s.is_sign && !i && n) {
i = !0;
p.active = !1;
h.active = !0;
r = l;
}
}
var f = e.signed_cash, _ = e.condition_cash, m = Number(e.rewardConfig.payQf) / 1e3, y = Number(e.rewardConfig.giftQf) / 1e3, g = this.RightPanel.getChildByName("upNode"), v = g.getChildByName("btn_pay"), C = v.getChildByName("Background"), b = g.getChildByName("kuangNode");
b.getChildByName("currentValue").getComponent(cc.Label).string = "₹" + f;
var I = b.getChildByName("progressBar");
I.getChildByName("barValue").getComponent(cc.Label).string = f + "/" + _;
I.getComponent(cc.ProgressBar).progress = f / _;
if (f >= _) {
b.active = !1;
v.active = !0;
v.getChildByName("add").getComponent(cc.Label).string = "Add " + m;
v.getChildByName("getValue").getComponent(cc.Label).string = "Get " + m + "+" + y;
a && (C.getComponent(cc.Button).interactable = !1);
C.getComponent(cc.Button).node.on("click", function() {
c.ActiveProxy.Instance.BuyThirtyDayData(function() {});
}, this);
} else {
b.active = !0;
v.active = !1;
}
var E = this.RightPanel.getChildByName("downNode"), S = E.getChildByName("btn_kongqueka"), T = E.getChildByName("giftNode"), R = e.safe_apk_received, O = e.safe_apk_cash;
if (this.isNeedLoadPack()) {
S.active = !1;
T.active = !0;
T.getChildByName("finished").active = !1;
R && (T.getChildByName("finished").active = !0);
T.getChildByName("icon").getChildByName("textAddValue").getComponent(cc.Label).string = O + "";
} else {
S.active = !0;
T.active = !1;
}
this.btnDownLoad.node.runAction(cc.sequence(cc.scaleTo(.8, .8), cc.scaleTo(.8, 1)).repeatForever());
};
t.prototype.onRequestGetReward = function(e) {
var t = this;
c.ActiveProxy.Instance.ReceiveThirtyDayData(function() {
c.ActiveProxy.Instance.getThirtyDayData(function(o) {
if (o) {
d.PopHelper.Instance.hideWaiting();
t.getThirtySignAllDatas = o;
t.initUI(o);
var n = t.SignPanel.getChildByName("SignInItem" + e).convertToWorldSpaceAR(cc.v2(0, 0));
t.creatorCoinActToMyHead(n, 15);
}
});
});
};
t.prototype.creatorCoinActToMyHead = function(e, t) {
void 0 === e && (e = null);
void 0 === t && (t = 15);
for (var o = 0; o < t; o++) {
var n = new cc.Node();
n.active = !0;
n.addComponent(cc.Sprite);
n.getComponent(cc.Sprite).spriteFrame = this.coinSprFra;
var a = this.node.convertToNodeSpaceAR(this.rewardNode.convertToWorldSpaceAR(cc.Vec2.ZERO)), i = this.node.convertToNodeSpaceAR(e);
this.node.addChild(n);
n.setPosition(i);
n.runAction(cc.sequence(cc.delayTime(.08 * o), cc.bezierTo(.8, [ i, cc.v2(a.x / 2, i.y / 2), a ]), cc.fadeOut(.2), cc.destroySelf()));
}
setTimeout(function() {
p.default.Instance.playBundleEffect("resources/sound/common/jiajinbi");
}, 500);
};
t.prototype.onClickKongQueKa = function() {
r.default.Instance.addBundleMaskLayer(s.BundleUIPath.KongQueKaLayer);
r.default.Instance.removeMaskLayer(this.node, !0);
};
t.prototype.onClickGift = function() {
var e = l.default.getInstance().InviteTargetLink;
e && "" != e || (e = "https://download.genevah.xyz");
cc.sys.openURL(e);
r.default.Instance.removeMaskLayer(this.node, !0);
};
t.prototype.onCloseClicked = function() {
r.default.Instance.removeMaskLayer(this.node, !0);
};
i([ _(cc.Node) ], t.prototype, "SignPanel", void 0);
i([ _(cc.Node) ], t.prototype, "RightPanel", void 0);
i([ _(cc.Button) ], t.prototype, "btnDownLoad", void 0);
i([ _(cc.SpriteFrame) ], t.prototype, "coinSprFra", void 0);
i([ _(cc.Node) ], t.prototype, "rewardNode", void 0);
return i([ f ], t);
}(cc.Component);
o.default = m;
cc._RF.pop();
}, {
"../../../../Game/Script/global/GlobalValue": "GlobalValue",
"../../../../Game/client/global/enum/game/Const": "Const",
"../../../../Game/fromework/helper/AudioHelper": "AudioHelper",
"../../../../Game/fromework/helper/UIHelper": "UIHelper",
"../../../../platform/Platform": "Platform",
"../../../global/PopHelper": "PopHelper",
"../../active/ActiveModel": "ActiveModel"
} ],
Tips: [ function(e, t, o) {
"use strict";
cc._RF.push(t, "761e6Dom7dMebbKM+G+O2Tl", "Tips");
var n, a = this && this.__extends || (n = function(e, t) {
return (n = Object.setPrototypeOf || {
__proto__: []
} instanceof Array && function(e, t) {
e.__proto__ = t;
} || function(e, t) {
for (var o in t) Object.prototype.hasOwnProperty.call(t, o) && (e[o] = t[o]);
})(e, t);
}, function(e, t) {
n(e, t);
function o() {
this.constructor = e;
}
e.prototype = null === t ? Object.create(t) : (o.prototype = t.prototype, new o());
}), i = this && this.__decorate || function(e, t, o, n) {
var a, i = arguments.length, r = i < 3 ? t : null === n ? n = Object.getOwnPropertyDescriptor(t, o) : n;
if ("object" == typeof Reflect && "function" == typeof Reflect.decorate) r = Reflect.decorate(e, t, o, n); else for (var l = e.length - 1; l >= 0; l--) (a = e[l]) && (r = (i < 3 ? a(r) : i > 3 ? a(t, o, r) : a(t, o)) || r);
return i > 3 && r && Object.defineProperty(t, o, r), r;
};
Object.defineProperty(o, "__esModule", {
value: !0
});
var r = cc._decorator, l = r.ccclass, s = r.property, c = r.menu, u = function(e) {
a(t, e);
function t() {
var t = null !== e && e.apply(this, arguments) || this;
t.Text = null;
t._pool = null;
return t;
}
t.prototype.init = function(e) {
this._pool = e;
};
t.prototype.showTips = function(e) {
if (e && "" !== e) {
this.node.opacity = 0;
this.Text.overflow = cc.Label.Overflow.NONE;
this.Text.string = e;
this.Text._forceUpdateRenderData(!0);
if (this.Text.node.width > cc.view.getFrameSize().width - 100) {
this.Text.overflow = cc.Label.Overflow.RESIZE_HEIGHT;
this.Text.node.width = cc.view.getFrameSize().width - 100;
}
this.Text._forceUpdateRenderData(!0);
this._begin();
}
};
t.prototype._begin = function() {
var e = this, t = cc.fadeIn(.2), o = cc.delayTime(2), n = cc.fadeOut(1), a = cc.callFunc(function() {
e.Text.string = "";
e._pool.put(e.node);
}), i = cc.sequence(t, o, n, a);
this.node.runAction(i);
};
t.prototype.onLoad = function() {};
t.prototype.start = function() {};
i([ s(cc.Label) ], t.prototype, "Text", void 0);
return i([ l, c("component/Tips(悬浮提示)") ], t);
}(cc.Component);
o.default = u;
cc._RF.pop();
}, {} ],
Tools: [ function(e, t, o) {
"use strict";
cc._RF.push(t, "963d4EqxmtDZp83SB2n7c4P", "Tools");
Object.defineProperty(o, "__esModule", {
value: !0
});
o.Tools = void 0;
var n = e("../../../platform/Platform");
(function(e) {
e.GenerateUUID = function() {
var e = new Date().getTime();
return "xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g, function(t) {
var o = (e + 16 * Math.random()) % 16 | 0;
e = Math.floor(e / 16);
return ("x" == t ? o : 3 & o | 8).toString(16);
});
};
e.GenerateID = function(e) {
for (var t = "", o = 0; o < e; o++) t += Math.floor(10 * Math.random());
return t;
};
e.isEmpty = function(e) {
return null == e || "string" == typeof e && "" === e.trim() || !(!Array.isArray(e) || 0 !== e.length) || "object" == typeof e && 0 === Object.keys(e).length;
};
e.TArray = {
upsetArr: function(e) {
return e.sort(function() {
return Math.random() - .5;
});
},
maxArr: function(e) {
return Math.max.apply(null, e);
},
minArr: function(e) {
return Math.min.apply(null, e);
},
sumArr: function(e) {
return e.reduce(function(e, t) {
return e + t;
}, 0);
},
coletr: function(e) {
return this.sumArr(e) / e.length;
},
randomOne: function(e) {
return e[Math.floor(Math.random() * e.length)];
},
getEleCount: function(e, t) {
for (var o = 0, n = 0, a = e.length; n < a; n++) t == e[n] && o++;
return o;
},
getCount: function(e, t, o) {
void 0 === o && (o = !1);
for (var n, a = {}, i = [], r = 0, l = e.length; r < l; r++) a[n = e[r]] ? a[n]++ : a[n] = 1;
for (var s in a) i.push({
el: s,
count: a[s]
});
i.sort(function(e, t) {
return t.count - e.count;
});
o && (i = i.reverse());
var c = t || i.length;
return i.slice(0, c);
},
getArrayNum: function(e, t, o) {
for (var n = [], a = o || e.length - 1, i = t; i <= a; i++) n.push(e[i]);
return n;
},
removeArrayForValue: function(e, t, o) {
void 0 === o && (o = !1);
e.filter(function(e) {
return o ? -1 !== e.indexOf(t) : e !== t;
});
},
close: function(e) {
if (e) for (;0 < e.length; 0) e.splice(0, 1);
},
passArray: function(e) {
var t = [];
for (var o in e) t.push(e[o]);
return t;
},
flatten: function(e) {
var t = this;
return [].concat.apply([], e.map(function(e) {
return Array.isArray(e) ? t.flatten(e) : e;
}));
},
duplicate: function(e, t) {
if (e.length <= 0) return t;
if (t.length <= 0) return e;
for (var o = e.slice(0), n = t.slice(0), a = o.length - 1; a >= 0; a--) for (var i = n.length - 1; i >= 0; i--) if (o[a] == n[i]) {
o.splice(a, 1);
n.splice(i, 1);
break;
}
return o;
},
deepCopy: function(t) {
var o = [];
t.forEach(function(t, n) {
t instanceof Array ? o[n] = e.TArray.deepCopy(t) : o[n] = t;
});
return o;
},
equals: function(t, o) {
if (!t || !o) return !1;
if (t.length != o.length) return !1;
for (var n = 0, a = t.length; n < a; n++) if (t[n] instanceof Array && o[n] instanceof Array) {
if (!e.TArray.equals(t[n], o[n])) return !1;
} else if (t[n] != o[n]) return !1;
return !0;
},
memset: function(t, o) {
t.forEach(function(n, a) {
n instanceof Array ? e.TArray.memset(t[a], o) : t[a] = o;
});
},
getLength: function(t) {
var o = 0;
t.forEach(function(t) {
t instanceof Array ? o += e.TArray.getLength(t) : o++;
});
return o;
},
division: function(e, t) {
for (var o = [], n = Math.ceil(e.length / t), a = 0; a < t; a++) o.push(e.slice(a * n, (a + 1) * n));
return o;
},
getRandomElementsFromArray: function(e, t) {
for (var o = e.slice(), n = [], a = 0; a < t && o.length > 0; a++) {
var i = Math.floor(Math.random() * o.length), r = o.splice(i, 1)[0];
n.push(r);
}
return n;
},
shuffle: function(e) {
for (var t, o, n = e.length; 0 != n; ) t = [ e[o = Math.random() * n-- >>> 0], e[n] ], 
e[n] = t[0], e[o] = t[1];
return e;
}
};
e.TObj = {
instanceOf: function(e, t) {
return toString.apply(e) === "[object " + t + "]" || typeof e === t.toLowerCase();
},
toJSON: function(e) {
var t = null;
try {
t = JSON.parse(e);
} catch (t) {
n.default.log("to JSON ERROR=" + e);
}
return t;
},
fmtData: function(e) {
return JSON.stringify(e);
},
deepCopy: function(t) {
if (null == t || {} == t || [] == t) return t;
var o;
if (t instanceof Array) {
o = [];
for (var n in t) if ("function" == typeof t[n]) o[n] = t[n]; else {
var a = "object" == typeof t[n] ? e.TObj.deepCopy(t[n]) : t[n];
o.push(a);
}
} else if (t instanceof Map) {
o = new Map();
t.forEach(function(t, n) {
o.set(n, e.TObj.deepCopy(t));
});
} else {
o = {};
for (var n in t) if ("function" == typeof t[n]) o[n] = t[n]; else {
a = "object" == typeof t[n] ? e.TObj.deepCopy(t[n]) : t[n];
o[n] = a;
}
}
return o;
},
areObjectsEqual: function(t, o) {
if (typeof t != typeof o) return !1;
if ("object" != typeof t || null === t || null === o) return t === o;
var n = Object.keys(t), a = Object.keys(o);
if (n.length !== a.length) return !1;
for (var i = 0, r = n; i < r.length; i++) {
var l = r[i];
if (!e.TObj.areObjectsEqual(t[l], o[l])) return !1;
}
return !0;
}
};
var t;
(function(e) {
e[e.ALL = 1] = "ALL";
e[e.FRONT_AND_BACK = 2] = "FRONT_AND_BACK";
e[e.FRONT = 3] = "FRONT";
e[e.BACK = 4] = "BACK";
})(t = e.BlankType || (e.BlankType = {}));
e.TStr = {
trim: function(e, o) {
switch (o) {
case t.ALL:
return e.replace(/\s+/g, "");

case t.FRONT_AND_BACK:
return e.replace(/(^\s*)|(\s*$)/g, "");

case t.FRONT:
return e.replace(/(^\s*)/g, "");

case t.BACK:
return e.replace(/(\s*$)/g, "");

default:
return e;
}
},
changeCase: function(e, t) {
switch (t) {
case 1:
return e.replace(/^(\w)(\w+)/, function(e, t, o) {
return t.toUpperCase() + o.toLowerCase();
});

case 2:
return e.replace(/^(\w)(\w+)/, function(e, t, o) {
return t.toLowerCase() + o.toUpperCase();
});

case 3:
return function() {
var t = "";
e.split("").forEach(function(e) {
/^([a-z]+)/.test(e) ? t += e.toUpperCase() : /^([A-Z]+)/.test(e) ? t += e.toLowerCase() : t += e;
});
return t;
}();

case 4:
return e.toUpperCase();

case 5:
return e.toLowerCase();

default:
return e;
}
},
repeatStr: function(e, t) {
for (var o = "", n = 0; n < t; n++) o += e;
return o;
},
replaceAll: function(e, t, o) {
var n = new RegExp(t, "g");
return e.replace(n, o);
},
replaceString: function(t, o) {
Object.keys(o).forEach(function(n) {
t = e.TStr.replaceAll(t, "%{" + n + "}", o[n]);
});
return t;
},
replaceStr: function(e, t, o, n) {
var a = "", i = null, r = n || "*";
if (3 === t.length && 0 === o) {
a = "(\\w{" + t[0] + "})\\w{" + t[1] + "}(\\w{" + t[2] + "})";
i = new RegExp(a);
var l = this.repeatStr(r, t[1]);
return e.replace(i, "$1" + l + "$2");
}
if (3 === t.length && 1 === o) {
a = "\\w{" + t[0] + "}(\\w{" + t[1] + "})\\w{" + t[2] + "}";
i = new RegExp(a);
var s = this.repeatSte(r, t[0]), c = this.repeatSte(r, t[2]);
return e.replace(i, s + "$1" + c);
}
if (1 === t.length && 0 == o) {
a = "(^\\w{" + t[0] + "})";
i = new RegExp(a);
l = this.repeatSte(r, t[0]);
return e.replace(i, l);
}
if (1 === t.length && 1 == o) {
a = "(\\w{" + t[0] + "}$)";
i = new RegExp(a);
l = this.repeatSte(r, t[0]);
return e.replace(i, l);
}
},
checkType: function(e, t) {
switch (t) {
case "email":
return /^[\w-]+(\.[\w-]+)*@[\w-]+(\.[\w-]+)+$/.test(e);

case "phone":
return /^1[3|4|5|7|8][0-9]{9}$/.test(e);

case "tel":
return /^(0\d{2,3}-\d{7,8})(-\d{1,4})?$/.test(e);

case "number":
return /^[0-9]+$/.test(e);

case "english":
return /^[a-zA-Z\s]+$/.test(e);

case "chinese":
return /^[\u4E00-\u9FA5]+$/.test(e);

case "lower":
return /^[a-z]+$/.test(e);

case "upper":
return /^[A-Z]+$/.test(e);

case "dd/mm/yyyy":
return /^(\d{2})(\/)(\d{2})(\/)(\d{4})$/.test(e);

case "indiaPhone":
return /^[0-9]{10}$/.test(e);

default:
return !0;
}
},
hasNumber: function(e) {
return /\d/.test(e);
},
checkPwd: function(e) {
var t = 0;
if (e.length < 6) return t;
/[0-9]/.test(e) && t++;
/[a-z]/.test(e) && t++;
/[A-Z]/.test(e) && t++;
/[\.|-|_]/.test(e) && t++;
return t;
},
countStr: function(e, t) {
return e.split(t).length - 1;
},
stringFormat: function() {
if (!(arguments.length < 2)) {
var t = arguments[0];
if (2 == arguments.length && e.TObj.instanceOf(arguments[1], "Array")) for (var o = arguments[1], n = 1; n <= o.length; n++) {
var a = new RegExp("\\{" + n + "\\}", "g");
t = t.replace(a, o[n - 1]);
} else for (n = 1; n < arguments.length; n++) {
a = new RegExp("\\{" + n + "\\}", "g");
t = t.replace(a, arguments[n]);
}
return t;
}
},
SubStr: function(e, t, o, n) {
if (-1 == t.indexOf(o)) return t;
switch (e) {
case 1:
return t.substr(t.indexOf(o), n);

case 2:
return t.substr(t.lastIndexOf(o), n);

case 3:
return t.substr(o.length, n);

default:
return t;
}
},
ellipsisString: function(e, t) {
return e.length > t ? e.substr(0, t) + "..." : e;
},
getQueryString: function(e, t) {
var o = e.toLowerCase(), n = new RegExp("(" + o + ")=([^&]*)(&|$)", "i"), a = t.match(n);
return null != a ? decodeURI(a[2]) : null;
}
};
e.TDate = {
MonthSimple: [ "Jan", "Feb", "Mar", "Apr", "May", "Jun", "Jul", "Aug", "Sept", "Oct", "Nov", "Dec" ],
second2Day: function(e) {
var t = 0, o = 0, n = 0, a = 0;
if (e >= 0) {
t = Math.floor(e / 3600 / 24);
o = Math.floor(e / 60 / 60 % 24);
n = Math.floor(e / 60 % 60);
a = Math.floor(e % 60);
}
return {
day: t,
hour: o,
minu: n,
sec: a
};
},
second2Hour: function(e) {
var t = 0, o = 0, n = 0;
if (e >= 0) {
t = Math.floor(e / 60 / 60);
o = Math.floor(e / 60 % 60);
n = Math.floor(e % 60);
}
return {
hour: t,
minu: o,
sec: n
};
},
letgetEndTime: function(e) {
var t = new Date(), o = new Date(e.replace(/-/g, "/")).getTime() - t.getTime(), a = 0, i = 0, r = 0, l = 0;
if (o >= 0) {
a = Math.floor(o / 1e3 / 3600 / 24);
i = Math.floor(o / 1e3 / 60 / 60 % 24);
r = Math.floor(o / 1e3 / 60 % 60);
l = Math.floor(o / 1e3 % 60);
}
n.default.log("剩余时间" + a + "天 " + i + "小时 " + r + " 分钟" + l + " 秒");
return {
day: a,
hour: i,
minu: r,
sec: l
};
},
letcurtimestamp: function() {
return Math.round(new Date().getTime());
},
letcurtime: function() {
var e = new Date(), t = e.getFullYear(), o = e.getMonth() + 1, a = e.getDate(), i = e.getDay(), r = e.getHours(), l = e.getMinutes(), s = e.getSeconds();
n.default.log(t + "/" + o + "/" + a + "/ " + r + ":" + l + ":" + s);
return {
year: Number(t),
month: Number(o),
date: Number(a),
day: Number(i),
hour: Number(r),
minu: Number(l),
sec: Number(s)
};
},
letfmtData: function(o) {
var n = "";
if (!e.TObj.instanceOf(o, "undefined") && o && "" != e.TStr.trim(o, t.ALL) && 8 == o.length) {
n = o.substring(0, 4) + "/";
n += o.substring(4, 6) + "/";
n += o.substring(6, 8) + "/";
}
return n;
},
lettimeFormat: function(e) {
var t = new Date(1e3 * parseInt(e));
return t.getFullYear() + "/" + (t.getMonth() + 1 < 10 ? "0" + (t.getMonth() + 1) : t.getMonth() + 1) + "/" + (t.getDate() < 10 ? "0" + t.getDate() : t.getDate() + "") + " " + (t.getHours() < 10 ? "0" + t.getHours() : t.getHours()) + ":" + (t.getMinutes() < 10 ? "0" + t.getMinutes() : t.getMinutes()) + ":" + (t.getSeconds() < 10 ? "0" + t.getSeconds() : t.getSeconds());
},
letgetUnixTime: function(e) {
var t = e.replace(/-/g, "/");
return new Date(t).getTime().toString().substr(0, 10);
},
format: function(t, o, n) {
void 0 === o && (o = "yyyy-MM-dd hh:mm:ss");
void 0 === n && (n = !1);
var a = new Date(t), i = n ? e.TDate.MonthSimple[a.getMonth()] : e.TDate.fix2(a.getMonth() + 1);
return (o = (o = (o = (o = (o = o.replace("yyyy", a.getFullYear() + "")).replace("MM", i)).replace("dd", e.TDate.fix2(a.getDate()))).replace("hh", e.TDate.fix2(a.getHours()))).replace("mm", e.TDate.fix2(a.getMinutes()))).replace("ss", e.TDate.fix2(a.getSeconds()));
},
fix2: function(e) {
return e < 10 ? "0" + e : "" + e;
},
isTheSameLocalDay: function(e, t) {
var o = new Date(e), n = new Date(t);
return o.toDateString() === n.toDateString();
}
};
e.TNumber = {
toThousands: function(e) {
return (e || 0).toString().replace(/(\d)(?=(?:\d{3})+$)/g, "$1,");
},
NumFormat: function(e) {
if (0 === e) return "0 B";
var t, o = 1e3, n = [ "", "k", "m", "b", "t", "aa", "ab", "ac" ], a = Math.floor(Math.log(e) / Math.log(o));
if (0 == a) {
t = e / Math.pow(o, a);
t = Math.floor(100 * t) / 100;
} else {
t = a < n.length ? e / Math.pow(o, a) : e / Math.pow(o, a) + Math.pow(o, a - (n.length - 1));
t = a >= n.length ? Math.floor(100 * t) / 100 + n[n.length - 1] : Math.floor(100 * t) / 100 + n[a];
}
return t;
},
MoneyNumFormat: function(t) {
if (!t || isNaN(t) || t < 0) return "0";
if (t < 1e3) return e.TNumber.numFixed(t, 0);
if (t >= 1e3 && t < 1e5) {
t = Math.floor(t);
return this.toThousands(t);
}
if (t >= 1e5 && t < 1e6) return e.TNumber.numFixed(t / 1e5, 2) + "L";
if (t >= 1e6 && t < 1e7) return e.TNumber.numFixed(t / 1e5, 1) + "L";
var o = Math.floor(t / 1e7);
return this.toThousands(o) + "CR";
},
randomFloat: function(e, t) {
return 2 === arguments.length ? e + Math.random() * (t - e) : 1 === arguments.length ? Math.random() * e : 255 * Math.random();
},
randomNumber: function(e, t) {
return 2 === arguments.length ? Math.round(e + Math.random() * (t - e)) : 1 === arguments.length ? Math.round(Math.random() * e) : Math.round(255 * Math.random());
},
randomMinMax: function(e, t) {
return Math.floor(Math.random() * (t - e + 1) + e);
},
randomColor: function() {
return "rgb(" + this.randomNumber(255) + "," + this.randomNumber(255) + "," + this.randomNumber(255) + ")";
},
passNum: function(e, t) {
switch (e) {
case "int":
return ~~t;

case "float":
return 1 * t;

default:
n.default.log(e + "Not Find");
}
},
addPreZero: function(e, t) {
for (var o = (e + "").length, n = "", a = 0; a < t - o; a++) n += "0";
return n + e;
},
changeBytes: function(e) {
var t, o = t = e < 102.4 ? e.toFixed(2) + "B" : e < 104857.6 ? (e / 1024).toFixed(2) + "KB" : e < 107374182.4 ? (e / 1048576).toFixed(2) + "MB" : (e / 1073741824).toFixed(2) + "GB", n = o.indexOf(".");
return "00" == o.substr(n + 1, 2) ? o.substring(0, n) + o.substr(n + 3, 2) : t;
},
num2thousand: function(e) {
return 1e3 * e;
},
num2single: function(e) {
return e / 1e3;
},
numFixed: function(e, t) {
if (t <= 0) return Math.floor(e);
var o = Math.pow(10, t);
return Math.floor(e * o) / o;
},
simplifyNumber: function(e) {
return e >= 1e6 ? this.numFixed(e / 1e6, 1) + "m" : e >= 1e3 ? this.numFixed(e / 1e3, 1) + "k" : e;
},
formatToTwoDecimalString: function(e) {
return Number(e.toFixed(2)).toString();
}
};
e.Base64 = {
uint8arrayToBase64: function(e) {
for (var t, o = 0, n = e.length, a = ""; o < n; ) {
t = e.subarray(o, Math.min(o + 32768, n));
a += String.fromCharCode.apply(null, t);
o += 32768;
}
return "data:image/png;base64," + btoa(a);
},
base64ToUint8Array: function(t) {
for (var o = ((t = e.TStr.replaceAll(t, "data:image/png;base64,", "")) + "=".repeat((4 - t.length % 4) % 4)).replace(/\-/g, "+").replace(/_/g, "/"), n = window.atob(o), a = new Uint8Array(n.length), i = 0; i < n.length; ++i) a[i] = n.charCodeAt(i);
return a;
},
encode: function(t, o) {
var n = window.base64Ex;
return n.encode(n.encode(t) + e.JSMD5.md5(o));
},
decode: function(t, o) {
var n = window.base64Ex, a = n.decode(t).replace(e.JSMD5.md5(o), "");
return n.decode(a);
},
encrypt_chars: "ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_.",
encrypt: function(t, o, n, a, i) {
void 0 === a && (a = 8);
void 0 === i && (i = 16);
for (var r = e.TNumber.randomMinMax(0, 64), l = e.TNumber.randomMinMax(0, 64), s = e.TNumber.randomMinMax(0, 64), c = e.Base64.encrypt_chars[r], u = e.Base64.encrypt_chars[l], d = e.Base64.encrypt_chars[s], p = r + l + s, h = 0, f = 0; null != o[f]; ) h += o[f++].charCodeAt(0);
for (var _ = e.JSMD5.md5(e.JSMD5.md5(e.JSMD5.md5(o + c) + u + n) + d).substr(p % a, h % a + i), m = "", y = 0, g = 0, v = (t = (t = window.base64Ex.encode(t)).replace(/\+/g, "-").replace(/\//g, "_").replace(/\=/g, ".")).length, C = _.length, b = 0; b < v; b++) {
g = g == C ? 0 : g;
y = (p + e.Base64.encrypt_chars.indexOf(t[b]) + _[g++].charCodeAt(0)) % 64;
m += e.Base64.encrypt_chars[y];
}
var I = m.length;
I++;
m = m.slice(0, l % I) + d + m.slice(l % I);
I++;
m = m.slice(0, r % I) + u + m.slice(r % I);
I++;
return m.slice(0, h % I) + c + m.slice(h % I);
},
decrypt: function(t, o, n, a, i) {
void 0 === a && (a = 8);
void 0 === i && (i = 16);
for (var r = 0, l = 0, s = t.length; null != o[l]; ) r += o[l++].charCodeAt(0);
var c = t[r % s], u = e.Base64.encrypt_chars.indexOf(c), d = (t = t.substr(0, r % s) + t.substr(r % s + 1))[u % --s], p = e.Base64.encrypt_chars.indexOf(d), h = (t = t.substr(0, u % s) + t.substr(u % s + 1))[p % --s], f = e.Base64.encrypt_chars.indexOf(h);
t = t.substr(0, p % s) + t.substr(p % s + 1);
s--;
var _ = u + p + f, m = e.JSMD5.md5(e.JSMD5.md5(e.JSMD5.md5(o + c) + d + n) + h).substr(_ % a, r % a + i), y = "", g = 0, v = 0;
s = t.length;
for (var C = m.length, b = 0; b < s; b++) {
v = v == C ? 0 : v;
g = e.Base64.encrypt_chars.indexOf(t[b]) - _ - m[v++].charCodeAt(0);
for (;g < 0; ) g += 64;
y += e.Base64.encrypt_chars[g];
}
y = y.replace(/\-/g, "+").replace(/\_/g, "/").replace(/\./g, "=");
return (y = window.base64Ex.decode(y)).trim().replace(/\x00/g, "");
}
};
e.JSMD5 = {
md5: function(e) {
function t(e, t) {
return e << t | e >>> 32 - t;
}
function o(e, t) {
var o, n, a, i, r;
a = 2147483648 & e;
i = 2147483648 & t;
r = (1073741823 & e) + (1073741823 & t);
return (o = 1073741824 & e) & (n = 1073741824 & t) ? 2147483648 ^ r ^ a ^ i : o | n ? 1073741824 & r ? 3221225472 ^ r ^ a ^ i : 1073741824 ^ r ^ a ^ i : r ^ a ^ i;
}
function n(e, t, o) {
return e & t | ~e & o;
}
function a(e, t, o) {
return e & o | t & ~o;
}
function i(e, t, o) {
return e ^ t ^ o;
}
function r(e, t, o) {
return t ^ (e | ~o);
}
function l(e, a, i, r, l, s, c) {
e = o(e, o(o(n(a, i, r), l), c));
return o(t(e, s), a);
}
function s(e, n, i, r, l, s, c) {
e = o(e, o(o(a(n, i, r), l), c));
return o(t(e, s), n);
}
function c(e, n, a, r, l, s, c) {
e = o(e, o(o(i(n, a, r), l), c));
return o(t(e, s), n);
}
function u(e, n, a, i, l, s, c) {
e = o(e, o(o(r(n, a, i), l), c));
return o(t(e, s), n);
}
function d(e) {
var t, o = "", n = "";
for (t = 0; t <= 3; t++) o += (n = "0" + (e >>> 8 * t & 255).toString(16)).substr(n.length - 2, 2);
return o;
}
var p, h, f, _, m, y, g, v, C, b = Array();
b = function(e) {
for (var t, o = e.length, n = o + 8, a = 16 * ((n - n % 64) / 64 + 1), i = Array(a - 1), r = 0, l = 0; l < o; ) {
r = l % 4 * 8;
i[t = (l - l % 4) / 4] = i[t] | e.charCodeAt(l) << r;
l++;
}
r = l % 4 * 8;
i[t = (l - l % 4) / 4] = i[t] | 128 << r;
i[a - 2] = o << 3;
i[a - 1] = o >>> 29;
return i;
}(e = function(e) {
e = e.replace(/\r\n/g, "\n");
for (var t = "", o = 0; o < e.length; o++) {
var n = e.charCodeAt(o);
if (n < 128) t += String.fromCharCode(n); else if (n > 127 && n < 2048) {
t += String.fromCharCode(n >> 6 | 192);
t += String.fromCharCode(63 & n | 128);
} else {
t += String.fromCharCode(n >> 12 | 224);
t += String.fromCharCode(n >> 6 & 63 | 128);
t += String.fromCharCode(63 & n | 128);
}
}
return t;
}(e));
y = 1732584193;
g = 4023233417;
v = 2562383102;
C = 271733878;
for (p = 0; p < b.length; p += 16) {
h = y;
f = g;
_ = v;
m = C;
y = l(y, g, v, C, b[p + 0], 7, 3614090360);
C = l(C, y, g, v, b[p + 1], 12, 3905402710);
v = l(v, C, y, g, b[p + 2], 17, 606105819);
g = l(g, v, C, y, b[p + 3], 22, 3250441966);
y = l(y, g, v, C, b[p + 4], 7, 4118548399);
C = l(C, y, g, v, b[p + 5], 12, 1200080426);
v = l(v, C, y, g, b[p + 6], 17, 2821735955);
g = l(g, v, C, y, b[p + 7], 22, 4249261313);
y = l(y, g, v, C, b[p + 8], 7, 1770035416);
C = l(C, y, g, v, b[p + 9], 12, 2336552879);
v = l(v, C, y, g, b[p + 10], 17, 4294925233);
g = l(g, v, C, y, b[p + 11], 22, 2304563134);
y = l(y, g, v, C, b[p + 12], 7, 1804603682);
C = l(C, y, g, v, b[p + 13], 12, 4254626195);
v = l(v, C, y, g, b[p + 14], 17, 2792965006);
y = s(y, g = l(g, v, C, y, b[p + 15], 22, 1236535329), v, C, b[p + 1], 5, 4129170786);
C = s(C, y, g, v, b[p + 6], 9, 3225465664);
v = s(v, C, y, g, b[p + 11], 14, 643717713);
g = s(g, v, C, y, b[p + 0], 20, 3921069994);
y = s(y, g, v, C, b[p + 5], 5, 3593408605);
C = s(C, y, g, v, b[p + 10], 9, 38016083);
v = s(v, C, y, g, b[p + 15], 14, 3634488961);
g = s(g, v, C, y, b[p + 4], 20, 3889429448);
y = s(y, g, v, C, b[p + 9], 5, 568446438);
C = s(C, y, g, v, b[p + 14], 9, 3275163606);
v = s(v, C, y, g, b[p + 3], 14, 4107603335);
g = s(g, v, C, y, b[p + 8], 20, 1163531501);
y = s(y, g, v, C, b[p + 13], 5, 2850285829);
C = s(C, y, g, v, b[p + 2], 9, 4243563512);
v = s(v, C, y, g, b[p + 7], 14, 1735328473);
y = c(y, g = s(g, v, C, y, b[p + 12], 20, 2368359562), v, C, b[p + 5], 4, 4294588738);
C = c(C, y, g, v, b[p + 8], 11, 2272392833);
v = c(v, C, y, g, b[p + 11], 16, 1839030562);
g = c(g, v, C, y, b[p + 14], 23, 4259657740);
y = c(y, g, v, C, b[p + 1], 4, 2763975236);
C = c(C, y, g, v, b[p + 4], 11, 1272893353);
v = c(v, C, y, g, b[p + 7], 16, 4139469664);
g = c(g, v, C, y, b[p + 10], 23, 3200236656);
y = c(y, g, v, C, b[p + 13], 4, 681279174);
C = c(C, y, g, v, b[p + 0], 11, 3936430074);
v = c(v, C, y, g, b[p + 3], 16, 3572445317);
g = c(g, v, C, y, b[p + 6], 23, 76029189);
y = c(y, g, v, C, b[p + 9], 4, 3654602809);
C = c(C, y, g, v, b[p + 12], 11, 3873151461);
v = c(v, C, y, g, b[p + 15], 16, 530742520);
y = u(y, g = c(g, v, C, y, b[p + 2], 23, 3299628645), v, C, b[p + 0], 6, 4096336452);
C = u(C, y, g, v, b[p + 7], 10, 1126891415);
v = u(v, C, y, g, b[p + 14], 15, 2878612391);
g = u(g, v, C, y, b[p + 5], 21, 4237533241);
y = u(y, g, v, C, b[p + 12], 6, 1700485571);
C = u(C, y, g, v, b[p + 3], 10, 2399980690);
v = u(v, C, y, g, b[p + 10], 15, 4293915773);
g = u(g, v, C, y, b[p + 1], 21, 2240044497);
y = u(y, g, v, C, b[p + 8], 6, 1873313359);
C = u(C, y, g, v, b[p + 15], 10, 4264355552);
v = u(v, C, y, g, b[p + 6], 15, 2734768916);
g = u(g, v, C, y, b[p + 13], 21, 1309151649);
y = u(y, g, v, C, b[p + 4], 6, 4149444226);
C = u(C, y, g, v, b[p + 11], 10, 3174756917);
v = u(v, C, y, g, b[p + 2], 15, 718787259);
g = u(g, v, C, y, b[p + 9], 21, 3951481745);
y = o(y, h);
g = o(g, f);
v = o(v, _);
C = o(C, m);
}
return (d(y) + d(g) + d(v) + d(C)).toLowerCase();
}
};
e.TCreator = {
getAngle: function(e, t, o) {
void 0 === o && (o = 0);
var n = t.x - e.x, a = t.y - e.y;
return 180 * Math.atan2(a, n) / Math.PI % 360 + o;
},
imageAutoSize: function(e, t, o, n) {
var a = t.getOriginalSize();
if (0 != n && 0 != a.height) if (a.width > a.height) {
e.width = a.width * (n / a.height);
e.height = n;
} else if (a.width < a.height) {
e.width = o;
e.height = a.height * (o / a.width);
} else {
e.width = o;
e.height = n;
}
}
};
e.TFloat = {
div: function(t, o) {
var n, a, i = 0, r = 0;
try {
i = t.toString().split(".")[1].length;
} catch (e) {}
try {
r = o.toString().split(".")[1].length;
} catch (e) {}
n = Number(t.toString().replace(".", ""));
a = Number(o.toString().replace(".", ""));
return e.TFloat.mul(n / a, Math.pow(10, r - i));
},
mul: function(e, t) {
var o = 0, n = e.toString(), a = t.toString();
try {
o += n.split(".")[1].length;
} catch (e) {}
try {
o += a.split(".")[1].length;
} catch (e) {}
return Number(n.replace(".", "")) * Number(a.replace(".", "")) / Math.pow(10, o);
},
add: function(e, t) {
var o, n, a;
try {
o = e.toString().split(".")[1].length;
} catch (e) {
o = 0;
}
try {
n = t.toString().split(".")[1].length;
} catch (e) {
n = 0;
}
return (e * (a = Math.pow(10, Math.max(o, n))) + t * a) / a;
},
sub: function(t, o) {
var n, a, i, r;
try {
n = t.toString().split(".")[1].length;
} catch (e) {
n = 0;
}
try {
a = o.toString().split(".")[1].length;
} catch (e) {
a = 0;
}
i = Math.pow(10, Math.max(n, a));
r = n >= a ? n : a;
return e.TNumber.numFixed((t * i - o * i) / i, r);
},
calculateVariance: function(e) {
var t = e.reduce(function(e, t) {
return e + t;
}, 0) / e.length;
return e.reduce(function(e, o) {
return e + Math.pow(o - t, 2);
}, 0) / (e.length - 1);
}
};
e.TUrl = {
getQueryString: function(e) {
var t = {}, o = e.split("?")[1];
if (o) for (var a = o.split("&"), i = 0; i < a.length; i++) {
var r = a[i].split("="), l = r[0], s = r[1];
t[l] = "";
try {
t[l] = decodeURIComponent(s || "");
} catch (e) {
n.default.error("getQueryString decodeURIComponent error", e);
}
}
return t;
},
setQueryString: function(e) {
var t = "", o = 0;
for (var n in e) {
t += 0 == o ? "?" + n + "=" + e[n] : "&" + n + "=" + e[n];
o++;
}
return encodeURI(t);
}
};
})(o.Tools || (o.Tools = {}));
cc._RF.pop();
}, {
"../../../platform/Platform": "Platform"
} ],
TotalResultItem: [ function(e, t, o) {
"use strict";
cc._RF.push(t, "eddfc0cdN5JZZQxeJi2qtK6", "TotalResultItem");
var n, a = this && this.__extends || (n = function(e, t) {
return (n = Object.setPrototypeOf || {
__proto__: []
} instanceof Array && function(e, t) {
e.__proto__ = t;
} || function(e, t) {
for (var o in t) Object.prototype.hasOwnProperty.call(t, o) && (e[o] = t[o]);
})(e, t);
}, function(e, t) {
n(e, t);
function o() {
this.constructor = e;
}
e.prototype = null === t ? Object.create(t) : (o.prototype = t.prototype, new o());
}), i = this && this.__decorate || function(e, t, o, n) {
var a, i = arguments.length, r = i < 3 ? t : null === n ? n = Object.getOwnPropertyDescriptor(t, o) : n;
if ("object" == typeof Reflect && "function" == typeof Reflect.decorate) r = Reflect.decorate(e, t, o, n); else for (var l = e.length - 1; l >= 0; l--) (a = e[l]) && (r = (i < 3 ? a(r) : i > 3 ? a(t, o, r) : a(t, o)) || r);
return i > 3 && r && Object.defineProperty(t, o, r), r;
};
Object.defineProperty(o, "__esModule", {
value: !0
});
var r = e("../../../../Game/client/global/enum/game/Game"), l = e("../../../../Game/client/global/enum/game/UIUtils"), s = e("../../../../Game/client/model/LanguageModel"), c = e("../../../../Game/fromework/global/Tools"), u = e("../../../../Game/fromework/mvvm/modelView/ViewModel"), d = cc._decorator, p = d.ccclass, h = d.property, f = function(e) {
a(t, e);
function t() {
var t = null !== e && e.apply(this, arguments) || this;
t.Background = null;
t.HeadImg = null;
t.UserName = null;
t.TotalScore = null;
t.WinColor = null;
t.LoseColor = null;
t.OtherMoney = null;
t.CashNode = null;
t.Cash = null;
t.GoldNode = null;
t.Gold = null;
t.BonusNode = null;
t.Bonus = null;
t.BackFrames = [];
t._data = null;
return t;
}
t.prototype.setLabelColor = function(e) {
this.UserName.node.color = e ? this.WinColor : this.LoseColor;
this.TotalScore.node.color = e ? this.WinColor : this.LoseColor;
this.OtherMoney.node.color = e ? this.WinColor : this.LoseColor;
this.Cash.node.color = e ? this.WinColor : this.LoseColor;
this.Gold.node.color = e ? this.WinColor : this.LoseColor;
this.Bonus.node.color = e ? this.WinColor : this.LoseColor;
this.Background.spriteFrame = e ? this.BackFrames[0] : this.BackFrames[1];
};
t.prototype.onItemInitCallFunc = function(e) {
this._data = e;
var t = e.userData;
t.head_url && "" != t.head_url && l.UIUtils.updateHeadImage(t.head_url, this.HeadImg, cc.size(103, 103));
this.setLabelColor(t.uid == u.VM.getValue("user.uid"));
var o = e.play, n = e.play ? e.play.base : 0, a = t.bonus ? t.bonus : 0;
this.UserName.string = t.name;
this.TotalScore.string = t.tscore + "";
this.OtherMoney.node.active = o.currency != r.GameEnum.MoneyType.CASH && o.currency != r.GameEnum.MoneyType.GOLD;
this.CashNode.active = o.currency == r.GameEnum.MoneyType.CASH;
this.GoldNode.active = o.currency == r.GameEnum.MoneyType.GOLD;
this.BonusNode.active = 0 != a;
if (9 == e.roomState) if (1 == t.res) {
this.OtherMoney.string = "+" + e.jackpot;
this.Cash.string = "+" + e.jackpot;
this.Gold.string = "+" + e.jackpot;
} else {
this.OtherMoney.string = "-" + c.Tools.TNumber.numFixed(parseFloat(n) - a, 2);
this.Cash.string = "-" + c.Tools.TNumber.numFixed(parseFloat(n) - a, 2);
this.Gold.string = "-" + c.Tools.TNumber.numFixed(parseFloat(n) - a, 2);
this.Bonus.string = "-" + c.Tools.TNumber.numFixed(a, 2);
} else if (0 == t.res || 1 == t.res) {
this.OtherMoney.string = s.default.getString("GAME_USER_STATE_PLAYING");
this.Cash.string = s.default.getString("GAME_USER_STATE_PLAYING");
this.Gold.string = s.default.getString("GAME_USER_STATE_PLAYING");
} else {
this.OtherMoney.string = "-" + c.Tools.TNumber.numFixed(parseFloat(n) - a, 2);
this.Cash.string = "-" + c.Tools.TNumber.numFixed(parseFloat(n) - a, 2);
this.Gold.string = "-" + c.Tools.TNumber.numFixed(parseFloat(n) - a, 2);
this.Bonus.string = "-" + c.Tools.TNumber.numFixed(a, 2);
}
};
t.prototype.onItemEnterCallFunc = function() {
this.node.opacity = 255;
};
t.prototype.onItemExitCallFunc = function() {
this.node.opacity = 0;
};
i([ h(cc.Sprite) ], t.prototype, "Background", void 0);
i([ h(cc.Sprite) ], t.prototype, "HeadImg", void 0);
i([ h(cc.Label) ], t.prototype, "UserName", void 0);
i([ h(cc.Label) ], t.prototype, "TotalScore", void 0);
i([ h(cc.Color) ], t.prototype, "WinColor", void 0);
i([ h(cc.Color) ], t.prototype, "LoseColor", void 0);
i([ h(cc.Label) ], t.prototype, "OtherMoney", void 0);
i([ h(cc.Node) ], t.prototype, "CashNode", void 0);
i([ h(cc.Label) ], t.prototype, "Cash", void 0);
i([ h(cc.Node) ], t.prototype, "GoldNode", void 0);
i([ h(cc.Label) ], t.prototype, "Gold", void 0);
i([ h(cc.Node) ], t.prototype, "BonusNode", void 0);
i([ h(cc.Label) ], t.prototype, "Bonus", void 0);
i([ h([ cc.SpriteFrame ]) ], t.prototype, "BackFrames", void 0);
return i([ p ], t);
}(cc.Component);
o.default = f;
cc._RF.pop();
}, {
"../../../../Game/client/global/enum/game/Game": "Game",
"../../../../Game/client/global/enum/game/UIUtils": "UIUtils",
"../../../../Game/client/model/LanguageModel": "LanguageModel",
"../../../../Game/fromework/global/Tools": "Tools",
"../../../../Game/fromework/mvvm/modelView/ViewModel": "ViewModel"
} ],
TotalResult: [ function(e, t, o) {
"use strict";
cc._RF.push(t, "87437eMAPlBGrJhKil6/cN2", "TotalResult");
var n, a = this && this.__extends || (n = function(e, t) {
return (n = Object.setPrototypeOf || {
__proto__: []
} instanceof Array && function(e, t) {
e.__proto__ = t;
} || function(e, t) {
for (var o in t) Object.prototype.hasOwnProperty.call(t, o) && (e[o] = t[o]);
})(e, t);
}, function(e, t) {
n(e, t);
function o() {
this.constructor = e;
}
e.prototype = null === t ? Object.create(t) : (o.prototype = t.prototype, new o());
}), i = this && this.__decorate || function(e, t, o, n) {
var a, i = arguments.length, r = i < 3 ? t : null === n ? n = Object.getOwnPropertyDescriptor(t, o) : n;
if ("object" == typeof Reflect && "function" == typeof Reflect.decorate) r = Reflect.decorate(e, t, o, n); else for (var l = e.length - 1; l >= 0; l--) (a = e[l]) && (r = (i < 3 ? a(r) : i > 3 ? a(t, o, r) : a(t, o)) || r);
return i > 3 && r && Object.defineProperty(t, o, r), r;
};
Object.defineProperty(o, "__esModule", {
value: !0
});
var r = e("../../../../fromework/component/listView/ListView"), l = e("../../../model/GameModel"), s = e("../../../model/LobbyModel"), c = cc._decorator, u = c.ccclass, d = c.property, p = function(e) {
a(t, e);
function t() {
var t = null !== e && e.apply(this, arguments) || this;
t.ListView = null;
t._model = null;
t._isSplit = !1;
t._callFunc = null;
t._continueCallfunc = null;
return t;
}
t.prototype._refreshView = function() {
var e = this, t = [], o = s.default.Instance.getGamePlay(this._model.roomData.rtype);
this._model.allUserData.userMap.forEach(function(n) {
var a = {};
if (e._isSplit) {
var i = e._model.splitDataMap.get(n.uid);
a.jackpot = i ? i.amount : 0;
} else a.jackpot = e._model.roomData.bonus;
a.roomState = e._model.optData.state;
a.userData = n;
a.play = o;
t.push(a);
});
this.ListView.datas = t;
};
t.prototype.show = function(e, t, o, n) {
if (1 != this._isSplit) {
this._model = e;
this._isSplit = t;
this._callFunc = o;
this._continueCallfunc = n;
this._refreshView();
var a = s.default.Instance.getGamePlay(e.roomData.rtype);
a && l.ScoreRecord.Instance.setRecord(a.cls, null);
}
};
t.prototype.close = function() {
if (this._callFunc) {
this._callFunc();
this._callFunc = null;
}
this._model = null;
this._isSplit = !1;
this.node.removeFromParent(!0);
this.node.destroy();
};
t.prototype.onContinueBtnClicked = function() {
if (this._continueCallfunc) {
this._continueCallfunc();
this._continueCallfunc = null;
this._model = null;
this._isSplit = !1;
this.node.removeFromParent(!0);
this.node.destroy();
} else this.close();
};
t.prototype.onCloseBtnClicked = function() {
this.close();
};
i([ d(r.default) ], t.prototype, "ListView", void 0);
return i([ u ], t);
}(cc.Component);
o.default = p;
cc._RF.pop();
}, {
"../../../../fromework/component/listView/ListView": "ListView",
"../../../model/GameModel": "GameModel",
"../../../model/LobbyModel": "LobbyModel"
} ],
TrackManager: [ function(e, t, o) {
"use strict";
cc._RF.push(t, "d83d7YUZqdBX6WhKXK446Zi", "TrackManager");
var n, a = this && this.__extends || (n = function(e, t) {
return (n = Object.setPrototypeOf || {
__proto__: []
} instanceof Array && function(e, t) {
e.__proto__ = t;
} || function(e, t) {
for (var o in t) Object.prototype.hasOwnProperty.call(t, o) && (e[o] = t[o]);
})(e, t);
}, function(e, t) {
n(e, t);
function o() {
this.constructor = e;
}
e.prototype = null === t ? Object.create(t) : (o.prototype = t.prototype, new o());
}), i = this && this.__decorate || function(e, t, o, n) {
var a, i = arguments.length, r = i < 3 ? t : null === n ? n = Object.getOwnPropertyDescriptor(t, o) : n;
if ("object" == typeof Reflect && "function" == typeof Reflect.decorate) r = Reflect.decorate(e, t, o, n); else for (var l = e.length - 1; l >= 0; l--) (a = e[l]) && (r = (i < 3 ? a(r) : i > 3 ? a(t, o, r) : a(t, o)) || r);
return i > 3 && r && Object.defineProperty(t, o, r), r;
};
Object.defineProperty(o, "__esModule", {
value: !0
});
var r = e("../../Game/client/global/enum/game/Const"), l = e("../../Game/fromework/helper/AudioHelper"), s = e("../Common/SlotConst"), c = e("../Common/SlotModel"), u = e("./Track"), d = cc._decorator, p = d.ccclass, h = d.property, f = function(e) {
a(t, e);
function t() {
var t = null !== e && e.apply(this, arguments) || this;
t.Tracks = [];
t.ScatterTrackEffect = null;
t._scatterSoundIndex = -1;
return t;
}
t.prototype.onLoad = function() {};
t.prototype.onDestroy = function() {};
t.prototype.init = function() {
this.Tracks.forEach(function(e) {
e.init();
});
};
t.prototype.playSpin = function(e, t) {
var o = this, n = c.default.Instance;
this.resetSlot();
var a = this.getScatterArray();
this.playScatterEffect(e, a);
for (var i = 0; i < this.Tracks.length; i++) {
var s = this.Tracks[i], u = n.roomData.show_card.cards[i], d = e ? .5 : .5 + .3 * i, p = a.indexOf(i);
0 == p ? d += 1 : p > 0 && (d = d + .8 * p + 1);
s.playSpin(d, e && p < 0, u);
}
var h = e ? .5 : .5 + .3 * (this.Tracks.length - 1), f = h;
a.length > 0 && (h += .8 * (a.length - 1) + 1);
h += .1;
this.scheduleOnce(function() {
if (o && o.node && o.node.isValid) {
if (-1 != o._scatterSoundIndex) {
l.default.Instance.stopEffect(o._scatterSoundIndex);
o._scatterSoundIndex = -1;
}
o.checkScatter();
t && t();
o.ScatterTrackEffect.node.active = !1;
o.unscheduleAllCallbacks();
}
}, h);
e && this.scheduleOnce(function() {
o && o.node && o.node.isValid && e && l.default.Instance.playBundleEffect(r.BundleSoundPath.slot_spin_stop);
}, f);
};
t.prototype.changeWildSlot = function() {
for (var e = c.default.Instance, t = c.default.Instance.getSlotConfigByType(1)[1].id, o = 0; o < e.userData.wild_step_info.highlight.length; o++) {
var n = e.userData.wild_step_info.highlight[o];
this.Tracks[n.x].changeWildSlotByIndex(n.y, t);
}
};
t.prototype.resetSlot = function() {
for (var e = 0; e < this.Tracks.length; e++) this.Tracks[e].resetSlot();
this.ScatterTrackEffect.node.active = !1;
this.unscheduleAllCallbacks();
};
t.prototype.getScatterArray = function() {
var e = c.default.Instance.roomData.show_card.scattr_info;
if (e.highlight.length < 2 || 2 == e.highlight.length && 4 == e.highlight[e.highlight.length - 1].x) return [];
for (var t = [], o = e.highlight[1].x + 1; o < s.TrackCount; o++) t.push(o);
return t;
};
t.prototype.checkScatter = function() {
c.default.Instance.roomData.show_card.scattr_info.highlight.length < 3 && this.Tracks.forEach(function(e) {
e.resetSlot();
});
};
t.prototype.playScatterEffect = function(e, t) {
var o = this;
if (!(t.length <= 0)) for (var n = function(n) {
var i = t[n], s = e ? .5 : .5 + .3 * (i - 1);
n > 0 && (s = s + .8 * (n - 1) + 1);
a.scheduleOnce(function() {
if (-1 != o._scatterSoundIndex) {
l.default.Instance.stopEffect(o._scatterSoundIndex);
o._scatterSoundIndex = -1;
}
o._scatterSoundIndex = l.default.Instance.playBundleEffect(r.BundleSoundPath.slot_scatter_track);
o.ScatterTrackEffect.node.active = !0;
o.ScatterTrackEffect.node.position = o.Tracks[i].node.position;
o.ScatterTrackEffect.setAnimation(0, "scattr_track", !0);
}, s);
}, a = this, i = 0; i < t.length; i++) n(i);
};
i([ h([ u.default ]) ], t.prototype, "Tracks", void 0);
i([ h(sp.Skeleton) ], t.prototype, "ScatterTrackEffect", void 0);
return i([ p ], t);
}(cc.Component);
o.default = f;
cc._RF.pop();
}, {
"../../Game/client/global/enum/game/Const": "Const",
"../../Game/fromework/helper/AudioHelper": "AudioHelper",
"../Common/SlotConst": "SlotConst",
"../Common/SlotModel": "SlotModel",
"./Track": "Track"
} ],
Track: [ function(e, t, o) {
"use strict";
cc._RF.push(t, "f0a54dzs9VKV7Vif9FNRlUY", "Track");
var n, a = this && this.__extends || (n = function(e, t) {
return (n = Object.setPrototypeOf || {
__proto__: []
} instanceof Array && function(e, t) {
e.__proto__ = t;
} || function(e, t) {
for (var o in t) Object.prototype.hasOwnProperty.call(t, o) && (e[o] = t[o]);
})(e, t);
}, function(e, t) {
n(e, t);
function o() {
this.constructor = e;
}
e.prototype = null === t ? Object.create(t) : (o.prototype = t.prototype, new o());
}), i = this && this.__decorate || function(e, t, o, n) {
var a, i = arguments.length, r = i < 3 ? t : null === n ? n = Object.getOwnPropertyDescriptor(t, o) : n;
if ("object" == typeof Reflect && "function" == typeof Reflect.decorate) r = Reflect.decorate(e, t, o, n); else for (var l = e.length - 1; l >= 0; l--) (a = e[l]) && (r = (i < 3 ? a(r) : i > 3 ? a(t, o, r) : a(t, o)) || r);
return i > 3 && r && Object.defineProperty(t, o, r), r;
};
Object.defineProperty(o, "__esModule", {
value: !0
});
var r = e("../../Game/client/global/enum/game/Const"), l = e("../../Game/fromework/helper/AudioHelper"), s = e("../../Game/fromework/helper/EventHelper"), c = e("../Common/SlotConst"), u = e("../Common/SlotModel"), d = e("./Slot"), p = cc._decorator, h = p.ccclass, f = p.property, _ = function(e) {
a(t, e);
function t() {
var t = null !== e && e.apply(this, arguments) || this;
t.Slot = null;
t.Track = null;
t._isMove = !1;
t._slots = [];
t._dataAry = [];
t._orgDataAry = [];
t._slotSize = null;
t._preMove = 0;
t._maxLength = 0;
t._runTime = 0;
t._maxTime = 1;
t._originalPos = [];
t._moveIndex = 0;
t._isFast = !1;
return t;
}
t.prototype.onLoad = function() {
s.default.Instance.Global.bind(c.SlotNetEvent.S2C_ENTER_ROOM, this.refreshIcon, this);
this._isMove = !1;
};
t.prototype.onDestroy = function() {
s.default.Instance.Global.unbind(c.SlotNetEvent.S2C_ENTER_ROOM, this.refreshIcon, this);
this._isMove = !1;
this._isFast = !1;
this._slots.length = 0;
};
t.prototype.update = function(e) {
this._isMove && this.move(e);
};
t.prototype.init = function() {
this.initItem();
};
t.prototype.playSpin = function(e, t, o) {
var n = Math.floor(20 * e);
this._isFast = t;
this._preMove = 0;
this._maxLength = this._slotSize.height * n;
this._runTime = 0;
this._moveIndex = 0;
this._maxTime = e;
this._orgDataAry = o;
this._dataAry.length = 0;
for (var a = 0, i = 0; i < n; i++) i >= n - 3 - 1 && i < n - 1 ? this._dataAry.push(o[a++]) : this._dataAry.push(u.default.Instance.getRandomSlotID());
this._isMove = !0;
};
t.prototype.resetSlot = function() {
for (var e = 0; e < this._slots.length; e++) {
this._slots[e].WinEffect.active = !1;
this._slots[e].Effect.node.active = !1;
this._slots[e].Icon.node.active = !0;
}
};
t.prototype.playSlotEffectByIndex = function(e) {
var t = this._slots[e + 1];
null != t && t.playEffect();
};
t.prototype.changeWildSlotByIndex = function(e, t) {
var o = this._slots[e + 1];
null != o && o.refreshByID(t);
};
t.prototype.initItem = function() {
for (var e = 0; e < c.SlotCount + 3; e++) {
var t = cc.instantiate(this.Slot);
t.parent = this.Track;
var o = t.getComponent(d.default);
this._slots.push(o);
}
this._slotSize = this._slots[0].node.getContentSize();
var n = -this._slotSize.height / 2;
for (e = 0; e < this._slots.length; e++) {
(o = this._slots[e]).node.x = 0;
o.node.y = n;
n += this._slotSize.height;
}
this._slots.sort(function(e, t) {
return e.node.y - t.node.y;
});
for (e = 0; e < this._slots.length; e++) {
o = this._slots[e];
this._originalPos.push(o.node.getPosition());
}
};
t.prototype.refreshIcon = function() {
for (var e = 0; e < this._slots.length; e++) {
var t = this._slots[e], o = u.default.Instance.getRandomSlotID();
t.refreshByID(o);
}
};
t.prototype.lightScatter = function() {
var e = u.default.Instance.roomData.show_card.scattr_info;
if (!(e.highlight.length < 2 || 2 == e.highlight.length && 4 == e.highlight[e.highlight.length - 1].x)) for (var t = 1; t < 4; t++) {
var o = this._slots[t], n = u.default.Instance.getSlotConfigByID(o.cid);
n && 2 == n.type && o.playEffect();
}
};
t.prototype.moveDown = function(e) {
var t = this;
!this._isFast && l.default.Instance.playBundleEffect(r.BundleSoundPath.slot_spin_stop);
cc.tween(this.node).by(.05, {
y: -30
}).delay(.03).by(.05, {
y: 30
}).call(function() {
t.lightScatter();
e && e();
}).start();
};
t.prototype.playAlign = function() {
this._slots.sort(function(e, t) {
return e.node.y - t.node.y;
});
for (var e = 0; e < this._slots.length; e++) this._slots[e].node.setPosition(this._originalPos[e]);
if (this._slots[1].cid != this._orgDataAry[0] || this._slots[2].cid != this._orgDataAry[1] || this._slots[3].cid != this._orgDataAry[2]) {
this._slots[1].refreshByID(this._orgDataAry[0]);
this._slots[2].refreshByID(this._orgDataAry[1]);
this._slots[3].refreshByID(this._orgDataAry[2]);
}
this.moveDown();
};
t.prototype.getMoveLength = function(e) {
this._runTime += e;
var t = this._runTime / this._maxTime * this._maxLength, o = t - this._preMove;
this._preMove = t;
return o;
};
t.prototype.move = function(e) {
for (var t = this.getMoveLength(e), o = 0; o < this._slots.length; o++) {
var n = this._slots[o];
n.node.y -= t;
if (n.node.y < -this._slotSize.height) {
this._moveIndex++;
var a = this._slots;
a.sort(function(e, t) {
return e.node.y - t.node.y;
});
n.node.y = a[a.length - 1].node.y + this._slotSize.height;
n.refreshByID(this._dataAry[this._moveIndex] || 3);
}
}
this._moveIndex >= this._dataAry.length && (this._isMove = !1);
this._isMove || this.playAlign();
};
i([ f(cc.Prefab) ], t.prototype, "Slot", void 0);
i([ f(cc.Node) ], t.prototype, "Track", void 0);
return i([ h ], t);
}(cc.Component);
o.default = _;
cc._RF.pop();
}, {
"../../Game/client/global/enum/game/Const": "Const",
"../../Game/fromework/helper/AudioHelper": "AudioHelper",
"../../Game/fromework/helper/EventHelper": "EventHelper",
"../Common/SlotConst": "SlotConst",
"../Common/SlotModel": "SlotModel",
"./Slot": "Slot"
} ],
TraditionABDealer: [ function(e, t, o) {
"use strict";
cc._RF.push(t, "584ad8S/4pFxpXkCWdDfwVM", "TraditionABDealer");
var n, a = this && this.__extends || (n = function(e, t) {
return (n = Object.setPrototypeOf || {
__proto__: []
} instanceof Array && function(e, t) {
e.__proto__ = t;
} || function(e, t) {
for (var o in t) Object.prototype.hasOwnProperty.call(t, o) && (e[o] = t[o]);
})(e, t);
}, function(e, t) {
n(e, t);
function o() {
this.constructor = e;
}
e.prototype = null === t ? Object.create(t) : (o.prototype = t.prototype, new o());
}), i = this && this.__decorate || function(e, t, o, n) {
var a, i = arguments.length, r = i < 3 ? t : null === n ? n = Object.getOwnPropertyDescriptor(t, o) : n;
if ("object" == typeof Reflect && "function" == typeof Reflect.decorate) r = Reflect.decorate(e, t, o, n); else for (var l = e.length - 1; l >= 0; l--) (a = e[l]) && (r = (i < 3 ? a(r) : i > 3 ? a(t, o, r) : a(t, o)) || r);
return i > 3 && r && Object.defineProperty(t, o, r), r;
};
Object.defineProperty(o, "__esModule", {
value: !0
});
var r = e("../../../Game/client/global/enum/game/Const"), l = e("../../../Game/client/global/enum/game/Event"), s = e("../../../Game/fromework/global/ResLoader"), c = e("../../../Game/fromework/helper/AudioHelper"), u = e("../../../Game/fromework/helper/EventHelper"), d = e("../../../platform/Platform"), p = e("../../Common/Component/CompositeCard"), h = e("../../Common/Utils/CompositeEvent"), f = e("../../Common/Utils/CompositeUtil"), _ = cc._decorator, m = _.ccclass, y = _.property, g = function(e) {
a(t, e);
function t() {
var t = null !== e && e.apply(this, arguments) || this;
t.Dealer = null;
t.CardParent = null;
t.OpenSlot = null;
t.AndarSlot = null;
t.BaharSlot = null;
t._openCard = null;
return t;
}
t.prototype.onEnable = function() {
u.default.Instance.Global.bind(h.CompositeGameEvent.GAME_RECONNECT, this.onEnterRoom, this);
u.default.Instance.Global.bind(l.GameEvent.S2C_AB_DEAL, this.onDealerOpenCard, this);
u.default.Instance.Global.bind(l.GameEvent.S2C_AB_SHOW, this.onDealer, this);
u.default.Instance.Global.bind(l.GameEvent.S2C_RESET, this.onReset, this);
};
t.prototype.onDisable = function() {
u.default.Instance.Global.unbind(h.CompositeGameEvent.GAME_RECONNECT, this.onEnterRoom, this);
u.default.Instance.Global.unbind(l.GameEvent.S2C_AB_DEAL, this.onDealerOpenCard, this);
u.default.Instance.Global.unbind(l.GameEvent.S2C_AB_SHOW, this.onDealer, this);
u.default.Instance.Global.unbind(l.GameEvent.S2C_RESET, this.onReset, this);
};
t.prototype.onLoad = function() {
cc.game.on(cc.game.EVENT_SHOW, this._onReset, this);
};
t.prototype.onDestroy = function() {
cc.game.off(cc.game.EVENT_SHOW, this._onReset, this);
};
t.prototype._onReset = function() {
this.node.stopAllActions();
this.CardParent.destroyAllChildren();
this.destroyOpenCard();
this.Dealer.children.forEach(function(e) {
e.active = !0;
});
};
t.prototype.destroyOpenCard = function() {
if (null != this._openCard) {
this._openCard.removeFromParent(!0);
this._openCard.destroy();
}
this._openCard = null;
};
t.prototype.createOpenCard = function() {
var e = this, t = f.default.Game.Model;
s.default.Instance.loadBundleRes(r.BundleUIPath.CompositeCard, cc.Prefab, function(o, n) {
if (o) d.default.log("TraditionABDealer Can Not Load CompositeCard!"); else {
e._openCard = cc.instantiate(n);
e._openCard.scale = .65;
e._openCard.active = !0;
e._openCard.parent = e.CardParent;
e._openCard.setPosition(e.OpenSlot.getPosition());
e._openCard.zIndex = 0;
e._openCard.getComponent(p.default).init(t.deal_card[0], !0);
}
});
};
t.prototype.onEnterRoom = function() {
var e = this, t = f.default.Game.Model;
this._onReset();
0 != t.deal_card.length && this.createOpenCard();
if (2 == t.roomData.state || 3 == t.roomData.state) {
null != t.show_card[0] && this.createCards(t.show_card[0], function(o) {
for (var n = 0 == t.show_card_index ? 0 : 1, a = 0; a < o.length; a++) {
var i = a % 2 == n, r = o[a];
r.node.active = !0;
r.node.scale = .65;
r.node.position = i ? e.AndarSlot.position : e.BaharSlot.position;
r.open = !0;
}
});
if (3 == t.roomData.state && null != t.show_card[1]) {
var o = t.show_card[1], n = 0, a = t.getCountDown() - 3;
a <= 0 ? n = o.length - 1 : (n = Math.floor(o.length - a / .5)) < 0 && (n = 0);
this.createCards(o, function(t) {
e.dealer(t, n);
});
}
}
};
t.prototype.onDealerOpenCard = function(e) {
var t = this, o = e.getUserData();
this.destroyOpenCard();
s.default.Instance.loadBundleRes(r.BundleUIPath.CompositeCard, cc.Prefab, function(e, n) {
if (e) d.default.log("TraditionABDealer Can Not Load CompositeCard!"); else {
t._openCard = cc.instantiate(n);
t._openCard.scale = .5;
t._openCard.parent = t.CardParent;
t._openCard.setPosition(t.Dealer.position);
t._openCard.zIndex = 0;
var a = t._openCard.getComponent(p.default);
a.init(o.wildCard, !0);
var i = t.OpenSlot.getPosition();
a.moveCard(.3, i, .65, .65, function() {
u.default.Instance.Global.emit(h.CompositeUIEvent.UI_PLAY_START_BET);
}, !0);
c.default.Instance.playBundleEffect(r.BundleSoundPath.common_discard);
}
});
};
t.prototype.dealer = function(e, t) {
var o = this;
void 0 === t && (t = 0);
for (var n = f.default.Game.Model, a = 0 == n.show_card_index ? 0 : 1, i = 0 != n.win_options.length, l = [], s = function(n) {
var s = e[n], f = n % 2 == a, _ = n == e.length - 1, m = f ? d.AndarSlot : d.BaharSlot;
if (!s || !s.node || !s.node.isValid) return "continue";
if (n < t) {
s.node.active = !0;
s.node.scale = .65;
s.node.position = f ? d.AndarSlot.position : d.BaharSlot.position;
s.open = !0;
s.showLightBorder(_ && i);
} else {
l.push(cc.callFunc(function() {
if (s.node && s.node.isValid) {
s.node.active = !0;
s.open = !0;
s.node.setPosition(o.Dealer.position);
var e = m.getPosition();
s.moveCard(.3, e, .65, .65, function() {}, !0);
c.default.Instance.playBundleEffect(r.BundleSoundPath.common_discard);
}
}));
_ || l.push(cc.delayTime(.5));
}
if (_ && i) {
l.push(cc.delayTime(.4));
l.push(cc.callFunc(function() {
s && s.showLightBorder(!0);
o._openCard && o._openCard.getComponent(p.default).showLightBorder(!0);
u.default.Instance.Global.emit(h.OddsEvent.ODDS_SHOW_WIN);
}));
l.push(cc.delayTime(2));
l.push(cc.callFunc(function() {
u.default.Instance.Global.emit(h.OddsEvent.ODDS_RECYCLING);
}));
}
}, d = this, _ = 0; _ < e.length; _++) s(_);
this.node.stopAllActions();
this.node.runAction(cc.sequence(l));
};
t.prototype.createCards = function(e, t) {
var o = this;
s.default.Instance.loadBundleRes(r.BundleUIPath.CompositeCard, cc.Prefab, function(n, a) {
if (n) d.default.log("TraditionABDealer Can Not Load CompositeCard!"); else {
for (var i = [], r = 0; r < e.length; r++) {
var l = cc.instantiate(a);
l.scale = .5;
l.active = !1;
l.parent = o.CardParent;
l.setPosition(o.Dealer.position);
l.zIndex = r;
var s = l.getComponent(p.default);
s.init(e[r], !1);
i.push(s);
}
t && t(i);
}
});
};
t.prototype.onDealer = function() {
var e = this, t = f.default.Game.Model, o = null != t.show_card[1] ? t.show_card[1] : t.show_card[0];
this.createCards(o, function(t) {
e.dealer(t, 0);
});
};
t.prototype.onReset = function() {
this._onReset();
};
i([ y(cc.Node) ], t.prototype, "Dealer", void 0);
i([ y(cc.Node) ], t.prototype, "CardParent", void 0);
i([ y(cc.Node) ], t.prototype, "OpenSlot", void 0);
i([ y(cc.Node) ], t.prototype, "AndarSlot", void 0);
i([ y(cc.Node) ], t.prototype, "BaharSlot", void 0);
return i([ m ], t);
}(cc.Component);
o.default = g;
cc._RF.pop();
}, {
"../../../Game/client/global/enum/game/Const": "Const",
"../../../Game/client/global/enum/game/Event": "Event",
"../../../Game/fromework/global/ResLoader": "ResLoader",
"../../../Game/fromework/helper/AudioHelper": "AudioHelper",
"../../../Game/fromework/helper/EventHelper": "EventHelper",
"../../../platform/Platform": "Platform",
"../../Common/Component/CompositeCard": "CompositeCard",
"../../Common/Utils/CompositeEvent": "CompositeEvent",
"../../Common/Utils/CompositeUtil": "CompositeUtil"
} ],
TraditionABEvent: [ function(e, t, o) {
"use strict";
cc._RF.push(t, "1f713XTshBGXrW/ElW+nU77", "TraditionABEvent");
Object.defineProperty(o, "__esModule", {
value: !0
});
o.TraditionABUIEvent = o.TraditionABGameEvent = o.TraditionABEvent = void 0;
o.TraditionABEvent = {
S2C_ENTER_ROOM: "S2C_ENTER_ROOM",
S2C_RESET: "S2C_RESET",
S2C_LEAVE: "S2C_LEAVE",
S2C_LEAVE_SINGLE: "S2C_LEAVE_SINGLE",
S2C_DISMISS_ROOM: "S2C_DISMISS_ROOM",
S2C_INTERACT: "S2C_INTERACT",
S2C_DEAL: "S2C_DEAL",
S2C_BET: "S2C_BET",
S2C_BET_BATCH: "S2C_BET_BATCH",
S2C_SHOW: "S2C_SHOW",
S2C_RANK: "S2C_RANK"
};
o.TraditionABGameEvent = {
GAME_RECONNECT: "GAME_RECONNECT"
};
o.TraditionABUIEvent = {
UI_EFFECT_START_BET: "UI_EFFECT_START_BET",
UI_EFFECT_STOP_BET: "UI_EFFECT_STOP_BET",
UI_MEMBER_COUNT_CHANGE: "UI_MEMBER_COUNT_CHANGE",
UI_PLAY_START_BET: "UI_PLAY_START_BET",
UI_PLAY_STOP_BET: "UI_PLAY_STOP_BET",
UI_PLAY_GOLD_DICE_EFF: "UI_PLAY_GOLD_DICE_EFF",
UI_HIDE_GOLD_DICE_EFF: "UI_HIDE_GOLD_DICE_EFF"
};
cc._RF.pop();
}, {} ],
TraditionABHelp: [ function(e, t, o) {
"use strict";
cc._RF.push(t, "1a7f6bISWFMUJemvsUS4ZwA", "TraditionABHelp");
var n, a = this && this.__extends || (n = function(e, t) {
return (n = Object.setPrototypeOf || {
__proto__: []
} instanceof Array && function(e, t) {
e.__proto__ = t;
} || function(e, t) {
for (var o in t) Object.prototype.hasOwnProperty.call(t, o) && (e[o] = t[o]);
})(e, t);
}, function(e, t) {
n(e, t);
function o() {
this.constructor = e;
}
e.prototype = null === t ? Object.create(t) : (o.prototype = t.prototype, new o());
}), i = this && this.__decorate || function(e, t, o, n) {
var a, i = arguments.length, r = i < 3 ? t : null === n ? n = Object.getOwnPropertyDescriptor(t, o) : n;
if ("object" == typeof Reflect && "function" == typeof Reflect.decorate) r = Reflect.decorate(e, t, o, n); else for (var l = e.length - 1; l >= 0; l--) (a = e[l]) && (r = (i < 3 ? a(r) : i > 3 ? a(t, o, r) : a(t, o)) || r);
return i > 3 && r && Object.defineProperty(t, o, r), r;
};
Object.defineProperty(o, "__esModule", {
value: !0
});
var r = e("../../Common/Utils/CompositeUtil"), l = cc._decorator, s = l.ccclass, c = l.property, u = function(e) {
a(t, e);
function t() {
var t = null !== e && e.apply(this, arguments) || this;
t.Rate = null;
return t;
}
t.prototype.onLoad = function() {
var e = r.default.Game.Model;
this.Rate.string = "Note: Winnings on the First Card drawn after each bet are " + 100 * e.bet_win_rate + "%";
};
i([ c(cc.Label) ], t.prototype, "Rate", void 0);
return i([ s ], t);
}(cc.Component);
o.default = u;
cc._RF.pop();
}, {
"../../Common/Utils/CompositeUtil": "CompositeUtil"
} ],
TraditionABModel: [ function(e, t, o) {
"use strict";
cc._RF.push(t, "04c97xZGRhO75U58OrjEWtT", "TraditionABModel");
var n, a = this && this.__extends || (n = function(e, t) {
return (n = Object.setPrototypeOf || {
__proto__: []
} instanceof Array && function(e, t) {
e.__proto__ = t;
} || function(e, t) {
for (var o in t) Object.prototype.hasOwnProperty.call(t, o) && (e[o] = t[o]);
})(e, t);
}, function(e, t) {
n(e, t);
function o() {
this.constructor = e;
}
e.prototype = null === t ? Object.create(t) : (o.prototype = t.prototype, new o());
});
Object.defineProperty(o, "__esModule", {
value: !0
});
o.TraditionABModel = void 0;
var i = e("../../../client/logic/game/HearBeat"), r = e("../../../client/model/ErrorModel"), l = e("../../../Game/fromework/helper/EventHelper"), s = e("../../../fromework/helper/NetHelper"), c = e("../../../Game/fromework/mvvm/modelView/ViewModel"), u = e("../../Common/Utils/CompositeProxy"), d = e("../../Common/Utils/CompositeStruct"), p = e("./TraditionABStruct"), h = e("../../../Game/fromework/global/Tools"), f = e("../../../Game/client/global/enum/net/S2C"), _ = e("../../../Game/client/global/enum/net/C2S"), m = e("../../../Game/client/global/enum/game/Game"), y = e("../../../Game/client/global/enum/game/Event"), g = function(e) {
a(t, e);
function t() {
var t = null !== e && e.apply(this, arguments) || this;
t.declearHistory = new p.TraditionABStruct.DeclearHistory();
t.show_card_index = 0;
t.bet_fee_currency = [];
t.bet_options = [];
t.allUserData = [];
t.bet_win_rate = .26;
return t;
}
Object.defineProperty(t, "Instance", {
get: function() {
t._instance || (t._instance = new t());
return t._instance;
},
enumerable: !1,
configurable: !0
});
t.prototype.clear = function() {
null != t._instance && (t._instance = null);
};
t.prototype.refreshUserData = function(e) {
var t = this;
this.allUserData.splice(0);
var o = Object.keys(e), n = c.VM.getValue("user.uid");
o.forEach(function(o) {
var a = new p.TraditionABStruct.UserData(e[o]);
if (o == n) {
t.refreshPlayerRecord(e[o].bet_record);
t.total_fee = h.Tools.TNumber.numFixed(h.Tools.TNumber.num2single(e[o].total_fee), 1);
}
t.allUserData.push(a);
});
};
t.prototype.getUserData = function(e) {
for (var t = 0; t < this.allUserData.length; t++) if (this.allUserData[t].uid == e) return this.allUserData[t];
return null;
};
t.prototype.getCompensationCash = function() {
for (var e = new Map(), t = 0; t < this.win_options.length; t++) {
var o = this.roomBetRecord[this.win_options[t]];
if (0 != o.amount) {
var n = this.bet_options[this.win_options[t]];
e.set(this.win_options[t], o.amount * (n.x - 1));
}
}
return e;
};
t.prototype.getWinFee = function(e) {
var t = new Map();
if (this.declearData.user_data.has(String(e))) for (var o = this.declearData.user_data.get(String(e)), n = 0; n < o.bet_record.length; n++) {
var a = o.bet_record[n];
if (0 != a.amount) {
var i = t.has(n) ? t.get(n) : 0, r = this.bet_options[n];
t.set(n, i + a.amount * r.x);
}
}
return t;
};
t._instance = null;
return t;
}(u.CompositeModel);
o.TraditionABModel = g;
var v = function(e) {
a(t, e);
function t() {
return null !== e && e.apply(this, arguments) || this;
}
Object.defineProperty(t, "Instance", {
get: function() {
t._instance || (t._instance = new t());
return t._instance;
},
enumerable: !1,
configurable: !0
});
t.prototype.Init = function() {
l.default.Instance.Net.bind(f.S2C.GAME.ROOM_ENTER_ROOM, this._onEnterRoom, this);
l.default.Instance.Net.bind(f.S2C.GAME.ROOM_SWITCH_ROOM, this._onSwitchRoom, this);
l.default.Instance.Net.bind(f.S2C.GAME.ROOM_DEAL, this._onDeal, this);
l.default.Instance.Net.bind(f.S2C.GAME.ROOM_START_BET, this._onStartBet, this);
l.default.Instance.Net.bind(f.S2C.GAME.ROOM_BET, this._onBet, this);
l.default.Instance.Net.bind(f.S2C.GAME.ROOM_BET_BATCH, this._onBetBatch, this);
l.default.Instance.Net.bind(f.S2C.GAME.ROOM_STOP_BET, this._onStopBet, this);
l.default.Instance.Net.bind(f.S2C.GAME.ROOM_SHOW, this._onShow, this);
l.default.Instance.Net.bind(f.S2C.GAME.ROOM_RESET_ROOM, this._onResetRoom, this);
l.default.Instance.Net.bind(f.S2C.GAME.ROOM_INTERACT, this._onInteract, this);
l.default.Instance.Net.bind(f.S2C.GAME.ROOM_RANK, this._onRank, this);
l.default.Instance.Net.bind(f.S2C.GAME.ROOM_LEAVE, this._onLeave, this);
l.default.Instance.Net.bind(f.S2C.GAME.ROOM_LEAVE_SINGLE, this._onLeaveSingle, this);
l.default.Instance.Net.bind(f.S2C.GAME.ROOM_DISMISS, this._onDismiss, this);
l.default.Instance.Net.bind(f.S2C.GAME.ROOM_SEND_AVAILABLE_BALANCE, this._onBalanceRefresh, this);
l.default.Instance.Global.bind(s.NetState.NET_WEBSOCKET_CONNECT_OPEN, this._onWsContented, this);
};
t.prototype.destory = function() {
l.default.Instance.Net.unbind(f.S2C.GAME.ROOM_ENTER_ROOM, this._onEnterRoom, this);
l.default.Instance.Net.unbind(f.S2C.GAME.ROOM_SWITCH_ROOM, this._onSwitchRoom, this);
l.default.Instance.Net.unbind(f.S2C.GAME.ROOM_DEAL, this._onDeal, this);
l.default.Instance.Net.unbind(f.S2C.GAME.ROOM_START_BET, this._onStartBet, this);
l.default.Instance.Net.unbind(f.S2C.GAME.ROOM_BET, this._onBet, this);
l.default.Instance.Net.unbind(f.S2C.GAME.ROOM_BET_BATCH, this._onBetBatch, this);
l.default.Instance.Net.unbind(f.S2C.GAME.ROOM_STOP_BET, this._onStopBet, this);
l.default.Instance.Net.unbind(f.S2C.GAME.ROOM_SHOW, this._onShow, this);
l.default.Instance.Net.unbind(f.S2C.GAME.ROOM_RESET_ROOM, this._onResetRoom, this);
l.default.Instance.Net.unbind(f.S2C.GAME.ROOM_INTERACT, this._onInteract, this);
l.default.Instance.Net.unbind(f.S2C.GAME.ROOM_RANK, this._onRank, this);
l.default.Instance.Net.unbind(f.S2C.GAME.ROOM_LEAVE, this._onLeave, this);
l.default.Instance.Net.unbind(f.S2C.GAME.ROOM_LEAVE_SINGLE, this._onLeaveSingle, this);
l.default.Instance.Net.unbind(f.S2C.GAME.ROOM_DISMISS, this._onDismiss, this);
l.default.Instance.Net.unbind(f.S2C.GAME.ROOM_SEND_AVAILABLE_BALANCE, this._onBalanceRefresh, this);
l.default.Instance.Global.unbind(s.NetState.NET_WEBSOCKET_CONNECT_OPEN, this._onWsContented, this);
};
t.prototype.clear = function() {};
t.prototype._onWsContented = function() {
i.default.Instance.begin();
var e = c.VM.getValue("lobby.roomID");
0 != e && this.sendEnterRoom(e);
};
Object.defineProperty(t.prototype, "roomID", {
get: function() {
return c.VM.getValue("lobby.roomID");
},
enumerable: !1,
configurable: !0
});
t.prototype.checkRoomID = function(e) {
return c.VM.getValue("lobby.roomID") == e;
};
t.prototype.checkRoomType = function(e) {
var t = e.split("_"), o = -1;
null != t && null != t[0] && (o = parseInt(t[0]));
return o == m.GameEnum.PlayType.GAME_TRADITION_AB;
};
t.prototype._onEnterRoom = function(t) {
var o = t.getUserData();
if (this.checkRoomID(o.rid)) {
var n = g.Instance;
if (null != o.user_data && o.uid == this.uid) {
n.bet_fee_currency = o.bet_fee_currency;
n.bet_options = o.bet_options;
n.declearHistory.refresh(o.declear_history);
null != o.bet_win_rate && (n.bet_win_rate = o.bet_win_rate);
n.show_card_index = o.show_card_index;
}
e.prototype._onEnterRoom.call(this, o, n);
l.default.Instance.Global.emit("TradABTotal", o.bet_data);
}
};
t.prototype._onSwitchRoom = function(e) {
var t = e.getUserData();
if (this.checkRoomType(t.room_type)) {
c.VM.getValue("lobby.roomID") != t.r && c.VM.setValue("lobby.roomID", parseInt(t.r));
l.default.Instance.Global.emit(y.GameEvent.S2C_SWITCH_ROOM, t.r);
}
};
t.prototype._onDeal = function(t) {
var o = t.getUserData();
if (this.checkRoomID(o.rid)) {
var n = g.Instance;
e.prototype._onDeal.call(this, o, n);
l.default.Instance.Global.emit("TradABTotalReset");
}
};
t.prototype._onStartBet = function(t) {
var o = t.getUserData();
if (this.checkRoomID(o.rid)) {
var n = g.Instance;
e.prototype._onStartBet.call(this, o, n);
}
};
t.prototype._onBet = function(t) {
var o = t.getUserData();
if (this.checkRoomID(o.rid)) {
var n = g.Instance, a = n.getUserData(o.bet_user.uid);
if (null != a) {
a.bet_status = o.bet_user.bet_status;
a.bet_record = d.CompositeStruct.getBetRecordArray(o.bet_user.bet_record);
}
e.prototype._onBet.call(this, o, n);
l.default.Instance.Global.emit("TradABTotal", o.bet_data);
}
};
t.prototype._onBetBatch = function(t) {
var o = t.getUserData();
if (this.checkRoomID(o.rid)) {
var n = g.Instance;
e.prototype._onBetBatch.call(this, o, n);
l.default.Instance.Global.emit("TradABTotal", o.bet_data);
}
};
t.prototype._onStopBet = function(t) {
var o = t.getUserData();
if (this.checkRoomID(o.rid)) {
var n = g.Instance;
n.refreshUserData(o.user_data);
e.prototype._onStopBet.call(this, o, n);
}
};
t.prototype._onShow = function(e) {
var t = e.getUserData();
if (this.checkRoomID(t.rid)) {
var o = g.Instance;
o.show_card_index = t.show_card_index;
if (t.win_options.length > 0) {
var n = new p.TraditionABStruct.HistoryData({
d: [ null != t.room_data.show_card[1] ? t.room_data.show_card[1].length : t.room_data.show_card[0].length ],
w: t.win_options
});
o.declearHistory.addHistory(n);
}
o.sTime = t.stime;
o.roomData.refresh(t.room_data);
o.deal_card = t.room_data.deal_card;
o.show_card = t.room_data.show_card;
o.refreshRoomRecord(t.bet_data);
o.refreshUserData(t.user_data);
o.win_options = t.win_options || [];
if (t.declear_data) {
o.declearData = new d.CompositeStruct.DeclearData();
o.declearData.refresh(t.declear_data);
} else o.declearData = null;
l.default.Instance.Global.emit(y.GameEvent.S2C_AB_SHOW);
}
};
t.prototype._onResetRoom = function(t) {
var o = t.getUserData();
if (this.checkRoomID(o.rid)) {
var n = g.Instance;
n.refreshUserData(o.user_data);
e.prototype._onResetRoom.call(this, o, n);
}
};
t.prototype._onInteract = function(t) {
var o = t.getUserData();
if (this.checkRoomID(o.rid)) {
var n = g.Instance;
e.prototype._onInteract.call(this, o, n);
}
};
t.prototype._onRank = function(t) {
var o = t.getUserData();
if (this.checkRoomID(o.rid)) {
var n = g.Instance;
e.prototype._onRank.call(this, o, n);
}
};
t.prototype._onLeave = function(t) {
var o = t.getUserData();
if (this.checkRoomID(o.rid)) {
var n = g.Instance;
e.prototype._onLeave.call(this, o, n);
}
};
t.prototype._onLeaveSingle = function(t) {
var o = t.getUserData();
if (this.checkRoomID(o.rid) || 0 == c.VM.getValue("lobby.roomID")) {
var n = g.Instance;
e.prototype._onLeaveSingle.call(this, o, n);
}
};
t.prototype._onDismiss = function(t) {
var o = t.getUserData();
if (this.checkRoomID(o.rid)) {
var n = g.Instance;
e.prototype._onDismiss.call(this, o, n);
}
};
t.prototype._onBalanceRefresh = function(t) {
var o = t.getUserData();
if (!this.checkRoomID(o.rid)) {
var n = g.Instance;
e.prototype._onBalanceRefresh.call(this, o, n);
}
};
t.prototype.sendEnterRoom = function(e, t) {
void 0 === t && (t = !0);
var o = s.default.Instance.makeMsg(_.C2S.ROOM_ENTER_ROOM, {
u: this.uid,
t: this.token,
r: e,
is_open: t
});
s.default.Instance.send(o);
};
t.prototype.sendBet = function(e, t) {
var o = h.Tools.TNumber.num2thousand(e);
r.default.Instance.CompositeBetNum = e;
var n = s.default.Instance.makeMsg(_.C2S.ROOM_BET, {
u: this.uid,
t: this.token,
r: this.roomID,
fee: o,
option: t
});
s.default.Instance.send(n);
};
t.prototype.sendInteract = function(e, t, o) {
var n;
n = o ? {
u: this.uid,
t: this.token,
r: this.roomID,
to_u: e,
opt_type: t,
opt_val: o
} : {
u: this.uid,
t: this.token,
r: this.roomID,
to_u: e,
opt_type: t
};
var a = s.default.Instance.makeMsg(_.C2S.ROOM_INTERACT, n);
s.default.Instance.send(a);
};
t.prototype.sendRank = function(e, t) {
var o = s.default.Instance.makeMsg(_.C2S.ROOM_RANK, {
u: this.uid,
t: this.token,
r: this.roomID,
page: e,
count: t
});
s.default.Instance.send(o);
};
t.prototype.sendLeave = function() {
var e = s.default.Instance.makeMsg(_.C2S.ROOM_LEAVE, {
u: this.uid,
t: this.token,
r: this.roomID
});
s.default.Instance.send(e);
};
t._instance = null;
return t;
}(u.CompositeProxy);
o.default = v;
cc._RF.pop();
}, {
"../../../Game/client/global/enum/game/Event": "Event",
"../../../Game/client/global/enum/game/Game": "Game",
"../../../Game/client/global/enum/net/C2S": "C2S",
"../../../Game/client/global/enum/net/S2C": "S2C",
"../../../Game/fromework/global/Tools": "Tools",
"../../../Game/fromework/helper/EventHelper": "EventHelper",
"../../../Game/fromework/mvvm/modelView/ViewModel": "ViewModel",
"../../../client/logic/game/HearBeat": "HearBeat",
"../../../client/model/ErrorModel": "ErrorModel",
"../../../fromework/helper/NetHelper": "NetHelper",
"../../Common/Utils/CompositeProxy": "CompositeProxy",
"../../Common/Utils/CompositeStruct": "CompositeStruct",
"./TraditionABStruct": "TraditionABStruct"
} ],
TraditionABOdds: [ function(e, t, o) {
"use strict";
cc._RF.push(t, "70de8+HxWVMJoQcdYHeAcZn", "TraditionABOdds");
var n, a = this && this.__extends || (n = function(e, t) {
return (n = Object.setPrototypeOf || {
__proto__: []
} instanceof Array && function(e, t) {
e.__proto__ = t;
} || function(e, t) {
for (var o in t) Object.prototype.hasOwnProperty.call(t, o) && (e[o] = t[o]);
})(e, t);
}, function(e, t) {
n(e, t);
function o() {
this.constructor = e;
}
e.prototype = null === t ? Object.create(t) : (o.prototype = t.prototype, new o());
}), i = this && this.__decorate || function(e, t, o, n) {
var a, i = arguments.length, r = i < 3 ? t : null === n ? n = Object.getOwnPropertyDescriptor(t, o) : n;
if ("object" == typeof Reflect && "function" == typeof Reflect.decorate) r = Reflect.decorate(e, t, o, n); else for (var l = e.length - 1; l >= 0; l--) (a = e[l]) && (r = (i < 3 ? a(r) : i > 3 ? a(t, o, r) : a(t, o)) || r);
return i > 3 && r && Object.defineProperty(t, o, r), r;
};
Object.defineProperty(o, "__esModule", {
value: !0
});
var r = e("../../../Game/fromework/helper/EventHelper"), l = e("../../Common/Utils/CompositeEvent"), s = e("../../Common/Utils/CompositeUtil"), c = cc._decorator, u = c.ccclass, d = c.property, p = function(e) {
a(t, e);
function t() {
var t = null !== e && e.apply(this, arguments) || this;
t.OddsValueLabel = null;
t.totalNum = null;
t.Index = 0;
return t;
}
t.prototype.onEnable = function() {
r.default.Instance.Global.bind(l.CompositeGameEvent.GAME_RECONNECT, this._refreshOddsRate, this);
r.default.Instance.Global.bind("TradABTotal", this._refreTotal, this);
r.default.Instance.Global.bind("TradABTotalReset", this.resetTotal, this);
};
t.prototype.onDisable = function() {
r.default.Instance.Global.unbind(l.CompositeGameEvent.GAME_RECONNECT, this._refreshOddsRate, this);
r.default.Instance.Global.unbind("TradABTotal", this._refreTotal, this);
r.default.Instance.Global.unbind("TradABTotalReset", this.resetTotal, this);
};
t.prototype._refreshOddsRate = function() {
var e = s.default.Game.Model.bet_options;
this.OddsValueLabel.string = e[this.Index].x + "X";
};
t.prototype._refreTotal = function(e) {
var t = this;
setTimeout(function() {
if (t.node.isValid) {
var o = e.getUserData();
o && o[t.Index] && o[t.Index].amount && (t.totalNum.string = "" + o[t.Index].amount / 1e3);
}
}, 500);
};
t.prototype.resetTotal = function() {
this.totalNum.string = "0";
};
i([ d(cc.Label) ], t.prototype, "OddsValueLabel", void 0);
i([ d(cc.Label) ], t.prototype, "totalNum", void 0);
i([ d(cc.Integer) ], t.prototype, "Index", void 0);
return i([ u ], t);
}(cc.Component);
o.default = p;
cc._RF.pop();
}, {
"../../../Game/fromework/helper/EventHelper": "EventHelper",
"../../Common/Utils/CompositeEvent": "CompositeEvent",
"../../Common/Utils/CompositeUtil": "CompositeUtil"
} ],
TraditionABRecordSmall: [ function(e, t, o) {
"use strict";
cc._RF.push(t, "02ba4RUzDpAc5t7xLl4RDd0", "TraditionABRecordSmall");
var n, a = this && this.__extends || (n = function(e, t) {
return (n = Object.setPrototypeOf || {
__proto__: []
} instanceof Array && function(e, t) {
e.__proto__ = t;
} || function(e, t) {
for (var o in t) Object.prototype.hasOwnProperty.call(t, o) && (e[o] = t[o]);
})(e, t);
}, function(e, t) {
n(e, t);
function o() {
this.constructor = e;
}
e.prototype = null === t ? Object.create(t) : (o.prototype = t.prototype, new o());
}), i = this && this.__decorate || function(e, t, o, n) {
var a, i = arguments.length, r = i < 3 ? t : null === n ? n = Object.getOwnPropertyDescriptor(t, o) : n;
if ("object" == typeof Reflect && "function" == typeof Reflect.decorate) r = Reflect.decorate(e, t, o, n); else for (var l = e.length - 1; l >= 0; l--) (a = e[l]) && (r = (i < 3 ? a(r) : i > 3 ? a(t, o, r) : a(t, o)) || r);
return i > 3 && r && Object.defineProperty(t, o, r), r;
};
Object.defineProperty(o, "__esModule", {
value: !0
});
var r = e("../../../Game/client/global/enum/game/Event"), l = e("../../../Game/fromework/helper/EventHelper"), s = e("../../Common/Utils/CompositeUtil"), c = cc._decorator, u = c.ccclass, d = c.property, p = function(e) {
a(t, e);
function t() {
var t = null !== e && e.apply(this, arguments) || this;
t.TopRecordParent = null;
t.TopRecordItem = null;
t.Frames_Item = [];
t.Light = null;
t.MaxCount = 18;
return t;
}
t.prototype.onEnable = function() {
l.default.Instance.Global.bind(r.GameEvent.S2C_ENTER_ROOM, this._onEnterRoom, this);
l.default.Instance.Global.bind(r.GameEvent.S2C_RESET, this._onResetRoom, this);
};
t.prototype.onDisable = function() {
l.default.Instance.Global.unbind(r.GameEvent.S2C_ENTER_ROOM, this._onEnterRoom, this);
l.default.Instance.Global.unbind(r.GameEvent.S2C_RESET, this._onResetRoom, this);
};
t.prototype.onLoad = function() {
this.refreshTopRecord(!1);
};
t.prototype._onEnterRoom = function() {
this.refreshTopRecord(!1);
};
t.prototype._onResetRoom = function() {
this.refreshTopRecord(!0);
};
t.prototype.refreshTopRecord = function(e) {
var t = this;
void 0 === e && (e = !1);
var o = s.default.Game.Model;
this.TopRecordParent.destroyAllChildren();
for (var n = o.declearHistory.getSimpleHistory(this.MaxCount), a = 0; a < n.length; a++) {
var i = n[a], r = cc.instantiate(this.TopRecordItem);
r.active = !0;
r.setPosition(cc.Vec2.ZERO);
r.parent = this.TopRecordParent;
r.getChildByName("Background").getComponent(cc.Sprite).spriteFrame = this.Frames_Item[0 == i.win[0] ? 0 : 1];
r.getChildByName("Points").getComponent(cc.Label).string = 0 == i.win[0] ? "A" : "B";
}
if (e && null != this.Light) {
this.TopRecordParent.getComponent(cc.Layout).updateLayout();
var l = this.TopRecordParent.children[this.TopRecordParent.children.length - 1], c = l.parent.convertToWorldSpaceAR(l.position), u = this.Light.node.parent.convertToNodeSpaceAR(c);
this.Light.node.position = u;
this.Light.node.active = !0;
this.Light.armatureName = "Armature";
this.Light.once(dragonBones.EventObject.COMPLETE, function() {
t.Light.node.active = !1;
}, this);
this.Light.playAnimation("animation_new_details", 1);
}
};
i([ d(cc.Node) ], t.prototype, "TopRecordParent", void 0);
i([ d(cc.Node) ], t.prototype, "TopRecordItem", void 0);
i([ d([ cc.SpriteFrame ]) ], t.prototype, "Frames_Item", void 0);
i([ d(dragonBones.ArmatureDisplay) ], t.prototype, "Light", void 0);
i([ d ], t.prototype, "MaxCount", void 0);
return i([ u ], t);
}(cc.Component);
o.default = p;
cc._RF.pop();
}, {
"../../../Game/client/global/enum/game/Event": "Event",
"../../../Game/fromework/helper/EventHelper": "EventHelper",
"../../Common/Utils/CompositeUtil": "CompositeUtil"
} ],
TraditionABRecord: [ function(e, t, o) {
"use strict";
cc._RF.push(t, "dc889/uvYdCnr+D5c8uVpIU", "TraditionABRecord");
var n, a = this && this.__extends || (n = function(e, t) {
return (n = Object.setPrototypeOf || {
__proto__: []
} instanceof Array && function(e, t) {
e.__proto__ = t;
} || function(e, t) {
for (var o in t) Object.prototype.hasOwnProperty.call(t, o) && (e[o] = t[o]);
})(e, t);
}, function(e, t) {
n(e, t);
function o() {
this.constructor = e;
}
e.prototype = null === t ? Object.create(t) : (o.prototype = t.prototype, new o());
}), i = this && this.__decorate || function(e, t, o, n) {
var a, i = arguments.length, r = i < 3 ? t : null === n ? n = Object.getOwnPropertyDescriptor(t, o) : n;
if ("object" == typeof Reflect && "function" == typeof Reflect.decorate) r = Reflect.decorate(e, t, o, n); else for (var l = e.length - 1; l >= 0; l--) (a = e[l]) && (r = (i < 3 ? a(r) : i > 3 ? a(t, o, r) : a(t, o)) || r);
return i > 3 && r && Object.defineProperty(t, o, r), r;
};
Object.defineProperty(o, "__esModule", {
value: !0
});
var r = e("../../../Game/fromework/helper/UIHelper"), l = e("../../Common/Utils/CompositeUtil"), s = cc._decorator, c = s.ccclass, u = s.property, d = function(e) {
a(t, e);
function t() {
var t = null !== e && e.apply(this, arguments) || this;
t.AndarWin = null;
t.BaharWin = null;
t.BottomContent = null;
t.BottomRecordParent = null;
t.BottomRecordItem = null;
t.Frames_Item = [];
return t;
}
t.prototype.onLoad = function() {
var e = l.default.Game.Model;
if (e) {
var t = e.declearHistory.getWinRate();
this.AndarWin.string = (100 * t.andar).toFixed(0) + "%";
this.BaharWin.string = (100 * t.bahar).toFixed(0) + "%";
} else {
this.AndarWin.string = "0%";
this.BaharWin.string = "0%";
}
this.refreshBottomRecord();
};
t.prototype.refreshBottomRecord = function() {
var e = l.default.Game.Model;
this.BottomRecordParent.destroyAllChildren();
for (var t = e.declearHistory.getComplexHistory(18), o = 0, n = 0; n < t.length; n++) {
var a = t[n], i = 27 + 54 * n;
a.length > o && (o = a.length);
for (var r = 0; r < a.length; r++) {
var s = a[r], c = -(27 + 54 * r), u = cc.instantiate(this.BottomRecordItem);
u.active = !0;
u.setPosition(cc.v2(i, c));
u.parent = this.BottomRecordParent;
u.getChildByName("Background").getComponent(cc.Sprite).spriteFrame = this.Frames_Item[0 == s.win[0] ? 0 : 1];
u.getChildByName("Points").getComponent(cc.Label).string = 0 == s.win[0] ? "A" : "B";
}
}
this.BottomContent.height = 54 * o;
};
t.prototype.onCloseClicked = function() {
r.default.Instance.removeMaskLayer(this.node, !0);
};
i([ u(cc.Label) ], t.prototype, "AndarWin", void 0);
i([ u(cc.Label) ], t.prototype, "BaharWin", void 0);
i([ u(cc.Node) ], t.prototype, "BottomContent", void 0);
i([ u(cc.Node) ], t.prototype, "BottomRecordParent", void 0);
i([ u(cc.Node) ], t.prototype, "BottomRecordItem", void 0);
i([ u([ cc.SpriteFrame ]) ], t.prototype, "Frames_Item", void 0);
return i([ c ], t);
}(cc.Component);
o.default = d;
cc._RF.pop();
}, {
"../../../Game/fromework/helper/UIHelper": "UIHelper",
"../../Common/Utils/CompositeUtil": "CompositeUtil"
} ],
TraditionABStruct: [ function(e, t, o) {
"use strict";
cc._RF.push(t, "b4cfcPMZHZHlq5pLnAiYXlt", "TraditionABStruct");
var n, a = this && this.__extends || (n = function(e, t) {
return (n = Object.setPrototypeOf || {
__proto__: []
} instanceof Array && function(e, t) {
e.__proto__ = t;
} || function(e, t) {
for (var o in t) Object.prototype.hasOwnProperty.call(t, o) && (e[o] = t[o]);
})(e, t);
}, function(e, t) {
n(e, t);
function o() {
this.constructor = e;
}
e.prototype = null === t ? Object.create(t) : (o.prototype = t.prototype, new o());
});
Object.defineProperty(o, "__esModule", {
value: !0
});
o.TraditionABStruct = void 0;
var i = e("../../Common/Utils/CompositeStruct");
(function(e) {
var t = function(e) {
a(t, e);
function t(t) {
var o = e.call(this) || this;
t && o.refresh(t);
return o;
}
t.prototype.refresh = function(t) {
e.prototype.refresh.call(this, t);
this.bet_status = t.bet_status;
this.bet_record = [];
this.bet_record = i.CompositeStruct.getBetRecordArray(t.bet_record);
};
return t;
}(i.CompositeStruct.UserData);
e.UserData = t;
var o = function() {
function e(e) {
this.count = 0;
this.win = [];
e && this.refresh(e);
}
e.prototype.refresh = function(e) {
this.count = e.d[0];
this.win = e.w;
};
return e;
}();
e.HistoryData = o;
var n = function() {
function e(e) {
this.historyArray = [];
e && this.refresh(e);
}
e.prototype.refresh = function(e) {
var t = this;
this.historyArray.splice(0);
e.forEach(function(e) {
var n = new o(e);
t.historyArray.push(n);
});
};
e.prototype.getWinRate = function() {
var e = 0, t = 0, o = 0;
this.historyArray.forEach(function(n) {
e++;
0 == n.win[0] ? t++ : o++;
});
return {
andar: t / e,
bahar: o / e
};
};
e.prototype.addHistory = function(e) {
100 == this.historyArray.length && this.historyArray.shift();
this.historyArray.push(e);
};
e.prototype.getSimpleHistory = function(e) {
for (var t = [], o = this.historyArray.length - 1; o >= 0; o--) {
var n = this.historyArray[o];
t.unshift(n);
if (t.length == e) break;
}
return t;
};
e.prototype.getComplexHistory = function(e) {
for (var t = [], o = -1, n = this.historyArray.length - 1; n >= 0; n--) {
var a = this.historyArray[n];
if (o != a.win[0]) {
if (t.length == e) break;
o = a.win[0];
t.unshift([]);
}
t[0].length != e && t[0].unshift(a);
}
return t;
};
return e;
}();
e.DeclearHistory = n;
})(o.TraditionABStruct || (o.TraditionABStruct = {}));
cc._RF.pop();
}, {
"../../Common/Utils/CompositeStruct": "CompositeStruct"
} ],
TraditionChipGenerator: [ function(e, t, o) {
"use strict";
cc._RF.push(t, "f9446ZzY8xNpom51jNxVOV1", "TraditionChipGenerator");
var n, a = this && this.__extends || (n = function(e, t) {
return (n = Object.setPrototypeOf || {
__proto__: []
} instanceof Array && function(e, t) {
e.__proto__ = t;
} || function(e, t) {
for (var o in t) Object.prototype.hasOwnProperty.call(t, o) && (e[o] = t[o]);
})(e, t);
}, function(e, t) {
n(e, t);
function o() {
this.constructor = e;
}
e.prototype = null === t ? Object.create(t) : (o.prototype = t.prototype, new o());
}), i = this && this.__decorate || function(e, t, o, n) {
var a, i = arguments.length, r = i < 3 ? t : null === n ? n = Object.getOwnPropertyDescriptor(t, o) : n;
if ("object" == typeof Reflect && "function" == typeof Reflect.decorate) r = Reflect.decorate(e, t, o, n); else for (var l = e.length - 1; l >= 0; l--) (a = e[l]) && (r = (i < 3 ? a(r) : i > 3 ? a(t, o, r) : a(t, o)) || r);
return i > 3 && r && Object.defineProperty(t, o, r), r;
}, r = this && this.__awaiter || function(e, t, o, n) {
return new (o || (o = Promise))(function(a, i) {
function r(e) {
try {
s(n.next(e));
} catch (e) {
i(e);
}
}
function l(e) {
try {
s(n.throw(e));
} catch (e) {
i(e);
}
}
function s(e) {
e.done ? a(e.value) : (t = e.value, t instanceof o ? t : new o(function(e) {
e(t);
})).then(r, l);
var t;
}
s((n = n.apply(e, t || [])).next());
});
}, l = this && this.__generator || function(e, t) {
var o, n, a, i, r = {
label: 0,
sent: function() {
if (1 & a[0]) throw a[1];
return a[1];
},
trys: [],
ops: []
};
return i = {
next: l(0),
throw: l(1),
return: l(2)
}, "function" == typeof Symbol && (i[Symbol.iterator] = function() {
return this;
}), i;
function l(e) {
return function(t) {
return s([ e, t ]);
};
}
function s(i) {
if (o) throw new TypeError("Generator is already executing.");
for (;r; ) try {
if (o = 1, n && (a = 2 & i[0] ? n.return : i[0] ? n.throw || ((a = n.return) && a.call(n), 
0) : n.next) && !(a = a.call(n, i[1])).done) return a;
(n = 0, a) && (i = [ 2 & i[0], a.value ]);
switch (i[0]) {
case 0:
case 1:
a = i;
break;

case 4:
r.label++;
return {
value: i[1],
done: !1
};

case 5:
r.label++;
n = i[1];
i = [ 0 ];
continue;

case 7:
i = r.ops.pop();
r.trys.pop();
continue;

default:
if (!(a = r.trys, a = a.length > 0 && a[a.length - 1]) && (6 === i[0] || 2 === i[0])) {
r = 0;
continue;
}
if (3 === i[0] && (!a || i[1] > a[0] && i[1] < a[3])) {
r.label = i[1];
break;
}
if (6 === i[0] && r.label < a[1]) {
r.label = a[1];
a = i;
break;
}
if (a && r.label < a[2]) {
r.label = a[2];
r.ops.push(i);
break;
}
a[2] && r.ops.pop();
r.trys.pop();
continue;
}
i = t.call(e, r);
} catch (e) {
i = [ 6, e ];
n = 0;
} finally {
o = a = 0;
}
if (5 & i[0]) throw i[1];
return {
value: i[0] ? i[1] : void 0,
done: !0
};
}
};
Object.defineProperty(o, "__esModule", {
value: !0
});
o.GeneratorVector = void 0;
var s = e("../../../Game/fromework/helper/EventHelper"), c = e("../../Common/Component/CompositeChipGold"), u = e("../../Common/Utils/CompositeEvent"), d = e("../../Common/Utils/CompositeUtil"), p = e("../../../Game/fromework/global/CachePool");
o.GeneratorVector = [ cc.v2(10, -10), cc.v2(-10, -10), cc.v2(10, 0), cc.v2(10, 10), cc.v2(-10, 0), cc.v2(-10, 10), cc.v2(10, 10), cc.v2(0, 10) ];
var h = cc._decorator, f = h.ccclass, _ = h.property, m = function(e) {
a(t, e);
function t() {
var t = null !== e && e.apply(this, arguments) || this;
t.ChitItem = null;
t.Target = null;
t.Frame = !0;
t.Duration = 8;
t.Index = 0;
return t;
}
t.prototype.init = function(e) {
this.Index = e;
};
t.prototype._tremble = function() {
cc.tween(this.Target).to(.05, {
x: o.GeneratorVector[this.Index].x,
y: o.GeneratorVector[this.Index].y
}).to(.05, {
x: 0,
y: 0
}).start();
};
t.prototype._chipIn = function(e, t, o) {
var n = p.CachePool.getInstance().getObj(p.CacheType.BET_COIN, cc.instantiate(this.ChitItem));
n.getComponent(c.default).reset(e, p.CacheType.BET_COIN);
n.angle = 360 * Math.random();
var a = n.getComponent(c.default);
n.parent = d.default.getChipLayer(!0);
n.position = this.node.parent.convertToWorldSpaceAR(this.node.position).sub(cc.v3(cc.winSize.width / 2, cc.winSize.height / 2, 0));
a.throw(t);
s.default.Instance.Global.emit(u.ChipGeneratorEvent.GENERATOR_ADDCHIP, {
index: o,
node: n
});
};
t.prototype._getItemGenerator = function(e) {
var t;
return l(this, function(o) {
switch (o.label) {
case 0:
t = 0;
o.label = 1;

case 1:
return t < e.length ? [ 4, this._chipIn(e[t].value, e[t].dest, e[t].index) ] : [ 3, 4 ];

case 2:
o.sent();
o.label = 3;

case 3:
++t;
return [ 3, 1 ];

case 4:
return [ 2 ];
}
});
};
t.prototype.executePreFrame = function(e, t) {
var o = this;
return new Promise(function(n) {
var a = e, i = function() {
for (var e = new Date().getTime(), r = a.next(); ;r = a.next()) {
if (null == r || r.done) {
n(null);
return;
}
if (new Date().getTime() - e > t) {
o.scheduleOnce(function() {
i();
});
return;
}
}
};
i();
});
};
t.prototype._doChipInAsync = function(e) {
return r(this, void 0, void 0, function() {
return l(this, function(t) {
switch (t.label) {
case 0:
return [ 4, this.executePreFrame(this._getItemGenerator(e), this.Duration) ];

case 1:
t.sent();
return [ 2 ];
}
});
});
};
t.prototype._doChipIn = function(e) {
var t = this;
e.forEach(function(e) {
t._chipIn(e.value, e.dest, e.index);
});
};
t.prototype.doChipIn = function(e) {
if (!(e.length <= 0)) {
this._tremble();
this.Frame ? this._doChipInAsync(e) : this._doChipIn(e);
}
};
t.prototype._onGeneratorBet = function(e) {
var t = e.getUserData();
t.index == this.Index && this.doChipIn(t.betData);
};
t.prototype.onEnable = function() {
s.default.Instance.Global.bind(u.ChipGeneratorEvent.GENERATOR_BET, this._onGeneratorBet, this);
};
t.prototype.onDisable = function() {
s.default.Instance.Global.unbind(u.ChipGeneratorEvent.GENERATOR_BET, this._onGeneratorBet, this);
};
t.prototype.onLoad = function() {};
t.prototype.start = function() {};
i([ _(cc.Prefab) ], t.prototype, "ChitItem", void 0);
i([ _(cc.Node) ], t.prototype, "Target", void 0);
i([ _({
tooltip: "是否分帧加载"
}) ], t.prototype, "Frame", void 0);
i([ _({
tooltip: "分配给每帧的时间，单位毫秒，仅在开启分帧加载时有用",
visible: function() {
return 0 != this.Frame;
}
}) ], t.prototype, "Duration", void 0);
i([ _ ], t.prototype, "Index", void 0);
return i([ f ], t);
}(cc.Component);
o.default = m;
cc._RF.pop();
}, {
"../../../Game/fromework/global/CachePool": "CachePool",
"../../../Game/fromework/helper/EventHelper": "EventHelper",
"../../Common/Component/CompositeChipGold": "CompositeChipGold",
"../../Common/Utils/CompositeEvent": "CompositeEvent",
"../../Common/Utils/CompositeUtil": "CompositeUtil"
} ],
TraditionChipManagerGold: [ function(e, t, o) {
"use strict";
cc._RF.push(t, "8829baaNC5OIazdFZJn/MON", "TraditionChipManagerGold");
var n, a = this && this.__extends || (n = function(e, t) {
return (n = Object.setPrototypeOf || {
__proto__: []
} instanceof Array && function(e, t) {
e.__proto__ = t;
} || function(e, t) {
for (var o in t) Object.prototype.hasOwnProperty.call(t, o) && (e[o] = t[o]);
})(e, t);
}, function(e, t) {
n(e, t);
function o() {
this.constructor = e;
}
e.prototype = null === t ? Object.create(t) : (o.prototype = t.prototype, new o());
}), i = this && this.__decorate || function(e, t, o, n) {
var a, i = arguments.length, r = i < 3 ? t : null === n ? n = Object.getOwnPropertyDescriptor(t, o) : n;
if ("object" == typeof Reflect && "function" == typeof Reflect.decorate) r = Reflect.decorate(e, t, o, n); else for (var l = e.length - 1; l >= 0; l--) (a = e[l]) && (r = (i < 3 ? a(r) : i > 3 ? a(t, o, r) : a(t, o)) || r);
return i > 3 && r && Object.defineProperty(t, o, r), r;
};
Object.defineProperty(o, "__esModule", {
value: !0
});
var r = e("../../../Game/client/global/enum/game/Event"), l = e("../../../Game/fromework/helper/EventHelper"), s = e("../../Common/Component/CompositeChipGold"), c = e("../../Common/Utils/CompositeConst"), u = e("../../Common/Utils/CompositeEvent"), d = e("../../Common/Utils/CompositeUtil"), p = e("../../../Game/fromework/global/CachePool"), h = e("../../../Game/client/global/enum/game/Const"), f = e("../../../Game/fromework/helper/AudioHelper"), _ = e("../../../platform/Platform"), m = cc._decorator, y = m.ccclass, g = m.property, v = function(e) {
a(t, e);
function t() {
var t = null !== e && e.apply(this, arguments) || this;
t.ChipPrefab = null;
t.ChipsLayer = null;
t.Banker = null;
t._chips = new Map();
return t;
}
t.prototype._getHarvest = function(e, t) {
for (var o = 0, n = 0, a = [], i = d.default.Game.Model.bet_fee_currency, r = i.length - 1; r >= 0; --r) a.push(i[r] / 1e3);
for (;n < a.length; ) if (e - a[n] >= 0) {
e -= a[n];
o += (Math.log2(a[n]) + 1) * (Math.sqrt(t - 1) + 1);
} else n++;
return o;
};
t.prototype._getDispense = function(e, t) {
return this._chips.get(e).length * Math.sqrt(t - 1);
};
t.prototype._init = function() {
for (var e = 0; e < 11; e++) this._chips.set(e, []);
};
t.prototype._onGameHide = function() {
this._clear();
this.unscheduleAllCallbacks();
};
t.prototype._addChip = function(e, t) {
this._chips.get(e).push(t);
};
t.prototype._clear = function() {
this._chips.forEach(function(e) {
e.forEach(function(e) {
if (e.isValid) {
e.stopAllActions();
e.removeFromParent(!0);
}
});
});
this._init();
};
t.prototype._refreshChips = function() {
var e = this;
this._clear();
var t = d.default.Game.Model;
if (2 == t.roomData.state || 3 == t.roomData.state) for (var o = t.roomBetRecord, n = function(t) {
var n = o[t];
n.detail.size > 0 && n.detail.forEach(function(o, n) {
for (var a = 0; a < o; a++) {
var i = p.CachePool.getInstance().getObj(p.CacheType.BET_COIN, cc.instantiate(e.ChipPrefab));
i.getComponent(s.default).reset(n / 1e3, p.CacheType.BET_COIN);
i.parent = e.ChipsLayer;
i.getComponent(s.default);
var r = d.default.getOddsManager().getPosInRect(t);
i.position = r;
i.angle = 360 * Math.random();
e._addChip(t, i);
}
});
}, a = 0; a < o.length; a++) n(a);
};
t.prototype._onGeneratorBet = function(e) {
var t = e.getUserData();
this._addChip(t.index, t.node);
};
t.prototype._onRecycling = function() {
var e = this, t = d.default.Game.Model.win_options, o = 0;
this._chips.forEach(function(n, a) {
for (var i = !1, r = 0; r < t.length; r++) a == t[r] && (i = !0);
if (!i) {
n.forEach(function(t) {
o++;
t.zIndex = 99;
t.getComponent(s.default).back(e.Banker.position, null, p.CacheType.BET_COIN);
});
e._chips.set(a, []);
}
});
o > 0 && f.default.Instance.playBundleEffect(h.BundleSoundPath.tp_chip_collect);
l.default.Instance.Global.emit(u.OddsEvent.ODDS_HIDE_WIN);
this.scheduleOnce(function() {
e && e.node && e.node.isValid && e._onDispense();
}, 1.2);
};
t.prototype._onDispense = function() {
var e = this, t = d.default.Game.Model.win_options, o = 0;
t.forEach(function(t) {
for (var n = e._getDispense(t, d.default.Game.Model.getOddsRate(t)), a = 0; a < n; a++) {
o++;
var i, r = d.default.Game.Model.bet_fee_currency, l = 100 * Math.random();
i = l < 20 ? r[0] : l < 40 ? r[1] : l < 50 ? r[2] : l < 60 ? r[3] : l < 70 ? r[4] : l < 75 ? r[5] : l < 82 ? r[6] : l < 92 ? r[7] : l < 97 ? r[8] : r[9];
var c = p.CachePool.getInstance().getObj(p.CacheType.BET_COIN, cc.instantiate(e.ChipPrefab));
c.getComponent(s.default).reset(i / 1e3, p.CacheType.BET_COIN);
c.parent = e.ChipsLayer;
var u = d.default.getOddsManager().getPosInRect(t);
_.default.log(u);
c.position = e.Banker.position;
c.angle = 360 * Math.random();
e._addChip(t, c);
c.getComponent(s.default).throw(u);
}
});
o > 0 && f.default.Instance.playBundleEffect(h.BundleSoundPath.tp_chip_collect);
this.scheduleOnce(function() {
e && e.node && e.node.isValid && e._harvest();
}, 1);
};
t.prototype._harvest = function() {
var e = this, t = d.default.Game.Model, o = 0;
t.allUserData.forEach(function(n) {
var a = t.getWinFee(n.uid), i = d.default.getGeneratorIndex(n.uid);
i = 7 == i ? 4 : i;
var r = c.TraditionHeadPosition[i];
a.forEach(function(n, a) {
for (var i = e._getHarvest(n, t.getOddsRate(a)), l = e._chips.get(a), c = 0; c < i && c < l.length; c++) {
var u = l[c];
o++;
u.getComponent(s.default).back(r, null, p.CacheType.BET_COIN);
l.splice(c, 1);
}
});
});
var n = c.TraditionHeadPosition[5];
this._chips.forEach(function(e) {
for (var t = 0; t < e.length; t++) {
o++;
e[t].getComponent(s.default).back(n, null, p.CacheType.BET_COIN);
}
});
o > 0 && f.default.Instance.playBundleEffect(h.BundleSoundPath.tp_chip_collect);
this.scheduleOnce(function() {
e._clear();
t.declearData.user_data.forEach(function(e, o) {
if (null != e.win_fee && 0 != e.win_fee) {
var n = {
index: d.default.getGeneratorIndex(parseInt(o)),
money: e.win_fee,
total: e.total_fee
}, a = t.getUserData(o);
null != a && (a.total_fee = e.total_fee);
l.default.Instance.Global.emit(u.UserEvent.USER_WIN_MONEY, n);
}
});
if (t.declearData && t.declearData.other && t.declearData.other.win_fee) {
var o = {
index: 6,
money: t.declearData.other.win_fee,
total: 0
};
l.default.Instance.Global.emit(u.UserEvent.USER_WIN_MONEY, o);
}
l.default.Instance.Global.emit("TREASURE_LIST_AB");
}, .5);
};
t.prototype._onReset = function() {
this.unscheduleAllCallbacks();
this._clear();
};
t.prototype.onEnable = function() {
l.default.Instance.Global.bind(u.CompositeGameEvent.GAME_RECONNECT, this._refreshChips, this);
l.default.Instance.Global.bind(u.ChipGeneratorEvent.GENERATOR_ADDCHIP, this._onGeneratorBet, this);
l.default.Instance.Global.bind(u.OddsEvent.ODDS_RECYCLING, this._onRecycling, this);
l.default.Instance.Global.bind(r.GameEvent.S2C_RESET, this._onReset, this);
};
t.prototype.onDisable = function() {
l.default.Instance.Global.unbind(u.CompositeGameEvent.GAME_RECONNECT, this._refreshChips, this);
l.default.Instance.Global.unbind(u.ChipGeneratorEvent.GENERATOR_ADDCHIP, this._onGeneratorBet, this);
l.default.Instance.Global.unbind(u.OddsEvent.ODDS_RECYCLING, this._onRecycling, this);
l.default.Instance.Global.unbind(r.GameEvent.S2C_RESET, this._onReset, this);
};
t.prototype.onLoad = function() {
this._init();
cc.game.on(cc.game.EVENT_HIDE, this._onGameHide, this);
};
t.prototype.onDestroy = function() {
this.unscheduleAllCallbacks();
};
i([ g(cc.Prefab) ], t.prototype, "ChipPrefab", void 0);
i([ g(cc.Node) ], t.prototype, "ChipsLayer", void 0);
i([ g(cc.Node) ], t.prototype, "Banker", void 0);
return i([ y ], t);
}(cc.Component);
o.default = v;
cc._RF.pop();
}, {
"../../../Game/client/global/enum/game/Const": "Const",
"../../../Game/client/global/enum/game/Event": "Event",
"../../../Game/fromework/global/CachePool": "CachePool",
"../../../Game/fromework/helper/AudioHelper": "AudioHelper",
"../../../Game/fromework/helper/EventHelper": "EventHelper",
"../../../platform/Platform": "Platform",
"../../Common/Component/CompositeChipGold": "CompositeChipGold",
"../../Common/Utils/CompositeConst": "CompositeConst",
"../../Common/Utils/CompositeEvent": "CompositeEvent",
"../../Common/Utils/CompositeUtil": "CompositeUtil"
} ],
TraditionChipManager: [ function(e, t, o) {
"use strict";
cc._RF.push(t, "838c5koU2pPt6P5QjoE4d5L", "TraditionChipManager");
var n, a = this && this.__extends || (n = function(e, t) {
return (n = Object.setPrototypeOf || {
__proto__: []
} instanceof Array && function(e, t) {
e.__proto__ = t;
} || function(e, t) {
for (var o in t) Object.prototype.hasOwnProperty.call(t, o) && (e[o] = t[o]);
})(e, t);
}, function(e, t) {
n(e, t);
function o() {
this.constructor = e;
}
e.prototype = null === t ? Object.create(t) : (o.prototype = t.prototype, new o());
}), i = this && this.__decorate || function(e, t, o, n) {
var a, i = arguments.length, r = i < 3 ? t : null === n ? n = Object.getOwnPropertyDescriptor(t, o) : n;
if ("object" == typeof Reflect && "function" == typeof Reflect.decorate) r = Reflect.decorate(e, t, o, n); else for (var l = e.length - 1; l >= 0; l--) (a = e[l]) && (r = (i < 3 ? a(r) : i > 3 ? a(t, o, r) : a(t, o)) || r);
return i > 3 && r && Object.defineProperty(t, o, r), r;
};
Object.defineProperty(o, "__esModule", {
value: !0
});
var r = e("../../../Game/client/global/enum/game/Event"), l = e("../../../Game/fromework/helper/AudioHelper"), s = e("../../../Game/fromework/helper/EventHelper"), c = e("../../Common/Utils/CompositeConst"), u = e("../../Common/Utils/CompositeEvent"), d = e("../../Common/Utils/CompositeUtil"), p = e("./TraditionChip"), h = e("../../../Game/fromework/global/CachePool"), f = e("../../../Game/client/global/enum/game/Const"), _ = e("../../../platform/Platform"), m = cc._decorator, y = m.ccclass, g = m.property, v = function(e) {
a(t, e);
function t() {
var t = null !== e && e.apply(this, arguments) || this;
t.ChipPrefab = null;
t.ChipsLayer = null;
t.Banker = null;
t._chips = new Map();
return t;
}
t.prototype._init = function() {
for (var e = 0; e < 11; e++) this._chips.set(e, []);
};
t.prototype._onGameHide = function() {
this._clear();
this.unscheduleAllCallbacks();
};
t.prototype._addChip = function(e, t) {
this._chips.get(e).push(t);
};
t.prototype._clear = function() {
this._chips.forEach(function(e) {
e.forEach(function(e) {
if (e.isValid) {
e.stopAllActions();
e.removeFromParent(!0);
}
});
});
this._init();
};
t.prototype._refreshChips = function() {
var e = this;
this._clear();
var t = d.default.Game.Model;
if (2 == t.roomData.state || 3 == t.roomData.state) for (var o = t.roomBetRecord, n = function(t) {
var n = o[t];
n.detail.size > 0 && n.detail.forEach(function(o, n) {
for (var a = 0; a < o; a++) {
var i = h.CachePool.getInstance().getObj(h.CacheType.BET_COIN, cc.instantiate(e.ChipPrefab));
i.parent = e.ChipsLayer;
i.getComponent(p.default).init(n / 1e3);
var r = d.default.getOddsManager().getPosInRect(t);
i.position = r;
i.angle = 360 * Math.random();
e._addChip(t, i);
}
});
}, a = 0; a < o.length; a++) n(a);
};
t.prototype._onGeneratorBet = function(e) {
var t = e.getUserData();
this._addChip(t.index, t.node);
};
t.prototype._onRecycling = function() {
var e = this, t = d.default.Game.Model.win_options, o = 0;
this._chips.forEach(function(n, a) {
for (var i = !1, r = 0; r < t.length; r++) a == t[r] && (i = !0);
if (!i) {
n.forEach(function(t) {
o++;
t.zIndex = 99;
t.getComponent(p.default).back(e.Banker.position);
});
e._chips.set(a, []);
}
});
o > 0 && l.default.Instance.playBundleEffect(f.BundleSoundPath.tp_chip_collect);
s.default.Instance.Global.emit(u.OddsEvent.ODDS_HIDE_WIN);
this.scheduleOnce(function() {
e && e.node && e.node.isValid && e._onDispense();
}, 1.2);
};
t.prototype._onDispense = function() {
var e = this, t = d.default.Game.Model.getCompensationCash(), o = 0;
t.forEach(function(t, n) {
var a = p.default.division(t);
_.default.log("区域:" + n + "|总数:" + t);
for (var i = 0; i < a.length; i++) {
o++;
var r = h.CachePool.getInstance().getObj(h.CacheType.BET_COIN, cc.instantiate(e.ChipPrefab));
r.parent = e.ChipsLayer;
r.angle = 360 * Math.random();
r.getComponent(p.default).init(a[i]);
_.default.log("筹码：" + a[i]);
var l = d.default.getOddsManager().getPosInRect(n);
_.default.log(l);
r.position = e.Banker.position;
e._addChip(n, r);
r.getComponent(p.default).throw(l);
}
});
o > 0 && l.default.Instance.playBundleEffect(f.BundleSoundPath.tp_chip_collect);
this.scheduleOnce(function() {
e && e.node && e.node.isValid && e._harvest();
}, .1);
};
t.prototype._harvest = function() {
var e = this, t = d.default.Game.Model, o = 0;
t.allUserData.forEach(function(n) {
var a = t.getWinFee(n.uid), i = d.default.getGeneratorIndex(n.uid), r = c.TraditionHeadPosition[i];
i = 7 == i ? 4 : i;
a.forEach(function(t, n) {
for (var a = p.default.division(t), i = 0; i < a.length; i++) for (var l = e._chips.get(n), s = 0; s < l.length; s++) {
var c = l[s];
if (c.getComponent(p.default).value == a[i]) {
o++;
c.getComponent(p.default).back(r);
l.splice(s, 1);
break;
}
}
});
});
var n = c.TraditionHeadPosition[5];
this._chips.forEach(function(e) {
for (var t = 0; t < e.length; t++) {
o++;
e[t].getComponent(p.default).back(n);
}
});
o > 0 && l.default.Instance.playBundleEffect(f.BundleSoundPath.tp_chip_collect);
this.scheduleOnce(function() {
e._clear();
t.declearData.user_data.forEach(function(e, o) {
if (null != e.win_fee && 0 != e.win_fee) {
var n = {
index: d.default.getGeneratorIndex(parseInt(o)),
money: e.win_fee,
total: e.total_fee
}, a = t.getUserData(o);
null != a && (a.total_fee = e.total_fee);
s.default.Instance.Global.emit(u.UserEvent.USER_WIN_MONEY, n);
}
});
if (t.declearData && t.declearData.other && t.declearData.other.win_fee) {
var o = {
index: 6,
money: t.declearData.other.win_fee,
total: 0
};
s.default.Instance.Global.emit(u.UserEvent.USER_WIN_MONEY, o);
}
}, .5);
};
t.prototype._onReset = function() {
this.unscheduleAllCallbacks();
this._clear();
};
t.prototype.onEnable = function() {
s.default.Instance.Global.bind(u.CompositeGameEvent.GAME_RECONNECT, this._refreshChips, this);
s.default.Instance.Global.bind(u.ChipGeneratorEvent.GENERATOR_ADDCHIP, this._onGeneratorBet, this);
s.default.Instance.Global.bind(u.OddsEvent.ODDS_RECYCLING, this._onRecycling, this);
s.default.Instance.Global.bind(r.GameEvent.S2C_RESET, this._onReset, this);
};
t.prototype.onDisable = function() {
s.default.Instance.Global.unbind(u.CompositeGameEvent.GAME_RECONNECT, this._refreshChips, this);
s.default.Instance.Global.unbind(u.ChipGeneratorEvent.GENERATOR_ADDCHIP, this._onGeneratorBet, this);
s.default.Instance.Global.unbind(u.OddsEvent.ODDS_RECYCLING, this._onRecycling, this);
s.default.Instance.Global.unbind(r.GameEvent.S2C_RESET, this._onReset, this);
};
t.prototype.onLoad = function() {
this._init();
cc.game.on(cc.game.EVENT_HIDE, this._onGameHide, this);
};
t.prototype.onDestroy = function() {
this.unscheduleAllCallbacks();
};
i([ g(cc.Prefab) ], t.prototype, "ChipPrefab", void 0);
i([ g(cc.Node) ], t.prototype, "ChipsLayer", void 0);
i([ g(cc.Node) ], t.prototype, "Banker", void 0);
return i([ y ], t);
}(cc.Component);
o.default = v;
cc._RF.pop();
}, {
"../../../Game/client/global/enum/game/Const": "Const",
"../../../Game/client/global/enum/game/Event": "Event",
"../../../Game/fromework/global/CachePool": "CachePool",
"../../../Game/fromework/helper/AudioHelper": "AudioHelper",
"../../../Game/fromework/helper/EventHelper": "EventHelper",
"../../../platform/Platform": "Platform",
"../../Common/Utils/CompositeConst": "CompositeConst",
"../../Common/Utils/CompositeEvent": "CompositeEvent",
"../../Common/Utils/CompositeUtil": "CompositeUtil",
"./TraditionChip": "TraditionChip"
} ],
TraditionChip: [ function(e, t, o) {
"use strict";
cc._RF.push(t, "b41abn3gl9DkLxpUWmgxqmN", "TraditionChip");
var n, a = this && this.__extends || (n = function(e, t) {
return (n = Object.setPrototypeOf || {
__proto__: []
} instanceof Array && function(e, t) {
e.__proto__ = t;
} || function(e, t) {
for (var o in t) Object.prototype.hasOwnProperty.call(t, o) && (e[o] = t[o]);
})(e, t);
}, function(e, t) {
n(e, t);
function o() {
this.constructor = e;
}
e.prototype = null === t ? Object.create(t) : (o.prototype = t.prototype, new o());
}), i = this && this.__decorate || function(e, t, o, n) {
var a, i = arguments.length, r = i < 3 ? t : null === n ? n = Object.getOwnPropertyDescriptor(t, o) : n;
if ("object" == typeof Reflect && "function" == typeof Reflect.decorate) r = Reflect.decorate(e, t, o, n); else for (var l = e.length - 1; l >= 0; l--) (a = e[l]) && (r = (i < 3 ? a(r) : i > 3 ? a(t, o, r) : a(t, o)) || r);
return i > 3 && r && Object.defineProperty(t, o, r), r;
};
Object.defineProperty(o, "__esModule", {
value: !0
});
var r = e("../../../Game/fromework/global/Tools"), l = cc._decorator, s = l.ccclass, c = l.property, u = function(e) {
a(t, e);
function t() {
var t = null !== e && e.apply(this, arguments) || this;
t.Chap_Icon = null;
t.Chap_1 = null;
t.Chap_2 = null;
t.Chap_4 = null;
t.Chap_5 = null;
t.Chap_8 = null;
t.Chap_10 = null;
t.Chap_16 = null;
t.Chap_20 = null;
t.Chap_32 = null;
t.Chap_40 = null;
t.Chap_64 = null;
t.Chap_80 = null;
t.Chap_128 = null;
t.Chap_160 = null;
t.Chap_256 = null;
t.Chap_320 = null;
t.Chap_512 = null;
t.Chap_640 = null;
t.Chap_1280 = null;
t.Chap_2560 = null;
t._ChapSpriteMap = null;
t._value = 0;
return t;
}
Object.defineProperty(t.prototype, "value", {
get: function() {
return this._value;
},
enumerable: !1,
configurable: !0
});
t.division = function(e) {
var t = [], o = [ 1, 2, 3, 5, 8, 10, 16, 20, 32, 40, 64, 80, 128, 160, 256, 320, 512, 640, 1280, 2560 ], n = 0;
e % o[o.length - 1] != 0 && t.push(o[o.length - 1]);
for (;n < o.length; ) if (e - o[n] >= 0) {
e -= o[n];
t.push(o[n]);
} else n++;
return t;
};
t.prototype.init = function(e) {
this.Chap_Icon.spriteFrame = this._ChapSpriteMap.get(1e3 * e);
this._value = e;
};
t.prototype.throw = function(e, t) {
var o = r.Tools.TNumber.randomFloat(.45, .6), n = e.sub(this.node.position).mag();
cc.tween(this.node).parallel(cc.tween(this.node).to(o, {
position: e
}, {
easing: "quadOut"
}).call(function() {
t && t();
}), cc.tween(this.node).by(o + .1, {
angle: Math.random() * (n / 30) * 20
}, {
easing: "quadOut"
})).start();
};
t.prototype.back = function(e, t) {
var o = r.Tools.TNumber.randomFloat(.45, .6);
cc.tween(this.node).to(o, {
position: e
}).call(function() {
t && t();
}).removeSelf().start();
};
t.prototype.onLoad = function() {
this._ChapSpriteMap = new Map([ [ 1e3, this.Chap_1 ], [ 2e3, this.Chap_2 ], [ 4e3, this.Chap_4 ], [ 5e3, this.Chap_5 ], [ 8e3, this.Chap_8 ], [ 1e4, this.Chap_10 ], [ 16e3, this.Chap_16 ], [ 2e4, this.Chap_20 ], [ 32e3, this.Chap_32 ], [ 4e4, this.Chap_40 ], [ 64e3, this.Chap_64 ], [ 8e4, this.Chap_80 ], [ 128e3, this.Chap_128 ], [ 16e4, this.Chap_160 ], [ 256e3, this.Chap_256 ], [ 32e4, this.Chap_320 ], [ 512e3, this.Chap_512 ], [ 64e4, this.Chap_640 ], [ 128e4, this.Chap_1280 ], [ 256e4, this.Chap_2560 ] ]);
};
t.prototype.start = function() {};
i([ c(cc.Sprite) ], t.prototype, "Chap_Icon", void 0);
i([ c(cc.SpriteFrame) ], t.prototype, "Chap_1", void 0);
i([ c(cc.SpriteFrame) ], t.prototype, "Chap_2", void 0);
i([ c(cc.SpriteFrame) ], t.prototype, "Chap_4", void 0);
i([ c(cc.SpriteFrame) ], t.prototype, "Chap_5", void 0);
i([ c(cc.SpriteFrame) ], t.prototype, "Chap_8", void 0);
i([ c(cc.SpriteFrame) ], t.prototype, "Chap_10", void 0);
i([ c(cc.SpriteFrame) ], t.prototype, "Chap_16", void 0);
i([ c(cc.SpriteFrame) ], t.prototype, "Chap_20", void 0);
i([ c(cc.SpriteFrame) ], t.prototype, "Chap_32", void 0);
i([ c(cc.SpriteFrame) ], t.prototype, "Chap_40", void 0);
i([ c(cc.SpriteFrame) ], t.prototype, "Chap_64", void 0);
i([ c(cc.SpriteFrame) ], t.prototype, "Chap_80", void 0);
i([ c(cc.SpriteFrame) ], t.prototype, "Chap_128", void 0);
i([ c(cc.SpriteFrame) ], t.prototype, "Chap_160", void 0);
i([ c(cc.SpriteFrame) ], t.prototype, "Chap_256", void 0);
i([ c(cc.SpriteFrame) ], t.prototype, "Chap_320", void 0);
i([ c(cc.SpriteFrame) ], t.prototype, "Chap_512", void 0);
i([ c(cc.SpriteFrame) ], t.prototype, "Chap_640", void 0);
i([ c(cc.SpriteFrame) ], t.prototype, "Chap_1280", void 0);
i([ c(cc.SpriteFrame) ], t.prototype, "Chap_2560", void 0);
return i([ s ], t);
}(cc.Component);
o.default = u;
cc._RF.pop();
}, {
"../../../Game/fromework/global/Tools": "Tools"
} ],
TraditionChooseBetChip: [ function(e, t, o) {
"use strict";
cc._RF.push(t, "5dd06aEyQxHGKm5wG4gR8OP", "TraditionChooseBetChip");
var n, a = this && this.__extends || (n = function(e, t) {
return (n = Object.setPrototypeOf || {
__proto__: []
} instanceof Array && function(e, t) {
e.__proto__ = t;
} || function(e, t) {
for (var o in t) Object.prototype.hasOwnProperty.call(t, o) && (e[o] = t[o]);
})(e, t);
}, function(e, t) {
n(e, t);
function o() {
this.constructor = e;
}
e.prototype = null === t ? Object.create(t) : (o.prototype = t.prototype, new o());
}), i = this && this.__decorate || function(e, t, o, n) {
var a, i = arguments.length, r = i < 3 ? t : null === n ? n = Object.getOwnPropertyDescriptor(t, o) : n;
if ("object" == typeof Reflect && "function" == typeof Reflect.decorate) r = Reflect.decorate(e, t, o, n); else for (var l = e.length - 1; l >= 0; l--) (a = e[l]) && (r = (i < 3 ? a(r) : i > 3 ? a(t, o, r) : a(t, o)) || r);
return i > 3 && r && Object.defineProperty(t, o, r), r;
};
Object.defineProperty(o, "__esModule", {
value: !0
});
var r = e("../../../Game/fromework/helper/EventHelper"), l = e("../../Common/Utils/CompositeEvent"), s = cc.color(204, 204, 204, 255), c = cc.color(255, 255, 255, 255), u = cc._decorator, d = u.ccclass, p = u.property, h = function(e) {
a(t, e);
function t() {
var t = null !== e && e.apply(this, arguments) || this;
t.Light = null;
t.Chap_Icon = null;
t._chipValue = 0;
t.Chap_1 = null;
t.Chap_2 = null;
t.Chap_4 = null;
t.Chap_5 = null;
t.Chap_8 = null;
t.Chap_10 = null;
t.Chap_16 = null;
t.Chap_20 = null;
t.Chap_32 = null;
t.Chap_40 = null;
t.Chap_64 = null;
t.Chap_80 = null;
t.Chap_128 = null;
t.Chap_160 = null;
t.Chap_256 = null;
t.Chap_320 = null;
t.Chap_512 = null;
t.Chap_640 = null;
t.Chap_1280 = null;
t.Chap_2560 = null;
return t;
}
Object.defineProperty(t.prototype, "ChipValue", {
get: function() {
return this._chipValue;
},
set: function(e) {
this._init(e);
},
enumerable: !1,
configurable: !0
});
t.prototype._init = function(e) {
this._chipValue = e;
this.Chap_Icon.spriteFrame = this["Chap_" + this._chipValue];
this.Chap_Icon.node.color = s;
};
t.prototype._onBetChip = function(e) {
var t = e.getUserData(), o = this.Light.node.active, n = this.Light.node.active = t == this.ChipValue;
this.Chap_Icon.node.color = t == this.ChipValue ? c : s;
o && !n ? cc.tween(this.node).by(.05, {
y: -15
}).start() : n && !o && cc.tween(this.node).by(.05, {
y: 15
}).start();
};
t.prototype.onClick = function() {
r.default.Instance.Global.emit(l.BetChipEvent.BET_CHIP_CLICK, this.ChipValue);
};
t.prototype.onEnable = function() {
r.default.Instance.Global.bind(l.BetChipEvent.BET_CHIP_CLICK, this._onBetChip, this);
};
t.prototype.onDisable = function() {
r.default.Instance.Global.unbind(l.BetChipEvent.BET_CHIP_CLICK, this._onBetChip, this);
};
t.prototype.onLoad = function() {};
t.prototype.start = function() {};
i([ p(cc.Sprite) ], t.prototype, "Light", void 0);
i([ p(cc.Sprite) ], t.prototype, "Chap_Icon", void 0);
i([ p ], t.prototype, "_chipValue", void 0);
i([ p ], t.prototype, "ChipValue", null);
i([ p(cc.SpriteFrame) ], t.prototype, "Chap_1", void 0);
i([ p(cc.SpriteFrame) ], t.prototype, "Chap_2", void 0);
i([ p(cc.SpriteFrame) ], t.prototype, "Chap_4", void 0);
i([ p(cc.SpriteFrame) ], t.prototype, "Chap_5", void 0);
i([ p(cc.SpriteFrame) ], t.prototype, "Chap_8", void 0);
i([ p(cc.SpriteFrame) ], t.prototype, "Chap_10", void 0);
i([ p(cc.SpriteFrame) ], t.prototype, "Chap_16", void 0);
i([ p(cc.SpriteFrame) ], t.prototype, "Chap_20", void 0);
i([ p(cc.SpriteFrame) ], t.prototype, "Chap_32", void 0);
i([ p(cc.SpriteFrame) ], t.prototype, "Chap_40", void 0);
i([ p(cc.SpriteFrame) ], t.prototype, "Chap_64", void 0);
i([ p(cc.SpriteFrame) ], t.prototype, "Chap_80", void 0);
i([ p(cc.SpriteFrame) ], t.prototype, "Chap_128", void 0);
i([ p(cc.SpriteFrame) ], t.prototype, "Chap_160", void 0);
i([ p(cc.SpriteFrame) ], t.prototype, "Chap_256", void 0);
i([ p(cc.SpriteFrame) ], t.prototype, "Chap_320", void 0);
i([ p(cc.SpriteFrame) ], t.prototype, "Chap_512", void 0);
i([ p(cc.SpriteFrame) ], t.prototype, "Chap_640", void 0);
i([ p(cc.SpriteFrame) ], t.prototype, "Chap_1280", void 0);
i([ p(cc.SpriteFrame) ], t.prototype, "Chap_2560", void 0);
return i([ d ], t);
}(cc.Component);
o.default = h;
cc._RF.pop();
}, {
"../../../Game/fromework/helper/EventHelper": "EventHelper",
"../../Common/Utils/CompositeEvent": "CompositeEvent"
} ],
TraditionGeneratorManager: [ function(e, t, o) {
"use strict";
cc._RF.push(t, "ac6c1YoKwhFv47CwmveyGBp", "TraditionGeneratorManager");
var n, a = this && this.__extends || (n = function(e, t) {
return (n = Object.setPrototypeOf || {
__proto__: []
} instanceof Array && function(e, t) {
e.__proto__ = t;
} || function(e, t) {
for (var o in t) Object.prototype.hasOwnProperty.call(t, o) && (e[o] = t[o]);
})(e, t);
}, function(e, t) {
n(e, t);
function o() {
this.constructor = e;
}
e.prototype = null === t ? Object.create(t) : (o.prototype = t.prototype, new o());
}), i = this && this.__decorate || function(e, t, o, n) {
var a, i = arguments.length, r = i < 3 ? t : null === n ? n = Object.getOwnPropertyDescriptor(t, o) : n;
if ("object" == typeof Reflect && "function" == typeof Reflect.decorate) r = Reflect.decorate(e, t, o, n); else for (var l = e.length - 1; l >= 0; l--) (a = e[l]) && (r = (i < 3 ? a(r) : i > 3 ? a(t, o, r) : a(t, o)) || r);
return i > 3 && r && Object.defineProperty(t, o, r), r;
};
Object.defineProperty(o, "__esModule", {
value: !0
});
var r = e("../../../Game/client/global/enum/game/Const"), l = e("../../../Game/client/global/enum/game/Event"), s = e("../../../Game/fromework/helper/AudioHelper"), c = e("../../../Game/fromework/helper/EventHelper"), u = e("../../../Game/fromework/mvvm/modelView/ViewModel"), d = e("../../Common/Utils/CompositeEvent"), p = e("../../Common/Utils/CompositeModel"), h = e("../../Common/Utils/CompositeUtil"), f = cc._decorator.ccclass, _ = function(e) {
a(t, e);
function t() {
return null !== e && e.apply(this, arguments) || this;
}
t.prototype._onGameHide = function() {
this.unscheduleAllCallbacks();
};
t.prototype._onBet = function(e) {
var t = this, o = e.getUserData(), n = o.uid == u.VM.getValue("user.uid");
o.bet_batch_data.forEach(function(e, a) {
e.detail.forEach(function(e, i) {
for (var l = 0, u = function() {
var e = {
index: 0,
betData: []
};
e.index = h.default.getGeneratorIndex(o.uid);
var u = h.default.getOddsManager().getPosInRect(a), f = new p.ChipDataStruct(i / 1e3, u, a);
e.betData.push(f);
t.scheduleOnce(function() {
c.default.Instance.Global.emit(d.ChipGeneratorEvent.GENERATOR_BET, e);
s.default.Instance.playBundleEffect(r.BundleSoundPath.common_chip);
}, l);
l += n ? 0 : .2;
}, f = 0; f < e; f++) u();
});
});
};
t.prototype._onBetBatch = function(e) {
var t = this;
e.getUserData().forEach(function(e, o) {
e.detail.forEach(function(e, n) {
var a = {
index: 0,
betData: []
};
a.index = 6;
for (var i = 0; i < e; i++) {
var l = h.default.getOddsManager().getPosInRect(o), u = new p.ChipDataStruct(n / 1e3, l, o);
a.betData.push(u);
}
t.scheduleOnce(function() {
c.default.Instance.Global.emit(d.ChipGeneratorEvent.GENERATOR_BET, a);
s.default.Instance.playBundleEffect(r.BundleSoundPath.common_chip);
}, Math.random());
});
});
};
t.prototype.onEnable = function() {
c.default.Instance.Global.bind(l.GameEvent.S2C_AB_BET, this._onBet, this);
c.default.Instance.Global.bind(l.GameEvent.S2C_AB_BET_BATCH, this._onBetBatch, this);
};
t.prototype.onDisable = function() {
c.default.Instance.Global.unbind(l.GameEvent.S2C_AB_BET, this._onBet, this);
c.default.Instance.Global.unbind(l.GameEvent.S2C_AB_BET_BATCH, this._onBetBatch, this);
};
t.prototype.onLoad = function() {
cc.game.on(cc.game.EVENT_HIDE, this._onGameHide, this);
};
t.prototype.start = function() {};
return i([ f ], t);
}(cc.Component);
o.default = _;
cc._RF.pop();
}, {
"../../../Game/client/global/enum/game/Const": "Const",
"../../../Game/client/global/enum/game/Event": "Event",
"../../../Game/fromework/helper/AudioHelper": "AudioHelper",
"../../../Game/fromework/helper/EventHelper": "EventHelper",
"../../../Game/fromework/mvvm/modelView/ViewModel": "ViewModel",
"../../Common/Utils/CompositeEvent": "CompositeEvent",
"../../Common/Utils/CompositeModel": "CompositeModel",
"../../Common/Utils/CompositeUtil": "CompositeUtil"
} ],
TraditionPlayerHeadManager: [ function(e, t, o) {
"use strict";
cc._RF.push(t, "8c53aMrvhNLY5G9kp91G96U", "TraditionPlayerHeadManager");
var n, a = this && this.__extends || (n = function(e, t) {
return (n = Object.setPrototypeOf || {
__proto__: []
} instanceof Array && function(e, t) {
e.__proto__ = t;
} || function(e, t) {
for (var o in t) Object.prototype.hasOwnProperty.call(t, o) && (e[o] = t[o]);
})(e, t);
}, function(e, t) {
n(e, t);
function o() {
this.constructor = e;
}
e.prototype = null === t ? Object.create(t) : (o.prototype = t.prototype, new o());
}), i = this && this.__decorate || function(e, t, o, n) {
var a, i = arguments.length, r = i < 3 ? t : null === n ? n = Object.getOwnPropertyDescriptor(t, o) : n;
if ("object" == typeof Reflect && "function" == typeof Reflect.decorate) r = Reflect.decorate(e, t, o, n); else for (var l = e.length - 1; l >= 0; l--) (a = e[l]) && (r = (i < 3 ? a(r) : i > 3 ? a(t, o, r) : a(t, o)) || r);
return i > 3 && r && Object.defineProperty(t, o, r), r;
};
Object.defineProperty(o, "__esModule", {
value: !0
});
var r = e("../../../Game/client/global/enum/game/Event"), l = e("../../../Game/fromework/mvvm/modelView/ViewModel"), s = e("../../Common/Component/CompositeWinMoney"), c = e("../../Common/Utils/CompositeConst"), u = e("../../Common/Utils/CompositeEvent"), d = e("../../Common/Utils/CompositeUtil"), p = e("./TraditionChipGenerator"), h = e("./TraditionPlayerHead"), f = e("../../../Game/fromework/helper/EventHelper"), _ = cc._decorator, m = _.ccclass, y = _.property, g = function(e) {
a(t, e);
function t() {
var t = null !== e && e.apply(this, arguments) || this;
t.PlayerHeadPrefab = null;
return t;
}
t.prototype.init = function() {
for (var e = c.TraditionHeadPosition, t = 0; t < e.length - 1; ++t) {
var o = cc.instantiate(this.PlayerHeadPrefab);
o.parent = this.node;
o.position = e[t];
var n = o.getComponent(h.default);
e.length - 2 == t && (t = 7);
n.init(t);
o.getComponent(p.default).init(t);
o.getComponentInChildren(s.default).init(t);
}
};
t.prototype._refreshPlayersHead = function() {
for (var e = d.default.Game.Model, t = 0; t < 4; t++) {
var o = {
type: 0,
index: t,
head: null
}, n = d.default.getGeneratorUserData(t);
if (null != n) {
o.type = n.label, o.index = n.seat, o.head = {
id: n.uid,
icon_url: n.head_url,
name: n.name,
money: n.total_fee,
state: n.bet_status,
andar: n.bet_record[0].amount,
bahar: n.bet_record[1].amount
};
f.default.Instance.Global.emit(u.UserEvent.USER_REFRESH_DATA, o);
}
}
var a = e.getUserData(l.VM.getValue("user.uid"));
if (null != a) {
(o = {
type: 0,
index: 7,
head: null
}).head = {
id: a.uid,
icon_url: a.head_url,
name: a.name,
money: a.total_fee,
state: a.bet_status,
andar: a.bet_record[0].amount,
bahar: a.bet_record[1].amount
};
f.default.Instance.Global.emit(u.UserEvent.USER_REFRESH_DATA, o);
}
};
t.prototype.onEnable = function() {
f.default.Instance.Global.bind(r.GameEvent.S2C_ENTER_ROOM, this._refreshPlayersHead, this);
f.default.Instance.Global.bind(r.GameEvent.S2C_RESET, this._refreshPlayersHead, this);
f.default.Instance.Global.bind(r.GameEvent.S2C_AB_BET, this._refreshPlayersHead, this);
f.default.Instance.Global.bind(r.GameEvent.S2C_AB_SHOW, this._refreshPlayersHead, this);
f.default.Instance.Global.bind(r.GameEvent.S2C_SEND_AVAILABLE_BALANCE, this._refreshPlayersHead, this);
f.default.Instance.Global.bind(u.CompositeGameEvent.UI_EFFECT_START_BET, this._refreshPlayersHead, this);
f.default.Instance.Global.bind(u.CompositeGameEvent.UI_EFFECT_STOP_BET, this._refreshPlayersHead, this);
};
t.prototype.onDisable = function() {
f.default.Instance.Global.unbind(r.GameEvent.S2C_ENTER_ROOM, this._refreshPlayersHead, this);
f.default.Instance.Global.unbind(r.GameEvent.S2C_RESET, this._refreshPlayersHead, this);
f.default.Instance.Global.unbind(r.GameEvent.S2C_AB_BET, this._refreshPlayersHead, this);
f.default.Instance.Global.unbind(r.GameEvent.S2C_AB_SHOW, this._refreshPlayersHead, this);
f.default.Instance.Global.unbind(r.GameEvent.S2C_SEND_AVAILABLE_BALANCE, this._refreshPlayersHead, this);
f.default.Instance.Global.unbind(u.CompositeGameEvent.UI_EFFECT_START_BET, this._refreshPlayersHead, this);
f.default.Instance.Global.unbind(u.CompositeGameEvent.UI_EFFECT_STOP_BET, this._refreshPlayersHead, this);
};
t.prototype.onLoad = function() {
this.init();
};
t.prototype.start = function() {};
i([ y(cc.Prefab) ], t.prototype, "PlayerHeadPrefab", void 0);
return i([ m ], t);
}(cc.Component);
o.default = g;
cc._RF.pop();
}, {
"../../../Game/client/global/enum/game/Event": "Event",
"../../../Game/fromework/helper/EventHelper": "EventHelper",
"../../../Game/fromework/mvvm/modelView/ViewModel": "ViewModel",
"../../Common/Component/CompositeWinMoney": "CompositeWinMoney",
"../../Common/Utils/CompositeConst": "CompositeConst",
"../../Common/Utils/CompositeEvent": "CompositeEvent",
"../../Common/Utils/CompositeUtil": "CompositeUtil",
"./TraditionChipGenerator": "TraditionChipGenerator",
"./TraditionPlayerHead": "TraditionPlayerHead"
} ],
TraditionPlayerHead: [ function(e, t, o) {
"use strict";
cc._RF.push(t, "bf31enjTPRDdrOjzvnYz4B5", "TraditionPlayerHead");
var n, a = this && this.__extends || (n = function(e, t) {
return (n = Object.setPrototypeOf || {
__proto__: []
} instanceof Array && function(e, t) {
e.__proto__ = t;
} || function(e, t) {
for (var o in t) Object.prototype.hasOwnProperty.call(t, o) && (e[o] = t[o]);
})(e, t);
}, function(e, t) {
n(e, t);
function o() {
this.constructor = e;
}
e.prototype = null === t ? Object.create(t) : (o.prototype = t.prototype, new o());
}), i = this && this.__decorate || function(e, t, o, n) {
var a, i = arguments.length, r = i < 3 ? t : null === n ? n = Object.getOwnPropertyDescriptor(t, o) : n;
if ("object" == typeof Reflect && "function" == typeof Reflect.decorate) r = Reflect.decorate(e, t, o, n); else for (var l = e.length - 1; l >= 0; l--) (a = e[l]) && (r = (i < 3 ? a(r) : i > 3 ? a(t, o, r) : a(t, o)) || r);
return i > 3 && r && Object.defineProperty(t, o, r), r;
};
Object.defineProperty(o, "__esModule", {
value: !0
});
var r = e("../../../Game/fromework/global/Tools"), l = e("../../../Game/fromework/helper/EventHelper"), s = e("../../Common/Utils/CompositeConst"), c = e("../../Common/Utils/CompositeEvent"), u = e("../../Common/Utils/CompositeUtil"), d = e("../../../Game/client/global/enum/game/UIUtils"), p = e("../../../Game/client/logic/game/GameHelper"), h = cc._decorator, f = h.ccclass, _ = h.property, m = function(e) {
a(t, e);
function t() {
var t = null !== e && e.apply(this, arguments) || this;
t.Icon_Empty = null;
t.Node_Bet = null;
t.Node_Name = null;
t.Node_Money = null;
t.Node_Self_BG = null;
t.Money_Node_A = null;
t.Money_Node_B = null;
t.Node_Countdown_Mask = null;
t.Node_Betted = null;
t.Node_Skip = null;
t.Node_Countdown_BG = null;
t.Label_Countdown_Value = null;
t.Node_Light = null;
t.Node_Win = null;
t.Icon_Image = null;
t.Name_Text = null;
t.Money_Value_Self = null;
t.Money_Value_A = null;
t.Money_Value_B = null;
t.SpriteFrame_Man = null;
t.SpriteFrame_Woman = null;
t._index = 0;
t._icon_url = "";
t._state = 0;
t._counting = !1;
t._countdownID = -1;
return t;
}
Object.defineProperty(t.prototype, "Index", {
get: function() {
return this._index;
},
set: function(e) {
this._index = e;
this._empty();
},
enumerable: !1,
configurable: !0
});
t.prototype.init = function(e) {
this.Index = e;
this._counting = !1;
};
t.prototype._onGameHide = function() {
this.unscheduleAllCallbacks();
this._hideCountDown();
};
t.prototype._empty = function() {
this._refreshSelfBG();
this.Node_Name.active = !1;
this.Node_Money.active = !1;
this.Node_Self_BG.active = !1;
this.Icon_Empty.active = !0;
this.Icon_Image.spriteFrame = null;
this.Icon_Image.node.active = !1;
this.Node_Bet.active = !1;
this.Node_Win.active = !1;
this.Money_Node_A.active = !1;
this.Money_Node_B.active = !1;
this.Name_Text.string = "";
this.Money_Value_Self.string = "";
this.Money_Value_A.string = "";
this.Money_Value_B.string = "";
};
t.prototype._refreshSelfBG = function() {
this.Node_Self_BG.active = this.Index == s.TRADITION_PLAYER_SELF;
};
t.prototype._refreshIcon = function(e, t) {
var o = this, n = !t || 1 == t;
if (null == e) {
this._icon_url = null;
this.Icon_Image.node.active = !1;
this.Icon_Empty.active = !0;
this.Icon_Image.spriteFrame = n ? this.SpriteFrame_Man : this.SpriteFrame_Woman;
this.Icon_Image.node.width = 100;
this.Icon_Image.node.height = 100;
} else if ("" == e) {
this._icon_url = "";
this.Icon_Image.node.active = !0;
this.Icon_Empty.active = !1;
this.Icon_Image.spriteFrame = n ? this.SpriteFrame_Man : this.SpriteFrame_Woman;
this.Icon_Image.node.width = 100;
this.Icon_Image.node.height = 100;
} else if (this._icon_url != e) {
this._icon_url = e;
d.UIUtils.updateHeadImage(e, this.Icon_Image, cc.size(100, 100), function(e) {
if (o && o.Icon_Image && o.Icon_Image.isValid) {
o.Icon_Image.node.active = e;
o.Icon_Empty.active = !e;
}
});
}
};
t.prototype._refreshName = function(e) {
this.Node_Name.active = !0;
this.Name_Text.string = r.Tools.TStr.ellipsisString(e, 12);
};
t.prototype._refreshMoney = function(e) {
this.Node_Money.active = !0;
this.Money_Value_Self.string = "" + r.Tools.TNumber.numFixed(e, 1);
};
t.prototype._refreshBetValue = function(e, t) {
this.Node_Bet.active = !0;
if (e > 0) {
this.Money_Node_A.active = !0;
this.Money_Value_A.string = "" + e;
} else this.Money_Node_A.active = !1;
if (t > 0) {
this.Money_Node_B.active = !0;
this.Money_Value_B.string = "" + t;
} else this.Money_Node_B.active = !1;
};
t.prototype._refreshBetState = function(e) {
this._state = e;
this.Node_Betted.active = 1 == this._state;
this.Node_Skip.active = 2 == this._state;
if (0 != this._state) {
this._hideCountDown();
this._stopCountDown();
}
};
t.prototype._showCountDown = function() {
var e = this;
if (2 != this._state && !this._counting) {
this._counting = !0;
var t = u.default.Game.Model.getCountDown();
t--;
this.Node_Countdown_BG.active = !0;
this.Label_Countdown_Value.string = t + "";
this.Node_Countdown_Mask.node.active = !0;
this.Node_Countdown_Mask.progress = 1;
this.Node_Light.active = !0;
this.Node_Light.opacity = 0;
this._countdownID = p.Countdown.creat(t, function() {
e._stopCountDown();
}, function(o) {
if (e && e.Label_Countdown_Value && e.Label_Countdown_Value.node.isValid && t >= 0) {
e.Label_Countdown_Value.string = o + "";
cc.tween(e.Node_Light).to(.5, {
opacity: 255
}).to(.5, {
opacity: 0
}).start();
cc.tween(e.Node_Countdown_Mask).to(1, {
progress: (o - 1) / t
}).start();
}
}, this);
}
};
t.prototype._stopCountDown = function() {
this._counting = !1;
if (this && this.Label_Countdown_Value && this.Label_Countdown_Value.node.isValid) {
this.Label_Countdown_Value.string = "0";
this.Node_Light.stopAllActions();
this.Node_Light.opacity = 0;
this.Node_Light.active = !1;
this.Node_Countdown_Mask.node.stopAllActions();
this.Node_Countdown_Mask.progress = 0;
this.Node_Countdown_Mask.node.active = !1;
}
};
t.prototype._hideCountDown = function() {
this.Node_Countdown_BG.active = !1;
if (-1 != this._countdownID) {
p.Countdown.deleta(this._countdownID);
this._countdownID = -1;
}
};
t.prototype._refreshHead = function(e) {
this._refreshName(e.name);
this._refreshMoney(e.money);
this._refreshBetState(e.state);
this._refreshBetValue(e.andar, e.bahar);
this._refreshSelfBG();
this._refreshIcon(e.icon_url, e.sex);
};
t.prototype._onUserDataRefresh = function(e) {
var t = e.getUserData();
if (t.index == this.Index) {
if (!t.head) {
this._empty();
return;
}
this._refreshHead(t.head);
}
};
t.prototype._onUserWin = function(e) {
var t = this, o = e.getUserData();
if (o.index == this.Index && 0 != o.money) {
this._refreshMoney(o.total);
this.Node_Win.active = !0;
cc.tween(this.Node_Win).to(.15, {
opacity: 255
}).delay(.7).to(.15, {
opacity: 0
}).call(function() {
t.Node_Win.opacity = 0;
t.Node_Win.active = !1;
}).start();
}
};
t.prototype.onEnable = function() {
l.default.Instance.Global.bind(c.UserEvent.USER_REFRESH_DATA, this._onUserDataRefresh, this);
l.default.Instance.Global.bind(c.UserEvent.USER_WIN_MONEY, this._onUserWin, this);
l.default.Instance.Global.bind(c.UserEvent.USER_SHOW_COUNTDOWN, this._showCountDown, this);
l.default.Instance.Global.bind(c.UserEvent.USER_HIDE_COUNTDOWN, this._hideCountDown, this);
};
t.prototype.onDisable = function() {
l.default.Instance.Global.unbind(c.UserEvent.USER_REFRESH_DATA, this._onUserDataRefresh, this);
l.default.Instance.Global.unbind(c.UserEvent.USER_WIN_MONEY, this._onUserWin, this);
l.default.Instance.Global.unbind(c.UserEvent.USER_SHOW_COUNTDOWN, this._showCountDown, this);
l.default.Instance.Global.unbind(c.UserEvent.USER_HIDE_COUNTDOWN, this._hideCountDown, this);
};
t.prototype.onLoad = function() {
cc.game.on(cc.game.EVENT_HIDE, this._onGameHide, this);
};
t.prototype.start = function() {};
t.prototype.onDestroy = function() {
this._hideCountDown();
};
i([ _(cc.Node) ], t.prototype, "Icon_Empty", void 0);
i([ _(cc.Node) ], t.prototype, "Node_Bet", void 0);
i([ _(cc.Node) ], t.prototype, "Node_Name", void 0);
i([ _(cc.Node) ], t.prototype, "Node_Money", void 0);
i([ _(cc.Node) ], t.prototype, "Node_Self_BG", void 0);
i([ _(cc.Node) ], t.prototype, "Money_Node_A", void 0);
i([ _(cc.Node) ], t.prototype, "Money_Node_B", void 0);
i([ _(cc.ProgressBar) ], t.prototype, "Node_Countdown_Mask", void 0);
i([ _(cc.Node) ], t.prototype, "Node_Betted", void 0);
i([ _(cc.Node) ], t.prototype, "Node_Skip", void 0);
i([ _(cc.Node) ], t.prototype, "Node_Countdown_BG", void 0);
i([ _(cc.Label) ], t.prototype, "Label_Countdown_Value", void 0);
i([ _(cc.Node) ], t.prototype, "Node_Light", void 0);
i([ _(cc.Node) ], t.prototype, "Node_Win", void 0);
i([ _(cc.Sprite) ], t.prototype, "Icon_Image", void 0);
i([ _(cc.Label) ], t.prototype, "Name_Text", void 0);
i([ _(cc.Label) ], t.prototype, "Money_Value_Self", void 0);
i([ _(cc.Label) ], t.prototype, "Money_Value_A", void 0);
i([ _(cc.Label) ], t.prototype, "Money_Value_B", void 0);
i([ _(cc.SpriteFrame) ], t.prototype, "SpriteFrame_Man", void 0);
i([ _(cc.SpriteFrame) ], t.prototype, "SpriteFrame_Woman", void 0);
i([ _({
step: 1,
min: 0,
max: 7
}) ], t.prototype, "_index", void 0);
i([ _({
step: 1,
min: 0,
max: 7
}) ], t.prototype, "Index", null);
return i([ f ], t);
}(cc.Component);
o.default = m;
cc._RF.pop();
}, {
"../../../Game/client/global/enum/game/UIUtils": "UIUtils",
"../../../Game/client/logic/game/GameHelper": "GameHelper",
"../../../Game/fromework/global/Tools": "Tools",
"../../../Game/fromework/helper/EventHelper": "EventHelper",
"../../Common/Utils/CompositeConst": "CompositeConst",
"../../Common/Utils/CompositeEvent": "CompositeEvent",
"../../Common/Utils/CompositeUtil": "CompositeUtil"
} ],
TraditionUI: [ function(e, t, o) {
"use strict";
cc._RF.push(t, "20046t86RJHBYRIV4Tk3kaC", "TraditionUI");
var n, a = this && this.__extends || (n = function(e, t) {
return (n = Object.setPrototypeOf || {
__proto__: []
} instanceof Array && function(e, t) {
e.__proto__ = t;
} || function(e, t) {
for (var o in t) Object.prototype.hasOwnProperty.call(t, o) && (e[o] = t[o]);
})(e, t);
}, function(e, t) {
n(e, t);
function o() {
this.constructor = e;
}
e.prototype = null === t ? Object.create(t) : (o.prototype = t.prototype, new o());
}), i = this && this.__decorate || function(e, t, o, n) {
var a, i = arguments.length, r = i < 3 ? t : null === n ? n = Object.getOwnPropertyDescriptor(t, o) : n;
if ("object" == typeof Reflect && "function" == typeof Reflect.decorate) r = Reflect.decorate(e, t, o, n); else for (var l = e.length - 1; l >= 0; l--) (a = e[l]) && (r = (i < 3 ? a(r) : i > 3 ? a(t, o, r) : a(t, o)) || r);
return i > 3 && r && Object.defineProperty(t, o, r), r;
};
Object.defineProperty(o, "__esModule", {
value: !0
});
var r = e("../../../Game/client/global/enum/game/Event"), l = e("../../../client/logic/Wallet/WalletHelper"), s = e("../../../Game/fromework/helper/EventHelper"), c = e("../../../Game/fromework/helper/UIHelper"), u = e("../../Common/Utils/CompositeConst"), d = e("../../Common/Utils/CompositeEvent"), p = e("../../Common/Utils/CompositeUtil"), h = e("./TraditionChooseBetChip"), f = e("../../../Game/client/global/enum/game/Const"), _ = e("../../../Game/fromework/mvvm/modelView/ViewModel"), m = cc._decorator, y = m.ccclass, g = m.property, v = function(e) {
a(t, e);
function t() {
var t = null !== e && e.apply(this, arguments) || this;
t.BetChipPrefab = null;
t.MemberCount = null;
t.AndarValue = null;
t.BaharValue = null;
t.ChipsNode = null;
t.Bottom = null;
t._gameMethod = u.PlayMethod.AndarBahar;
return t;
}
Object.defineProperty(t.prototype, "GameMethod", {
get: function() {
return this._gameMethod;
},
set: function(e) {
this._gameMethod = e;
},
enumerable: !1,
configurable: !0
});
t.prototype._onGameHide = function() {
this.unscheduleAllCallbacks();
this.ChipsNode.removeAllChildren(!0);
};
t.prototype._init = function() {
this.ChipsNode.removeAllChildren(!0);
for (var e = p.default.Game.Model.bet_fee_currency, t = 0; t < e.length; ++t) {
var o = cc.instantiate(this.BetChipPrefab);
o.parent = this.ChipsNode;
o.getComponent(h.default).ChipValue = e[t] / 1e3;
}
2 == p.default.Game.Model.roomData.state ? this._showBottom() : this._hideBottom();
};
t.prototype.onBackClick = function() {
p.default.Game.Proxy.sendLeave();
};
t.prototype.onHelpClick = function() {
u.PlayMethod.AndarBahar == this.GameMethod ? c.default.Instance.addBundleMaskLayer(f.BundleUIPath.ABHelp) : u.PlayMethod.RedAndBlack == this.GameMethod ? c.default.Instance.addBundleMaskLayer(f.BundleUIPath.RBHelp) : u.PlayMethod.LuckyDice == this.GameMethod ? c.default.Instance.addBundleMaskLayer(f.BundleUIPath.LuckyDiceHelp) : u.PlayMethod.DragonVSTiger == this.GameMethod ? c.default.Instance.addBundleMaskLayer(f.BundleUIPath.DTHelp) : u.PlayMethod.SevenUpDown == this.GameMethod ? c.default.Instance.addBundleMaskLayer(f.BundleUIPath.SUDHelp) : u.PlayMethod.TraditionAndarBahar == this.GameMethod && c.default.Instance.addBundleMaskLayer(f.BundleUIPath.TraditionABHelp);
};
t.prototype.onHistoryClick = function() {
u.PlayMethod.AndarBahar == this.GameMethod ? c.default.Instance.addBundleMaskLayer(f.BundleUIPath.ABRecord) : u.PlayMethod.RedAndBlack == this.GameMethod ? c.default.Instance.addBundleMaskLayer(f.BundleUIPath.RBRecord) : u.PlayMethod.LuckyDice == this.GameMethod ? c.default.Instance.addBundleMaskLayer(f.BundleUIPath.LuckyDiceRecord) : u.PlayMethod.DragonVSTiger == this.GameMethod ? c.default.Instance.addBundleMaskLayer(f.BundleUIPath.DTRecord) : u.PlayMethod.SevenUpDown == this.GameMethod ? c.default.Instance.addBundleMaskLayer(f.BundleUIPath.SUDRecord) : u.PlayMethod.TraditionAndarBahar == this.GameMethod && c.default.Instance.addBundleMaskLayer(f.BundleUIPath.TraditionABRecord);
};
t.prototype.onMemberClick = function() {
c.default.Instance.addBundleMaskLayer(f.BundleUIPath.OtherMember);
};
t.prototype.onNoticeClick = function() {
u.PlayMethod.AndarBahar == this.GameMethod ? c.default.Instance.addBundleMaskLayer(f.BundleUIPath.ABRecord) : u.PlayMethod.RedAndBlack == this.GameMethod ? c.default.Instance.addBundleMaskLayer(f.BundleUIPath.RBRecord) : u.PlayMethod.LuckyDice == this.GameMethod ? c.default.Instance.addBundleMaskLayer(f.BundleUIPath.LuckyDiceRecord) : u.PlayMethod.DragonVSTiger == this.GameMethod ? c.default.Instance.addBundleMaskLayer(f.BundleUIPath.DTRecord) : u.PlayMethod.SevenUpDown == this.GameMethod ? c.default.Instance.addBundleMaskLayer(f.BundleUIPath.SUDRecord) : u.PlayMethod.TraditionAndarBahar == this.GameMethod && c.default.Instance.addBundleMaskLayer(f.BundleUIPath.TraditionABRecord);
};
t.prototype.onBuyClick = function() {
l.default.Instance.openRecharge();
};
t.prototype.onAndarClick = function() {
s.default.Instance.Global.emit(d.OddsEvent.ODDS_CLICK, {
index: 0
});
};
t.prototype.onBaharClick = function() {
s.default.Instance.Global.emit(d.OddsEvent.ODDS_CLICK, {
index: 1
});
};
t.prototype._onMemberCountChange = function(e) {
var t = e.getUserData();
this.MemberCount.string = "" + t;
};
t.prototype._onSelectChipChange = function(e) {
var t = e.getUserData();
this.AndarValue.string = t + "";
this.BaharValue.string = t + "";
};
t.prototype._showBottom = function() {
var e = p.default.Game.Model.getUserData(_.VM.getValue("user.uid"));
e && 0 == e.bet_status && (this.Bottom.active = !0);
var t = p.default.Game.Model.bet_fee_currency, o = cc.sys.localStorage.getItem(_.VM.getValue("user.uid") + "CompositeChipIndex" + this.GameMethod);
null == o && (o = 0);
this.scheduleOnce(function() {
s.default.Instance.Global.emit(d.BetChipEvent.BET_CHIP_CLICK, t[parseInt(o)] / 1e3);
});
};
t.prototype._hideBottom = function() {
this.Bottom.active = !1;
};
t.prototype._onPlayerBet = function(e) {
var t = e.getUserData();
t.head && 7 == t.index && 0 != t.head.state && this._hideBottom();
};
t.prototype.onEnable = function() {
s.default.Instance.Global.bind(r.GameEvent.S2C_ENTER_ROOM, this._init, this);
s.default.Instance.Global.bind(d.CompositeUIEvent.UI_MEMBER_COUNT_CHANGE, this._onMemberCountChange, this);
s.default.Instance.Global.bind(d.BetChipEvent.BET_CHIP_CLICK, this._onSelectChipChange, this);
s.default.Instance.Global.bind(d.UserEvent.USER_REFRESH_DATA, this._onPlayerBet, this);
s.default.Instance.Global.bind(d.CompositeGameEvent.UI_EFFECT_START_BET, this._showBottom, this);
s.default.Instance.Global.bind(d.CompositeGameEvent.UI_EFFECT_STOP_BET, this._hideBottom, this);
};
t.prototype.onDisable = function() {
s.default.Instance.Global.unbind(r.GameEvent.S2C_ENTER_ROOM, this._init, this);
s.default.Instance.Global.unbind(d.CompositeUIEvent.UI_MEMBER_COUNT_CHANGE, this._onMemberCountChange, this);
s.default.Instance.Global.unbind(d.BetChipEvent.BET_CHIP_CLICK, this._onSelectChipChange, this);
s.default.Instance.Global.unbind(d.UserEvent.USER_REFRESH_DATA, this._onPlayerBet, this);
s.default.Instance.Global.unbind(d.CompositeGameEvent.UI_EFFECT_START_BET, this._showBottom, this);
s.default.Instance.Global.unbind(d.CompositeGameEvent.UI_EFFECT_STOP_BET, this._hideBottom, this);
};
t.prototype.__preload = function() {};
t.prototype.onLoad = function() {
cc.game.on(cc.game.EVENT_HIDE, this._onGameHide, this);
};
t.prototype.onDestroy = function() {};
t.prototype.start = function() {};
i([ g(cc.Prefab) ], t.prototype, "BetChipPrefab", void 0);
i([ g(cc.Label) ], t.prototype, "MemberCount", void 0);
i([ g(cc.Label) ], t.prototype, "AndarValue", void 0);
i([ g(cc.Label) ], t.prototype, "BaharValue", void 0);
i([ g(cc.Node) ], t.prototype, "ChipsNode", void 0);
i([ g(cc.Node) ], t.prototype, "Bottom", void 0);
i([ g({
type: cc.Enum(u.PlayMethod)
}) ], t.prototype, "_gameMethod", void 0);
i([ g({
type: cc.Enum(u.PlayMethod),
tooltip: "游戏类型"
}) ], t.prototype, "GameMethod", null);
return i([ y ], t);
}(cc.Component);
o.default = v;
cc._RF.pop();
}, {
"../../../Game/client/global/enum/game/Const": "Const",
"../../../Game/client/global/enum/game/Event": "Event",
"../../../Game/fromework/helper/EventHelper": "EventHelper",
"../../../Game/fromework/helper/UIHelper": "UIHelper",
"../../../Game/fromework/mvvm/modelView/ViewModel": "ViewModel",
"../../../client/logic/Wallet/WalletHelper": "WalletHelper",
"../../Common/Utils/CompositeConst": "CompositeConst",
"../../Common/Utils/CompositeEvent": "CompositeEvent",
"../../Common/Utils/CompositeUtil": "CompositeUtil",
"./TraditionChooseBetChip": "TraditionChooseBetChip"
} ],
TreasureEvent: [ function(e, t, o) {
"use strict";
cc._RF.push(t, "76d4a24vkFASK4rCRYeK2+0", "TreasureEvent");
Object.defineProperty(o, "__esModule", {
value: !0
});
o.TreasureEvent = o.TreasureEventC2S = o.TreasureEventS2C = void 0;
o.TreasureEventS2C = {
TREASURE_LIST: "S2C_Room_treasure_list"
};
o.TreasureEventC2S = {
RECV_TREASURE: [ "Room", "recv_treasure" ],
LEVELUP_TREASURE: [ "Room", "levelup_treasure" ]
};
o.TreasureEvent = {
TREASURE_LIST: "TREASURE_LIST"
};
cc._RF.pop();
}, {} ],
TreasureModel: [ function(e, t, o) {
"use strict";
cc._RF.push(t, "aec8elE+8ZNFbCn6uzAGQJa", "TreasureModel");
Object.defineProperty(o, "__esModule", {
value: !0
});
o.TreasureProxy = void 0;
var n = e("../../Game/fromework/helper/EventHelper"), a = e("../../Game/fromework/mvvm/modelView/ViewModel"), i = e("../../platform/Platform"), r = e("../../fromework/helper/NetHelper"), l = e("../logic/ui/Treasure/TreasureEvent"), s = function() {
function e() {
this.treasureList = null;
}
Object.defineProperty(e, "Instance", {
get: function() {
e._instance || (e._instance = new e());
return e._instance;
},
enumerable: !1,
configurable: !0
});
e.prototype.Init = function() {
n.default.Instance.Net.bind(l.TreasureEventS2C.TREASURE_LIST, this._onTreasureList, this);
};
e.prototype.clear = function() {
n.default.Instance.Net.unbind(l.TreasureEventS2C.TREASURE_LIST, this._onTreasureList, this);
};
Object.defineProperty(e.prototype, "uid", {
get: function() {
return a.VM.getValue("user.uid");
},
enumerable: !1,
configurable: !0
});
Object.defineProperty(e.prototype, "token", {
get: function() {
return a.VM.getValue("user.token");
},
enumerable: !1,
configurable: !0
});
Object.defineProperty(e.prototype, "roomID", {
get: function() {
return a.VM.getValue("lobby.roomID");
},
enumerable: !1,
configurable: !0
});
e.prototype._onTreasureList = function(e) {
var t = e.getUserData();
i.default.log("_onTreasureList", t);
this.treasureList = t;
n.default.Instance.Global.emit(l.TreasureEvent.TREASURE_LIST);
};
e.prototype.sendRecvTreasure = function() {
var e = r.default.Instance.makeMsg(l.TreasureEventC2S.RECV_TREASURE, {
u: this.uid,
t: this.token,
r: this.roomID
});
r.default.Instance.send(e);
};
e.prototype.sendLevelupTreasure = function() {
var e = r.default.Instance.makeMsg(l.TreasureEventC2S.LEVELUP_TREASURE, {
u: this.uid,
t: this.token,
r: this.roomID
});
r.default.Instance.send(e);
};
e._instance = null;
return e;
}();
o.TreasureProxy = s;
cc._RF.pop();
}, {
"../../Game/fromework/helper/EventHelper": "EventHelper",
"../../Game/fromework/mvvm/modelView/ViewModel": "ViewModel",
"../../fromework/helper/NetHelper": "NetHelper",
"../../platform/Platform": "Platform",
"../logic/ui/Treasure/TreasureEvent": "TreasureEvent"
} ],
Treasure: [ function(e, t, o) {
"use strict";
cc._RF.push(t, "fd7feyThTJJVqvoRwGljkvK", "Treasure");
var n, a = this && this.__extends || (n = function(e, t) {
return (n = Object.setPrototypeOf || {
__proto__: []
} instanceof Array && function(e, t) {
e.__proto__ = t;
} || function(e, t) {
for (var o in t) Object.prototype.hasOwnProperty.call(t, o) && (e[o] = t[o]);
})(e, t);
}, function(e, t) {
n(e, t);
function o() {
this.constructor = e;
}
e.prototype = null === t ? Object.create(t) : (o.prototype = t.prototype, new o());
}), i = this && this.__decorate || function(e, t, o, n) {
var a, i = arguments.length, r = i < 3 ? t : null === n ? n = Object.getOwnPropertyDescriptor(t, o) : n;
if ("object" == typeof Reflect && "function" == typeof Reflect.decorate) r = Reflect.decorate(e, t, o, n); else for (var l = e.length - 1; l >= 0; l--) (a = e[l]) && (r = (i < 3 ? a(r) : i > 3 ? a(t, o, r) : a(t, o)) || r);
return i > 3 && r && Object.defineProperty(t, o, r), r;
};
Object.defineProperty(o, "__esModule", {
value: !0
});
var r = e("../../../../Game/fromework/global/Tools"), l = e("../../../../Game/fromework/helper/AudioHelper"), s = e("../../../../Game/fromework/helper/EventHelper"), c = e("../../../global/Global"), u = e("../../../global/PopHelper"), d = e("../../../model/TreasureModel"), p = e("../../../model/UserModel"), h = e("./TreasureEvent"), f = cc._decorator, _ = f.ccclass, m = f.property, y = function(e) {
a(t, e);
function t() {
var t = null !== e && e.apply(this, arguments) || this;
t.Background = null;
t.startWorldPos = null;
t.treasure_btn = null;
t.treasure_btn_light = null;
t.progressBar = null;
t.totalWin = null;
t.statusLabel = null;
t.labelItem = null;
t.treasure_framework_content = null;
t.content = null;
t.coinSprFra = null;
t.hidenNodeArr = [];
t.headNode = null;
t.isneedShow = !1;
t.data = null;
return t;
}
t.prototype.onLoad = function() {};
t.prototype.onEnable = function() {
s.default.Instance.Global.bind(h.TreasureEvent.TREASURE_LIST, this.initView, this);
s.default.Instance.Global.bind("TREASURE_LIST_AB", this.resetView, this);
cc.director.getScene().getChildByName("Canvas").on(cc.Node.EventType.TOUCH_START, this.backgroundBtnClick, this);
};
t.prototype.onDisable = function() {
s.default.Instance.Global.unbind(h.TreasureEvent.TREASURE_LIST, this.initView, this);
s.default.Instance.Global.unbind("TREASURE_LIST_AB", this.resetView, this);
cc.director.getScene().getChildByName("Canvas").off(cc.Node.EventType.TOUCH_START, this.backgroundBtnClick, this);
};
t.prototype.resetView = function() {
if (this.isneedShow) {
this.showView();
this.isneedShow = !1;
}
};
t.prototype.initView = function() {
var e;
if (null != this.data && ("TraditionAndarBahar" == cc.director.getScene().name || "AndarBahar" == cc.director.getScene().name || "LuckyDice" == cc.director.getScene().name || "SevenUpDown" == cc.director.getScene().name)) {
if (!((null === (e = d.TreasureProxy.Instance.treasureList) || void 0 === e ? void 0 : e.award) > 0)) {
this.isneedShow = !0;
return;
}
this.isneedShow = !1;
}
this.showView();
};
t.prototype.showView = function() {
var e = this, t = this.data = d.TreasureProxy.Instance.treasureList, o = r.Tools.isEmpty(null == t ? void 0 : t.treasure_list);
this.hidenNodeArr.forEach(function(e) {
return e.active = o;
});
[ "Background", "treasure_btn" ].map(function(t) {
return e.node.getChildByName(t);
}).forEach(function(e) {
return e.active = !o;
});
(null == t ? void 0 : t.award) > 0 && u.PopHelper.Instance.showReward(c.Global.Instance.changeReward({
1: t.award
}), function() {
e.creatorCoinActToMyHead();
});
if (!o) {
var n = t.currentWin > 0 ? 2 : 0;
this.scheduleOnce(function() {
var o, n = (null === (o = null == t ? void 0 : t.treasure_list) || void 0 === o ? void 0 : o.config) || [], a = n.slice(0, n.length / 2), i = n.slice(n.length / 2, n.length), l = n.map(function(e, t) {
return t % 2 == 0 ? a.shift() : i.shift();
});
null == l || l.forEach(function(t, o) {
var n = "labelItem_" + (o + 1), a = e.content.getChildByName(n) || cc.instantiate(e.labelItem);
a.name = n;
a.parent = e.content;
a.getChildByName("label1").getComponent(cc.Label).string = "Lv " + t.level;
a.getChildByName("label2").getComponent(cc.Label).string = "+₹" + t.award;
a.active = !0;
});
t.treasure_list.totalWin > t.treasure_list.award && (t.treasure_list.totalWin = t.treasure_list.award);
var s = r.Tools.TFloat.div(t.treasure_list.totalWin, t.treasure_list.award), c = t.treasure_list.totalWin;
if (t.currentWin > 0) {
for (var u = Math.max(r.Tools.TFloat.sub(s, e.progressBar.progress), 0), d = e.totalWin.string.match(/[-+]?\d+(\.\d+)?/), p = d ? parseFloat(d[0]) : 0, h = r.Tools.TFloat.sub(c, p), f = r.Tools.TFloat.div(h, 10), _ = r.Tools.TFloat.div(u, 10), m = function(t) {
cc.tween(e.totalWin).delay(_ * t).call(function() {
e.totalWin.string = 10 !== t ? "+₹" + r.Tools.TFloat.add(p, r.Tools.TFloat.mul(f, t)) : "+₹" + c;
}).start();
}, y = 1; y <= 10; y++) m(y);
cc.tween(e.progressBar).to(u, {
progress: s
}).call(function() {
e.updateStatus();
}).start();
e.creatorCoinAct(e.startWorldPos.convertToWorldSpaceAR(cc.Vec2.ZERO));
} else {
e.totalWin.string = "+₹" + c;
e.progressBar.progress = s;
e.updateStatus();
}
}, n);
}
};
t.prototype.updateStatus = function() {
var e = this.data;
switch (e.treasure_list.status) {
case 1:
this.statusLabel.string = "RECEIVE TREASURE";
break;

case 2:
this.statusLabel.string = "UPGRADE TREASURE";
break;

default:
this.statusLabel.string = "LV " + e.treasure_list.level + " TREASURE";
}
cc.Tween.stopAllByTarget(this.treasure_btn_light);
if (0 === e.treasure_list.status || 3 === e.treasure_list.status) this.treasure_btn_light.active = !1; else {
this.treasure_btn_light.active = !0;
cc.tween(this.treasure_btn_light).set({
opacity: 0
}).to(.3, {
opacity: 255
}, {
easing: "fade"
}).to(.3, {
opacity: 0
}, {
easing: "fade"
}).union().repeatForever().start();
}
};
t.prototype.creatorCoinAct = function(e, t) {
void 0 === e && (e = null);
void 0 === t && (t = 15);
for (var o = 0; o < t; o++) {
var n = new cc.Node();
n.active = !0;
n.addComponent(cc.Sprite);
n.getComponent(cc.Sprite).spriteFrame = this.coinSprFra;
var a = this.node.convertToNodeSpaceAR(this.treasure_btn.convertToWorldSpaceAR(cc.Vec2.ZERO)), i = cc.Vec2.ZERO;
if (e && null != e) {
i = this.node.convertToNodeSpaceAR(e);
a = this.node.convertToNodeSpaceAR(this.treasure_btn.convertToWorldSpaceAR(cc.Vec2.ZERO));
}
this.node.addChild(n);
n.setPosition(i);
n.runAction(cc.sequence(cc.delayTime(.08 * o), cc.bezierTo(.8, [ i, cc.v2((a.x - i.x) / 2, (a.y - i.y) / 8), a ]), cc.fadeOut(.2), cc.destroySelf()));
setTimeout(function() {
l.default.Instance.playBundleEffect("resources/sound/common/jiajinbi");
}, 500);
}
};
t.prototype.treasureBtnClick = function() {
switch (this.data.treasure_list.status) {
case 1:
d.TreasureProxy.Instance.sendRecvTreasure();
break;

case 2:
d.TreasureProxy.Instance.sendLevelupTreasure();
break;

default:
this.treasure_framework_content.active = !this.treasure_framework_content.activeInHierarchy;
}
if (0 == p.userSoundHavePlay.SOUND_BOX_MORE) {
l.default.Instance.playBundleEffect("resources/sound/tipEffect/themore", !1, null, !1, !0);
p.userSoundHavePlay.SOUND_BOX_MORE = 1;
}
};
t.prototype.backgroundBtnClick = function() {
this.treasure_framework_content.active = !1;
};
t.prototype.start = function() {};
t.prototype.creatorCoinActToMyHead = function(e, t) {
void 0 === e && (e = null);
void 0 === t && (t = 15);
for (var o = 0; o < t; o++) {
var n = new cc.Node();
n.active = !0;
n.addComponent(cc.Sprite);
n.getComponent(cc.Sprite).spriteFrame = this.coinSprFra;
var a = this.node.convertToNodeSpaceAR(this.treasure_btn.convertToWorldSpaceAR(cc.Vec2.ZERO)), i = this.node.convertToNodeSpaceAR(this.headNode.convertToWorldSpaceAR(cc.Vec2.ZERO));
if (e && null != e) {
a = this.node.convertToNodeSpaceAR(e);
i = this.node.convertToNodeSpaceAR(this.treasure_btn.convertToWorldSpaceAR(cc.Vec2.ZERO));
}
this.node.addChild(n);
n.setPosition(a);
n.runAction(cc.sequence(cc.delayTime(.08 * o), cc.bezierTo(.8, [ a, cc.v2(i.x, a.y / 2), i ]), cc.fadeOut(.2), cc.destroySelf()));
setTimeout(function() {
l.default.Instance.playBundleEffect("resources/sound/common/jiajinbi");
}, 500);
}
};
i([ m(cc.Node) ], t.prototype, "Background", void 0);
i([ m(cc.Node) ], t.prototype, "startWorldPos", void 0);
i([ m(cc.Node) ], t.prototype, "treasure_btn", void 0);
i([ m(cc.Node) ], t.prototype, "treasure_btn_light", void 0);
i([ m(cc.ProgressBar) ], t.prototype, "progressBar", void 0);
i([ m(cc.Label) ], t.prototype, "totalWin", void 0);
i([ m(cc.Label) ], t.prototype, "statusLabel", void 0);
i([ m(cc.Node) ], t.prototype, "labelItem", void 0);
i([ m(cc.Node) ], t.prototype, "treasure_framework_content", void 0);
i([ m(cc.Node) ], t.prototype, "content", void 0);
i([ m(cc.SpriteFrame) ], t.prototype, "coinSprFra", void 0);
i([ m([ cc.Node ]) ], t.prototype, "hidenNodeArr", void 0);
i([ m(cc.Node) ], t.prototype, "headNode", void 0);
return i([ _ ], t);
}(cc.Component);
o.default = y;
cc._RF.pop();
}, {
"../../../../Game/fromework/global/Tools": "Tools",
"../../../../Game/fromework/helper/AudioHelper": "AudioHelper",
"../../../../Game/fromework/helper/EventHelper": "EventHelper",
"../../../global/Global": "Global",
"../../../global/PopHelper": "PopHelper",
"../../../model/TreasureModel": "TreasureModel",
"../../../model/UserModel": "UserModel",
"./TreasureEvent": "TreasureEvent"
} ],
UIHelper: [ function(e, t, o) {
"use strict";
cc._RF.push(t, "859352l9WJNJJSOAVEngEo4", "UIHelper");
var n = this && this.__awaiter || function(e, t, o, n) {
return new (o || (o = Promise))(function(a, i) {
function r(e) {
try {
s(n.next(e));
} catch (e) {
i(e);
}
}
function l(e) {
try {
s(n.throw(e));
} catch (e) {
i(e);
}
}
function s(e) {
e.done ? a(e.value) : (t = e.value, t instanceof o ? t : new o(function(e) {
e(t);
})).then(r, l);
var t;
}
s((n = n.apply(e, t || [])).next());
});
}, a = this && this.__generator || function(e, t) {
var o, n, a, i, r = {
label: 0,
sent: function() {
if (1 & a[0]) throw a[1];
return a[1];
},
trys: [],
ops: []
};
return i = {
next: l(0),
throw: l(1),
return: l(2)
}, "function" == typeof Symbol && (i[Symbol.iterator] = function() {
return this;
}), i;
function l(e) {
return function(t) {
return s([ e, t ]);
};
}
function s(i) {
if (o) throw new TypeError("Generator is already executing.");
for (;r; ) try {
if (o = 1, n && (a = 2 & i[0] ? n.return : i[0] ? n.throw || ((a = n.return) && a.call(n), 
0) : n.next) && !(a = a.call(n, i[1])).done) return a;
(n = 0, a) && (i = [ 2 & i[0], a.value ]);
switch (i[0]) {
case 0:
case 1:
a = i;
break;

case 4:
r.label++;
return {
value: i[1],
done: !1
};

case 5:
r.label++;
n = i[1];
i = [ 0 ];
continue;

case 7:
i = r.ops.pop();
r.trys.pop();
continue;

default:
if (!(a = r.trys, a = a.length > 0 && a[a.length - 1]) && (6 === i[0] || 2 === i[0])) {
r = 0;
continue;
}
if (3 === i[0] && (!a || i[1] > a[0] && i[1] < a[3])) {
r.label = i[1];
break;
}
if (6 === i[0] && r.label < a[1]) {
r.label = a[1];
a = i;
break;
}
if (a && r.label < a[2]) {
r.label = a[2];
r.ops.push(i);
break;
}
a[2] && r.ops.pop();
r.trys.pop();
continue;
}
i = t.call(e, r);
} catch (e) {
i = [ 6, e ];
n = 0;
} finally {
o = a = 0;
}
if (5 & i[0]) throw i[1];
return {
value: i[0] ? i[1] : void 0,
done: !0
};
}
};
Object.defineProperty(o, "__esModule", {
value: !0
});
o.UIAddType = void 0;
var i, r = e("../../../Game/BundleManager"), l = e("../../../platform/Platform"), s = e("../global/ResLoader");
(function(e) {
e[e.ADD = 0] = "ADD";
e[e.CHANGE = 1] = "CHANGE";
})(i = o.UIAddType || (o.UIAddType = {}));
var c = function() {
function e() {
this._bgLayer = null;
this._uiLayer = null;
this._maskLayer = null;
this._uiLayers = new Map();
this._bgLayers = new Map();
this._maskLayers = new Map();
this._uiLayersSequence = new Array();
}
Object.defineProperty(e, "Instance", {
get: function() {
e._Instance || (e._Instance = new e());
return e._Instance;
},
enumerable: !1,
configurable: !0
});
e.prototype.init = function() {
this._uiLayers.clear();
this._bgLayers.clear();
this._maskLayers.clear();
this._uiLayersSequence.length = 0;
};
e.prototype.release = function() {
this._destroyAllLayers();
};
e.prototype.isOpenMaskLayer = function(e) {
var t = !1;
null != this._maskLayers && 0 != this._maskLayers.size && this._maskLayers.forEach(function(o) {
o == e && (t = !0);
});
return t;
};
e.prototype.setLayers = function(e, t, o) {
this._destroyAllLayers();
this._bgLayer = e;
this._uiLayer = t;
this._maskLayer = o;
};
e.prototype.addBgLayer = function(e, t, o) {
var n = this, a = o, i = e;
s.default.Instance.loadRes(e, cc.Prefab, function(e, o) {
var r = cc.instantiate(o);
n._addBGLayer(i, r, null == a ? 10 : a);
t && t(r);
});
};
e.prototype.addMaskLayer = function(e, t, o) {
var n = this, a = o, i = e;
s.default.Instance.loadRes(e, cc.Prefab, function(e, o) {
var r = cc.instantiate(o);
n._addMaskLayer(i, r, null == a ? 10 : a);
t && t(r);
});
};
e.prototype.addBundleMaskLayer = function(e, t, o) {
return n(this, void 0, void 0, function() {
var n, i, s, c;
return a(this, function(a) {
switch (a.label) {
case 0:
n = o;
i = e;
s = this;
a.label = 1;

case 1:
a.trys.push([ 1, 3, , 4 ]);
return [ 4, r.default.getInstance().getGameBundle() ];

case 2:
a.sent().load(e, cc.Prefab, function(e, o) {
if (!e) {
var a = cc.instantiate(o);
s._addMaskLayer(i, a, null == n ? 10 : n);
t && t(a);
}
});
return [ 3, 4 ];

case 3:
c = a.sent();
l.default.error("addBundleMaskLayer error", c);
return [ 3, 4 ];

case 4:
return [ 2 ];
}
});
});
};
e.prototype.getMaskLayer = function(e) {
var t = null;
null != this._maskLayers && 0 != this._maskLayers.size && this._maskLayers.forEach(function(o, n) {
o == e && (t = n);
});
return t;
};
e.prototype.changeLayer = function(e, t, o) {
var n = this, a = o, r = e;
this._uiLayers.forEach(function(e, t) {
for (var o = 0; o < n._uiLayersSequence.length; o++) if (n._uiLayersSequence[o].layer == t) {
n._uiLayersSequence.splice(o, 1);
break;
}
n._uiLayer.removeChild(t);
t.destroy();
s.default.Instance.releaseRes(e);
});
this._uiLayers.clear();
s.default.Instance.loadRes(r, cc.Prefab, function(o, r) {
var l = cc.instantiate(r);
n._uiLayersSequence.push({
layer: l,
addType: i.CHANGE
});
n._addPhaseLayer(e, l, null == a ? 10 : a);
t && t(l);
});
};
e.prototype.back = function(e, t) {
if (!(this._uiLayersSequence.length <= 1)) {
var o = this._uiLayersSequence.pop(), n = this._uiLayersSequence[this._uiLayersSequence.length - 1];
o.addType == i.CHANGE ? this.changeLayer(this._uiLayers.get(n.layer), e, t) : o.addType == i.ADD && this.removeLayer(o.layer);
}
};
e.prototype.addLayer = function(e, t, o) {
var n = this, a = o, r = e;
s.default.Instance.loadRes(r, cc.Prefab, function(o, r) {
var l = cc.instantiate(r);
n._uiLayersSequence.push({
layer: l,
addType: i.ADD
});
n._addPhaseLayer(e, l, null == a ? 10 : a);
t && t(l);
});
};
e.prototype.addBundleLayer = function(e, t, o) {
return n(this, void 0, void 0, function() {
var n, s, c;
return a(this, function(a) {
switch (a.label) {
case 0:
n = o;
s = this;
a.label = 1;

case 1:
a.trys.push([ 1, 3, , 4 ]);
return [ 4, r.default.getInstance().getGameBundle() ];

case 2:
a.sent().load(e, cc.Prefab, function(o, a) {
if (!o) {
var r = cc.instantiate(a);
s._uiLayersSequence.push({
layer: r,
addType: i.ADD
});
s._addPhaseLayer(e, r, null == n ? 10 : n);
t && t(r);
}
});
return [ 3, 4 ];

case 3:
c = a.sent();
l.default.error("addBundleLayer error", c);
return [ 3, 4 ];

case 4:
return [ 2 ];
}
});
});
};
e.prototype.loadLayer = function(e, t) {
s.default.Instance.loadRes(e, cc.Prefab, function(e, o) {
var n = cc.instantiate(o);
t && t(n);
});
};
e.prototype.removeLayer = function(e, t) {
void 0 === t && (t = !0);
for (var o = 0; o < this._uiLayersSequence.length; o++) if (this._uiLayersSequence[o].layer == e) {
this._uiLayersSequence.splice(o, 1);
break;
}
this._releaseLayer(e, t);
};
e.prototype.removeBGLayer = function(e, t) {
void 0 === t && (t = !0);
this._releaseBGLayer(e, t);
};
e.prototype.removeMaskLayer = function(e, t) {
void 0 === t && (t = !0);
this._releaseMaskLayer(e, t);
};
e.prototype._addPhaseLayer = function(e, t, o, n) {
void 0 === n && (n = null);
if (n) n.addChild(t, o); else {
var a = e.split("/"), i = a[a.length - 1];
this._uiLayer.getChildByName(i) && cc.isValid(this._uiLayer.getChildByName(i), !0) && this._releaseLayer(this._uiLayer.getChildByName(i));
this._uiLayer.addChild(t, o);
this._uiLayers.set(t, e);
}
};
e.prototype._addBGLayer = function(e, t, o, n) {
void 0 === n && (n = null);
if (n) n.addChild(t, o); else {
var a = e.split("/"), i = a[a.length - 1];
this._bgLayer.getChildByName(i) && cc.isValid(this._bgLayer.getChildByName(i), !0) && this._releaseBGLayer(this._bgLayer.getChildByName(i));
this._bgLayer.addChild(t, o);
this._bgLayers.set(t, e);
}
};
e.prototype._addMaskLayer = function(e, t, o, n) {
void 0 === n && (n = null);
if (n) n.addChild(t, o); else {
var a = e.split("/"), i = a[a.length - 1];
this._maskLayer.getChildByName(i) && cc.isValid(this._maskLayer.getChildByName(i), !0) && this._releaseMaskLayer(this._maskLayer.getChildByName(i));
this._maskLayer.addChild(t, o);
this._maskLayers.set(t, e);
}
};
e.prototype._releaseLayer = function(e, t) {
void 0 === t && (t = !0);
this._uiLayer.removeChild(e, t);
var o = this._uiLayers.get(e);
s.default.Instance.releaseRes(o);
this._uiLayers.delete(e);
e.destroy();
};
e.prototype._releaseBGLayer = function(e, t) {
void 0 === t && (t = !0);
this._bgLayer.removeChild(e, t);
var o = this._bgLayers.get(e);
s.default.Instance.releaseRes(o);
this._bgLayers.delete(e);
e.destroy();
};
e.prototype._releaseMaskLayer = function(e, t) {
void 0 === t && (t = !0);
this._maskLayer.removeChild(e, t);
var o = this._maskLayers.get(e);
s.default.Instance.releaseRes(o);
this._maskLayers.delete(e);
e.destroy();
};
e.prototype._destroyAllLayers = function() {
if (this._bgLayer) {
this._bgLayer.children && this._bgLayer.destroyAllChildren();
this._bgLayer.destroy();
}
if (this._uiLayer) {
this._uiLayer.children && this._uiLayer.destroyAllChildren();
this._uiLayer.destroy();
}
if (this._maskLayer) {
this._maskLayer.children && this._maskLayer.destroyAllChildren();
this._maskLayer.destroy();
}
this._bgLayer = null;
this._uiLayer = null;
this._maskLayer = null;
this._uiLayers.forEach(function(e) {
s.default.Instance.releaseRes(e);
});
this._uiLayers.clear();
this._bgLayers.forEach(function(e) {
s.default.Instance.releaseRes(e);
});
this._bgLayers.clear();
this._maskLayers.forEach(function(e) {
s.default.Instance.releaseRes(e);
});
this._maskLayers.clear();
this._uiLayersSequence.length = 0;
};
e._Instance = null;
return e;
}();
o.default = c;
cc._RF.pop();
}, {
"../../../Game/BundleManager": "BundleManager",
"../../../platform/Platform": "Platform",
"../global/ResLoader": "ResLoader"
} ],
UIUtils: [ function(e, t, o) {
"use strict";
cc._RF.push(t, "aea8fG/s9VFyIrSaQCMbV65", "UIUtils");
Object.defineProperty(o, "__esModule", {
value: !0
});
o.UIUtils = void 0;
var n = e("../../../../../platform/Platform"), a = e("../../../../fromework/global/ResLoader"), i = e("../../../../fromework/global/Tools");
(function(e) {
e.runInputTipsAction = function(e, t) {
null != e.theOriginalX && (e.x = parseFloat(e.theOriginalX));
e.theOriginalX = e.x + "";
e.x = e.x + 50;
var o = cc.sequence(cc.moveBy(.1, cc.v2(-50, 0)), cc.moveBy(.1, cc.v2(25, 0)), cc.moveBy(.1, cc.v2(-25, 0)), cc.callFunc(function() {
e.x = parseFloat(e.theOriginalX);
t && t();
}));
e.runAction(o);
};
e.disableButton = function(e, t, o) {
var n = e;
o.originalString = null != o.originalString ? o.originalString : o.string;
o.string = n + "";
t.interactable = !1;
if (t.intervalID && -1 != t.intervalID) {
clearInterval(t.intervalID);
t.intervalID = -1;
}
t.intervalID = setInterval(function() {
n--;
if (t && o && t.node && o.node && !(n <= 0)) o && (o.string = n + ""); else {
clearInterval(t.intervalID);
t.intervalID = -1;
t && t.node && (t.interactable = !0);
o && o.node && (o.string = o.originalString);
}
}, 1e3);
};
e.setNodeColor = function(e, t) {
if (e && e.isValid) {
var o = cc.Color.BLACK.fromHEX(t);
e.opacity = o.a;
e.color = cc.color(o.r, o.g, o.b);
}
};
e.getNumberScrollAry = function(e, t, o) {
for (var n = [], a = Math.abs(t - e) / o, i = 0; i < o; i++) n.push(Number((e + i * a).toFixed(1)));
n.push(t);
return n;
};
e.setGray = function e(t, o, n) {
void 0 === o && (o = !0);
void 0 === n && (n = !1);
var a = t, i = o ? cc.Material.BUILTIN_NAME.GRAY_SPRITE : cc.Material.BUILTIN_NAME.SPRITE, r = cc.Material.getBuiltinMaterial(i + "");
if (t instanceof cc.Node) {
(a = t.getComponent(cc.Sprite)) && a.setMaterial(0, r);
(a = t.getComponent(cc.Label)) && a.setMaterial(0, r);
n && t.children.forEach(function(t) {
e(t, o, n);
}, this);
} else a && a.setMaterial(0, r);
};
var t = [ "1", "2", "3", "4", "5", "6" ];
e.updateHeadImage = function(e, o, r, l) {
void 0 === r && (r = cc.size(110, 110));
"" != e && null != o && o.isValid && (-1 != t.indexOf(e) ? a.default.Instance.loadBundleRes("resources/Texture/Head/user_head_" + e, cc.SpriteFrame, function(e, t) {
if (e) {
n.default.log("load default head image error:" + e.message);
l && l(!1);
} else if (null != o && o.isValid) {
o.spriteFrame = t;
o.scheduleOnce(function() {
if (o && o.node && o.node.isValid) {
o.node.width = r.width;
o.node.height = r.height;
}
});
l && l(!0);
}
}) : cc.assetManager.loadRemote(e, {
ext: ".png"
}, function(e, t) {
if (e) {
n.default.log("load remote head image error:" + e.message);
l && l(!1);
} else if (null != o && o.isValid) {
o.spriteFrame = new cc.SpriteFrame(t);
o.scheduleOnce(function() {
o && o.node && o.node.isValid && i.Tools.TCreator.imageAutoSize(o.node, o.spriteFrame, r.width, r.height);
});
l && l(!0);
}
}));
};
})(o.UIUtils || (o.UIUtils = {}));
cc._RF.pop();
}, {
"../../../../../platform/Platform": "Platform",
"../../../../fromework/global/ResLoader": "ResLoader",
"../../../../fromework/global/Tools": "Tools"
} ],
UpdateModel: [ function(e, t, o) {
"use strict";
cc._RF.push(t, "0d3b01z7dhMspRrQdB9jfcq", "UpdateModel");
Object.defineProperty(o, "__esModule", {
value: !0
});
var n = e("../../../Config"), a = e("../../../Game/Script/global/GlobalValue"), i = e("../../../Game/client/global/enum/game/Event"), r = e("../../../Game/client/global/enum/net/C2S"), l = e("../../../Game/client/global/enum/net/S2C"), s = e("../../../Game/fromework/global/Tools"), c = e("../../../Game/fromework/helper/EventHelper"), u = e("../../../platform/Platform"), d = e("./CommonModel"), p = function() {
function e() {
this._serverConfig = null;
this._hotUpdateNotice = null;
this._updateVersion = "1.0.0";
this._hotUpdateSize = 0;
this._isJumpHotUpdate = !1;
}
Object.defineProperty(e, "Instance", {
get: function() {
e._instance || (e._instance = new e());
return e._instance;
},
enumerable: !1,
configurable: !0
});
e.prototype.Init = function() {
c.default.Instance.Net.bind(l.S2C.SERVER.CONFIG, this._onServerConfig, this);
c.default.Instance.Net.bind(l.S2C.SERVER.HOT_UPDATE, this._onGetUpdateNotice, this);
};
e.prototype.clear = function() {
this.updateVersion = "";
this.hotUpdateSize = 0;
this.isJumpHotUpdate = !1;
this._serverConfig = null;
this._hotUpdateNotice = null;
};
Object.defineProperty(e.prototype, "serverConfig", {
get: function() {
return this._serverConfig;
},
enumerable: !1,
configurable: !0
});
Object.defineProperty(e.prototype, "hotUpdateNotice", {
get: function() {
return this._hotUpdateNotice;
},
enumerable: !1,
configurable: !0
});
Object.defineProperty(e.prototype, "updateVersion", {
get: function() {
return this._updateVersion;
},
set: function(e) {
this._updateVersion = e;
},
enumerable: !1,
configurable: !0
});
Object.defineProperty(e.prototype, "hotUpdateSize", {
get: function() {
return this._hotUpdateSize;
},
set: function(e) {
this._hotUpdateSize = e;
},
enumerable: !1,
configurable: !0
});
Object.defineProperty(e.prototype, "isJumpHotUpdate", {
get: function() {
return this._isJumpHotUpdate;
},
set: function(e) {
this._isJumpHotUpdate = e;
},
enumerable: !1,
configurable: !0
});
e.prototype._onServerConfig = function(e) {
var t = e.getUserData();
this._serverConfig = new d.Common.ServerConfig(t);
a.default.getInstance().HttpServerUrl = this._serverConfig.web_url;
a.default.getInstance().WebSocketUrl = this._serverConfig.gate_url;
a.default.getInstance().WalletUrl = this._serverConfig.gm_url;
a.default.getInstance().ServiceUrl = null != this._serverConfig.kefu_url ? this._serverConfig.kefu_url : "";
a.default.getInstance().OpenHotUpdate = "" != this._serverConfig.hot_update_url;
c.default.Instance.Global.emit(i.ServerEvent.SERVER_CONFIG);
};
e.prototype._onGetUpdateNotice = function(e) {
var t = e.getUserData();
this._hotUpdateNotice = new d.Common.HotUpdateNotoceData(t);
c.default.Instance.Global.emit(i.ServerEvent.HOT_UPDATE_NOTICE);
};
e.prototype.sendGetServerConfig = function(e) {
var t = u.default.getPackageName(), o = n.Config.Channel, a = u.default.getVersionCode(), i = "", l = "", c = cc.sys.localStorage.getItem("CommonUserUid"), d = s.Tools.GenerateID(s.Tools.TNumber.randomNumber(2, 50)), p = "0", h = u.default.getTextFromClipboard();
null != h && "" != h && (p = s.Tools.TStr.getQueryString("invite_id", h));
if (cc.sys.isNative) {
i = u.default.getOnlyID();
l = u.default.getDeviceID();
} else {
i = "web_imei";
l = "web_device";
}
null == c && (c = "");
this.makeMsg(r.C2S.SERVER_CONFIG, {
package: t,
channel: o,
version: a,
imei: i,
device_info: l,
uid: c,
ad_type: e,
invite_uid: p,
useless: d
});
};
e.prototype.sendGetUpdateNotice = function() {
var t, o = u.default.getPackageName(), a = n.Config.Channel, i = e.Instance.updateVersion, l = cc.sys.localStorage.getItem("CommonUserUid");
t = cc.sys.isNative ? u.default.getOnlyID() : "web_imei";
null == l && (l = "");
this.makeMsg(r.C2S.SERVER_HOT_UPDATE, {
packageName: o,
channel: a,
version: i,
imei: t,
uid: l
});
};
e.prototype.makeMsg = function(e, t) {
return {
m: e[0],
f: e[1],
d: t
};
};
e._instance = null;
return e;
}();
o.default = p;
cc._RF.pop();
}, {
"../../../Config": "Config",
"../../../Game/Script/global/GlobalValue": "GlobalValue",
"../../../Game/client/global/enum/game/Event": "Event",
"../../../Game/client/global/enum/net/C2S": "C2S",
"../../../Game/client/global/enum/net/S2C": "S2C",
"../../../Game/fromework/global/Tools": "Tools",
"../../../Game/fromework/helper/EventHelper": "EventHelper",
"../../../platform/Platform": "Platform",
"./CommonModel": "CommonModel"
} ],
UpdateNotice: [ function(e, t, o) {
"use strict";
cc._RF.push(t, "a25e7o1AhFDdoOoZP1s/Fdq", "UpdateNotice");
var n, a = this && this.__extends || (n = function(e, t) {
return (n = Object.setPrototypeOf || {
__proto__: []
} instanceof Array && function(e, t) {
e.__proto__ = t;
} || function(e, t) {
for (var o in t) Object.prototype.hasOwnProperty.call(t, o) && (e[o] = t[o]);
})(e, t);
}, function(e, t) {
n(e, t);
function o() {
this.constructor = e;
}
e.prototype = null === t ? Object.create(t) : (o.prototype = t.prototype, new o());
}), i = this && this.__decorate || function(e, t, o, n) {
var a, i = arguments.length, r = i < 3 ? t : null === n ? n = Object.getOwnPropertyDescriptor(t, o) : n;
if ("object" == typeof Reflect && "function" == typeof Reflect.decorate) r = Reflect.decorate(e, t, o, n); else for (var l = e.length - 1; l >= 0; l--) (a = e[l]) && (r = (i < 3 ? a(r) : i > 3 ? a(t, o, r) : a(t, o)) || r);
return i > 3 && r && Object.defineProperty(t, o, r), r;
};
Object.defineProperty(o, "__esModule", {
value: !0
});
var r = e("../../../../Game/client/model/LanguageModel"), l = e("../../../../Game/client/model/UpdateModel"), s = e("../../../../Game/fromework/global/Tools"), c = cc._decorator, u = c.ccclass, d = c.property, p = function(e) {
a(t, e);
function t() {
var t = null !== e && e.apply(this, arguments) || this;
t.Title = null;
t.Content = null;
t.LblLeft = null;
t.LblRight = null;
t.AlertPanel = null;
t.ScrollContent = null;
t.Item = null;
t.Buttons = null;
t.LeftButton = null;
t.RightButton = null;
t.CloseButton = null;
t._callFunc = null;
t._isUpdate = !1;
return t;
}
t.prototype.show = function(e, t) {
this._callFunc = t;
var o = l.default.Instance.hotUpdateNotice;
this.Title.string = o.notice_title ? o.notice_title : "";
this.LeftButton.active = 1 == o.hot_update_type;
this.RightButton.active = !0;
this.Buttons.active = e;
this.CloseButton.interactable = !e;
this.LblLeft.string = r.default.getString("GENG_XIN_SHAOHOU");
this.LblRight.string = r.default.getString("GENG_XIN_QUEDING");
var n = r.default.getString("GENG_XIN_NEIRONG");
n = s.Tools.TStr.replaceAll(n, "%{updateSize}", s.Tools.TNumber.changeBytes(l.default.Instance.hotUpdateSize));
var a = "";
Object.keys(o.reward).forEach(function(e) {
if ("1" == e && 0 != o.reward[e]) {
"" != a && (a += " & ");
a = a + o.reward[e] + "Cash";
}
if ("4" == e && 0 != o.reward[e]) {
"" != a && (a += " & ");
a = a + o.reward[e] + "Bonus";
}
});
if ("" != a) {
var i = s.Tools.TStr.replaceAll(r.default.getString("GENG_XIN_NEIRONG_REWARD"), "%{updatemoney}", a);
n = s.Tools.TStr.replaceAll(n, "%{reward}", i);
} else n = s.Tools.TStr.replaceAll(n, "%{reward}", r.default.getString("GENGXIN_ONE"));
this.Content.string = n;
this.updateNotice();
this.openAction();
};
t.prototype.close = function() {
var e = this;
this.closeAction(function() {
e._callFunc && e._callFunc(e._isUpdate);
e._callFunc = null;
});
};
t.prototype.openAction = function() {
this.AlertPanel.setPosition(cc.v2(0, this.node.height / 2 + this.AlertPanel.height / 2));
this.AlertPanel.runAction(cc.moveTo(.1, cc.v2(0, 0)));
};
t.prototype.closeAction = function(e) {
var t = this;
this.AlertPanel.runAction(cc.sequence(cc.moveTo(.1, cc.v2(0, -(this.node.height / 2 + this.AlertPanel.height / 2))), cc.callFunc(function() {
e && e();
t.node.removeFromParent(!0);
t.node.destroy();
})));
};
t.prototype.updateNotice = function() {
var e = l.default.Instance.hotUpdateNotice;
this.ScrollContent.removeAllChildren(!0);
for (var t = 0; t < e.notice_list.length; t++) {
var o = e.notice_list[t], n = cc.instantiate(this.Item);
n.active = !0;
n.parent = this.ScrollContent;
n.getChildByName("Title").getComponent(cc.Label).string = o.title;
for (var a = n.getChildByName("Content"), i = 0; i < o.content.length; i++) {
var r = cc.instantiate(a);
r.active = !0;
r.parent = n;
r.getComponent(cc.Label).string = o.content[i];
}
}
};
t.prototype.onLeftClicked = function() {
this._isUpdate = !1;
this.close();
};
t.prototype.onRightClicked = function() {
this._isUpdate = !0;
this.close();
};
t.prototype.onCloseClicked = function() {
this._isUpdate = !1;
this.close();
};
i([ d(cc.Label) ], t.prototype, "Title", void 0);
i([ d(cc.Label) ], t.prototype, "Content", void 0);
i([ d(cc.Label) ], t.prototype, "LblLeft", void 0);
i([ d(cc.Label) ], t.prototype, "LblRight", void 0);
i([ d(cc.Node) ], t.prototype, "AlertPanel", void 0);
i([ d(cc.Node) ], t.prototype, "ScrollContent", void 0);
i([ d(cc.Node) ], t.prototype, "Item", void 0);
i([ d(cc.Node) ], t.prototype, "Buttons", void 0);
i([ d(cc.Node) ], t.prototype, "LeftButton", void 0);
i([ d(cc.Node) ], t.prototype, "RightButton", void 0);
i([ d(cc.Button) ], t.prototype, "CloseButton", void 0);
return i([ u ], t);
}(cc.Component);
o.default = p;
cc._RF.pop();
}, {
"../../../../Game/client/model/LanguageModel": "LanguageModel",
"../../../../Game/client/model/UpdateModel": "UpdateModel",
"../../../../Game/fromework/global/Tools": "Tools"
} ],
UserInfo: [ function(e, t, o) {
"use strict";
cc._RF.push(t, "ca3188zcMhKfbhZOcC4RXYg", "UserInfo");
var n, a = this && this.__extends || (n = function(e, t) {
return (n = Object.setPrototypeOf || {
__proto__: []
} instanceof Array && function(e, t) {
e.__proto__ = t;
} || function(e, t) {
for (var o in t) Object.prototype.hasOwnProperty.call(t, o) && (e[o] = t[o]);
})(e, t);
}, function(e, t) {
n(e, t);
function o() {
this.constructor = e;
}
e.prototype = null === t ? Object.create(t) : (o.prototype = t.prototype, new o());
}), i = this && this.__decorate || function(e, t, o, n) {
var a, i = arguments.length, r = i < 3 ? t : null === n ? n = Object.getOwnPropertyDescriptor(t, o) : n;
if ("object" == typeof Reflect && "function" == typeof Reflect.decorate) r = Reflect.decorate(e, t, o, n); else for (var l = e.length - 1; l >= 0; l--) (a = e[l]) && (r = (i < 3 ? a(r) : i > 3 ? a(t, o, r) : a(t, o)) || r);
return i > 3 && r && Object.defineProperty(t, o, r), r;
};
Object.defineProperty(o, "__esModule", {
value: !0
});
var r = e("../../../component/NumericLabel"), l = e("../../../component/pop/BindAlert"), s = e("../../../../Game/client/model/LanguageModel"), c = e("../../../model/PhoneModel"), u = e("../../../model/WalletModel"), d = e("../../Wallet/WalletHelper"), p = e("../../../../Game/fromework/helper/EventHelper"), h = e("../../../../Game/client/global/enum/game/Event"), f = e("../../../../Game/fromework/mvvm/modelView/ViewModel"), _ = e("../../../../Game/client/global/enum/game/Game"), m = e("../../../global/PopHelper"), y = e("../../../../Game/client/global/enum/game/UIUtils"), g = e("../../../../Game/fromework/global/Tools"), v = e("../../../../Game/fromework/helper/UIHelper"), C = e("../../../../Game/client/global/enum/game/Const"), b = e("../../../../platform/Platform"), I = cc._decorator, E = I.ccclass, S = I.property, T = function(e) {
a(t, e);
function t() {
var t = null !== e && e.apply(this, arguments) || this;
t.AlertPanel = null;
t.UserHeadImage = null;
t.NameInput = null;
t.PhoneInputNode = null;
t.PhoneInfoNode = null;
t.PhoneNumber = null;
t.PhoneInput = null;
t.OTPInput = null;
t.SendOTPButton = null;
t.SendOTPButtonTitle = null;
t.Time = null;
t.SaveButton = null;
t.SaveTitle = null;
t.EditButton = null;
t._openType = 0;
t._headImgPath = "";
t._otpPhoneNumber = "";
t._interval = -1;
return t;
}
t.prototype.onEnable = function() {
p.default.Instance.Global.bind(h.PlatformEvent.PLATFORM_PICK_ALBUM_COMPLETED, this.selectImgSuccess, this);
p.default.Instance.Global.bind(h.PlatformEvent.PLATFORM_TAKE_PHOTO_COMPLETED, this.selectImgSuccess, this);
p.default.Instance.Global.bind(h.WalletEvent.KYC_MOBILE_BIND_CODE, this.refreshOtp, this);
p.default.Instance.Global.bind(h.WalletEvent.KYC_MOBILE_BIND_PHONE, this.onMobileBindPhone, this);
p.default.Instance.Global.bind(h.PhoneEvent.PHONE_CHECK_CODE, this.onCheckPhoneOTP, this);
f.VM.bindPath("user.headUrl", this._refreshHeadImg, this);
};
t.prototype.onDisable = function() {
p.default.Instance.Global.unbind(h.PlatformEvent.PLATFORM_PICK_ALBUM_COMPLETED, this.selectImgSuccess, this);
p.default.Instance.Global.unbind(h.PlatformEvent.PLATFORM_TAKE_PHOTO_COMPLETED, this.selectImgSuccess, this);
p.default.Instance.Global.unbind(h.WalletEvent.KYC_MOBILE_BIND_CODE, this.refreshOtp, this);
p.default.Instance.Global.unbind(h.WalletEvent.KYC_MOBILE_BIND_PHONE, this.onMobileBindPhone, this);
p.default.Instance.Global.unbind(h.PhoneEvent.PHONE_CHECK_CODE, this.onCheckPhoneOTP, this);
f.VM.unbindPath("user.headUrl", this._refreshHeadImg, this);
};
t.prototype.refreshOtp = function() {
var e = this, t = c.PhoneProxy.Instance.getCountDown(_.GameEnum.VerificationType.SMS_TYPE_BIND_PHONE), o = function() {
e.Time.string = t + "";
};
if (t <= 0) {
this.SendOTPButton.interactable = !0;
this.SendOTPButtonTitle.active = !0;
this.Time.node.active = !1;
} else {
this.SendOTPButton.interactable = !1;
this.SendOTPButtonTitle.active = !1;
this.Time.node.active = !0;
if (-1 != this._interval) {
clearInterval(this._interval);
this._interval = -1;
}
o();
this._interval = setInterval(function() {
t--;
if (!e || !e.node || !e.node.isValid || t <= 0) {
clearInterval(e._interval);
if (e.node) {
e.SendOTPButton.interactable = !0;
e.SendOTPButtonTitle.active = !0;
e.Time.node.active = !1;
}
} else o();
}, 1e3);
}
};
t.prototype.onMobileBindPhone = function(e) {
if (e.getUserData()) {
this.refreshPhone();
if (1 == this._openType) {
this._openType = 0;
this.onCloseClicked();
d.default.Instance.openWithdraw();
}
} else {
var t = {
title: s.default.getString("PROMPT_NOTICE"),
content: s.default.getString("KYC_OPT_FAILED"),
rightTitle: s.default.getString("COMMON_TRY_AGAIN"),
rightCallFunc: function() {}
};
m.PopHelper.Instance.showAlert(t, null);
}
};
t.prototype.onCheckPhoneOTP = function(e) {
var t = e.getUserData();
if (t.sms_type == _.GameEnum.VerificationType.SMS_TYPE_CHANGE_PHONE) if (t.result) {
this.PhoneInfoNode.active = !1;
this.EditButton.active = !1;
this.PhoneInputNode.active = !0;
this.SaveButton.active = !0;
this.refreshOtp();
} else m.PopHelper.Instance.showTips(s.default.getString("KYC_OPT_FAILED"));
};
t.prototype.refreshPhone = function() {
var e = f.VM.getValue("wallet.userPhone");
if (e && 0 != e) {
this.PhoneInfoNode.active = !0;
this.EditButton.active = !1;
this.PhoneInputNode.active = !1;
this.SaveButton.active = !1;
this.PhoneNumber.string = s.default.getString("USER_INFO_YOUR_PHONE") + e;
} else {
this.PhoneInfoNode.active = !1;
this.EditButton.active = !1;
this.PhoneInputNode.active = !0;
this.SaveButton.active = !0;
this.refreshOtp();
}
this.SaveTitle.string = s.default.getString("USER_INFO_BIND");
};
t.prototype.onLoad = function() {};
t.prototype.InitView = function(e) {
void 0 === e && (e = 0);
this._openType = e;
this.NameInput.string = f.VM.getValue("user.name");
this._refreshHeadImg();
this.refreshPhone();
"" != c.PhoneProxy.Instance.defaultPhone && (this.PhoneInput.string = c.PhoneProxy.Instance.defaultPhone);
this.openAction();
};
t.prototype.openAction = function() {
this.AlertPanel.setPosition(cc.v2(0, this.node.height / 2 + this.AlertPanel.height / 2));
this.AlertPanel.runAction(cc.moveTo(.1, cc.v2(0, 0)));
};
t.prototype.closeAction = function(e) {
var t = this;
this.AlertPanel.runAction(cc.sequence(cc.moveTo(.1, cc.v2(0, -(this.node.height / 2 + this.AlertPanel.height / 2))), cc.callFunc(function() {
e && e();
t.node.removeFromParent(!0);
t.node.destroy();
})));
};
t.prototype._refreshHeadImg = function(e) {
var t = f.VM.getValue("user.headUrl");
null != e && (t = e);
b.default.log("SetHeadUrl:" + t);
t && "" != t && y.UIUtils.updateHeadImage(t, this.UserHeadImage, cc.size(110, 110));
};
t.prototype.selectImgSuccess = function(e) {
this._headImgPath = e.getUserData();
b.default.log("[UserSetting] select user head image:" + this._headImgPath);
if ("" != this._headImgPath && cc.sys.isNative) {
var t = g.Tools.Base64.uint8arrayToBase64(jsb.fileUtils.getDataFromFile(this._headImgPath));
u.WalletProxy.Instance.sendUserApply("", t);
} else if (cc.sys.isBrowser) {
t = "data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAADUlEQVQImWNgYGBgAAAABQABh6FO1AAAAABJRU5ErkJggg==";
u.WalletProxy.Instance.sendUserApply("", t);
}
};
t.prototype.onCameraClicked = function() {
cc.sys.isNative ? b.default.takePhoto() : p.default.Instance.Global.emit(h.PlatformEvent.PLATFORM_PICK_ALBUM_COMPLETED, "");
};
t.prototype.onCalleryClicked = function() {
cc.sys.isNative ? b.default.pickImageFromAlbum() : p.default.Instance.Global.emit(h.PlatformEvent.PLATFORM_TAKE_PHOTO_COMPLETED, "");
};
t.prototype.onChangeNameClicked = function() {
var e = this.NameInput.string;
if ("" != e) {
if (e != f.VM.getValue("user.name")) {
f.VM.setValue("user.name", e);
u.WalletProxy.Instance.sendUserApply(e);
}
} else m.PopHelper.Instance.showTips(s.default.getString("KYC_DOC_INPUT_TIP_3"));
};
t.prototype.onSendOTpClicked = function() {
if (g.Tools.TStr.checkType(this.PhoneInput.string, "indiaPhone")) {
this._otpPhoneNumber = this.PhoneInput.string;
c.PhoneProxy.Instance.sendGetVerificationCode(_.GameEnum.VerificationType.SMS_TYPE_BIND_PHONE, this.PhoneInput.string);
} else m.PopHelper.Instance.showTips(s.default.getString("KYC_INPUT_TIP_1"));
};
t.prototype.onSaveClicked = function() {
var e = this.OTPInput.string;
null != e && "" != e ? u.WalletProxy.Instance.sendBindPhone(this._otpPhoneNumber, 91, e) : m.PopHelper.Instance.showTips(s.default.getString("KYC_INPUT_TIP_2"));
};
t.prototype.onEditClicked = function() {
var e = f.VM.getValue("wallet.userPhone");
null != e ? v.default.Instance.addBundleMaskLayer(C.BundleUIPath.BindAlert, function(t) {
t.getComponent(l.default).show(e, _.GameEnum.VerificationType.SMS_TYPE_CHANGE_PHONE, function(t) {
null != t ? c.PhoneProxy.Instance.sendCheckVerificationCode(_.GameEnum.VerificationType.SMS_TYPE_CHANGE_PHONE, e, t) : m.PopHelper.Instance.showTips(s.default.getString("KYC_OPT_FAILED"));
});
}) : m.PopHelper.Instance.showTips(s.default.getString("KYC_OPT_FAILED"));
};
t.prototype.onCloseClicked = function() {
if (-1 != this._interval) {
clearInterval(this._interval);
this._interval = -1;
}
this.closeAction();
};
i([ S(cc.Node) ], t.prototype, "AlertPanel", void 0);
i([ S(cc.Sprite) ], t.prototype, "UserHeadImage", void 0);
i([ S(cc.EditBox) ], t.prototype, "NameInput", void 0);
i([ S(cc.Node) ], t.prototype, "PhoneInputNode", void 0);
i([ S(cc.Node) ], t.prototype, "PhoneInfoNode", void 0);
i([ S(cc.Label) ], t.prototype, "PhoneNumber", void 0);
i([ S(r.default) ], t.prototype, "PhoneInput", void 0);
i([ S(r.default) ], t.prototype, "OTPInput", void 0);
i([ S(cc.Button) ], t.prototype, "SendOTPButton", void 0);
i([ S(cc.Node) ], t.prototype, "SendOTPButtonTitle", void 0);
i([ S(cc.Label) ], t.prototype, "Time", void 0);
i([ S(cc.Node) ], t.prototype, "SaveButton", void 0);
i([ S(cc.Label) ], t.prototype, "SaveTitle", void 0);
i([ S(cc.Node) ], t.prototype, "EditButton", void 0);
return i([ E ], t);
}(cc.Component);
o.default = T;
cc._RF.pop();
}, {
"../../../../Game/client/global/enum/game/Const": "Const",
"../../../../Game/client/global/enum/game/Event": "Event",
"../../../../Game/client/global/enum/game/Game": "Game",
"../../../../Game/client/global/enum/game/UIUtils": "UIUtils",
"../../../../Game/client/model/LanguageModel": "LanguageModel",
"../../../../Game/fromework/global/Tools": "Tools",
"../../../../Game/fromework/helper/EventHelper": "EventHelper",
"../../../../Game/fromework/helper/UIHelper": "UIHelper",
"../../../../Game/fromework/mvvm/modelView/ViewModel": "ViewModel",
"../../../../platform/Platform": "Platform",
"../../../component/NumericLabel": "NumericLabel",
"../../../component/pop/BindAlert": "BindAlert",
"../../../global/PopHelper": "PopHelper",
"../../../model/PhoneModel": "PhoneModel",
"../../../model/WalletModel": "WalletModel",
"../../Wallet/WalletHelper": "WalletHelper"
} ],
UserModel: [ function(e, t, o) {
"use strict";
cc._RF.push(t, "2ae3bPRe4xIN49mumigLET/", "UserModel");
Object.defineProperty(o, "__esModule", {
value: !0
});
o.user = o.UserModel = o.userSoundHavePlay = o.OrganicSwitch = o.ClientSwitch = void 0;
var n = e("../../Config"), a = e("../../Game/Script/global/GlobalValue"), i = e("../../Game/client/global/enum/game/Const"), r = e("../../Game/client/global/enum/game/Event"), l = e("../../Game/client/global/enum/net/C2S"), s = e("../../Game/client/global/enum/net/S2C"), c = e("../../Game/client/model/LanguageModel"), u = e("../../Game/client/model/UpdateModel"), d = e("../../Game/fromework/helper/EventHelper"), p = e("../../Game/fromework/mvvm/modelView/ViewModel"), h = e("../../platform/Platform"), f = e("../../fromework/helper/NetHelper"), _ = e("../global/Global"), m = e("./WalletModel"), y = e("../../Game/fromework/global/Tools");
(function(e) {
e[e.CLIENT_FUNC_SWITCH_WEB = 1] = "CLIENT_FUNC_SWITCH_WEB";
e[e.CLIENT_FUNC_SWITCH_SIGN = 2] = "CLIENT_FUNC_SWITCH_SIGN";
e[e.CLIENT_FUNC_SWITCH_WITHDRAW_DETAILS = 4] = "CLIENT_FUNC_SWITCH_WITHDRAW_DETAILS";
e[e.CLIENT_FUNC_SWITCH_PAY_GUIDE = 8] = "CLIENT_FUNC_SWITCH_PAY_GUIDE";
e[e.CLIENT_FUNC_SWITCH_PLAY_NOW = 16] = "CLIENT_FUNC_SWITCH_PLAY_NOW";
e[e.CLIENT_FUNC_SWITCH_OPEN_PLATFORM = 32] = "CLIENT_FUNC_SWITCH_OPEN_PLATFORM";
e[e.CLIENT_FUNC_SWITCH_MONTH_CARD = 64] = "CLIENT_FUNC_SWITCH_MONTH_CARD";
e[e.CLIENT_FUNC_SWITCH_VIP_STORE = 128] = "CLIENT_FUNC_SWITCH_VIP_STORE";
e[e.CLIENT_FUNC_SWITCH_REFER = 256] = "CLIENT_FUNC_SWITCH_REFER";
e[e.CLIENT_FUNC_SWITCH_TASK = 512] = "CLIENT_FUNC_SWITCH_TASK";
e[e.CLIENT_FUNC_SWITCH_GP_SHARE = 2048] = "CLIENT_FUNC_SWITCH_GP_SHARE";
e[e.CLIENT_FUNC_SWITCH_KYC = 32768] = "CLIENT_FUNC_SWITCH_KYC";
})(o.ClientSwitch || (o.ClientSwitch = {}));
(function(e) {
e[e.ORGANIC_FUNC_SWITCH_RECHARGE = 1] = "ORGANIC_FUNC_SWITCH_RECHARGE";
})(o.OrganicSwitch || (o.OrganicSwitch = {}));
var g = function() {
function e() {}
e.SOUND_LOBBY_BOSS = 0;
e.SOUND_EXCHANGE_WIN = 0;
e.SOUND_TREASUEBOX_ONE = 0;
e.SOUND_GOLDSLEVRYCARD_BUY = 0;
e.SOUND_BONUS_WELLCOME = 0;
e.SOUND_VIP_HIGHER = 0;
e.SOUND_BOX_MORE = 0;
e.SOUND_SHOP_RECHARGE = 0;
e.SOUND_WITHDRAW_WITHDRAW = 0;
return e;
}();
o.userSoundHavePlay = g;
var v = function() {
function e() {
this.account = "";
this.uid = 0;
this.name = "";
this.token = "";
this.isFirstLogin = !1;
this.headUrl = "";
this.isBinding = !1;
this.is_binding_open_platform = !1;
this.guide_rtype = "";
this.sort_coefficient = 2.5;
this.update_reward = {};
this.daily_reward = [];
this.vip_level = 0;
this.vip_exp = 0;
this.client_func_switch = 0;
this.org_func_switch = 0;
this.source_config = {};
}
e.prototype.refreshData = function(e) {
p.VM.setValue("user.account", e.account);
p.VM.setValue("user.uid", parseInt(e.uid));
p.VM.setValue("user.name", e.name);
p.VM.setValue("user.token", e.token);
p.VM.setValue("user.isFirstLogin", 1 == e.is_first);
p.VM.setValue("user.headUrl", e.head_url);
p.VM.setValue("user.isBinding", e.is_binding);
p.VM.setValue("user.is_binding_open_platform", null != e.is_binding_open_platform && 1 == e.is_binding_open_platform);
p.VM.setValue("user.guide_rtype", null != e.guide_rtype ? e.guide_rtype : "");
p.VM.setValue("user.sort_coefficient", null != e.sort_coefficient ? parseFloat(e.sort_coefficient) : 2.5);
p.VM.setValue("user.update_reward", null != e.update_reward ? e.update_reward : {});
p.VM.setValue("user.daily_reward", null != e.daily_reward ? e.daily_reward : []);
p.VM.setValue("user.vip_level", null != e.vip_level ? e.vip_level : 0);
p.VM.setValue("user.vip_exp", null != e.vip_exp ? e.vip_exp : 0);
p.VM.setValue("user.client_func_switch", null != e.client_func_switch ? e.client_func_switch : 0);
p.VM.setValue("user.org_func_switch", null != e.org_func_switch ? e.org_func_switch : 0);
p.VM.setValue("user.source_config", null != e.source_config ? e.source_config : {});
var t = p.VM.get("user").$data;
h.default.log(t);
};
return e;
}();
o.UserModel = v;
o.user = new v();
p.VM.add(o.user, "user");
var C = function() {
function e() {
this._curLoginParam = null;
this._phoneTokenIsTimeOut = !1;
}
Object.defineProperty(e, "Instance", {
get: function() {
e._instance || (e._instance = new e());
return e._instance;
},
enumerable: !1,
configurable: !0
});
e.prototype.Init = function() {
d.default.Instance.Net.bind(s.S2C.USER.REGISTER, this._onRegister, this);
d.default.Instance.Net.bind(s.S2C.USER.LOGIN_PHONE, this._onPhoneLogin, this);
d.default.Instance.Net.bind(s.S2C.USER.LOGIN_PHONE_TOKEN, this._onPhoneLogin, this);
d.default.Instance.Net.bind(s.S2C.USER.LOGIN_GUEST, this._onLogin, this);
d.default.Instance.Net.bind(s.S2C.USER.LOGIN_OTHER, this._onLogin, this);
d.default.Instance.Net.bind(s.S2C.USER.LOGIN_CODE, this._onLoginPhoneOtp, this);
d.default.Instance.Net.bind(s.S2C.USER.UPDATE_REWARD, this._onUpdateReward, this);
d.default.Instance.Net.bind(s.S2C.USER.GET_VIP_INFO, this._onGetVIPInfo, this);
d.default.Instance.Net.bind(s.S2C.USER.USER_MODIFY_DEFAULT_HEAD, this._onChangeDefaultHead, this);
};
Object.defineProperty(e.prototype, "phoneTokenIsTimeOut", {
get: function() {
return this._phoneTokenIsTimeOut;
},
set: function(e) {
this._phoneTokenIsTimeOut = e;
},
enumerable: !1,
configurable: !0
});
e.prototype.isBindedOpenPlatform = function() {
return p.VM.getValue("user.is_binding_open_platform");
};
e.prototype.getPlatform = function() {
return cc.sys.isNative ? cc.sys.os == cc.sys.OS_ANDROID ? "android" : cc.sys.os == cc.sys.OS_IOS ? "ios" : "other" : "web";
};
e.prototype.loginCallFunc = function(t) {
h.default.log("------------------------------------- loginCallFunc ---", t.head_url);
h.default.log("loginCallFunc ---theData:", JSON.stringify(t));
cc.sys.localStorage.setItem("CommonUserUid", t.uid);
if (t.service_info) {
a.default.getInstance().HttpServerUrl = t.service_info.web_url;
a.default.getInstance().WebSocketUrl = t.service_info.gate_url;
a.default.getInstance().WalletUrl = t.service_info.gm_url;
a.default.getInstance().ServiceUrl = t.service_info.kefu_url;
a.default.getInstance().isWhaleUser = t.service_info.in_white_list;
d.default.Instance.nativTimeArryScheduleOpen();
f.default.Instance.HttpUrl = t.service_info.web_url;
h.default.log("loginCallFunc ---theData: 替换 --------------------------- ");
}
o.user.refreshData(t);
e.Instance.setArriagn(t.func_level);
var n = JSON.parse(cc.sys.localStorage.getItem("LastLoginParam")), i = JSON.parse(cc.sys.localStorage.getItem(r.SDKEvent.SDKEVENT_FIRST_LOGIN));
if (!(i = null != i && i)) {
cc.sys.localStorage.setItem(r.SDKEvent.SDKEVENT_FIRST_LOGIN, JSON.stringify(!0));
h.default.logSignUp(n.type);
h.default.sendCompleteRegistrationEvent(n.type);
}
h.default.sendLoginEvent();
h.default.logLogin(null == n ? void 0 : n.type);
var l = new Date(1e3 * parseInt(t.reg_time)), s = l.getDate() < 10 ? "0" + l.getDate() : l.getDate() + "", c = l.getFullYear(), u = l.getMonth() + 1 < 10 ? "0" + (l.getMonth() + 1) : l.getMonth() + 1, p = new Date(1e3 * parseInt(t.server_time)), m = p.getDate() < 10 ? "0" + p.getDate() : p.getDate() + "", y = p.getFullYear(), g = p.getMonth() + 1 < 10 ? "0" + (p.getMonth() + 1) : p.getMonth() + 1;
_.Global.Instance.isCurLoginRegist = m == s && y == c && g == u;
_.Global.Instance.resetTime = t.reg_time;
_.Global.Instance.serverTime = t.server_time;
_.Global.Instance.TimeDifference = Math.round(Number(new Date().getTime()) / 1e3) - Number(t.server_time);
d.default.Instance.Global.emit(r.UserEvent.USER_LOGIN_SUCCESS);
_.Global.Instance.down_safe_reward = {};
if (t.down_safe_reward) for (var v in t.down_safe_reward) t.down_safe_reward[v] && t.down_safe_reward[v] > 0 && (_.Global.Instance.down_safe_reward[v] = (t.down_safe_reward[v] / 1e3).toFixed(0));
_.Global.Instance.down_safe_trigger = t.down_safe_trigger;
if (t.reg_reward) {
_.Global.Instance.login_reward = {};
for (var v in t.reg_reward) t.reg_reward[v] && t.reg_reward[v] > 0 && (_.Global.Instance.login_reward[v] = (t.reg_reward[v] / 1e3).toFixed(0));
}
};
e.prototype.setArriagn = function(e) {
var t = u.default.Instance.serverConfig, o = a.default.getInstance().isCashGame;
a.default.getInstance().func_level = e;
a.default.getInstance().isCashGame = 2 == t.func_state;
if (o != a.default.getInstance().isCashGame) {
c.default.Instance.Init();
d.default.Instance.Global.emit(r.GameUIEvent.REFRESH_CASH);
}
};
e.checkSwitch = function(e) {
return 0 != (p.VM.getValue("user.client_func_switch") & e);
};
e.checkOrganicSwitch = function(e) {
return 0 != (p.VM.getValue("user.org_func_switch") & e);
};
e.prototype._onRegister = function() {
d.default.Instance.Global.emit(r.UserEvent.USER_REGISTER_SUCCESS);
};
e.prototype._onPhoneLogin = function(e) {
var t = e.getUserData();
this._curLoginParam.cd = "";
this._curLoginParam.ac = "";
this._curLoginParam.login_token = t.login_token;
this._curLoginParam.ad = h.default.getAdType();
cc.sys.localStorage.setItem("LastLoginParam", JSON.stringify(this._curLoginParam));
this._curLoginParam = null;
this.loginCallFunc(t);
};
e.prototype._onLogin = function(e) {
var t = e.getUserData();
cc.sys.localStorage.setItem("LastLoginParam", JSON.stringify(this._curLoginParam));
this._curLoginParam = null;
h.default.log(" UserProxy   _onLogin  ");
this.loginCallFunc(t);
};
e.prototype._onLoginPhoneOtp = function(e) {
var t = e.getUserData();
d.default.Instance.Global.emit(r.UserEvent.USER_LOGIN_PHONE_OTP, t);
};
e.prototype._onUpdateReward = function(e) {
var t = e.getUserData();
p.VM.setValue("user.update_reward", {
1: 0,
4: 0
});
m.WalletProxy.Instance.sendGetUserWallet();
d.default.Instance.Global.emit(r.UserEvent.USER_UPDATE_REWARD, t);
};
e.prototype._onGetVIPInfo = function(e) {
var t = e.getUserData();
p.VM.setValue("user.vip_level", null != t.vip_level ? t.vip_level : 0);
p.VM.setValue("user.vip_exp", null != t.vip_exp ? t.vip_exp : 0);
d.default.Instance.Global.emit(r.UserEvent.USER_UPDATE_VIP_INFO);
};
e.prototype._onChangeDefaultHead = function(e) {
var t = e.getUserData();
p.VM.setValue("user.headUrl", t.head);
};
e.prototype.sendRegister = function(e, t, o) {
var n = f.default.Instance.makeMsg(l.C2S.USER_REGISTER, {
a: e,
c: t,
p: o
});
f.default.Instance.sendLoadHttp(n);
};
e.prototype.sendLoginPhoneOtp = function(e, t, o) {
void 0 === o && (o = 91);
var n = f.default.Instance.makeMsg(l.C2S.USER_LOGIN_CODE, {
pn: e,
ac: o,
channel: t
});
f.default.Instance.sendLoadHttp(n);
};
e.prototype.sendLoginPhone = function(e) {
var t = "", o = "0", n = h.default.getTextFromClipboard();
if (null != n && "" != n) {
t = y.Tools.TStr.getQueryString("zone", n);
o = y.Tools.TStr.getQueryString("invite_id", n);
}
var a = f.default.Instance.makeMsg(l.C2S.USER_LOGIN_PHONE, {
package: e.packageName ? e.packageName : "",
imei: e.onlyID,
device_info: e.device_info,
source: e.channel,
channel: i.LoginType.Phone,
platform: e.platform,
version: e.version,
phone: e.phoneNumber ? e.phoneNumber : "",
area_code: e.ac ? e.ac : "",
code: e.cd ? e.cd : "",
hot_update_version: e.hot_update_version,
afid: e.afid ? e.afid : "",
app_instance_id: e.app_instance_id ? e.app_instance_id : "",
advertising_id: e.advertising_id ? e.advertising_id : "",
ad: h.default.getAdType(),
zone: t,
invite_uid: o
});
this._curLoginParam = e;
f.default.Instance.sendLoadHttp(a);
};
e.prototype.sendLoginPhoneToken = function(e) {
var t = "", o = "0", n = h.default.getTextFromClipboard();
if (null != n && "" != n) {
t = y.Tools.TStr.getQueryString("zone", n);
o = y.Tools.TStr.getQueryString("invite_id", n);
}
var a = f.default.Instance.makeMsg(l.C2S.USER_LOGIN_PHONE_TOKEN, {
package: e.packageName ? e.packageName : "",
imei: e.onlyID,
device_info: e.device_info,
source: e.channel,
channel: i.LoginType.Phone,
platform: e.platform,
version: e.version,
phone: e.phoneNumber ? e.phoneNumber : "",
area_code: e.ac ? e.ac : "",
code: e.cd ? e.cd : "",
login_token: e.login_token ? e.login_token : "",
hot_update_version: e.hot_update_version,
afid: e.afid ? e.afid : "",
app_instance_id: e.app_instance_id ? e.app_instance_id : "",
advertising_id: e.advertising_id ? e.advertising_id : "",
ad: h.default.getAdType(),
zone: t,
invite_uid: o
});
this._curLoginParam = e;
f.default.Instance.sendLoginPhoneTokenHttp(a);
};
e.prototype.sendLoginGuest = function(e) {
var t = "", o = "0", n = h.default.getTextFromClipboard();
if (null != n && "" != n) {
t = y.Tools.TStr.getQueryString("zone", n);
o = y.Tools.TStr.getQueryString("invite_id", n);
}
var a = f.default.Instance.makeMsg(l.C2S.USER_LOGIN_GUEST, {
package: e.packageName ? e.packageName : "",
imei: e.onlyID,
device_info: e.device_info,
source: e.channel,
channel: i.LoginType.Guest,
platform: e.platform,
version: e.version,
hot_update_version: e.hot_update_version,
afid: e.afid ? e.afid : "",
app_instance_id: e.app_instance_id ? e.app_instance_id : "",
advertising_id: e.advertising_id ? e.advertising_id : "",
ad: h.default.getAdType(),
zone: t,
invite_uid: o
});
this._curLoginParam = e;
f.default.Instance.sendLoadHttp(a);
};
e.prototype.sendLoginOther = function(e) {
var t = "", o = "0", n = h.default.getTextFromClipboard();
if (null != n && "" != n) {
t = y.Tools.TStr.getQueryString("zone", n);
o = y.Tools.TStr.getQueryString("invite_id", n);
}
var a = f.default.Instance.makeMsg(l.C2S.USER_LOGIN_OTHER, {
package: e.packageName ? e.packageName : "",
imei: e.onlyID,
device_info: e.device_info,
source: e.channel,
channel: e.type,
platform: e.platform,
version: e.version,
open_id: e.openID,
name: e.userName ? e.userName : "",
head_url: e.userHead ? e.userHead : "",
hot_update_version: e.hot_update_version,
afid: e.afid ? e.afid : "",
app_instance_id: e.app_instance_id ? e.app_instance_id : "",
advertising_id: e.advertising_id ? e.advertising_id : "",
ad: h.default.getAdType(),
zone: t,
invite_uid: o
});
this._curLoginParam = e;
f.default.Instance.sendLoadHttp(a);
};
e.prototype.sendUpdateReward = function() {
var e, t = h.default.getPackageName(), o = n.Config.Channel, a = u.default.Instance.updateVersion, i = p.VM.getValue("user.uid"), r = p.VM.getValue("user.token");
e = cc.sys.isNative ? h.default.getOnlyID() : "web_imei";
null == i && (i = "");
var s = f.default.Instance.makeMsg(l.C2S.USER_UPDATE_REWARD, {
packageName: t,
channel: o,
version: a,
imei: e,
u: i,
t: r
});
f.default.Instance.send(s);
};
e.prototype.sendGetVIPInfo = function() {
var e = p.VM.getValue("user.uid"), t = p.VM.getValue("user.token");
null == e && (e = "");
var o = f.default.Instance.makeMsg(l.C2S.USER_GET_VIP_INFO, {
u: e,
t: t
});
f.default.Instance.sendHttp(o);
};
e.prototype.sendBindOpenPlatform = function(e, t, o, n) {
var a = p.VM.getValue("user.uid"), i = p.VM.getValue("user.token"), r = t || "", s = o || "", c = f.default.Instance.makeMsg(l.C2S.USER_BIND_OPENPLATFORM, {
u: a,
t: i,
open_id: e,
_name: r,
head_url: s,
channel: n
});
f.default.Instance.send(c);
};
e.prototype.sendChangeDefaultHead = function(e) {
var t = p.VM.getValue("user.uid"), o = p.VM.getValue("user.token"), n = f.default.Instance.makeMsg(l.C2S.USER_MODIFY_DEFAULT_HEAD, {
u: t,
t: o,
head: e
});
f.default.Instance.send(n);
};
e._instance = null;
return e;
}();
o.default = C;
cc._RF.pop();
}, {
"../../Config": "Config",
"../../Game/Script/global/GlobalValue": "GlobalValue",
"../../Game/client/global/enum/game/Const": "Const",
"../../Game/client/global/enum/game/Event": "Event",
"../../Game/client/global/enum/net/C2S": "C2S",
"../../Game/client/global/enum/net/S2C": "S2C",
"../../Game/client/model/LanguageModel": "LanguageModel",
"../../Game/client/model/UpdateModel": "UpdateModel",
"../../Game/fromework/global/Tools": "Tools",
"../../Game/fromework/helper/EventHelper": "EventHelper",
"../../Game/fromework/mvvm/modelView/ViewModel": "ViewModel",
"../../fromework/helper/NetHelper": "NetHelper",
"../../platform/Platform": "Platform",
"../global/Global": "Global",
"./WalletModel": "WalletModel"
} ],
UserSetting: [ function(e, t, o) {
"use strict";
cc._RF.push(t, "962ceEwEWJH65NjHOt9iiDL", "UserSetting");
var n, a = this && this.__extends || (n = function(e, t) {
return (n = Object.setPrototypeOf || {
__proto__: []
} instanceof Array && function(e, t) {
e.__proto__ = t;
} || function(e, t) {
for (var o in t) Object.prototype.hasOwnProperty.call(t, o) && (e[o] = t[o]);
})(e, t);
}, function(e, t) {
n(e, t);
function o() {
this.constructor = e;
}
e.prototype = null === t ? Object.create(t) : (o.prototype = t.prototype, new o());
}), i = this && this.__decorate || function(e, t, o, n) {
var a, i = arguments.length, r = i < 3 ? t : null === n ? n = Object.getOwnPropertyDescriptor(t, o) : n;
if ("object" == typeof Reflect && "function" == typeof Reflect.decorate) r = Reflect.decorate(e, t, o, n); else for (var l = e.length - 1; l >= 0; l--) (a = e[l]) && (r = (i < 3 ? a(r) : i > 3 ? a(t, o, r) : a(t, o)) || r);
return i > 3 && r && Object.defineProperty(t, o, r), r;
};
Object.defineProperty(o, "__esModule", {
value: !0
});
var r = e("../../../../Game/Script/global/GlobalValue"), l = e("../../../../Game/fromework/global/Tools"), s = e("../../../../Game/fromework/helper/EventHelper"), c = e("../../../../Game/fromework/helper/UIHelper"), u = e("../../../../Game/fromework/mvvm/modelView/ViewModel"), d = e("../../../../Game/client/global/enum/game/Event"), p = e("../../../../Game/client/model/LanguageModel"), h = e("../../../model/UserModel"), f = e("../../Wallet/WalletHelper"), _ = e("../UserInfo/UserInfo"), m = e("../VIP/VIPLogic"), y = e("../../../../Game/client/global/enum/game/Const"), g = cc._decorator, v = g.ccclass, C = g.property, b = function(e) {
a(t, e);
function t() {
var t = null !== e && e.apply(this, arguments) || this;
t.MainPanel = null;
t.VIPNode = null;
t.KYCNode = null;
t.ReferNode = null;
t.VIPShopButton = null;
t.VIPUpgrade = null;
t.VIPExpProgress = null;
t.VIPExp = null;
t._isPlayAnimation = !1;
return t;
}
t.prototype.playInAnimation = function(e, t) {
var o = this;
if (!this._isPlayAnimation) {
this._isPlayAnimation = !0;
e.on(cc.Animation.EventType.FINISHED, function() {
o._isPlayAnimation = !1;
t && t();
}, this);
e.play("SettingLeftIn");
}
};
t.prototype.playOutAnimation = function(e, t) {
var o = this;
if (!this._isPlayAnimation) {
this._isPlayAnimation = !0;
e.on(cc.Animation.EventType.FINISHED, function() {
o._isPlayAnimation = !1;
t && t();
}, this);
e.play("SettingLeftOut");
}
};
t.prototype.onEnable = function() {
s.default.Instance.Global.bind(d.UserEvent.USER_UPDATE_VIP_INFO, this.refreshVIP, this);
};
t.prototype.onDisable = function() {
s.default.Instance.Global.unbind(d.UserEvent.USER_UPDATE_VIP_INFO, this.refreshVIP, this);
};
t.prototype.start = function() {
h.default.Instance.sendGetVIPInfo();
var e = r.default.getInstance().isCashGame;
this.VIPNode.active = e;
this.KYCNode.active = e;
this.ReferNode.active = e && 1 == h.default.checkSwitch(h.ClientSwitch.CLIENT_FUNC_SWITCH_REFER);
this.VIPShopButton.active = e && 1 == h.default.checkSwitch(h.ClientSwitch.CLIENT_FUNC_SWITCH_VIP_STORE);
this.MainPanel.active = !0;
this.playInAnimation(this.MainPanel.getComponent(cc.Animation));
};
t.prototype.refreshVIP = function() {
if (m.default.Instance.isMaxLevel()) {
this.VIPExpProgress.progress = 1;
this.VIPExp.string = p.default.getString("COMMON_TEXT_MAX");
} else {
var e = m.default.Instance.getVipConfig(u.VM.getValue("user.vip_level") + 1);
this.VIPUpgrade.string = l.Tools.TStr.replaceString(p.default.getString("VIP_USER_UPGRADE_TIPS"), {
recharge: m.default.Instance.nextExp
});
var t = u.VM.getValue("user.vip_exp") / e.exp;
t < 0 && (t = 0);
t > 1 && (t = 1);
this.VIPExpProgress.progress = t;
this.VIPExp.string = u.VM.getValue("user.vip_exp") + "/" + e.exp;
}
};
t.prototype.onVIPPrivilegeClicked = function() {
var e = this;
this.playOutAnimation(this.MainPanel.getComponent(cc.Animation), function() {
c.default.Instance.removeMaskLayer(e.node);
c.default.Instance.addBundleMaskLayer(y.BundleUIPath.VIPDetail);
});
};
t.prototype.onVIPShopClicked = function() {
var e = this;
this.playOutAnimation(this.MainPanel.getComponent(cc.Animation), function() {
c.default.Instance.removeMaskLayer(e.node);
c.default.Instance.addBundleMaskLayer(y.BundleUIPath.VIPShop);
});
};
t.prototype.onChangeUserClicked = function() {
var e = this;
this.playOutAnimation(this.MainPanel.getComponent(cc.Animation), function() {
c.default.Instance.removeMaskLayer(e.node);
c.default.Instance.addBundleMaskLayer(y.BundleUIPath.UserInfo, function(e) {
e.getComponent(_.default).InitView(0);
});
});
};
t.prototype.onKYCClicked = function() {
var e = this;
this.playOutAnimation(this.MainPanel.getComponent(cc.Animation), function() {
f.default.Instance.openKYC();
c.default.Instance.removeMaskLayer(e.node);
});
};
t.prototype.onBonusBalanceClicked = function() {
var e = this;
this.playOutAnimation(this.MainPanel.getComponent(cc.Animation), function() {
f.default.Instance.openBonusRecord();
c.default.Instance.removeMaskLayer(e.node);
});
};
t.prototype.onReferClicked = function() {
var e = this;
this.playOutAnimation(this.MainPanel.getComponent(cc.Animation), function() {
f.default.Instance.openReferearn();
c.default.Instance.removeMaskLayer(e.node);
});
};
t.prototype.onCloseClicked = function() {
var e = this;
this.playOutAnimation(this.MainPanel.getComponent(cc.Animation), function() {
c.default.Instance.removeMaskLayer(e.node);
});
};
i([ C(cc.Node) ], t.prototype, "MainPanel", void 0);
i([ C(cc.Node) ], t.prototype, "VIPNode", void 0);
i([ C(cc.Node) ], t.prototype, "KYCNode", void 0);
i([ C(cc.Node) ], t.prototype, "ReferNode", void 0);
i([ C(cc.Node) ], t.prototype, "VIPShopButton", void 0);
i([ C(cc.Label) ], t.prototype, "VIPUpgrade", void 0);
i([ C(cc.ProgressBar) ], t.prototype, "VIPExpProgress", void 0);
i([ C(cc.Label) ], t.prototype, "VIPExp", void 0);
return i([ v ], t);
}(cc.Component);
o.default = b;
cc._RF.pop();
}, {
"../../../../Game/Script/global/GlobalValue": "GlobalValue",
"../../../../Game/client/global/enum/game/Const": "Const",
"../../../../Game/client/global/enum/game/Event": "Event",
"../../../../Game/client/model/LanguageModel": "LanguageModel",
"../../../../Game/fromework/global/Tools": "Tools",
"../../../../Game/fromework/helper/EventHelper": "EventHelper",
"../../../../Game/fromework/helper/UIHelper": "UIHelper",
"../../../../Game/fromework/mvvm/modelView/ViewModel": "ViewModel",
"../../../model/UserModel": "UserModel",
"../../Wallet/WalletHelper": "WalletHelper",
"../UserInfo/UserInfo": "UserInfo",
"../VIP/VIPLogic": "VIPLogic"
} ],
VIPDetailItem: [ function(e, t, o) {
"use strict";
cc._RF.push(t, "70d14Hc4rFLKpYjVWJQfa8/", "VIPDetailItem");
var n, a = this && this.__extends || (n = function(e, t) {
return (n = Object.setPrototypeOf || {
__proto__: []
} instanceof Array && function(e, t) {
e.__proto__ = t;
} || function(e, t) {
for (var o in t) Object.prototype.hasOwnProperty.call(t, o) && (e[o] = t[o]);
})(e, t);
}, function(e, t) {
n(e, t);
function o() {
this.constructor = e;
}
e.prototype = null === t ? Object.create(t) : (o.prototype = t.prototype, new o());
}), i = this && this.__decorate || function(e, t, o, n) {
var a, i = arguments.length, r = i < 3 ? t : null === n ? n = Object.getOwnPropertyDescriptor(t, o) : n;
if ("object" == typeof Reflect && "function" == typeof Reflect.decorate) r = Reflect.decorate(e, t, o, n); else for (var l = e.length - 1; l >= 0; l--) (a = e[l]) && (r = (i < 3 ? a(r) : i > 3 ? a(t, o, r) : a(t, o)) || r);
return i > 3 && r && Object.defineProperty(t, o, r), r;
};
Object.defineProperty(o, "__esModule", {
value: !0
});
var r = e("../../../../Game/fromework/mvvm/modelView/ViewModel"), l = cc._decorator, s = l.ccclass, c = l.property, u = function(e) {
a(t, e);
function t() {
var t = null !== e && e.apply(this, arguments) || this;
t.Background = null;
t.Cell_Frames = [];
t.NonVIP = null;
t.VIPBg = null;
t.VIPLevel = null;
t.VIPExp = null;
t.BonusReward = null;
t.BonusRelease = null;
t.MinWithdraw = null;
t.WithdrawNum = null;
t._data = null;
return t;
}
t.prototype.onItemInitCallFunc = function(e, t) {
this._data = e;
var o = r.VM.getValue("user.vip_level") == this._data.level;
this.Background.spriteFrame = this.Cell_Frames[o ? 2 : t % 2];
this.NonVIP.active = 0 == this._data.level;
this.VIPBg.active = 0 != this._data.level;
this.VIPLevel.string = "V" + this._data.level;
this.VIPExp.string = 0 == this._data.level ? "N/A" : this._data.exp + "";
this.BonusReward.string = this._data.recharge_rate + "%";
this.BonusRelease.string = this._data.discount_rate + "%";
this.MinWithdraw.string = this._data.withdraw_conf.min_amount + "";
this.WithdrawNum.string = this._data.withdraw_conf.withdraw_number + "";
};
t.prototype.onItemEnterCallFunc = function() {
this.node.opacity = 255;
};
t.prototype.onItemExitCallFunc = function() {
this.node.opacity = 0;
};
i([ c(cc.Sprite) ], t.prototype, "Background", void 0);
i([ c([ cc.SpriteFrame ]) ], t.prototype, "Cell_Frames", void 0);
i([ c(cc.Node) ], t.prototype, "NonVIP", void 0);
i([ c(cc.Node) ], t.prototype, "VIPBg", void 0);
i([ c(cc.Label) ], t.prototype, "VIPLevel", void 0);
i([ c(cc.Label) ], t.prototype, "VIPExp", void 0);
i([ c(cc.Label) ], t.prototype, "BonusReward", void 0);
i([ c(cc.Label) ], t.prototype, "BonusRelease", void 0);
i([ c(cc.Label) ], t.prototype, "MinWithdraw", void 0);
i([ c(cc.Label) ], t.prototype, "WithdrawNum", void 0);
return i([ s ], t);
}(cc.Component);
o.default = u;
cc._RF.pop();
}, {
"../../../../Game/fromework/mvvm/modelView/ViewModel": "ViewModel"
} ],
VIPDetail: [ function(e, t, o) {
"use strict";
cc._RF.push(t, "2ea8acEQyhPg5uATDdiQQQe", "VIPDetail");
var n, a = this && this.__extends || (n = function(e, t) {
return (n = Object.setPrototypeOf || {
__proto__: []
} instanceof Array && function(e, t) {
e.__proto__ = t;
} || function(e, t) {
for (var o in t) Object.prototype.hasOwnProperty.call(t, o) && (e[o] = t[o]);
})(e, t);
}, function(e, t) {
n(e, t);
function o() {
this.constructor = e;
}
e.prototype = null === t ? Object.create(t) : (o.prototype = t.prototype, new o());
}), i = this && this.__decorate || function(e, t, o, n) {
var a, i = arguments.length, r = i < 3 ? t : null === n ? n = Object.getOwnPropertyDescriptor(t, o) : n;
if ("object" == typeof Reflect && "function" == typeof Reflect.decorate) r = Reflect.decorate(e, t, o, n); else for (var l = e.length - 1; l >= 0; l--) (a = e[l]) && (r = (i < 3 ? a(r) : i > 3 ? a(t, o, r) : a(t, o)) || r);
return i > 3 && r && Object.defineProperty(t, o, r), r;
};
Object.defineProperty(o, "__esModule", {
value: !0
});
var r = e("../../../../fromework/component/listView/ListView"), l = e("../../../../Game/client/model/LanguageModel"), s = e("../../../model/VIPModel"), c = e("../../Wallet/WalletHelper"), u = e("./VIPLogic"), d = e("../../../../Game/fromework/helper/EventHelper"), p = e("../../../../Game/client/global/enum/game/Event"), h = e("../../../../Game/fromework/global/Tools"), f = e("../../../../Game/fromework/mvvm/modelView/ViewModel"), _ = e("../../../global/PopHelper"), m = e("../../../../Game/fromework/helper/UIHelper"), y = cc._decorator, g = y.ccclass, v = y.property, C = function(e) {
a(t, e);
function t() {
var t = null !== e && e.apply(this, arguments) || this;
t.ListView = null;
t.Formula = null;
t.VIPLevel = null;
return t;
}
t.prototype.onEnable = function() {
d.default.Instance.Global.bind(p.VIPEvent.VIP_GET_CONGIF, this.refreshView, this);
};
t.prototype.onDisable = function() {
d.default.Instance.Global.unbind(p.VIPEvent.VIP_GET_CONGIF, this.refreshView, this);
};
t.prototype.onLoad = function() {
s.VIPProxy.Instance.sendGetVIPPermissions();
};
t.prototype.refreshView = function() {
var e = this;
u.default.Instance.isMaxLevel() ? this.VIPLevel.string = l.default.getString("VIP_TIPS_LEVEL_MAX") : this.VIPLevel.string = h.Tools.TStr.replaceString(l.default.getString("VIP_TIPS_LEVEL_EXP"), {
level: f.VM.getValue("user.vip_level"),
exp: u.default.Instance.nextExp
});
this.ListView.datas = s.VIPProxy.Instance.vipConfig;
var t = u.default.Instance.getVIPDetailIndex() - 1;
t < 0 && (t = 0);
t >= s.VIPProxy.Instance.vipConfig.length && (t = s.VIPProxy.Instance.vipConfig.length - 1);
this.scheduleOnce(function() {
e && e.node && e.node.isValid && e.ListView.scrollToIndex(t, .5);
});
};
t.prototype.onTipsClicked = function(e, t) {
var o = "";
"BonusReward" == t && (o = l.default.getString("VIP_DETAIL_TIP_BONUSREWARD"));
"BonusRelease" == t && (o = l.default.getString("VIP_DETAIL_TIP_BONUSRELEASE"));
"MinWithdraw" == t && (o = l.default.getString("VIP_DETAIL_TIP_MINWITHDRAW"));
var n = {
content: o,
rightTitle: l.default.getString("GENGXIN_QUEDING")
};
_.PopHelper.Instance.showAlert(n);
};
t.prototype.onRechargeClicked = function() {
m.default.Instance.removeMaskLayer(this.node, !0);
c.default.Instance.openRecharge();
};
t.prototype.onCloseBtnClicked = function() {
m.default.Instance.removeMaskLayer(this.node, !0);
};
i([ v(r.default) ], t.prototype, "ListView", void 0);
i([ v(cc.Label) ], t.prototype, "Formula", void 0);
i([ v(cc.Label) ], t.prototype, "VIPLevel", void 0);
return i([ g ], t);
}(cc.Component);
o.default = C;
cc._RF.pop();
}, {
"../../../../Game/client/global/enum/game/Event": "Event",
"../../../../Game/client/model/LanguageModel": "LanguageModel",
"../../../../Game/fromework/global/Tools": "Tools",
"../../../../Game/fromework/helper/EventHelper": "EventHelper",
"../../../../Game/fromework/helper/UIHelper": "UIHelper",
"../../../../Game/fromework/mvvm/modelView/ViewModel": "ViewModel",
"../../../../fromework/component/listView/ListView": "ListView",
"../../../global/PopHelper": "PopHelper",
"../../../model/VIPModel": "VIPModel",
"../../Wallet/WalletHelper": "WalletHelper",
"./VIPLogic": "VIPLogic"
} ],
VIPLogic: [ function(e, t, o) {
"use strict";
cc._RF.push(t, "a0f20mdXGdAgqbiWxkk6e+U", "VIPLogic");
Object.defineProperty(o, "__esModule", {
value: !0
});
var n = e("../../../../Game/fromework/global/Tools"), a = e("../../../../Game/fromework/mvvm/modelView/ViewModel"), i = e("../../../model/VIPModel"), r = function() {
function e() {}
Object.defineProperty(e, "Instance", {
get: function() {
e._instance || (e._instance = new e());
return e._instance;
},
enumerable: !1,
configurable: !0
});
e.prototype.isMaxLevel = function() {
return a.VM.getValue("user.vip_level") >= i.VIPProxy.Instance.vipConfig[i.VIPProxy.Instance.vipConfig.length - 1].level;
};
e.prototype.getVipConfig = function(e) {
var t = null == e ? a.VM.getValue("user.vip_level") : e, o = null;
i.VIPProxy.Instance.vipConfig.forEach(function(e) {
e.level == t && (o = e);
});
return o;
};
e.prototype.getVIPShopIndex = function() {
for (var e = -1, t = 0; t < i.VIPProxy.Instance.vipShopData.length; t++) if (3 == i.VIPProxy.Instance.vipShopData[t].buy_lock) {
e = t;
break;
}
if (-1 == e) for (t = 0; t < i.VIPProxy.Instance.vipShopData.length; t++) if (1 == i.VIPProxy.Instance.vipShopData[t].buy_lock) {
e = t;
break;
}
return -1 == e ? 0 : e;
};
e.prototype.getVIPDetailIndex = function() {
for (var e = 0, t = a.VM.getValue("user.vip_level"), o = 0; o < i.VIPProxy.Instance.vipConfig.length; o++) if (i.VIPProxy.Instance.vipConfig[o].level == t) {
e = o;
break;
}
return e;
};
e.prototype.vipExp2Recharge = function(e) {
return Math.ceil(e / 10);
};
e.prototype.getExpByLevel = function(e) {
var t = this.getVipConfig(e).exp - a.VM.getValue("user.vip_exp");
return n.Tools.TNumber.numFixed(t, 1);
};
Object.defineProperty(e.prototype, "nextExp", {
get: function() {
var e = a.VM.getValue("user.vip_exp"), t = this.getVipConfig(a.VM.getValue("user.vip_level") + 1);
if (t) {
var o = t.exp - e;
return n.Tools.TNumber.numFixed(o, 1);
}
return 0;
},
enumerable: !1,
configurable: !0
});
e.prototype.getRechargeBonus = function(e) {
var t = this.getVipConfig();
if (t) {
var o = e * t.recharge_rate;
o > 0 && (o /= 100);
return n.Tools.TNumber.numFixed(o, 2);
}
};
e._instance = null;
return e;
}();
o.default = r;
cc._RF.pop();
}, {
"../../../../Game/fromework/global/Tools": "Tools",
"../../../../Game/fromework/mvvm/modelView/ViewModel": "ViewModel",
"../../../model/VIPModel": "VIPModel"
} ],
VIPModel: [ function(e, t, o) {
"use strict";
cc._RF.push(t, "af5dfj/Q39Am7iSz3/uIv8+", "VIPModel");
Object.defineProperty(o, "__esModule", {
value: !0
});
o.VIPProxy = void 0;
var n = e("../global/PopHelper"), a = e("./RedDotModel"), i = e("./UserModel"), r = e("./WalletModel"), l = e("../global/Global"), s = e("../../Game/client/model/CommonModel"), c = e("../../Game/fromework/helper/EventHelper"), u = e("../../Game/client/global/enum/game/Event"), d = e("../../Game/client/global/enum/game/Game"), p = e("../../Game/fromework/mvvm/modelView/ViewModel"), h = e("../../Game/Script/global/GlobalValue"), f = e("../../Game/fromework/net/NetHttp"), _ = function() {
function e() {
this._vipConfig = [];
this._vipShopData = [];
this._vipWithdrawRule = null;
this._vipWithdrawRule = new s.Common.VIPWithdrawRule();
}
Object.defineProperty(e, "Instance", {
get: function() {
e._instance || (e._instance = new e());
return e._instance;
},
enumerable: !1,
configurable: !0
});
e.prototype.Init = function() {};
Object.defineProperty(e.prototype, "vipConfig", {
get: function() {
return this._vipConfig;
},
enumerable: !1,
configurable: !0
});
Object.defineProperty(e.prototype, "vipShopData", {
get: function() {
return this._vipShopData;
},
enumerable: !1,
configurable: !0
});
Object.defineProperty(e.prototype, "vipWithdrawRule", {
get: function() {
return this._vipWithdrawRule;
},
enumerable: !1,
configurable: !0
});
e.prototype._onGetVIPPermissions = function(e) {
var t = this, o = JSON.parse(e.response);
if (1 == o.code) {
this._vipConfig.splice(0);
o.data.forEach(function(e) {
var o = new s.Common.VIPLevelConfig(e);
t._vipConfig.push(o);
});
c.default.Instance.Global.emit(u.VIPEvent.VIP_GET_CONGIF);
}
};
e.prototype._onGetGiftList = function(e) {
var t = this, o = JSON.parse(e.response);
if (1 == o.code) {
this._vipShopData.splice(0);
var n = i.default.checkSwitch(i.ClientSwitch.CLIENT_FUNC_SWITCH_VIP_STORE), r = a.default.Instance.checkRedDotTime(d.GameEnum.RedDotKey.VIPShop, 1), l = 0;
o.data.list.forEach(function(e) {
var o = new s.Common.VIPShopGift(e);
n && r && 3 == o.buy_lock && l++;
t._vipShopData.push(o);
});
c.default.Instance.Global.emit(u.RedDotEvent.REFRESH_RED_DOT_DATA, {
key: d.GameEnum.RedDotKey.VIPShop,
value: l
});
c.default.Instance.Global.emit(u.VIPEvent.VIP_GET_GIFT_LIST);
}
};
e.prototype._onVIPGiftBuy = function(e) {
var t = JSON.parse(e.response);
if (1 == t.code) {
n.PopHelper.Instance.showReward(l.Global.Instance.changeReward(t.data), function() {});
this.sendGetGiftList();
r.WalletProxy.Instance.sendGetUserWallet();
} else c.default.Instance.Global.emit(u.VIPEvent.VIP_SHOP_BUY_FAILED, t.code);
};
e.prototype._onGetWithdrawGear = function(e) {
var t = JSON.parse(e.response);
if (1 == t.code) {
this._vipWithdrawRule.refresh(t.data);
c.default.Instance.Global.emit(u.VIPEvent.VIP_GET_WITHDRAW_RULE);
}
};
e.prototype.sendGetVIPPermissions = function() {
var e = {
uid: p.VM.getValue("user.uid"),
token: p.VM.getValue("user.token")
};
f.default.Instance.post(h.default.getInstance().WalletUrl + "vipPermissions", e, this._onGetVIPPermissions.bind(this), !0);
};
e.prototype.sendGetGiftList = function() {
var e = {
uid: p.VM.getValue("user.uid"),
token: p.VM.getValue("user.token")
};
f.default.Instance.post(h.default.getInstance().WalletUrl + "getGiftList", e, this._onGetGiftList.bind(this), !0);
};
e.prototype.sendVIPGiftBuy = function(e, t) {
var o = {
uid: p.VM.getValue("user.uid"),
token: p.VM.getValue("user.token"),
vipGiftId: e,
payType: t
};
f.default.Instance.post(h.default.getInstance().WalletUrl + "vipGiftBuy", o, this._onVIPGiftBuy.bind(this), !0);
};
e.prototype.sendGetWithdrawGear = function() {
var e = {
player_index: p.VM.getValue("user.uid"),
token: p.VM.getValue("user.token")
};
f.default.Instance.post(h.default.getInstance().WalletUrl + "getwithviprule", e, this._onGetWithdrawGear.bind(this), !0);
};
e._instance = null;
return e;
}();
o.VIPProxy = _;
cc._RF.pop();
}, {
"../../Game/Script/global/GlobalValue": "GlobalValue",
"../../Game/client/global/enum/game/Event": "Event",
"../../Game/client/global/enum/game/Game": "Game",
"../../Game/client/model/CommonModel": "CommonModel",
"../../Game/fromework/helper/EventHelper": "EventHelper",
"../../Game/fromework/mvvm/modelView/ViewModel": "ViewModel",
"../../Game/fromework/net/NetHttp": "NetHttp",
"../global/Global": "Global",
"../global/PopHelper": "PopHelper",
"./RedDotModel": "RedDotModel",
"./UserModel": "UserModel",
"./WalletModel": "WalletModel"
} ],
VIPShopItem: [ function(e, t, o) {
"use strict";
cc._RF.push(t, "4f691qos0RHwZZ5uQxLJo9Z", "VIPShopItem");
var n, a = this && this.__extends || (n = function(e, t) {
return (n = Object.setPrototypeOf || {
__proto__: []
} instanceof Array && function(e, t) {
e.__proto__ = t;
} || function(e, t) {
for (var o in t) Object.prototype.hasOwnProperty.call(t, o) && (e[o] = t[o]);
})(e, t);
}, function(e, t) {
n(e, t);
function o() {
this.constructor = e;
}
e.prototype = null === t ? Object.create(t) : (o.prototype = t.prototype, new o());
}), i = this && this.__decorate || function(e, t, o, n) {
var a, i = arguments.length, r = i < 3 ? t : null === n ? n = Object.getOwnPropertyDescriptor(t, o) : n;
if ("object" == typeof Reflect && "function" == typeof Reflect.decorate) r = Reflect.decorate(e, t, o, n); else for (var l = e.length - 1; l >= 0; l--) (a = e[l]) && (r = (i < 3 ? a(r) : i > 3 ? a(t, o, r) : a(t, o)) || r);
return i > 3 && r && Object.defineProperty(t, o, r), r;
};
Object.defineProperty(o, "__esModule", {
value: !0
});
var r = e("../../../../client/global/PopHelper"), l = e("../../../../Game/client/global/enum/game/Event"), s = e("../../../../Game/client/model/LanguageModel"), c = e("../../../../Game/fromework/helper/EventHelper"), u = e("../../../../Game/fromework/mvvm/modelView/ViewModel"), d = e("../../../model/VIPModel"), p = e("../../Wallet/WalletHelper"), h = cc._decorator, f = h.ccclass, _ = h.property, m = function(e) {
a(t, e);
function t() {
var t = null !== e && e.apply(this, arguments) || this;
t.VIPLevel = null;
t.RewardDeposit = null;
t.RewardBonus = null;
t.RewardWithdraw = null;
t.ButtonWithdraw = null;
t.ORIcon = null;
t.ButtonDeposit = null;
t.LockNode = null;
t.LockLabel = null;
t.FinishNode = null;
t.OneTime = null;
t.Icon = null;
t.Icon_Frames = [];
t._data = null;
return t;
}
t.prototype.onItemInitCallFunc = function(e, t) {
this._data = e;
this.VIPLevel.string = this._data.vip + "";
this.RewardBonus.node.active = this._data.give_bonus && this._data.give_bonus > 0;
this.RewardDeposit.node.active = this._data.give_deposit && this._data.give_deposit > 0;
this.RewardWithdraw.node.active = this._data.give_withdraw && this._data.give_withdraw > 0;
this.RewardBonus.string = s.default.getString("DE_BONUS") + " " + s.default.getString("MoneySymbol") + this._data.give_bonus;
this.RewardDeposit.string = s.default.getString("REFER_RULE_DEPOSIT") + " " + s.default.getString("MoneySymbol") + this._data.give_deposit;
this.RewardWithdraw.string = s.default.getString("DT_WITH") + " " + s.default.getString("MoneySymbol") + this._data.give_withdraw;
this.Icon.spriteFrame = null != this.Icon_Frames[t] ? this.Icon_Frames[t] : this.Icon_Frames[this.Icon_Frames.length - 1];
this.ButtonWithdraw.interactable = u.VM.getValue("wallet.withdraw") >= this._data.withdraw;
this.ButtonWithdraw.node.active = this._data.withdraw > 0 && 3 == this._data.buy_lock;
this.ButtonDeposit.node.active = this._data.deposit > 0 && 1 == this._data.buy_lock || 3 == this._data.buy_lock;
this.ORIcon.active = this.ButtonWithdraw.node.active && this.ButtonDeposit.node.active;
cc.find("Background/Label", this.ButtonWithdraw.node).getComponent(cc.Label).string = this._data.withdraw + " Withdrawal";
cc.find("Background/Label", this.ButtonDeposit.node).getComponent(cc.Label).string = this._data.deposit + " Deposit";
this.OneTime.active = 2 != this._data.buy_lock;
this.LockNode.active = 1 == this._data.buy_lock;
this.LockLabel.string = "Need VIP" + this._data.vip;
this.FinishNode.active = 2 == this._data.buy_lock;
};
t.prototype.onItemEnterCallFunc = function() {
this.node.opacity = 255;
};
t.prototype.onItemExitCallFunc = function() {
this.node.opacity = 0;
};
t.prototype.onWithdrawClicked = function() {
1 != this._data.buy_lock && 2 != this._data.buy_lock && (this._data.withdraw > u.VM.getValue("wallet.withdraw") || d.VIPProxy.Instance.sendVIPGiftBuy(this._data.gift_id, 2));
};
t.prototype.onDepositClicked = function() {
if (1 != this._data.buy_lock && 2 != this._data.buy_lock) if (this._data.deposit > u.VM.getValue("wallet.cash")) {
var e = {
content: s.default.getString("VIP_ALERT_DEPOSIT"),
leftTitle: s.default.getString("KYC_ALERT_LATER"),
rightTitle: s.default.getString("DT_AC"),
rightCallFunc: function() {
c.default.Instance.Global.emit(l.VIPEvent.VIP_UI_CLOSE_SHOP);
p.default.Instance.openRecharge();
}
};
r.PopHelper.Instance.showAlert(e);
} else d.VIPProxy.Instance.sendVIPGiftBuy(this._data.gift_id, 1);
};
i([ _(cc.Label) ], t.prototype, "VIPLevel", void 0);
i([ _(cc.Label) ], t.prototype, "RewardDeposit", void 0);
i([ _(cc.Label) ], t.prototype, "RewardBonus", void 0);
i([ _(cc.Label) ], t.prototype, "RewardWithdraw", void 0);
i([ _(cc.Button) ], t.prototype, "ButtonWithdraw", void 0);
i([ _(cc.Node) ], t.prototype, "ORIcon", void 0);
i([ _(cc.Button) ], t.prototype, "ButtonDeposit", void 0);
i([ _(cc.Node) ], t.prototype, "LockNode", void 0);
i([ _(cc.Label) ], t.prototype, "LockLabel", void 0);
i([ _(cc.Node) ], t.prototype, "FinishNode", void 0);
i([ _(cc.Node) ], t.prototype, "OneTime", void 0);
i([ _(cc.Sprite) ], t.prototype, "Icon", void 0);
i([ _([ cc.SpriteFrame ]) ], t.prototype, "Icon_Frames", void 0);
return i([ f ], t);
}(cc.Component);
o.default = m;
cc._RF.pop();
}, {
"../../../../Game/client/global/enum/game/Event": "Event",
"../../../../Game/client/model/LanguageModel": "LanguageModel",
"../../../../Game/fromework/helper/EventHelper": "EventHelper",
"../../../../Game/fromework/mvvm/modelView/ViewModel": "ViewModel",
"../../../../client/global/PopHelper": "PopHelper",
"../../../model/VIPModel": "VIPModel",
"../../Wallet/WalletHelper": "WalletHelper"
} ],
VIPShop: [ function(e, t, o) {
"use strict";
cc._RF.push(t, "7fc68bhwQhKbpRsPJhK1gVV", "VIPShop");
var n, a = this && this.__extends || (n = function(e, t) {
return (n = Object.setPrototypeOf || {
__proto__: []
} instanceof Array && function(e, t) {
e.__proto__ = t;
} || function(e, t) {
for (var o in t) Object.prototype.hasOwnProperty.call(t, o) && (e[o] = t[o]);
})(e, t);
}, function(e, t) {
n(e, t);
function o() {
this.constructor = e;
}
e.prototype = null === t ? Object.create(t) : (o.prototype = t.prototype, new o());
}), i = this && this.__decorate || function(e, t, o, n) {
var a, i = arguments.length, r = i < 3 ? t : null === n ? n = Object.getOwnPropertyDescriptor(t, o) : n;
if ("object" == typeof Reflect && "function" == typeof Reflect.decorate) r = Reflect.decorate(e, t, o, n); else for (var l = e.length - 1; l >= 0; l--) (a = e[l]) && (r = (i < 3 ? a(r) : i > 3 ? a(t, o, r) : a(t, o)) || r);
return i > 3 && r && Object.defineProperty(t, o, r), r;
};
Object.defineProperty(o, "__esModule", {
value: !0
});
var r = e("../../../../fromework/component/listView/ListView"), l = e("../../../../Game/client/model/LanguageModel"), s = e("../../../model/RedDotModel"), c = e("../../../model/VIPModel"), u = e("../../Wallet/WalletHelper"), d = e("./VIPLogic"), p = e("../../../../Game/client/global/enum/game/Event"), h = e("../../../../Game/fromework/helper/EventHelper"), f = e("../../../../Game/client/global/enum/game/Game"), _ = e("../../../global/PopHelper"), m = e("../../../../Game/fromework/global/Tools"), y = e("../../../../Game/fromework/mvvm/modelView/ViewModel"), g = e("../../../../Game/fromework/helper/UIHelper"), v = cc._decorator, C = v.ccclass, b = v.property, I = function(e) {
a(t, e);
function t() {
var t = null !== e && e.apply(this, arguments) || this;
t.ListView = null;
t.VIPLevel = null;
return t;
}
t.prototype.onEnable = function() {
h.default.Instance.Global.bind(p.VIPEvent.VIP_GET_GIFT_LIST, this.refreshView, this);
h.default.Instance.Global.bind(p.VIPEvent.VIP_UI_CLOSE_SHOP, this.onCloseBtnClicked, this);
h.default.Instance.Global.bind(p.VIPEvent.VIP_SHOP_BUY_FAILED, this.onBuyFailed, this);
};
t.prototype.onDisable = function() {
h.default.Instance.Global.unbind(p.VIPEvent.VIP_GET_GIFT_LIST, this.refreshView, this);
h.default.Instance.Global.unbind(p.VIPEvent.VIP_UI_CLOSE_SHOP, this.onCloseBtnClicked, this);
h.default.Instance.Global.unbind(p.VIPEvent.VIP_SHOP_BUY_FAILED, this.onBuyFailed, this);
};
t.prototype.onLoad = function() {
s.default.Instance.setRedDotTime(f.GameEnum.RedDotKey.VIPShop, 1);
c.VIPProxy.Instance.sendGetGiftList();
};
t.prototype.onBuyFailed = function(e) {
var t = e.getUserData(), o = "";
1015 == t && (o = l.default.getString("VIP_SHOP_BUY_FAILES_1015"));
1016 == t && (o = l.default.getString("VIP_SHOP_BUY_FAILES_1016"));
1017 == t && (o = l.default.getString("VIP_SHOP_BUY_FAILES_1017"));
1018 == t && (o = l.default.getString("VIP_SHOP_BUY_FAILES_1018"));
1019 == t && (o = l.default.getString("VIP_SHOP_BUY_FAILES_1019"));
"" != o && _.PopHelper.Instance.showTips(o);
};
t.prototype.refreshView = function() {
var e = this;
d.default.Instance.isMaxLevel() ? this.VIPLevel.string = l.default.getString("VIP_TIPS_LEVEL_MAX") : this.VIPLevel.string = m.Tools.TStr.replaceString(l.default.getString("VIP_TIPS_LEVEL_EXP"), {
level: y.VM.getValue("user.vip_level"),
exp: d.default.Instance.nextExp
});
this.ListView.datas = c.VIPProxy.Instance.vipShopData.concat();
var t = d.default.Instance.getVIPShopIndex();
t < 0 && (t = 0);
t >= c.VIPProxy.Instance.vipShopData.length && (t = c.VIPProxy.Instance.vipShopData.length - 1);
this.scheduleOnce(function() {
e && e.node && e.node.isValid && e.ListView.scrollToIndex(t, .5);
});
};
t.prototype.onRechargeClicked = function() {
g.default.Instance.removeMaskLayer(this.node, !0);
u.default.Instance.openRecharge();
};
t.prototype.onCloseBtnClicked = function() {
g.default.Instance.removeMaskLayer(this.node, !0);
};
i([ b(r.default) ], t.prototype, "ListView", void 0);
i([ b(cc.Label) ], t.prototype, "VIPLevel", void 0);
return i([ C ], t);
}(cc.Component);
o.default = I;
cc._RF.pop();
}, {
"../../../../Game/client/global/enum/game/Event": "Event",
"../../../../Game/client/global/enum/game/Game": "Game",
"../../../../Game/client/model/LanguageModel": "LanguageModel",
"../../../../Game/fromework/global/Tools": "Tools",
"../../../../Game/fromework/helper/EventHelper": "EventHelper",
"../../../../Game/fromework/helper/UIHelper": "UIHelper",
"../../../../Game/fromework/mvvm/modelView/ViewModel": "ViewModel",
"../../../../fromework/component/listView/ListView": "ListView",
"../../../global/PopHelper": "PopHelper",
"../../../model/RedDotModel": "RedDotModel",
"../../../model/VIPModel": "VIPModel",
"../../Wallet/WalletHelper": "WalletHelper",
"./VIPLogic": "VIPLogic"
} ],
VMBase: [ function(e, t, o) {
"use strict";
cc._RF.push(t, "59f2eX1LzJE7ZDrBhETGohW", "VMBase");
var n, a = this && this.__extends || (n = function(e, t) {
return (n = Object.setPrototypeOf || {
__proto__: []
} instanceof Array && function(e, t) {
e.__proto__ = t;
} || function(e, t) {
for (var o in t) Object.prototype.hasOwnProperty.call(t, o) && (e[o] = t[o]);
})(e, t);
}, function(e, t) {
n(e, t);
function o() {
this.constructor = e;
}
e.prototype = null === t ? Object.create(t) : (o.prototype = t.prototype, new o());
}), i = this && this.__decorate || function(e, t, o, n) {
var a, i = arguments.length, r = i < 3 ? t : null === n ? n = Object.getOwnPropertyDescriptor(t, o) : n;
if ("object" == typeof Reflect && "function" == typeof Reflect.decorate) r = Reflect.decorate(e, t, o, n); else for (var l = e.length - 1; l >= 0; l--) (a = e[l]) && (r = (i < 3 ? a(r) : i > 3 ? a(t, o, r) : a(t, o)) || r);
return i > 3 && r && Object.defineProperty(t, o, r), r;
};
Object.defineProperty(o, "__esModule", {
value: !0
});
var r = e("../../../../platform/Platform"), l = e("./ViewModel"), s = cc._decorator, c = s.ccclass, u = (s.property, 
function(e) {
a(t, e);
function t() {
var t = null !== e && e.apply(this, arguments) || this;
t.watchPath = "";
t.watchPathArr = [];
t.templateMode = !1;
t.templateValueArr = [];
t.VM = l.VM;
return t;
}
t.prototype.onLoad = function() {
for (var e = this, t = this.watchPath.split("."), o = 1; o < t.length; o++) if ("*" == t[o]) {
(l = this.node.getParent().children.findIndex(function(t) {
return t === e.node;
})) <= 0 && (l = 0);
t[o] = l.toString();
break;
}
this.watchPath = t.join(".");
var n = this.watchPathArr;
if (n.length >= 1) for (o = 0; o < n.length; o++) {
for (var a = n[o].split("."), i = 1; i < a.length; i++) if ("*" == a[i]) {
var l;
(l = this.node.getParent().children.findIndex(function(t) {
return t === e.node;
})) <= 0 && (l = 0);
a[i] = l.toString();
break;
}
this.watchPathArr[o] = a.join(".");
}
"" == this.watchPath && "" == this.watchPathArr.join("") && r.default.log("可能未设置路径的节点:", this.node.getParent().name + "." + this.node.name);
};
t.prototype.onEnable = function() {
this.templateMode ? this.setMultPathEvent(!0) : "" != this.watchPath && this.VM.bindPath(this.watchPath, this.onValueChanged, this);
this.onValueInit();
};
t.prototype.onDisable = function() {
this.templateMode ? this.setMultPathEvent(!1) : "" != this.watchPath && this.VM.unbindPath(this.watchPath, this.onValueChanged, this);
};
t.prototype.setMultPathEvent = function(e) {
void 0 === e && (e = !0);
for (var t = this.watchPathArr, o = 0; o < t.length; o++) {
var n = t[o];
e ? this.VM.bindPath(n, this.onValueChanged, this) : this.VM.unbindPath(n, this.onValueChanged, this);
}
};
t.prototype.onValueInit = function() {};
t.prototype.onValueChanged = function() {};
return i([ c ], t);
}(cc.Component));
o.default = u;
cc._RF.pop();
}, {
"../../../../platform/Platform": "Platform",
"./ViewModel": "ViewModel"
} ],
VMCompsEdit: [ function(e, t, o) {
"use strict";
cc._RF.push(t, "757d62BdehH4L1ZQNfDJscP", "VMCompsEdit");
var n, a = this && this.__extends || (n = function(e, t) {
return (n = Object.setPrototypeOf || {
__proto__: []
} instanceof Array && function(e, t) {
e.__proto__ = t;
} || function(e, t) {
for (var o in t) Object.prototype.hasOwnProperty.call(t, o) && (e[o] = t[o]);
})(e, t);
}, function(e, t) {
n(e, t);
function o() {
this.constructor = e;
}
e.prototype = null === t ? Object.create(t) : (o.prototype = t.prototype, new o());
}), i = this && this.__decorate || function(e, t, o, n) {
var a, i = arguments.length, r = i < 3 ? t : null === n ? n = Object.getOwnPropertyDescriptor(t, o) : n;
if ("object" == typeof Reflect && "function" == typeof Reflect.decorate) r = Reflect.decorate(e, t, o, n); else for (var l = e.length - 1; l >= 0; l--) (a = e[l]) && (r = (i < 3 ? a(r) : i > 3 ? a(t, o, r) : a(t, o)) || r);
return i > 3 && r && Object.defineProperty(t, o, r), r;
};
Object.defineProperty(o, "__esModule", {
value: !0
});
var r, l = e("../../../../platform/Platform"), s = cc._decorator, c = s.ccclass, u = s.property, d = s.executeInEditMode, p = s.menu, h = s.help;
(function(e) {
e[e.SEARCH_COMPONENT = 0] = "SEARCH_COMPONENT";
e[e.ENABLE_COMPONENT = 1] = "ENABLE_COMPONENT";
e[e.REPLACE_WATCH_PATH = 2] = "REPLACE_WATCH_PATH";
e[e.DELETE_COMPONENT = 3] = "DELETE_COMPONENT";
})(r || (r = {}));
var f = function(e) {
a(t, e);
function t() {
var t = null !== e && e.apply(this, arguments) || this;
t.findList = [ "VMBase", "VMParent" ];
t.actionType = r.SEARCH_COMPONENT;
t.allowDelete = !1;
t.targetPath = "game";
t.replacePath = "*";
t.canCollectNodes = !1;
t.collectNodes = [];
return t;
}
Object.defineProperty(t.prototype, "findTrigger", {
get: function() {
return !1;
},
set: function() {
this.setComponents(0);
},
enumerable: !1,
configurable: !0
});
Object.defineProperty(t.prototype, "enableTrigger", {
get: function() {
return !1;
},
set: function() {
this.setComponents(1);
},
enumerable: !1,
configurable: !0
});
Object.defineProperty(t.prototype, "disableTrigger", {
get: function() {
return !1;
},
set: function() {
this.setComponents(2);
},
enumerable: !1,
configurable: !0
});
Object.defineProperty(t.prototype, "deleteTrigger", {
get: function() {
return !1;
},
set: function() {
this.setComponents(3);
},
enumerable: !1,
configurable: !0
});
Object.defineProperty(t.prototype, "replaceTrigger", {
get: function() {
return !1;
},
set: function() {
this.setComponents(4);
},
enumerable: !1,
configurable: !0
});
t.prototype.onLoad = function() {
var e = this.getNodePath(this.node);
l.default.error("you forget delete MVEditFinder,[path]", e);
};
t.prototype.setComponents = function(e) {
var t = this, o = this.findList, n = "搜索到当前节点下面的组件";
switch (e) {
case 0:
n = "搜索到当前节点下面的组件";
break;

case 1:
n = "激活以下节点的组件";
break;

case 2:
n = "关闭以下节点的组件";
break;

case 3:
n = "删除以下节点的组件";
break;

case 4:
n = "替换以下节点的路径";
}
l.default.log(n);
l.default.log("______________________");
o.forEach(function(o) {
t.searchComponent(o, e);
});
l.default.log("______________________");
};
t.prototype.searchComponent = function(e, t) {
var o = this;
void 0 === t && (t = 0);
this.collectNodes = [];
var n = this.node.getComponentsInChildren(e);
if (!(null == n || n.length < 1)) {
l.default.log("[" + e + "]:");
n.forEach(function(e) {
var n = "";
t <= 3 && (n = !0 === e.templateMode ? e.watchPathArr ? ":[Path:" + e.watchPathArr.join("|") + "]" : "" : e.watchPath ? ":[Path:" + e.watchPath + "]" : "");
l.default.log(o.getNodePath(e.node) + n);
switch (t) {
case 0:
o.canCollectNodes && -1 === o.collectNodes.indexOf(e.node) && o.collectNodes.push(e.node);
break;

case 1:
e.enabled = !0;
break;

case 2:
e.enabled = !1;
break;

case 3:
e.node.removeComponent(e);
break;

case 4:
var a = o.targetPath, i = o.replacePath;
if (!0 === e.templateMode) for (var r = 0; r < e.watchPathArr.length; r++) {
var s = e.watchPathArr[r];
e.watchPathArr[r] = o.replaceNodePath(s, a, i);
} else e.watchPath = o.replaceNodePath(e.watchPath, a, i);
}
});
}
};
t.prototype.replaceNodePath = function(e, t, o) {
for (var n = e.split("."), a = t.split("."), i = o.split("."), r = !0, s = 0; s < a.length; s++) if (n[s] !== a[s]) {
r = !1;
break;
}
if (!0 === r) {
for (s = 0; s < i.length; s++) n[s] = i[s];
l.default.log(" 路径更新:", e, ">>>", n.join("."));
}
return n.join(".");
};
t.prototype.getNodePath = function(e) {
for (var t = e, o = []; t; ) {
var n = t.getParent();
if (!n) break;
o.push(t.name);
t = n;
}
return o.reverse().join("/");
};
i([ u({
type: [ cc.String ]
}) ], t.prototype, "findList", void 0);
i([ u({
type: cc.Enum(r)
}) ], t.prototype, "actionType", void 0);
i([ u({
tooltip: "勾选后,会自动查找 find list 中填写的组件",
visible: function() {
return this.actionType === r.SEARCH_COMPONENT;
}
}) ], t.prototype, "findTrigger", null);
i([ u({
tooltip: "勾选后,会批量激活 find list 中填写的组件",
visible: function() {
return this.actionType === r.ENABLE_COMPONENT;
}
}) ], t.prototype, "enableTrigger", null);
i([ u({
tooltip: "勾选后,会批量关闭 find list 中填写的组件",
visible: function() {
return this.actionType === r.ENABLE_COMPONENT;
}
}) ], t.prototype, "disableTrigger", null);
i([ u({
tooltip: "允许删除节点的组件,确定需要移除请勾选,防止误操作",
visible: function() {
return this.actionType === r.DELETE_COMPONENT;
}
}) ], t.prototype, "allowDelete", void 0);
i([ u({
tooltip: "勾选后,会批量删除 find list 中填写的组件",
displayName: "[ X DELETE X ]",
visible: function() {
return this.allowDelete && this.actionType === r.DELETE_COMPONENT;
}
}) ], t.prototype, "deleteTrigger", null);
i([ u({
tooltip: "勾选后,会批量替换掉指定的路径",
visible: function() {
return this.actionType === r.REPLACE_WATCH_PATH;
}
}) ], t.prototype, "replaceTrigger", null);
i([ u({
tooltip: "匹配的路径,匹配规则: 搜索开头为 game的路径",
visible: function() {
return this.actionType === r.REPLACE_WATCH_PATH;
}
}) ], t.prototype, "targetPath", void 0);
i([ u({
tooltip: "替换的路径,将匹配到的路径替换",
visible: function() {
return this.actionType === r.REPLACE_WATCH_PATH;
}
}) ], t.prototype, "replacePath", void 0);
i([ u({
tooltip: "是否搜集绑定VM组件的节点?",
visible: function() {
return this.actionType === r.SEARCH_COMPONENT;
}
}) ], t.prototype, "canCollectNodes", void 0);
i([ u({
type: [ cc.Node ],
readonly: !0,
tooltip: "收集到绑定了VM组件相关的节点，可以自己跳转过去",
visible: function() {
return this.canCollectNodes && this.actionType === r.SEARCH_COMPONENT;
}
}) ], t.prototype, "collectNodes", void 0);
return i([ c, d, p("ModelViewer/Edit-Comps (快速组件操作)"), h("https://github.com/wsssheep/cocos_creator_mvvm_tools/blob/master/docs/VMCompsEdit.md") ], t);
}(cc.Component);
o.default = f;
cc._RF.pop();
}, {
"../../../../platform/Platform": "Platform"
} ],
VMCustom: [ function(e, t, o) {
"use strict";
cc._RF.push(t, "ae787pPy0RGaqrxzCaLwQDP", "VMCustom");
var n, a = this && this.__extends || (n = function(e, t) {
return (n = Object.setPrototypeOf || {
__proto__: []
} instanceof Array && function(e, t) {
e.__proto__ = t;
} || function(e, t) {
for (var o in t) Object.prototype.hasOwnProperty.call(t, o) && (e[o] = t[o]);
})(e, t);
}, function(e, t) {
n(e, t);
function o() {
this.constructor = e;
}
e.prototype = null === t ? Object.create(t) : (o.prototype = t.prototype, new o());
}), i = this && this.__decorate || function(e, t, o, n) {
var a, i = arguments.length, r = i < 3 ? t : null === n ? n = Object.getOwnPropertyDescriptor(t, o) : n;
if ("object" == typeof Reflect && "function" == typeof Reflect.decorate) r = Reflect.decorate(e, t, o, n); else for (var l = e.length - 1; l >= 0; l--) (a = e[l]) && (r = (i < 3 ? a(r) : i > 3 ? a(t, o, r) : a(t, o)) || r);
return i > 3 && r && Object.defineProperty(t, o, r), r;
};
Object.defineProperty(o, "__esModule", {
value: !0
});
var r = e("../../../../platform/Platform"), l = e("./VMBase"), s = cc._decorator, c = s.ccclass, u = s.property, d = s.executeInEditMode, p = s.menu, h = s.help, f = function(e) {
a(t, e);
function t() {
var t = null !== e && e.apply(this, arguments) || this;
t.controller = !1;
t.watchPath = "";
t.componentName = "";
t.componentProperty = "";
t.refreshRate = .1;
t._timer = 0;
t._watchComponent = null;
t._canWatchComponent = !1;
t._oldValue = null;
return t;
}
t.prototype.onLoad = function() {
e.prototype.onLoad.call(this);
this.checkEditorComponent();
this._watchComponent = this.node.getComponent(this.componentName);
this.checkComponentState();
};
t.prototype.onRestore = function() {
this.checkEditorComponent();
};
t.prototype.start = function() {
this.onValueInit();
};
t.prototype.checkEditorComponent = function() {};
t.prototype.checkComponentState = function() {
this._canWatchComponent = !1;
this._watchComponent ? this.componentProperty ? this.componentProperty in this._watchComponent != 0 ? this._canWatchComponent = !0 : r.default.error("需要监听的组件的属性不存在") : r.default.error("未设置需要监听的组件 的属性") : r.default.error("未设置需要监听的组件");
};
t.prototype.getComponentValue = function() {
return this._watchComponent[this.componentProperty];
};
t.prototype.setComponentValue = function(e) {
if ("cc.Toggle" == this.componentName) {
1 == e && this.node.getComponent(cc.Toggle).check();
0 == e && this.node.getComponent(cc.Toggle).uncheck();
} else this._watchComponent[this.componentProperty] = e;
};
t.prototype.onValueInit = function() {
this.setComponentValue(this.VM.getValue(this.watchPath));
};
t.prototype.onValueController = function(e) {
this.VM.setValue(this.watchPath, e);
};
t.prototype.onValueChanged = function(e) {
this.setComponentValue(e);
};
t.prototype.update = function(e) {
if (this.controller && this._canWatchComponent && !1 !== this._watchComponent.enabled) {
this._timer += e;
if (!(this._timer < this.refreshRate)) {
this._timer = 0;
var t = this._oldValue, o = this.getComponentValue();
if (this._oldValue !== o) {
this._oldValue = this.getComponentValue();
this.onValueController(o, t);
}
}
}
};
i([ u({
tooltip: "激活controller,以开启双向绑定，否则只能接收消息"
}) ], t.prototype, "controller", void 0);
i([ u ], t.prototype, "watchPath", void 0);
i([ u({
tooltip: "绑定组件的名字"
}) ], t.prototype, "componentName", void 0);
i([ u({
tooltip: "组件上需要监听的属性"
}) ], t.prototype, "componentProperty", void 0);
i([ u({
tooltip: "刷新间隔频率(只影响脏检查的频率)",
step: .01,
range: [ 0, 1 ],
visible: function() {
return !0 === this.controller;
}
}) ], t.prototype, "refreshRate", void 0);
return i([ c, d, p("ModelViewer/VM-Custom (自定义VM)"), h("https://github.com/wsssheep/cocos_creator_mvvm_tools/blob/master/docs/VMCustom.md") ], t);
}(l.default);
o.default = f;
cc._RF.pop();
}, {
"../../../../platform/Platform": "Platform",
"./VMBase": "VMBase"
} ],
VMEvent: [ function(e, t, o) {
"use strict";
cc._RF.push(t, "68b5bdJTkNN1J8CpJtoJ80g", "VMEvent");
var n, a = this && this.__extends || (n = function(e, t) {
return (n = Object.setPrototypeOf || {
__proto__: []
} instanceof Array && function(e, t) {
e.__proto__ = t;
} || function(e, t) {
for (var o in t) Object.prototype.hasOwnProperty.call(t, o) && (e[o] = t[o]);
})(e, t);
}, function(e, t) {
n(e, t);
function o() {
this.constructor = e;
}
e.prototype = null === t ? Object.create(t) : (o.prototype = t.prototype, new o());
}), i = this && this.__decorate || function(e, t, o, n) {
var a, i = arguments.length, r = i < 3 ? t : null === n ? n = Object.getOwnPropertyDescriptor(t, o) : n;
if ("object" == typeof Reflect && "function" == typeof Reflect.decorate) r = Reflect.decorate(e, t, o, n); else for (var l = e.length - 1; l >= 0; l--) (a = e[l]) && (r = (i < 3 ? a(r) : i > 3 ? a(t, o, r) : a(t, o)) || r);
return i > 3 && r && Object.defineProperty(t, o, r), r;
};
Object.defineProperty(o, "__esModule", {
value: !0
});
var r, l = e("./VMBase"), s = cc._decorator, c = s.ccclass, u = s.property, d = s.executeInEditMode, p = s.menu, h = s.help;
(function(e) {
e[e.none = 0] = "none";
e[e["=="] = 1] = "==";
e[e["!="] = 2] = "!=";
e[e[">"] = 3] = ">";
e[e[">="] = 4] = ">=";
e[e["<"] = 5] = "<";
e[e["<="] = 6] = "<=";
})(r || (r = {}));
var f = function(e) {
a(t, e);
function t() {
var t = null !== e && e.apply(this, arguments) || this;
t.templateMode = !1;
t.watchPath = "";
t.triggerOnce = !1;
t.watchPathArr = [];
t.filterMode = r.none;
t.compareValue = "";
t.changeEvents = [];
return t;
}
t.prototype.onValueInit = function() {};
t.prototype.onValueChanged = function(e, t, o) {
if (this.conditionCheck(e, this.compareValue)) {
Array.isArray(this.changeEvents) && this.changeEvents.forEach(function(n) {
n.emit([ e, t, o ]);
});
!0 === this.triggerOnce && (this.enabled = !1);
}
};
t.prototype.conditionCheck = function(e, t) {
var o = r;
switch (this.filterMode) {
case o.none:
return !0;

case o["=="]:
if (e == t) return !0;
break;

case o["!="]:
if (e != t) return !0;
break;

case o["<"]:
if (e < t) return !0;
break;

case o[">"]:
if (e > t) return !0;
break;

case o[">="]:
if (e >= t) return !0;
break;

case o["<"]:
if (e < t) return !0;
break;

case o["<="]:
if (e <= t) return !0;
}
return !1;
};
i([ u({
tooltip: "使用模板模式，可以使用多路径监听"
}) ], t.prototype, "templateMode", void 0);
i([ u({
tooltip: "监听获取值的路径",
visible: function() {
return !1 === this.templateMode;
}
}) ], t.prototype, "watchPath", void 0);
i([ u({
tooltip: "触发一次后会自动关闭该事件"
}) ], t.prototype, "triggerOnce", void 0);
i([ u({
tooltip: "监听获取值的多条路径,这些值的改变都会通过这个函数回调,请使用 pathArr 区分获取的值 ",
type: [ cc.String ],
visible: function() {
return !0 === this.templateMode;
}
}) ], t.prototype, "watchPathArr", void 0);
i([ u({
tooltip: "过滤模式，会根据条件过滤掉时间的触发",
type: cc.Enum(r)
}) ], t.prototype, "filterMode", void 0);
i([ u({
visible: function() {
return this.filterMode !== r.none;
}
}) ], t.prototype, "compareValue", void 0);
i([ u([ cc.Component.EventHandler ]) ], t.prototype, "changeEvents", void 0);
return i([ c, d, p("ModelViewer/VM-EventCall(调用函数)"), h("https://github.com/wsssheep/cocos_creator_mvvm_tools/blob/master/docs/VMEvent.md") ], t);
}(l.default);
o.default = f;
cc._RF.pop();
}, {
"./VMBase": "VMBase"
} ],
VMLabel: [ function(e, t, o) {
"use strict";
cc._RF.push(t, "d67a3S16a9KDbVbn/02nqsw", "VMLabel");
var n, a = this && this.__extends || (n = function(e, t) {
return (n = Object.setPrototypeOf || {
__proto__: []
} instanceof Array && function(e, t) {
e.__proto__ = t;
} || function(e, t) {
for (var o in t) Object.prototype.hasOwnProperty.call(t, o) && (e[o] = t[o]);
})(e, t);
}, function(e, t) {
n(e, t);
function o() {
this.constructor = e;
}
e.prototype = null === t ? Object.create(t) : (o.prototype = t.prototype, new o());
}), i = this && this.__decorate || function(e, t, o, n) {
var a, i = arguments.length, r = i < 3 ? t : null === n ? n = Object.getOwnPropertyDescriptor(t, o) : n;
if ("object" == typeof Reflect && "function" == typeof Reflect.decorate) r = Reflect.decorate(e, t, o, n); else for (var l = e.length - 1; l >= 0; l--) (a = e[l]) && (r = (i < 3 ? a(r) : i > 3 ? a(t, o, r) : a(t, o)) || r);
return i > 3 && r && Object.defineProperty(t, o, r), r;
};
Object.defineProperty(o, "__esModule", {
value: !0
});
var r = e("./VMBase"), l = e("./StringFormat"), s = cc._decorator, c = s.ccclass, u = s.property, d = s.menu, p = s.executeInEditMode, h = s.help, f = {
CC_LABEL: "cc.Label",
CC_RICH_TEXT: "cc.RichText",
CC_EDIT_BOX: "cc.EditBox"
}, _ = function(e) {
a(t, e);
function t() {
var t = null !== e && e.apply(this, arguments) || this;
t.watchPath = "";
t.labelType = f.CC_LABEL;
t.templateMode = !1;
t.watchPathArr = [];
t.templateValueArr = [];
t.templateFormatArr = [];
t.originText = null;
return t;
}
t.prototype.onRestore = function() {
this.checkLabel();
};
t.prototype.onLoad = function() {
e.prototype.onLoad.call(this);
this.checkLabel();
if (this.templateMode) {
this.originText = this.getLabelValue();
this.parseTemplate();
}
};
t.prototype.start = function() {
this.onValueInit();
};
t.prototype.parseTemplate = function() {
var e = /\{\{(.+?)\}\}/, t = this.originText.match(/\{\{(.+?)\}\}/g);
if (null != t) for (var o = 0; o < t.length; o++) {
var n = t[o].match(e)[1].split(":")[1] || "";
this.templateFormatArr[o] = n;
}
};
t.prototype.getReplaceText = function() {
if (!this.originText) return "";
var e = /\{\{(.+?)\}\}/, t = this.originText.match(/\{\{(.+?)\}\}/g);
if (null == t) return "";
for (var o = this.originText, n = 0; n < t.length; n++) {
var a, i = t[n], r = i.match(e), l = parseInt(r[1] || "0") || 0, s = this.templateFormatArr[n];
a = this.templateValueArr[l];
o = o.replace(i, this.getValueFromFormat(a, s));
}
return o;
};
t.prototype.getValueFromFormat = function(e, t) {
return l.StringFormatFunction.deal(e, t);
};
t.prototype.onValueInit = function() {
if (!1 === this.templateMode) this.setLabelValue(this.VM.getValue(this.watchPath)); else {
for (var e = this.watchPathArr.length, t = 0; t < e; t++) this.templateValueArr[t] = this.VM.getValue(this.watchPathArr[t], "?");
this.setLabelValue(this.getReplaceText());
}
};
t.prototype.onValueChanged = function(e, t, o) {
if (!1 === this.templateMode) this.setLabelValue(e); else {
var n = o.join("."), a = this.watchPathArr.findIndex(function(e) {
return e === n;
});
if (a >= 0) {
this.templateValueArr[a] = e;
this.setLabelValue(this.getReplaceText());
}
}
};
t.prototype.setLabelValue = function(e) {
this.getComponent(this.labelType).string = e + "";
};
t.prototype.getLabelValue = function() {
return this.getComponent(this.labelType).string;
};
t.prototype.checkLabel = function() {
for (var e = [ "cc.Label", "cc.RichText", "cc.EditBox" ], t = 0; t < e.length; t++) {
var o = e[t];
if (this.node.getComponent(o)) {
this.labelType = o;
return !0;
}
}
Platform.error("没有挂载任何label组件");
return !1;
};
i([ u({
visible: function() {
return !1 === this.templateMode;
}
}) ], t.prototype, "watchPath", void 0);
i([ u({
readonly: !0
}) ], t.prototype, "labelType", void 0);
i([ u({
tooltip: "是否启用模板代码,只能在运行时之前设置,\n将会动态解析模板语法 {{0}},并且自动设置监听的路径"
}) ], t.prototype, "templateMode", void 0);
i([ u({
type: [ cc.String ],
visible: function() {
return !0 === this.templateMode;
}
}) ], t.prototype, "watchPathArr", void 0);
return i([ c, p, d("ModelViewer/VM-Label(文本VM)"), h("https://github.com/wsssheep/cocos_creator_mvvm_tools/blob/master/docs/VMLabel.md") ], t);
}(r.default);
o.default = _;
cc._RF.pop();
}, {
"./StringFormat": "StringFormat",
"./VMBase": "VMBase"
} ],
VMModify: [ function(e, t, o) {
"use strict";
cc._RF.push(t, "895e3jwhOhLLIDJWpXtakyW", "VMModify");
var n, a = this && this.__extends || (n = function(e, t) {
return (n = Object.setPrototypeOf || {
__proto__: []
} instanceof Array && function(e, t) {
e.__proto__ = t;
} || function(e, t) {
for (var o in t) Object.prototype.hasOwnProperty.call(t, o) && (e[o] = t[o]);
})(e, t);
}, function(e, t) {
n(e, t);
function o() {
this.constructor = e;
}
e.prototype = null === t ? Object.create(t) : (o.prototype = t.prototype, new o());
}), i = this && this.__decorate || function(e, t, o, n) {
var a, i = arguments.length, r = i < 3 ? t : null === n ? n = Object.getOwnPropertyDescriptor(t, o) : n;
if ("object" == typeof Reflect && "function" == typeof Reflect.decorate) r = Reflect.decorate(e, t, o, n); else for (var l = e.length - 1; l >= 0; l--) (a = e[l]) && (r = (i < 3 ? a(r) : i > 3 ? a(t, o, r) : a(t, o)) || r);
return i > 3 && r && Object.defineProperty(t, o, r), r;
};
Object.defineProperty(o, "__esModule", {
value: !0
});
var r, l = e("./VMBase"), s = cc._decorator, c = s.ccclass, u = s.property, d = s.menu, p = s.help;
(function(e) {
e[e.MIN = 0] = "MIN";
e[e.MAX = 1] = "MAX";
e[e.MIN_MAX = 2] = "MIN_MAX";
})(r || (r = {}));
var h = function(e) {
a(t, e);
function t() {
var t = null !== e && e.apply(this, arguments) || this;
t.watchPath = "";
t.valueClamp = !1;
t.valueClampMode = r.MIN_MAX;
t.valueMin = 0;
t.valueMax = 1;
return t;
}
t.prototype.start = function() {};
t.prototype.clampValue = function(e) {
var t = this.valueMin, o = this.valueMax;
if (0 == this.valueClamp) return e;
switch (this.valueClampMode) {
case r.MIN_MAX:
e > o && (e = o);
e < t && (e = t);
break;

case r.MIN:
e < t && (e = t);
break;

case r.MAX:
e > o && (e = o);
}
return e;
};
t.prototype.vAddInt = function(e, t) {
this.vAdd(e, t, !0);
};
t.prototype.vSubInt = function(e, t) {
this.vSub(e, t, !0);
};
t.prototype.vMulInt = function(e, t) {
this.vMul(e, t, !0);
};
t.prototype.vDivInt = function(e, t) {
this.vDiv(e, t, !0);
};
t.prototype.vAdd = function(e, t, o) {
void 0 === o && (o = !1);
var n = parseFloat(t), a = this.VM.getValue(this.watchPath, 0) + n;
o && (a = Math.round(a));
this.VM.setValue(this.watchPath, this.clampValue(a));
};
t.prototype.vSub = function(e, t, o) {
void 0 === o && (o = !1);
var n = parseFloat(t), a = this.VM.getValue(this.watchPath, 0) - n;
o && (a = Math.round(a));
this.VM.setValue(this.watchPath, this.clampValue(a));
};
t.prototype.vMul = function(e, t, o) {
void 0 === o && (o = !1);
var n = parseFloat(t), a = this.VM.getValue(this.watchPath, 0) * n;
o && (a = Math.round(a));
this.VM.setValue(this.watchPath, this.clampValue(a));
};
t.prototype.vDiv = function(e, t, o) {
void 0 === o && (o = !1);
var n = parseFloat(t), a = this.VM.getValue(this.watchPath, 0) / n;
o && (a = Math.round(a));
this.VM.setValue(this.watchPath, this.clampValue(a));
};
t.prototype.vString = function(e, t) {
var o = t;
this.VM.setValue(this.watchPath, o);
};
t.prototype.vNumberInt = function(e, t) {
this.vNumber(e, t, !0);
};
t.prototype.vNumber = function(e, t, o) {
void 0 === o && (o = !1);
var n = parseFloat(t);
o && (n = Math.round(n));
this.VM.setValue(this.watchPath, this.clampValue(n));
};
i([ u ], t.prototype, "watchPath", void 0);
i([ u() ], t.prototype, "valueClamp", void 0);
i([ u({
type: cc.Enum(r),
visible: function() {
return !0 === this.valueClamp;
}
}) ], t.prototype, "valueClampMode", void 0);
i([ u({
visible: function() {
return !0 === this.valueClamp && this.valueClampMode !== r.MAX;
}
}) ], t.prototype, "valueMin", void 0);
i([ u({
visible: function() {
return !0 === this.valueClamp && this.valueClampMode !== r.MIN;
}
}) ], t.prototype, "valueMax", void 0);
return i([ c, d("ModelViewer/VM-Modify(修改Model)"), p("https://github.com/wsssheep/cocos_creator_mvvm_tools/blob/master/docs/VMModify.md") ], t);
}(l.default);
o.default = h;
cc._RF.pop();
}, {
"./VMBase": "VMBase"
} ],
VMParent: [ function(e, t, o) {
"use strict";
cc._RF.push(t, "5ef17UEcTpB+aU6iDrY+qLT", "VMParent");
var n, a = this && this.__extends || (n = function(e, t) {
return (n = Object.setPrototypeOf || {
__proto__: []
} instanceof Array && function(e, t) {
e.__proto__ = t;
} || function(e, t) {
for (var o in t) Object.prototype.hasOwnProperty.call(t, o) && (e[o] = t[o]);
})(e, t);
}, function(e, t) {
n(e, t);
function o() {
this.constructor = e;
}
e.prototype = null === t ? Object.create(t) : (o.prototype = t.prototype, new o());
}), i = this && this.__decorate || function(e, t, o, n) {
var a, i = arguments.length, r = i < 3 ? t : null === n ? n = Object.getOwnPropertyDescriptor(t, o) : n;
if ("object" == typeof Reflect && "function" == typeof Reflect.decorate) r = Reflect.decorate(e, t, o, n); else for (var l = e.length - 1; l >= 0; l--) (a = e[l]) && (r = (i < 3 ? a(r) : i > 3 ? a(t, o, r) : a(t, o)) || r);
return i > 3 && r && Object.defineProperty(t, o, r), r;
};
Object.defineProperty(o, "__esModule", {
value: !0
});
var r = e("./ViewModel"), l = cc._decorator, s = l.ccclass, c = (l.property, l.help), u = l.executionOrder, d = function(e) {
a(t, e);
function t() {
var t = null !== e && e.apply(this, arguments) || this;
t.tag = "_temp";
t.data = {};
t.VM = r.VM;
return t;
}
t.prototype.onLoad = function() {
if (null != this.data) {
this.tag = "_temp<" + this.node.uuid.replace(".", "") + ">";
r.VM.add(this.data, this.tag);
for (var e = this.getVMComponents(), t = 0; t < e.length; t++) {
var o = e[t];
this.replaceVMPath(o, this.tag);
}
this.onBind();
}
};
t.prototype.onBind = function() {};
t.prototype.onUnBind = function() {};
t.prototype.replaceVMPath = function(e, t) {
var o = e.watchPath;
if (1 == e.templateMode) {
var n = e.watchPathArr;
if (n) for (var a = 0; a < n.length; a++) {
var i = n[a];
n[a] = i.replace("*", t);
}
} else "*" === o.split(".")[0] && (e.watchPath = o.replace("*", t));
};
t.prototype.getVMComponents = function() {
var e = this, t = this.node.getComponentsInChildren("VMBase"), o = this.node.getComponentsInChildren("VMParent").filter(function(t) {
return t.uuid !== e.uuid;
}), n = [];
o.forEach(function(e) {
n = n.concat(e.getComponentsInChildren("VMBase"));
});
return t.filter(function(e) {
return n.indexOf(e) < 0;
});
};
t.prototype.onDestroy = function() {
this.onUnBind();
r.VM.remove(this.tag);
this.data = null;
};
return i([ s, u(-1), c("https://github.com/wsssheep/cocos_creator_mvvm_tools/blob/master/docs/VMParent.md") ], t);
}(cc.Component);
o.default = d;
cc._RF.pop();
}, {
"./ViewModel": "ViewModel"
} ],
VMProgress: [ function(e, t, o) {
"use strict";
cc._RF.push(t, "28ee8c2jXZG15di2B5AZcfa", "VMProgress");
var n, a = this && this.__extends || (n = function(e, t) {
return (n = Object.setPrototypeOf || {
__proto__: []
} instanceof Array && function(e, t) {
e.__proto__ = t;
} || function(e, t) {
for (var o in t) Object.prototype.hasOwnProperty.call(t, o) && (e[o] = t[o]);
})(e, t);
}, function(e, t) {
n(e, t);
function o() {
this.constructor = e;
}
e.prototype = null === t ? Object.create(t) : (o.prototype = t.prototype, new o());
}), i = this && this.__decorate || function(e, t, o, n) {
var a, i = arguments.length, r = i < 3 ? t : null === n ? n = Object.getOwnPropertyDescriptor(t, o) : n;
if ("object" == typeof Reflect && "function" == typeof Reflect.decorate) r = Reflect.decorate(e, t, o, n); else for (var l = e.length - 1; l >= 0; l--) (a = e[l]) && (r = (i < 3 ? a(r) : i > 3 ? a(t, o, r) : a(t, o)) || r);
return i > 3 && r && Object.defineProperty(t, o, r), r;
};
Object.defineProperty(o, "__esModule", {
value: !0
});
var r = e("./VMCustom"), l = e("./StringFormat"), s = cc._decorator, c = s.ccclass, u = s.property, d = s.menu, p = s.help, h = function(e) {
a(t, e);
function t() {
var t = null !== e && e.apply(this, arguments) || this;
t.watchPath = "";
t.watchPathArr = [ "[min]", "[max]" ];
t.templateMode = !0;
t.stringFormat = "";
return t;
}
t.prototype.onLoad = function() {
(this.watchPathArr.length < 2 || "[min]" == this.watchPathArr[0] || "[max]" == this.watchPathArr[1]) && Platform.error("VMProgress must have two values!");
e.prototype.onLoad.call(this);
};
t.prototype.start = function() {
this.onValueInit();
};
t.prototype.onValueInit = function() {
for (var e = this.watchPathArr.length, t = 0; t < e; t++) this.templateValueArr[t] = this.VM.getValue(this.watchPathArr[t]);
var o = this.templateValueArr[0] / this.templateValueArr[1];
this.setComponentValue(o);
};
t.prototype.setComponentValue = function(t) {
if ("" !== this.stringFormat) {
var o = l.StringFormatFunction.deal(t, this.stringFormat);
e.prototype.setComponentValue.call(this, o);
} else e.prototype.setComponentValue.call(this, t);
};
t.prototype.onValueController = function(e) {
var t = Math.round(e * this.templateValueArr[1]);
Number.isNaN(t) && (t = 0);
this.VM.setValue(this.watchPathArr[0], t);
};
t.prototype.onValueChanged = function(e, t, o) {
if (!1 !== this.templateMode) {
var n = o.join("."), a = this.watchPathArr.findIndex(function(e) {
return e === n;
});
a >= 0 && (this.templateValueArr[a] = e);
var i = this.templateValueArr[0] / this.templateValueArr[1];
i > 1 && (i = 1);
(i < 0 || Number.isNaN(i)) && (i = 0);
this.setComponentValue(i);
}
};
i([ u({
visible: !1,
override: !0
}) ], t.prototype, "watchPath", void 0);
i([ u({
type: [ cc.String ],
tooltip: "第一个值是min 值，第二个值 是 max 值，会计算出两者的比例"
}) ], t.prototype, "watchPathArr", void 0);
i([ u({
visible: function() {
return "string" === this.componentProperty;
},
tooltip: "字符串格式化，和 VMLabel 的字段一样，需要填入对应的格式化字符串"
}) ], t.prototype, "stringFormat", void 0);
return i([ c, d("ModelViewer/VM-Progress (VM-进度条)"), p("https://github.com/wsssheep/cocos_creator_mvvm_tools/blob/master/docs/VMProgress.md") ], t);
}(r.default);
o.default = h;
cc._RF.pop();
}, {
"./StringFormat": "StringFormat",
"./VMCustom": "VMCustom"
} ],
VMState: [ function(e, t, o) {
"use strict";
cc._RF.push(t, "c691dysNYZJFL/eO0wEhGYy", "VMState");
var n, a = this && this.__extends || (n = function(e, t) {
return (n = Object.setPrototypeOf || {
__proto__: []
} instanceof Array && function(e, t) {
e.__proto__ = t;
} || function(e, t) {
for (var o in t) Object.prototype.hasOwnProperty.call(t, o) && (e[o] = t[o]);
})(e, t);
}, function(e, t) {
n(e, t);
function o() {
this.constructor = e;
}
e.prototype = null === t ? Object.create(t) : (o.prototype = t.prototype, new o());
}), i = this && this.__decorate || function(e, t, o, n) {
var a, i = arguments.length, r = i < 3 ? t : null === n ? n = Object.getOwnPropertyDescriptor(t, o) : n;
if ("object" == typeof Reflect && "function" == typeof Reflect.decorate) r = Reflect.decorate(e, t, o, n); else for (var l = e.length - 1; l >= 0; l--) (a = e[l]) && (r = (i < 3 ? a(r) : i > 3 ? a(t, o, r) : a(t, o)) || r);
return i > 3 && r && Object.defineProperty(t, o, r), r;
};
Object.defineProperty(o, "__esModule", {
value: !0
});
var r, l, s, c = e("./ViewModel"), u = e("./VMBase"), d = cc._decorator, p = d.ccclass, h = d.property, f = d.menu, _ = d.help;
(function(e) {
e[e["=="] = 0] = "==";
e[e["!="] = 1] = "!=";
e[e[">"] = 2] = ">";
e[e[">="] = 3] = ">=";
e[e["<"] = 4] = "<";
e[e["<="] = 5] = "<=";
e[e.range = 6] = "range";
})(r || (r = {}));
(function(e) {
e[e.NODE_ACTIVE = 0] = "NODE_ACTIVE";
e[e.NODE_VISIBLE = 1] = "NODE_VISIBLE";
e[e.NODE_OPACITY = 2] = "NODE_OPACITY";
e[e.NODE_COLOR = 3] = "NODE_COLOR";
e[e.COMPONENT_CUSTOM = 4] = "COMPONENT_CUSTOM";
})(l || (l = {}));
(function(e) {
e[e.NODE_INDEX = 0] = "NODE_INDEX";
e[e.NODE_NAME = 1] = "NODE_NAME";
})(s || (s = {}));
var m = function(e) {
a(t, e);
function t() {
var t = null !== e && e.apply(this, arguments) || this;
t.watchPath = "";
t.foreachChildMode = !1;
t.condition = r["=="];
t.foreachChildType = s.NODE_INDEX;
t.valueA = 0;
t.valueB = 0;
t.valueAction = l.NODE_ACTIVE;
t.valueActionOpacity = 0;
t.valueActionColor = cc.color(155, 155, 155);
t.valueComponentName = "";
t.valueComponentProperty = "";
t.valueComponentDefaultValue = "";
t.valueComponentActionValue = "";
t.watchNodes = [];
return t;
}
t.prototype.onLoad = function() {
e.prototype.onLoad.call(this);
if (0 == this.watchNodes.length) {
this.valueAction !== l.NODE_ACTIVE && !1 === this.foreachChildMode && this.watchNodes.push(this.node);
this.watchNodes = this.watchNodes.concat(this.node.children);
}
};
t.prototype.start = function() {
this.enabled && this.onValueInit();
};
t.prototype.onValueInit = function() {
var e = c.VM.getValue(this.watchPath);
this.checkNodeFromValue(e);
};
t.prototype.onValueChanged = function(e) {
this.checkNodeFromValue(e);
};
t.prototype.checkNodeFromValue = function(e) {
var t = this;
if (this.foreachChildMode) this.watchNodes.forEach(function(o, n) {
var a = t.foreachChildType === s.NODE_INDEX ? n : o.name, i = t.conditionCheck(e, a);
t.setNodeState(o, i);
}); else {
var o = this.conditionCheck(e, this.valueA, this.valueB);
this.setNodesStates(o);
}
};
t.prototype.setNodesStates = function(e) {
var t = this, o = this.watchNodes, n = e;
o.forEach(function(e) {
t.setNodeState(e, n);
});
};
t.prototype.setNodeState = function(e, t) {
var o = this.valueAction, n = t, a = l;
switch (o) {
case a.NODE_ACTIVE:
e.active = !!n;
break;

case a.NODE_VISIBLE:
e.opacity = n ? 255 : 0;
break;

case a.NODE_COLOR:
e.color = n ? this.valueActionColor : cc.color(255, 255, 255);
break;

case a.NODE_OPACITY:
e.opacity = n ? this.valueActionOpacity : 255;
break;

case a.COMPONENT_CUSTOM:
var i = e.getComponent(this.valueComponentName);
if (null == i) return;
this.valueComponentProperty in i && (i[this.valueComponentProperty] = n ? this.valueComponentActionValue : this.valueComponentDefaultValue);
}
};
t.prototype.conditionCheck = function(e, t, o) {
var n = r;
switch (this.condition) {
case n["=="]:
if (e == t) return !0;
break;

case n["!="]:
if (e != t) return !0;
break;

case n["<"]:
if (e < t) return !0;
break;

case n[">"]:
if (e > t) return !0;
break;

case n[">="]:
if (e >= t) return !0;
break;

case n["<"]:
if (e < t) return !0;
break;

case n["<="]:
if (e <= t) return !0;
break;

case n.range:
if (e >= t && e <= o) return !0;
}
return !1;
};
i([ h ], t.prototype, "watchPath", void 0);
i([ h({
tooltip: "遍历子节点,根据子节点的名字或名字转换为值，判断值满足条件 来激活"
}) ], t.prototype, "foreachChildMode", void 0);
i([ h({
type: cc.Enum(r)
}) ], t.prototype, "condition", void 0);
i([ h({
type: cc.Enum(s),
tooltip: "遍历子节点,根据子节点的名字转换为值，判断值满足条件 来激活",
visible: function() {
return !0 === this.foreachChildMode;
}
}) ], t.prototype, "foreachChildType", void 0);
i([ h({
displayName: "Value: a",
visible: function() {
return !1 === this.foreachChildMode;
}
}) ], t.prototype, "valueA", void 0);
i([ h({
displayName: "Value: b",
visible: function() {
return !1 === this.foreachChildMode && this.condition === r.range;
}
}) ], t.prototype, "valueB", void 0);
i([ h({
type: cc.Enum(l),
tooltip: "一旦满足条件就对节点执行操作"
}) ], t.prototype, "valueAction", void 0);
i([ h({
visible: function() {
return this.valueAction === l.NODE_OPACITY;
},
range: [ 0, 255 ],
type: cc.Integer,
displayName: "Action Opacity"
}) ], t.prototype, "valueActionOpacity", void 0);
i([ h({
visible: function() {
return this.valueAction === l.NODE_COLOR;
},
displayName: "Action Color"
}) ], t.prototype, "valueActionColor", void 0);
i([ h({
visible: function() {
return this.valueAction === l.COMPONENT_CUSTOM;
},
displayName: "Component Name"
}) ], t.prototype, "valueComponentName", void 0);
i([ h({
visible: function() {
return this.valueAction === l.COMPONENT_CUSTOM;
},
displayName: "Component Property"
}) ], t.prototype, "valueComponentProperty", void 0);
i([ h({
visible: function() {
return this.valueAction === l.COMPONENT_CUSTOM;
},
displayName: "Default Value"
}) ], t.prototype, "valueComponentDefaultValue", void 0);
i([ h({
visible: function() {
return this.valueAction === l.COMPONENT_CUSTOM;
},
displayName: "Action Value"
}) ], t.prototype, "valueComponentActionValue", void 0);
i([ h({
type: [ cc.Node ],
tooltip: "需要执行条件的节点，如果不填写则默认会执行本节点以及本节点的所有子节点 的状态"
}) ], t.prototype, "watchNodes", void 0);
return i([ p, f("ModelViewer/VM-State (VM状态控制)"), _("https://github.com/wsssheep/cocos_creator_mvvm_tools/blob/master/docs/VMState.md") ], t);
}(u.default);
o.default = m;
cc._RF.pop();
}, {
"./VMBase": "VMBase",
"./ViewModel": "ViewModel"
} ],
VSArrow: [ function(e, t, o) {
"use strict";
cc._RF.push(t, "e0591eLGV1M+KbyogvKkEd7", "VSArrow");
var n, a = this && this.__extends || (n = function(e, t) {
return (n = Object.setPrototypeOf || {
__proto__: []
} instanceof Array && function(e, t) {
e.__proto__ = t;
} || function(e, t) {
for (var o in t) Object.prototype.hasOwnProperty.call(t, o) && (e[o] = t[o]);
})(e, t);
}, function(e, t) {
n(e, t);
function o() {
this.constructor = e;
}
e.prototype = null === t ? Object.create(t) : (o.prototype = t.prototype, new o());
}), i = this && this.__decorate || function(e, t, o, n) {
var a, i = arguments.length, r = i < 3 ? t : null === n ? n = Object.getOwnPropertyDescriptor(t, o) : n;
if ("object" == typeof Reflect && "function" == typeof Reflect.decorate) r = Reflect.decorate(e, t, o, n); else for (var l = e.length - 1; l >= 0; l--) (a = e[l]) && (r = (i < 3 ? a(r) : i > 3 ? a(t, o, r) : a(t, o)) || r);
return i > 3 && r && Object.defineProperty(t, o, r), r;
};
Object.defineProperty(o, "__esModule", {
value: !0
});
var r = e("../../../Game/fromework/global/Tools"), l = cc._decorator, s = l.ccclass, c = l.property, u = function(e) {
a(t, e);
function t() {
var t = null !== e && e.apply(this, arguments) || this;
t.Arrow = null;
t.VS = null;
t._beginPos = cc.Vec2.ZERO;
t._endPos = cc.Vec2.ZERO;
return t;
}
t.prototype.pointTo = function(e, t, o) {
this._beginPos = e;
this._endPos = t;
var n = r.Tools.TCreator.getAngle(e, t);
this.Arrow.node.setPosition(e);
this.Arrow.node.angle = n - 90;
var a = 0;
cc.tween(this.Arrow.node).parallel(cc.tween(this.Arrow.node).to(1, {
x: t.x,
y: t.y
}).set({
x: e.x,
y: e.y
}).call(function() {
1 <= ++a && o && o();
}), cc.tween(this.Arrow.node).to(.1, {
opacity: 255
}).delay(.7).to(.1, {
opacity: 0
})).repeatForever().start();
};
t.prototype.fadeOut = function(e) {
cc.tween(this.Arrow.node).to(.1, {
opacity: 0
}).call(function() {
e && e();
}).start();
};
t.prototype.showVS = function(e) {
var t = cc.instantiate(this.VS);
t.setPosition(cc.v2((this._endPos.x + this._beginPos.x) / 2, (this._endPos.y + this._beginPos.y) / 2));
t.parent = this.node;
t.getComponent(cc.Animation).once("finished", function() {
e && e();
});
};
t.prototype.start = function() {};
i([ c(cc.Sprite) ], t.prototype, "Arrow", void 0);
i([ c(cc.Prefab) ], t.prototype, "VS", void 0);
return i([ s ], t);
}(cc.Component);
o.default = u;
cc._RF.pop();
}, {
"../../../Game/fromework/global/Tools": "Tools"
} ],
ViewModel: [ function(e, t, o) {
"use strict";
cc._RF.push(t, "f48c0TUqEROVqx9PaINtbXc", "ViewModel");
Object.defineProperty(o, "__esModule", {
value: !0
});
o.VM = void 0;
var n = e("../../../../platform/Platform"), a = e("./JsonOb"), i = "VC:";
function r(e, t, o, a) {
void 0 === a && (a = "");
for (var i = t.split("."), r = 0; r < i.length; r++) {
var l = i[r];
if (l in e == 0) {
n.default.error("[" + l + "] not find in " + a + "." + t);
break;
}
r == i.length - 1 ? e[l] = o : e = e[l];
}
}
function l(e, t, o, a) {
void 0 === a && (a = "");
for (var i = t.split("."), r = 0; r < i.length; r++) {
var l = i[r];
if (l in e == 0) {
n.default.error("[" + l + "] not find in " + a + "." + t);
return o;
}
e = e[l];
}
null !== e && "undefined" != typeof e || (e = o);
return e;
}
var s = function() {
function e(e, t) {
this._tag = null;
this.active = !0;
this.emitToRootPath = !1;
new a.JsonOb(e, this._callback.bind(this));
this.$data = e;
this._tag = t;
}
e.prototype._callback = function(e, t, o) {
if (1 == this.active) {
var n = i + this._tag + "." + o.join(".");
cc.director.emit(n, e, t, [ this._tag ].concat(o));
this.emitToRootPath && cc.director.emit(i + this._tag, e, t, o);
if (o.length >= 2) for (var a = 0; a < o.length - 1; a++) o[a];
}
};
e.prototype.setValue = function(e, t) {
r(this.$data, e, t, this._tag);
};
e.prototype.getValue = function(e, t) {
return l(this.$data, e, t, this._tag);
};
return e;
}(), c = function() {
function e() {
this._mvs = [];
this.EMIT_HEAD = i;
this.setObjValue = r;
this.getObjValue = l;
}
e.prototype.add = function(e, t, o) {
void 0 === t && (t = "global");
void 0 === o && (o = !1);
var a = new s(e, t), i = this._mvs.find(function(e) {
return e.tag === t;
});
if (t.includes(".")) n.default.error("cant write . in tag:", t); else if (i) n.default.error("already set VM tag:" + t); else {
a.emitToRootPath = o;
this._mvs.push({
tag: t,
vm: a
});
}
};
e.prototype.remove = function(e) {
var t = this._mvs.findIndex(function(t) {
return t.tag === e;
});
t >= 0 && this._mvs.splice(t, 1);
};
e.prototype.get = function(e) {
var t = this._mvs.find(function(t) {
return t.tag === e;
});
if (null != t) return t.vm;
n.default.warn("cant find VM from:", e);
};
e.prototype.addValue = function(e, t) {
var o = (e = e.trim()).split(".");
o.length < 2 && n.default.error("Cant find path:" + e);
var a = this.get(o[0]);
if (a) {
var i = o.slice(1).join(".");
a.setValue(i, a.getValue(i) + t);
} else n.default.error("Cant Set VM:" + o[0]);
};
e.prototype.getValue = function(e, t) {
var o = (e = e.trim()).split(".");
if (o.length < 2) n.default.error("Get Value Cant find path:" + e); else {
var a = this.get(o[0]);
if (a) return a.getValue(o.slice(1).join("."), t);
n.default.error("Cant Get VM:" + o[0]);
}
};
e.prototype.setValue = function(e, t) {
var o = (e = e.trim()).split(".");
if (o.length < 2) n.default.error("Set Value Cant find path:" + e); else {
var a = this.get(o[0]);
a ? a.setValue(o.slice(1).join("."), t) : n.default.error("Cant Set VM:" + o[0]);
}
};
e.prototype.bindPath = function(e, t, o, a) {
"" != (e = e.trim()) ? "*" !== e.split(".")[0] ? cc.director.on(i + e, t, o, a) : n.default.error(e, "路径不合法,可能错误覆盖了 VMParent 的onLoad 方法, 或者父节点并未挂载 VMParent 相关的组件脚本") : n.default.error(o.node.name, "节点绑定的路径为空");
};
e.prototype.unbindPath = function(e, t, o) {
"*" !== (e = e.trim()).split(".")[0] ? cc.director.off(i + e, t, o) : n.default.error(e, "路径不合法,可能错误覆盖了 VMParent 的onLoad 方法, 或者父节点并未挂载 VMParent 相关的组件脚本");
};
e.prototype.inactive = function() {
this._mvs.forEach(function(e) {
e.vm.active = !1;
});
};
e.prototype.active = function() {
this._mvs.forEach(function(e) {
e.vm.active = !0;
});
};
return e;
}();
o.VM = new c();
cc._RF.pop();
}, {
"../../../../platform/Platform": "Platform",
"./JsonOb": "JsonOb"
} ],
Waiting: [ function(e, t, o) {
"use strict";
cc._RF.push(t, "f2c49zo4kZHAaNPumby9Ozl", "Waiting");
var n, a = this && this.__extends || (n = function(e, t) {
return (n = Object.setPrototypeOf || {
__proto__: []
} instanceof Array && function(e, t) {
e.__proto__ = t;
} || function(e, t) {
for (var o in t) Object.prototype.hasOwnProperty.call(t, o) && (e[o] = t[o]);
})(e, t);
}, function(e, t) {
n(e, t);
function o() {
this.constructor = e;
}
e.prototype = null === t ? Object.create(t) : (o.prototype = t.prototype, new o());
}), i = this && this.__decorate || function(e, t, o, n) {
var a, i = arguments.length, r = i < 3 ? t : null === n ? n = Object.getOwnPropertyDescriptor(t, o) : n;
if ("object" == typeof Reflect && "function" == typeof Reflect.decorate) r = Reflect.decorate(e, t, o, n); else for (var l = e.length - 1; l >= 0; l--) (a = e[l]) && (r = (i < 3 ? a(r) : i > 3 ? a(t, o, r) : a(t, o)) || r);
return i > 3 && r && Object.defineProperty(t, o, r), r;
};
Object.defineProperty(o, "__esModule", {
value: !0
});
var r = e("../../Game/client/model/LanguageModel"), l = e("../../platform/Platform"), s = cc._decorator, c = s.ccclass, u = s.property, d = s.menu, p = function(e) {
a(t, e);
function t() {
var t = null !== e && e.apply(this, arguments) || this;
t.Panel = null;
t.Text = null;
t.Spine = null;
t.Matching = null;
t.TipsLabel = null;
t.CardWaiting = null;
t.WaitingAnimation = null;
t._timeId = -1;
t._timeIDCard = -1;
return t;
}
t.prototype.beginAct = function() {
this.Spine.node.active = !0;
this.Spine.setAnimation(0, "loading_tex", !0);
};
t.prototype.endAct = function() {
this.Spine.node.active = !1;
};
t.prototype.show = function(e, t) {
var o = this;
if (this.Text) {
this.beginAct();
this.Text.string = e || "";
this.node.active = !0;
this.Matching.active = !1;
l.default.log("Waiting show delayTime:", t);
this.Panel.active = !1;
if (-1 != this._timeId) {
clearTimeout(this._timeId);
this._timeId = -1;
}
if (0 != t) this._timeId = setTimeout(function() {
if (o && o.node && o.node.isValid && o._timeId > 0) {
o.Panel.active = !0;
o.CardWaiting.active && o._hideCardWaiting();
l.default.log("Waiting show---  _timeId", o._timeId);
}
o._timeId = -1;
}, 1e3 * t); else {
this.Panel.active = !0;
this.CardWaiting.active && this._hideCardWaiting();
}
l.default.log("Waiting show _timeId:", this._timeId);
}
};
t.prototype.hide = function() {
l.default.log("Waiting hide - _timeId:" + this._timeId);
if (-1 != this._timeId) {
clearTimeout(this._timeId);
this._timeId = -1;
}
this.endAct();
this.node.active = !1;
l.default.log("Waiting 2 hide - _timeId:" + this._timeId);
};
t.prototype.showMatching = function() {
this.node.active = !0;
this.Panel.active = !1;
this.CardWaiting.active = !1;
this.Matching.active = !0;
var e = r.default.getString("ENTER_GAME_MATCHING");
this.changeDots(e);
};
t.prototype.hideMatching = function() {
this.node.active = !1;
this.Matching.active = !1;
this.TipsLabel.node.stopAllActions();
};
t.prototype.changeDots = function(e) {
var t = this, o = "", n = 0;
this.TipsLabel.string = "";
this.TipsLabel.node.stopAllActions();
var a = cc.delayTime(.5), i = cc.callFunc(function() {
n > 3 && (n = 0);
o = "";
for (var a = 0; a < n; ++a) o += ".";
t.TipsLabel.string = e + o;
++n;
}), r = cc.sequence(i, a), l = cc.repeatForever(r);
this.TipsLabel.node.runAction(l);
};
t.prototype.showCardWaiting = function(e, t, o) {
var n = this;
void 0 === o && (o = 1);
this.node.active = !0;
this.Panel.active = !1;
this.Matching.active = !1;
this.CardWaiting.active = !1;
var a = this.CardWaiting.convertToNodeSpaceAR(t);
this.WaitingAnimation.node.scale = o;
this.WaitingAnimation.node.setPosition(a);
this.WaitingAnimation.node.stopAllActions();
this.WaitingAnimation.fillRange = 0;
if (-1 != this._timeIDCard) {
clearTimeout(this._timeIDCard);
this._timeIDCard = -1;
}
if (0 != e) this._timeIDCard = setTimeout(function() {
n._timeIDCard = -1;
if (n && n.node && n.node.isValid) {
n.CardWaiting.active = !0;
n.WaitingAnimation.fillRange = 0;
cc.tween(n.WaitingAnimation).to(1.3, {
fillRange: -1
}).start();
}
}, 1e3 * e); else {
this.CardWaiting.active = !0;
this.WaitingAnimation.fillRange = 0;
cc.tween(this.WaitingAnimation).to(1.3, {
fillRange: -1
}).start();
}
};
t.prototype.hideCardWaiting = function() {
this.node.active = !1;
this.Panel.active = !1;
this.Matching.active = !1;
this._hideCardWaiting();
};
t.prototype._hideCardWaiting = function() {
this.CardWaiting.active = !1;
this.WaitingAnimation.node.setPosition(cc.Vec2.ZERO);
if (-1 != this._timeIDCard) {
clearTimeout(this._timeIDCard);
this._timeIDCard = -1;
}
};
i([ u(cc.Node) ], t.prototype, "Panel", void 0);
i([ u(cc.Label) ], t.prototype, "Text", void 0);
i([ u(sp.Skeleton) ], t.prototype, "Spine", void 0);
i([ u(cc.Node) ], t.prototype, "Matching", void 0);
i([ u(cc.Label) ], t.prototype, "TipsLabel", void 0);
i([ u(cc.Node) ], t.prototype, "CardWaiting", void 0);
i([ u(cc.Sprite) ], t.prototype, "WaitingAnimation", void 0);
return i([ c, d("component/Waiting(加载,链接组件)") ], t);
}(cc.Component);
o.default = p;
cc._RF.pop();
}, {
"../../Game/client/model/LanguageModel": "LanguageModel",
"../../platform/Platform": "Platform"
} ],
WalletActItem: [ function(e, t, o) {
"use strict";
cc._RF.push(t, "8f5408kJ4BLTZq5eyLODLp7", "WalletActItem");
var n, a = this && this.__extends || (n = function(e, t) {
return (n = Object.setPrototypeOf || {
__proto__: []
} instanceof Array && function(e, t) {
e.__proto__ = t;
} || function(e, t) {
for (var o in t) Object.prototype.hasOwnProperty.call(t, o) && (e[o] = t[o]);
})(e, t);
}, function(e, t) {
n(e, t);
function o() {
this.constructor = e;
}
e.prototype = null === t ? Object.create(t) : (o.prototype = t.prototype, new o());
}), i = this && this.__decorate || function(e, t, o, n) {
var a, i = arguments.length, r = i < 3 ? t : null === n ? n = Object.getOwnPropertyDescriptor(t, o) : n;
if ("object" == typeof Reflect && "function" == typeof Reflect.decorate) r = Reflect.decorate(e, t, o, n); else for (var l = e.length - 1; l >= 0; l--) (a = e[l]) && (r = (i < 3 ? a(r) : i > 3 ? a(t, o, r) : a(t, o)) || r);
return i > 3 && r && Object.defineProperty(t, o, r), r;
};
Object.defineProperty(o, "__esModule", {
value: !0
});
var r = e("../../component/RedDot"), l = e("../../../Game/client/model/LanguageModel"), s = e("../../model/RedDotModel"), c = e("../../../Game/client/global/enum/game/Game"), u = e("../../../Game/fromework/global/Tools"), d = e("../../../Game/fromework/helper/EventHelper"), p = e("../../../Game/client/global/enum/game/Event"), h = cc._decorator, f = h.ccclass, _ = h.property, m = function(e) {
a(t, e);
function t() {
var t = null !== e && e.apply(this, arguments) || this;
t.ActName = null;
t.Discount = null;
t.Time = null;
t.Buttons = null;
t.JoinButton = null;
t.DetailButton = null;
t.Detail = null;
t.DetailDiscount = null;
t.TableParent = null;
t.LineNode = null;
t.TableLabel = null;
t.BonusDetail = null;
t.Explain = null;
t.RedDot = null;
t._cellHeight = 50;
t._data = null;
return t;
}
t.prototype.setButtonsActive = function(e) {
this.Buttons.active = e;
};
t.prototype.setDetailActive = function(e) {
this.Detail.active = e;
};
t.prototype.onItemInitCallFunc = function(e) {
this._data = e;
this._data && this.RedDot.setBindKeys([ c.GameEnum.RedDotKey.RechargeActivity + this._data.id ]);
this.ActName.string = this._data.title;
this.Discount.string = this._data.subtitle;
this.DetailDiscount.string = this._data.subtitle;
var t = u.Tools.TDate.second2Day(this._data.end_time - this._data.now_time), o = u.Tools.TStr.replaceString(l.default.getString("COMMON_SURPLUS_TIME"), t);
this.Time.string = u.Tools.TStr.replaceAll(l.default.getString("ADD_EX"), "%{num}", o);
this.initTable();
this.initBonusDetail();
this.initExplain();
};
t.prototype.onItemEnterCallFunc = function() {
this.node.opacity = 255;
this.JoinButton.interactable = !0;
this.DetailButton.interactable = !0;
};
t.prototype.onItemExitCallFunc = function() {
this.node.opacity = 0;
this.JoinButton.interactable = !1;
this.DetailButton.interactable = !1;
};
t.prototype.initTable = function() {
this.TableParent.destroyAllChildren();
var e = this._data.table ? this._data.table : [], t = e[0] ? e[0].length : 0, o = e.length ? e.length : 0, n = this.TableParent.width, a = o * this._cellHeight, i = n / t;
this.TableParent.height = a;
for (var r = 0; r < o; r++) {
if (r < o) {
var l = cc.instantiate(this.LineNode);
this.TableParent.addChild(l);
l.active = !0;
l.width = n;
l.setPosition(n / 2, -this._cellHeight * r);
}
for (var s = 0; s < t; s++) {
if (0 == r && s < t - 1) {
var c = cc.instantiate(this.LineNode);
this.TableParent.addChild(c);
c.active = !0;
c.width = a;
c.angle = 90;
c.setPosition(i * (s + 1), -a / 2);
}
var u = cc.instantiate(this.TableLabel);
this.TableParent.addChild(u);
var d = u.getComponent(cc.Label);
u.active = !0;
u.setPosition(i / 2 + s * i, -(this._cellHeight / 2 + r * this._cellHeight));
var p = e[r][s];
d.string = p || "";
}
}
};
t.prototype.initBonusDetail = function() {
var e = this._data.des.split("\n");
this.BonusDetail.destroyAllChildren();
for (var t = 0; t < e.length; t++) {
var o = cc.instantiate(this.TableLabel);
this.BonusDetail.addChild(o);
o.active = !0;
o.setAnchorPoint(cc.v2(0, .5));
o.x = 10;
o.width = 580;
var n = o.getComponent(cc.Label);
n.string = e[t];
n.horizontalAlign = cc.Label.HorizontalAlign.LEFT;
n.overflow = cc.Label.Overflow.RESIZE_HEIGHT;
n.fontSize = 18;
n.lineHeight = 18;
}
};
t.prototype.initExplain = function() {
var e = this._data.provision.split("\n");
this.Explain.destroyAllChildren();
for (var t = 0; t < e.length; t++) {
var o = cc.instantiate(this.TableLabel);
this.Explain.addChild(o);
o.active = !0;
o.setAnchorPoint(cc.v2(0, .5));
o.x = -290;
o.width = 580;
o.color = cc.color(255, 255, 255);
var n = o.getComponent(cc.Label);
n.string = e[t];
n.horizontalAlign = cc.Label.HorizontalAlign.LEFT;
n.overflow = cc.Label.Overflow.RESIZE_HEIGHT;
n.fontSize = 18;
n.lineHeight = 18;
}
};
t.prototype.onJoinBtnClicked = function() {
s.default.Instance.delRechargeRedDot(this._data);
d.default.Instance.Global.emit(p.WalletEvent.ACTIVITY_SELECT, this._data);
};
t.prototype.onDetailBtnClicked = function() {
this.Detail.active = !this.Detail.active;
var e = this.DetailButton.node.getChildByName("Title").getComponent(cc.Label), t = this.DetailButton.node.getChildByName("Arrow");
e.string = this.Detail.active ? l.default.getString("WALLET_ITEM_CLOSE") : l.default.getString("WALLER_ITEM_MORE");
t.angle = this.Detail.active ? 180 : 0;
};
i([ _(cc.Label) ], t.prototype, "ActName", void 0);
i([ _(cc.Label) ], t.prototype, "Discount", void 0);
i([ _(cc.Label) ], t.prototype, "Time", void 0);
i([ _(cc.Node) ], t.prototype, "Buttons", void 0);
i([ _(cc.Button) ], t.prototype, "JoinButton", void 0);
i([ _(cc.Button) ], t.prototype, "DetailButton", void 0);
i([ _(cc.Node) ], t.prototype, "Detail", void 0);
i([ _(cc.Label) ], t.prototype, "DetailDiscount", void 0);
i([ _(cc.Node) ], t.prototype, "TableParent", void 0);
i([ _(cc.Node) ], t.prototype, "LineNode", void 0);
i([ _(cc.Node) ], t.prototype, "TableLabel", void 0);
i([ _(cc.Node) ], t.prototype, "BonusDetail", void 0);
i([ _(cc.Node) ], t.prototype, "Explain", void 0);
i([ _(r.default) ], t.prototype, "RedDot", void 0);
return i([ f ], t);
}(cc.Component);
o.default = m;
cc._RF.pop();
}, {
"../../../Game/client/global/enum/game/Event": "Event",
"../../../Game/client/global/enum/game/Game": "Game",
"../../../Game/client/model/LanguageModel": "LanguageModel",
"../../../Game/fromework/global/Tools": "Tools",
"../../../Game/fromework/helper/EventHelper": "EventHelper",
"../../component/RedDot": "RedDot",
"../../model/RedDotModel": "RedDotModel"
} ],
WalletActivity: [ function(e, t, o) {
"use strict";
cc._RF.push(t, "8d69eAulYZGp5oREkfIRm+V", "WalletActivity");
var n, a = this && this.__extends || (n = function(e, t) {
return (n = Object.setPrototypeOf || {
__proto__: []
} instanceof Array && function(e, t) {
e.__proto__ = t;
} || function(e, t) {
for (var o in t) Object.prototype.hasOwnProperty.call(t, o) && (e[o] = t[o]);
})(e, t);
}, function(e, t) {
n(e, t);
function o() {
this.constructor = e;
}
e.prototype = null === t ? Object.create(t) : (o.prototype = t.prototype, new o());
}), i = this && this.__decorate || function(e, t, o, n) {
var a, i = arguments.length, r = i < 3 ? t : null === n ? n = Object.getOwnPropertyDescriptor(t, o) : n;
if ("object" == typeof Reflect && "function" == typeof Reflect.decorate) r = Reflect.decorate(e, t, o, n); else for (var l = e.length - 1; l >= 0; l--) (a = e[l]) && (r = (i < 3 ? a(r) : i > 3 ? a(t, o, r) : a(t, o)) || r);
return i > 3 && r && Object.defineProperty(t, o, r), r;
};
Object.defineProperty(o, "__esModule", {
value: !0
});
var r = e("../../../Game/fromework/helper/UIHelper"), l = e("../../../Game/client/global/enum/game/Event"), s = e("../../model/WalletModel"), c = e("./WalletActItem"), u = e("../../../Game/fromework/helper/EventHelper"), d = cc._decorator, p = d.ccclass, h = d.property, f = function(e) {
a(t, e);
function t() {
var t = null !== e && e.apply(this, arguments) || this;
t.Panel = null;
t.Activity = null;
t.ActivityItem = null;
t.NoActivity = null;
t._isPlayAnimation = !1;
return t;
}
t.prototype.onEnable = function() {
u.default.Instance.Global.bind(l.WalletEvent.ACTIVITY_SELECT, this.onCloseClicked, this);
};
t.prototype.onDisable = function() {
u.default.Instance.Global.unbind(l.WalletEvent.ACTIVITY_SELECT, this.onCloseClicked, this);
};
t.prototype.playInAnimation = function(e, t) {
var o = this;
if (!this._isPlayAnimation) {
this._isPlayAnimation = !0;
e.on(cc.Animation.EventType.FINISHED, function() {
o._isPlayAnimation = !1;
t && t();
}, this);
e.play("WalletRechargeActivityIn");
}
};
t.prototype.playOutAnimation = function(e, t) {
var o = this;
if (!this._isPlayAnimation) {
this._isPlayAnimation = !0;
e.on(cc.Animation.EventType.FINISHED, function() {
o._isPlayAnimation = !1;
t && t();
}, this);
e.play("WalletRechargeActivityOut");
}
};
t.prototype.InitView = function() {
this.initActivity();
this.playInAnimation(this.Panel.getComponent(cc.Animation));
};
t.prototype.initActivity = function() {
for (var e = s.WalletProxy.Instance.activityList.concat(), t = 0; t < e.length; t++) {
var o = e[t], n = cc.instantiate(this.ActivityItem), a = n.getComponent(c.default);
n.zIndex = 0;
this.Activity.addChild(n);
a.onItemInitCallFunc(o, t);
}
this.NoActivity.active = 0 == e.length;
};
t.prototype.onCloseClicked = function() {
var e = this;
this.playOutAnimation(this.Panel.getComponent(cc.Animation), function() {
r.default.Instance.removeMaskLayer(e.node);
});
};
i([ h(cc.Node) ], t.prototype, "Panel", void 0);
i([ h(cc.Node) ], t.prototype, "Activity", void 0);
i([ h(cc.Prefab) ], t.prototype, "ActivityItem", void 0);
i([ h(cc.Node) ], t.prototype, "NoActivity", void 0);
return i([ p ], t);
}(cc.Component);
o.default = f;
cc._RF.pop();
}, {
"../../../Game/client/global/enum/game/Event": "Event",
"../../../Game/fromework/helper/EventHelper": "EventHelper",
"../../../Game/fromework/helper/UIHelper": "UIHelper",
"../../model/WalletModel": "WalletModel",
"./WalletActItem": "WalletActItem"
} ],
WalletHelper: [ function(e, t, o) {
"use strict";
cc._RF.push(t, "64886ra/NxOILj2QSLgp1jc", "WalletHelper");
Object.defineProperty(o, "__esModule", {
value: !0
});
var n = e("../../../Config"), a = e("../../../Game/client/model/LanguageModel"), i = e("../../model/WalletModel"), r = e("../ui/AddCash/AddCash"), l = e("../ui/Refer/ReferView"), s = e("../ui/Service/ServiceView"), c = e("../ui/Shop/ShopView"), u = e("./BonusRecord"), d = e("./RechargeView"), p = e("./WalletKYC"), h = e("./WalletMain"), f = e("./WalletWithdraw"), _ = e("../../model/UserModel"), m = e("../ui/Recent/RecentView"), y = e("../../../Game/fromework/helper/EventHelper"), g = e("../../../Game/client/global/enum/game/Event"), v = e("../../../Game/Script/global/GlobalValue"), C = e("../../../Game/client/global/enum/game/Const"), b = e("../../../Game/fromework/helper/UIHelper"), I = e("../../../Game/fromework/mvvm/modelView/ViewModel"), E = e("../../../Game/fromework/global/Tools"), S = e("../../../Game/client/global/enum/game/Game"), T = e("../../../Game/fromework/net/NetHttp"), R = e("../../global/PopHelper"), O = e("../../../platform/Platform"), A = function() {
function e() {}
Object.defineProperty(e, "Instance", {
get: function() {
e._Instance || (e._Instance = new e());
return e._Instance;
},
enumerable: !1,
configurable: !0
});
e.prototype.Init = function() {
cc.game.on(cc.game.EVENT_SHOW, this._onShowApp, this);
};
e.prototype.destory = function() {
cc.game.off(cc.game.EVENT_SHOW, this._onShowApp, this);
};
e.prototype._onShowApp = function() {
y.default.Instance.Global.emit(g.WalletEvent.RECHARGE_BROWSER_END);
};
e.prototype.onPayment = function(t, o) {
var n = "";
1 == t.code ? 1 == t.payWay ? n = "purchase succeeds!" : t.data && t.data.isOpenURL ? cc.sys.openURL(t.data.payLinks) : e.Instance.openRechargeWebView(t.data.payLinks) : n = 6001 == t.code ? a.default.getString("WALLET_CASH_ATTEND") : 6003 == t.code ? a.default.getString("WALLET_CASH_WRONG") : 6004 == t.code ? a.default.getString("WALLET_CASH_UID") : 6005 == t.code ? a.default.getString("WALLET_CASH_ORDER") : 6006 == t.code ? a.default.getString("WALLET_CASH_THIRD") : 6008 == t.code ? a.default.getString("WALLET_CASH_TYPE") : 999 == t.code ? t.msg : "Error code:" + t.code;
if ("" != n) {
R.PopHelper.Instance.showTips(n);
o && o();
}
};
e.prototype.openWallet = function() {
v.default.getInstance().isCashGame ? b.default.Instance.changeLayer(C.BundleUIPath.WalletMain, function(e) {
e.getComponent(h.default).InitView();
}) : this.openShop();
};
e.prototype.openRecharge = function(e, t) {
(v.default.getInstance().isCashGame || _.default.checkOrganicSwitch(_.OrganicSwitch.ORGANIC_FUNC_SWITCH_RECHARGE)) && b.default.Instance.addBundleMaskLayer(C.BundleUIPath.AddCash, function(o) {
o.getComponent(r.default).InitView(e);
t && t();
}, R.PopZindex.AddCash);
};
e.prototype.openWithdraw = function(e) {
b.default.Instance.addBundleLayer(C.BundleUIPath.WalletWithdraw, function(t) {
t.getComponent(f.default).InitView();
e && e();
});
};
e.prototype.openShop = function() {
b.default.Instance.addBundleMaskLayer(C.BundleUIPath.ShopView, function(e) {
e.getComponent(c.default).InitView();
});
};
e.prototype.openRechargeView = function(e, t, o, n, a, r, l) {
var s = this;
void 0 === t && (t = 0);
void 0 === o && (o = 0);
void 0 === n && (n = 0);
void 0 === a && (a = 0);
void 0 === r && (r = 0);
void 0 === l && (l = 0);
0 != t ? i.WalletProxy.Instance.sendPayment(t, o, 0, 0, function(t) {
var o = JSON.parse(t.response);
s.onPayment(o, e);
}, n, a, r, l) : this.openRecharge({
activityId: o,
cash: t
});
};
e.prototype.openBonusRecord = function() {
b.default.Instance.addBundleLayer(C.BundleUIPath.BonusRecord, function(e) {
e.getComponent(u.default).InitView();
});
};
e.prototype.openKYC = function() {
b.default.Instance.addBundleLayer(C.BundleUIPath.WalletKYC, function(e) {
e.getComponent(p.default).InitView();
});
};
e.prototype.openReferearn = function() {
b.default.Instance.addBundleLayer(C.BundleUIPath.ReferView, function(e) {
e.getComponent(l.default).show();
});
};
e.prototype.openRecent = function() {
b.default.Instance.addBundleLayer(C.BundleUIPath.RecentView, function(e) {
e.getComponent(m.default).InitView();
});
};
e.prototype.openRechargeAlert = function(t, o, n, i, r) {
void 0 === o && (o = 0);
void 0 === n && (n = !0);
void 0 === r && (r = !1);
var l = I.VM.getValue("wallet.total");
l >= t && 0 != o ? R.PopHelper.Instance.showTips(E.Tools.TStr.replaceAll(a.default.getString("RECHARGE_ALERT_FROZEN"), "%{amount}", E.Tools.TFloat.sub(l, o))) : e.Instance.openRecharge();
};
e.prototype.openRechargeWebView = function(e) {
O.default.setOrientation(C.Orientation.Portrait);
b.default.Instance.addBundleMaskLayer(C.BundleUIPath.RechargeView, function(t) {
t.getComponent(d.default).InitView(e);
}, R.PopZindex.NumberEditBox);
};
e.prototype.openSerciveView = function(e, t) {
void 0 === e && (e = !0);
if ("" != v.default.getInstance().ServiceUrl) {
var o = "";
o = e ? v.default.getInstance().ServiceUrl + "/index/chat/fqa?source=" + n.Config.Channel + "&uid=" + I.VM.getValue("user.uid") : v.default.getInstance().ServiceUrl + "/index/chat/chat?source=" + n.Config.Channel + "&uid=" + I.VM.getValue("user.uid");
null != t && "" != t && (o = o + "&msg=" + t);
O.default.log("openSerciveView url", o);
var a = I.VM.getValue("user.source_config");
1 == (null == a ? void 0 : a.kefu_webview) ? b.default.Instance.addBundleMaskLayer(C.BundleUIPath.ServiceView, function(e) {
e.getComponent(s.default).InitView(o);
}) : cc.sys.openURL(o);
}
y.default.Instance.Global.emit(g.RedDotEvent.REFRESH_RED_DOT_DATA, {
key: S.GameEnum.RedDotKey.ServiceUnread,
value: 0
});
};
e.prototype.getServiceUnreadCount = function() {
"" != v.default.getInstance().ServiceUrl && T.default.Instance.post(v.default.getInstance().WalletUrl + "userUnprocessedNum", {
uid: I.VM.getValue("user.uid"),
token: I.VM.getValue("user.token"),
source: n.Config.Channel
}, function(e) {
var t = JSON.parse(e.response);
if (1 == t.code) {
var o = parseInt(t.num);
O.default.log("UnreadCount:" + o);
y.default.Instance.Global.emit(g.RedDotEvent.REFRESH_RED_DOT_DATA, {
key: S.GameEnum.RedDotKey.ServiceUnread,
value: o
});
}
}, !0);
};
e.prototype.openWorkOrder = function(e) {
var t = v.default.getInstance().ServiceUrl + "/index/recharge_work_order/clientele?source=" + n.Config.Channel + "&uid=" + I.VM.getValue("user.uid") + "&order_id=" + e;
cc.sys.openURL(t);
};
e._Instance = null;
return e;
}();
o.default = A;
cc._RF.pop();
}, {
"../../../Config": "Config",
"../../../Game/Script/global/GlobalValue": "GlobalValue",
"../../../Game/client/global/enum/game/Const": "Const",
"../../../Game/client/global/enum/game/Event": "Event",
"../../../Game/client/global/enum/game/Game": "Game",
"../../../Game/client/model/LanguageModel": "LanguageModel",
"../../../Game/fromework/global/Tools": "Tools",
"../../../Game/fromework/helper/EventHelper": "EventHelper",
"../../../Game/fromework/helper/UIHelper": "UIHelper",
"../../../Game/fromework/mvvm/modelView/ViewModel": "ViewModel",
"../../../Game/fromework/net/NetHttp": "NetHttp",
"../../../platform/Platform": "Platform",
"../../global/PopHelper": "PopHelper",
"../../model/UserModel": "UserModel",
"../../model/WalletModel": "WalletModel",
"../ui/AddCash/AddCash": "AddCash",
"../ui/Recent/RecentView": "RecentView",
"../ui/Refer/ReferView": "ReferView",
"../ui/Service/ServiceView": "ServiceView",
"../ui/Shop/ShopView": "ShopView",
"./BonusRecord": "BonusRecord",
"./RechargeView": "RechargeView",
"./WalletKYC": "WalletKYC",
"./WalletMain": "WalletMain",
"./WalletWithdraw": "WalletWithdraw"
} ],
WalletInfoAlert: [ function(e, t, o) {
"use strict";
cc._RF.push(t, "04e98+BosxOb4lSHZYC+ppZ", "WalletInfoAlert");
var n, a = this && this.__extends || (n = function(e, t) {
return (n = Object.setPrototypeOf || {
__proto__: []
} instanceof Array && function(e, t) {
e.__proto__ = t;
} || function(e, t) {
for (var o in t) Object.prototype.hasOwnProperty.call(t, o) && (e[o] = t[o]);
})(e, t);
}, function(e, t) {
n(e, t);
function o() {
this.constructor = e;
}
e.prototype = null === t ? Object.create(t) : (o.prototype = t.prototype, new o());
}), i = this && this.__decorate || function(e, t, o, n) {
var a, i = arguments.length, r = i < 3 ? t : null === n ? n = Object.getOwnPropertyDescriptor(t, o) : n;
if ("object" == typeof Reflect && "function" == typeof Reflect.decorate) r = Reflect.decorate(e, t, o, n); else for (var l = e.length - 1; l >= 0; l--) (a = e[l]) && (r = (i < 3 ? a(r) : i > 3 ? a(t, o, r) : a(t, o)) || r);
return i > 3 && r && Object.defineProperty(t, o, r), r;
};
Object.defineProperty(o, "__esModule", {
value: !0
});
var r = e("../../component/NumericLabel"), l = e("../../../Game/client/model/LanguageModel"), s = e("../../model/PhoneModel"), c = e("../../model/WalletModel"), u = e("../../../Game/fromework/global/Tools"), d = e("../../global/PopHelper"), p = cc._decorator, h = p.ccclass, f = p.property, _ = function(e) {
a(t, e);
function t() {
var t = null !== e && e.apply(this, arguments) || this;
t.AlertPanel = null;
t.NameInput = null;
t.PhoneInput = null;
t._callFunc = null;
return t;
}
t.prototype.openAction = function() {
this.AlertPanel.setPosition(cc.v2(0, this.node.height / 2 + this.AlertPanel.height / 2));
this.AlertPanel.runAction(cc.moveTo(.1, cc.v2(0, 0)));
};
t.prototype.closeAction = function(e) {
var t = this;
this.AlertPanel.runAction(cc.sequence(cc.moveTo(.1, cc.v2(0, -(this.node.height / 2 + this.AlertPanel.height / 2))), cc.callFunc(function() {
e && e();
t.node.removeFromParent(!0);
t.node.destroy();
})));
};
t.prototype.InitView = function(e) {
this._callFunc = e;
var t = c.WalletProxy.Instance.rechargeUserInfo, o = t.user_name, n = t.tel_phone;
null == o && (o = "");
null == n && (n = "");
"" == n && "" != s.PhoneProxy.Instance.defaultPhone && (n = s.PhoneProxy.Instance.defaultPhone);
this.NameInput.string = o;
this.PhoneInput.string = n;
this.openAction();
};
t.prototype.onSubmitClicked = function() {
if (0 != this.NameInput.string.length) if (u.Tools.TStr.hasNumber(this.NameInput.string)) d.PopHelper.Instance.showTips(l.default.getString("KYC_DOC_INPUT_TIP_5")); else if (u.Tools.TStr.checkType(this.PhoneInput.string, "indiaPhone")) {
c.WalletProxy.Instance.sendSetRechargeUserInfo(this.NameInput.string, this.PhoneInput.string, "");
this._callFunc && this._callFunc(this.NameInput.string, this.PhoneInput.string, "");
this.onCloseClicked();
} else d.PopHelper.Instance.showTips(l.default.getString("KYC_INPUT_TIP_1")); else d.PopHelper.Instance.showTips(l.default.getString("KYC_DOC_INPUT_TIP_3"));
};
t.prototype.onCloseClicked = function() {
this.closeAction();
};
i([ f(cc.Node) ], t.prototype, "AlertPanel", void 0);
i([ f(cc.EditBox) ], t.prototype, "NameInput", void 0);
i([ f(r.default) ], t.prototype, "PhoneInput", void 0);
return i([ h ], t);
}(cc.Component);
o.default = _;
cc._RF.pop();
}, {
"../../../Game/client/model/LanguageModel": "LanguageModel",
"../../../Game/fromework/global/Tools": "Tools",
"../../component/NumericLabel": "NumericLabel",
"../../global/PopHelper": "PopHelper",
"../../model/PhoneModel": "PhoneModel",
"../../model/WalletModel": "WalletModel"
} ],
WalletKYCDocument: [ function(e, t, o) {
"use strict";
cc._RF.push(t, "f566c6UcsBA2pdzSFgg2ift", "WalletKYCDocument");
var n, a = this && this.__extends || (n = function(e, t) {
return (n = Object.setPrototypeOf || {
__proto__: []
} instanceof Array && function(e, t) {
e.__proto__ = t;
} || function(e, t) {
for (var o in t) Object.prototype.hasOwnProperty.call(t, o) && (e[o] = t[o]);
})(e, t);
}, function(e, t) {
n(e, t);
function o() {
this.constructor = e;
}
e.prototype = null === t ? Object.create(t) : (o.prototype = t.prototype, new o());
}), i = this && this.__decorate || function(e, t, o, n) {
var a, i = arguments.length, r = i < 3 ? t : null === n ? n = Object.getOwnPropertyDescriptor(t, o) : n;
if ("object" == typeof Reflect && "function" == typeof Reflect.decorate) r = Reflect.decorate(e, t, o, n); else for (var l = e.length - 1; l >= 0; l--) (a = e[l]) && (r = (i < 3 ? a(r) : i > 3 ? a(t, o, r) : a(t, o)) || r);
return i > 3 && r && Object.defineProperty(t, o, r), r;
};
Object.defineProperty(o, "__esModule", {
value: !0
});
var r = e("../../../fromework/component/listView/ListView"), l = e("../../component/NumericLabel"), s = e("../../../Game/client/model/LanguageModel"), c = e("../../model/WalletModel"), u = e("./WalletSelectImg"), d = e("../../../Game/fromework/helper/EventHelper"), p = e("../../../Game/client/global/enum/game/Event"), h = e("../../../Game/fromework/global/Tools"), f = e("../../../Game/fromework/helper/UIHelper"), _ = e("../../../Game/client/global/enum/game/Const"), m = e("../../../Game/fromework/mvvm/modelView/ViewModel"), y = e("../../global/PopHelper"), g = cc._decorator, v = g.ccclass, C = g.property, b = function(e) {
a(t, e);
function t() {
var t = null !== e && e.apply(this, arguments) || this;
t.DropView = null;
t.StateDrop = null;
t.Location = null;
t.UnKYC = null;
t.Success = null;
t.Rejected = null;
t.Waitting = null;
t.StateTitle = null;
t.NameInput = null;
t.NumberInput = null;
t.DateInput = null;
t.FrontSelect = null;
t.BackSelect = null;
t.StateList = null;
t.StateName = [];
t.FailState = [];
t._curType = 0;
t._curSide = -1;
t._frontUrl = "";
t._backUrl = "";
return t;
}
t.prototype.onEnable = function() {
d.default.Instance.Global.bind(p.WalletEvent.RECENT_KYC_QUERY, this.onKYCQuery, this);
d.default.Instance.Global.bind(p.WalletEvent.KYC_APPLY_BACK, this.onKYCApplyBack, this);
d.default.Instance.Global.bind(p.WalletEvent.STATE_DROP_SELECT, this.onSelectState, this);
d.default.Instance.Global.bind(p.PlatformEvent.PLATFORM_PICK_ALBUM_COMPLETED, this.selectImgSuccess, this);
d.default.Instance.Global.bind(p.PlatformEvent.PLATFORM_TAKE_PHOTO_COMPLETED, this.selectImgSuccess, this);
};
t.prototype.onDisable = function() {
d.default.Instance.Global.unbind(p.WalletEvent.RECENT_KYC_QUERY, this.onKYCQuery, this);
d.default.Instance.Global.unbind(p.WalletEvent.KYC_APPLY_BACK, this.onKYCApplyBack, this);
d.default.Instance.Global.unbind(p.WalletEvent.STATE_DROP_SELECT, this.onSelectState, this);
d.default.Instance.Global.unbind(p.PlatformEvent.PLATFORM_PICK_ALBUM_COMPLETED, this.selectImgSuccess, this);
d.default.Instance.Global.unbind(p.PlatformEvent.PLATFORM_TAKE_PHOTO_COMPLETED, this.selectImgSuccess, this);
};
t.prototype.onKYCApplyBack = function(e) {
var t, o = e.getUserData();
if ("" == (t = 1 == o ? "" : 1001 == o ? s.default.getString("KYC_APPLY_BACK1") : 1002 == o ? s.default.getString("KYC_APPLY_BACK2") : 1003 == o ? s.default.getString("KYC_APPLY_BACK3") : 1009 == o ? s.default.getString("KYC_APPLY_BACK4") : 1011 == o ? s.default.getString("KYC_APPLY_BACK5") : s.default.getString("SUBMIT_FAIL"))) this.refreshView(); else {
var n = {
title: s.default.getString("PROMPT_NOTICE"),
content: t,
rightTitle: s.default.getString("ALERT_BTN_CHECK")
};
y.PopHelper.Instance.showAlert(n);
}
};
t.prototype.onKYCQuery = function() {
this.refreshView();
};
t.prototype.selectImgSuccess = function(e) {
var t = e.getUserData();
if (0 == this._curSide) {
this.FrontSelect.active = !0;
this._frontUrl = t;
}
if (1 == this._curSide) {
this.BackSelect.active = !0;
this._backUrl = t;
}
this._curSide = -1;
};
t.prototype.initState = function() {
this.StateName = [ s.default.getString("SEL_STA1"), s.default.getString("SEL_STA2"), s.default.getString("SEL_STA3"), s.default.getString("SEL_STA4"), s.default.getString("SEL_STA5"), s.default.getString("SEL_STA6"), s.default.getString("SEL_STA7"), s.default.getString("SEL_STA8"), s.default.getString("SEL_STA9"), s.default.getString("SEL_STA10"), s.default.getString("SEL_STA11"), s.default.getString("SEL_STA12"), s.default.getString("SEL_STA13"), s.default.getString("SEL_STA14"), s.default.getString("SEL_STA15"), s.default.getString("SEL_STA16"), s.default.getString("SEL_STA17"), s.default.getString("SEL_STA18"), s.default.getString("SEL_STA19"), s.default.getString("SEL_STA20"), s.default.getString("SEL_STA21"), s.default.getString("SEL_STA22"), s.default.getString("SEL_STA23"), s.default.getString("SEL_STA24"), s.default.getString("SEL_STA25"), s.default.getString("SEL_STA26"), s.default.getString("SEL_STA27"), s.default.getString("SEL_STA28"), s.default.getString("SEL_STA29"), s.default.getString("SEL_STA30"), s.default.getString("SEL_STA31"), s.default.getString("SEL_STA32"), s.default.getString("SEL_STA33"), s.default.getString("SEL_STA34"), s.default.getString("SEL_STA35"), s.default.getString("SEL_STA36") ];
this.FailState = [ s.default.getString("SEL_STA2"), s.default.getString("SEL_STA4"), s.default.getString("SEL_STA25"), s.default.getString("SEL_STA26"), s.default.getString("SEL_STA30"), s.default.getString("SEL_STA32") ];
};
t.prototype.refreshView = function() {
this.initState();
var e = c.WalletProxy.Instance.KYCState;
if (-1 == e) {
this.UnKYC.active = !1;
this.Success.active = !1;
this.Rejected.active = !1;
this.Waitting.active = !1;
c.WalletProxy.Instance.sendGetKycResult();
} else {
this.UnKYC.active = 1 != e && 1008 != e && 1006 != e;
this.Success.active = 1 == e;
this.Rejected.active = 1008 == e;
this.Waitting.active = 1006 == e;
this.refreshKYCType();
}
};
t.prototype.refreshKYCType = function() {
if (0 == this._curType) {
this.NumberInput.string = "";
this.NameInput.placeholder = s.default.getString("KYC_DOC_PLACEHOLDER");
}
if (1 == this._curType) {
this.NumberInput.string = "";
this.NameInput.placeholder = s.default.getString("DOC_NAME1");
}
if (2 == this._curType) {
this.NumberInput.string = "";
this.NameInput.placeholder = s.default.getString("KYC_PASSPORT_PLACEHOLDER2");
}
};
t.prototype.onNameInputEnd = function() {
if (0 == this.NameInput.string.length) {
y.PopHelper.Instance.showTips(s.default.getString("KYC_DOC_INPUT_TIP_3"));
return !1;
}
if (h.Tools.TStr.hasNumber(this.NameInput.string)) {
y.PopHelper.Instance.showTips(s.default.getString("KYC_DOC_INPUT_TIP_5"));
return !1;
}
return !0;
};
t.prototype.onNumberInputEnd = function() {
var e = "";
0 == this._curType && 12 != this.NumberInput.string.length && (e = s.default.getString("KYC_DOC_TIPS1"));
1 == this._curType && 15 != this.NumberInput.string.length && 16 != this.NumberInput.string.length && (e = s.default.getString("KYC_DOC_TIPS2"));
2 == this._curType && 8 != this.NumberInput.string.length && (e = s.default.getString("KYC_DOC_TIPS3"));
if ("" != e) {
y.PopHelper.Instance.showTips(e);
return !1;
}
return !0;
};
t.prototype.onDateInput = function() {
for (var e = this.DateInput.string.replace(/[^0-9]/gi, ""), t = "", o = 0; o < e.length; o++) {
t += e[o];
1 != o && 3 != o && 7 != o || (t += "/");
if (7 == o) break;
}
this.DateInput.string = t;
};
t.prototype.onDateInputEnd = function() {
if (h.Tools.TStr.checkType(this.DateInput.string, "dd/mm/yyyy")) {
var e = this.DateInput.string.split("/"), t = parseInt(e[0]), o = parseInt(e[1]), n = parseInt(e[2]);
if ((new Date().getTime() - new Date(n, o, t, 0, 0, 0).getTime()) / 3155815e4 >= 18) return !0;
y.PopHelper.Instance.showTips(s.default.getString("KYC_ALERT_AGE"));
return !1;
}
y.PopHelper.Instance.showTips(s.default.getString("KYC_DOC_INPUT_TIP_1"));
return !1;
};
t.prototype.onFrontSideClicked = function() {
var e = this;
f.default.Instance.addBundleMaskLayer(_.BundleUIPath.WalletSelectImg, function(t) {
e._curSide = 0;
t.getComponent(u.default).InitView(e._curType, e._curSide);
});
};
t.prototype.onBackSideClicked = function() {
var e = this;
f.default.Instance.addBundleMaskLayer(_.BundleUIPath.WalletSelectImg, function(t) {
e._curSide = 1;
t.getComponent(u.default).InitView(e._curType, e._curSide);
});
};
t.prototype.onRejectedClicked = function() {
this.UnKYC.active = !0;
this.Success.active = !1;
this.Rejected.active = !1;
this.Waitting.active = !1;
};
t.prototype.onStateClicked = function() {
this.StateDrop.active = !0;
var e = this.Location.parent.convertToWorldSpaceAR(this.Location.getPosition());
e.y = e.y - 40;
this.StateDrop.setPosition(this.StateDrop.parent.convertToNodeSpaceAR(e));
this.StateList.datas = this.StateName.concat();
};
t.prototype.onStateDropClose = function() {
this.StateDrop.active = !1;
};
t.prototype.onSelectState = function(e) {
var t = e.getUserData();
this.StateDrop.active = !1;
this.StateTitle.string = t;
this.FailState.indexOf(t) >= 0 && y.PopHelper.Instance.showTips(s.default.getString("KYC_DOC_INPUT_TIP_2"));
};
t.prototype.onSubmitClicked = function() {
var e = m.VM.getValue("wallet.userPhone"), t = m.VM.getValue("wallet.userEmail");
if (0 != e && "" != t) if (!cc.sys.isNative || "" != this._frontUrl && "" != this._backUrl) {
if (this.onNameInputEnd() && this.onNumberInputEnd() && this.onDateInputEnd()) if (this.StateName.indexOf(this.StateTitle.string) < 0) y.PopHelper.Instance.showTips(s.default.getString("KYC_DOC_INPUT_TIP_4")); else if (this.FailState.indexOf(this.StateTitle.string) >= 0) y.PopHelper.Instance.showTips(s.default.getString("KYC_DOC_INPUT_TIP_2")); else {
var o = this._curType + 1, n = this.NameInput.string, a = this.NumberInput.string, i = this.DateInput.string, r = "", l = "";
if (cc.sys.isNative) {
r = h.Tools.Base64.uint8arrayToBase64(jsb.fileUtils.getDataFromFile(this._frontUrl));
l = h.Tools.Base64.uint8arrayToBase64(jsb.fileUtils.getDataFromFile(this._backUrl));
} else {
r = "data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAADUlEQVQImWNgYGBgAAAABQABh6FO1AAAAABJRU5ErkJggg==";
l = "data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAADUlEQVQImWNgYGBgAAAABQABh6FO1AAAAABJRU5ErkJggg==";
}
c.WalletProxy.Instance.sendKycApply(o, n, a, i, this.StateTitle.string, r, l);
y.PopHelper.Instance.showWaiting(0, "Submitting");
}
} else y.PopHelper.Instance.showTips(s.default.getString("KYC_DOC_SUBMIT_TIP")); else {
var u = {
title: s.default.getString("PROMPT_NOTICE"),
content: s.default.getString("KYC_DOC_ALERT"),
rightTitle: s.default.getString("COMMON_TRY_AGAIN"),
rightCallFunc: function() {
d.default.Instance.Global.emit(p.WalletEvent.KYC_SELECT_TOGGLE, 0);
},
cancelCallFunc: function() {
d.default.Instance.Global.emit(p.WalletEvent.KYC_SELECT_TOGGLE, 0);
}
};
y.PopHelper.Instance.showAlert(u, null);
}
};
i([ C(cc.Node) ], t.prototype, "DropView", void 0);
i([ C(cc.Node) ], t.prototype, "StateDrop", void 0);
i([ C(cc.Node) ], t.prototype, "Location", void 0);
i([ C(cc.Node) ], t.prototype, "UnKYC", void 0);
i([ C(cc.Node) ], t.prototype, "Success", void 0);
i([ C(cc.Node) ], t.prototype, "Rejected", void 0);
i([ C(cc.Node) ], t.prototype, "Waitting", void 0);
i([ C(cc.Label) ], t.prototype, "StateTitle", void 0);
i([ C(cc.EditBox) ], t.prototype, "NameInput", void 0);
i([ C(l.default) ], t.prototype, "NumberInput", void 0);
i([ C(cc.EditBox) ], t.prototype, "DateInput", void 0);
i([ C(cc.Node) ], t.prototype, "FrontSelect", void 0);
i([ C(cc.Node) ], t.prototype, "BackSelect", void 0);
i([ C(r.default) ], t.prototype, "StateList", void 0);
return i([ v ], t);
}(cc.Component);
o.default = b;
cc._RF.pop();
}, {
"../../../Game/client/global/enum/game/Const": "Const",
"../../../Game/client/global/enum/game/Event": "Event",
"../../../Game/client/model/LanguageModel": "LanguageModel",
"../../../Game/fromework/global/Tools": "Tools",
"../../../Game/fromework/helper/EventHelper": "EventHelper",
"../../../Game/fromework/helper/UIHelper": "UIHelper",
"../../../Game/fromework/mvvm/modelView/ViewModel": "ViewModel",
"../../../fromework/component/listView/ListView": "ListView",
"../../component/NumericLabel": "NumericLabel",
"../../global/PopHelper": "PopHelper",
"../../model/WalletModel": "WalletModel",
"./WalletSelectImg": "WalletSelectImg"
} ],
WalletKYCMobile: [ function(e, t, o) {
"use strict";
cc._RF.push(t, "59da875VPBCMrWJfElyLWLP", "WalletKYCMobile");
var n, a = this && this.__extends || (n = function(e, t) {
return (n = Object.setPrototypeOf || {
__proto__: []
} instanceof Array && function(e, t) {
e.__proto__ = t;
} || function(e, t) {
for (var o in t) Object.prototype.hasOwnProperty.call(t, o) && (e[o] = t[o]);
})(e, t);
}, function(e, t) {
n(e, t);
function o() {
this.constructor = e;
}
e.prototype = null === t ? Object.create(t) : (o.prototype = t.prototype, new o());
}), i = this && this.__decorate || function(e, t, o, n) {
var a, i = arguments.length, r = i < 3 ? t : null === n ? n = Object.getOwnPropertyDescriptor(t, o) : n;
if ("object" == typeof Reflect && "function" == typeof Reflect.decorate) r = Reflect.decorate(e, t, o, n); else for (var l = e.length - 1; l >= 0; l--) (a = e[l]) && (r = (i < 3 ? a(r) : i > 3 ? a(t, o, r) : a(t, o)) || r);
return i > 3 && r && Object.defineProperty(t, o, r), r;
};
Object.defineProperty(o, "__esModule", {
value: !0
});
var r = e("../../component/NumericLabel"), l = e("../../component/pop/BindAlert"), s = e("../../../Game/client/model/LanguageModel"), c = e("../../model/PhoneModel"), u = e("../../model/WalletModel"), d = e("../../../Game/fromework/helper/EventHelper"), p = e("../../../Game/client/global/enum/game/Event"), h = e("../../../Game/client/global/enum/game/Game"), f = e("../../../Game/fromework/mvvm/modelView/ViewModel"), _ = e("../../../Game/fromework/global/Tools"), m = e("../../../Game/fromework/helper/UIHelper"), y = e("../../../Game/client/global/enum/game/Const"), g = e("../../global/PopHelper"), v = cc._decorator, C = v.ccclass, b = v.property, I = function(e) {
a(t, e);
function t() {
var t = null !== e && e.apply(this, arguments) || this;
t.MobileInput = null;
t.EmailInput = null;
t.Phone = null;
t.Email = null;
t.MobileConfirmButton = null;
t.MobileChangeButton = null;
t.MobileDoneIcon = null;
t.EmailConfirmButton = null;
t.EmailChangeButton = null;
t.EmailDoneIcon = null;
t._isVerifyMobile = !1;
t._isVerifyEmail = !1;
return t;
}
t.prototype.onEnable = function() {
d.default.Instance.Global.bind(p.WalletEvent.KYC_MOBILE_BIND_PHONE, this.onMobileBindPhone, this);
d.default.Instance.Global.bind(p.WalletEvent.KYC_MOBILE_BIND_EMAIL, this.onMobileBindEmail, this);
d.default.Instance.Global.bind(p.PhoneEvent.PHONE_CHECK_CODE, this.onCheckPhoneOTP, this);
};
t.prototype.onDisable = function() {
d.default.Instance.Global.unbind(p.WalletEvent.KYC_MOBILE_BIND_PHONE, this.onMobileBindPhone, this);
d.default.Instance.Global.unbind(p.WalletEvent.KYC_MOBILE_BIND_EMAIL, this.onMobileBindEmail, this);
d.default.Instance.Global.unbind(p.PhoneEvent.PHONE_CHECK_CODE, this.onCheckPhoneOTP, this);
};
t.prototype.onMobileBindPhone = function(e) {
var t = this;
if (e.getUserData()) {
this._isVerifyMobile = !0;
this.refreshMobile();
} else {
var o = {
title: s.default.getString("PROMPT_NOTICE"),
content: s.default.getString("KYC_OPT_FAILED"),
rightTitle: s.default.getString("COMMON_TRY_AGAIN"),
rightCallFunc: function() {
t._isVerifyMobile = !1;
t.refreshMobile();
}
};
g.PopHelper.Instance.showAlert(o, null);
}
};
t.prototype.onMobileBindEmail = function(e) {
var t = this;
if (e.getUserData()) {
this._isVerifyEmail = !0;
this.refreshEmail();
} else {
var o = {
title: s.default.getString("PROMPT_NOTICE"),
content: s.default.getString("KYC_OPT_FAILED"),
rightTitle: s.default.getString("COMMON_TRY_AGAIN"),
rightCallFunc: function() {
t._isVerifyEmail = !1;
t.refreshEmail();
}
};
g.PopHelper.Instance.showAlert(o, null);
}
};
t.prototype.onCheckPhoneOTP = function(e) {
var t = e.getUserData();
if (t.sms_type == h.GameEnum.VerificationType.SMS_TYPE_CHANGE_PHONE) if (t.result) {
this._isVerifyMobile = !1;
this.refreshMobile();
} else g.PopHelper.Instance.showTips(s.default.getString("KYC_OPT_FAILED"));
};
t.prototype.refreshView = function() {
var e = f.VM.getValue("wallet.userPhone"), t = f.VM.getValue("wallet.userEmail");
this._isVerifyMobile = 0 != e;
this._isVerifyEmail = "" != t;
this.refreshMobile();
this.refreshEmail();
};
t.prototype.refreshMobile = function() {
if (this._isVerifyMobile) {
this.MobileInput.node.active = !1;
this.Phone.node.active = !0;
this.MobileConfirmButton.active = !1;
this.MobileChangeButton.active = !0;
this.MobileDoneIcon.active = !0;
this.Phone.string = f.VM.getValue("wallet.userPhone");
} else {
this.MobileInput.node.active = !0;
this.Phone.node.active = !1;
this.MobileConfirmButton.active = !0;
this.MobileChangeButton.active = !1;
this.MobileDoneIcon.active = !1;
}
};
t.prototype.refreshEmail = function() {
if (this._isVerifyEmail) {
this.EmailInput.node.active = !1;
this.Email.node.active = !0;
this.EmailConfirmButton.active = !1;
this.EmailChangeButton.active = !0;
this.EmailDoneIcon.active = !0;
this.Email.string = f.VM.getValue("wallet.userEmail");
} else {
this.EmailInput.node.active = !0;
this.Email.node.active = !1;
this.EmailConfirmButton.active = !0;
this.EmailChangeButton.active = !1;
this.EmailDoneIcon.active = !1;
}
};
t.prototype.onMobileInputEnd = function() {
_.Tools.TStr.checkType(this.MobileInput.string, "indiaPhone") || g.PopHelper.Instance.showTips(s.default.getString("KYC_INPUT_TIP_1"));
};
t.prototype.onEmailInputEnd = function() {
_.Tools.TStr.checkType(this.EmailInput.string, "email") || g.PopHelper.Instance.showTips(s.default.getString("KYC_INPUT_TIP_3"));
};
t.prototype.onMobileConfirmClicked = function() {
var e = parseInt(this.MobileInput.string);
_.Tools.TStr.checkType(e, "indiaPhone") ? m.default.Instance.addBundleMaskLayer(y.BundleUIPath.BindAlert, function(t) {
t.getComponent(l.default).show(e, h.GameEnum.VerificationType.SMS_TYPE_BIND_PHONE, function(t) {
null != t ? u.WalletProxy.Instance.sendBindPhone(e, 91, t) : g.PopHelper.Instance.showTips(s.default.getString("KYC_INPUT_TIP_2"));
});
}) : g.PopHelper.Instance.showTips(s.default.getString("KYC_INPUT_TIP_1"));
};
t.prototype.onMobileChangeClicked = function() {
var e = f.VM.getValue("wallet.userPhone");
null != e ? m.default.Instance.addBundleMaskLayer(y.BundleUIPath.BindAlert, function(t) {
t.getComponent(l.default).show(e, h.GameEnum.VerificationType.SMS_TYPE_CHANGE_PHONE, function(t) {
null != t ? c.PhoneProxy.Instance.sendCheckVerificationCode(h.GameEnum.VerificationType.SMS_TYPE_CHANGE_PHONE, e, t) : g.PopHelper.Instance.showTips(s.default.getString("KYC_OPT_FAILED"));
});
}) : g.PopHelper.Instance.showTips(s.default.getString("KYC_OPT_FAILED"));
};
t.prototype.onEmailComfirmClicked = function() {
_.Tools.TStr.checkType(this.EmailInput.string, "email") ? u.WalletProxy.Instance.sendBindEmail(this.EmailInput.string) : g.PopHelper.Instance.showTips(s.default.getString("KYC_INPUT_TIP_3"));
};
t.prototype.onEmailChangeClicked = function() {
this._isVerifyEmail = !1;
this.refreshEmail();
};
i([ b(r.default) ], t.prototype, "MobileInput", void 0);
i([ b(cc.EditBox) ], t.prototype, "EmailInput", void 0);
i([ b(cc.Label) ], t.prototype, "Phone", void 0);
i([ b(cc.Label) ], t.prototype, "Email", void 0);
i([ b(cc.Node) ], t.prototype, "MobileConfirmButton", void 0);
i([ b(cc.Node) ], t.prototype, "MobileChangeButton", void 0);
i([ b(cc.Node) ], t.prototype, "MobileDoneIcon", void 0);
i([ b(cc.Node) ], t.prototype, "EmailConfirmButton", void 0);
i([ b(cc.Node) ], t.prototype, "EmailChangeButton", void 0);
i([ b(cc.Node) ], t.prototype, "EmailDoneIcon", void 0);
return i([ C ], t);
}(cc.Component);
o.default = I;
cc._RF.pop();
}, {
"../../../Game/client/global/enum/game/Const": "Const",
"../../../Game/client/global/enum/game/Event": "Event",
"../../../Game/client/global/enum/game/Game": "Game",
"../../../Game/client/model/LanguageModel": "LanguageModel",
"../../../Game/fromework/global/Tools": "Tools",
"../../../Game/fromework/helper/EventHelper": "EventHelper",
"../../../Game/fromework/helper/UIHelper": "UIHelper",
"../../../Game/fromework/mvvm/modelView/ViewModel": "ViewModel",
"../../component/NumericLabel": "NumericLabel",
"../../component/pop/BindAlert": "BindAlert",
"../../global/PopHelper": "PopHelper",
"../../model/PhoneModel": "PhoneModel",
"../../model/WalletModel": "WalletModel"
} ],
WalletKYCStateItem: [ function(e, t, o) {
"use strict";
cc._RF.push(t, "112fexY8MpMB5ce/qy03rDJ", "WalletKYCStateItem");
var n, a = this && this.__extends || (n = function(e, t) {
return (n = Object.setPrototypeOf || {
__proto__: []
} instanceof Array && function(e, t) {
e.__proto__ = t;
} || function(e, t) {
for (var o in t) Object.prototype.hasOwnProperty.call(t, o) && (e[o] = t[o]);
})(e, t);
}, function(e, t) {
n(e, t);
function o() {
this.constructor = e;
}
e.prototype = null === t ? Object.create(t) : (o.prototype = t.prototype, new o());
}), i = this && this.__decorate || function(e, t, o, n) {
var a, i = arguments.length, r = i < 3 ? t : null === n ? n = Object.getOwnPropertyDescriptor(t, o) : n;
if ("object" == typeof Reflect && "function" == typeof Reflect.decorate) r = Reflect.decorate(e, t, o, n); else for (var l = e.length - 1; l >= 0; l--) (a = e[l]) && (r = (i < 3 ? a(r) : i > 3 ? a(t, o, r) : a(t, o)) || r);
return i > 3 && r && Object.defineProperty(t, o, r), r;
};
Object.defineProperty(o, "__esModule", {
value: !0
});
var r = e("../../../Game/client/global/enum/game/Event"), l = e("../../../Game/fromework/helper/EventHelper"), s = cc._decorator, c = s.ccclass, u = s.property, d = function(e) {
a(t, e);
function t() {
var t = null !== e && e.apply(this, arguments) || this;
t.Title = null;
t.ClickButton = null;
t._data = null;
return t;
}
t.prototype.onItemInitCallFunc = function(e) {
this._data = e;
this.Title.string = this._data;
};
t.prototype.onItemEnterCallFunc = function() {
this.node.opacity = 255;
this.ClickButton.interactable = !0;
};
t.prototype.onItemExitCallFunc = function() {
this.node.opacity = 0;
this.ClickButton.interactable = !1;
};
t.prototype.onCellClicked = function() {
l.default.Instance.Global.emit(r.WalletEvent.STATE_DROP_SELECT, this._data);
};
i([ u(cc.Label) ], t.prototype, "Title", void 0);
i([ u(cc.Button) ], t.prototype, "ClickButton", void 0);
return i([ c ], t);
}(cc.Component);
o.default = d;
cc._RF.pop();
}, {
"../../../Game/client/global/enum/game/Event": "Event",
"../../../Game/fromework/helper/EventHelper": "EventHelper"
} ],
WalletKYC: [ function(e, t, o) {
"use strict";
cc._RF.push(t, "0a6bboghhFN36NVNOug4Q01", "WalletKYC");
var n, a = this && this.__extends || (n = function(e, t) {
return (n = Object.setPrototypeOf || {
__proto__: []
} instanceof Array && function(e, t) {
e.__proto__ = t;
} || function(e, t) {
for (var o in t) Object.prototype.hasOwnProperty.call(t, o) && (e[o] = t[o]);
})(e, t);
}, function(e, t) {
n(e, t);
function o() {
this.constructor = e;
}
e.prototype = null === t ? Object.create(t) : (o.prototype = t.prototype, new o());
}), i = this && this.__decorate || function(e, t, o, n) {
var a, i = arguments.length, r = i < 3 ? t : null === n ? n = Object.getOwnPropertyDescriptor(t, o) : n;
if ("object" == typeof Reflect && "function" == typeof Reflect.decorate) r = Reflect.decorate(e, t, o, n); else for (var l = e.length - 1; l >= 0; l--) (a = e[l]) && (r = (i < 3 ? a(r) : i > 3 ? a(t, o, r) : a(t, o)) || r);
return i > 3 && r && Object.defineProperty(t, o, r), r;
};
Object.defineProperty(o, "__esModule", {
value: !0
});
var r = e("../../../Game/client/global/enum/game/Event"), l = e("../../../Game/fromework/helper/EventHelper"), s = e("../../../Game/fromework/helper/UIHelper"), c = e("../../model/WalletModel"), u = e("./WalletHelper"), d = e("./WalletKYCDocument"), p = e("./WalletKYCMobile"), h = cc._decorator, f = h.ccclass, _ = h.property, m = function(e) {
a(t, e);
function t() {
var t = null !== e && e.apply(this, arguments) || this;
t.Toggle_Document = null;
t.Toggle_Mobile = null;
t.Document = null;
t.Mobile = null;
return t;
}
t.prototype.onEnable = function() {
l.default.Instance.Global.bind(r.WalletEvent.KYC_SELECT_TOGGLE, this.selectToggle, this);
l.default.Instance.Global.bind(r.WalletEvent.RECENT_CHECK_PHONE_MAIL, this.checkPhoneMail, this);
l.default.Instance.Global.bind(r.WalletEvent.RECENT_KYC_QUERY, this.checkKYC, this);
};
t.prototype.onDisable = function() {
l.default.Instance.Global.unbind(r.WalletEvent.KYC_SELECT_TOGGLE, this.selectToggle, this);
l.default.Instance.Global.unbind(r.WalletEvent.RECENT_CHECK_PHONE_MAIL, this.checkPhoneMail, this);
l.default.Instance.Global.bind(r.WalletEvent.RECENT_KYC_QUERY, this.checkKYC, this);
};
t.prototype.checkKYC = function() {
this.refreshDocument();
};
t.prototype.checkPhoneMail = function() {
this.refreshMobile();
};
t.prototype.selectToggle = function(e) {
var t = e.getUserData();
0 == t && this.onToggleMobClicked();
1 == t && this.onToggleDocClicked();
};
t.prototype.InitView = function() {
c.WalletProxy.Instance.sendPhoneMailState();
this.onToggleMobClicked();
};
t.prototype.refreshDocument = function() {
this.Document.getComponent(d.default).refreshView();
};
t.prototype.refreshMobile = function() {
this.Mobile.getComponent(p.default).refreshView();
};
t.prototype.onToggleDocClicked = function() {
this.Document.active = !0;
this.Mobile.active = !1;
c.WalletProxy.Instance.sendGetKycResult();
};
t.prototype.onToggleMobClicked = function() {
this.Document.active = !1;
this.Mobile.active = !0;
this.refreshMobile();
};
t.prototype.onServiceClicked = function() {
u.default.Instance.openSerciveView();
};
t.prototype.onCloseClicked = function() {
s.default.Instance.removeLayer(this.node);
};
i([ _(cc.Node) ], t.prototype, "Toggle_Document", void 0);
i([ _(cc.Node) ], t.prototype, "Toggle_Mobile", void 0);
i([ _(cc.Node) ], t.prototype, "Document", void 0);
i([ _(cc.Node) ], t.prototype, "Mobile", void 0);
return i([ f ], t);
}(cc.Component);
o.default = m;
cc._RF.pop();
}, {
"../../../Game/client/global/enum/game/Event": "Event",
"../../../Game/fromework/helper/EventHelper": "EventHelper",
"../../../Game/fromework/helper/UIHelper": "UIHelper",
"../../model/WalletModel": "WalletModel",
"./WalletHelper": "WalletHelper",
"./WalletKYCDocument": "WalletKYCDocument",
"./WalletKYCMobile": "WalletKYCMobile"
} ],
WalletMain: [ function(e, t, o) {
"use strict";
cc._RF.push(t, "34ba15hBc5PjZrZUtPwqsiQ", "WalletMain");
var n, a = this && this.__extends || (n = function(e, t) {
return (n = Object.setPrototypeOf || {
__proto__: []
} instanceof Array && function(e, t) {
e.__proto__ = t;
} || function(e, t) {
for (var o in t) Object.prototype.hasOwnProperty.call(t, o) && (e[o] = t[o]);
})(e, t);
}, function(e, t) {
n(e, t);
function o() {
this.constructor = e;
}
e.prototype = null === t ? Object.create(t) : (o.prototype = t.prototype, new o());
}), i = this && this.__decorate || function(e, t, o, n) {
var a, i = arguments.length, r = i < 3 ? t : null === n ? n = Object.getOwnPropertyDescriptor(t, o) : n;
if ("object" == typeof Reflect && "function" == typeof Reflect.decorate) r = Reflect.decorate(e, t, o, n); else for (var l = e.length - 1; l >= 0; l--) (a = e[l]) && (r = (i < 3 ? a(r) : i > 3 ? a(t, o, r) : a(t, o)) || r);
return i > 3 && r && Object.defineProperty(t, o, r), r;
};
Object.defineProperty(o, "__esModule", {
value: !0
});
var r = e("../../../Game/client/global/enum/game/Const"), l = e("../../../Game/client/model/LanguageModel"), s = e("../../../Game/fromework/helper/UIHelper"), c = e("../../model/RedDotModel"), u = e("../../model/WalletModel"), d = e("../ui/Recent/RecentView"), p = e("./WalletKYC"), h = e("./WalletWithdraw"), f = cc._decorator, _ = f.ccclass, m = f.property, y = function(e) {
a(t, e);
function t() {
var t = null !== e && e.apply(this, arguments) || this;
t.TipView = null;
t.TipLabel = null;
return t;
}
t.prototype.InitView = function() {
u.WalletProxy.Instance.sendGetUserWallet();
u.WalletProxy.Instance.sendGetKycResult();
u.WalletProxy.Instance.sendPhoneMailState();
};
t.prototype.showTipView = function(e, t) {
var o = e.parent.convertToWorldSpaceAR(e.getPosition()), n = this.TipView.convertToNodeSpaceAR(o);
this.TipLabel.node.parent.setPosition(n.x, n.y - 50);
this.TipLabel.string = t;
this.TipView.active = !0;
};
t.prototype.onDepositedTipsClicked = function(e) {
this.showTipView(e.target, l.default.getString("WALLET_BALANCE_DEPOSITED"));
};
t.prototype.onWinningTipsClicked = function(e) {
this.showTipView(e.target, l.default.getString("WALLET_BALANCE_WIN"));
};
t.prototype.onBonusTipsClicked = function(e) {
this.showTipView(e.target, l.default.getString("WALLET_BALANCE_BONUS"));
};
t.prototype.onClickHideTipView = function() {
this.TipView.active = !1;
};
t.prototype.onAddCashClicked = function() {
s.default.Instance.addBundleLayer(r.BundleUIPath.WalletRecharge, function(e) {
e.getComponent("WalletRecharge").InitView();
});
};
t.prototype.onWithdrawClicked = function() {
var e = this;
u.WalletProxy.Instance.sendGetKycResult(function() {
1 == u.WalletProxy.Instance.KYCState ? s.default.Instance.addBundleLayer(r.BundleUIPath.WalletWithdraw, function(e) {
e.getComponent(h.default).InitView();
}) : e.onKYCClicked();
});
};
t.prototype.onRecentClicked = function() {
s.default.Instance.addBundleLayer(r.BundleUIPath.RecentView, function(e) {
e.getComponent(d.default).InitView();
});
};
t.prototype.onKYCClicked = function() {
c.RedDotProxy.Instance.sendReadRedDot("kyc_status");
s.default.Instance.addBundleLayer(r.BundleUIPath.WalletKYC, function(e) {
e.getComponent(p.default).InitView();
});
};
t.prototype.onCloseClicked = function() {
s.default.Instance.changeLayer(r.BundleUIPath.LobbyView);
};
i([ m(cc.Node) ], t.prototype, "TipView", void 0);
i([ m(cc.Label) ], t.prototype, "TipLabel", void 0);
return i([ _ ], t);
}(cc.Component);
o.default = y;
cc._RF.pop();
}, {
"../../../Game/client/global/enum/game/Const": "Const",
"../../../Game/client/model/LanguageModel": "LanguageModel",
"../../../Game/fromework/helper/UIHelper": "UIHelper",
"../../model/RedDotModel": "RedDotModel",
"../../model/WalletModel": "WalletModel",
"../ui/Recent/RecentView": "RecentView",
"./WalletKYC": "WalletKYC",
"./WalletWithdraw": "WalletWithdraw"
} ],
WalletModel: [ function(e, t, o) {
"use strict";
cc._RF.push(t, "5ce35ffuPFFGoc/wXos51Ut", "WalletModel");
Object.defineProperty(o, "__esModule", {
value: !0
});
o.WalletProxy = o.walletData = void 0;
var n = e("./PhoneModel"), a = e("./RedDotModel"), i = e("./RecentModel"), r = e("../../Game/fromework/mvvm/modelView/ViewModel"), l = e("../../Game/client/model/CommonModel"), s = e("../../Game/client/global/enum/game/Const"), c = e("../../Game/fromework/helper/EventHelper"), u = e("../../Game/client/global/enum/net/S2C"), d = e("../../Game/client/global/enum/game/Game"), p = e("../../Game/fromework/global/Tools"), h = e("../../Game/client/global/enum/game/Event"), f = e("../../Game/client/model/LanguageModel"), _ = e("../../Game/fromework/net/NetHttp"), m = e("../../Game/Script/global/GlobalValue"), y = e("../../Game/client/global/enum/net/C2S"), g = e("../../fromework/helper/NetHelper"), v = e("../../Game/client/logic/game/GameHelper"), C = e("../global/PopHelper"), b = e("../../platform/Platform"), I = e("../../Game/fromework/helper/UIHelper"), E = e("../global/Global");
o.walletData = new function() {
this.userPhone = 0;
this.userEmail = "";
this.total = 0;
this.cash = 0;
this.practice = 0;
this.withdraw = 0;
this.bonus = 0;
this.bonusBalance = 0;
this.gold = 0;
this.totalRecharge = 0;
this.withdrawFinger = 0;
this.totalWithdraw = 0;
this.remainingWithAmt = 0;
this.totalFlow = 0;
}();
r.VM.add(o.walletData, "wallet");
var S = function() {
function e() {
this._KYCState = -1;
this._activityList = [];
this._minRecharge = s.MinSingleRecharge;
this._maxRecharge = s.MaxSingleRecharge;
this._bankData = null;
this._withdrawLimitData = null;
this._noticeList = [];
this._bonusRecordList = [];
this._withdrawAmout = 0;
this._rechargeGoods = new Map();
this._rechargeUserInfo = new l.Common.RechargeUserInfo();
this._rechargeGear = s.RechargeGear.concat();
this._unclaimedBonus = 0;
this._BonusReturnRate = 1;
this._firstRechargeInfo = null;
this.bonusinfo = null;
}
Object.defineProperty(e, "Instance", {
get: function() {
e._instance || (e._instance = new e());
return e._instance;
},
enumerable: !1,
configurable: !0
});
Object.defineProperty(e.prototype, "KYCState", {
get: function() {
return this._KYCState;
},
enumerable: !1,
configurable: !0
});
Object.defineProperty(e.prototype, "activityList", {
get: function() {
return this._activityList;
},
enumerable: !1,
configurable: !0
});
Object.defineProperty(e.prototype, "minRecharge", {
get: function() {
return this._minRecharge;
},
enumerable: !1,
configurable: !0
});
Object.defineProperty(e.prototype, "maxRecharge", {
get: function() {
return this._maxRecharge;
},
enumerable: !1,
configurable: !0
});
Object.defineProperty(e.prototype, "bankData", {
get: function() {
return this._bankData;
},
enumerable: !1,
configurable: !0
});
Object.defineProperty(e.prototype, "withdrawLimitData", {
get: function() {
return this._withdrawLimitData;
},
enumerable: !1,
configurable: !0
});
Object.defineProperty(e.prototype, "noticeList", {
get: function() {
return this._noticeList;
},
enumerable: !1,
configurable: !0
});
Object.defineProperty(e.prototype, "bonusRecordList", {
get: function() {
return this._bonusRecordList;
},
enumerable: !1,
configurable: !0
});
Object.defineProperty(e.prototype, "rechargeGoods", {
get: function() {
return this._rechargeGoods;
},
enumerable: !1,
configurable: !0
});
Object.defineProperty(e.prototype, "rechargeUserInfo", {
get: function() {
return this._rechargeUserInfo;
},
enumerable: !1,
configurable: !0
});
Object.defineProperty(e.prototype, "rechargeGear", {
get: function() {
return this._rechargeGear;
},
enumerable: !1,
configurable: !0
});
Object.defineProperty(e.prototype, "unclaimedBonus", {
get: function() {
return this._unclaimedBonus;
},
enumerable: !1,
configurable: !0
});
Object.defineProperty(e.prototype, "BonusReturnRate", {
get: function() {
return this._BonusReturnRate;
},
enumerable: !1,
configurable: !0
});
Object.defineProperty(e.prototype, "firstRechargeInfo", {
get: function() {
return this._firstRechargeInfo;
},
enumerable: !1,
configurable: !0
});
e.prototype.Init = function() {
c.default.Instance.Net.bind(u.S2C.WALLET.WALLET_CHECK_PHONE, this.onCheckPhone, this);
c.default.Instance.Net.bind(u.S2C.WALLET.WALLET_BIND_CODE, this.onBindCode, this);
c.default.Instance.Net.bind(u.S2C.WALLET.WALLET_BIND_PHONE, this.onBindPhone, this);
c.default.Instance.Net.bind(u.S2C.WALLET.WALLET_BIND_EMAIL, this.onBindEmail, this);
c.default.Instance.Net.bind(u.S2C.WALLET.WALLET_GET_USER_WALLET, this.onGetUserWallet, this);
c.default.Instance.Net.bind(u.S2C.GAME.ROOM_SEND_AVAILABLE_BALANCE, this._onBalanceRefresh, this);
c.default.Instance.Net.bind(u.S2C.RECHARGE.RECHARGE_READY, this.onGetUserRechargeInfoWS, this);
};
e.prototype.clear = function() {
this._KYCState = -1;
this._activityList.splice(0);
this._activityList = [];
this._bankData = null;
this._withdrawLimitData = null;
this._noticeList.splice(0);
this._noticeList = [];
this._bonusRecordList.splice(0);
this._bonusRecordList = [];
};
e.prototype.startRechargeAmtTime = function(e) {
var t = this;
void 0 === e && (e = 30);
v.Countdown.creat(e, function() {
t.UserRechargeInfo();
}, null, this);
};
e.prototype.getRechargeAmountRate = function(e, t) {
var o = this._rechargeGoods.get(e), n = 0, a = 0, i = 0;
null != o && o.forEach(function(e) {
if (e.amount.toString() == t.toString()) {
n = e.deposit;
a = e.bonus;
i = e.gift_rate;
}
});
return {
deposit: n,
bonus: a,
rate: i
};
};
e.prototype.getRechargeGoods = function(e) {
return this._rechargeGoods.has(e) ? this._rechargeGoods.get(e) : null;
};
e.prototype.getRechargeActiveByType = function(e) {
for (var t = this.activityList.concat(), o = [], n = 0; n < t.length; n++) t[n].type == e && o.push(t[n]);
return o;
};
e.prototype.checkMoney = function(e, t) {
return e == d.GameEnum.MoneyType.CASH ? r.VM.getValue("wallet.total") >= t : e == d.GameEnum.MoneyType.GOLD ? r.VM.getValue("wallet.gold") >= t : void 0;
};
e.prototype.getNoticeDatas = function(e) {
var t = [];
this.noticeList.forEach(function(o) {
o && o.pic_type == e && t.push(o);
});
return t;
};
e.prototype.refreshWallet = function(e) {
if (e.user_wallet) {
null != e.user_wallet[d.GameEnum.MoneyType.CASH] && r.VM.setValue("wallet.cash", p.Tools.TNumber.num2single(e.user_wallet[d.GameEnum.MoneyType.CASH]));
null != e.user_wallet[d.GameEnum.MoneyType.PRACTICE] && r.VM.setValue("wallet.practice", p.Tools.TNumber.num2single(e.user_wallet[d.GameEnum.MoneyType.PRACTICE]));
null != e.user_wallet[d.GameEnum.MoneyType.WITHDRAW] && r.VM.setValue("wallet.withdraw", p.Tools.TNumber.num2single(e.user_wallet[d.GameEnum.MoneyType.WITHDRAW]));
null != e.user_wallet[d.GameEnum.MoneyType.GOLD] && r.VM.setValue("wallet.gold", p.Tools.TNumber.num2single(e.user_wallet[d.GameEnum.MoneyType.GOLD]));
null != e.user_wallet[d.GameEnum.MoneyType.BONUS] && r.VM.setValue("wallet.bonus", p.Tools.TNumber.num2single(e.user_wallet[d.GameEnum.MoneyType.BONUS]));
if (null != e.user_wallet[d.GameEnum.MoneyType.UNCLAIMEDBONUS]) {
this._unclaimedBonus = p.Tools.TNumber.num2single(e.user_wallet[d.GameEnum.MoneyType.UNCLAIMEDBONUS]);
c.default.Instance.Global.emit(h.WalletEvent.BONUS_GET_UNREWARD, this._unclaimedBonus);
}
null != e.user_wallet[d.GameEnum.MoneyType.TOTAL_CASH] && r.VM.setValue("wallet.totalRecharge", p.Tools.TNumber.num2single(e.user_wallet[d.GameEnum.MoneyType.TOTAL_CASH]));
null != e.user_wallet[d.GameEnum.MoneyType.TOTAL_WITHDRAW] && r.VM.setValue("wallet.totalWithdraw", p.Tools.TNumber.num2single(e.user_wallet[d.GameEnum.MoneyType.TOTAL_WITHDRAW]));
null != e.user_wallet[d.GameEnum.MoneyType.remainingWithAmt] && r.VM.setValue("wallet.remainingWithAmt", p.Tools.TNumber.num2single(e.user_wallet[d.GameEnum.MoneyType.remainingWithAmt]));
null != e.user_wallet[d.GameEnum.MoneyType.totalFlow] && r.VM.setValue("wallet.totalFlow", p.Tools.TNumber.num2single(e.user_wallet[d.GameEnum.MoneyType.totalFlow]).toFixed(2));
}
r.VM.setValue("wallet.total", p.Tools.TNumber.num2single(e.total_fee));
};
e.prototype.onUserApply = function(e) {
var t = JSON.parse(e.response);
1 == t.code && C.PopHelper.Instance.showTips(f.default.getString("SUCCESS_APPROVAL"));
var o = !1;
1001 == t.code && (o = !0);
1002 == t.code && (o = !0);
1003 == t.code && (o = !0);
1004 == t.code && (o = !0);
o && C.PopHelper.Instance.showTips(f.default.getString("SUBMIT_FAIL"));
t.data && t.data.header_url && "" != t.data.header_url && r.VM.setValue("user.headUrl", t.data.header_url);
};
e.prototype.onKycApply = function(e) {
var t = JSON.parse(e.response);
b.default.log("[WalletModel]onKycApply: " + t.code);
1 == t.code && (this._KYCState = 1006);
c.default.Instance.Global.emit(h.WalletEvent.KYC_APPLY_BACK, t.code);
};
e.prototype.onActivityList = function(e) {
var t = this, o = JSON.parse(e.response);
this._activityList.splice(0);
if (o.data) {
var n = 0;
o.data.forEach(function(e) {
var o = new l.Common.ActivityData(e), i = d.GameEnum.RedDotKey.RechargeActivity + o.id;
t._activityList.push(o);
var r = a.default.Instance.checkRedDotTime(i, o.red_dot_type);
r && n++;
c.default.Instance.Global.emit(h.RedDotEvent.REFRESH_RED_DOT_DATA, {
key: i,
value: r ? 1 : 0
});
});
c.default.Instance.Global.emit(h.RedDotEvent.REFRESH_RED_DOT_DATA, {
key: d.GameEnum.RedDotKey.RechargeActivity,
value: n
});
a.default.Instance.refreshRecharge(this._activityList);
}
if (o.amount) {
this._minRecharge = o.amount.min;
this._maxRecharge = o.amount.max;
}
c.default.Instance.Global.emit(h.WalletEvent.RECHARGE_ACT_REFRESH);
};
e.prototype.onGiftCalculator = function(e) {
var t = JSON.parse(e.response);
c.default.Instance.Global.emit(h.WalletEvent.RECHARGE_GET_CALCULATOR, t);
};
e.prototype.onSetBackAccount = function(e) {
var t = JSON.parse(e.response);
if (1 == t.code) {
this._bankData ? this._bankData.refresh(t.data) : this._bankData = new l.Common.BankData(t.data);
this.sendPhoneMailState();
}
c.default.Instance.Global.emit(h.WalletEvent.WITHDRAW_SET_BANK, t.code);
};
e.prototype.onCheckBankAccount = function(e) {
var t = JSON.parse(e.response);
1 == t.code && (this._bankData ? this._bankData.refresh(t.data) : this._bankData = new l.Common.BankData(t.data));
null != t.with_limit && (this._withdrawLimitData ? this._withdrawLimitData.refresh(t.with_limit) : this._withdrawLimitData = new l.Common.WithdrawLimitData(t.with_limit));
c.default.Instance.Global.emit(h.WalletEvent.WITHDRAW_CHECK_BANK, t.code);
};
e.prototype.onWithdraw = function(e) {
var t = JSON.parse(e.response);
1 == t.code && (this._withdrawAmout = 0);
c.default.Instance.Global.emit(h.WalletEvent.WITHDRAW_APPLY, t);
};
e.prototype.onWithdrawCancel = function(e) {
var t = JSON.parse(e.response);
if (1028 == t.code || 1 == t.code) {
var o = i.RecentProxy.Instance.getRecentByID(t.data.wallet_sn);
null != o && 0 != o.length && o.forEach(function(e) {
e.status_new = t.data.status_new;
e.fail_message = t.data.fail_message;
});
}
c.default.Instance.Global.emit(h.WalletEvent.WITHDRAW_CANCEL, t);
};
e.prototype.onPaymentType = function(e) {
var t = JSON.parse(e.response);
c.default.Instance.Global.emit(h.WalletEvent.WALLET_PAYMENT_TYPE, t);
};
e.prototype.onPayment = function(e) {
var t = JSON.parse(e.response);
c.default.Instance.Global.emit(h.WalletEvent.WALLET_PAYMENT, t);
};
e.prototype.onNoticeList = function(e) {
var t = this, o = JSON.parse(e.response);
if (o) {
this._noticeList.splice(0);
o.forEach(function(e) {
var o = new l.Common.NoticeData(e);
t._noticeList.push(o);
});
a.default.Instance.refreshNotice(this._noticeList);
this._noticeList.sort(function(e, t) {
return t.active_order - e.active_order;
});
}
c.default.Instance.Global.emit(h.WalletEvent.REFRESH_NOTICE_REFRESH);
};
e.prototype.onBonusRecord = function(e) {
var t = this, o = JSON.parse(e.response);
if (1 == o.code) {
this._bonusRecordList.splice(0);
o.data.forEach(function(e) {
var o = new l.Common.BonusRecordData(e);
t._bonusRecordList.push(o);
});
}
c.default.Instance.Global.emit(h.WalletEvent.REFRESH_BONUS_RECORD);
};
e.prototype.onBonusAllAmount = function(e) {
var t = JSON.parse(e.response);
1 == t.code && r.VM.setValue("wallet.bonusBalance", t.data.bonus_balance_all);
};
e.prototype.RechargeManage = function(e) {
var t = r.VM.getValue("user.uid");
if (null != e) {
var o = parseInt(e.recharge_amt);
if (!isNaN(o) && 0 != o) {
if (e.first_charge && 1 == e.first_charge) {
b.default.sendFirstPurchaseEvent(o, "INR");
b.default.logPurchase(o);
}
b.default.sendPurchaseEvent(o, "INR");
b.default.logEarnVirtualCurrency(o);
if (o <= s.RechargeLittle) {
b.default.logEvent("RechargeLittle", JSON.stringify({
amount: o
}));
b.default.sendEvent("RechargeLittle", JSON.stringify({
amount: o
}));
} else if (o > s.RechargeLittle && o <= s.RechargeMiddle) {
b.default.logEvent("RechargeMiddle", JSON.stringify({
amount: o
}));
b.default.sendEvent("RechargeMiddle", JSON.stringify({
amount: o
}));
} else if (o > s.RechargeMiddle) {
b.default.logEvent("RechargeLarge", JSON.stringify({
amount: o
}));
b.default.sendEvent("RechargeLarge", JSON.stringify({
amount: o
}));
}
cc.sys.localStorage.setItem("isRecharge" + t, JSON.stringify(!0));
}
}
};
e.prototype.onGetUserRechargeInfoWS = function(e) {
b.default.log("[WalletModel onGetUserRechargeInfoWS]response");
var t = e.getUserData();
this.RechargeManage(t);
};
e.prototype.onGetUserRechargeInfoHttp = function(e) {
b.default.log("[WalletModel onGetUserRechargeInfoHttp]response:" + e.response);
var t = JSON.parse(e.response);
this.RechargeManage(t);
};
e.prototype.onGetRechargeGoods = function(e) {
var t = this, o = JSON.parse(e.response);
if (1 == o.code) {
if (0 != o.gift_id) {
this._rechargeGoods.set(parseInt(o.gift_id), o.data);
c.default.Instance.Global.emit(h.WalletEvent.RECHARGE_GET_GOODS);
} else {
this._rechargeGear.splice(0);
o.data.forEach(function(e) {
t._rechargeGear.push(parseInt(e.amount));
});
c.default.Instance.Global.emit(h.WalletEvent.RECHARGE_ACT_REFRESH);
}
this._firstRechargeInfo = null;
o.firstRechargeInfo && null != o.firstRechargeInfo && (this._firstRechargeInfo = o.firstRechargeInfo);
}
};
e.prototype.onGetRechargeUserInfo = function(e) {
var t = JSON.parse(e.response);
if (1 == t.code) {
this._rechargeUserInfo.refresh(t.data);
if ("" != this._rechargeUserInfo.tel_phone) {
var o = parseInt(this._rechargeUserInfo.tel_phone);
isNaN(o) || (n.PhoneProxy.Instance.defaultPhone = o + "");
}
}
c.default.Instance.Global.emit(h.WalletEvent.RECHARGE_GET_USERINFO);
};
e.prototype.onCheckPhone = function(e) {
var t = e.getUserData(), o = parseInt(t.pn);
isNaN(o) && (o = 0);
r.VM.setValue("wallet.userPhone", o);
r.VM.setValue("wallet.userEmail", t.e);
0 != o && (n.PhoneProxy.Instance.defaultPhone = o + "");
c.default.Instance.Global.emit(h.WalletEvent.RECENT_CHECK_PHONE_MAIL);
};
e.prototype.onBindCode = function(e) {
var t = e.getUserData();
c.default.Instance.Global.emit(h.WalletEvent.KYC_MOBILE_BIND_CODE, t.r);
};
e.prototype.onBindPhone = function(e) {
var t = e.getUserData();
if (t.r) {
r.VM.setValue("wallet.userPhone", parseInt(t.pn));
0 != t.pn && (n.PhoneProxy.Instance.defaultPhone = t.pn);
}
c.default.Instance.Global.emit(h.WalletEvent.KYC_MOBILE_BIND_PHONE, t.r);
};
e.prototype.onBindEmail = function(e) {
var t = e.getUserData();
t.r && r.VM.setValue("wallet.userEmail", t.e);
c.default.Instance.Global.emit(h.WalletEvent.KYC_MOBILE_BIND_EMAIL, t.r);
};
e.prototype.onGetUserWallet = function(e) {
var t = e.getUserData();
b.default.log("get_user_wallet", t);
r.VM.setValue("wallet.cash", t[d.GameEnum.MoneyType.CASH]);
r.VM.setValue("wallet.practice", t[d.GameEnum.MoneyType.PRACTICE]);
r.VM.setValue("wallet.withdraw", t[d.GameEnum.MoneyType.WITHDRAW]);
r.VM.setValue("wallet.bonus", t[d.GameEnum.MoneyType.BONUS]);
var o = t[d.GameEnum.MoneyType.CASH] + t[d.GameEnum.MoneyType.WITHDRAW];
r.VM.setValue("wallet.total", p.Tools.TNumber.numFixed(o, 2));
r.VM.setValue("wallet.gold", parseFloat(t[d.GameEnum.MoneyType.GOLD]));
r.VM.setValue("wallet.totalRecharge", parseFloat(t[d.GameEnum.MoneyType.TOTAL_CASH]));
r.VM.setValue("wallet.totalWithdraw", parseFloat(t[d.GameEnum.MoneyType.TOTAL_WITHDRAW]));
null != t[d.GameEnum.MoneyType.remainingWithAmt] && r.VM.setValue("wallet.remainingWithAmt", parseFloat(t[d.GameEnum.MoneyType.remainingWithAmt]));
null != t[d.GameEnum.MoneyType.totalFlow] && r.VM.setValue("wallet.totalFlow", parseFloat(t[d.GameEnum.MoneyType.totalFlow]).toFixed(2));
var n = !(0 !== t[d.GameEnum.MoneyType.TOTAL_WITHDRAW] || !t.canWithdraw || JSON.parse(cc.sys.localStorage.getItem("bankState")));
r.VM.setValue("wallet.withdrawFinger", n);
c.default.Instance.Global.emit("withdrawFinger", n);
this._unclaimedBonus = t[d.GameEnum.MoneyType.UNCLAIMEDBONUS];
c.default.Instance.Global.emit(h.WalletEvent.BONUS_GET_UNREWARD, this._unclaimedBonus);
c.default.Instance.Global.emit(h.WalletEvent.WALLET_USER_GET_WALLET);
};
e.prototype._onBalanceRefresh = function(t) {
var o = t.getUserData();
e.Instance.refreshWallet(o);
0 == o.rid && c.default.Instance.Global.emit(h.GameEvent.S2C_SEND_AVAILABLE_BALANCE);
};
e.prototype.sendUserApply = function(e, t) {
e || (e = "");
t || (t = "");
var o = {
player_index: r.VM.getValue("user.uid"),
token: r.VM.getValue("user.token"),
name: e,
head_pic: t
};
_.default.Instance.post(m.default.getInstance().WalletUrl + "apply", o, this.onUserApply.bind(this), !0);
};
e.prototype.sendGetKycResult = function(e) {
var t = this;
_.default.Instance.get(m.default.getInstance().WalletUrl + "kycRes", {
player_index: r.VM.getValue("user.uid"),
token: r.VM.getValue("user.token")
}, function(o) {
var n = JSON.parse(o.response);
t._KYCState = n.code;
e ? e() : c.default.Instance.Global.emit(h.WalletEvent.RECENT_KYC_QUERY);
}, !0);
};
e.prototype.sendKycApply = function(e, t, o, n, a, i, l) {
var s = {
type: e,
player_index: r.VM.getValue("user.uid"),
token: r.VM.getValue("user.token"),
name: t,
card_num: o,
date_of_birth: n,
address: a,
pic_z: i,
pic_f: l
};
_.default.Instance.post(m.default.getInstance().WalletUrl + "kyc", s, this.onKycApply.bind(this), !0);
};
e.prototype.sendGetActivityList = function() {
_.default.Instance.post(m.default.getInstance().WalletUrl + "gift", {
player_index: r.VM.getValue("user.uid"),
token: r.VM.getValue("user.token")
}, this.onActivityList.bind(this), !0);
};
e.prototype.sendGiftCalculator = function(e, t, o) {
_.default.Instance.get(m.default.getInstance().WalletUrl + "giftCalculator", {
player_index: r.VM.getValue("user.uid"),
token: r.VM.getValue("user.token"),
gift_id: e,
amount: t
}, o ? function(e) {
var t = JSON.parse(e.response);
o(t);
} : this.onGiftCalculator.bind(this), !0);
};
e.prototype.sendSetBankAccount = function(e, t, o, n, a, i, l, s, c) {
_.default.Instance.get(m.default.getInstance().WalletUrl + "setBankAccount", {
player_index: r.VM.getValue("user.uid"),
token: r.VM.getValue("user.token"),
true_name: e,
bank_account: t,
ifsc: o,
checkout_phone: n,
email: a,
bank_name: i,
pan_no: l,
aadhaar: s,
opt: c
}, this.onSetBackAccount.bind(this), !0);
};
e.prototype.sendCheckBankAccount = function() {
_.default.Instance.get(m.default.getInstance().WalletUrl + "bankAccount", {
player_index: r.VM.getValue("user.uid"),
token: r.VM.getValue("user.token")
}, this.onCheckBankAccount.bind(this), !0);
};
e.prototype.sendWidthdraw = function(e) {
var t = p.Tools.TDate.letcurtimestamp();
if ((null == E.Global.Instance.downNewLayerTime || t - E.Global.Instance.downNewLayerTime >= 3e5) && !b.default.isOfflinePackage() && cc.sys.os !== cc.sys.OS_IOS && r.VM.getValue("wallet.totalRecharge") > 500) {
I.default.Instance.addBundleMaskLayer(s.BundleUIPath.DownNewLayer, function() {}, 9999);
E.Global.Instance.downNewLayerTime = t;
} else {
var o = b.default.getOnlyID();
this._withdrawAmout = e;
_.default.Instance.get(m.default.getInstance().WalletUrl + "withd", {
player_index: r.VM.getValue("user.uid"),
token: r.VM.getValue("user.token"),
amount: e,
imei: o
}, this.onWithdraw.bind(this), !0);
}
};
e.prototype.sendWithdrawCancel = function(e) {
var t = b.default.getOnlyID();
_.default.Instance.get(m.default.getInstance().WalletUrl + "withd_cancel", {
player_index: r.VM.getValue("user.uid"),
token: r.VM.getValue("user.token"),
wallet_sn: e,
imei: t
}, this.onWithdrawCancel.bind(this), !0);
};
e.prototype.sendPaymentType = function() {
_.default.Instance.get(m.default.getInstance().WalletUrl + "paytype", {
player_index: r.VM.getValue("user.uid"),
token: r.VM.getValue("user.token")
}, this.onPaymentType.bind(this), !0);
};
e.prototype.sendPayment = function(e, t, o, n, a, i, l, s, c) {
void 0 === o && (o = 0);
void 0 === n && (n = 0);
void 0 === i && (i = 0);
void 0 === l && (l = 0);
void 0 === s && (s = 0);
void 0 === c && (c = 0);
var u = 0;
cc.sys.os == cc.sys.OS_ANDROID && (u = 1);
cc.sys.os == cc.sys.OS_IOS && (u = 2);
cc.sys.isNative || (u = 3);
var d = {
player_index: r.VM.getValue("user.uid"),
token: r.VM.getValue("user.token"),
gift_id: t,
amount: e,
user_name: "",
mobile_type: u,
tel_phone: "",
email: "",
idCard: "",
payType: 0,
cashback: o,
bonus: n,
monthly_card_id: i,
is_bankruptcy: l,
is_cash: m.default.getInstance().isCashGame ? "" : "is_cash",
active_type: s,
hideGainInfo: c
};
_.default.Instance.get(m.default.getInstance().WalletUrl + "pay", d, a, !0);
};
e.prototype.sendGetNotice = function() {
_.default.Instance.get(m.default.getInstance().WalletUrl + "activeList", {
player_index: r.VM.getValue("user.uid"),
token: r.VM.getValue("user.token")
}, this.onNoticeList.bind(this), !0);
};
e.prototype.sendGetBonusRecord = function() {
_.default.Instance.get(m.default.getInstance().WalletUrl + "bonusList", {
player_index: r.VM.getValue("user.uid"),
token: r.VM.getValue("user.token")
}, this.onBonusRecord.bind(this), !0);
};
e.prototype.sendBonusAllAmount = function() {
_.default.Instance.get(m.default.getInstance().WalletUrl + "bonusAllAmount", {
player_index: r.VM.getValue("user.uid"),
token: r.VM.getValue("user.token")
}, this.onBonusAllAmount.bind(this), !0);
};
e.prototype.UserRechargeInfo = function() {
_.default.Instance.get(m.default.getInstance().WalletUrl + "getUserRechargeInfo", {
player_index: r.VM.getValue("user.uid"),
token: r.VM.getValue("user.token")
}, this.onGetUserRechargeInfoHttp.bind(this), !0);
};
e.prototype.sendGetRechargeGoods = function(e, t) {
_.default.Instance.get(m.default.getInstance().WalletUrl + "goodsCnt", {
player_index: r.VM.getValue("user.uid"),
token: r.VM.getValue("user.token"),
gift_id: e,
amount_list: t
}, this.onGetRechargeGoods.bind(this), !0);
};
e.prototype.sendGetRechargeUserInfo = function() {
_.default.Instance.get(m.default.getInstance().WalletUrl + "getRechargeUserInfo", {
player_index: r.VM.getValue("user.uid"),
token: r.VM.getValue("user.token")
}, this.onGetRechargeUserInfo.bind(this), !0);
};
e.prototype.sendSetRechargeUserInfo = function(e, t, o, n) {
var a = this;
void 0 === e && (e = "");
void 0 === t && (t = "");
void 0 === o && (o = "");
void 0 === n && (n = 0);
_.default.Instance.post(m.default.getInstance().WalletUrl + "setRechargeUserInfo", {
player_index: r.VM.getValue("user.uid"),
token: r.VM.getValue("user.token"),
name: e,
phone: t,
email: o,
preinstall_amount: n
}, function(i) {
if (1 == JSON.parse(i.response).code) {
"" != e && (a.rechargeUserInfo.user_name = e);
"" != t && (a.rechargeUserInfo.tel_phone = t);
"" != o && (a.rechargeUserInfo.email = o);
0 != n && (a.rechargeUserInfo.preferred = n);
a.sendGetRechargeUserInfo();
}
}, !0);
};
e.prototype.sendGetRechargeRegion = function(e, t) {
_.default.Instance.post(m.default.getInstance().WalletUrl + "rechargeRegion", {
player_index: r.VM.getValue("user.uid"),
token: r.VM.getValue("user.token"),
amount: e
}, function(e) {
var o = JSON.parse(e.response);
t && t(o);
}, !0);
};
e.prototype.sendAppWeb = function() {
_.default.Instance.post(m.default.getInstance().WalletUrl + "appweb", {
uid: r.VM.getValue("user.uid"),
token: r.VM.getValue("user.token")
});
};
e.prototype.sendGetBonusUnaccalimed = function() {
var e = this;
_.default.Instance.post(m.default.getInstance().WalletUrl + "getbonusunaccalimed", {
uid: r.VM.getValue("user.uid"),
token: r.VM.getValue("user.token")
}, function(t) {
var o = JSON.parse(t.response);
if (1 == o.code) {
e._unclaimedBonus = o.data.fee;
e._BonusReturnRate = o.data.transform;
c.default.Instance.Global.emit(h.WalletEvent.BONUS_GET_UNREWARD, o.data.fee);
}
}, !0);
};
e.prototype.sendRewardBonus = function(e) {
var t = this;
_.default.Instance.post(m.default.getInstance().WalletUrl + "bonusreceive", {
uid: r.VM.getValue("user.uid"),
token: r.VM.getValue("user.token")
}, function(o) {
var n = JSON.parse(o.response);
if (1 == n.code) {
var a = parseFloat(n.data);
isNaN(a) && (a = 0);
e && e(p.Tools.TNumber.num2single(a));
t.sendGetUserWallet();
}
}, !0);
};
e.prototype.sendGetWithdrawCount = function(e) {
_.default.Instance.post(m.default.getInstance().WalletUrl + "getWithNum", {
player_index: r.VM.getValue("user.uid"),
token: r.VM.getValue("user.token")
}, function(t) {
var o = JSON.parse(t.response);
e && e(parseInt(o));
}, !0);
};
e.prototype.sendCheckPhoneNumber = function(e, t) {
_.default.Instance.post(m.default.getInstance().WalletUrl + "verifyphoneapi", {
checkout_phone: e,
player_index: r.VM.getValue("user.uid"),
token: r.VM.getValue("user.token")
}, function(e) {
var o = JSON.parse(e.response);
t && t(parseInt(o));
}, !0);
};
e.prototype.sendCheckIFSC = function(e, t) {
_.default.Instance.post(m.default.getInstance().WalletUrl + "verifyifscapi", {
ifsc: e,
player_index: r.VM.getValue("user.uid"),
token: r.VM.getValue("user.token")
}, function(e) {
var o = JSON.parse(e.response);
t && t(parseInt(o));
}, !0);
};
e.prototype.sendPhoneMailState = function() {
var e = g.default.Instance.makeMsg(y.C2S.WALLET_CHECK_PHONE, {
u: r.VM.getValue("user.uid"),
t: r.VM.getValue("user.token")
});
g.default.Instance.send(e);
};
e.prototype.sendBindCode = function(e, t) {
var o = g.default.Instance.makeMsg(y.C2S.WALLET_BIND_CODE, {
pn: e,
ac: t,
u: r.VM.getValue("user.uid"),
t: r.VM.getValue("user.token")
});
g.default.Instance.send(o);
};
e.prototype.sendBindPhone = function(e, t, o) {
var n = g.default.Instance.makeMsg(y.C2S.WALLET_BIND_PHONE, {
pn: e,
ac: t,
cd: o,
u: r.VM.getValue("user.uid"),
t: r.VM.getValue("user.token")
});
g.default.Instance.send(n);
};
e.prototype.sendBindEmail = function(e) {
var t = g.default.Instance.makeMsg(y.C2S.WALLET_BIND_EMAIL, {
u: r.VM.getValue("user.uid"),
t: r.VM.getValue("user.token"),
e: e
});
g.default.Instance.send(t);
};
e.prototype.sendGetUserWallet = function() {
var e = g.default.Instance.makeMsg(y.C2S.WALLET_GET_USER_WALLET, {
u: r.VM.getValue("user.uid"),
t: r.VM.getValue("user.token")
});
g.default.Instance.send(e);
};
e.prototype.sendSystemTipsWithdraw = function() {
var e = g.default.Instance.makeMsg(y.C2S.SERVER_SYSTEM_TIPS_WITHDRAW, {
u: r.VM.getValue("user.uid"),
t: r.VM.getValue("user.token")
});
g.default.Instance.send(e);
};
e.prototype.getBonusData = function(e) {
var t = this;
_.default.Instance.get(m.default.getInstance().WalletUrl + "bonusinfo", {
uid: r.VM.getValue("user.uid"),
token: r.VM.getValue("user.token")
}, function(o) {
var n = JSON.parse(o.response);
if (1 == n.code) {
t.bonusinfo = n.data;
if (e) {
e(n.data);
c.default.Instance.Global.emit(h.WalletEvent.BONUS_GET_UNREWARD, null);
}
}
}, !0);
};
e._instance = null;
return e;
}();
o.WalletProxy = S;
cc._RF.pop();
}, {
"../../Game/Script/global/GlobalValue": "GlobalValue",
"../../Game/client/global/enum/game/Const": "Const",
"../../Game/client/global/enum/game/Event": "Event",
"../../Game/client/global/enum/game/Game": "Game",
"../../Game/client/global/enum/net/C2S": "C2S",
"../../Game/client/global/enum/net/S2C": "S2C",
"../../Game/client/logic/game/GameHelper": "GameHelper",
"../../Game/client/model/CommonModel": "CommonModel",
"../../Game/client/model/LanguageModel": "LanguageModel",
"../../Game/fromework/global/Tools": "Tools",
"../../Game/fromework/helper/EventHelper": "EventHelper",
"../../Game/fromework/helper/UIHelper": "UIHelper",
"../../Game/fromework/mvvm/modelView/ViewModel": "ViewModel",
"../../Game/fromework/net/NetHttp": "NetHttp",
"../../fromework/helper/NetHelper": "NetHelper",
"../../platform/Platform": "Platform",
"../global/Global": "Global",
"../global/PopHelper": "PopHelper",
"./PhoneModel": "PhoneModel",
"./RecentModel": "RecentModel",
"./RedDotModel": "RedDotModel"
} ],
WalletRecharge: [ function(e, t, o) {
"use strict";
cc._RF.push(t, "c4548IBfPtK75Kv2jlITIxb", "WalletRecharge");
var n, a = this && this.__extends || (n = function(e, t) {
return (n = Object.setPrototypeOf || {
__proto__: []
} instanceof Array && function(e, t) {
e.__proto__ = t;
} || function(e, t) {
for (var o in t) Object.prototype.hasOwnProperty.call(t, o) && (e[o] = t[o]);
})(e, t);
}, function(e, t) {
n(e, t);
function o() {
this.constructor = e;
}
e.prototype = null === t ? Object.create(t) : (o.prototype = t.prototype, new o());
}), i = this && this.__decorate || function(e, t, o, n) {
var a, i = arguments.length, r = i < 3 ? t : null === n ? n = Object.getOwnPropertyDescriptor(t, o) : n;
if ("object" == typeof Reflect && "function" == typeof Reflect.decorate) r = Reflect.decorate(e, t, o, n); else for (var l = e.length - 1; l >= 0; l--) (a = e[l]) && (r = (i < 3 ? a(r) : i > 3 ? a(t, o, r) : a(t, o)) || r);
return i > 3 && r && Object.defineProperty(t, o, r), r;
};
Object.defineProperty(o, "__esModule", {
value: !0
});
var r = e("../../component/NumericLabel"), l = e("../../../Game/client/model/LanguageModel"), s = e("../../model/WalletModel"), c = e("../ui/VIP/VIPLogic"), u = e("./WalletActItem"), d = e("./WalletActivity"), p = e("./WalletHelper"), h = e("./WalletInfoAlert"), f = e("../../../Game/fromework/helper/EventHelper"), _ = e("../../../Game/client/global/enum/game/Event"), m = e("../../../Game/fromework/global/Tools"), y = e("../../../Game/fromework/mvvm/modelView/ViewModel"), g = e("../../../Game/client/global/enum/game/Const"), v = e("../../../Game/fromework/helper/UIHelper"), C = e("../../global/PopHelper"), b = cc._decorator, I = b.ccclass, E = b.property, S = function(e) {
a(t, e);
function t() {
var t = null !== e && e.apply(this, arguments) || this;
t.Total = null;
t.Cash = null;
t.CashBack = null;
t.Bonus = null;
t.ActSelectItem = null;
t.ActSelectItemName = null;
t.ActDetailNode = null;
t.Prefab_WalletActItem = null;
t.ActivityContent = null;
t.Enpty = null;
t.VIPTips = null;
t.CashInput = null;
t.RechargeItem = null;
t.RechargeLayout = null;
t.PhoneNode = null;
t.PhoneInput = null;
t._isInit = !1;
t._openParam = null;
t._walletActItem = null;
t._inputCash = 0;
t._cashback = 0;
t._bonus = 0;
t._minInput = s.WalletProxy.Instance.minRecharge;
t._maxInput = s.WalletProxy.Instance.maxRecharge;
t._isSelectAct = !1;
t._curActivityData = null;
t.rechargeDatas = [];
t._toggles = new Map();
t._curToggleIndex = -1;
return t;
}
t.prototype.onEnable = function() {
f.default.Instance.Global.bind(_.WalletEvent.ACTIVITY_SELECT, this.onSelectActivity, this);
f.default.Instance.Global.bind(_.WalletEvent.RECHARGE_GET_CALCULATOR, this.onGiftCalculator, this);
f.default.Instance.Global.bind(_.WalletEvent.RECHARGE_GET_USERINFO, this.refreshPhone, this);
f.default.Instance.Global.bind(_.WalletEvent.RECHARGE_ACT_REFRESH, this.onActRefresh, this);
f.default.Instance.Global.bind(_.WalletEvent.RECHARGE_CLOSE_WEBVIEW, this.onResetView, this);
};
t.prototype.onDisable = function() {
f.default.Instance.Global.unbind(_.WalletEvent.ACTIVITY_SELECT, this.onSelectActivity, this);
f.default.Instance.Global.unbind(_.WalletEvent.RECHARGE_GET_CALCULATOR, this.onGiftCalculator, this);
f.default.Instance.Global.unbind(_.WalletEvent.RECHARGE_GET_USERINFO, this.refreshPhone, this);
f.default.Instance.Global.unbind(_.WalletEvent.RECHARGE_ACT_REFRESH, this.onActRefresh, this);
f.default.Instance.Global.unbind(_.WalletEvent.RECHARGE_CLOSE_WEBVIEW, this.onResetView, this);
};
t.prototype.onPayment = function(e) {
var t = "";
if (1 == e.code) {
if (e.data.isWebView) {
p.default.Instance.openRechargeWebView(e.data.payLinks);
this.onCloseClicked();
}
} else t = 6001 == e.code ? l.default.getString("WALLET_CASH_ATTEND") : 6003 == e.code ? l.default.getString("WALLET_CASH_WRONG") : 6004 == e.code ? l.default.getString("WALLET_CASH_UID") : 6005 == e.code ? l.default.getString("WALLET_CASH_ORDER") : 6006 == e.code ? l.default.getString("WALLET_CASH_THIRD") : 6008 == e.code ? l.default.getString("WALLET_CASH_TYPE") : "Error code:" + e.code;
"" != t && C.PopHelper.Instance.showTips(t);
};
t.prototype.onResetView = function() {
this._inputCash = 0;
this._cashback = 0;
this._bonus = 0;
this._isSelectAct = !1;
this._curActivityData = null;
this._curToggleIndex = -1;
this.CashInput.string = "";
this.refreshView();
};
t.prototype.onActRefresh = function() {
var e = this, t = 1e3;
null != this._openParam && null != this._openParam.cash && (t = this._openParam.cash);
if (this._isInit && s.WalletProxy.Instance.activityList.length > 0) {
var o = s.WalletProxy.Instance.activityList[0];
null != this._openParam && null != this._openParam.activityId && s.WalletProxy.Instance.activityList.forEach(function(t) {
e._openParam.activityId == t.id && (o = t);
});
this._isInit = !1;
this._isSelectAct = !0;
this._curActivityData = o;
this._minInput = o.min_amount;
this._maxInput = o.max_amount;
t < this._minInput && (t = this._minInput);
t > this._maxInput && (t = this._maxInput);
this.refreshView();
this.onCashInputReturn(null, t);
} else {
this.refreshView();
this.onCashInputReturn(null, t);
}
};
t.prototype.onGiftCalculator = function(e) {
var t = e.getUserData();
if (1 == t.code) {
this._cashback = t.data.deposit_amount - this._inputCash;
this._bonus = t.data.bonus + c.default.Instance.getRechargeBonus(this._inputCash);
this.refreshWallet();
}
};
t.prototype.onSelectActivity = function(e) {
var t = e.getUserData();
this._curActivityData = t;
this._isSelectAct = !0;
this._minInput = t.min_amount;
this._maxInput = t.max_amount;
this.onCashInputReturn(null, this._minInput);
this.refreshAct();
};
t.prototype.InitView = function(e) {
this._isInit = !0;
this._openParam = e;
this.Enpty.active = !1;
this.ActSelectItem.active = !1;
this.ActDetailNode.active = !1;
this.refreshPhone();
s.WalletProxy.Instance.sendGetActivityList();
s.WalletProxy.Instance.sendGetRechargeGoods(0, []);
};
t.prototype.refreshView = function() {
this.refreshWallet();
this.refreshAct();
this.refreshRecharge();
if (c.default.Instance.isMaxLevel()) this.VIPTips.string = l.default.getString("VIP_TIPS_LEVEL_MAX"); else {
var e = c.default.Instance.nextExp, t = e <= 0 ? 0 : c.default.Instance.vipExp2Recharge(e), o = y.VM.getValue("user.vip_level");
this.VIPTips.string = m.Tools.TStr.replaceString(l.default.getString("VIP_TIPS_LEVEL_MONEY"), {
recharge: t,
level: o + 1
});
}
};
t.prototype.refreshPhone = function() {
if ("" == s.WalletProxy.Instance.rechargeUserInfo.tel_phone) this.PhoneNode.active = !1; else {
this.PhoneNode.active = !0;
this.PhoneInput.string = s.WalletProxy.Instance.rechargeUserInfo.tel_phone;
}
};
t.prototype.refreshWallet = function() {
this.Total.string = m.Tools.TNumber.numFixed(this._inputCash + this._cashback + this._bonus, 2) + "";
this.Cash.string = m.Tools.TNumber.numFixed(this._inputCash, 2) + "";
this.CashBack.string = m.Tools.TNumber.numFixed(this._cashback, 2) + "";
this.Bonus.string = m.Tools.TNumber.numFixed(this._bonus, 2) + "";
this.CashInput.string = 0 == this._inputCash ? "" : this._inputCash + "";
};
t.prototype.refreshAct = function() {
this.Enpty.active = !this._isSelectAct;
this.ActSelectItem.active = this._isSelectAct;
this.ActDetailNode.active = this._isSelectAct;
if (this._isSelectAct) {
this.ActSelectItemName.string = this._curActivityData.title;
if (this._walletActItem && this._walletActItem.node && this._walletActItem.node.isValid) {
this._walletActItem.setButtonsActive(!1);
this._walletActItem.setDetailActive(!0);
this._walletActItem.onItemInitCallFunc(this._curActivityData, 0);
} else {
this.ActivityContent.destroyAllChildren();
var e = cc.instantiate(this.Prefab_WalletActItem);
e.active = !0;
e.zIndex = 0;
this.ActivityContent.addChild(e);
this._walletActItem = e.getComponent(u.default);
this._walletActItem.setButtonsActive(!1);
this._walletActItem.setDetailActive(!0);
this._walletActItem.onItemInitCallFunc(this._curActivityData, 0);
}
}
};
t.prototype.refreshRecharge = function() {
this.rechargeDatas = s.WalletProxy.Instance.rechargeGear.concat();
this.RechargeLayout.destroyAllChildren();
this._toggles.clear();
for (var e = 0; e < this.rechargeDatas.length; e++) {
var t = this.rechargeDatas[e], o = cc.instantiate(this.RechargeItem);
o.active = !0;
o.RechargeGear = t;
this.RechargeLayout.addChild(o);
o.getChildByName("CashNum").getComponent(cc.Label).string = l.default.getString("COMMON_RUPEE") + t;
var n = o.getComponent(cc.Toggle);
n.isChecked = !1;
this._toggles.set(e, n);
var a = new cc.Component.EventHandler();
a.target = this.node;
a.component = "WalletRecharge";
a.handler = "onRechargeToggleClicked";
a.customEventData = String(e);
n.checkEvents.push(a);
if (this._curToggleIndex == e) {
n.check();
n.interactable = !1;
} else {
n.uncheck();
n.interactable = !0;
}
}
};
t.prototype.refreshToggleState = function() {
var e = this, t = !1;
this._toggles.forEach(function(o, n) {
if (e.rechargeDatas[n] == e._inputCash) {
e.onRechargeToggleClicked(o, n);
t = !0;
}
});
t || this.onRechargeToggleClicked(null, -1);
};
t.prototype.onActDeselected = function() {
this._curActivityData = null;
this._isSelectAct = !1;
this._cashback = 0;
this._bonus = 0;
this._minInput = s.WalletProxy.Instance.minRecharge;
this._maxInput = s.WalletProxy.Instance.maxRecharge;
this.onCashInputReturn(null, this._inputCash);
this.refreshAct();
};
t.prototype.onActSelectClicked = function() {
v.default.Instance.addBundleMaskLayer(g.BundleUIPath.WalletActivity, function(e) {
e.getComponent(d.default).InitView();
});
};
t.prototype.onCashInputReturn = function(e, t) {
var o = parseInt(this.CashInput.string);
null != t && isNaN(o) && (o = t);
if (isNaN(o)) {
this.CashInput.string = "";
this._inputCash = 0;
this._cashback = 0;
this._bonus = 0;
this.refreshToggleState();
this.refreshWallet();
var n = m.Tools.TStr.replaceString(l.default.getString("RECHARGE_INPUT_TIPS3"), {
num1: this._minInput,
num2: this._maxInput
});
C.PopHelper.Instance.showTips(n);
} else {
if (o < this._minInput || o > this._maxInput) {
n = "";
n = this._isSelectAct ? m.Tools.TStr.replaceString(l.default.getString("RECHARGE_INPUT_TIPS2"), {
num1: this._minInput,
num2: this._maxInput
}) : m.Tools.TStr.replaceString(l.default.getString("RECHARGE_INPUT_TIPS3"), {
num1: this._minInput,
num2: this._maxInput
});
C.PopHelper.Instance.showTips(n);
}
o < this._minInput && (o = this._minInput);
o > this._maxInput && (o = this._maxInput);
this._inputCash = o;
this.refreshToggleState();
if (this._isSelectAct) s.WalletProxy.Instance.sendGiftCalculator(this._curActivityData.id, this._inputCash); else {
this._bonus = c.default.Instance.getRechargeBonus(o);
this.refreshWallet();
}
}
};
t.prototype.onRechargeToggleClicked = function(e, t) {
var o = this, n = parseInt(t);
if (this._curToggleIndex != n) {
this._curToggleIndex = n;
var a = this.rechargeDatas[this._curToggleIndex];
if (a) {
if (a < this._minInput) {
var i = m.Tools.TStr.replaceString(l.default.getString("RECHARGE_INPUT_TIPS2"), {
num1: this._minInput,
num2: this._maxInput
});
C.PopHelper.Instance.showTips(i);
this.refreshToggleState();
return;
}
if (a > this._maxInput) {
i = m.Tools.TStr.replaceString(l.default.getString("RECHARGE_INPUT_TIPS2"), {
num1: this._minInput,
num2: this._maxInput
});
C.PopHelper.Instance.showTips(i);
this.refreshToggleState();
return;
}
this._inputCash = a;
this.CashInput.string = a + "";
}
this._toggles.forEach(function(e, t) {
var n = e.node.getChildByName("CashNum");
if (o._curToggleIndex == t) {
n.color = cc.Color.WHITE;
e.check();
e.interactable = !1;
} else {
n.color = cc.Color.WHITE;
e.uncheck();
e.interactable = !0;
}
});
if (this._isSelectAct) s.WalletProxy.Instance.sendGiftCalculator(this._curActivityData.id, this._inputCash); else {
this._bonus = c.default.Instance.getRechargeBonus(this._inputCash);
this.refreshWallet();
}
}
};
t.prototype.onAddCashClicked = function() {
var e = this;
if (0 != this._inputCash) {
var t = s.WalletProxy.Instance.rechargeUserInfo, o = this._inputCash, n = this._curActivityData ? this._curActivityData.id : 0;
t.info_switch ? v.default.Instance.addBundleMaskLayer(g.BundleUIPath.WalletInfoAlert, function(t) {
t.getComponent(h.default).InitView(function() {
s.WalletProxy.Instance.sendPayment(o, n, 0, 0, function(t) {
var o = JSON.parse(t.response);
e.onPayment(o);
});
});
}) : s.WalletProxy.Instance.sendPayment(o, n, 0, 0, function(t) {
var o = JSON.parse(t.response);
e.onPayment(o);
});
} else C.PopHelper.Instance.showTips(l.default.getString("RECHARGE_INPUT_TIPS1"));
};
t.prototype.onPhoneInputReturn = function() {
var e = this.PhoneInput.string;
if (m.Tools.TStr.checkType(e, "indiaPhone")) s.WalletProxy.Instance.sendSetRechargeUserInfo("", e, ""); else {
C.PopHelper.Instance.showTips(l.default.getString("KYC_INPUT_TIP_1"));
this.PhoneInput.string = s.WalletProxy.Instance.rechargeUserInfo.tel_phone;
}
};
t.prototype.onCloseClicked = function() {
v.default.Instance.removeLayer(this.node);
};
i([ E(cc.Label) ], t.prototype, "Total", void 0);
i([ E(cc.Label) ], t.prototype, "Cash", void 0);
i([ E(cc.Label) ], t.prototype, "CashBack", void 0);
i([ E(cc.Label) ], t.prototype, "Bonus", void 0);
i([ E(cc.Node) ], t.prototype, "ActSelectItem", void 0);
i([ E(cc.Label) ], t.prototype, "ActSelectItemName", void 0);
i([ E(cc.Node) ], t.prototype, "ActDetailNode", void 0);
i([ E(cc.Prefab) ], t.prototype, "Prefab_WalletActItem", void 0);
i([ E(cc.Node) ], t.prototype, "ActivityContent", void 0);
i([ E(cc.Node) ], t.prototype, "Enpty", void 0);
i([ E(cc.Label) ], t.prototype, "VIPTips", void 0);
i([ E(r.default) ], t.prototype, "CashInput", void 0);
i([ E(cc.Node) ], t.prototype, "RechargeItem", void 0);
i([ E(cc.Node) ], t.prototype, "RechargeLayout", void 0);
i([ E(cc.Node) ], t.prototype, "PhoneNode", void 0);
i([ E(r.default) ], t.prototype, "PhoneInput", void 0);
return i([ I ], t);
}(cc.Component);
o.default = S;
cc._RF.pop();
}, {
"../../../Game/client/global/enum/game/Const": "Const",
"../../../Game/client/global/enum/game/Event": "Event",
"../../../Game/client/model/LanguageModel": "LanguageModel",
"../../../Game/fromework/global/Tools": "Tools",
"../../../Game/fromework/helper/EventHelper": "EventHelper",
"../../../Game/fromework/helper/UIHelper": "UIHelper",
"../../../Game/fromework/mvvm/modelView/ViewModel": "ViewModel",
"../../component/NumericLabel": "NumericLabel",
"../../global/PopHelper": "PopHelper",
"../../model/WalletModel": "WalletModel",
"../ui/VIP/VIPLogic": "VIPLogic",
"./WalletActItem": "WalletActItem",
"./WalletActivity": "WalletActivity",
"./WalletHelper": "WalletHelper",
"./WalletInfoAlert": "WalletInfoAlert"
} ],
WalletSelectImg: [ function(e, t, o) {
"use strict";
cc._RF.push(t, "bb4f9O6kohP47MWn3oPCSGN", "WalletSelectImg");
var n, a = this && this.__extends || (n = function(e, t) {
return (n = Object.setPrototypeOf || {
__proto__: []
} instanceof Array && function(e, t) {
e.__proto__ = t;
} || function(e, t) {
for (var o in t) Object.prototype.hasOwnProperty.call(t, o) && (e[o] = t[o]);
})(e, t);
}, function(e, t) {
n(e, t);
function o() {
this.constructor = e;
}
e.prototype = null === t ? Object.create(t) : (o.prototype = t.prototype, new o());
}), i = this && this.__decorate || function(e, t, o, n) {
var a, i = arguments.length, r = i < 3 ? t : null === n ? n = Object.getOwnPropertyDescriptor(t, o) : n;
if ("object" == typeof Reflect && "function" == typeof Reflect.decorate) r = Reflect.decorate(e, t, o, n); else for (var l = e.length - 1; l >= 0; l--) (a = e[l]) && (r = (i < 3 ? a(r) : i > 3 ? a(t, o, r) : a(t, o)) || r);
return i > 3 && r && Object.defineProperty(t, o, r), r;
};
Object.defineProperty(o, "__esModule", {
value: !0
});
var r = e("../../../Game/fromework/helper/UIHelper"), l = e("../../../platform/Platform"), s = cc._decorator, c = s.ccclass, u = s.property, d = function(e) {
a(t, e);
function t() {
var t = null !== e && e.apply(this, arguments) || this;
t.AadhaarFront = null;
t.AadhaarBack = null;
t.DrivingFront = null;
t.DrivingBack = null;
t.PassportFront = null;
t.PassportBack = null;
t._type = 0;
t._side = 0;
return t;
}
t.prototype.InitView = function(e, t) {
this._type = e;
this._side = t;
this.refreshView();
};
t.prototype.refreshView = function() {
this.AadhaarFront.active = 0 == this._type && 0 == this._side;
this.AadhaarBack.active = 0 == this._type && 1 == this._side;
this.DrivingFront.active = 1 == this._type && 0 == this._side;
this.DrivingBack.active = 1 == this._type && 1 == this._side;
this.PassportFront.active = 2 == this._type && 0 == this._side;
this.PassportBack.active = 2 == this._type && 1 == this._side;
};
t.prototype.onPhotographClicked = function() {
l.default.takePhoto();
this.onCloseClicked();
};
t.prototype.onSelectClicked = function() {
l.default.pickImageFromAlbum();
this.onCloseClicked();
};
t.prototype.onCloseClicked = function() {
r.default.Instance.removeMaskLayer(this.node);
};
i([ u(cc.Node) ], t.prototype, "AadhaarFront", void 0);
i([ u(cc.Node) ], t.prototype, "AadhaarBack", void 0);
i([ u(cc.Node) ], t.prototype, "DrivingFront", void 0);
i([ u(cc.Node) ], t.prototype, "DrivingBack", void 0);
i([ u(cc.Node) ], t.prototype, "PassportFront", void 0);
i([ u(cc.Node) ], t.prototype, "PassportBack", void 0);
return i([ c ], t);
}(cc.Component);
o.default = d;
cc._RF.pop();
}, {
"../../../Game/fromework/helper/UIHelper": "UIHelper",
"../../../platform/Platform": "Platform"
} ],
WalletWithdrawPending: [ function(e, t, o) {
"use strict";
cc._RF.push(t, "ca300Foch1CDbKj99m+LSD1", "WalletWithdrawPending");
var n, a = this && this.__extends || (n = function(e, t) {
return (n = Object.setPrototypeOf || {
__proto__: []
} instanceof Array && function(e, t) {
e.__proto__ = t;
} || function(e, t) {
for (var o in t) Object.prototype.hasOwnProperty.call(t, o) && (e[o] = t[o]);
})(e, t);
}, function(e, t) {
n(e, t);
function o() {
this.constructor = e;
}
e.prototype = null === t ? Object.create(t) : (o.prototype = t.prototype, new o());
}), i = this && this.__decorate || function(e, t, o, n) {
var a, i = arguments.length, r = i < 3 ? t : null === n ? n = Object.getOwnPropertyDescriptor(t, o) : n;
if ("object" == typeof Reflect && "function" == typeof Reflect.decorate) r = Reflect.decorate(e, t, o, n); else for (var l = e.length - 1; l >= 0; l--) (a = e[l]) && (r = (i < 3 ? a(r) : i > 3 ? a(t, o, r) : a(t, o)) || r);
return i > 3 && r && Object.defineProperty(t, o, r), r;
};
Object.defineProperty(o, "__esModule", {
value: !0
});
var r = e("../../../Game/client/global/enum/game/Const"), l = e("../../../Game/client/model/LanguageModel"), s = e("../../../Game/fromework/global/Tools"), c = e("../../../Game/fromework/helper/UIHelper"), u = e("../../model/WalletModel"), d = e("./WalletWithdraw"), p = cc._decorator, h = p.ccclass, f = p.property, _ = function(e) {
a(t, e);
function t() {
var t = null !== e && e.apply(this, arguments) || this;
t.TransactionId = null;
t.Amount = null;
t.HandingFee = null;
t.Account = null;
t.Time = null;
return t;
}
t.prototype.InitView = function(e) {
this.TransactionId.string = e.data.order_id;
this.Amount.string = "+" + l.default.getString("COMMON_RUPEE") + e.data.amount;
this.Account.string = e.data.bank_account;
this.Time.string = s.Tools.TDate.format(1e3 * e.data.create_time, "dd MM yyyy hh:mm", !0);
for (var t = Object.keys(e.data.fee), o = "", n = 0; n < t.length; n++) {
var a = parseInt(t[n]), i = s.Tools.TNumber.num2single(e.data.fee[a]);
0 != n && (o += " ");
1 == a ? o = o + l.default.getString("COMMON_RUPEE") + i + "(" + l.default.getString("REFER_RULE_DEPOSIT") + ")" : 3 == a ? o = o + l.default.getString("COMMON_RUPEE") + i + "(" + l.default.getString("REFER_RULE_WITHDRAWAL") + ")" : 4 == a && (o = o + l.default.getString("COMMON_RUPEE") + i + "(" + l.default.getString("DE_BONUS") + ")");
}
this.HandingFee.string = o;
};
t.prototype.onCloseClicked = function() {
c.default.Instance.removeLayer(this.node);
};
t.prototype.onWithdrawClicked = function() {
var e = this;
c.default.Instance.addBundleLayer(r.BundleUIPath.WalletWithdraw, function(t) {
u.WalletProxy.Instance.sendGetUserWallet();
e.onCloseClicked();
t.getComponent(d.default).InitView();
});
};
i([ f(cc.Label) ], t.prototype, "TransactionId", void 0);
i([ f(cc.Label) ], t.prototype, "Amount", void 0);
i([ f(cc.Label) ], t.prototype, "HandingFee", void 0);
i([ f(cc.Label) ], t.prototype, "Account", void 0);
i([ f(cc.Label) ], t.prototype, "Time", void 0);
return i([ h ], t);
}(cc.Component);
o.default = _;
cc._RF.pop();
}, {
"../../../Game/client/global/enum/game/Const": "Const",
"../../../Game/client/model/LanguageModel": "LanguageModel",
"../../../Game/fromework/global/Tools": "Tools",
"../../../Game/fromework/helper/UIHelper": "UIHelper",
"../../model/WalletModel": "WalletModel",
"./WalletWithdraw": "WalletWithdraw"
} ],
WalletWithdraw: [ function(e, t, o) {
"use strict";
cc._RF.push(t, "9b6911j7gFFtY8MSPCX1WEF", "WalletWithdraw");
var n, a = this && this.__extends || (n = function(e, t) {
return (n = Object.setPrototypeOf || {
__proto__: []
} instanceof Array && function(e, t) {
e.__proto__ = t;
} || function(e, t) {
for (var o in t) Object.prototype.hasOwnProperty.call(t, o) && (e[o] = t[o]);
})(e, t);
}, function(e, t) {
n(e, t);
function o() {
this.constructor = e;
}
e.prototype = null === t ? Object.create(t) : (o.prototype = t.prototype, new o());
}), i = this && this.__decorate || function(e, t, o, n) {
var a, i = arguments.length, r = i < 3 ? t : null === n ? n = Object.getOwnPropertyDescriptor(t, o) : n;
if ("object" == typeof Reflect && "function" == typeof Reflect.decorate) r = Reflect.decorate(e, t, o, n); else for (var l = e.length - 1; l >= 0; l--) (a = e[l]) && (r = (i < 3 ? a(r) : i > 3 ? a(t, o, r) : a(t, o)) || r);
return i > 3 && r && Object.defineProperty(t, o, r), r;
};
Object.defineProperty(o, "__esModule", {
value: !0
});
var r = e("../../../Config"), l = e("../../component/NumericLabel"), s = e("../../component/pop/BindAlert"), c = e("../../component/WithdrawCheckAlert"), u = e("../../component/WithdrawLimitAlert"), d = e("../../../Game/client/model/LanguageModel"), p = e("../../model/RecentModel"), h = e("../../model/RedDotModel"), f = e("../../model/UserModel"), _ = e("../../model/VIPModel"), m = e("../../model/WalletModel"), y = e("../ui/Recent/RecentPayView"), g = e("../ui/WithdrawChargeAlert/WithdrawChargeAlert"), v = e("./WalletWithdrawPending"), C = e("../../../Game/client/global/enum/game/Const"), b = e("../../../Game/client/global/enum/game/Event"), I = e("../../../Game/fromework/helper/EventHelper"), E = e("../../../Game/fromework/helper/UIHelper"), S = e("../../../Game/fromework/global/Tools"), T = e("../../../Game/fromework/mvvm/modelView/ViewModel"), R = e("../../../Game/client/global/enum/game/Game"), O = e("../../../Game/Script/global/GlobalValue"), A = e("../../global/PopHelper"), P = e("../ui/Exchange/ExchangeWithdarwLayer"), M = e("../active/ActiveModel"), G = cc._decorator, w = G.ccclass, D = G.property, L = function(e) {
a(t, e);
function t() {
var t = null !== e && e.apply(this, arguments) || this;
t.KYCButton = null;
t.Balance = null;
t.Withdraw = null;
t.InputLeft = null;
t.InputRight = null;
t.InputBank = null;
t.AccountInput = null;
t.PhoneInput = null;
t.NameInput = null;
t.IFSCInput = null;
t.EmailInput = null;
t.BankNameInput = null;
t.PanNoInput = null;
t.AadhaarInput = null;
t.Bank = null;
t.BankNumber = null;
t.BankName = null;
t.AmountTips = null;
t.TotalBet = null;
t.TotalWithdraw = null;
t.TotalReward = null;
t.WithdrawAmount = null;
t.RemainingWithdraw = null;
t.WithdrawButton = null;
t.Limit = null;
t.AmountInput = null;
t.ToggleNode = null;
t.ToggleParent = null;
t.CountLimitTitle = null;
t.CountLimitButton = null;
t._bankState = 0;
t._toggles = new Map();
t._withdrawDatas = [];
t._curToggleIndex = -1;
t._minInput = C.MinSingleWidthdraw;
t._maxInput = C.MaxSingleWidthdraw;
t._inputCash = 0;
t._withdrawCount = 0;
t._withdrawDetail = !1;
return t;
}
t.prototype.onLoad = function() {
I.default.Instance.Global.bind(b.WalletEvent.WITHDRAW_CHECK_BANK, this.onCheckBank, this);
I.default.Instance.Global.bind(b.WalletEvent.WITHDRAW_SET_BANK, this.onSetBank, this);
I.default.Instance.Global.bind(b.WalletEvent.WITHDRAW_APPLY, this.onWidthdraw, this);
I.default.Instance.Global.bind(b.VIPEvent.VIP_GET_WITHDRAW_RULE, this.onGetVIPRule, this);
m.WalletProxy.Instance.sendGetUserWallet();
cc.game.on(cc.game.EVENT_SHOW, this._onShowApp, this);
};
t.prototype.onDestroy = function() {
I.default.Instance.Global.unbind(b.WalletEvent.WITHDRAW_CHECK_BANK, this.onCheckBank, this);
I.default.Instance.Global.unbind(b.WalletEvent.WITHDRAW_SET_BANK, this.onSetBank, this);
I.default.Instance.Global.unbind(b.WalletEvent.WITHDRAW_APPLY, this.onWidthdraw, this);
I.default.Instance.Global.unbind(b.VIPEvent.VIP_GET_WITHDRAW_RULE, this.onGetVIPRule, this);
cc.game.off(cc.game.EVENT_SHOW, this._onShowApp, this);
};
t.prototype.InitView = function() {
var e = this;
this._withdrawDetail = f.default.checkSwitch(f.ClientSwitch.CLIENT_FUNC_SWITCH_WITHDRAW_DETAILS);
m.WalletProxy.Instance.sendCheckBankAccount();
_.VIPProxy.Instance.sendGetWithdrawGear();
h.RedDotProxy.Instance.sendReadRedDot("withdrawal_status");
m.WalletProxy.Instance.sendGetKycResult();
m.WalletProxy.Instance.sendGetWithdrawCount(function(t) {
e._withdrawCount = t;
e.refreshWithdrawCount();
});
this.KYCButton.active = 1 == f.default.checkSwitch(f.ClientSwitch.CLIENT_FUNC_SWITCH_KYC);
};
t.prototype._onShowApp = function() {
m.WalletProxy.Instance.sendGetKycResult();
};
t.prototype.onCheckBank = function(e) {
var t = e.getUserData();
this._bankState = 1 == t ? 1 : 0;
cc.sys.localStorage.setItem("bankState", JSON.stringify(this._bankState));
this.refreshBankView();
this.refreshWithdrawAmount();
};
t.prototype.onSetBank = function(e) {
var t = e.getUserData();
if (1 == t) {
this._bankState = 1;
cc.sys.localStorage.setItem("bankState", JSON.stringify(this._bankState));
cc.sys.localStorage.setItem("WithdrawCheckSwitch", JSON.stringify(!0));
this.refreshBankView();
} else 3002 == t ? A.PopHelper.Instance.showTips(d.default.getString("KYC_OPT_FAILED")) : 4006 == t ? A.PopHelper.Instance.showTips(d.default.getString("WITHDRAW_NAME_TIPS")) : 1025 == t ? A.PopHelper.Instance.showTips(d.default.getString("WITHDRAW_FAIL_TIP4")) : A.PopHelper.Instance.showTips(d.default.getString("WITHDRAW_FAIL_TIP7"));
};
t.prototype.onWidthdraw = function(e) {
var t = this, o = e.getUserData(), n = o.code;
1 == n && E.default.Instance.addBundleLayer(C.BundleUIPath.WalletWithdrawPending, function(e) {
E.default.Instance.removeLayer(t.node);
e.getComponent(v.default).InitView(o);
});
1002 == n && A.PopHelper.Instance.showTips(d.default.getString("WITHDRAW_FAIL_TIP12"));
1004 == n && A.PopHelper.Instance.showTips(d.default.getString("WITHDRAW_FAIL_TIP8"));
if (1006 == n) {
var a = {
title: d.default.getString("DT_NOTICE"),
content: d.default.getString("WITHDRAW_FAIL_TIP9"),
leftTitle: d.default.getString("KYC_ALERT_LATER"),
leftCallFunc: function() {},
rightTitle: d.default.getString("KYC_ALERT_COMPLETE"),
rightCallFunc: function() {
m.WalletProxy.Instance.sendGetKycResult();
}
};
A.PopHelper.Instance.showAlert(a, null);
}
3001 == n && A.PopHelper.Instance.showTips(d.default.getString("WITHDRAW_FAIL_TIP10"));
if (4002 == n) {
var i = S.Tools.TStr.replaceString(d.default.getString("WITHDRAW_FAIL_TIP1"), {
num1: this._minInput,
num2: this._maxInput
});
A.PopHelper.Instance.showTips(i);
}
4003 == n && A.PopHelper.Instance.showTips(d.default.getString("WITHDRAW_FAIL_TIP11"));
1021 == n && A.PopHelper.Instance.showTips(d.default.getString("VIP_WITHDRAW_TIPS_1"));
1022 == n && A.PopHelper.Instance.showTips(d.default.getString("VIP_WITHDRAW_TIPS_2"));
1023 == n && A.PopHelper.Instance.showTips(d.default.getString("VIP_WITHDRAW_TIPS_3"));
1025 == n && A.PopHelper.Instance.showTips(d.default.getString("WITHDRAW_FAIL_TIP4"));
4005 == n && A.PopHelper.Instance.showTips(d.default.getString("WITHDRAW_INSUFFICIENT"));
4006 == n && A.PopHelper.Instance.showTips(d.default.getString("WITHDRAW_NAME_TIPS"));
4007 == n && A.PopHelper.Instance.showTips(d.default.getString("WITHDRAW_TIPS_4007"));
999 == n && null != o.msg && A.PopHelper.Instance.showTips(o.msg);
};
t.prototype.onGetVIPRule = function() {
var e = _.VIPProxy.Instance.vipWithdrawRule;
this._minInput = e.with_min;
this._maxInput = e.max_amt;
this._withdrawDatas = e.with_amt.concat();
this.Limit.string = S.Tools.TStr.replaceString(d.default.getString("WITHDRAW_FAIL_TIP1"), {
num1: this._minInput,
num2: this._maxInput
});
this.refreshWithdraw();
this.refreshWithdrawCount();
};
t.prototype.refreshWithdrawCount = function() {
var e = _.VIPProxy.Instance.vipWithdrawRule;
if (-1 == this._curToggleIndex) this.CountLimitTitle.string = S.Tools.TStr.replaceString(d.default.getString("WALLET_WITHDEAW_HANDING"), {
ratio: e.handling_fee_rate
}); else {
var t = this._withdrawDatas[this._curToggleIndex];
this.CountLimitTitle.string = S.Tools.TStr.replaceString(d.default.getString("WALLET_WITHDEAW_HANDING_SELECT"), {
cash: t.handling_fee
});
}
this.CountLimitButton.string = S.Tools.TStr.replaceAll(d.default.getString("WITHDRAW_LIMIT_BUTTON"), "%{count}", this._withdrawCount);
};
t.prototype.refreshBankView = function() {
this.InputBank.active = 0 == this._bankState || 2 == this._bankState;
this.Balance.active = !this._withdrawDetail || 1 == this._bankState;
this.Withdraw.active = !this._withdrawDetail || 1 == this._bankState;
this.Bank.active = 1 == this._bankState;
if (this._withdrawDetail) {
this.InputLeft.width = 605;
this.InputRight.active = !0;
this.InputBank.width = 1210;
} else {
this.InputLeft.width = 550;
this.InputRight.active = !1;
this.InputBank.width = 550;
}
if (1 == this._bankState) {
var e = m.WalletProxy.Instance.bankData, t = String(e.account).replace(/^(\d{4})\d+(\d{4})$/, "$1*********$2");
this.BankNumber.string = S.Tools.TStr.replaceAll(d.default.getString("WITHDRAW_AC_NO"), "%{num}", t);
this.BankName.string = S.Tools.TStr.replaceAll(d.default.getString("WITHDRAW_ACCOUNT_NAME"), "%{name}", e.name);
this.AccountInput.string = e.account;
var o = T.VM.getValue("wallet.userPhone");
this.PhoneInput.string = o && 0 != o ? o.toString() : "";
this.NameInput.string = e.name;
this.IFSCInput.string = e.ifsc;
this.BankNameInput.string = e.bank_name;
this.EmailInput.string = e.email;
this.PanNoInput.string = e.pan_no;
this.AadhaarInput.string = e.aadhaar;
}
};
t.prototype.onChangeAccountClicked = function() {
this._bankState = 2;
cc.sys.localStorage.setItem("bankState", JSON.stringify(this._bankState));
this.refreshBankView();
};
t.prototype.onAccountInputEnd = function() {
this.AccountInput.string.length < 9 && A.PopHelper.Instance.showTips(d.default.getString("WITHDRAW_FAIL_TIP2"));
};
t.prototype.onPhoneInputEnd = function() {
S.Tools.TStr.checkType(this.PhoneInput.string, "indiaPhone") || A.PopHelper.Instance.showTips(d.default.getString("KYC_INPUT_TIP_1"));
};
t.prototype.onIFSCInputEnd = function() {
this.IFSCInput.string.match("^[A-Za-z]{4}0[A-Za-z0-9]{6}$") ? m.WalletProxy.Instance.sendCheckIFSC(this.IFSCInput.string, function(e) {
0 == e && A.PopHelper.Instance.showTips(d.default.getString("WITHDRAW_FAIL_TIP4"));
}) : A.PopHelper.Instance.showTips(d.default.getString("WITHDRAW_FAIL_TIP4"));
};
t.prototype.onBankNameInputEnd = function() {
S.Tools.TStr.checkType(this.BankNameInput.string, "english") && "" != this.BankNameInput.string || A.PopHelper.Instance.showTips(d.default.getString("WITHDRAW_BANK_NAME_TIPS"));
};
t.prototype.onEmailInputEnd = function() {
S.Tools.TStr.checkType(this.EmailInput.string, "email") || A.PopHelper.Instance.showTips(d.default.getString("KYC_INPUT_TIP_3"));
};
t.prototype.onPanNoInputEnd = function() {
this.PanNoInput.string.match("^[A-Za-z]{5}[0-9]{4}[A-Za-z]{1}$") || A.PopHelper.Instance.showTips(d.default.getString("WITHDRAW_PAN_NO_TIPS"));
};
t.prototype.onAadhaarInputEnd = function() {
/^[0-9]{12}$/.test(this.AadhaarInput.string) || A.PopHelper.Instance.showTips(d.default.getString("WITHDRAW_AADHAAR_TIPS"));
};
t.prototype.onIFSCButtonClicked = function() {
cc.sys.openURL(r.Config.IFSCUrl);
};
t.prototype.onConfirmClicked = function() {
var e = this;
this.AccountInput.string.length < 9 ? A.PopHelper.Instance.showTips(d.default.getString("WITHDRAW_FAIL_TIP2")) : 0 != this.NameInput.string.length ? S.Tools.TStr.checkType(this.NameInput.string, "english") ? this.IFSCInput.string.match("^[A-Za-z]{4}0[A-Za-z0-9]{6}$") ? !this._withdrawDetail || S.Tools.TStr.checkType(this.BankNameInput.string, "english") && "" != this.BankNameInput.string ? S.Tools.TStr.checkType(this.PhoneInput.string, "indiaPhone") ? !this._withdrawDetail || S.Tools.TStr.checkType(this.EmailInput.string, "email") ? !this._withdrawDetail || this.PanNoInput.string.match("^[A-Za-z]{5}[0-9]{4}[A-Za-z]{1}$") ? !this._withdrawDetail || /^[0-9]{12}$/.test(this.AadhaarInput.string) ? m.WalletProxy.Instance.sendCheckPhoneNumber(this.PhoneInput.string, function(t) {
3001 == t ? A.PopHelper.Instance.showTips(d.default.getString("WITHDRAW_FAIL_TIP14")) : 1 == t ? m.WalletProxy.Instance.sendCheckIFSC(e.IFSCInput.string, function(t) {
if (0 == t) A.PopHelper.Instance.showTips(d.default.getString("WITHDRAW_FAIL_TIP4")); else {
var o = e.NameInput.string, n = e.AccountInput.string, a = e.IFSCInput.string, i = T.VM.getValue("wallet.userPhone"), r = e.EmailInput.string, l = e.BankNameInput.string, c = e.PanNoInput.string, u = e.AadhaarInput.string;
i && 0 != i || (i = e.PhoneInput.string);
E.default.Instance.addBundleMaskLayer(C.BundleUIPath.BindAlert, function(e) {
e.getComponent(s.default).show(i, R.GameEnum.VerificationType.SMS_TYPE_BANK_CARD, function(e) {
null != e ? m.WalletProxy.Instance.sendSetBankAccount(o, n, a, i, r, l, c, u, e) : A.PopHelper.Instance.showTips(d.default.getString("KYC_OPT_FAILED"));
});
});
}
}) : A.PopHelper.Instance.showTips(d.default.getString("KYC_OPT_FAILED"));
}) : A.PopHelper.Instance.showTips(d.default.getString("WITHDRAW_AADHAAR_TIPS")) : A.PopHelper.Instance.showTips(d.default.getString("WITHDRAW_PAN_NO_TIPS")) : A.PopHelper.Instance.showTips(d.default.getString("KYC_INPUT_TIP_3")) : A.PopHelper.Instance.showTips(d.default.getString("KYC_INPUT_TIP_1")) : A.PopHelper.Instance.showTips(d.default.getString("WITHDRAW_BANK_NAME_TIPS")) : A.PopHelper.Instance.showTips(d.default.getString("WITHDRAW_FAIL_TIP4")) : A.PopHelper.Instance.showTips(d.default.getString("WITHDRAW_FAIL_TIP13")) : A.PopHelper.Instance.showTips(d.default.getString("WITHDRAW_FAIL_TIP5"));
};
t.prototype.refreshWithdrawAmount = function() {
var e = m.WalletProxy.Instance.withdrawLimitData;
this.TotalBet.string = d.default.getString("MoneySymbol") + e.totalFlow;
this.TotalWithdraw.string = d.default.getString("MoneySymbol") + e.totalWithLimt;
this.TotalReward.string = d.default.getString("MoneySymbol") + e.freeTotalAmt;
this.WithdrawAmount.string = d.default.getString("MoneySymbol") + e.withTotalAmt;
this.RemainingWithdraw.string = d.default.getString("MoneySymbol") + e.remainingWithAmt;
};
t.prototype.refreshWithdraw = function() {
this.ToggleParent.destroyAllChildren();
this._toggles.clear();
for (var e = 0; e < this._withdrawDatas.length; e++) {
var t = this._withdrawDatas[e], o = cc.instantiate(this.ToggleNode);
o.active = !0;
o.WithdrawGear = t;
this.ToggleParent.addChild(o);
o.getChildByName("CashNum").getComponent(cc.Label).string = d.default.getString("COMMON_RUPEE") + t.amt;
var n = o.getComponent(cc.Toggle);
n.isChecked = !1;
this._toggles.set(e, n);
var a = new cc.Component.EventHandler();
a.target = this.node;
a.component = "WalletWithdraw";
a.handler = "onWithdrawToggleClicked";
a.customEventData = String(e);
n.checkEvents.push(a);
if (this._curToggleIndex == e) {
n.check();
n.interactable = !1;
} else {
n.uncheck();
n.interactable = !0;
}
}
};
t.prototype.onWithdrawToggleClicked = function(e, t) {
var o = this, n = parseInt(t);
if (this._curToggleIndex != n) {
this._curToggleIndex = n;
var a = this._withdrawDatas[this._curToggleIndex];
if (a) {
if (a.amt < this._minInput || a.amt > this._maxInput) {
var i = S.Tools.TStr.replaceString(d.default.getString("WITHDRAW_FAIL_TIP1"), {
num1: this._minInput,
num2: this._maxInput
});
A.PopHelper.Instance.showTips(i);
this.refreshToggleState();
return;
}
if (a.amt > T.VM.getValue("wallet.withdraw")) {
A.PopHelper.Instance.showTips(d.default.getString("WITHDRAW_INSUFFICIENT"));
this.refreshToggleState();
return;
}
this._inputCash = a.amt;
this.AmountInput.string = a.amt + "";
}
this._toggles.forEach(function(e, t) {
var n = e.node.getChildByName("CashNum");
if (o._curToggleIndex == t) {
n.color = cc.Color.WHITE;
e.check();
e.interactable = !1;
} else {
n.color = cc.Color.WHITE;
e.uncheck();
e.interactable = !0;
}
});
this.refreshWithdrawCount();
}
};
t.prototype.refreshToggleState = function() {
var e = this, t = !1;
this._toggles.forEach(function(o, n) {
if (e._withdrawDatas[n].amt == e._inputCash) {
e.onWithdrawToggleClicked(o, n);
t = !0;
}
});
t || this.onWithdrawToggleClicked(null, -1);
};
t.prototype.onAmountInputEnd = function() {
var e = parseInt(this.AmountInput.string), t = !1;
if (e < this._minInput) {
this.AmountInput.string = String(this._minInput);
t = !0;
e = this._minInput;
}
if (e > this._maxInput) {
this.AmountInput.string = String(this._maxInput);
t = !0;
e = this._maxInput;
}
if (t) {
var o = S.Tools.TStr.replaceString(d.default.getString("WITHDRAW_FAIL_TIP1"), {
num1: this._minInput,
num2: this._maxInput
});
A.PopHelper.Instance.showTips(o);
} else if (e > T.VM.getValue("wallet.withdraw")) {
A.PopHelper.Instance.showTips(d.default.getString("WITHDRAW_INSUFFICIENT"));
this.AmountInput.string = this._inputCash + "";
} else {
this._inputCash = e;
this.refreshToggleState();
}
};
t.prototype.onWithdrawClicked = function() {
var e = this, t = parseInt(this.AmountInput.string);
if (0 != this._bankState) if (t > T.VM.getValue("wallet.withdraw")) A.PopHelper.Instance.showTips(d.default.getString("WITHDRAW_INSUFFICIENT")); else if (this._withdrawCount <= 0) A.PopHelper.Instance.showTips(d.default.getString("VIP_WITHDRAW_TIPS_1")); else if (t > m.WalletProxy.Instance.withdrawLimitData.remainingWithAmt) E.default.Instance.addBundleMaskLayer(C.BundleUIPath.WithdrawLimitAlert, function(e) {
e.getComponent(u.default).showAlert();
}); else if (T.VM.getValue("wallet.totalRecharge") < 100) E.default.Instance.addBundleMaskLayer(C.BundleUIPath.WithdrawChargeAlert, function(e) {
e.getComponent(g.default).showView(function() {});
}); else if (1 != f.default.checkSwitch(f.ClientSwitch.CLIENT_FUNC_SWITCH_KYC) || 1 == m.WalletProxy.Instance.KYCState || 1006 == m.WalletProxy.Instance.KYCState) if (t >= this._minInput && t <= this._maxInput) {
var o = JSON.parse(cc.sys.localStorage.getItem("WithdrawCheckSwitch"));
null == o && (o = !0);
o ? T.VM.getValue("wallet.totalWithdraw") > 0 && M.ActiveProxy.Instance.ExchangeData && t >= M.ActiveProxy.Instance.ExchangeData.needMinAmount && M.ActiveProxy.Instance.isOpenExchangeActive ? E.default.Instance.addBundleMaskLayer(C.BundleUIPath.ExchangeWithdarwLayer, function(o) {
o.getComponent(P.default).init(t, function() {
E.default.Instance.addBundleMaskLayer(C.BundleUIPath.WithdrawCheckAlert, function(o) {
o.getComponent(c.default).showAlert(function() {
e.onChangeAccountClicked();
}, function() {
m.WalletProxy.Instance.sendWidthdraw(t);
});
});
}, function() {
m.WalletProxy.Instance.sendCheckBankAccount();
_.VIPProxy.Instance.sendGetWithdrawGear();
h.RedDotProxy.Instance.sendReadRedDot("withdrawal_status");
m.WalletProxy.Instance.sendGetKycResult();
m.WalletProxy.Instance.sendGetWithdrawCount(function(t) {
e._withdrawCount = t;
e.refreshWithdrawCount();
});
});
}) : E.default.Instance.addBundleMaskLayer(C.BundleUIPath.WithdrawCheckAlert, function(o) {
o.getComponent(c.default).showAlert(function() {
e.onChangeAccountClicked();
}, function() {
m.WalletProxy.Instance.sendWidthdraw(t);
});
}) : T.VM.getValue("wallet.totalWithdraw") > 0 && M.ActiveProxy.Instance.ExchangeData && t >= M.ActiveProxy.Instance.ExchangeData.needMinAmount && M.ActiveProxy.Instance.isOpenExchangeActive ? E.default.Instance.addBundleMaskLayer(C.BundleUIPath.ExchangeWithdarwLayer, function(o) {
o.getComponent(P.default).init(t, function() {
m.WalletProxy.Instance.sendWidthdraw(t);
}, function() {
m.WalletProxy.Instance.sendCheckBankAccount();
_.VIPProxy.Instance.sendGetWithdrawGear();
h.RedDotProxy.Instance.sendReadRedDot("withdrawal_status");
m.WalletProxy.Instance.sendGetKycResult();
m.WalletProxy.Instance.sendGetWithdrawCount(function(t) {
e._withdrawCount = t;
e.refreshWithdrawCount();
});
});
}) : m.WalletProxy.Instance.sendWidthdraw(t);
} else {
var n = S.Tools.TStr.replaceString(d.default.getString("WITHDRAW_FAIL_TIP1"), {
num1: this._minInput,
num2: this._maxInput
});
A.PopHelper.Instance.showTips(n);
} else {
var a = {
content: d.default.getString("WITHDRAW_TIPS_KYC"),
leftTitle: d.default.getString("DOC_KYC"),
leftCallFunc: function() {
e.onKYCClicked();
}
};
A.PopHelper.Instance.showAlert(a);
} else A.PopHelper.Instance.showTips(d.default.getString("WALLET_WITHDRAW_SUBMIT_BANK"));
};
t.prototype.onRecentClicked = function() {
E.default.Instance.addBundleMaskLayer(C.BundleUIPath.RecentPayView, function(e) {
e.getComponent(y.default).showView(p.RecentType.Withdraw);
});
};
t.prototype.onShowAmountTips = function() {
this.AmountTips.active = !0;
};
t.prototype.onHideAmountTips = function() {
this.AmountTips.active = !1;
};
t.prototype.onKYCClicked = function() {
cc.sys.openURL(O.default.getInstance().WalletUrl + "webToken?player_index=" + T.VM.getValue("user.uid") + "&token=" + T.VM.getValue("user.token"));
};
t.prototype.onCloseClicked = function() {
E.default.Instance.removeLayer(this.node);
};
i([ D(cc.Node) ], t.prototype, "KYCButton", void 0);
i([ D(cc.Node) ], t.prototype, "Balance", void 0);
i([ D(cc.Node) ], t.prototype, "Withdraw", void 0);
i([ D(cc.Node) ], t.prototype, "InputLeft", void 0);
i([ D(cc.Node) ], t.prototype, "InputRight", void 0);
i([ D(cc.Node) ], t.prototype, "InputBank", void 0);
i([ D(l.default) ], t.prototype, "AccountInput", void 0);
i([ D(l.default) ], t.prototype, "PhoneInput", void 0);
i([ D(cc.EditBox) ], t.prototype, "NameInput", void 0);
i([ D(cc.EditBox) ], t.prototype, "IFSCInput", void 0);
i([ D(cc.EditBox) ], t.prototype, "EmailInput", void 0);
i([ D(cc.EditBox) ], t.prototype, "BankNameInput", void 0);
i([ D(cc.EditBox) ], t.prototype, "PanNoInput", void 0);
i([ D(l.default) ], t.prototype, "AadhaarInput", void 0);
i([ D(cc.Node) ], t.prototype, "Bank", void 0);
i([ D(cc.Label) ], t.prototype, "BankNumber", void 0);
i([ D(cc.Label) ], t.prototype, "BankName", void 0);
i([ D(cc.Node) ], t.prototype, "AmountTips", void 0);
i([ D(cc.Label) ], t.prototype, "TotalBet", void 0);
i([ D(cc.Label) ], t.prototype, "TotalWithdraw", void 0);
i([ D(cc.Label) ], t.prototype, "TotalReward", void 0);
i([ D(cc.Label) ], t.prototype, "WithdrawAmount", void 0);
i([ D(cc.Label) ], t.prototype, "RemainingWithdraw", void 0);
i([ D(cc.Node) ], t.prototype, "WithdrawButton", void 0);
i([ D(cc.Label) ], t.prototype, "Limit", void 0);
i([ D(l.default) ], t.prototype, "AmountInput", void 0);
i([ D(cc.Node) ], t.prototype, "ToggleNode", void 0);
i([ D(cc.Node) ], t.prototype, "ToggleParent", void 0);
i([ D(cc.RichText) ], t.prototype, "CountLimitTitle", void 0);
i([ D(cc.Label) ], t.prototype, "CountLimitButton", void 0);
return i([ w ], t);
}(cc.Component);
o.default = L;
cc._RF.pop();
}, {
"../../../Config": "Config",
"../../../Game/Script/global/GlobalValue": "GlobalValue",
"../../../Game/client/global/enum/game/Const": "Const",
"../../../Game/client/global/enum/game/Event": "Event",
"../../../Game/client/global/enum/game/Game": "Game",
"../../../Game/client/model/LanguageModel": "LanguageModel",
"../../../Game/fromework/global/Tools": "Tools",
"../../../Game/fromework/helper/EventHelper": "EventHelper",
"../../../Game/fromework/helper/UIHelper": "UIHelper",
"../../../Game/fromework/mvvm/modelView/ViewModel": "ViewModel",
"../../component/NumericLabel": "NumericLabel",
"../../component/WithdrawCheckAlert": "WithdrawCheckAlert",
"../../component/WithdrawLimitAlert": "WithdrawLimitAlert",
"../../component/pop/BindAlert": "BindAlert",
"../../global/PopHelper": "PopHelper",
"../../model/RecentModel": "RecentModel",
"../../model/RedDotModel": "RedDotModel",
"../../model/UserModel": "UserModel",
"../../model/VIPModel": "VIPModel",
"../../model/WalletModel": "WalletModel",
"../active/ActiveModel": "ActiveModel",
"../ui/Exchange/ExchangeWithdarwLayer": "ExchangeWithdarwLayer",
"../ui/Recent/RecentPayView": "RecentPayView",
"../ui/WithdrawChargeAlert/WithdrawChargeAlert": "WithdrawChargeAlert",
"./WalletWithdrawPending": "WalletWithdrawPending"
} ],
WelComeBonus: [ function(e, t, o) {
"use strict";
cc._RF.push(t, "52069r05HNB7I6ZUZ6RH+Tw", "WelComeBonus");
var n, a = this && this.__extends || (n = function(e, t) {
return (n = Object.setPrototypeOf || {
__proto__: []
} instanceof Array && function(e, t) {
e.__proto__ = t;
} || function(e, t) {
for (var o in t) Object.prototype.hasOwnProperty.call(t, o) && (e[o] = t[o]);
})(e, t);
}, function(e, t) {
n(e, t);
function o() {
this.constructor = e;
}
e.prototype = null === t ? Object.create(t) : (o.prototype = t.prototype, new o());
}), i = this && this.__decorate || function(e, t, o, n) {
var a, i = arguments.length, r = i < 3 ? t : null === n ? n = Object.getOwnPropertyDescriptor(t, o) : n;
if ("object" == typeof Reflect && "function" == typeof Reflect.decorate) r = Reflect.decorate(e, t, o, n); else for (var l = e.length - 1; l >= 0; l--) (a = e[l]) && (r = (i < 3 ? a(r) : i > 3 ? a(t, o, r) : a(t, o)) || r);
return i > 3 && r && Object.defineProperty(t, o, r), r;
};
Object.defineProperty(o, "__esModule", {
value: !0
});
var r = e("../../../../Game/fromework/helper/UIHelper"), l = e("../../../../Game/client/global/enum/game/Const"), s = e("../../active/ActiveModel"), c = e("../../../../Game/fromework/helper/EventHelper"), u = e("../../../global/Global"), d = e("../../../../Game/fromework/global/Tools"), p = e("../../../component/pop/tipsHand"), h = e("../../../../Game/fromework/mvvm/modelView/ViewModel"), f = cc._decorator, _ = f.ccclass, m = f.property, y = function(e) {
a(t, e);
function t() {
var t = null !== e && e.apply(this, arguments) || this;
t.item = null;
t.itemScroll = null;
t.isFirstOpen = !1;
t.itemSpr = [];
return t;
}
t.prototype.show = function(e) {
e && (this.isFirstOpen = e);
};
t.prototype.showData = function(e) {
if (e && e.activeInfos && this.node) {
this.itemScroll.content.destroyAllChildren();
for (var t = [], o = function(o) {
var a = cc.instantiate(n.item);
a.active = !0;
a.parent = n.itemScroll.content;
a.getComponent(cc.Sprite).spriteFrame = n.itemSpr[o] ? n.itemSpr[o] : n.itemSpr[0];
var i = a.getChildByName("cash"), r = a.getChildByName("bonus"), c = a.getChildByName("total"), d = a.getChildByName("btn_buy");
i.getComponent(cc.Label).string = l.MoneySymbol + Number(e.activeInfos[o].reward[0].currey_qf[1]) / 1e3;
r.getComponent(cc.Label).string = l.MoneySymbol + Number(e.activeInfos[o].reward[0].currey_qf[4]) / 1e3;
c.getComponent(cc.Label).string = l.MoneySymbol + (Number(e.activeInfos[o].reward[0].currey_qf[1]) / 1e3 + Number(e.activeInfos[o].reward[0].currey_qf[4]) / 1e3);
d.getChildByName("num").getComponent(cc.Label).string = l.MoneySymbol + Number(e.activeInfos[o].pay_qf) / 1e3;
d.getChildByName("tipsHand").active = !1;
h.VM.getValue("wallet.totalRecharge"), Number(e.activeInfos[o].pay_qf), u.Global.Instance.tipHandNum;
if (Number(e.activeInfos[o].pay_qf) / 1e3 <= h.VM.getValue("wallet.withdraw") && Number(e.activeInfos[o].pay_qf) / 1e3 <= h.VM.getValue("wallet.remainingWithAmt") && h.VM.getValue("wallet.totalRecharge") > 0 && Number(e.activeInfos[o].pay_qf) / 1e3 >= u.Global.Instance.tipHandNum) {
var p = {
nodeTip: d,
buyNum: Number(e.activeInfos[o].pay_qf) / 1e3
};
t.push(p);
}
d.on(cc.Node.EventType.TOUCH_END, function() {
s.ActiveProxy.Instance.sendRechargeBonus(e.activeInfos[o].active_type, e.activeInfos[o].id, function() {});
});
a.on(cc.Node.EventType.TOUCH_END, function() {
s.ActiveProxy.Instance.sendRechargeBonus(e.activeInfos[o].active_type, e.activeInfos[o].id, function() {});
});
}, n = this, a = 0; a < e.activeInfos.length; a++) o(a);
if (t.length > 0) {
t[t.length - 1].nodeTip.getChildByName("tipsHand").active = !0;
t[t.length - 1].nodeTip.getChildByName("tipsHand").getComponent(p.default).show(t[t.length - 1].buyNum);
}
}
};
t.prototype.start = function() {
var e = this;
s.ActiveProxy.Instance.getRechargeBonusNew(1, function(t) {
e.showData(t);
});
var t = new Date(new Date(new Date().toLocaleDateString()).getTime() + 864e5 - 1).getTime(), o = Math.round(Number(t) / 1e3 - Number(new Date().getTime()) / 1e3) - Number(u.Global.Instance.TimeDifference), n = d.Tools.TDate.second2Hour(o), a = String(n.hour), i = String(n.minu), r = String(n.sec);
n.hour < 10 && (a = "0" + n.hour);
n.minu < 10 && (i = "0" + n.minu);
n.sec < 10 && (r = "0" + n.sec);
this.node.getChildByName("UINode").getChildByName("time").getComponent(cc.Label).string = a + ":" + i + ":" + r;
this.schedule(function() {
if ((o -= 1) >= 0) {
n = d.Tools.TDate.second2Hour(o);
a = String(n.hour);
i = String(n.minu);
r = String(n.sec);
n.hour < 10 && (a = "0" + n.hour);
n.minu < 10 && (i = "0" + n.minu);
n.sec < 10 && (r = "0" + n.sec);
e.node.getChildByName("UINode").getChildByName("time").getComponent(cc.Label).string = a + ":" + i + ":" + r;
} else {
o = 0;
e.unscheduleAllCallbacks();
}
}, 1);
};
t.prototype.closeClick = function() {
this.unscheduleAllCallbacks();
r.default.Instance.removeMaskLayer(this.node, !0);
this.isFirstOpen && c.default.Instance.Global.emit("openLoginAlert");
};
t.prototype.buyClick = function() {};
i([ m(cc.Node) ], t.prototype, "item", void 0);
i([ m(cc.ScrollView) ], t.prototype, "itemScroll", void 0);
i([ m(cc.SpriteFrame) ], t.prototype, "itemSpr", void 0);
return i([ _ ], t);
}(cc.Component);
o.default = y;
cc._RF.pop();
}, {
"../../../../Game/client/global/enum/game/Const": "Const",
"../../../../Game/fromework/global/Tools": "Tools",
"../../../../Game/fromework/helper/EventHelper": "EventHelper",
"../../../../Game/fromework/helper/UIHelper": "UIHelper",
"../../../../Game/fromework/mvvm/modelView/ViewModel": "ViewModel",
"../../../component/pop/tipsHand": "tipsHand",
"../../../global/Global": "Global",
"../../active/ActiveModel": "ActiveModel"
} ],
WithdrawAlert: [ function(e, t, o) {
"use strict";
cc._RF.push(t, "771e4PcMrVClbXfdaIrPjdr", "WithdrawAlert");
var n, a = this && this.__extends || (n = function(e, t) {
return (n = Object.setPrototypeOf || {
__proto__: []
} instanceof Array && function(e, t) {
e.__proto__ = t;
} || function(e, t) {
for (var o in t) Object.prototype.hasOwnProperty.call(t, o) && (e[o] = t[o]);
})(e, t);
}, function(e, t) {
n(e, t);
function o() {
this.constructor = e;
}
e.prototype = null === t ? Object.create(t) : (o.prototype = t.prototype, new o());
}), i = this && this.__decorate || function(e, t, o, n) {
var a, i = arguments.length, r = i < 3 ? t : null === n ? n = Object.getOwnPropertyDescriptor(t, o) : n;
if ("object" == typeof Reflect && "function" == typeof Reflect.decorate) r = Reflect.decorate(e, t, o, n); else for (var l = e.length - 1; l >= 0; l--) (a = e[l]) && (r = (i < 3 ? a(r) : i > 3 ? a(t, o, r) : a(t, o)) || r);
return i > 3 && r && Object.defineProperty(t, o, r), r;
};
Object.defineProperty(o, "__esModule", {
value: !0
});
var r = e("../../Game/fromework/helper/UIHelper"), l = e("../logic/Wallet/WalletHelper"), s = e("../model/WalletModel"), c = cc._decorator, u = c.ccclass, d = c.property, p = function(e) {
a(t, e);
function t() {
var t = null !== e && e.apply(this, arguments) || this;
t.AlertPanel = null;
t.WinNode = null;
t.LoseNode = null;
t._callFunc = null;
return t;
}
t.prototype.openAction = function() {
this.AlertPanel.setPosition(cc.v2(0, this.node.height / 2 + this.AlertPanel.height / 2));
this.AlertPanel.runAction(cc.moveTo(.1, cc.v2(0, 0)));
};
t.prototype.closeAction = function(e) {
var t = this, o = cc.moveTo(.1, cc.v2(0, -(this.node.height / 2 + this.AlertPanel.height / 2))), n = cc.callFunc(function() {
e && e.apply(t);
}), a = cc.sequence(o, n);
this.AlertPanel.runAction(a);
};
t.prototype.showAlert = function(e, t) {
this._callFunc = t;
this.WinNode.active = 1 == e;
this.LoseNode.active = 2 == e;
this.openAction();
};
t.prototype.refreshAlert = function(e, t) {
var o = this;
this.closeAction(function() {
o._callFunc = t;
o.WinNode.active = 1 == e;
o.LoseNode.active = 2 == e;
o.openAction();
});
};
t.prototype.onWithdrawClicked = function() {
var e = this;
s.WalletProxy.Instance.sendSystemTipsWithdraw();
this.closeAction(function() {
r.default.Instance.removeMaskLayer(e.node);
l.default.Instance.openWithdraw();
});
};
t.prototype.onBackClicked = function() {
var e = this;
this.closeAction(function() {
r.default.Instance.removeMaskLayer(e.node);
e._callFunc && e._callFunc(!1);
});
};
i([ d(cc.Node) ], t.prototype, "AlertPanel", void 0);
i([ d(cc.Node) ], t.prototype, "WinNode", void 0);
i([ d(cc.Node) ], t.prototype, "LoseNode", void 0);
return i([ u ], t);
}(cc.Component);
o.default = p;
cc._RF.pop();
}, {
"../../Game/fromework/helper/UIHelper": "UIHelper",
"../logic/Wallet/WalletHelper": "WalletHelper",
"../model/WalletModel": "WalletModel"
} ],
WithdrawChargeAlert: [ function(e, t, o) {
"use strict";
cc._RF.push(t, "45d86SYMetMu66n9xqbgC1+", "WithdrawChargeAlert");
var n, a = this && this.__extends || (n = function(e, t) {
return (n = Object.setPrototypeOf || {
__proto__: []
} instanceof Array && function(e, t) {
e.__proto__ = t;
} || function(e, t) {
for (var o in t) Object.prototype.hasOwnProperty.call(t, o) && (e[o] = t[o]);
})(e, t);
}, function(e, t) {
n(e, t);
function o() {
this.constructor = e;
}
e.prototype = null === t ? Object.create(t) : (o.prototype = t.prototype, new o());
}), i = this && this.__decorate || function(e, t, o, n) {
var a, i = arguments.length, r = i < 3 ? t : null === n ? n = Object.getOwnPropertyDescriptor(t, o) : n;
if ("object" == typeof Reflect && "function" == typeof Reflect.decorate) r = Reflect.decorate(e, t, o, n); else for (var l = e.length - 1; l >= 0; l--) (a = e[l]) && (r = (i < 3 ? a(r) : i > 3 ? a(t, o, r) : a(t, o)) || r);
return i > 3 && r && Object.defineProperty(t, o, r), r;
};
Object.defineProperty(o, "__esModule", {
value: !0
});
var r = e("../../../../Game/client/global/enum/game/Const"), l = e("../../../../Game/fromework/helper/UIHelper"), s = e("../../../../Game/Script/global/GlobalValue"), c = e("../../../model/UserModel"), u = e("../../../model/WalletModel"), d = e("../../active/ActiveManager"), p = e("../../Wallet/WalletHelper"), h = cc._decorator, f = h.ccclass, _ = (h.property, 
function(e) {
a(t, e);
function t() {
var t = null !== e && e.apply(this, arguments) || this;
t._callFunc = null;
return t;
}
t.prototype.showView = function(e) {
this._callFunc = e;
};
t.prototype.onOKClicked = function() {
this._callFunc && this._callFunc();
this._callFunc = null;
l.default.Instance.removeMaskLayer(this.node, !0);
var e = u.WalletProxy.Instance.activityList[0];
p.default.Instance.openRechargeView(function() {
p.default.Instance.openRecharge({
activityId: e ? e.id : 0,
cash: 100
});
}, 100, e ? e.id : 0);
};
t.prototype.onOtherClicked = function() {
this._callFunc && this._callFunc();
this._callFunc = null;
l.default.Instance.removeMaskLayer(this.node, !0);
d.default.Instance.checkSuperActive() ? d.default.Instance.openSuperAlertAndRefreshData() : 1 == c.default.checkSwitch(c.ClientSwitch.CLIENT_FUNC_SWITCH_MONTH_CARD) && s.default.getInstance().isCashGame && l.default.Instance.addBundleMaskLayer(r.BundleUIPath.MonthCard);
};
t.prototype.onCloseClicked = function() {
l.default.Instance.removeMaskLayer(this.node, !0);
};
return i([ f ], t);
}(cc.Component));
o.default = _;
cc._RF.pop();
}, {
"../../../../Game/Script/global/GlobalValue": "GlobalValue",
"../../../../Game/client/global/enum/game/Const": "Const",
"../../../../Game/fromework/helper/UIHelper": "UIHelper",
"../../../model/UserModel": "UserModel",
"../../../model/WalletModel": "WalletModel",
"../../Wallet/WalletHelper": "WalletHelper",
"../../active/ActiveManager": "ActiveManager"
} ],
WithdrawCheckAlert: [ function(e, t, o) {
"use strict";
cc._RF.push(t, "8c99dkUmY5FGKxA+6+ac+eM", "WithdrawCheckAlert");
var n, a = this && this.__extends || (n = function(e, t) {
return (n = Object.setPrototypeOf || {
__proto__: []
} instanceof Array && function(e, t) {
e.__proto__ = t;
} || function(e, t) {
for (var o in t) Object.prototype.hasOwnProperty.call(t, o) && (e[o] = t[o]);
})(e, t);
}, function(e, t) {
n(e, t);
function o() {
this.constructor = e;
}
e.prototype = null === t ? Object.create(t) : (o.prototype = t.prototype, new o());
}), i = this && this.__decorate || function(e, t, o, n) {
var a, i = arguments.length, r = i < 3 ? t : null === n ? n = Object.getOwnPropertyDescriptor(t, o) : n;
if ("object" == typeof Reflect && "function" == typeof Reflect.decorate) r = Reflect.decorate(e, t, o, n); else for (var l = e.length - 1; l >= 0; l--) (a = e[l]) && (r = (i < 3 ? a(r) : i > 3 ? a(t, o, r) : a(t, o)) || r);
return i > 3 && r && Object.defineProperty(t, o, r), r;
};
Object.defineProperty(o, "__esModule", {
value: !0
});
var r = e("../../Game/fromework/helper/UIHelper"), l = e("../model/WalletModel"), s = cc._decorator, c = s.ccclass, u = s.property, d = function(e) {
a(t, e);
function t() {
var t = null !== e && e.apply(this, arguments) || this;
t.AlertPanel = null;
t.Name = null;
t.Account = null;
t.IFSC = null;
t.Toggle = null;
t._modifyCallFunc = null;
t._confirmCallFunc = null;
t._panelPos = null;
return t;
}
t.prototype.onLoad = function() {
this._panelPos = this.AlertPanel.getPosition();
};
t.prototype.openAction = function() {
this.AlertPanel.setPosition(cc.v2(0, this.node.height / 2 + this.AlertPanel.height / 2));
this.AlertPanel.runAction(cc.moveTo(.1, this._panelPos));
};
t.prototype.closeAction = function(e) {
var t = this, o = cc.moveTo(.1, cc.v2(0, -(this.node.height / 2 + this.AlertPanel.height / 2))), n = cc.callFunc(function() {
e && e.apply(t);
}), a = cc.sequence(o, n);
this.AlertPanel.runAction(a);
};
t.prototype.showAlert = function(e, t) {
this._modifyCallFunc = e;
this._confirmCallFunc = t;
var o = l.WalletProxy.Instance.bankData;
this.Name.string = o.name;
this.Account.string = o.account;
this.IFSC.string = o.ifsc;
this.openAction();
};
t.prototype.onModifyClicked = function() {
var e = this;
this.closeAction(function() {
cc.sys.localStorage.setItem("WithdrawCheckSwitch", JSON.stringify(!e.Toggle.isChecked));
r.default.Instance.removeMaskLayer(e.node);
e._modifyCallFunc && e._modifyCallFunc();
});
};
t.prototype.onConfirmClicked = function() {
var e = this;
this.closeAction(function() {
cc.sys.localStorage.setItem("WithdrawCheckSwitch", JSON.stringify(!e.Toggle.isChecked));
r.default.Instance.removeMaskLayer(e.node);
e._confirmCallFunc && e._confirmCallFunc();
});
};
i([ u(cc.Node) ], t.prototype, "AlertPanel", void 0);
i([ u(cc.Label) ], t.prototype, "Name", void 0);
i([ u(cc.Label) ], t.prototype, "Account", void 0);
i([ u(cc.Label) ], t.prototype, "IFSC", void 0);
i([ u(cc.Toggle) ], t.prototype, "Toggle", void 0);
return i([ c ], t);
}(cc.Component);
o.default = d;
cc._RF.pop();
}, {
"../../Game/fromework/helper/UIHelper": "UIHelper",
"../model/WalletModel": "WalletModel"
} ],
WithdrawLimitAlert: [ function(e, t, o) {
"use strict";
cc._RF.push(t, "a5373pCZUdGCJYZNi32wZrf", "WithdrawLimitAlert");
var n, a = this && this.__extends || (n = function(e, t) {
return (n = Object.setPrototypeOf || {
__proto__: []
} instanceof Array && function(e, t) {
e.__proto__ = t;
} || function(e, t) {
for (var o in t) Object.prototype.hasOwnProperty.call(t, o) && (e[o] = t[o]);
})(e, t);
}, function(e, t) {
n(e, t);
function o() {
this.constructor = e;
}
e.prototype = null === t ? Object.create(t) : (o.prototype = t.prototype, new o());
}), i = this && this.__decorate || function(e, t, o, n) {
var a, i = arguments.length, r = i < 3 ? t : null === n ? n = Object.getOwnPropertyDescriptor(t, o) : n;
if ("object" == typeof Reflect && "function" == typeof Reflect.decorate) r = Reflect.decorate(e, t, o, n); else for (var l = e.length - 1; l >= 0; l--) (a = e[l]) && (r = (i < 3 ? a(r) : i > 3 ? a(t, o, r) : a(t, o)) || r);
return i > 3 && r && Object.defineProperty(t, o, r), r;
};
Object.defineProperty(o, "__esModule", {
value: !0
});
var r = e("../../Game/client/global/enum/game/Event"), l = e("../../Game/client/global/enum/game/Game"), s = e("../../Game/fromework/helper/EventHelper"), c = e("../../Game/fromework/helper/UIHelper"), u = e("../../Game/fromework/mvvm/modelView/ViewModel"), d = e("../model/LobbyModel"), p = cc._decorator, h = p.ccclass, f = p.property, _ = function(e) {
a(t, e);
function t() {
var t = null !== e && e.apply(this, arguments) || this;
t.AlertPanel = null;
t._callFunc = null;
return t;
}
t.prototype.openAction = function() {
this.AlertPanel.setPosition(cc.v2(0, this.node.height / 2 + this.AlertPanel.height / 2));
this.AlertPanel.runAction(cc.moveTo(.1, cc.v2(0, 0)));
};
t.prototype.closeAction = function(e) {
var t = this, o = cc.moveTo(.1, cc.v2(0, -(this.node.height / 2 + this.AlertPanel.height / 2))), n = cc.callFunc(function() {
e && e.apply(t);
}), a = cc.sequence(o, n);
this.AlertPanel.runAction(a);
};
t.prototype.showAlert = function(e) {
this._callFunc = e;
this.openAction();
};
t.prototype.onTPWarClicked = function() {
var e = d.default.Instance.getGamePlayByCls(l.GameEnum.PlayType.GAME_TP_WAR);
e && e[0] && s.default.Instance.Global.emit(r.GameUIEvent.LOBBY_CASH_JOIN, e[0].rtype);
};
t.prototype.on3PattiClicked = function() {
var e = d.default.Instance.getGamePlayByCls(l.GameEnum.PlayType.TP_3PATTI), t = .5;
u.VM.getValue("wallet.total") >= 128 && (t = 1);
for (var o = null, n = 0; n < e.length; n++) if (e[n].base == t) {
o = e[n];
break;
}
null != o ? s.default.Instance.Global.emit(r.GameUIEvent.LOBBY_CASH_JOIN, o.rtype) : e && e[0] && s.default.Instance.Global.emit(r.GameUIEvent.LOBBY_CASH_JOIN, e[0].rtype);
};
t.prototype.onBackClicked = function() {
var e = this;
this.closeAction(function() {
c.default.Instance.removeMaskLayer(e.node);
e._callFunc && e._callFunc(!1);
});
};
i([ f(cc.Node) ], t.prototype, "AlertPanel", void 0);
return i([ h ], t);
}(cc.Component);
o.default = _;
cc._RF.pop();
}, {
"../../Game/client/global/enum/game/Event": "Event",
"../../Game/client/global/enum/game/Game": "Game",
"../../Game/fromework/helper/EventHelper": "EventHelper",
"../../Game/fromework/helper/UIHelper": "UIHelper",
"../../Game/fromework/mvvm/modelView/ViewModel": "ViewModel",
"../model/LobbyModel": "LobbyModel"
} ],
challengeDone: [ function(e, t, o) {
"use strict";
cc._RF.push(t, "5fba2kdUV5A8K7grzTrdwfM", "challengeDone");
var n, a = this && this.__extends || (n = function(e, t) {
return (n = Object.setPrototypeOf || {
__proto__: []
} instanceof Array && function(e, t) {
e.__proto__ = t;
} || function(e, t) {
for (var o in t) Object.prototype.hasOwnProperty.call(t, o) && (e[o] = t[o]);
})(e, t);
}, function(e, t) {
n(e, t);
function o() {
this.constructor = e;
}
e.prototype = null === t ? Object.create(t) : (o.prototype = t.prototype, new o());
}), i = this && this.__decorate || function(e, t, o, n) {
var a, i = arguments.length, r = i < 3 ? t : null === n ? n = Object.getOwnPropertyDescriptor(t, o) : n;
if ("object" == typeof Reflect && "function" == typeof Reflect.decorate) r = Reflect.decorate(e, t, o, n); else for (var l = e.length - 1; l >= 0; l--) (a = e[l]) && (r = (i < 3 ? a(r) : i > 3 ? a(t, o, r) : a(t, o)) || r);
return i > 3 && r && Object.defineProperty(t, o, r), r;
};
Object.defineProperty(o, "__esModule", {
value: !0
});
var r = cc._decorator, l = r.ccclass, s = (r.property, function(e) {
a(t, e);
function t() {
return null !== e && e.apply(this, arguments) || this;
}
t.prototype.onLoad = function() {};
t.prototype.start = function() {
var e = this;
this.scheduleOnce(function() {
e.node.active = !1;
}, 5);
};
return i([ l ], t);
}(cc.Component));
o.default = s;
cc._RF.pop();
}, {} ],
fullScreenBg: [ function(e, t, o) {
"use strict";
cc._RF.push(t, "fec62hsC9pB/oh2zauaWI60", "fullScreenBg");
var n, a = this && this.__extends || (n = function(e, t) {
return (n = Object.setPrototypeOf || {
__proto__: []
} instanceof Array && function(e, t) {
e.__proto__ = t;
} || function(e, t) {
for (var o in t) Object.prototype.hasOwnProperty.call(t, o) && (e[o] = t[o]);
})(e, t);
}, function(e, t) {
n(e, t);
function o() {
this.constructor = e;
}
e.prototype = null === t ? Object.create(t) : (o.prototype = t.prototype, new o());
}), i = this && this.__decorate || function(e, t, o, n) {
var a, i = arguments.length, r = i < 3 ? t : null === n ? n = Object.getOwnPropertyDescriptor(t, o) : n;
if ("object" == typeof Reflect && "function" == typeof Reflect.decorate) r = Reflect.decorate(e, t, o, n); else for (var l = e.length - 1; l >= 0; l--) (a = e[l]) && (r = (i < 3 ? a(r) : i > 3 ? a(t, o, r) : a(t, o)) || r);
return i > 3 && r && Object.defineProperty(t, o, r), r;
};
Object.defineProperty(o, "__esModule", {
value: !0
});
var r = cc._decorator, l = r.ccclass, s = (r.property, function(e) {
a(t, e);
function t() {
return null !== e && e.apply(this, arguments) || this;
}
t.prototype.start = function() {
var e, t = this.node, o = cc.view.getDesignResolutionSize().width, n = cc.view.getDesignResolutionSize().height, a = cc.view.getVisibleSizeInPixel().width, i = cc.view.getVisibleSizeInPixel().height;
e = a / i >= o / n ? a / i / (o / n) : i / a * (o / n);
t.setScale(750 * e / 720, 750 * e / 720, 750 * e / 720);
};
return i([ l ], t);
}(cc.Component));
o.default = s;
cc._RF.pop();
}, {} ],
tipsHand: [ function(e, t, o) {
"use strict";
cc._RF.push(t, "72e24u0vJtMFIZT3FzYerB1", "tipsHand");
var n, a = this && this.__extends || (n = function(e, t) {
return (n = Object.setPrototypeOf || {
__proto__: []
} instanceof Array && function(e, t) {
e.__proto__ = t;
} || function(e, t) {
for (var o in t) Object.prototype.hasOwnProperty.call(t, o) && (e[o] = t[o]);
})(e, t);
}, function(e, t) {
n(e, t);
function o() {
this.constructor = e;
}
e.prototype = null === t ? Object.create(t) : (o.prototype = t.prototype, new o());
}), i = this && this.__decorate || function(e, t, o, n) {
var a, i = arguments.length, r = i < 3 ? t : null === n ? n = Object.getOwnPropertyDescriptor(t, o) : n;
if ("object" == typeof Reflect && "function" == typeof Reflect.decorate) r = Reflect.decorate(e, t, o, n); else for (var l = e.length - 1; l >= 0; l--) (a = e[l]) && (r = (i < 3 ? a(r) : i > 3 ? a(t, o, r) : a(t, o)) || r);
return i > 3 && r && Object.defineProperty(t, o, r), r;
};
Object.defineProperty(o, "__esModule", {
value: !0
});
var r = e("../../../Game/client/global/enum/game/Event"), l = e("../../../Game/fromework/helper/EventHelper"), s = e("../../../Game/fromework/mvvm/modelView/ViewModel"), c = e("../../global/Global"), u = cc._decorator, d = u.ccclass, p = (u.property, 
function(e) {
a(t, e);
function t() {
var t = null !== e && e.apply(this, arguments) || this;
t._buyNum = null;
return t;
}
t.prototype.onLoad = function() {
l.default.Instance.Global.bind(r.WalletEvent.WALLET_USER_GET_WALLET, this.refShow, this);
};
t.prototype.onDisable = function() {
l.default.Instance.Global.unbind(r.WalletEvent.WALLET_USER_GET_WALLET, this.refShow, this);
};
t.prototype.start = function() {};
t.prototype.show = function(e) {
this._buyNum = e;
var t = s.VM.getValue("wallet.withdraw"), o = s.VM.getValue("wallet.remainingWithAmt");
t >= e && o >= e && s.VM.getValue("wallet.totalRecharge") > 0 && e >= c.Global.Instance.tipHandNum ? this.node.getChildByName("hand").active = !0 : this.node.getChildByName("hand").active = !1;
};
t.prototype.refShow = function() {
null != this._buyNum && (s.VM.getValue("wallet.withdraw") >= this._buyNum && s.VM.getValue("wallet.remainingWithAmt") >= this._buyNum && s.VM.getValue("wallet.totalRecharge") > 0 && this._buyNum >= c.Global.Instance.tipHandNum ? this.node.getChildByName("hand").active = !0 : this.node.getChildByName("hand").active = !1);
};
return i([ d ], t);
}(cc.Component));
o.default = p;
cc._RF.pop();
}, {
"../../../Game/client/global/enum/game/Event": "Event",
"../../../Game/fromework/helper/EventHelper": "EventHelper",
"../../../Game/fromework/mvvm/modelView/ViewModel": "ViewModel",
"../../global/Global": "Global"
} ]
}, {}, [ "ABDealer", "ABHelp", "ABModel", "ABRecord", "ABRecordSmall", "ABStruct", "BlastEvent", "BlastModel", "BlastStruct", "BlastBetPanel", "BlastLotteryRecordItem", "BlastMyRecordItem", "BlastRecordAlert", "BlastRecordAlertItem", "BlastRecordPanel", "BlastRecordSmall", "BlastRocket", "BlastScaleLine", "BlastSpace", "BlastSpaceBG", "BlastSpaceMeteor", "BlastSpaceMeteorite", "BlastSpaceRun", "BlastSpaceScene", "BlastSpaceStar", "BlastSpaceUI", "BlastThisRoundItem", "BlastWin", "ChooseBetChip", "CompositeCard", "CompositeChip", "CompositeChipGenerator", "CompositeChipGold", "CompositeHelp", "CompositeOdds", "CompositePlayerHead", "CompositeRankHead", "CompositeWinMoney", "OtherMember", "CompositeScene", "ChipManager", "ChipManagerGold", "GameManager", "GeneratorManager", "OddsManager", "PlayerHeadManager", "CompositeEffect", "CompositeUI", "CompositeConst", "CompositeEvent", "CompositeModel", "CompositeProxy", "CompositeStruct", "CompositeUtil", "DTDealer", "DTDealerList", "DTDealerListItem", "DTHelp", "DTModel", "DTRecord", "DTRecordSmall", "DTScene", "DTStruct", "LuckyDiceDealer", "LuckyDiceHelp", "LuckyDiceModel", "LuckyDiceRecord", "LuckyDiceRecordSmall", "LuckyDiceStruct", "LotoFast", "LotoFastBigWinner", "LotoFastDealer", "LotoFastEvent", "LotoFastHelp", "LotoFastJackPot", "LotoFastJackPotRecordItem", "LotoFastManager", "LotoFastMarquee", "LotoFastModel", "LotoFastOdds", "LotoFastRecord", "LotoFastRecordAlert", "LotoFastRecordSmall", "LotoFastStruct", "LotoFastTips", "LotoFastUserRecordItem", "LotoFastWinnerRecordItem", "RS1LotteryHelp", "RS1LotteryRecord", "RS1LotteryView", "BtnBuyFit", "RBDealer", "RBHelp", "RBModel", "RBRecord", "RBRecordSmall", "RBStruct", "RBFast", "RBFastCensus", "RBFastDealer", "RBFastEvent", "RBFastHelp", "RBFastManager", "RBFastModel", "RBFastOdds", "RBFastRecord", "RBFastRecordAlert", "RBFastStruct", "RBFastTips", "RBFastUserRecordItem", "RBFastWinnerRecordItem", "RouletteDashboard", "RouletteDealer", "RouletteHelp", "RouletteItem", "RouletteModel", "RouletteOdds", "RouletteRecord", "RouletteRecordSmall", "RouletteStruct", "SUDDealer", "SUDHelp", "SUDModel", "SUDRecord", "SUDRecordSmall", "SUDStruct", "TPWarDealer", "TPWarHelp", "TPWarModel", "TPWarRecord", "TPWarRecordSmall", "TPWarScene", "TPWarStruct", "TraditionABDealer", "TraditionABEvent", "TraditionABHelp", "TraditionABModel", "TraditionABOdds", "TraditionABRecord", "TraditionABRecordSmall", "TraditionABStruct", "TraditionChip", "TraditionChipGenerator", "TraditionChipManager", "TraditionChipManagerGold", "TraditionChooseBetChip", "TraditionGeneratorManager", "TraditionPlayerHead", "TraditionPlayerHeadManager", "TraditionUI", "Config", "BundleManager", "GlobalValue", "ShellNetHttp", "ShellProxy", "SingleUserModel", "Tips", "Const", "Event", "Game", "UIUtils", "C2S", "S2C", "GameHelper", "AutoSort", "CheckTools", "PureSequence", "Sequence", "Set", "CommonModel", "LanguageModel", "UpdateModel", "Fromework", "CachePool", "ResLoader", "Tools", "EventWorker", "AudioHelper", "ConfigHelper", "EventHelper", "UIHelper", "Base64IN", "BhvButtonGroup", "BhvFrameIndex", "BhvRollNumber", "BhvSwitchPage", "JsonOb", "StringFormat", "VMBase", "VMCompsEdit", "VMCustom", "VMEvent", "VMLabel", "VMModify", "VMParent", "VMProgress", "VMState", "ViewModel", "NetHttp", "NetUtils", "SlotConst", "SlotModel", "SlotProxy", "SlotStruct", "SlotProgress", "SlotSpinButton", "SlotTab", "Slot", "SlotHelp", "SlotInfo", "SlotItemAlert", "SlotResult", "SlotScene", "SlotUI", "SlotWin", "Track", "TrackManager", "FestivalEvent", "FestivalModel", "FestivalStruct", "FestivalExchange", "FestivalItem", "FestivalRandomItem", "FestivalTask", "FestivalTaskBox", "FestivalTaskItem", "FestivalView", "Card", "Character", "Chip", "CurrencySlider", "Dealer", "GameHead", "GlobalNotice", "Group", "HeadManager", "ImageLoader", "Marquee", "MoneyAction", "NetworkDelay", "NodeColor", "NumericEditorBox", "NumericLabel", "RedDot", "ScoreItem", "ScoreWindow", "SequenceBulb", "Waiting", "WithdrawAlert", "WithdrawCheckAlert", "WithdrawLimitAlert", "CloseDeck", "FinishDeck", "OpenDeck", "Alert", "BestDeclare", "BindAlert", "CountDown", "TableMenu", "tipsHand", "Global", "PopHelper", "BonusRecord", "BonusRecordItem", "RechargeView", "WalletActItem", "WalletActivity", "WalletHelper", "WalletInfoAlert", "WalletKYC", "WalletKYCDocument", "WalletKYCMobile", "WalletKYCStateItem", "WalletMain", "WalletRecharge", "WalletSelectImg", "WalletWithdraw", "WalletWithdrawPending", "ActiveEvent", "ActiveManager", "ActiveModel", "ActiveStruct", "BrokeActive", "BrokeChargeCmp", "BrokeMonthCard", "BrokeNormal", "DailyRecharge", "DailyRechargeItem", "FirstCharge", "RechagerActivity", "GameInfo", "HearBeat", "TableBoard", "TableManager", "TableOptTips", "TestTools", "AutoSortNew", "Sort", "Guide", "DevTestScene", "GameScene", "GuideScene", "LaunchScene", "LoadingScene", "LobbyScene", "LoginScene", "RS1LotteryScene", "TeenPattiScene", "TestScene", "Activity", "ActivityItem", "AddCash", "AddCashActItem", "AddCashActivity", "AddCashItem", "AddCashEvent", "AddCashVIP", "AddCashVIPgradeItem", "BetBoxLayer", "BonusLayer", "WelComeBonus", "Calender", "CalenderDay", "CardRecorder", "CardRecorderItem", "ChairAlert", "ChallengeButton", "ChallengeLayer", "ChallengeModel", "challengeDone", "DownNewLayer", "ExchangeLayer", "ExchangeWithdarwLayer", "HelpView", "KongQueKaLayer", "LobbyLogic", "LobbyRoomItem", "LobbyRoomList", "LobbyRoomPractice", "LobbyRoomSlider", "LobbyView", "MailCashApplication", "MailCashResult", "MailDetail", "MailItem", "MailNormal", "MailRecharge", "MailUI", "GoldSliverCard", "MonthCard", "MonthCardItem", "MonthCardLobbyView", "MonthCardUpdate", "Notice", "RecentDetailOther", "RecentItem", "RecentPayItem", "RecentPayView", "RecentView", "RechargeAlert", "ReferHelp", "ReferInviteBox", "ReferItem", "ReferLevelAlert", "ReferShare", "ReferView", "ReferEarn", "RewardView", "ScoreBoard", "ScoreBoardItem", "ServiceView", "ShopView", "ShopViewItem", "SignLayer", "ThirtyDaysSignUp", "Signin", "SigninItem", "SplitPrize", "SplitPrizeItem", "TaskButton", "TaskEvent", "TaskItem", "TaskModel", "TaskStruct", "TaskView", "TotalResult", "TotalResultItem", "Treasure", "TreasureEvent", "UpdateNotice", "UserInfo", "VIPDetail", "VIPDetailItem", "VIPLogic", "VIPShop", "VIPShopItem", "WithdrawChargeAlert", "FirstAward", "GameSetView", "GameSetting", "LobbySetting", "UserSetting", "AddCashVIPModel", "ErrorModel", "GameModel", "InviteModel", "ItemModel", "LobbyModel", "LogEventModel", "MailModel", "MarqueeModel", "MonthCardModel", "PhoneModel", "RecentModel", "RedDotModel", "ReferModel", "ShopModel", "SingModel", "TreasureModel", "UserModel", "VIPModel", "WalletModel", "Card_tp", "PlayerHead_tp", "TP_Eff_Win", "TP_Effect_Follow", "VSArrow", "TeenPattiLogic", "TeenPattiModel", "TeenPattiStruct", "CompateAlert", "TPHelp_5", "TPHelp_6_7", "TeenPattiInfo", "TeenPattiUI", "TPRechargeAlert", "TPRechargeAlertItem", "ButtonBlock", "CashSprite", "ColorAssembler2D", "LongTouchComponent", "TableList", "TableListItem", "ListView", "ListViewItem", "NetHelper", "NetWebSocket", "Log", "Platform", "fullScreenBg" ]);